var $V=Object.defineProperty;var TA=g=>{throw TypeError(g)};var zV=(g,t,i)=>t in g?$V(g,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):g[t]=i;var St=(g,t,i)=>zV(g,typeof t!="symbol"?t+"":t,i),EA=(g,t,i)=>t.has(g)||TA("Cannot "+i),$N=(g,t)=>Object(t)!==t?TA('Cannot use the "in" operator on this value'):g.has(t),u=(g,t,i)=>(EA(g,t,"read from private field"),i?i.call(g):t.get(g)),j=(g,t,i)=>t.has(g)?TA("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(g):t.set(g,i),D=(g,t,i,n)=>(EA(g,t,"write to private field"),n?n.call(g,i):t.set(g,i),i),R=(g,t,i)=>(EA(g,t,"access private method"),i);var Yn=(g,t,i,n)=>({set _(o){D(g,t,o,i)},get _(){return u(g,t,n)}});/*!
 * jQuery JavaScript Library v3.7.1
 * https://jquery.com/
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license
 * https://jquery.org/license
 *
 * Date: 2023-08-28T13:37Z
 */(function(g,t){typeof module=="object"&&typeof module.exports=="object"?module.exports=g.document?t(g,!0):function(i){if(!i.document)throw new Error("jQuery requires a window with a document");return t(i)}:t(g)})(typeof window<"u"?window:void 0,function(g,t){var i=[],n=Object.getPrototypeOf,o=i.slice,l=i.flat?function(y){return i.flat.call(y)}:function(y){return i.concat.apply([],y)},c=i.push,d=i.indexOf,f={},m=f.toString,b=f.hasOwnProperty,T=b.toString,C=T.call(Object),P={},x=function(E){return typeof E=="function"&&typeof E.nodeType!="number"&&typeof E.item!="function"},L=function(E){return E!=null&&E===E.window},F=g.document,X={type:!0,src:!0,nonce:!0,noModule:!0};function re(y,E,U){U=U||F;var q,Z,Q=U.createElement("script");if(Q.text=y,E)for(q in X)Z=E[q]||E.getAttribute&&E.getAttribute(q),Z&&Q.setAttribute(q,Z);U.head.appendChild(Q).parentNode.removeChild(Q)}function K(y){return y==null?y+"":typeof y=="object"||typeof y=="function"?f[m.call(y)]||"object":typeof y}var te="3.7.1",ee=/HTML$/i,A=function(y,E){return new A.fn.init(y,E)};A.fn=A.prototype={jquery:te,constructor:A,length:0,toArray:function(){return o.call(this)},get:function(y){return y==null?o.call(this):y<0?this[y+this.length]:this[y]},pushStack:function(y){var E=A.merge(this.constructor(),y);return E.prevObject=this,E},each:function(y){return A.each(this,y)},map:function(y){return this.pushStack(A.map(this,function(E,U){return y.call(E,U,E)}))},slice:function(){return this.pushStack(o.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(A.grep(this,function(y,E){return(E+1)%2}))},odd:function(){return this.pushStack(A.grep(this,function(y,E){return E%2}))},eq:function(y){var E=this.length,U=+y+(y<0?E:0);return this.pushStack(U>=0&&U<E?[this[U]]:[])},end:function(){return this.prevObject||this.constructor()},push:c,sort:i.sort,splice:i.splice},A.extend=A.fn.extend=function(){var y,E,U,q,Z,Q,ae=arguments[0]||{},Pe=1,Se=arguments.length,je=!1;for(typeof ae=="boolean"&&(je=ae,ae=arguments[Pe]||{},Pe++),typeof ae!="object"&&!x(ae)&&(ae={}),Pe===Se&&(ae=this,Pe--);Pe<Se;Pe++)if((y=arguments[Pe])!=null)for(E in y)q=y[E],!(E==="__proto__"||ae===q)&&(je&&q&&(A.isPlainObject(q)||(Z=Array.isArray(q)))?(U=ae[E],Z&&!Array.isArray(U)?Q=[]:!Z&&!A.isPlainObject(U)?Q={}:Q=U,Z=!1,ae[E]=A.extend(je,Q,q)):q!==void 0&&(ae[E]=q));return ae},A.extend({expando:"jQuery"+(te+Math.random()).replace(/\D/g,""),isReady:!0,error:function(y){throw new Error(y)},noop:function(){},isPlainObject:function(y){var E,U;return!y||m.call(y)!=="[object Object]"?!1:(E=n(y),E?(U=b.call(E,"constructor")&&E.constructor,typeof U=="function"&&T.call(U)===C):!0)},isEmptyObject:function(y){var E;for(E in y)return!1;return!0},globalEval:function(y,E,U){re(y,{nonce:E&&E.nonce},U)},each:function(y,E){var U,q=0;if(me(y))for(U=y.length;q<U&&E.call(y[q],q,y[q])!==!1;q++);else for(q in y)if(E.call(y[q],q,y[q])===!1)break;return y},text:function(y){var E,U="",q=0,Z=y.nodeType;if(!Z)for(;E=y[q++];)U+=A.text(E);return Z===1||Z===11?y.textContent:Z===9?y.documentElement.textContent:Z===3||Z===4?y.nodeValue:U},makeArray:function(y,E){var U=E||[];return y!=null&&(me(Object(y))?A.merge(U,typeof y=="string"?[y]:y):c.call(U,y)),U},inArray:function(y,E,U){return E==null?-1:d.call(E,y,U)},isXMLDoc:function(y){var E=y&&y.namespaceURI,U=y&&(y.ownerDocument||y).documentElement;return!ee.test(E||U&&U.nodeName||"HTML")},merge:function(y,E){for(var U=+E.length,q=0,Z=y.length;q<U;q++)y[Z++]=E[q];return y.length=Z,y},grep:function(y,E,U){for(var q,Z=[],Q=0,ae=y.length,Pe=!U;Q<ae;Q++)q=!E(y[Q],Q),q!==Pe&&Z.push(y[Q]);return Z},map:function(y,E,U){var q,Z,Q=0,ae=[];if(me(y))for(q=y.length;Q<q;Q++)Z=E(y[Q],Q,U),Z!=null&&ae.push(Z);else for(Q in y)Z=E(y[Q],Q,U),Z!=null&&ae.push(Z);return l(ae)},guid:1,support:P}),typeof Symbol=="function"&&(A.fn[Symbol.iterator]=i[Symbol.iterator]),A.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(y,E){f["[object "+E+"]"]=E.toLowerCase()});function me(y){var E=!!y&&"length"in y&&y.length,U=K(y);return x(y)||L(y)?!1:U==="array"||E===0||typeof E=="number"&&E>0&&E-1 in y}function fe(y,E){return y.nodeName&&y.nodeName.toLowerCase()===E.toLowerCase()}var J=i.pop,ye=i.sort,Oe=i.splice,ot="[\\x20\\t\\r\\n\\f]",Tt=new RegExp("^"+ot+"+|((?:^|[^\\\\])(?:\\\\.)*)"+ot+"+$","g");A.contains=function(y,E){var U=E&&E.parentNode;return y===U||!!(U&&U.nodeType===1&&(y.contains?y.contains(U):y.compareDocumentPosition&&y.compareDocumentPosition(U)&16))};var dt=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\x80-\uFFFF\w-]/g;function kt(y,E){return E?y==="\0"?"ï¿½":y.slice(0,-1)+"\\"+y.charCodeAt(y.length-1).toString(16)+" ":"\\"+y}A.escapeSelector=function(y){return(y+"").replace(dt,kt)};var $e=F,vt=c;(function(){var y,E,U,q,Z,Q=vt,ae,Pe,Se,je,at,_t=A.expando,Je=0,At=0,Si=Tl(),rs=Tl(),Fi=Tl(),Xn=Tl(),An=function(be,Re){return be===Re&&(Z=!0),0},co="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",la="(?:\\\\[\\da-fA-F]{1,6}"+ot+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",Yi="\\["+ot+"*("+la+")(?:"+ot+"*([*^$|!~]?=)"+ot+`*(?:'((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)"|(`+la+"))|)"+ot+"*\\]",yu=":("+la+`)(?:\\((('((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)")|((?:\\\\.|[^\\\\()[\\]]|`+Yi+")*)|.*)\\)|)",ls=new RegExp(ot+"+","g"),Qs=new RegExp("^"+ot+"*,"+ot+"*"),Hs=new RegExp("^"+ot+"*([>+~]|"+ot+")"+ot+"*"),Od=new RegExp(ot+"|>"),fo=new RegExp(yu),Fd=new RegExp("^"+la+"$"),Ra={ID:new RegExp("^#("+la+")"),CLASS:new RegExp("^\\.("+la+")"),TAG:new RegExp("^("+la+"|[*])"),ATTR:new RegExp("^"+Yi),PSEUDO:new RegExp("^"+yu),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+ot+"*(even|odd|(([+-]|)(\\d*)n|)"+ot+"*(?:([+-]|)"+ot+"*(\\d+)|))"+ot+"*\\)|)","i"),bool:new RegExp("^(?:"+co+")$","i"),needsContext:new RegExp("^"+ot+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+ot+"*((?:-\\d)?\\d*)"+ot+"*\\)|)(?=[^-]|$)","i")},Fo=/^(?:input|select|textarea|button)$/i,ua=/^h\d$/i,qr=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ug=/[+~]/,Kn=new RegExp("\\\\[\\da-fA-F]{1,6}"+ot+"?|\\\\([^\\r\\n\\f])","g"),vn=function(be,Re){var Qe="0x"+be.slice(1)-65536;return Re||(Qe<0?String.fromCharCode(Qe+65536):String.fromCharCode(Qe>>10|55296,Qe&1023|56320))},Vh=function(){po()},wr=Bd(function(be){return be.disabled===!0&&fe(be,"fieldset")},{dir:"parentNode",next:"legend"});function Rx(){try{return ae.activeElement}catch{}}try{Q.apply(i=o.call($e.childNodes),$e.childNodes),i[$e.childNodes.length].nodeType}catch{Q={apply:function(Re,Qe){vt.apply(Re,o.call(Qe))},call:function(Re){vt.apply(Re,o.call(arguments,1))}}}function ms(be,Re,Qe,st){var gt,Lt,zt,ei,Wt,Gi,yi,xi=Re&&Re.ownerDocument,Xi=Re?Re.nodeType:9;if(Qe=Qe||[],typeof be!="string"||!be||Xi!==1&&Xi!==9&&Xi!==11)return Qe;if(!st&&(po(Re),Re=Re||ae,Se)){if(Xi!==11&&(Wt=qr.exec(be)))if(gt=Wt[1]){if(Xi===9)if(zt=Re.getElementById(gt)){if(zt.id===gt)return Q.call(Qe,zt),Qe}else return Qe;else if(xi&&(zt=xi.getElementById(gt))&&ms.contains(Re,zt)&&zt.id===gt)return Q.call(Qe,zt),Qe}else{if(Wt[2])return Q.apply(Qe,Re.getElementsByTagName(be)),Qe;if((gt=Wt[3])&&Re.getElementsByClassName)return Q.apply(Qe,Re.getElementsByClassName(gt)),Qe}if(!Xn[be+" "]&&(!je||!je.test(be))){if(yi=be,xi=Re,Xi===1&&(Od.test(be)||Hs.test(be))){for(xi=ug.test(be)&&T_(Re.parentNode)||Re,(xi!=Re||!P.scope)&&((ei=Re.getAttribute("id"))?ei=A.escapeSelector(ei):Re.setAttribute("id",ei=_t)),Gi=zh(be),Lt=Gi.length;Lt--;)Gi[Lt]=(ei?"#"+ei:":scope")+" "+hg(Gi[Lt]);yi=Gi.join(",")}try{return Q.apply(Qe,xi.querySelectorAll(yi)),Qe}catch{Xn(be,!0)}finally{ei===_t&&Re.removeAttribute("id")}}}return rr(be.replace(Tt,"$1"),Re,Qe,st)}function Tl(){var be=[];function Re(Qe,st){return be.push(Qe+" ")>E.cacheLength&&delete Re[be.shift()],Re[Qe+" "]=st}return Re}function ha(be){return be[_t]=!0,be}function El(be){var Re=ae.createElement("fieldset");try{return!!be(Re)}catch{return!1}finally{Re.parentNode&&Re.parentNode.removeChild(Re),Re=null}}function Gr(be){return function(Re){return fe(Re,"input")&&Re.type===be}}function w_(be){return function(Re){return(fe(Re,"input")||fe(Re,"button"))&&Re.type===be}}function $h(be){return function(Re){return"form"in Re?Re.parentNode&&Re.disabled===!1?"label"in Re?"label"in Re.parentNode?Re.parentNode.disabled===be:Re.disabled===be:Re.isDisabled===be||Re.isDisabled!==!be&&wr(Re)===be:Re.disabled===be:"label"in Re?Re.disabled===be:!1}}function Ma(be){return ha(function(Re){return Re=+Re,ha(function(Qe,st){for(var gt,Lt=be([],Qe.length,Re),zt=Lt.length;zt--;)Qe[gt=Lt[zt]]&&(Qe[gt]=!(st[gt]=Qe[gt]))})})}function T_(be){return be&&typeof be.getElementsByTagName<"u"&&be}function po(be){var Re,Qe=be?be.ownerDocument||be:$e;return Qe==ae||Qe.nodeType!==9||!Qe.documentElement||(ae=Qe,Pe=ae.documentElement,Se=!A.isXMLDoc(ae),at=Pe.matches||Pe.webkitMatchesSelector||Pe.msMatchesSelector,Pe.msMatchesSelector&&$e!=ae&&(Re=ae.defaultView)&&Re.top!==Re&&Re.addEventListener("unload",Vh),P.getById=El(function(st){return Pe.appendChild(st).id=A.expando,!ae.getElementsByName||!ae.getElementsByName(A.expando).length}),P.disconnectedMatch=El(function(st){return at.call(st,"*")}),P.scope=El(function(){return ae.querySelectorAll(":scope")}),P.cssHas=El(function(){try{return ae.querySelector(":has(*,:jqfake)"),!1}catch{return!0}}),P.getById?(E.filter.ID=function(st){var gt=st.replace(Kn,vn);return function(Lt){return Lt.getAttribute("id")===gt}},E.find.ID=function(st,gt){if(typeof gt.getElementById<"u"&&Se){var Lt=gt.getElementById(st);return Lt?[Lt]:[]}}):(E.filter.ID=function(st){var gt=st.replace(Kn,vn);return function(Lt){var zt=typeof Lt.getAttributeNode<"u"&&Lt.getAttributeNode("id");return zt&&zt.value===gt}},E.find.ID=function(st,gt){if(typeof gt.getElementById<"u"&&Se){var Lt,zt,ei,Wt=gt.getElementById(st);if(Wt){if(Lt=Wt.getAttributeNode("id"),Lt&&Lt.value===st)return[Wt];for(ei=gt.getElementsByName(st),zt=0;Wt=ei[zt++];)if(Lt=Wt.getAttributeNode("id"),Lt&&Lt.value===st)return[Wt]}return[]}}),E.find.TAG=function(st,gt){return typeof gt.getElementsByTagName<"u"?gt.getElementsByTagName(st):gt.querySelectorAll(st)},E.find.CLASS=function(st,gt){if(typeof gt.getElementsByClassName<"u"&&Se)return gt.getElementsByClassName(st)},je=[],El(function(st){var gt;Pe.appendChild(st).innerHTML="<a id='"+_t+"' href='' disabled='disabled'></a><select id='"+_t+"-\r\\' disabled='disabled'><option selected=''></option></select>",st.querySelectorAll("[selected]").length||je.push("\\["+ot+"*(?:value|"+co+")"),st.querySelectorAll("[id~="+_t+"-]").length||je.push("~="),st.querySelectorAll("a#"+_t+"+*").length||je.push(".#.+[+~]"),st.querySelectorAll(":checked").length||je.push(":checked"),gt=ae.createElement("input"),gt.setAttribute("type","hidden"),st.appendChild(gt).setAttribute("name","D"),Pe.appendChild(st).disabled=!0,st.querySelectorAll(":disabled").length!==2&&je.push(":enabled",":disabled"),gt=ae.createElement("input"),gt.setAttribute("name",""),st.appendChild(gt),st.querySelectorAll("[name='']").length||je.push("\\["+ot+"*name"+ot+"*="+ot+`*(?:''|"")`)}),P.cssHas||je.push(":has"),je=je.length&&new RegExp(je.join("|")),An=function(st,gt){if(st===gt)return Z=!0,0;var Lt=!st.compareDocumentPosition-!gt.compareDocumentPosition;return Lt||(Lt=(st.ownerDocument||st)==(gt.ownerDocument||gt)?st.compareDocumentPosition(gt):1,Lt&1||!P.sortDetached&&gt.compareDocumentPosition(st)===Lt?st===ae||st.ownerDocument==$e&&ms.contains($e,st)?-1:gt===ae||gt.ownerDocument==$e&&ms.contains($e,gt)?1:q?d.call(q,st)-d.call(q,gt):0:Lt&4?-1:1)}),ae}ms.matches=function(be,Re){return ms(be,null,null,Re)},ms.matchesSelector=function(be,Re){if(po(be),Se&&!Xn[Re+" "]&&(!je||!je.test(Re)))try{var Qe=at.call(be,Re);if(Qe||P.disconnectedMatch||be.document&&be.document.nodeType!==11)return Qe}catch{Xn(Re,!0)}return ms(Re,ae,null,[be]).length>0},ms.contains=function(be,Re){return(be.ownerDocument||be)!=ae&&po(be),A.contains(be,Re)},ms.attr=function(be,Re){(be.ownerDocument||be)!=ae&&po(be);var Qe=E.attrHandle[Re.toLowerCase()],st=Qe&&b.call(E.attrHandle,Re.toLowerCase())?Qe(be,Re,!Se):void 0;return st!==void 0?st:be.getAttribute(Re)},ms.error=function(be){throw new Error("Syntax error, unrecognized expression: "+be)},A.uniqueSort=function(be){var Re,Qe=[],st=0,gt=0;if(Z=!P.sortStable,q=!P.sortStable&&o.call(be,0),ye.call(be,An),Z){for(;Re=be[gt++];)Re===be[gt]&&(st=Qe.push(gt));for(;st--;)Oe.call(be,Qe[st],1)}return q=null,be},A.fn.uniqueSort=function(){return this.pushStack(A.uniqueSort(o.apply(this)))},E=A.expr={cacheLength:50,createPseudo:ha,match:Ra,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(be){return be[1]=be[1].replace(Kn,vn),be[3]=(be[3]||be[4]||be[5]||"").replace(Kn,vn),be[2]==="~="&&(be[3]=" "+be[3]+" "),be.slice(0,4)},CHILD:function(be){return be[1]=be[1].toLowerCase(),be[1].slice(0,3)==="nth"?(be[3]||ms.error(be[0]),be[4]=+(be[4]?be[5]+(be[6]||1):2*(be[3]==="even"||be[3]==="odd")),be[5]=+(be[7]+be[8]||be[3]==="odd")):be[3]&&ms.error(be[0]),be},PSEUDO:function(be){var Re,Qe=!be[6]&&be[2];return Ra.CHILD.test(be[0])?null:(be[3]?be[2]=be[4]||be[5]||"":Qe&&fo.test(Qe)&&(Re=zh(Qe,!0))&&(Re=Qe.indexOf(")",Qe.length-Re)-Qe.length)&&(be[0]=be[0].slice(0,Re),be[2]=Qe.slice(0,Re)),be.slice(0,3))}},filter:{TAG:function(be){var Re=be.replace(Kn,vn).toLowerCase();return be==="*"?function(){return!0}:function(Qe){return fe(Qe,Re)}},CLASS:function(be){var Re=Si[be+" "];return Re||(Re=new RegExp("(^|"+ot+")"+be+"("+ot+"|$)"))&&Si(be,function(Qe){return Re.test(typeof Qe.className=="string"&&Qe.className||typeof Qe.getAttribute<"u"&&Qe.getAttribute("class")||"")})},ATTR:function(be,Re,Qe){return function(st){var gt=ms.attr(st,be);return gt==null?Re==="!=":Re?(gt+="",Re==="="?gt===Qe:Re==="!="?gt!==Qe:Re==="^="?Qe&&gt.indexOf(Qe)===0:Re==="*="?Qe&&gt.indexOf(Qe)>-1:Re==="$="?Qe&&gt.slice(-Qe.length)===Qe:Re==="~="?(" "+gt.replace(ls," ")+" ").indexOf(Qe)>-1:Re==="|="?gt===Qe||gt.slice(0,Qe.length+1)===Qe+"-":!1):!0}},CHILD:function(be,Re,Qe,st,gt){var Lt=be.slice(0,3)!=="nth",zt=be.slice(-4)!=="last",ei=Re==="of-type";return st===1&&gt===0?function(Wt){return!!Wt.parentNode}:function(Wt,Gi,yi){var xi,Xi,fi,Ns,Fn,ar=Lt!==zt?"nextSibling":"previousSibling",ca=Wt.parentNode,Lr=ei&&Wt.nodeName.toLowerCase(),qh=!yi&&!ei,si=!1;if(ca){if(Lt){for(;ar;){for(fi=Wt;fi=fi[ar];)if(ei?fe(fi,Lr):fi.nodeType===1)return!1;Fn=ar=be==="only"&&!Fn&&"nextSibling"}return!0}if(Fn=[zt?ca.firstChild:ca.lastChild],zt&&qh){for(Xi=ca[_t]||(ca[_t]={}),xi=Xi[be]||[],Ns=xi[0]===Je&&xi[1],si=Ns&&xi[2],fi=Ns&&ca.childNodes[Ns];fi=++Ns&&fi&&fi[ar]||(si=Ns=0)||Fn.pop();)if(fi.nodeType===1&&++si&&fi===Wt){Xi[be]=[Je,Ns,si];break}}else if(qh&&(Xi=Wt[_t]||(Wt[_t]={}),xi=Xi[be]||[],Ns=xi[0]===Je&&xi[1],si=Ns),si===!1)for(;(fi=++Ns&&fi&&fi[ar]||(si=Ns=0)||Fn.pop())&&!((ei?fe(fi,Lr):fi.nodeType===1)&&++si&&(qh&&(Xi=fi[_t]||(fi[_t]={}),Xi[be]=[Je,si]),fi===Wt)););return si-=gt,si===st||si%st===0&&si/st>=0}}},PSEUDO:function(be,Re){var Qe,st=E.pseudos[be]||E.setFilters[be.toLowerCase()]||ms.error("unsupported pseudo: "+be);return st[_t]?st(Re):st.length>1?(Qe=[be,be,"",Re],E.setFilters.hasOwnProperty(be.toLowerCase())?ha(function(gt,Lt){for(var zt,ei=st(gt,Re),Wt=ei.length;Wt--;)zt=d.call(gt,ei[Wt]),gt[zt]=!(Lt[zt]=ei[Wt])}):function(gt){return st(gt,0,Qe)}):st}},pseudos:{not:ha(function(be){var Re=[],Qe=[],st=Wh(be.replace(Tt,"$1"));return st[_t]?ha(function(gt,Lt,zt,ei){for(var Wt,Gi=st(gt,null,ei,[]),yi=gt.length;yi--;)(Wt=Gi[yi])&&(gt[yi]=!(Lt[yi]=Wt))}):function(gt,Lt,zt){return Re[0]=gt,st(Re,null,zt,Qe),Re[0]=null,!Qe.pop()}}),has:ha(function(be){return function(Re){return ms(be,Re).length>0}}),contains:ha(function(be){return be=be.replace(Kn,vn),function(Re){return(Re.textContent||A.text(Re)).indexOf(be)>-1}}),lang:ha(function(be){return Fd.test(be||"")||ms.error("unsupported lang: "+be),be=be.replace(Kn,vn).toLowerCase(),function(Re){var Qe;do if(Qe=Se?Re.lang:Re.getAttribute("xml:lang")||Re.getAttribute("lang"))return Qe=Qe.toLowerCase(),Qe===be||Qe.indexOf(be+"-")===0;while((Re=Re.parentNode)&&Re.nodeType===1);return!1}}),target:function(be){var Re=g.location&&g.location.hash;return Re&&Re.slice(1)===be.id},root:function(be){return be===Pe},focus:function(be){return be===Rx()&&ae.hasFocus()&&!!(be.type||be.href||~be.tabIndex)},enabled:$h(!1),disabled:$h(!0),checked:function(be){return fe(be,"input")&&!!be.checked||fe(be,"option")&&!!be.selected},selected:function(be){return be.parentNode&&be.parentNode.selectedIndex,be.selected===!0},empty:function(be){for(be=be.firstChild;be;be=be.nextSibling)if(be.nodeType<6)return!1;return!0},parent:function(be){return!E.pseudos.empty(be)},header:function(be){return ua.test(be.nodeName)},input:function(be){return Fo.test(be.nodeName)},button:function(be){return fe(be,"input")&&be.type==="button"||fe(be,"button")},text:function(be){var Re;return fe(be,"input")&&be.type==="text"&&((Re=be.getAttribute("type"))==null||Re.toLowerCase()==="text")},first:Ma(function(){return[0]}),last:Ma(function(be,Re){return[Re-1]}),eq:Ma(function(be,Re,Qe){return[Qe<0?Qe+Re:Qe]}),even:Ma(function(be,Re){for(var Qe=0;Qe<Re;Qe+=2)be.push(Qe);return be}),odd:Ma(function(be,Re){for(var Qe=1;Qe<Re;Qe+=2)be.push(Qe);return be}),lt:Ma(function(be,Re,Qe){var st;for(Qe<0?st=Qe+Re:Qe>Re?st=Re:st=Qe;--st>=0;)be.push(st);return be}),gt:Ma(function(be,Re,Qe){for(var st=Qe<0?Qe+Re:Qe;++st<Re;)be.push(st);return be})}},E.pseudos.nth=E.pseudos.eq;for(y in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})E.pseudos[y]=Gr(y);for(y in{submit:!0,reset:!0})E.pseudos[y]=w_(y);function vT(){}vT.prototype=E.filters=E.pseudos,E.setFilters=new vT;function zh(be,Re){var Qe,st,gt,Lt,zt,ei,Wt,Gi=rs[be+" "];if(Gi)return Re?0:Gi.slice(0);for(zt=be,ei=[],Wt=E.preFilter;zt;){(!Qe||(st=Qs.exec(zt)))&&(st&&(zt=zt.slice(st[0].length)||zt),ei.push(gt=[])),Qe=!1,(st=Hs.exec(zt))&&(Qe=st.shift(),gt.push({value:Qe,type:st[0].replace(Tt," ")}),zt=zt.slice(Qe.length));for(Lt in E.filter)(st=Ra[Lt].exec(zt))&&(!Wt[Lt]||(st=Wt[Lt](st)))&&(Qe=st.shift(),gt.push({value:Qe,type:Lt,matches:st}),zt=zt.slice(Qe.length));if(!Qe)break}return Re?zt.length:zt?ms.error(be):rs(be,ei).slice(0)}function hg(be){for(var Re=0,Qe=be.length,st="";Re<Qe;Re++)st+=be[Re].value;return st}function Bd(be,Re,Qe){var st=Re.dir,gt=Re.next,Lt=gt||st,zt=Qe&&Lt==="parentNode",ei=At++;return Re.first?function(Wt,Gi,yi){for(;Wt=Wt[st];)if(Wt.nodeType===1||zt)return be(Wt,Gi,yi);return!1}:function(Wt,Gi,yi){var xi,Xi,fi=[Je,ei];if(yi){for(;Wt=Wt[st];)if((Wt.nodeType===1||zt)&&be(Wt,Gi,yi))return!0}else for(;Wt=Wt[st];)if(Wt.nodeType===1||zt)if(Xi=Wt[_t]||(Wt[_t]={}),gt&&fe(Wt,gt))Wt=Wt[st]||Wt;else{if((xi=Xi[Lt])&&xi[0]===Je&&xi[1]===ei)return fi[2]=xi[2];if(Xi[Lt]=fi,fi[2]=be(Wt,Gi,yi))return!0}return!1}}function cg(be){return be.length>1?function(Re,Qe,st){for(var gt=be.length;gt--;)if(!be[gt](Re,Qe,st))return!1;return!0}:be[0]}function wT(be,Re,Qe){for(var st=0,gt=Re.length;st<gt;st++)ms(be,Re[st],Qe);return Qe}function dg(be,Re,Qe,st,gt){for(var Lt,zt=[],ei=0,Wt=be.length,Gi=Re!=null;ei<Wt;ei++)(Lt=be[ei])&&(!Qe||Qe(Lt,st,gt))&&(zt.push(Lt),Gi&&Re.push(ei));return zt}function E_(be,Re,Qe,st,gt,Lt){return st&&!st[_t]&&(st=E_(st)),gt&&!gt[_t]&&(gt=E_(gt,Lt)),ha(function(zt,ei,Wt,Gi){var yi,xi,Xi,fi,Ns=[],Fn=[],ar=ei.length,ca=zt||wT(Re||"*",Wt.nodeType?[Wt]:Wt,[]),Lr=be&&(zt||!Re)?dg(ca,Ns,be,Wt,Gi):ca;if(Qe?(fi=gt||(zt?be:ar||st)?[]:ei,Qe(Lr,fi,Wt,Gi)):fi=Lr,st)for(yi=dg(fi,Fn),st(yi,[],Wt,Gi),xi=yi.length;xi--;)(Xi=yi[xi])&&(fi[Fn[xi]]=!(Lr[Fn[xi]]=Xi));if(zt){if(gt||be){if(gt){for(yi=[],xi=fi.length;xi--;)(Xi=fi[xi])&&yi.push(Lr[xi]=Xi);gt(null,fi=[],yi,Gi)}for(xi=fi.length;xi--;)(Xi=fi[xi])&&(yi=gt?d.call(zt,Xi):Ns[xi])>-1&&(zt[yi]=!(ei[yi]=Xi))}}else fi=dg(fi===ei?fi.splice(ar,fi.length):fi),gt?gt(null,ei,fi,Gi):Q.apply(ei,fi)})}function S_(be){for(var Re,Qe,st,gt=be.length,Lt=E.relative[be[0].type],zt=Lt||E.relative[" "],ei=Lt?1:0,Wt=Bd(function(xi){return xi===Re},zt,!0),Gi=Bd(function(xi){return d.call(Re,xi)>-1},zt,!0),yi=[function(xi,Xi,fi){var Ns=!Lt&&(fi||Xi!=U)||((Re=Xi).nodeType?Wt(xi,Xi,fi):Gi(xi,Xi,fi));return Re=null,Ns}];ei<gt;ei++)if(Qe=E.relative[be[ei].type])yi=[Bd(cg(yi),Qe)];else{if(Qe=E.filter[be[ei].type].apply(null,be[ei].matches),Qe[_t]){for(st=++ei;st<gt&&!E.relative[be[st].type];st++);return E_(ei>1&&cg(yi),ei>1&&hg(be.slice(0,ei-1).concat({value:be[ei-2].type===" "?"*":""})).replace(Tt,"$1"),Qe,ei<st&&S_(be.slice(ei,st)),st<gt&&S_(be=be.slice(st)),st<gt&&hg(be))}yi.push(Qe)}return cg(yi)}function fg(be,Re){var Qe=Re.length>0,st=be.length>0,gt=function(Lt,zt,ei,Wt,Gi){var yi,xi,Xi,fi=0,Ns="0",Fn=Lt&&[],ar=[],ca=U,Lr=Lt||st&&E.find.TAG("*",Gi),qh=Je+=ca==null?1:Math.random()||.1,si=Lr.length;for(Gi&&(U=zt==ae||zt||Gi);Ns!==si&&(yi=Lr[Ns])!=null;Ns++){if(st&&yi){for(xi=0,!zt&&yi.ownerDocument!=ae&&(po(yi),ei=!Se);Xi=be[xi++];)if(Xi(yi,zt||ae,ei)){Q.call(Wt,yi);break}Gi&&(Je=qh)}Qe&&((yi=!Xi&&yi)&&fi--,Lt&&Fn.push(yi))}if(fi+=Ns,Qe&&Ns!==fi){for(xi=0;Xi=Re[xi++];)Xi(Fn,ar,zt,ei);if(Lt){if(fi>0)for(;Ns--;)Fn[Ns]||ar[Ns]||(ar[Ns]=J.call(Wt));ar=dg(ar)}Q.apply(Wt,ar),Gi&&!Lt&&ar.length>0&&fi+Re.length>1&&A.uniqueSort(Wt)}return Gi&&(Je=qh,U=ca),Fn};return Qe?ha(gt):gt}function Wh(be,Re){var Qe,st=[],gt=[],Lt=Fi[be+" "];if(!Lt){for(Re||(Re=zh(be)),Qe=Re.length;Qe--;)Lt=S_(Re[Qe]),Lt[_t]?st.push(Lt):gt.push(Lt);Lt=Fi(be,fg(gt,st)),Lt.selector=be}return Lt}function rr(be,Re,Qe,st){var gt,Lt,zt,ei,Wt,Gi=typeof be=="function"&&be,yi=!st&&zh(be=Gi.selector||be);if(Qe=Qe||[],yi.length===1){if(Lt=yi[0]=yi[0].slice(0),Lt.length>2&&(zt=Lt[0]).type==="ID"&&Re.nodeType===9&&Se&&E.relative[Lt[1].type]){if(Re=(E.find.ID(zt.matches[0].replace(Kn,vn),Re)||[])[0],Re)Gi&&(Re=Re.parentNode);else return Qe;be=be.slice(Lt.shift().value.length)}for(gt=Ra.needsContext.test(be)?0:Lt.length;gt--&&(zt=Lt[gt],!E.relative[ei=zt.type]);)if((Wt=E.find[ei])&&(st=Wt(zt.matches[0].replace(Kn,vn),ug.test(Lt[0].type)&&T_(Re.parentNode)||Re))){if(Lt.splice(gt,1),be=st.length&&hg(Lt),!be)return Q.apply(Qe,st),Qe;break}}return(Gi||Wh(be,yi))(st,Re,!Se,Qe,!Re||ug.test(be)&&T_(Re.parentNode)||Re),Qe}P.sortStable=_t.split("").sort(An).join("")===_t,po(),P.sortDetached=El(function(be){return be.compareDocumentPosition(ae.createElement("fieldset"))&1}),A.find=ms,A.expr[":"]=A.expr.pseudos,A.unique=A.uniqueSort,ms.compile=Wh,ms.select=rr,ms.setDocument=po,ms.tokenize=zh,ms.escape=A.escapeSelector,ms.getText=A.text,ms.isXML=A.isXMLDoc,ms.selectors=A.expr,ms.support=A.support,ms.uniqueSort=A.uniqueSort})();var Jt=function(y,E,U){for(var q=[],Z=U!==void 0;(y=y[E])&&y.nodeType!==9;)if(y.nodeType===1){if(Z&&A(y).is(U))break;q.push(y)}return q},di=function(y,E){for(var U=[];y;y=y.nextSibling)y.nodeType===1&&y!==E&&U.push(y);return U},Ut=A.expr.match.needsContext,ui=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function qt(y,E,U){return x(E)?A.grep(y,function(q,Z){return!!E.call(q,Z,q)!==U}):E.nodeType?A.grep(y,function(q){return q===E!==U}):typeof E!="string"?A.grep(y,function(q){return d.call(E,q)>-1!==U}):A.filter(E,y,U)}A.filter=function(y,E,U){var q=E[0];return U&&(y=":not("+y+")"),E.length===1&&q.nodeType===1?A.find.matchesSelector(q,y)?[q]:[]:A.find.matches(y,A.grep(E,function(Z){return Z.nodeType===1}))},A.fn.extend({find:function(y){var E,U,q=this.length,Z=this;if(typeof y!="string")return this.pushStack(A(y).filter(function(){for(E=0;E<q;E++)if(A.contains(Z[E],this))return!0}));for(U=this.pushStack([]),E=0;E<q;E++)A.find(y,Z[E],U);return q>1?A.uniqueSort(U):U},filter:function(y){return this.pushStack(qt(this,y||[],!1))},not:function(y){return this.pushStack(qt(this,y||[],!0))},is:function(y){return!!qt(this,typeof y=="string"&&Ut.test(y)?A(y):y||[],!1).length}});var Ze,ki=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/,wi=A.fn.init=function(y,E,U){var q,Z;if(!y)return this;if(U=U||Ze,typeof y=="string")if(y[0]==="<"&&y[y.length-1]===">"&&y.length>=3?q=[null,y,null]:q=ki.exec(y),q&&(q[1]||!E))if(q[1]){if(E=E instanceof A?E[0]:E,A.merge(this,A.parseHTML(q[1],E&&E.nodeType?E.ownerDocument||E:F,!0)),ui.test(q[1])&&A.isPlainObject(E))for(q in E)x(this[q])?this[q](E[q]):this.attr(q,E[q]);return this}else return Z=F.getElementById(q[2]),Z&&(this[0]=Z,this.length=1),this;else return!E||E.jquery?(E||U).find(y):this.constructor(E).find(y);else{if(y.nodeType)return this[0]=y,this.length=1,this;if(x(y))return U.ready!==void 0?U.ready(y):y(A)}return A.makeArray(y,this)};wi.prototype=A.fn,Ze=A(F);var jt=/^(?:parents|prev(?:Until|All))/,Yt={children:!0,contents:!0,next:!0,prev:!0};A.fn.extend({has:function(y){var E=A(y,this),U=E.length;return this.filter(function(){for(var q=0;q<U;q++)if(A.contains(this,E[q]))return!0})},closest:function(y,E){var U,q=0,Z=this.length,Q=[],ae=typeof y!="string"&&A(y);if(!Ut.test(y)){for(;q<Z;q++)for(U=this[q];U&&U!==E;U=U.parentNode)if(U.nodeType<11&&(ae?ae.index(U)>-1:U.nodeType===1&&A.find.matchesSelector(U,y))){Q.push(U);break}}return this.pushStack(Q.length>1?A.uniqueSort(Q):Q)},index:function(y){return y?typeof y=="string"?d.call(A(y),this[0]):d.call(this,y.jquery?y[0]:y):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(y,E){return this.pushStack(A.uniqueSort(A.merge(this.get(),A(y,E))))},addBack:function(y){return this.add(y==null?this.prevObject:this.prevObject.filter(y))}});function Ei(y,E){for(;(y=y[E])&&y.nodeType!==1;);return y}A.each({parent:function(y){var E=y.parentNode;return E&&E.nodeType!==11?E:null},parents:function(y){return Jt(y,"parentNode")},parentsUntil:function(y,E,U){return Jt(y,"parentNode",U)},next:function(y){return Ei(y,"nextSibling")},prev:function(y){return Ei(y,"previousSibling")},nextAll:function(y){return Jt(y,"nextSibling")},prevAll:function(y){return Jt(y,"previousSibling")},nextUntil:function(y,E,U){return Jt(y,"nextSibling",U)},prevUntil:function(y,E,U){return Jt(y,"previousSibling",U)},siblings:function(y){return di((y.parentNode||{}).firstChild,y)},children:function(y){return di(y.firstChild)},contents:function(y){return y.contentDocument!=null&&n(y.contentDocument)?y.contentDocument:(fe(y,"template")&&(y=y.content||y),A.merge([],y.childNodes))}},function(y,E){A.fn[y]=function(U,q){var Z=A.map(this,E,U);return y.slice(-5)!=="Until"&&(q=U),q&&typeof q=="string"&&(Z=A.filter(q,Z)),this.length>1&&(Yt[y]||A.uniqueSort(Z),jt.test(y)&&Z.reverse()),this.pushStack(Z)}});var ii=/[^\x20\t\r\n\f]+/g;function hi(y){var E={};return A.each(y.match(ii)||[],function(U,q){E[q]=!0}),E}A.Callbacks=function(y){y=typeof y=="string"?hi(y):A.extend({},y);var E,U,q,Z,Q=[],ae=[],Pe=-1,Se=function(){for(Z=Z||y.once,q=E=!0;ae.length;Pe=-1)for(U=ae.shift();++Pe<Q.length;)Q[Pe].apply(U[0],U[1])===!1&&y.stopOnFalse&&(Pe=Q.length,U=!1);y.memory||(U=!1),E=!1,Z&&(U?Q=[]:Q="")},je={add:function(){return Q&&(U&&!E&&(Pe=Q.length-1,ae.push(U)),function at(_t){A.each(_t,function(Je,At){x(At)?(!y.unique||!je.has(At))&&Q.push(At):At&&At.length&&K(At)!=="string"&&at(At)})}(arguments),U&&!E&&Se()),this},remove:function(){return A.each(arguments,function(at,_t){for(var Je;(Je=A.inArray(_t,Q,Je))>-1;)Q.splice(Je,1),Je<=Pe&&Pe--}),this},has:function(at){return at?A.inArray(at,Q)>-1:Q.length>0},empty:function(){return Q&&(Q=[]),this},disable:function(){return Z=ae=[],Q=U="",this},disabled:function(){return!Q},lock:function(){return Z=ae=[],!U&&!E&&(Q=U=""),this},locked:function(){return!!Z},fireWith:function(at,_t){return Z||(_t=_t||[],_t=[at,_t.slice?_t.slice():_t],ae.push(_t),E||Se()),this},fire:function(){return je.fireWith(this,arguments),this},fired:function(){return!!q}};return je};function Gt(y){return y}function es(y){throw y}function js(y,E,U,q){var Z;try{y&&x(Z=y.promise)?Z.call(y).done(E).fail(U):y&&x(Z=y.then)?Z.call(y,E,U):E.apply(void 0,[y].slice(q))}catch(Q){U.apply(void 0,[Q])}}A.extend({Deferred:function(y){var E=[["notify","progress",A.Callbacks("memory"),A.Callbacks("memory"),2],["resolve","done",A.Callbacks("once memory"),A.Callbacks("once memory"),0,"resolved"],["reject","fail",A.Callbacks("once memory"),A.Callbacks("once memory"),1,"rejected"]],U="pending",q={state:function(){return U},always:function(){return Z.done(arguments).fail(arguments),this},catch:function(Q){return q.then(null,Q)},pipe:function(){var Q=arguments;return A.Deferred(function(ae){A.each(E,function(Pe,Se){var je=x(Q[Se[4]])&&Q[Se[4]];Z[Se[1]](function(){var at=je&&je.apply(this,arguments);at&&x(at.promise)?at.promise().progress(ae.notify).done(ae.resolve).fail(ae.reject):ae[Se[0]+"With"](this,je?[at]:arguments)})}),Q=null}).promise()},then:function(Q,ae,Pe){var Se=0;function je(at,_t,Je,At){return function(){var Si=this,rs=arguments,Fi=function(){var An,co;if(!(at<Se)){if(An=Je.apply(Si,rs),An===_t.promise())throw new TypeError("Thenable self-resolution");co=An&&(typeof An=="object"||typeof An=="function")&&An.then,x(co)?At?co.call(An,je(Se,_t,Gt,At),je(Se,_t,es,At)):(Se++,co.call(An,je(Se,_t,Gt,At),je(Se,_t,es,At),je(Se,_t,Gt,_t.notifyWith))):(Je!==Gt&&(Si=void 0,rs=[An]),(At||_t.resolveWith)(Si,rs))}},Xn=At?Fi:function(){try{Fi()}catch(An){A.Deferred.exceptionHook&&A.Deferred.exceptionHook(An,Xn.error),at+1>=Se&&(Je!==es&&(Si=void 0,rs=[An]),_t.rejectWith(Si,rs))}};at?Xn():(A.Deferred.getErrorHook?Xn.error=A.Deferred.getErrorHook():A.Deferred.getStackHook&&(Xn.error=A.Deferred.getStackHook()),g.setTimeout(Xn))}}return A.Deferred(function(at){E[0][3].add(je(0,at,x(Pe)?Pe:Gt,at.notifyWith)),E[1][3].add(je(0,at,x(Q)?Q:Gt)),E[2][3].add(je(0,at,x(ae)?ae:es))}).promise()},promise:function(Q){return Q!=null?A.extend(Q,q):q}},Z={};return A.each(E,function(Q,ae){var Pe=ae[2],Se=ae[5];q[ae[1]]=Pe.add,Se&&Pe.add(function(){U=Se},E[3-Q][2].disable,E[3-Q][3].disable,E[0][2].lock,E[0][3].lock),Pe.add(ae[3].fire),Z[ae[0]]=function(){return Z[ae[0]+"With"](this===Z?void 0:this,arguments),this},Z[ae[0]+"With"]=Pe.fireWith}),q.promise(Z),y&&y.call(Z,Z),Z},when:function(y){var E=arguments.length,U=E,q=Array(U),Z=o.call(arguments),Q=A.Deferred(),ae=function(Pe){return function(Se){q[Pe]=this,Z[Pe]=arguments.length>1?o.call(arguments):Se,--E||Q.resolveWith(q,Z)}};if(E<=1&&(js(y,Q.done(ae(U)).resolve,Q.reject,!E),Q.state()==="pending"||x(Z[U]&&Z[U].then)))return Q.then();for(;U--;)js(Z[U],ae(U),Q.reject);return Q.promise()}});var ps=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;A.Deferred.exceptionHook=function(y,E){g.console&&g.console.warn&&y&&ps.test(y.name)&&g.console.warn("jQuery.Deferred exception: "+y.message,y.stack,E)},A.readyException=function(y){g.setTimeout(function(){throw y})};var mi=A.Deferred();A.fn.ready=function(y){return mi.then(y).catch(function(E){A.readyException(E)}),this},A.extend({isReady:!1,readyWait:1,ready:function(y){(y===!0?--A.readyWait:A.isReady)||(A.isReady=!0,!(y!==!0&&--A.readyWait>0)&&mi.resolveWith(F,[A]))}}),A.ready.then=mi.then;function $i(){F.removeEventListener("DOMContentLoaded",$i),g.removeEventListener("load",$i),A.ready()}F.readyState==="complete"||F.readyState!=="loading"&&!F.documentElement.doScroll?g.setTimeout(A.ready):(F.addEventListener("DOMContentLoaded",$i),g.addEventListener("load",$i));var ws=function(y,E,U,q,Z,Q,ae){var Pe=0,Se=y.length,je=U==null;if(K(U)==="object"){Z=!0;for(Pe in U)ws(y,E,Pe,U[Pe],!0,Q,ae)}else if(q!==void 0&&(Z=!0,x(q)||(ae=!0),je&&(ae?(E.call(y,q),E=null):(je=E,E=function(at,_t,Je){return je.call(A(at),Je)})),E))for(;Pe<Se;Pe++)E(y[Pe],U,ae?q:q.call(y[Pe],Pe,E(y[Pe],U)));return Z?y:je?E.call(y):Se?E(y[0],U):Q},pn=/^-ms-/,Mt=/-([a-z])/g;function Mi(y,E){return E.toUpperCase()}function Fe(y){return y.replace(pn,"ms-").replace(Mt,Mi)}var Pi=function(y){return y.nodeType===1||y.nodeType===9||!+y.nodeType};function qs(){this.expando=A.expando+qs.uid++}qs.uid=1,qs.prototype={cache:function(y){var E=y[this.expando];return E||(E={},Pi(y)&&(y.nodeType?y[this.expando]=E:Object.defineProperty(y,this.expando,{value:E,configurable:!0}))),E},set:function(y,E,U){var q,Z=this.cache(y);if(typeof E=="string")Z[Fe(E)]=U;else for(q in E)Z[Fe(q)]=E[q];return Z},get:function(y,E){return E===void 0?this.cache(y):y[this.expando]&&y[this.expando][Fe(E)]},access:function(y,E,U){return E===void 0||E&&typeof E=="string"&&U===void 0?this.get(y,E):(this.set(y,E,U),U!==void 0?U:E)},remove:function(y,E){var U,q=y[this.expando];if(q!==void 0){if(E!==void 0)for(Array.isArray(E)?E=E.map(Fe):(E=Fe(E),E=E in q?[E]:E.match(ii)||[]),U=E.length;U--;)delete q[E[U]];(E===void 0||A.isEmptyObject(q))&&(y.nodeType?y[this.expando]=void 0:delete y[this.expando])}},hasData:function(y){var E=y[this.expando];return E!==void 0&&!A.isEmptyObject(E)}};var Bt=new qs,ts=new qs,de=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Te=/[A-Z]/g;function Me(y){return y==="true"?!0:y==="false"?!1:y==="null"?null:y===+y+""?+y:de.test(y)?JSON.parse(y):y}function Xe(y,E,U){var q;if(U===void 0&&y.nodeType===1)if(q="data-"+E.replace(Te,"-$&").toLowerCase(),U=y.getAttribute(q),typeof U=="string"){try{U=Me(U)}catch{}ts.set(y,E,U)}else U=void 0;return U}A.extend({hasData:function(y){return ts.hasData(y)||Bt.hasData(y)},data:function(y,E,U){return ts.access(y,E,U)},removeData:function(y,E){ts.remove(y,E)},_data:function(y,E,U){return Bt.access(y,E,U)},_removeData:function(y,E){Bt.remove(y,E)}}),A.fn.extend({data:function(y,E){var U,q,Z,Q=this[0],ae=Q&&Q.attributes;if(y===void 0){if(this.length&&(Z=ts.get(Q),Q.nodeType===1&&!Bt.get(Q,"hasDataAttrs"))){for(U=ae.length;U--;)ae[U]&&(q=ae[U].name,q.indexOf("data-")===0&&(q=Fe(q.slice(5)),Xe(Q,q,Z[q])));Bt.set(Q,"hasDataAttrs",!0)}return Z}return typeof y=="object"?this.each(function(){ts.set(this,y)}):ws(this,function(Pe){var Se;if(Q&&Pe===void 0)return Se=ts.get(Q,y),Se!==void 0||(Se=Xe(Q,y),Se!==void 0)?Se:void 0;this.each(function(){ts.set(this,y,Pe)})},null,E,arguments.length>1,null,!0)},removeData:function(y){return this.each(function(){ts.remove(this,y)})}}),A.extend({queue:function(y,E,U){var q;if(y)return E=(E||"fx")+"queue",q=Bt.get(y,E),U&&(!q||Array.isArray(U)?q=Bt.access(y,E,A.makeArray(U)):q.push(U)),q||[]},dequeue:function(y,E){E=E||"fx";var U=A.queue(y,E),q=U.length,Z=U.shift(),Q=A._queueHooks(y,E),ae=function(){A.dequeue(y,E)};Z==="inprogress"&&(Z=U.shift(),q--),Z&&(E==="fx"&&U.unshift("inprogress"),delete Q.stop,Z.call(y,ae,Q)),!q&&Q&&Q.empty.fire()},_queueHooks:function(y,E){var U=E+"queueHooks";return Bt.get(y,U)||Bt.access(y,U,{empty:A.Callbacks("once memory").add(function(){Bt.remove(y,[E+"queue",U])})})}}),A.fn.extend({queue:function(y,E){var U=2;return typeof y!="string"&&(E=y,y="fx",U--),arguments.length<U?A.queue(this[0],y):E===void 0?this:this.each(function(){var q=A.queue(this,y,E);A._queueHooks(this,y),y==="fx"&&q[0]!=="inprogress"&&A.dequeue(this,y)})},dequeue:function(y){return this.each(function(){A.dequeue(this,y)})},clearQueue:function(y){return this.queue(y||"fx",[])},promise:function(y,E){var U,q=1,Z=A.Deferred(),Q=this,ae=this.length,Pe=function(){--q||Z.resolveWith(Q,[Q])};for(typeof y!="string"&&(E=y,y=void 0),y=y||"fx";ae--;)U=Bt.get(Q[ae],y+"queueHooks"),U&&U.empty&&(q++,U.empty.add(Pe));return Pe(),Z.promise(E)}});var mt=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,ft=new RegExp("^(?:([+-])=|)("+mt+")([a-z%]*)$","i"),wt=["Top","Right","Bottom","Left"],$t=F.documentElement,oe=function(y){return A.contains(y.ownerDocument,y)},et={composed:!0};$t.getRootNode&&(oe=function(y){return A.contains(y.ownerDocument,y)||y.getRootNode(et)===y.ownerDocument});var ht=function(y,E){return y=E||y,y.style.display==="none"||y.style.display===""&&oe(y)&&A.css(y,"display")==="none"};function pt(y,E,U,q){var Z,Q,ae=20,Pe=q?function(){return q.cur()}:function(){return A.css(y,E,"")},Se=Pe(),je=U&&U[3]||(A.cssNumber[E]?"":"px"),at=y.nodeType&&(A.cssNumber[E]||je!=="px"&&+Se)&&ft.exec(A.css(y,E));if(at&&at[3]!==je){for(Se=Se/2,je=je||at[3],at=+Se||1;ae--;)A.style(y,E,at+je),(1-Q)*(1-(Q=Pe()/Se||.5))<=0&&(ae=0),at=at/Q;at=at*2,A.style(y,E,at+je),U=U||[]}return U&&(at=+at||+Se||0,Z=U[1]?at+(U[1]+1)*U[2]:+U[2],q&&(q.unit=je,q.start=at,q.end=Z)),Z}var ke={};function He(y){var E,U=y.ownerDocument,q=y.nodeName,Z=ke[q];return Z||(E=U.body.appendChild(U.createElement(q)),Z=A.css(E,"display"),E.parentNode.removeChild(E),Z==="none"&&(Z="block"),ke[q]=Z,Z)}function ne(y,E){for(var U,q,Z=[],Q=0,ae=y.length;Q<ae;Q++)q=y[Q],q.style&&(U=q.style.display,E?(U==="none"&&(Z[Q]=Bt.get(q,"display")||null,Z[Q]||(q.style.display="")),q.style.display===""&&ht(q)&&(Z[Q]=He(q))):U!=="none"&&(Z[Q]="none",Bt.set(q,"display",U)));for(Q=0;Q<ae;Q++)Z[Q]!=null&&(y[Q].style.display=Z[Q]);return y}A.fn.extend({show:function(){return ne(this,!0)},hide:function(){return ne(this)},toggle:function(y){return typeof y=="boolean"?y?this.show():this.hide():this.each(function(){ht(this)?A(this).show():A(this).hide()})}});var tt=/^(?:checkbox|radio)$/i,xt=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,z=/^$|^module$|\/(?:java|ecma)script/i;(function(){var y=F.createDocumentFragment(),E=y.appendChild(F.createElement("div")),U=F.createElement("input");U.setAttribute("type","radio"),U.setAttribute("checked","checked"),U.setAttribute("name","t"),E.appendChild(U),P.checkClone=E.cloneNode(!0).cloneNode(!0).lastChild.checked,E.innerHTML="<textarea>x</textarea>",P.noCloneChecked=!!E.cloneNode(!0).lastChild.defaultValue,E.innerHTML="<option></option>",P.option=!!E.lastChild})();var We={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};We.tbody=We.tfoot=We.colgroup=We.caption=We.thead,We.th=We.td,P.option||(We.optgroup=We.option=[1,"<select multiple='multiple'>","</select>"]);function qe(y,E){var U;return typeof y.getElementsByTagName<"u"?U=y.getElementsByTagName(E||"*"):typeof y.querySelectorAll<"u"?U=y.querySelectorAll(E||"*"):U=[],E===void 0||E&&fe(y,E)?A.merge([y],U):U}function le(y,E){for(var U=0,q=y.length;U<q;U++)Bt.set(y[U],"globalEval",!E||Bt.get(E[U],"globalEval"))}var De=/<|&#?\w+;/;function Ge(y,E,U,q,Z){for(var Q,ae,Pe,Se,je,at,_t=E.createDocumentFragment(),Je=[],At=0,Si=y.length;At<Si;At++)if(Q=y[At],Q||Q===0)if(K(Q)==="object")A.merge(Je,Q.nodeType?[Q]:Q);else if(!De.test(Q))Je.push(E.createTextNode(Q));else{for(ae=ae||_t.appendChild(E.createElement("div")),Pe=(xt.exec(Q)||["",""])[1].toLowerCase(),Se=We[Pe]||We._default,ae.innerHTML=Se[1]+A.htmlPrefilter(Q)+Se[2],at=Se[0];at--;)ae=ae.lastChild;A.merge(Je,ae.childNodes),ae=_t.firstChild,ae.textContent=""}for(_t.textContent="",At=0;Q=Je[At++];){if(q&&A.inArray(Q,q)>-1){Z&&Z.push(Q);continue}if(je=oe(Q),ae=qe(_t.appendChild(Q),"script"),je&&le(ae),U)for(at=0;Q=ae[at++];)z.test(Q.type||"")&&U.push(Q)}return _t}var Ot=/^([^.]*)(?:\.(.+)|)/;function Ct(){return!0}function It(){return!1}function ni(y,E,U,q,Z,Q){var ae,Pe;if(typeof E=="object"){typeof U!="string"&&(q=q||U,U=void 0);for(Pe in E)ni(y,Pe,U,q,E[Pe],Q);return y}if(q==null&&Z==null?(Z=U,q=U=void 0):Z==null&&(typeof U=="string"?(Z=q,q=void 0):(Z=q,q=U,U=void 0)),Z===!1)Z=It;else if(!Z)return y;return Q===1&&(ae=Z,Z=function(Se){return A().off(Se),ae.apply(this,arguments)},Z.guid=ae.guid||(ae.guid=A.guid++)),y.each(function(){A.event.add(this,E,Z,q,U)})}A.event={global:{},add:function(y,E,U,q,Z){var Q,ae,Pe,Se,je,at,_t,Je,At,Si,rs,Fi=Bt.get(y);if(Pi(y))for(U.handler&&(Q=U,U=Q.handler,Z=Q.selector),Z&&A.find.matchesSelector($t,Z),U.guid||(U.guid=A.guid++),(Se=Fi.events)||(Se=Fi.events=Object.create(null)),(ae=Fi.handle)||(ae=Fi.handle=function(Xn){return typeof A<"u"&&A.event.triggered!==Xn.type?A.event.dispatch.apply(y,arguments):void 0}),E=(E||"").match(ii)||[""],je=E.length;je--;)Pe=Ot.exec(E[je])||[],At=rs=Pe[1],Si=(Pe[2]||"").split(".").sort(),At&&(_t=A.event.special[At]||{},At=(Z?_t.delegateType:_t.bindType)||At,_t=A.event.special[At]||{},at=A.extend({type:At,origType:rs,data:q,handler:U,guid:U.guid,selector:Z,needsContext:Z&&A.expr.match.needsContext.test(Z),namespace:Si.join(".")},Q),(Je=Se[At])||(Je=Se[At]=[],Je.delegateCount=0,(!_t.setup||_t.setup.call(y,q,Si,ae)===!1)&&y.addEventListener&&y.addEventListener(At,ae)),_t.add&&(_t.add.call(y,at),at.handler.guid||(at.handler.guid=U.guid)),Z?Je.splice(Je.delegateCount++,0,at):Je.push(at),A.event.global[At]=!0)},remove:function(y,E,U,q,Z){var Q,ae,Pe,Se,je,at,_t,Je,At,Si,rs,Fi=Bt.hasData(y)&&Bt.get(y);if(!(!Fi||!(Se=Fi.events))){for(E=(E||"").match(ii)||[""],je=E.length;je--;){if(Pe=Ot.exec(E[je])||[],At=rs=Pe[1],Si=(Pe[2]||"").split(".").sort(),!At){for(At in Se)A.event.remove(y,At+E[je],U,q,!0);continue}for(_t=A.event.special[At]||{},At=(q?_t.delegateType:_t.bindType)||At,Je=Se[At]||[],Pe=Pe[2]&&new RegExp("(^|\\.)"+Si.join("\\.(?:.*\\.|)")+"(\\.|$)"),ae=Q=Je.length;Q--;)at=Je[Q],(Z||rs===at.origType)&&(!U||U.guid===at.guid)&&(!Pe||Pe.test(at.namespace))&&(!q||q===at.selector||q==="**"&&at.selector)&&(Je.splice(Q,1),at.selector&&Je.delegateCount--,_t.remove&&_t.remove.call(y,at));ae&&!Je.length&&((!_t.teardown||_t.teardown.call(y,Si,Fi.handle)===!1)&&A.removeEvent(y,At,Fi.handle),delete Se[At])}A.isEmptyObject(Se)&&Bt.remove(y,"handle events")}},dispatch:function(y){var E,U,q,Z,Q,ae,Pe=new Array(arguments.length),Se=A.event.fix(y),je=(Bt.get(this,"events")||Object.create(null))[Se.type]||[],at=A.event.special[Se.type]||{};for(Pe[0]=Se,E=1;E<arguments.length;E++)Pe[E]=arguments[E];if(Se.delegateTarget=this,!(at.preDispatch&&at.preDispatch.call(this,Se)===!1)){for(ae=A.event.handlers.call(this,Se,je),E=0;(Z=ae[E++])&&!Se.isPropagationStopped();)for(Se.currentTarget=Z.elem,U=0;(Q=Z.handlers[U++])&&!Se.isImmediatePropagationStopped();)(!Se.rnamespace||Q.namespace===!1||Se.rnamespace.test(Q.namespace))&&(Se.handleObj=Q,Se.data=Q.data,q=((A.event.special[Q.origType]||{}).handle||Q.handler).apply(Z.elem,Pe),q!==void 0&&(Se.result=q)===!1&&(Se.preventDefault(),Se.stopPropagation()));return at.postDispatch&&at.postDispatch.call(this,Se),Se.result}},handlers:function(y,E){var U,q,Z,Q,ae,Pe=[],Se=E.delegateCount,je=y.target;if(Se&&je.nodeType&&!(y.type==="click"&&y.button>=1)){for(;je!==this;je=je.parentNode||this)if(je.nodeType===1&&!(y.type==="click"&&je.disabled===!0)){for(Q=[],ae={},U=0;U<Se;U++)q=E[U],Z=q.selector+" ",ae[Z]===void 0&&(ae[Z]=q.needsContext?A(Z,this).index(je)>-1:A.find(Z,this,null,[je]).length),ae[Z]&&Q.push(q);Q.length&&Pe.push({elem:je,handlers:Q})}}return je=this,Se<E.length&&Pe.push({elem:je,handlers:E.slice(Se)}),Pe},addProp:function(y,E){Object.defineProperty(A.Event.prototype,y,{enumerable:!0,configurable:!0,get:x(E)?function(){if(this.originalEvent)return E(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[y]},set:function(U){Object.defineProperty(this,y,{enumerable:!0,configurable:!0,writable:!0,value:U})}})},fix:function(y){return y[A.expando]?y:new A.Event(y)},special:{load:{noBubble:!0},click:{setup:function(y){var E=this||y;return tt.test(E.type)&&E.click&&fe(E,"input")&&Zs(E,"click",!0),!1},trigger:function(y){var E=this||y;return tt.test(E.type)&&E.click&&fe(E,"input")&&Zs(E,"click"),!0},_default:function(y){var E=y.target;return tt.test(E.type)&&E.click&&fe(E,"input")&&Bt.get(E,"click")||fe(E,"a")}},beforeunload:{postDispatch:function(y){y.result!==void 0&&y.originalEvent&&(y.originalEvent.returnValue=y.result)}}}};function Zs(y,E,U){if(!U){Bt.get(y,E)===void 0&&A.event.add(y,E,Ct);return}Bt.set(y,E,!1),A.event.add(y,E,{namespace:!1,handler:function(q){var Z,Q=Bt.get(this,E);if(q.isTrigger&1&&this[E]){if(Q)(A.event.special[E]||{}).delegateType&&q.stopPropagation();else if(Q=o.call(arguments),Bt.set(this,E,Q),this[E](),Z=Bt.get(this,E),Bt.set(this,E,!1),Q!==Z)return q.stopImmediatePropagation(),q.preventDefault(),Z}else Q&&(Bt.set(this,E,A.event.trigger(Q[0],Q.slice(1),this)),q.stopPropagation(),q.isImmediatePropagationStopped=Ct)}})}A.removeEvent=function(y,E,U){y.removeEventListener&&y.removeEventListener(E,U)},A.Event=function(y,E){if(!(this instanceof A.Event))return new A.Event(y,E);y&&y.type?(this.originalEvent=y,this.type=y.type,this.isDefaultPrevented=y.defaultPrevented||y.defaultPrevented===void 0&&y.returnValue===!1?Ct:It,this.target=y.target&&y.target.nodeType===3?y.target.parentNode:y.target,this.currentTarget=y.currentTarget,this.relatedTarget=y.relatedTarget):this.type=y,E&&A.extend(this,E),this.timeStamp=y&&y.timeStamp||Date.now(),this[A.expando]=!0},A.Event.prototype={constructor:A.Event,isDefaultPrevented:It,isPropagationStopped:It,isImmediatePropagationStopped:It,isSimulated:!1,preventDefault:function(){var y=this.originalEvent;this.isDefaultPrevented=Ct,y&&!this.isSimulated&&y.preventDefault()},stopPropagation:function(){var y=this.originalEvent;this.isPropagationStopped=Ct,y&&!this.isSimulated&&y.stopPropagation()},stopImmediatePropagation:function(){var y=this.originalEvent;this.isImmediatePropagationStopped=Ct,y&&!this.isSimulated&&y.stopImmediatePropagation(),this.stopPropagation()}},A.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},A.event.addProp),A.each({focus:"focusin",blur:"focusout"},function(y,E){function U(q){if(F.documentMode){var Z=Bt.get(this,"handle"),Q=A.event.fix(q);Q.type=q.type==="focusin"?"focus":"blur",Q.isSimulated=!0,Z(q),Q.target===Q.currentTarget&&Z(Q)}else A.event.simulate(E,q.target,A.event.fix(q))}A.event.special[y]={setup:function(){var q;if(Zs(this,y,!0),F.documentMode)q=Bt.get(this,E),q||this.addEventListener(E,U),Bt.set(this,E,(q||0)+1);else return!1},trigger:function(){return Zs(this,y),!0},teardown:function(){var q;if(F.documentMode)q=Bt.get(this,E)-1,q?Bt.set(this,E,q):(this.removeEventListener(E,U),Bt.remove(this,E));else return!1},_default:function(q){return Bt.get(q.target,y)},delegateType:E},A.event.special[E]={setup:function(){var q=this.ownerDocument||this.document||this,Z=F.documentMode?this:q,Q=Bt.get(Z,E);Q||(F.documentMode?this.addEventListener(E,U):q.addEventListener(y,U,!0)),Bt.set(Z,E,(Q||0)+1)},teardown:function(){var q=this.ownerDocument||this.document||this,Z=F.documentMode?this:q,Q=Bt.get(Z,E)-1;Q?Bt.set(Z,E,Q):(F.documentMode?this.removeEventListener(E,U):q.removeEventListener(y,U,!0),Bt.remove(Z,E))}}}),A.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(y,E){A.event.special[y]={delegateType:E,bindType:E,handle:function(U){var q,Z=this,Q=U.relatedTarget,ae=U.handleObj;return(!Q||Q!==Z&&!A.contains(Z,Q))&&(U.type=ae.origType,q=ae.handler.apply(this,arguments),U.type=E),q}}}),A.fn.extend({on:function(y,E,U,q){return ni(this,y,E,U,q)},one:function(y,E,U,q){return ni(this,y,E,U,q,1)},off:function(y,E,U){var q,Z;if(y&&y.preventDefault&&y.handleObj)return q=y.handleObj,A(y.delegateTarget).off(q.namespace?q.origType+"."+q.namespace:q.origType,q.selector,q.handler),this;if(typeof y=="object"){for(Z in y)this.off(Z,E,y[Z]);return this}return(E===!1||typeof E=="function")&&(U=E,E=void 0),U===!1&&(U=It),this.each(function(){A.event.remove(this,y,U,E)})}});var bi=/<script|<style|<link/i,Oi=/checked\s*(?:[^=]|=\s*.checked.)/i,gs=/^\s*<!\[CDATA\[|\]\]>\s*$/g;function qi(y,E){return fe(y,"table")&&fe(E.nodeType!==11?E:E.firstChild,"tr")&&A(y).children("tbody")[0]||y}function Gs(y){return y.type=(y.getAttribute("type")!==null)+"/"+y.type,y}function Mn(y){return(y.type||"").slice(0,5)==="true/"?y.type=y.type.slice(5):y.removeAttribute("type"),y}function Sn(y,E){var U,q,Z,Q,ae,Pe,Se;if(E.nodeType===1){if(Bt.hasData(y)&&(Q=Bt.get(y),Se=Q.events,Se)){Bt.remove(E,"handle events");for(Z in Se)for(U=0,q=Se[Z].length;U<q;U++)A.event.add(E,Z,Se[Z][U])}ts.hasData(y)&&(ae=ts.access(y),Pe=A.extend({},ae),ts.set(E,Pe))}}function ji(y,E){var U=E.nodeName.toLowerCase();U==="input"&&tt.test(y.type)?E.checked=y.checked:(U==="input"||U==="textarea")&&(E.defaultValue=y.defaultValue)}function os(y,E,U,q){E=l(E);var Z,Q,ae,Pe,Se,je,at=0,_t=y.length,Je=_t-1,At=E[0],Si=x(At);if(Si||_t>1&&typeof At=="string"&&!P.checkClone&&Oi.test(At))return y.each(function(rs){var Fi=y.eq(rs);Si&&(E[0]=At.call(this,rs,Fi.html())),os(Fi,E,U,q)});if(_t&&(Z=Ge(E,y[0].ownerDocument,!1,y,q),Q=Z.firstChild,Z.childNodes.length===1&&(Z=Q),Q||q)){for(ae=A.map(qe(Z,"script"),Gs),Pe=ae.length;at<_t;at++)Se=Z,at!==Je&&(Se=A.clone(Se,!0,!0),Pe&&A.merge(ae,qe(Se,"script"))),U.call(y[at],Se,at);if(Pe)for(je=ae[ae.length-1].ownerDocument,A.map(ae,Mn),at=0;at<Pe;at++)Se=ae[at],z.test(Se.type||"")&&!Bt.access(Se,"globalEval")&&A.contains(je,Se)&&(Se.src&&(Se.type||"").toLowerCase()!=="module"?A._evalUrl&&!Se.noModule&&A._evalUrl(Se.src,{nonce:Se.nonce||Se.getAttribute("nonce")},je):re(Se.textContent.replace(gs,""),Se,je))}return y}function Ts(y,E,U){for(var q,Z=E?A.filter(E,y):y,Q=0;(q=Z[Q])!=null;Q++)!U&&q.nodeType===1&&A.cleanData(qe(q)),q.parentNode&&(U&&oe(q)&&le(qe(q,"script")),q.parentNode.removeChild(q));return y}A.extend({htmlPrefilter:function(y){return y},clone:function(y,E,U){var q,Z,Q,ae,Pe=y.cloneNode(!0),Se=oe(y);if(!P.noCloneChecked&&(y.nodeType===1||y.nodeType===11)&&!A.isXMLDoc(y))for(ae=qe(Pe),Q=qe(y),q=0,Z=Q.length;q<Z;q++)ji(Q[q],ae[q]);if(E)if(U)for(Q=Q||qe(y),ae=ae||qe(Pe),q=0,Z=Q.length;q<Z;q++)Sn(Q[q],ae[q]);else Sn(y,Pe);return ae=qe(Pe,"script"),ae.length>0&&le(ae,!Se&&qe(y,"script")),Pe},cleanData:function(y){for(var E,U,q,Z=A.event.special,Q=0;(U=y[Q])!==void 0;Q++)if(Pi(U)){if(E=U[Bt.expando]){if(E.events)for(q in E.events)Z[q]?A.event.remove(U,q):A.removeEvent(U,q,E.handle);U[Bt.expando]=void 0}U[ts.expando]&&(U[ts.expando]=void 0)}}}),A.fn.extend({detach:function(y){return Ts(this,y,!0)},remove:function(y){return Ts(this,y)},text:function(y){return ws(this,function(E){return E===void 0?A.text(this):this.empty().each(function(){(this.nodeType===1||this.nodeType===11||this.nodeType===9)&&(this.textContent=E)})},null,y,arguments.length)},append:function(){return os(this,arguments,function(y){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var E=qi(this,y);E.appendChild(y)}})},prepend:function(){return os(this,arguments,function(y){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var E=qi(this,y);E.insertBefore(y,E.firstChild)}})},before:function(){return os(this,arguments,function(y){this.parentNode&&this.parentNode.insertBefore(y,this)})},after:function(){return os(this,arguments,function(y){this.parentNode&&this.parentNode.insertBefore(y,this.nextSibling)})},empty:function(){for(var y,E=0;(y=this[E])!=null;E++)y.nodeType===1&&(A.cleanData(qe(y,!1)),y.textContent="");return this},clone:function(y,E){return y=y??!1,E=E??y,this.map(function(){return A.clone(this,y,E)})},html:function(y){return ws(this,function(E){var U=this[0]||{},q=0,Z=this.length;if(E===void 0&&U.nodeType===1)return U.innerHTML;if(typeof E=="string"&&!bi.test(E)&&!We[(xt.exec(E)||["",""])[1].toLowerCase()]){E=A.htmlPrefilter(E);try{for(;q<Z;q++)U=this[q]||{},U.nodeType===1&&(A.cleanData(qe(U,!1)),U.innerHTML=E);U=0}catch{}}U&&this.empty().append(E)},null,y,arguments.length)},replaceWith:function(){var y=[];return os(this,arguments,function(E){var U=this.parentNode;A.inArray(this,y)<0&&(A.cleanData(qe(this)),U&&U.replaceChild(E,this))},y)}}),A.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(y,E){A.fn[y]=function(U){for(var q,Z=[],Q=A(U),ae=Q.length-1,Pe=0;Pe<=ae;Pe++)q=Pe===ae?this:this.clone(!0),A(Q[Pe])[E](q),c.apply(Z,q.get());return this.pushStack(Z)}});var _s=new RegExp("^("+mt+")(?!px)[a-z%]+$","i"),ss=/^--/,sn=function(y){var E=y.ownerDocument.defaultView;return(!E||!E.opener)&&(E=g),E.getComputedStyle(y)},Ne=function(y,E,U){var q,Z,Q={};for(Z in E)Q[Z]=y.style[Z],y.style[Z]=E[Z];q=U.call(y);for(Z in E)y.style[Z]=Q[Z];return q},H=new RegExp(wt.join("|"),"i");(function(){function y(){if(je){Se.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",je.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",$t.appendChild(Se).appendChild(je);var at=g.getComputedStyle(je);U=at.top!=="1%",Pe=E(at.marginLeft)===12,je.style.right="60%",Q=E(at.right)===36,q=E(at.width)===36,je.style.position="absolute",Z=E(je.offsetWidth/3)===12,$t.removeChild(Se),je=null}}function E(at){return Math.round(parseFloat(at))}var U,q,Z,Q,ae,Pe,Se=F.createElement("div"),je=F.createElement("div");je.style&&(je.style.backgroundClip="content-box",je.cloneNode(!0).style.backgroundClip="",P.clearCloneStyle=je.style.backgroundClip==="content-box",A.extend(P,{boxSizingReliable:function(){return y(),q},pixelBoxStyles:function(){return y(),Q},pixelPosition:function(){return y(),U},reliableMarginLeft:function(){return y(),Pe},scrollboxSize:function(){return y(),Z},reliableTrDimensions:function(){var at,_t,Je,At;return ae==null&&(at=F.createElement("table"),_t=F.createElement("tr"),Je=F.createElement("div"),at.style.cssText="position:absolute;left:-11111px;border-collapse:separate",_t.style.cssText="box-sizing:content-box;border:1px solid",_t.style.height="1px",Je.style.height="9px",Je.style.display="block",$t.appendChild(at).appendChild(_t).appendChild(Je),At=g.getComputedStyle(_t),ae=parseInt(At.height,10)+parseInt(At.borderTopWidth,10)+parseInt(At.borderBottomWidth,10)===_t.offsetHeight,$t.removeChild(at)),ae}}))})();function ie(y,E,U){var q,Z,Q,ae,Pe=ss.test(E),Se=y.style;return U=U||sn(y),U&&(ae=U.getPropertyValue(E)||U[E],Pe&&ae&&(ae=ae.replace(Tt,"$1")||void 0),ae===""&&!oe(y)&&(ae=A.style(y,E)),!P.pixelBoxStyles()&&_s.test(ae)&&H.test(E)&&(q=Se.width,Z=Se.minWidth,Q=Se.maxWidth,Se.minWidth=Se.maxWidth=Se.width=ae,ae=U.width,Se.width=q,Se.minWidth=Z,Se.maxWidth=Q)),ae!==void 0?ae+"":ae}function Ce(y,E){return{get:function(){if(y()){delete this.get;return}return(this.get=E).apply(this,arguments)}}}var Ae=["Webkit","Moz","ms"],nt=F.createElement("div").style,Dt={};function Ai(y){for(var E=y[0].toUpperCase()+y.slice(1),U=Ae.length;U--;)if(y=Ae[U]+E,y in nt)return y}function Di(y){var E=A.cssProps[y]||Dt[y];return E||(y in nt?y:Dt[y]=Ai(y)||y)}var Ki=/^(none|table(?!-c[ea]).+)/,Es={position:"absolute",visibility:"hidden",display:"block"},Ht={letterSpacing:"0",fontWeight:"400"};function Xs(y,E,U){var q=ft.exec(E);return q?Math.max(0,q[2]-(U||0))+(q[3]||"px"):E}function ks(y,E,U,q,Z,Q){var ae=E==="width"?1:0,Pe=0,Se=0,je=0;if(U===(q?"border":"content"))return 0;for(;ae<4;ae+=2)U==="margin"&&(je+=A.css(y,U+wt[ae],!0,Z)),q?(U==="content"&&(Se-=A.css(y,"padding"+wt[ae],!0,Z)),U!=="margin"&&(Se-=A.css(y,"border"+wt[ae]+"Width",!0,Z))):(Se+=A.css(y,"padding"+wt[ae],!0,Z),U!=="padding"?Se+=A.css(y,"border"+wt[ae]+"Width",!0,Z):Pe+=A.css(y,"border"+wt[ae]+"Width",!0,Z));return!q&&Q>=0&&(Se+=Math.max(0,Math.ceil(y["offset"+E[0].toUpperCase()+E.slice(1)]-Q-Se-Pe-.5))||0),Se+je}function nn(y,E,U){var q=sn(y),Z=!P.boxSizingReliable()||U,Q=Z&&A.css(y,"boxSizing",!1,q)==="border-box",ae=Q,Pe=ie(y,E,q),Se="offset"+E[0].toUpperCase()+E.slice(1);if(_s.test(Pe)){if(!U)return Pe;Pe="auto"}return(!P.boxSizingReliable()&&Q||!P.reliableTrDimensions()&&fe(y,"tr")||Pe==="auto"||!parseFloat(Pe)&&A.css(y,"display",!1,q)==="inline")&&y.getClientRects().length&&(Q=A.css(y,"boxSizing",!1,q)==="border-box",ae=Se in y,ae&&(Pe=y[Se])),Pe=parseFloat(Pe)||0,Pe+ks(y,E,U||(Q?"border":"content"),ae,q,Pe)+"px"}A.extend({cssHooks:{opacity:{get:function(y,E){if(E){var U=ie(y,"opacity");return U===""?"1":U}}}},cssNumber:{animationIterationCount:!0,aspectRatio:!0,borderImageSlice:!0,columnCount:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,scale:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeMiterlimit:!0,strokeOpacity:!0},cssProps:{},style:function(y,E,U,q){if(!(!y||y.nodeType===3||y.nodeType===8||!y.style)){var Z,Q,ae,Pe=Fe(E),Se=ss.test(E),je=y.style;if(Se||(E=Di(Pe)),ae=A.cssHooks[E]||A.cssHooks[Pe],U!==void 0){if(Q=typeof U,Q==="string"&&(Z=ft.exec(U))&&Z[1]&&(U=pt(y,E,Z),Q="number"),U==null||U!==U)return;Q==="number"&&!Se&&(U+=Z&&Z[3]||(A.cssNumber[Pe]?"":"px")),!P.clearCloneStyle&&U===""&&E.indexOf("background")===0&&(je[E]="inherit"),(!ae||!("set"in ae)||(U=ae.set(y,U,q))!==void 0)&&(Se?je.setProperty(E,U):je[E]=U)}else return ae&&"get"in ae&&(Z=ae.get(y,!1,q))!==void 0?Z:je[E]}},css:function(y,E,U,q){var Z,Q,ae,Pe=Fe(E),Se=ss.test(E);return Se||(E=Di(Pe)),ae=A.cssHooks[E]||A.cssHooks[Pe],ae&&"get"in ae&&(Z=ae.get(y,!0,U)),Z===void 0&&(Z=ie(y,E,q)),Z==="normal"&&E in Ht&&(Z=Ht[E]),U===""||U?(Q=parseFloat(Z),U===!0||isFinite(Q)?Q||0:Z):Z}}),A.each(["height","width"],function(y,E){A.cssHooks[E]={get:function(U,q,Z){if(q)return Ki.test(A.css(U,"display"))&&(!U.getClientRects().length||!U.getBoundingClientRect().width)?Ne(U,Es,function(){return nn(U,E,Z)}):nn(U,E,Z)},set:function(U,q,Z){var Q,ae=sn(U),Pe=!P.scrollboxSize()&&ae.position==="absolute",Se=Pe||Z,je=Se&&A.css(U,"boxSizing",!1,ae)==="border-box",at=Z?ks(U,E,Z,je,ae):0;return je&&Pe&&(at-=Math.ceil(U["offset"+E[0].toUpperCase()+E.slice(1)]-parseFloat(ae[E])-ks(U,E,"border",!1,ae)-.5)),at&&(Q=ft.exec(q))&&(Q[3]||"px")!=="px"&&(U.style[E]=q,q=A.css(U,E)),Xs(U,q,at)}}}),A.cssHooks.marginLeft=Ce(P.reliableMarginLeft,function(y,E){if(E)return(parseFloat(ie(y,"marginLeft"))||y.getBoundingClientRect().left-Ne(y,{marginLeft:0},function(){return y.getBoundingClientRect().left}))+"px"}),A.each({margin:"",padding:"",border:"Width"},function(y,E){A.cssHooks[y+E]={expand:function(U){for(var q=0,Z={},Q=typeof U=="string"?U.split(" "):[U];q<4;q++)Z[y+wt[q]+E]=Q[q]||Q[q-2]||Q[0];return Z}},y!=="margin"&&(A.cssHooks[y+E].set=Xs)}),A.fn.extend({css:function(y,E){return ws(this,function(U,q,Z){var Q,ae,Pe={},Se=0;if(Array.isArray(q)){for(Q=sn(U),ae=q.length;Se<ae;Se++)Pe[q[Se]]=A.css(U,q[Se],!1,Q);return Pe}return Z!==void 0?A.style(U,q,Z):A.css(U,q)},y,E,arguments.length>1)}});function hs(y,E,U,q,Z){return new hs.prototype.init(y,E,U,q,Z)}A.Tween=hs,hs.prototype={constructor:hs,init:function(y,E,U,q,Z,Q){this.elem=y,this.prop=U,this.easing=Z||A.easing._default,this.options=E,this.start=this.now=this.cur(),this.end=q,this.unit=Q||(A.cssNumber[U]?"":"px")},cur:function(){var y=hs.propHooks[this.prop];return y&&y.get?y.get(this):hs.propHooks._default.get(this)},run:function(y){var E,U=hs.propHooks[this.prop];return this.options.duration?this.pos=E=A.easing[this.easing](y,this.options.duration*y,0,1,this.options.duration):this.pos=E=y,this.now=(this.end-this.start)*E+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),U&&U.set?U.set(this):hs.propHooks._default.set(this),this}},hs.prototype.init.prototype=hs.prototype,hs.propHooks={_default:{get:function(y){var E;return y.elem.nodeType!==1||y.elem[y.prop]!=null&&y.elem.style[y.prop]==null?y.elem[y.prop]:(E=A.css(y.elem,y.prop,""),!E||E==="auto"?0:E)},set:function(y){A.fx.step[y.prop]?A.fx.step[y.prop](y):y.elem.nodeType===1&&(A.cssHooks[y.prop]||y.elem.style[Di(y.prop)]!=null)?A.style(y.elem,y.prop,y.now+y.unit):y.elem[y.prop]=y.now}}},hs.propHooks.scrollTop=hs.propHooks.scrollLeft={set:function(y){y.elem.nodeType&&y.elem.parentNode&&(y.elem[y.prop]=y.now)}},A.easing={linear:function(y){return y},swing:function(y){return .5-Math.cos(y*Math.PI)/2},_default:"swing"},A.fx=hs.prototype.init,A.fx.step={};var yn,Gn,sr=/^(?:toggle|show|hide)$/,La=/queueHooks$/;function ue(){Gn&&(F.hidden===!1&&g.requestAnimationFrame?g.requestAnimationFrame(ue):g.setTimeout(ue,A.fx.interval),A.fx.tick())}function S(){return g.setTimeout(function(){yn=void 0}),yn=Date.now()}function k(y,E){var U,q=0,Z={height:y};for(E=E?1:0;q<4;q+=2-E)U=wt[q],Z["margin"+U]=Z["padding"+U]=y;return E&&(Z.opacity=Z.width=y),Z}function V(y,E,U){for(var q,Z=(rt.tweeners[E]||[]).concat(rt.tweeners["*"]),Q=0,ae=Z.length;Q<ae;Q++)if(q=Z[Q].call(U,E,y))return q}function he(y,E,U){var q,Z,Q,ae,Pe,Se,je,at,_t="width"in E||"height"in E,Je=this,At={},Si=y.style,rs=y.nodeType&&ht(y),Fi=Bt.get(y,"fxshow");U.queue||(ae=A._queueHooks(y,"fx"),ae.unqueued==null&&(ae.unqueued=0,Pe=ae.empty.fire,ae.empty.fire=function(){ae.unqueued||Pe()}),ae.unqueued++,Je.always(function(){Je.always(function(){ae.unqueued--,A.queue(y,"fx").length||ae.empty.fire()})}));for(q in E)if(Z=E[q],sr.test(Z)){if(delete E[q],Q=Q||Z==="toggle",Z===(rs?"hide":"show"))if(Z==="show"&&Fi&&Fi[q]!==void 0)rs=!0;else continue;At[q]=Fi&&Fi[q]||A.style(y,q)}if(Se=!A.isEmptyObject(E),!(!Se&&A.isEmptyObject(At))){_t&&y.nodeType===1&&(U.overflow=[Si.overflow,Si.overflowX,Si.overflowY],je=Fi&&Fi.display,je==null&&(je=Bt.get(y,"display")),at=A.css(y,"display"),at==="none"&&(je?at=je:(ne([y],!0),je=y.style.display||je,at=A.css(y,"display"),ne([y]))),(at==="inline"||at==="inline-block"&&je!=null)&&A.css(y,"float")==="none"&&(Se||(Je.done(function(){Si.display=je}),je==null&&(at=Si.display,je=at==="none"?"":at)),Si.display="inline-block")),U.overflow&&(Si.overflow="hidden",Je.always(function(){Si.overflow=U.overflow[0],Si.overflowX=U.overflow[1],Si.overflowY=U.overflow[2]})),Se=!1;for(q in At)Se||(Fi?"hidden"in Fi&&(rs=Fi.hidden):Fi=Bt.access(y,"fxshow",{display:je}),Q&&(Fi.hidden=!rs),rs&&ne([y],!0),Je.done(function(){rs||ne([y]),Bt.remove(y,"fxshow");for(q in At)A.style(y,q,At[q])})),Se=V(rs?Fi[q]:0,q,Je),q in Fi||(Fi[q]=Se.start,rs&&(Se.end=Se.start,Se.start=0))}}function we(y,E){var U,q,Z,Q,ae;for(U in y)if(q=Fe(U),Z=E[q],Q=y[U],Array.isArray(Q)&&(Z=Q[1],Q=y[U]=Q[0]),U!==q&&(y[q]=Q,delete y[U]),ae=A.cssHooks[q],ae&&"expand"in ae){Q=ae.expand(Q),delete y[q];for(U in Q)U in y||(y[U]=Q[U],E[U]=Z)}else E[q]=Z}function rt(y,E,U){var q,Z,Q=0,ae=rt.prefilters.length,Pe=A.Deferred().always(function(){delete Se.elem}),Se=function(){if(Z)return!1;for(var _t=yn||S(),Je=Math.max(0,je.startTime+je.duration-_t),At=Je/je.duration||0,Si=1-At,rs=0,Fi=je.tweens.length;rs<Fi;rs++)je.tweens[rs].run(Si);return Pe.notifyWith(y,[je,Si,Je]),Si<1&&Fi?Je:(Fi||Pe.notifyWith(y,[je,1,0]),Pe.resolveWith(y,[je]),!1)},je=Pe.promise({elem:y,props:A.extend({},E),opts:A.extend(!0,{specialEasing:{},easing:A.easing._default},U),originalProperties:E,originalOptions:U,startTime:yn||S(),duration:U.duration,tweens:[],createTween:function(_t,Je){var At=A.Tween(y,je.opts,_t,Je,je.opts.specialEasing[_t]||je.opts.easing);return je.tweens.push(At),At},stop:function(_t){var Je=0,At=_t?je.tweens.length:0;if(Z)return this;for(Z=!0;Je<At;Je++)je.tweens[Je].run(1);return _t?(Pe.notifyWith(y,[je,1,0]),Pe.resolveWith(y,[je,_t])):Pe.rejectWith(y,[je,_t]),this}}),at=je.props;for(we(at,je.opts.specialEasing);Q<ae;Q++)if(q=rt.prefilters[Q].call(je,y,at,je.opts),q)return x(q.stop)&&(A._queueHooks(je.elem,je.opts.queue).stop=q.stop.bind(q)),q;return A.map(at,V,je),x(je.opts.start)&&je.opts.start.call(y,je),je.progress(je.opts.progress).done(je.opts.done,je.opts.complete).fail(je.opts.fail).always(je.opts.always),A.fx.timer(A.extend(Se,{elem:y,anim:je,queue:je.opts.queue})),je}A.Animation=A.extend(rt,{tweeners:{"*":[function(y,E){var U=this.createTween(y,E);return pt(U.elem,y,ft.exec(E),U),U}]},tweener:function(y,E){x(y)?(E=y,y=["*"]):y=y.match(ii);for(var U,q=0,Z=y.length;q<Z;q++)U=y[q],rt.tweeners[U]=rt.tweeners[U]||[],rt.tweeners[U].unshift(E)},prefilters:[he],prefilter:function(y,E){E?rt.prefilters.unshift(y):rt.prefilters.push(y)}}),A.speed=function(y,E,U){var q=y&&typeof y=="object"?A.extend({},y):{complete:U||!U&&E||x(y)&&y,duration:y,easing:U&&E||E&&!x(E)&&E};return A.fx.off?q.duration=0:typeof q.duration!="number"&&(q.duration in A.fx.speeds?q.duration=A.fx.speeds[q.duration]:q.duration=A.fx.speeds._default),(q.queue==null||q.queue===!0)&&(q.queue="fx"),q.old=q.complete,q.complete=function(){x(q.old)&&q.old.call(this),q.queue&&A.dequeue(this,q.queue)},q},A.fn.extend({fadeTo:function(y,E,U,q){return this.filter(ht).css("opacity",0).show().end().animate({opacity:E},y,U,q)},animate:function(y,E,U,q){var Z=A.isEmptyObject(y),Q=A.speed(E,U,q),ae=function(){var Pe=rt(this,A.extend({},y),Q);(Z||Bt.get(this,"finish"))&&Pe.stop(!0)};return ae.finish=ae,Z||Q.queue===!1?this.each(ae):this.queue(Q.queue,ae)},stop:function(y,E,U){var q=function(Z){var Q=Z.stop;delete Z.stop,Q(U)};return typeof y!="string"&&(U=E,E=y,y=void 0),E&&this.queue(y||"fx",[]),this.each(function(){var Z=!0,Q=y!=null&&y+"queueHooks",ae=A.timers,Pe=Bt.get(this);if(Q)Pe[Q]&&Pe[Q].stop&&q(Pe[Q]);else for(Q in Pe)Pe[Q]&&Pe[Q].stop&&La.test(Q)&&q(Pe[Q]);for(Q=ae.length;Q--;)ae[Q].elem===this&&(y==null||ae[Q].queue===y)&&(ae[Q].anim.stop(U),Z=!1,ae.splice(Q,1));(Z||!U)&&A.dequeue(this,y)})},finish:function(y){return y!==!1&&(y=y||"fx"),this.each(function(){var E,U=Bt.get(this),q=U[y+"queue"],Z=U[y+"queueHooks"],Q=A.timers,ae=q?q.length:0;for(U.finish=!0,A.queue(this,y,[]),Z&&Z.stop&&Z.stop.call(this,!0),E=Q.length;E--;)Q[E].elem===this&&Q[E].queue===y&&(Q[E].anim.stop(!0),Q.splice(E,1));for(E=0;E<ae;E++)q[E]&&q[E].finish&&q[E].finish.call(this);delete U.finish})}}),A.each(["toggle","show","hide"],function(y,E){var U=A.fn[E];A.fn[E]=function(q,Z,Q){return q==null||typeof q=="boolean"?U.apply(this,arguments):this.animate(k(E,!0),q,Z,Q)}}),A.each({slideDown:k("show"),slideUp:k("hide"),slideToggle:k("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(y,E){A.fn[y]=function(U,q,Z){return this.animate(E,U,q,Z)}}),A.timers=[],A.fx.tick=function(){var y,E=0,U=A.timers;for(yn=Date.now();E<U.length;E++)y=U[E],!y()&&U[E]===y&&U.splice(E--,1);U.length||A.fx.stop(),yn=void 0},A.fx.timer=function(y){A.timers.push(y),A.fx.start()},A.fx.interval=13,A.fx.start=function(){Gn||(Gn=!0,ue())},A.fx.stop=function(){Gn=null},A.fx.speeds={slow:600,fast:200,_default:400},A.fn.delay=function(y,E){return y=A.fx&&A.fx.speeds[y]||y,E=E||"fx",this.queue(E,function(U,q){var Z=g.setTimeout(U,y);q.stop=function(){g.clearTimeout(Z)}})},function(){var y=F.createElement("input"),E=F.createElement("select"),U=E.appendChild(F.createElement("option"));y.type="checkbox",P.checkOn=y.value!=="",P.optSelected=U.selected,y=F.createElement("input"),y.value="t",y.type="radio",P.radioValue=y.value==="t"}();var Le,Rt=A.expr.attrHandle;A.fn.extend({attr:function(y,E){return ws(this,A.attr,y,E,arguments.length>1)},removeAttr:function(y){return this.each(function(){A.removeAttr(this,y)})}}),A.extend({attr:function(y,E,U){var q,Z,Q=y.nodeType;if(!(Q===3||Q===8||Q===2)){if(typeof y.getAttribute>"u")return A.prop(y,E,U);if((Q!==1||!A.isXMLDoc(y))&&(Z=A.attrHooks[E.toLowerCase()]||(A.expr.match.bool.test(E)?Le:void 0)),U!==void 0){if(U===null){A.removeAttr(y,E);return}return Z&&"set"in Z&&(q=Z.set(y,U,E))!==void 0?q:(y.setAttribute(E,U+""),U)}return Z&&"get"in Z&&(q=Z.get(y,E))!==null?q:(q=A.find.attr(y,E),q??void 0)}},attrHooks:{type:{set:function(y,E){if(!P.radioValue&&E==="radio"&&fe(y,"input")){var U=y.value;return y.setAttribute("type",E),U&&(y.value=U),E}}}},removeAttr:function(y,E){var U,q=0,Z=E&&E.match(ii);if(Z&&y.nodeType===1)for(;U=Z[q++];)y.removeAttribute(U)}}),Le={set:function(y,E,U){return E===!1?A.removeAttr(y,U):y.setAttribute(U,U),U}},A.each(A.expr.match.bool.source.match(/\w+/g),function(y,E){var U=Rt[E]||A.find.attr;Rt[E]=function(q,Z,Q){var ae,Pe,Se=Z.toLowerCase();return Q||(Pe=Rt[Se],Rt[Se]=ae,ae=U(q,Z,Q)!=null?Se:null,Rt[Se]=Pe),ae}});var Ls=/^(?:input|select|textarea|button)$/i,Ss=/^(?:a|area)$/i;A.fn.extend({prop:function(y,E){return ws(this,A.prop,y,E,arguments.length>1)},removeProp:function(y){return this.each(function(){delete this[A.propFix[y]||y]})}}),A.extend({prop:function(y,E,U){var q,Z,Q=y.nodeType;if(!(Q===3||Q===8||Q===2))return(Q!==1||!A.isXMLDoc(y))&&(E=A.propFix[E]||E,Z=A.propHooks[E]),U!==void 0?Z&&"set"in Z&&(q=Z.set(y,U,E))!==void 0?q:y[E]=U:Z&&"get"in Z&&(q=Z.get(y,E))!==null?q:y[E]},propHooks:{tabIndex:{get:function(y){var E=A.find.attr(y,"tabindex");return E?parseInt(E,10):Ls.test(y.nodeName)||Ss.test(y.nodeName)&&y.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),P.optSelected||(A.propHooks.selected={get:function(y){var E=y.parentNode;return E&&E.parentNode&&E.parentNode.selectedIndex,null},set:function(y){var E=y.parentNode;E&&(E.selectedIndex,E.parentNode&&E.parentNode.selectedIndex)}}),A.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){A.propFix[this.toLowerCase()]=this});function ns(y){var E=y.match(ii)||[];return E.join(" ")}function zi(y){return y.getAttribute&&y.getAttribute("class")||""}function On(y){return Array.isArray(y)?y:typeof y=="string"?y.match(ii)||[]:[]}A.fn.extend({addClass:function(y){var E,U,q,Z,Q,ae;return x(y)?this.each(function(Pe){A(this).addClass(y.call(this,Pe,zi(this)))}):(E=On(y),E.length?this.each(function(){if(q=zi(this),U=this.nodeType===1&&" "+ns(q)+" ",U){for(Q=0;Q<E.length;Q++)Z=E[Q],U.indexOf(" "+Z+" ")<0&&(U+=Z+" ");ae=ns(U),q!==ae&&this.setAttribute("class",ae)}}):this)},removeClass:function(y){var E,U,q,Z,Q,ae;return x(y)?this.each(function(Pe){A(this).removeClass(y.call(this,Pe,zi(this)))}):arguments.length?(E=On(y),E.length?this.each(function(){if(q=zi(this),U=this.nodeType===1&&" "+ns(q)+" ",U){for(Q=0;Q<E.length;Q++)for(Z=E[Q];U.indexOf(" "+Z+" ")>-1;)U=U.replace(" "+Z+" "," ");ae=ns(U),q!==ae&&this.setAttribute("class",ae)}}):this):this.attr("class","")},toggleClass:function(y,E){var U,q,Z,Q,ae=typeof y,Pe=ae==="string"||Array.isArray(y);return x(y)?this.each(function(Se){A(this).toggleClass(y.call(this,Se,zi(this),E),E)}):typeof E=="boolean"&&Pe?E?this.addClass(y):this.removeClass(y):(U=On(y),this.each(function(){if(Pe)for(Q=A(this),Z=0;Z<U.length;Z++)q=U[Z],Q.hasClass(q)?Q.removeClass(q):Q.addClass(q);else(y===void 0||ae==="boolean")&&(q=zi(this),q&&Bt.set(this,"__className__",q),this.setAttribute&&this.setAttribute("class",q||y===!1?"":Bt.get(this,"__className__")||""))}))},hasClass:function(y){var E,U,q=0;for(E=" "+y+" ";U=this[q++];)if(U.nodeType===1&&(" "+ns(zi(U))+" ").indexOf(E)>-1)return!0;return!1}});var Na=/\r/g;A.fn.extend({val:function(y){var E,U,q,Z=this[0];return arguments.length?(q=x(y),this.each(function(Q){var ae;this.nodeType===1&&(q?ae=y.call(this,Q,A(this).val()):ae=y,ae==null?ae="":typeof ae=="number"?ae+="":Array.isArray(ae)&&(ae=A.map(ae,function(Pe){return Pe==null?"":Pe+""})),E=A.valHooks[this.type]||A.valHooks[this.nodeName.toLowerCase()],(!E||!("set"in E)||E.set(this,ae,"value")===void 0)&&(this.value=ae))})):Z?(E=A.valHooks[Z.type]||A.valHooks[Z.nodeName.toLowerCase()],E&&"get"in E&&(U=E.get(Z,"value"))!==void 0?U:(U=Z.value,typeof U=="string"?U.replace(Na,""):U??"")):void 0}}),A.extend({valHooks:{option:{get:function(y){var E=A.find.attr(y,"value");return E??ns(A.text(y))}},select:{get:function(y){var E,U,q,Z=y.options,Q=y.selectedIndex,ae=y.type==="select-one",Pe=ae?null:[],Se=ae?Q+1:Z.length;for(Q<0?q=Se:q=ae?Q:0;q<Se;q++)if(U=Z[q],(U.selected||q===Q)&&!U.disabled&&(!U.parentNode.disabled||!fe(U.parentNode,"optgroup"))){if(E=A(U).val(),ae)return E;Pe.push(E)}return Pe},set:function(y,E){for(var U,q,Z=y.options,Q=A.makeArray(E),ae=Z.length;ae--;)q=Z[ae],(q.selected=A.inArray(A.valHooks.option.get(q),Q)>-1)&&(U=!0);return U||(y.selectedIndex=-1),Q}}}}),A.each(["radio","checkbox"],function(){A.valHooks[this]={set:function(y,E){if(Array.isArray(E))return y.checked=A.inArray(A(y).val(),E)>-1}},P.checkOn||(A.valHooks[this].get=function(y){return y.getAttribute("value")===null?"on":y.value})});var vr=g.location,xn={guid:Date.now()},Oo=/\?/;A.parseXML=function(y){var E,U;if(!y||typeof y!="string")return null;try{E=new g.DOMParser().parseFromString(y,"text/xml")}catch{}return U=E&&E.getElementsByTagName("parsererror")[0],(!E||U)&&A.error("Invalid XML: "+(U?A.map(U.childNodes,function(q){return q.textContent}).join(`
`):y)),E};var nr=/^(?:focusinfocus|focusoutblur)$/,bs=function(y){y.stopPropagation()};A.extend(A.event,{trigger:function(y,E,U,q){var Z,Q,ae,Pe,Se,je,at,_t,Je=[U||F],At=b.call(y,"type")?y.type:y,Si=b.call(y,"namespace")?y.namespace.split("."):[];if(Q=_t=ae=U=U||F,!(U.nodeType===3||U.nodeType===8)&&!nr.test(At+A.event.triggered)&&(At.indexOf(".")>-1&&(Si=At.split("."),At=Si.shift(),Si.sort()),Se=At.indexOf(":")<0&&"on"+At,y=y[A.expando]?y:new A.Event(At,typeof y=="object"&&y),y.isTrigger=q?2:3,y.namespace=Si.join("."),y.rnamespace=y.namespace?new RegExp("(^|\\.)"+Si.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,y.result=void 0,y.target||(y.target=U),E=E==null?[y]:A.makeArray(E,[y]),at=A.event.special[At]||{},!(!q&&at.trigger&&at.trigger.apply(U,E)===!1))){if(!q&&!at.noBubble&&!L(U)){for(Pe=at.delegateType||At,nr.test(Pe+At)||(Q=Q.parentNode);Q;Q=Q.parentNode)Je.push(Q),ae=Q;ae===(U.ownerDocument||F)&&Je.push(ae.defaultView||ae.parentWindow||g)}for(Z=0;(Q=Je[Z++])&&!y.isPropagationStopped();)_t=Q,y.type=Z>1?Pe:at.bindType||At,je=(Bt.get(Q,"events")||Object.create(null))[y.type]&&Bt.get(Q,"handle"),je&&je.apply(Q,E),je=Se&&Q[Se],je&&je.apply&&Pi(Q)&&(y.result=je.apply(Q,E),y.result===!1&&y.preventDefault());return y.type=At,!q&&!y.isDefaultPrevented()&&(!at._default||at._default.apply(Je.pop(),E)===!1)&&Pi(U)&&Se&&x(U[At])&&!L(U)&&(ae=U[Se],ae&&(U[Se]=null),A.event.triggered=At,y.isPropagationStopped()&&_t.addEventListener(At,bs),U[At](),y.isPropagationStopped()&&_t.removeEventListener(At,bs),A.event.triggered=void 0,ae&&(U[Se]=ae)),y.result}},simulate:function(y,E,U){var q=A.extend(new A.Event,U,{type:y,isSimulated:!0});A.event.trigger(q,null,E)}}),A.fn.extend({trigger:function(y,E){return this.each(function(){A.event.trigger(y,E,this)})},triggerHandler:function(y,E){var U=this[0];if(U)return A.event.trigger(y,E,U,!0)}});var ho=/\[\]$/,Wr=/\r?\n/g,Fh=/^(?:submit|button|image|reset|file)$/i,fT=/^(?:input|select|textarea|keygen)/i;function pT(y,E,U,q){var Z;if(Array.isArray(E))A.each(E,function(Q,ae){U||ho.test(y)?q(y,ae):pT(y+"["+(typeof ae=="object"&&ae!=null?Q:"")+"]",ae,U,q)});else if(!U&&K(E)==="object")for(Z in E)pT(y+"["+Z+"]",E[Z],U,q);else q(y,E)}A.param=function(y,E){var U,q=[],Z=function(Q,ae){var Pe=x(ae)?ae():ae;q[q.length]=encodeURIComponent(Q)+"="+encodeURIComponent(Pe??"")};if(y==null)return"";if(Array.isArray(y)||y.jquery&&!A.isPlainObject(y))A.each(y,function(){Z(this.name,this.value)});else for(U in y)pT(U,y[U],E,Z);return q.join("&")},A.fn.extend({serialize:function(){return A.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var y=A.prop(this,"elements");return y?A.makeArray(y):this}).filter(function(){var y=this.type;return this.name&&!A(this).is(":disabled")&&fT.test(this.nodeName)&&!Fh.test(y)&&(this.checked||!tt.test(y))}).map(function(y,E){var U=A(this).val();return U==null?null:Array.isArray(U)?A.map(U,function(q){return{name:E.name,value:q.replace(Wr,`\r
`)}}):{name:E.name,value:U.replace(Wr,`\r
`)}}).get()}});var f_=/%20/g,p_=/#.*$/,Bh=/([?&])_=[^&]*/,bu=/^(.*?):[ \t]*([^\r\n]*)$/mg,g_=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,gT=/^(?:GET|HEAD)$/,m_=/^\/\//,__={},Rd={},mT="*/".concat("*"),Uh=F.createElement("a");Uh.href=vr.href;function _T(y){return function(E,U){typeof E!="string"&&(U=E,E="*");var q,Z=0,Q=E.toLowerCase().match(ii)||[];if(x(U))for(;q=Q[Z++];)q[0]==="+"?(q=q.slice(1)||"*",(y[q]=y[q]||[]).unshift(U)):(y[q]=y[q]||[]).push(U)}}function bT(y,E,U,q){var Z={},Q=y===Rd;function ae(Pe){var Se;return Z[Pe]=!0,A.each(y[Pe]||[],function(je,at){var _t=at(E,U,q);if(typeof _t=="string"&&!Q&&!Z[_t])return E.dataTypes.unshift(_t),ae(_t),!1;if(Q)return!(Se=_t)}),Se}return ae(E.dataTypes[0])||!Z["*"]&&ae("*")}function b_(y,E){var U,q,Z=A.ajaxSettings.flatOptions||{};for(U in E)E[U]!==void 0&&((Z[U]?y:q||(q={}))[U]=E[U]);return q&&A.extend(!0,y,q),y}function yT(y,E,U){for(var q,Z,Q,ae,Pe=y.contents,Se=y.dataTypes;Se[0]==="*";)Se.shift(),q===void 0&&(q=y.mimeType||E.getResponseHeader("Content-Type"));if(q){for(Z in Pe)if(Pe[Z]&&Pe[Z].test(q)){Se.unshift(Z);break}}if(Se[0]in U)Q=Se[0];else{for(Z in U){if(!Se[0]||y.converters[Z+" "+Se[0]]){Q=Z;break}ae||(ae=Z)}Q=Q||ae}if(Q)return Q!==Se[0]&&Se.unshift(Q),U[Q]}function y_(y,E,U,q){var Z,Q,ae,Pe,Se,je={},at=y.dataTypes.slice();if(at[1])for(ae in y.converters)je[ae.toLowerCase()]=y.converters[ae];for(Q=at.shift();Q;)if(y.responseFields[Q]&&(U[y.responseFields[Q]]=E),!Se&&q&&y.dataFilter&&(E=y.dataFilter(E,y.dataType)),Se=Q,Q=at.shift(),Q){if(Q==="*")Q=Se;else if(Se!=="*"&&Se!==Q){if(ae=je[Se+" "+Q]||je["* "+Q],!ae){for(Z in je)if(Pe=Z.split(" "),Pe[1]===Q&&(ae=je[Se+" "+Pe[0]]||je["* "+Pe[0]],ae)){ae===!0?ae=je[Z]:je[Z]!==!0&&(Q=Pe[0],at.unshift(Pe[1]));break}}if(ae!==!0)if(ae&&y.throws)E=ae(E);else try{E=ae(E)}catch(_t){return{state:"parsererror",error:ae?_t:"No conversion from "+Se+" to "+Q}}}}return{state:"success",data:E}}A.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:vr.href,type:"GET",isLocal:g_.test(vr.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":mT,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":A.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(y,E){return E?b_(b_(y,A.ajaxSettings),E):b_(A.ajaxSettings,y)},ajaxPrefilter:_T(__),ajaxTransport:_T(Rd),ajax:function(y,E){typeof y=="object"&&(E=y,y=void 0),E=E||{};var U,q,Z,Q,ae,Pe,Se,je,at,_t,Je=A.ajaxSetup({},E),At=Je.context||Je,Si=Je.context&&(At.nodeType||At.jquery)?A(At):A.event,rs=A.Deferred(),Fi=A.Callbacks("once memory"),Xn=Je.statusCode||{},An={},co={},la="canceled",Yi={readyState:0,getResponseHeader:function(ls){var Qs;if(Se){if(!Q)for(Q={};Qs=bu.exec(Z);)Q[Qs[1].toLowerCase()+" "]=(Q[Qs[1].toLowerCase()+" "]||[]).concat(Qs[2]);Qs=Q[ls.toLowerCase()+" "]}return Qs==null?null:Qs.join(", ")},getAllResponseHeaders:function(){return Se?Z:null},setRequestHeader:function(ls,Qs){return Se==null&&(ls=co[ls.toLowerCase()]=co[ls.toLowerCase()]||ls,An[ls]=Qs),this},overrideMimeType:function(ls){return Se==null&&(Je.mimeType=ls),this},statusCode:function(ls){var Qs;if(ls)if(Se)Yi.always(ls[Yi.status]);else for(Qs in ls)Xn[Qs]=[Xn[Qs],ls[Qs]];return this},abort:function(ls){var Qs=ls||la;return U&&U.abort(Qs),yu(0,Qs),this}};if(rs.promise(Yi),Je.url=((y||Je.url||vr.href)+"").replace(m_,vr.protocol+"//"),Je.type=E.method||E.type||Je.method||Je.type,Je.dataTypes=(Je.dataType||"*").toLowerCase().match(ii)||[""],Je.crossDomain==null){Pe=F.createElement("a");try{Pe.href=Je.url,Pe.href=Pe.href,Je.crossDomain=Uh.protocol+"//"+Uh.host!=Pe.protocol+"//"+Pe.host}catch{Je.crossDomain=!0}}if(Je.data&&Je.processData&&typeof Je.data!="string"&&(Je.data=A.param(Je.data,Je.traditional)),bT(__,Je,E,Yi),Se)return Yi;je=A.event&&Je.global,je&&A.active++===0&&A.event.trigger("ajaxStart"),Je.type=Je.type.toUpperCase(),Je.hasContent=!gT.test(Je.type),q=Je.url.replace(p_,""),Je.hasContent?Je.data&&Je.processData&&(Je.contentType||"").indexOf("application/x-www-form-urlencoded")===0&&(Je.data=Je.data.replace(f_,"+")):(_t=Je.url.slice(q.length),Je.data&&(Je.processData||typeof Je.data=="string")&&(q+=(Oo.test(q)?"&":"?")+Je.data,delete Je.data),Je.cache===!1&&(q=q.replace(Bh,"$1"),_t=(Oo.test(q)?"&":"?")+"_="+xn.guid+++_t),Je.url=q+_t),Je.ifModified&&(A.lastModified[q]&&Yi.setRequestHeader("If-Modified-Since",A.lastModified[q]),A.etag[q]&&Yi.setRequestHeader("If-None-Match",A.etag[q])),(Je.data&&Je.hasContent&&Je.contentType!==!1||E.contentType)&&Yi.setRequestHeader("Content-Type",Je.contentType),Yi.setRequestHeader("Accept",Je.dataTypes[0]&&Je.accepts[Je.dataTypes[0]]?Je.accepts[Je.dataTypes[0]]+(Je.dataTypes[0]!=="*"?", "+mT+"; q=0.01":""):Je.accepts["*"]);for(at in Je.headers)Yi.setRequestHeader(at,Je.headers[at]);if(Je.beforeSend&&(Je.beforeSend.call(At,Yi,Je)===!1||Se))return Yi.abort();if(la="abort",Fi.add(Je.complete),Yi.done(Je.success),Yi.fail(Je.error),U=bT(Rd,Je,E,Yi),!U)yu(-1,"No Transport");else{if(Yi.readyState=1,je&&Si.trigger("ajaxSend",[Yi,Je]),Se)return Yi;Je.async&&Je.timeout>0&&(ae=g.setTimeout(function(){Yi.abort("timeout")},Je.timeout));try{Se=!1,U.send(An,yu)}catch(ls){if(Se)throw ls;yu(-1,ls)}}function yu(ls,Qs,Hs,Od){var fo,Fd,Ra,Fo,ua,qr=Qs;Se||(Se=!0,ae&&g.clearTimeout(ae),U=void 0,Z=Od||"",Yi.readyState=ls>0?4:0,fo=ls>=200&&ls<300||ls===304,Hs&&(Fo=yT(Je,Yi,Hs)),!fo&&A.inArray("script",Je.dataTypes)>-1&&A.inArray("json",Je.dataTypes)<0&&(Je.converters["text script"]=function(){}),Fo=y_(Je,Fo,Yi,fo),fo?(Je.ifModified&&(ua=Yi.getResponseHeader("Last-Modified"),ua&&(A.lastModified[q]=ua),ua=Yi.getResponseHeader("etag"),ua&&(A.etag[q]=ua)),ls===204||Je.type==="HEAD"?qr="nocontent":ls===304?qr="notmodified":(qr=Fo.state,Fd=Fo.data,Ra=Fo.error,fo=!Ra)):(Ra=qr,(ls||!qr)&&(qr="error",ls<0&&(ls=0))),Yi.status=ls,Yi.statusText=(Qs||qr)+"",fo?rs.resolveWith(At,[Fd,qr,Yi]):rs.rejectWith(At,[Yi,qr,Ra]),Yi.statusCode(Xn),Xn=void 0,je&&Si.trigger(fo?"ajaxSuccess":"ajaxError",[Yi,Je,fo?Fd:Ra]),Fi.fireWith(At,[Yi,qr]),je&&(Si.trigger("ajaxComplete",[Yi,Je]),--A.active||A.event.trigger("ajaxStop")))}return Yi},getJSON:function(y,E,U){return A.get(y,E,U,"json")},getScript:function(y,E){return A.get(y,void 0,E,"script")}}),A.each(["get","post"],function(y,E){A[E]=function(U,q,Z,Q){return x(q)&&(Q=Q||Z,Z=q,q=void 0),A.ajax(A.extend({url:U,type:E,dataType:Q,data:q,success:Z},A.isPlainObject(U)&&U))}}),A.ajaxPrefilter(function(y){var E;for(E in y.headers)E.toLowerCase()==="content-type"&&(y.contentType=y.headers[E]||"")}),A._evalUrl=function(y,E,U){return A.ajax({url:y,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(q){A.globalEval(q,E,U)}})},A.fn.extend({wrapAll:function(y){var E;return this[0]&&(x(y)&&(y=y.call(this[0])),E=A(y,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&E.insertBefore(this[0]),E.map(function(){for(var U=this;U.firstElementChild;)U=U.firstElementChild;return U}).append(this)),this},wrapInner:function(y){return x(y)?this.each(function(E){A(this).wrapInner(y.call(this,E))}):this.each(function(){var E=A(this),U=E.contents();U.length?U.wrapAll(y):E.append(y)})},wrap:function(y){var E=x(y);return this.each(function(U){A(this).wrapAll(E?y.call(this,U):y)})},unwrap:function(y){return this.parent(y).not("body").each(function(){A(this).replaceWith(this.childNodes)}),this}}),A.expr.pseudos.hidden=function(y){return!A.expr.pseudos.visible(y)},A.expr.pseudos.visible=function(y){return!!(y.offsetWidth||y.offsetHeight||y.getClientRects().length)},A.ajaxSettings.xhr=function(){try{return new g.XMLHttpRequest}catch{}};var v_={0:200,1223:204},jh=A.ajaxSettings.xhr();P.cors=!!jh&&"withCredentials"in jh,P.ajax=jh=!!jh,A.ajaxTransport(function(y){var E,U;if(P.cors||jh&&!y.crossDomain)return{send:function(q,Z){var Q,ae=y.xhr();if(ae.open(y.type,y.url,y.async,y.username,y.password),y.xhrFields)for(Q in y.xhrFields)ae[Q]=y.xhrFields[Q];y.mimeType&&ae.overrideMimeType&&ae.overrideMimeType(y.mimeType),!y.crossDomain&&!q["X-Requested-With"]&&(q["X-Requested-With"]="XMLHttpRequest");for(Q in q)ae.setRequestHeader(Q,q[Q]);E=function(Pe){return function(){E&&(E=U=ae.onload=ae.onerror=ae.onabort=ae.ontimeout=ae.onreadystatechange=null,Pe==="abort"?ae.abort():Pe==="error"?typeof ae.status!="number"?Z(0,"error"):Z(ae.status,ae.statusText):Z(v_[ae.status]||ae.status,ae.statusText,(ae.responseType||"text")!=="text"||typeof ae.responseText!="string"?{binary:ae.response}:{text:ae.responseText},ae.getAllResponseHeaders()))}},ae.onload=E(),U=ae.onerror=ae.ontimeout=E("error"),ae.onabort!==void 0?ae.onabort=U:ae.onreadystatechange=function(){ae.readyState===4&&g.setTimeout(function(){E&&U()})},E=E("abort");try{ae.send(y.hasContent&&y.data||null)}catch(Pe){if(E)throw Pe}},abort:function(){E&&E()}}}),A.ajaxPrefilter(function(y){y.crossDomain&&(y.contents.script=!1)}),A.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(y){return A.globalEval(y),y}}}),A.ajaxPrefilter("script",function(y){y.cache===void 0&&(y.cache=!1),y.crossDomain&&(y.type="GET")}),A.ajaxTransport("script",function(y){if(y.crossDomain||y.scriptAttrs){var E,U;return{send:function(q,Z){E=A("<script>").attr(y.scriptAttrs||{}).prop({charset:y.scriptCharset,src:y.url}).on("load error",U=function(Q){E.remove(),U=null,Q&&Z(Q.type==="error"?404:200,Q.type)}),F.head.appendChild(E[0])},abort:function(){U&&U()}}}});var lg=[],Hh=/(=)\?(?=&|$)|\?\?/;A.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var y=lg.pop()||A.expando+"_"+xn.guid++;return this[y]=!0,y}}),A.ajaxPrefilter("json jsonp",function(y,E,U){var q,Z,Q,ae=y.jsonp!==!1&&(Hh.test(y.url)?"url":typeof y.data=="string"&&(y.contentType||"").indexOf("application/x-www-form-urlencoded")===0&&Hh.test(y.data)&&"data");if(ae||y.dataTypes[0]==="jsonp")return q=y.jsonpCallback=x(y.jsonpCallback)?y.jsonpCallback():y.jsonpCallback,ae?y[ae]=y[ae].replace(Hh,"$1"+q):y.jsonp!==!1&&(y.url+=(Oo.test(y.url)?"&":"?")+y.jsonp+"="+q),y.converters["script json"]=function(){return Q||A.error(q+" was not called"),Q[0]},y.dataTypes[0]="json",Z=g[q],g[q]=function(){Q=arguments},U.always(function(){Z===void 0?A(g).removeProp(q):g[q]=Z,y[q]&&(y.jsonpCallback=E.jsonpCallback,lg.push(q)),Q&&x(Z)&&Z(Q[0]),Q=Z=void 0}),"script"}),P.createHTMLDocument=function(){var y=F.implementation.createHTMLDocument("").body;return y.innerHTML="<form></form><form></form>",y.childNodes.length===2}(),A.parseHTML=function(y,E,U){if(typeof y!="string")return[];typeof E=="boolean"&&(U=E,E=!1);var q,Z,Q;return E||(P.createHTMLDocument?(E=F.implementation.createHTMLDocument(""),q=E.createElement("base"),q.href=F.location.href,E.head.appendChild(q)):E=F),Z=ui.exec(y),Q=!U&&[],Z?[E.createElement(Z[1])]:(Z=Ge([y],E,Q),Q&&Q.length&&A(Q).remove(),A.merge([],Z.childNodes))},A.fn.load=function(y,E,U){var q,Z,Q,ae=this,Pe=y.indexOf(" ");return Pe>-1&&(q=ns(y.slice(Pe)),y=y.slice(0,Pe)),x(E)?(U=E,E=void 0):E&&typeof E=="object"&&(Z="POST"),ae.length>0&&A.ajax({url:y,type:Z||"GET",dataType:"html",data:E}).done(function(Se){Q=arguments,ae.html(q?A("<div>").append(A.parseHTML(Se)).find(q):Se)}).always(U&&function(Se,je){ae.each(function(){U.apply(this,Q||[Se.responseText,je,Se])})}),this},A.expr.pseudos.animated=function(y){return A.grep(A.timers,function(E){return y===E.elem}).length},A.offset={setOffset:function(y,E,U){var q,Z,Q,ae,Pe,Se,je,at=A.css(y,"position"),_t=A(y),Je={};at==="static"&&(y.style.position="relative"),Pe=_t.offset(),Q=A.css(y,"top"),Se=A.css(y,"left"),je=(at==="absolute"||at==="fixed")&&(Q+Se).indexOf("auto")>-1,je?(q=_t.position(),ae=q.top,Z=q.left):(ae=parseFloat(Q)||0,Z=parseFloat(Se)||0),x(E)&&(E=E.call(y,U,A.extend({},Pe))),E.top!=null&&(Je.top=E.top-Pe.top+ae),E.left!=null&&(Je.left=E.left-Pe.left+Z),"using"in E?E.using.call(y,Je):_t.css(Je)}},A.fn.extend({offset:function(y){if(arguments.length)return y===void 0?this:this.each(function(Z){A.offset.setOffset(this,y,Z)});var E,U,q=this[0];if(q)return q.getClientRects().length?(E=q.getBoundingClientRect(),U=q.ownerDocument.defaultView,{top:E.top+U.pageYOffset,left:E.left+U.pageXOffset}):{top:0,left:0}},position:function(){if(this[0]){var y,E,U,q=this[0],Z={top:0,left:0};if(A.css(q,"position")==="fixed")E=q.getBoundingClientRect();else{for(E=this.offset(),U=q.ownerDocument,y=q.offsetParent||U.documentElement;y&&(y===U.body||y===U.documentElement)&&A.css(y,"position")==="static";)y=y.parentNode;y&&y!==q&&y.nodeType===1&&(Z=A(y).offset(),Z.top+=A.css(y,"borderTopWidth",!0),Z.left+=A.css(y,"borderLeftWidth",!0))}return{top:E.top-Z.top-A.css(q,"marginTop",!0),left:E.left-Z.left-A.css(q,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var y=this.offsetParent;y&&A.css(y,"position")==="static";)y=y.offsetParent;return y||$t})}}),A.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(y,E){var U=E==="pageYOffset";A.fn[y]=function(q){return ws(this,function(Z,Q,ae){var Pe;if(L(Z)?Pe=Z:Z.nodeType===9&&(Pe=Z.defaultView),ae===void 0)return Pe?Pe[E]:Z[Q];Pe?Pe.scrollTo(U?Pe.pageXOffset:ae,U?ae:Pe.pageYOffset):Z[Q]=ae},y,q,arguments.length)}}),A.each(["top","left"],function(y,E){A.cssHooks[E]=Ce(P.pixelPosition,function(U,q){if(q)return q=ie(U,E),_s.test(q)?A(U).position()[E]+"px":q})}),A.each({Height:"height",Width:"width"},function(y,E){A.each({padding:"inner"+y,content:E,"":"outer"+y},function(U,q){A.fn[q]=function(Z,Q){var ae=arguments.length&&(U||typeof Z!="boolean"),Pe=U||(Z===!0||Q===!0?"margin":"border");return ws(this,function(Se,je,at){var _t;return L(Se)?q.indexOf("outer")===0?Se["inner"+y]:Se.document.documentElement["client"+y]:Se.nodeType===9?(_t=Se.documentElement,Math.max(Se.body["scroll"+y],_t["scroll"+y],Se.body["offset"+y],_t["offset"+y],_t["client"+y])):at===void 0?A.css(Se,je,Pe):A.style(Se,je,at,Pe)},E,ae?Z:void 0,ae)}})}),A.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(y,E){A.fn[E]=function(U){return this.on(E,U)}}),A.fn.extend({bind:function(y,E,U){return this.on(y,null,E,U)},unbind:function(y,E){return this.off(y,null,E)},delegate:function(y,E,U,q){return this.on(E,y,U,q)},undelegate:function(y,E,U){return arguments.length===1?this.off(y,"**"):this.off(E,y||"**",U)},hover:function(y,E){return this.on("mouseenter",y).on("mouseleave",E||y)}}),A.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(y,E){A.fn[E]=function(U,q){return arguments.length>0?this.on(E,null,U,q):this.trigger(E)}});var Lx=/^[\s\uFEFF\xA0]+|([^\s\uFEFF\xA0])[\s\uFEFF\xA0]+$/g;A.proxy=function(y,E){var U,q,Z;if(typeof E=="string"&&(U=y[E],E=y,y=U),!!x(y))return q=o.call(arguments,2),Z=function(){return y.apply(E||this,q.concat(o.call(arguments)))},Z.guid=y.guid=y.guid||A.guid++,Z},A.holdReady=function(y){y?A.readyWait++:A.ready(!0)},A.isArray=Array.isArray,A.parseJSON=JSON.parse,A.nodeName=fe,A.isFunction=x,A.isWindow=L,A.camelCase=Fe,A.type=K,A.now=Date.now,A.isNumeric=function(y){var E=A.type(y);return(E==="number"||E==="string")&&!isNaN(y-parseFloat(y))},A.trim=function(y){return y==null?"":(y+"").replace(Lx,"$1")},typeof define=="function"&&define.amd&&define("jquery",[],function(){return A});var Md=g.jQuery,Nx=g.$;return A.noConflict=function(y){return g.$===A&&(g.$=Nx),y&&g.jQuery===A&&(g.jQuery=Md),A},typeof t>"u"&&(g.jQuery=g.$=A),A});(function(g,t){typeof exports=="object"&&typeof module<"u"?t(exports):typeof define=="function"&&define.amd?define(["exports"],t):t((g=typeof globalThis<"u"?globalThis:g||self).Popper={})})(void 0,function(g){function t(de){return{width:(de=de.getBoundingClientRect()).width,height:de.height,top:de.top,right:de.right,bottom:de.bottom,left:de.left,x:de.left,y:de.top}}function i(de){return de==null?window:de.toString()!=="[object Window]"?(de=de.ownerDocument)&&de.defaultView||window:de}function n(de){return{scrollLeft:(de=i(de)).pageXOffset,scrollTop:de.pageYOffset}}function o(de){return de instanceof i(de).Element||de instanceof Element}function l(de){return de instanceof i(de).HTMLElement||de instanceof HTMLElement}function c(de){return typeof ShadowRoot<"u"&&(de instanceof i(de).ShadowRoot||de instanceof ShadowRoot)}function d(de){return de?(de.nodeName||"").toLowerCase():null}function f(de){return((o(de)?de.ownerDocument:de.document)||window.document).documentElement}function m(de){return t(f(de)).left+n(de).scrollLeft}function b(de){return i(de).getComputedStyle(de)}function T(de){return de=b(de),/auto|scroll|overlay|hidden/.test(de.overflow+de.overflowY+de.overflowX)}function C(de,Te,Me){Me===void 0&&(Me=!1);var Xe=f(Te);de=t(de);var mt=l(Te),ft={scrollLeft:0,scrollTop:0},wt={x:0,y:0};return(mt||!mt&&!Me)&&((d(Te)!=="body"||T(Xe))&&(ft=Te!==i(Te)&&l(Te)?{scrollLeft:Te.scrollLeft,scrollTop:Te.scrollTop}:n(Te)),l(Te)?((wt=t(Te)).x+=Te.clientLeft,wt.y+=Te.clientTop):Xe&&(wt.x=m(Xe))),{x:de.left+ft.scrollLeft-wt.x,y:de.top+ft.scrollTop-wt.y,width:de.width,height:de.height}}function P(de){var Te=t(de),Me=de.offsetWidth,Xe=de.offsetHeight;return 1>=Math.abs(Te.width-Me)&&(Me=Te.width),1>=Math.abs(Te.height-Xe)&&(Xe=Te.height),{x:de.offsetLeft,y:de.offsetTop,width:Me,height:Xe}}function x(de){return d(de)==="html"?de:de.assignedSlot||de.parentNode||(c(de)?de.host:null)||f(de)}function L(de){return 0<=["html","body","#document"].indexOf(d(de))?de.ownerDocument.body:l(de)&&T(de)?de:L(x(de))}function F(de,Te){var Me;Te===void 0&&(Te=[]);var Xe=L(de);return de=Xe===((Me=de.ownerDocument)==null?void 0:Me.body),Me=i(Xe),Xe=de?[Me].concat(Me.visualViewport||[],T(Xe)?Xe:[]):Xe,Te=Te.concat(Xe),de?Te:Te.concat(F(x(Xe)))}function X(de){return l(de)&&b(de).position!=="fixed"?de.offsetParent:null}function re(de){for(var Te=i(de),Me=X(de);Me&&0<=["table","td","th"].indexOf(d(Me))&&b(Me).position==="static";)Me=X(Me);if(Me&&(d(Me)==="html"||d(Me)==="body"&&b(Me).position==="static"))return Te;if(!Me)e:{if(Me=navigator.userAgent.toLowerCase().indexOf("firefox")!==-1,navigator.userAgent.indexOf("Trident")===-1||!l(de)||b(de).position!=="fixed")for(de=x(de);l(de)&&0>["html","body"].indexOf(d(de));){var Xe=b(de);if(Xe.transform!=="none"||Xe.perspective!=="none"||Xe.contain==="paint"||["transform","perspective"].indexOf(Xe.willChange)!==-1||Me&&Xe.willChange==="filter"||Me&&Xe.filter&&Xe.filter!=="none"){Me=de;break e}de=de.parentNode}Me=null}return Me||Te}function K(de){function Te(ft){Xe.add(ft.name),[].concat(ft.requires||[],ft.requiresIfExists||[]).forEach(function(wt){Xe.has(wt)||(wt=Me.get(wt))&&Te(wt)}),mt.push(ft)}var Me=new Map,Xe=new Set,mt=[];return de.forEach(function(ft){Me.set(ft.name,ft)}),de.forEach(function(ft){Xe.has(ft.name)||Te(ft)}),mt}function te(de){var Te;return function(){return Te||(Te=new Promise(function(Me){Promise.resolve().then(function(){Te=void 0,Me(de())})})),Te}}function ee(de){return de.split("-")[0]}function A(de,Te){var Me=Te.getRootNode&&Te.getRootNode();if(de.contains(Te))return!0;if(Me&&c(Me))do{if(Te&&de.isSameNode(Te))return!0;Te=Te.parentNode||Te.host}while(Te);return!1}function me(de){return Object.assign({},de,{left:de.x,top:de.y,right:de.x+de.width,bottom:de.y+de.height})}function fe(de,Te){if(Te==="viewport"){Te=i(de);var Me=f(de);Te=Te.visualViewport;var Xe=Me.clientWidth;Me=Me.clientHeight;var mt=0,ft=0;Te&&(Xe=Te.width,Me=Te.height,/^((?!chrome|android).)*safari/i.test(navigator.userAgent)||(mt=Te.offsetLeft,ft=Te.offsetTop)),de=me(de={width:Xe,height:Me,x:mt+m(de),y:ft})}else l(Te)?((de=t(Te)).top+=Te.clientTop,de.left+=Te.clientLeft,de.bottom=de.top+Te.clientHeight,de.right=de.left+Te.clientWidth,de.width=Te.clientWidth,de.height=Te.clientHeight,de.x=de.left,de.y=de.top):(ft=f(de),de=f(ft),Xe=n(ft),Te=(Me=ft.ownerDocument)==null?void 0:Me.body,Me=jt(de.scrollWidth,de.clientWidth,Te?Te.scrollWidth:0,Te?Te.clientWidth:0),mt=jt(de.scrollHeight,de.clientHeight,Te?Te.scrollHeight:0,Te?Te.clientHeight:0),ft=-Xe.scrollLeft+m(ft),Xe=-Xe.scrollTop,b(Te||de).direction==="rtl"&&(ft+=jt(de.clientWidth,Te?Te.clientWidth:0)-Me),de=me({width:Me,height:mt,x:ft,y:Xe}));return de}function J(de,Te,Me){return Te=Te==="clippingParents"?function(Xe){var mt=F(x(Xe)),ft=0<=["absolute","fixed"].indexOf(b(Xe).position)&&l(Xe)?re(Xe):Xe;return o(ft)?mt.filter(function(wt){return o(wt)&&A(wt,ft)&&d(wt)!=="body"}):[]}(de):[].concat(Te),(Me=(Me=[].concat(Te,[Me])).reduce(function(Xe,mt){return mt=fe(de,mt),Xe.top=jt(mt.top,Xe.top),Xe.right=Yt(mt.right,Xe.right),Xe.bottom=Yt(mt.bottom,Xe.bottom),Xe.left=jt(mt.left,Xe.left),Xe},fe(de,Me[0]))).width=Me.right-Me.left,Me.height=Me.bottom-Me.top,Me.x=Me.left,Me.y=Me.top,Me}function ye(de){return 0<=["top","bottom"].indexOf(de)?"x":"y"}function Oe(de){var Te=de.reference,Me=de.element,Xe=(de=de.placement)?ee(de):null;de=de?de.split("-")[1]:null;var mt=Te.x+Te.width/2-Me.width/2,ft=Te.y+Te.height/2-Me.height/2;switch(Xe){case"top":mt={x:mt,y:Te.y-Me.height};break;case"bottom":mt={x:mt,y:Te.y+Te.height};break;case"right":mt={x:Te.x+Te.width,y:ft};break;case"left":mt={x:Te.x-Me.width,y:ft};break;default:mt={x:Te.x,y:Te.y}}if((Xe=Xe?ye(Xe):null)!=null)switch(ft=Xe==="y"?"height":"width",de){case"start":mt[Xe]-=Te[ft]/2-Me[ft]/2;break;case"end":mt[Xe]+=Te[ft]/2-Me[ft]/2}return mt}function ot(de){return Object.assign({},{top:0,right:0,bottom:0,left:0},de)}function Tt(de,Te){return Te.reduce(function(Me,Xe){return Me[Xe]=de,Me},{})}function dt(de,Te){Te===void 0&&(Te={});var Me=Te;Te=(Te=Me.placement)===void 0?de.placement:Te;var Xe=Me.boundary,mt=Xe===void 0?"clippingParents":Xe,ft=(Xe=Me.rootBoundary)===void 0?"viewport":Xe;Xe=(Xe=Me.elementContext)===void 0?"popper":Xe;var wt=Me.altBoundary,$t=wt!==void 0&&wt;Me=ot(typeof(Me=(Me=Me.padding)===void 0?0:Me)!="number"?Me:Tt(Me,qt));var oe=de.elements.reference;wt=de.rects.popper,mt=J(o($t=de.elements[$t?Xe==="popper"?"reference":"popper":Xe])?$t:$t.contextElement||f(de.elements.popper),mt,ft),$t=Oe({reference:ft=t(oe),element:wt,strategy:"absolute",placement:Te}),wt=me(Object.assign({},wt,$t)),ft=Xe==="popper"?wt:ft;var et={top:mt.top-ft.top+Me.top,bottom:ft.bottom-mt.bottom+Me.bottom,left:mt.left-ft.left+Me.left,right:ft.right-mt.right+Me.right};if(de=de.modifiersData.offset,Xe==="popper"&&de){var ht=de[Te];Object.keys(et).forEach(function(pt){var ke=0<=["right","bottom"].indexOf(pt)?1:-1,He=0<=["top","bottom"].indexOf(pt)?"y":"x";et[pt]+=ht[He]*ke})}return et}function kt(){for(var de=arguments.length,Te=Array(de),Me=0;Me<de;Me++)Te[Me]=arguments[Me];return!Te.some(function(Xe){return!(Xe&&typeof Xe.getBoundingClientRect=="function")})}function $e(de){de===void 0&&(de={});var Te=de.defaultModifiers,Me=Te===void 0?[]:Te,Xe=(de=de.defaultOptions)===void 0?ii:de;return function(mt,ft,wt){function $t(){et.forEach(function(ke){return ke()}),et=[]}wt===void 0&&(wt=Xe);var oe={placement:"bottom",orderedModifiers:[],options:Object.assign({},ii,Xe),modifiersData:{},elements:{reference:mt,popper:ft},attributes:{},styles:{}},et=[],ht=!1,pt={state:oe,setOptions:function(ke){return $t(),oe.options=Object.assign({},Xe,oe.options,ke),oe.scrollParents={reference:o(mt)?F(mt):mt.contextElement?F(mt.contextElement):[],popper:F(ft)},ke=function(He){var ne=K(He);return wi.reduce(function(tt,xt){return tt.concat(ne.filter(function(z){return z.phase===xt}))},[])}(function(He){var ne=He.reduce(function(tt,xt){var z=tt[xt.name];return tt[xt.name]=z?Object.assign({},z,xt,{options:Object.assign({},z.options,xt.options),data:Object.assign({},z.data,xt.data)}):xt,tt},{});return Object.keys(ne).map(function(tt){return ne[tt]})}([].concat(Me,oe.options.modifiers))),oe.orderedModifiers=ke.filter(function(He){return He.enabled}),oe.orderedModifiers.forEach(function(He){var ne=He.name,tt=He.options;tt=tt===void 0?{}:tt,typeof(He=He.effect)=="function"&&(ne=He({state:oe,name:ne,instance:pt,options:tt}),et.push(ne||function(){}))}),pt.update()},forceUpdate:function(){if(!ht){var ke=oe.elements,He=ke.reference;if(kt(He,ke=ke.popper))for(oe.rects={reference:C(He,re(ke),oe.options.strategy==="fixed"),popper:P(ke)},oe.reset=!1,oe.placement=oe.options.placement,oe.orderedModifiers.forEach(function(xt){return oe.modifiersData[xt.name]=Object.assign({},xt.data)}),He=0;He<oe.orderedModifiers.length;He++)if(oe.reset===!0)oe.reset=!1,He=-1;else{var ne=oe.orderedModifiers[He];ke=ne.fn;var tt=ne.options;tt=tt===void 0?{}:tt,ne=ne.name,typeof ke=="function"&&(oe=ke({state:oe,options:tt,name:ne,instance:pt})||oe)}}},update:te(function(){return new Promise(function(ke){pt.forceUpdate(),ke(oe)})}),destroy:function(){$t(),ht=!0}};return kt(mt,ft)&&pt.setOptions(wt).then(function(ke){!ht&&wt.onFirstUpdate&&wt.onFirstUpdate(ke)}),pt}}function vt(de){var Te,Me=de.popper,Xe=de.popperRect,mt=de.placement,ft=de.offsets,wt=de.position,$t=de.gpuAcceleration,oe=de.adaptive;if((de=de.roundOffsets)===!0){de=ft.y;var et=window.devicePixelRatio||1;de={x:Ei(Ei(ft.x*et)/et)||0,y:Ei(Ei(de*et)/et)||0}}else de=typeof de=="function"?de(ft):ft;de=(de=(et=de).x)===void 0?0:de,et=(et=et.y)===void 0?0:et;var ht=ft.hasOwnProperty("x");ft=ft.hasOwnProperty("y");var pt,ke="left",He="top",ne=window;if(oe){var tt=re(Me),xt="clientHeight",z="clientWidth";tt===i(Me)&&b(tt=f(Me)).position!=="static"&&(xt="scrollHeight",z="scrollWidth"),mt==="top"&&(He="bottom",et-=tt[xt]-Xe.height,et*=$t?1:-1),mt==="left"&&(ke="right",de-=tt[z]-Xe.width,de*=$t?1:-1)}return Me=Object.assign({position:wt},oe&&js),$t?Object.assign({},Me,((pt={})[He]=ft?"0":"",pt[ke]=ht?"0":"",pt.transform=2>(ne.devicePixelRatio||1)?"translate("+de+"px, "+et+"px)":"translate3d("+de+"px, "+et+"px, 0)",pt)):Object.assign({},Me,((Te={})[He]=ft?et+"px":"",Te[ke]=ht?de+"px":"",Te.transform="",Te))}function Jt(de){return de.replace(/left|right|bottom|top/g,function(Te){return ws[Te]})}function di(de){return de.replace(/start|end/g,function(Te){return pn[Te]})}function Ut(de,Te,Me){return Me===void 0&&(Me={x:0,y:0}),{top:de.top-Te.height-Me.y,right:de.right-Te.width+Me.x,bottom:de.bottom-Te.height+Me.y,left:de.left-Te.width-Me.x}}function ui(de){return["top","right","bottom","left"].some(function(Te){return 0<=de[Te]})}var qt=["top","bottom","right","left"],Ze=qt.reduce(function(de,Te){return de.concat([Te+"-start",Te+"-end"])},[]),ki=[].concat(qt,["auto"]).reduce(function(de,Te){return de.concat([Te,Te+"-start",Te+"-end"])},[]),wi="beforeRead read afterRead beforeMain main afterMain beforeWrite write afterWrite".split(" "),jt=Math.max,Yt=Math.min,Ei=Math.round,ii={placement:"bottom",modifiers:[],strategy:"absolute"},hi={passive:!0},Gt={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(de){var Te=de.state,Me=de.instance,Xe=(de=de.options).scroll,mt=Xe===void 0||Xe,ft=(de=de.resize)===void 0||de,wt=i(Te.elements.popper),$t=[].concat(Te.scrollParents.reference,Te.scrollParents.popper);return mt&&$t.forEach(function(oe){oe.addEventListener("scroll",Me.update,hi)}),ft&&wt.addEventListener("resize",Me.update,hi),function(){mt&&$t.forEach(function(oe){oe.removeEventListener("scroll",Me.update,hi)}),ft&&wt.removeEventListener("resize",Me.update,hi)}},data:{}},es={name:"popperOffsets",enabled:!0,phase:"read",fn:function(de){var Te=de.state;Te.modifiersData[de.name]=Oe({reference:Te.rects.reference,element:Te.rects.popper,strategy:"absolute",placement:Te.placement})},data:{}},js={top:"auto",right:"auto",bottom:"auto",left:"auto"},ps={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(de){var Te=de.state,Me=de.options;de=(de=Me.gpuAcceleration)===void 0||de;var Xe=Me.adaptive;Xe=Xe===void 0||Xe,Me=(Me=Me.roundOffsets)===void 0||Me,de={placement:ee(Te.placement),popper:Te.elements.popper,popperRect:Te.rects.popper,gpuAcceleration:de},Te.modifiersData.popperOffsets!=null&&(Te.styles.popper=Object.assign({},Te.styles.popper,vt(Object.assign({},de,{offsets:Te.modifiersData.popperOffsets,position:Te.options.strategy,adaptive:Xe,roundOffsets:Me})))),Te.modifiersData.arrow!=null&&(Te.styles.arrow=Object.assign({},Te.styles.arrow,vt(Object.assign({},de,{offsets:Te.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:Me})))),Te.attributes.popper=Object.assign({},Te.attributes.popper,{"data-popper-placement":Te.placement})},data:{}},mi={name:"applyStyles",enabled:!0,phase:"write",fn:function(de){var Te=de.state;Object.keys(Te.elements).forEach(function(Me){var Xe=Te.styles[Me]||{},mt=Te.attributes[Me]||{},ft=Te.elements[Me];l(ft)&&d(ft)&&(Object.assign(ft.style,Xe),Object.keys(mt).forEach(function(wt){var $t=mt[wt];$t===!1?ft.removeAttribute(wt):ft.setAttribute(wt,$t===!0?"":$t)}))})},effect:function(de){var Te=de.state,Me={popper:{position:Te.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(Te.elements.popper.style,Me.popper),Te.styles=Me,Te.elements.arrow&&Object.assign(Te.elements.arrow.style,Me.arrow),function(){Object.keys(Te.elements).forEach(function(Xe){var mt=Te.elements[Xe],ft=Te.attributes[Xe]||{};Xe=Object.keys(Te.styles.hasOwnProperty(Xe)?Te.styles[Xe]:Me[Xe]).reduce(function(wt,$t){return wt[$t]="",wt},{}),l(mt)&&d(mt)&&(Object.assign(mt.style,Xe),Object.keys(ft).forEach(function(wt){mt.removeAttribute(wt)}))})}},requires:["computeStyles"]},$i={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(de){var Te=de.state,Me=de.name,Xe=(de=de.options.offset)===void 0?[0,0]:de,mt=(de=ki.reduce(function(wt,$t){var oe=Te.rects,et=ee($t),ht=0<=["left","top"].indexOf(et)?-1:1,pt=typeof Xe=="function"?Xe(Object.assign({},oe,{placement:$t})):Xe;return oe=(oe=pt[0])||0,pt=((pt=pt[1])||0)*ht,et=0<=["left","right"].indexOf(et)?{x:pt,y:oe}:{x:oe,y:pt},wt[$t]=et,wt},{}))[Te.placement],ft=mt.x;mt=mt.y,Te.modifiersData.popperOffsets!=null&&(Te.modifiersData.popperOffsets.x+=ft,Te.modifiersData.popperOffsets.y+=mt),Te.modifiersData[Me]=de}},ws={left:"right",right:"left",bottom:"top",top:"bottom"},pn={start:"end",end:"start"},Mt={name:"flip",enabled:!0,phase:"main",fn:function(de){var Te=de.state,Me=de.options;if(de=de.name,!Te.modifiersData[de]._skip){var Xe=Me.mainAxis;Xe=Xe===void 0||Xe;var mt=Me.altAxis;mt=mt===void 0||mt;var ft=Me.fallbackPlacements,wt=Me.padding,$t=Me.boundary,oe=Me.rootBoundary,et=Me.altBoundary,ht=Me.flipVariations,pt=ht===void 0||ht,ke=Me.allowedAutoPlacements;ht=ee(Me=Te.options.placement),ft=ft||(ht!==Me&&pt?function(Ot){if(ee(Ot)==="auto")return[];var Ct=Jt(Ot);return[di(Ot),Ct,di(Ct)]}(Me):[Jt(Me)]);var He=[Me].concat(ft).reduce(function(Ot,Ct){return Ot.concat(ee(Ct)==="auto"?function(It,ni){ni===void 0&&(ni={});var Zs=ni.boundary,bi=ni.rootBoundary,Oi=ni.padding,gs=ni.flipVariations,qi=ni.allowedAutoPlacements,Gs=qi===void 0?ki:qi,Mn=ni.placement.split("-")[1];(gs=(ni=Mn?gs?Ze:Ze.filter(function(ji){return ji.split("-")[1]===Mn}):qt).filter(function(ji){return 0<=Gs.indexOf(ji)})).length===0&&(gs=ni);var Sn=gs.reduce(function(ji,os){return ji[os]=dt(It,{placement:os,boundary:Zs,rootBoundary:bi,padding:Oi})[ee(os)],ji},{});return Object.keys(Sn).sort(function(ji,os){return Sn[ji]-Sn[os]})}(Te,{placement:Ct,boundary:$t,rootBoundary:oe,padding:wt,flipVariations:pt,allowedAutoPlacements:ke}):Ct)},[]);Me=Te.rects.reference,ft=Te.rects.popper;var ne=new Map;ht=!0;for(var tt=He[0],xt=0;xt<He.length;xt++){var z=He[xt],We=ee(z),qe=z.split("-")[1]==="start",le=0<=["top","bottom"].indexOf(We),De=le?"width":"height",Ge=dt(Te,{placement:z,boundary:$t,rootBoundary:oe,altBoundary:et,padding:wt});if(qe=le?qe?"right":"left":qe?"bottom":"top",Me[De]>ft[De]&&(qe=Jt(qe)),De=Jt(qe),le=[],Xe&&le.push(0>=Ge[We]),mt&&le.push(0>=Ge[qe],0>=Ge[De]),le.every(function(Ot){return Ot})){tt=z,ht=!1;break}ne.set(z,le)}if(ht)for(Xe=function(Ot){var Ct=He.find(function(It){if(It=ne.get(It))return It.slice(0,Ot).every(function(ni){return ni})});if(Ct)return tt=Ct,"break"},mt=pt?3:1;0<mt&&Xe(mt)!=="break";mt--);Te.placement!==tt&&(Te.modifiersData[de]._skip=!0,Te.placement=tt,Te.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}},Mi={name:"preventOverflow",enabled:!0,phase:"main",fn:function(de){var Te=de.state,Me=de.options;de=de.name;var Xe=Me.mainAxis,mt=Xe===void 0||Xe,ft=(Xe=Me.altAxis)!==void 0&&Xe;Xe=(Xe=Me.tether)===void 0||Xe;var wt=Me.tetherOffset,$t=wt===void 0?0:wt,oe=dt(Te,{boundary:Me.boundary,rootBoundary:Me.rootBoundary,padding:Me.padding,altBoundary:Me.altBoundary});Me=ee(Te.placement);var et=Te.placement.split("-")[1],ht=!et,pt=ye(Me);Me=pt==="x"?"y":"x",wt=Te.modifiersData.popperOffsets;var ke=Te.rects.reference,He=Te.rects.popper,ne=typeof $t=="function"?$t(Object.assign({},Te.rects,{placement:Te.placement})):$t;if($t={x:0,y:0},wt){if(mt||ft){var tt=pt==="y"?"top":"left",xt=pt==="y"?"bottom":"right",z=pt==="y"?"height":"width",We=wt[pt],qe=wt[pt]+oe[tt],le=wt[pt]-oe[xt],De=Xe?-He[z]/2:0,Ge=et==="start"?ke[z]:He[z];et=et==="start"?-He[z]:-ke[z],He=Te.elements.arrow,He=Xe&&He?P(He):{width:0,height:0};var Ot=Te.modifiersData["arrow#persistent"]?Te.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0};tt=Ot[tt],xt=Ot[xt],He=jt(0,Yt(ke[z],He[z])),Ge=ht?ke[z]/2-De-He-tt-ne:Ge-He-tt-ne,ke=ht?-ke[z]/2+De+He+xt+ne:et+He+xt+ne,ht=Te.elements.arrow&&re(Te.elements.arrow),ne=Te.modifiersData.offset?Te.modifiersData.offset[Te.placement][pt]:0,ht=wt[pt]+Ge-ne-(ht?pt==="y"?ht.clientTop||0:ht.clientLeft||0:0),ke=wt[pt]+ke-ne,mt&&(mt=Xe?Yt(qe,ht):qe,le=Xe?jt(le,ke):le,mt=jt(mt,Yt(We,le)),wt[pt]=mt,$t[pt]=mt-We),ft&&(mt=(ft=wt[Me])+oe[pt==="x"?"top":"left"],oe=ft-oe[pt==="x"?"bottom":"right"],mt=Xe?Yt(mt,ht):mt,Xe=Xe?jt(oe,ke):oe,Xe=jt(mt,Yt(ft,Xe)),wt[Me]=Xe,$t[Me]=Xe-ft)}Te.modifiersData[de]=$t}},requiresIfExists:["offset"]},Fe={name:"arrow",enabled:!0,phase:"main",fn:function(de){var Te,Me=de.state,Xe=de.name,mt=de.options,ft=Me.elements.arrow,wt=Me.modifiersData.popperOffsets,$t=ee(Me.placement);if(de=ye($t),$t=0<=["left","right"].indexOf($t)?"height":"width",ft&&wt){mt=ot(typeof(mt=typeof(mt=mt.padding)=="function"?mt(Object.assign({},Me.rects,{placement:Me.placement})):mt)!="number"?mt:Tt(mt,qt));var oe=P(ft),et=de==="y"?"top":"left",ht=de==="y"?"bottom":"right",pt=Me.rects.reference[$t]+Me.rects.reference[de]-wt[de]-Me.rects.popper[$t];wt=wt[de]-Me.rects.reference[de],wt=(ft=(ft=re(ft))?de==="y"?ft.clientHeight||0:ft.clientWidth||0:0)/2-oe[$t]/2+(pt/2-wt/2),$t=jt(mt[et],Yt(wt,ft-oe[$t]-mt[ht])),Me.modifiersData[Xe]=((Te={})[de]=$t,Te.centerOffset=$t-wt,Te)}},effect:function(de){var Te=de.state;if((de=(de=de.options.element)===void 0?"[data-popper-arrow]":de)!=null){if(typeof de=="string"&&!(de=Te.elements.popper.querySelector(de)))return;A(Te.elements.popper,de)&&(Te.elements.arrow=de)}},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]},Pi={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(de){var Te=de.state;de=de.name;var Me=Te.rects.reference,Xe=Te.rects.popper,mt=Te.modifiersData.preventOverflow,ft=dt(Te,{elementContext:"reference"}),wt=dt(Te,{altBoundary:!0});Me=Ut(ft,Me),Xe=Ut(wt,Xe,mt),mt=ui(Me),wt=ui(Xe),Te.modifiersData[de]={referenceClippingOffsets:Me,popperEscapeOffsets:Xe,isReferenceHidden:mt,hasPopperEscaped:wt},Te.attributes.popper=Object.assign({},Te.attributes.popper,{"data-popper-reference-hidden":mt,"data-popper-escaped":wt})}},qs=$e({defaultModifiers:[Gt,es,ps,mi]}),Bt=[Gt,es,ps,mi,$i,Mt,Mi,Fe,Pi],ts=$e({defaultModifiers:Bt});g.applyStyles=mi,g.arrow=Fe,g.computeStyles=ps,g.createPopper=ts,g.createPopperLite=qs,g.defaultModifiers=Bt,g.detectOverflow=dt,g.eventListeners=Gt,g.flip=Mt,g.hide=Pi,g.offset=$i,g.popperGenerator=$e,g.popperOffsets=es,g.preventOverflow=Mi,Object.defineProperty(g,"__esModule",{value:!0})});/*!
  * Bootstrap v5.0.2 (https://getbootstrap.com/)
  * Copyright 2011-2021 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */(function(g,t){typeof exports=="object"&&typeof module<"u"?module.exports=t(require("@popperjs/core")):typeof define=="function"&&define.amd?define(["@popperjs/core"],t):(g=typeof globalThis<"u"?globalThis:g||self).bootstrap=t(g.Popper)})(void 0,function(g){function t(Ne){if(Ne&&Ne.__esModule)return Ne;var H=Object.create(null);return Ne&&Object.keys(Ne).forEach(function(ie){if(ie!=="default"){var Ce=Object.getOwnPropertyDescriptor(Ne,ie);Object.defineProperty(H,ie,Ce.get?Ce:{enumerable:!0,get:function(){return Ne[ie]}})}}),H.default=Ne,Object.freeze(H)}var i=t(g);const n={find:(Ne,H=document.documentElement)=>[].concat(...Element.prototype.querySelectorAll.call(H,Ne)),findOne:(Ne,H=document.documentElement)=>Element.prototype.querySelector.call(H,Ne),children:(Ne,H)=>[].concat(...Ne.children).filter(ie=>ie.matches(H)),parents(Ne,H){const ie=[];let Ce=Ne.parentNode;for(;Ce&&Ce.nodeType===Node.ELEMENT_NODE&&Ce.nodeType!==3;)Ce.matches(H)&&ie.push(Ce),Ce=Ce.parentNode;return ie},prev(Ne,H){let ie=Ne.previousElementSibling;for(;ie;){if(ie.matches(H))return[ie];ie=ie.previousElementSibling}return[]},next(Ne,H){let ie=Ne.nextElementSibling;for(;ie;){if(ie.matches(H))return[ie];ie=ie.nextElementSibling}return[]}},o=Ne=>{do Ne+=Math.floor(1e6*Math.random());while(document.getElementById(Ne));return Ne},l=Ne=>{let H=Ne.getAttribute("data-bs-target");if(!H||H==="#"){let ie=Ne.getAttribute("href");if(!ie||!ie.includes("#")&&!ie.startsWith("."))return null;ie.includes("#")&&!ie.startsWith("#")&&(ie="#"+ie.split("#")[1]),H=ie&&ie!=="#"?ie.trim():null}return H},c=Ne=>{const H=l(Ne);return H&&document.querySelector(H)?H:null},d=Ne=>{const H=l(Ne);return H?document.querySelector(H):null},f=Ne=>{Ne.dispatchEvent(new Event("transitionend"))},m=Ne=>!(!Ne||typeof Ne!="object")&&(Ne.jquery!==void 0&&(Ne=Ne[0]),Ne.nodeType!==void 0),b=Ne=>m(Ne)?Ne.jquery?Ne[0]:Ne:typeof Ne=="string"&&Ne.length>0?n.findOne(Ne):null,T=(Ne,H,ie)=>{Object.keys(ie).forEach(Ce=>{const Ae=ie[Ce],nt=H[Ce],Dt=nt&&m(nt)?"element":(Ai=nt)==null?""+Ai:{}.toString.call(Ai).match(/\s([a-z]+)/i)[1].toLowerCase();var Ai;if(!new RegExp(Ae).test(Dt))throw new TypeError(`${Ne.toUpperCase()}: Option "${Ce}" provided type "${Dt}" but expected type "${Ae}".`)})},C=Ne=>!(!m(Ne)||Ne.getClientRects().length===0)&&getComputedStyle(Ne).getPropertyValue("visibility")==="visible",P=Ne=>!Ne||Ne.nodeType!==Node.ELEMENT_NODE||!!Ne.classList.contains("disabled")||(Ne.disabled!==void 0?Ne.disabled:Ne.hasAttribute("disabled")&&Ne.getAttribute("disabled")!=="false"),x=Ne=>{if(!document.documentElement.attachShadow)return null;if(typeof Ne.getRootNode=="function"){const H=Ne.getRootNode();return H instanceof ShadowRoot?H:null}return Ne instanceof ShadowRoot?Ne:Ne.parentNode?x(Ne.parentNode):null},L=()=>{},F=Ne=>Ne.offsetHeight,X=()=>{const{jQuery:Ne}=window;return Ne&&!document.body.hasAttribute("data-bs-no-jquery")?Ne:null},re=[],K=()=>document.documentElement.dir==="rtl",te=Ne=>{var H;H=()=>{const ie=X();if(ie){const Ce=Ne.NAME,Ae=ie.fn[Ce];ie.fn[Ce]=Ne.jQueryInterface,ie.fn[Ce].Constructor=Ne,ie.fn[Ce].noConflict=()=>(ie.fn[Ce]=Ae,Ne.jQueryInterface)}},document.readyState==="loading"?(re.length||document.addEventListener("DOMContentLoaded",()=>{re.forEach(ie=>ie())}),re.push(H)):H()},ee=Ne=>{typeof Ne=="function"&&Ne()},A=(Ne,H,ie=!0)=>{if(!ie)return void ee(Ne);const Ce=(Dt=>{if(!Dt)return 0;let{transitionDuration:Ai,transitionDelay:Di}=window.getComputedStyle(Dt);const Ki=Number.parseFloat(Ai),Es=Number.parseFloat(Di);return Ki||Es?(Ai=Ai.split(",")[0],Di=Di.split(",")[0],1e3*(Number.parseFloat(Ai)+Number.parseFloat(Di))):0})(H)+5;let Ae=!1;const nt=({target:Dt})=>{Dt===H&&(Ae=!0,H.removeEventListener("transitionend",nt),ee(Ne))};H.addEventListener("transitionend",nt),setTimeout(()=>{Ae||f(H)},Ce)},me=(Ne,H,ie,Ce)=>{let Ae=Ne.indexOf(H);if(Ae===-1)return Ne[!ie&&Ce?Ne.length-1:0];const nt=Ne.length;return Ae+=ie?1:-1,Ce&&(Ae=(Ae+nt)%nt),Ne[Math.max(0,Math.min(Ae,nt-1))]},fe=/[^.]*(?=\..*)\.|.*/,J=/\..*/,ye=/::\d+$/,Oe={};let ot=1;const Tt={mouseenter:"mouseover",mouseleave:"mouseout"},dt=/^(mouseenter|mouseleave)/i,kt=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function $e(Ne,H){return H&&`${H}::${ot++}`||Ne.uidEvent||ot++}function vt(Ne){const H=$e(Ne);return Ne.uidEvent=H,Oe[H]=Oe[H]||{},Oe[H]}function Jt(Ne,H,ie=null){const Ce=Object.keys(Ne);for(let Ae=0,nt=Ce.length;Ae<nt;Ae++){const Dt=Ne[Ce[Ae]];if(Dt.originalHandler===H&&Dt.delegationSelector===ie)return Dt}return null}function di(Ne,H,ie){const Ce=typeof H=="string",Ae=Ce?ie:H;let nt=qt(Ne);return kt.has(nt)||(nt=Ne),[Ce,Ae,nt]}function Ut(Ne,H,ie,Ce,Ae){if(typeof H!="string"||!Ne)return;if(ie||(ie=Ce,Ce=null),dt.test(H)){const ks=nn=>function(hs){if(!hs.relatedTarget||hs.relatedTarget!==hs.delegateTarget&&!hs.delegateTarget.contains(hs.relatedTarget))return nn.call(this,hs)};Ce?Ce=ks(Ce):ie=ks(ie)}const[nt,Dt,Ai]=di(H,ie,Ce),Di=vt(Ne),Ki=Di[Ai]||(Di[Ai]={}),Es=Jt(Ki,Dt,nt?ie:null);if(Es)return void(Es.oneOff=Es.oneOff&&Ae);const Ht=$e(Dt,H.replace(fe,"")),Xs=nt?function(ks,nn,hs){return function yn(Gn){const sr=ks.querySelectorAll(nn);for(let{target:La}=Gn;La&&La!==this;La=La.parentNode)for(let ue=sr.length;ue--;)if(sr[ue]===La)return Gn.delegateTarget=La,yn.oneOff&&Ze.off(ks,Gn.type,nn,hs),hs.apply(La,[Gn]);return null}}(Ne,ie,Ce):function(ks,nn){return function hs(yn){return yn.delegateTarget=ks,hs.oneOff&&Ze.off(ks,yn.type,nn),nn.apply(ks,[yn])}}(Ne,ie);Xs.delegationSelector=nt?ie:null,Xs.originalHandler=Dt,Xs.oneOff=Ae,Xs.uidEvent=Ht,Ki[Ht]=Xs,Ne.addEventListener(Ai,Xs,nt)}function ui(Ne,H,ie,Ce,Ae){const nt=Jt(H[ie],Ce,Ae);nt&&(Ne.removeEventListener(ie,nt,!!Ae),delete H[ie][nt.uidEvent])}function qt(Ne){return Ne=Ne.replace(J,""),Tt[Ne]||Ne}const Ze={on(Ne,H,ie,Ce){Ut(Ne,H,ie,Ce,!1)},one(Ne,H,ie,Ce){Ut(Ne,H,ie,Ce,!0)},off(Ne,H,ie,Ce){if(typeof H!="string"||!Ne)return;const[Ae,nt,Dt]=di(H,ie,Ce),Ai=Dt!==H,Di=vt(Ne),Ki=H.startsWith(".");if(nt!==void 0)return!Di||!Di[Dt]?void 0:void ui(Ne,Di,Dt,nt,Ae?ie:null);Ki&&Object.keys(Di).forEach(Ht=>{(function(Xs,ks,nn,hs){const yn=ks[nn]||{};Object.keys(yn).forEach(Gn=>{if(Gn.includes(hs)){const sr=yn[Gn];ui(Xs,ks,nn,sr.originalHandler,sr.delegationSelector)}})})(Ne,Di,Ht,H.slice(1))});const Es=Di[Dt]||{};Object.keys(Es).forEach(Ht=>{const Xs=Ht.replace(ye,"");if(!Ai||H.includes(Xs)){const ks=Es[Ht];ui(Ne,Di,Dt,ks.originalHandler,ks.delegationSelector)}})},trigger(Ne,H,ie){if(typeof H!="string"||!Ne)return null;const Ce=X(),Ae=qt(H),nt=H!==Ae,Dt=kt.has(Ae);let Ai,Di=!0,Ki=!0,Es=!1,Ht=null;return nt&&Ce&&(Ai=Ce.Event(H,ie),Ce(Ne).trigger(Ai),Di=!Ai.isPropagationStopped(),Ki=!Ai.isImmediatePropagationStopped(),Es=Ai.isDefaultPrevented()),Dt?(Ht=document.createEvent("HTMLEvents"),Ht.initEvent(Ae,Di,!0)):Ht=new CustomEvent(H,{bubbles:Di,cancelable:!0}),ie!==void 0&&Object.keys(ie).forEach(Xs=>{Object.defineProperty(Ht,Xs,{get:()=>ie[Xs]})}),Es&&Ht.preventDefault(),Ki&&Ne.dispatchEvent(Ht),Ht.defaultPrevented&&Ai!==void 0&&Ai.preventDefault(),Ht}},ki=new Map;var wi={set(Ne,H,ie){ki.has(Ne)||ki.set(Ne,new Map);const Ce=ki.get(Ne);Ce.has(H)||Ce.size===0?Ce.set(H,ie):console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(Ce.keys())[0]}.`)},get:(Ne,H)=>ki.has(Ne)&&ki.get(Ne).get(H)||null,remove(Ne,H){if(!ki.has(Ne))return;const ie=ki.get(Ne);ie.delete(H),ie.size===0&&ki.delete(Ne)}};class jt{constructor(H){(H=b(H))&&(this._element=H,wi.set(this._element,this.constructor.DATA_KEY,this))}dispose(){wi.remove(this._element,this.constructor.DATA_KEY),Ze.off(this._element,this.constructor.EVENT_KEY),Object.getOwnPropertyNames(this).forEach(H=>{this[H]=null})}_queueCallback(H,ie,Ce=!0){A(H,ie,Ce)}static getInstance(H){return wi.get(H,this.DATA_KEY)}static getOrCreateInstance(H,ie={}){return this.getInstance(H)||new this(H,typeof ie=="object"?ie:null)}static get VERSION(){return"5.0.2"}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}static get DATA_KEY(){return"bs."+this.NAME}static get EVENT_KEY(){return"."+this.DATA_KEY}}class Yt extends jt{static get NAME(){return"alert"}close(H){const ie=H?this._getRootElement(H):this._element,Ce=this._triggerCloseEvent(ie);Ce===null||Ce.defaultPrevented||this._removeElement(ie)}_getRootElement(H){return d(H)||H.closest(".alert")}_triggerCloseEvent(H){return Ze.trigger(H,"close.bs.alert")}_removeElement(H){H.classList.remove("show");const ie=H.classList.contains("fade");this._queueCallback(()=>this._destroyElement(H),H,ie)}_destroyElement(H){H.remove(),Ze.trigger(H,"closed.bs.alert")}static jQueryInterface(H){return this.each(function(){const ie=Yt.getOrCreateInstance(this);H==="close"&&ie[H](this)})}static handleDismiss(H){return function(ie){ie&&ie.preventDefault(),H.close(this)}}}Ze.on(document,"click.bs.alert.data-api",'[data-bs-dismiss="alert"]',Yt.handleDismiss(new Yt)),te(Yt);class Ei extends jt{static get NAME(){return"button"}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle("active"))}static jQueryInterface(H){return this.each(function(){const ie=Ei.getOrCreateInstance(this);H==="toggle"&&ie[H]()})}}function ii(Ne){return Ne==="true"||Ne!=="false"&&(Ne===Number(Ne).toString()?Number(Ne):Ne===""||Ne==="null"?null:Ne)}function hi(Ne){return Ne.replace(/[A-Z]/g,H=>"-"+H.toLowerCase())}Ze.on(document,"click.bs.button.data-api",'[data-bs-toggle="button"]',Ne=>{Ne.preventDefault();const H=Ne.target.closest('[data-bs-toggle="button"]');Ei.getOrCreateInstance(H).toggle()}),te(Ei);const Gt={setDataAttribute(Ne,H,ie){Ne.setAttribute("data-bs-"+hi(H),ie)},removeDataAttribute(Ne,H){Ne.removeAttribute("data-bs-"+hi(H))},getDataAttributes(Ne){if(!Ne)return{};const H={};return Object.keys(Ne.dataset).filter(ie=>ie.startsWith("bs")).forEach(ie=>{let Ce=ie.replace(/^bs/,"");Ce=Ce.charAt(0).toLowerCase()+Ce.slice(1,Ce.length),H[Ce]=ii(Ne.dataset[ie])}),H},getDataAttribute:(Ne,H)=>ii(Ne.getAttribute("data-bs-"+hi(H))),offset(Ne){const H=Ne.getBoundingClientRect();return{top:H.top+document.body.scrollTop,left:H.left+document.body.scrollLeft}},position:Ne=>({top:Ne.offsetTop,left:Ne.offsetLeft})},es={interval:5e3,keyboard:!0,slide:!1,pause:"hover",wrap:!0,touch:!0},js={interval:"(number|boolean)",keyboard:"boolean",slide:"(boolean|string)",pause:"(string|boolean)",wrap:"boolean",touch:"boolean"},ps="next",mi="prev",$i="left",ws="right",pn={ArrowLeft:ws,ArrowRight:$i};class Mt extends jt{constructor(H,ie){super(H),this._items=null,this._interval=null,this._activeElement=null,this._isPaused=!1,this._isSliding=!1,this.touchTimeout=null,this.touchStartX=0,this.touchDeltaX=0,this._config=this._getConfig(ie),this._indicatorsElement=n.findOne(".carousel-indicators",this._element),this._touchSupported="ontouchstart"in document.documentElement||navigator.maxTouchPoints>0,this._pointerEvent=!!window.PointerEvent,this._addEventListeners()}static get Default(){return es}static get NAME(){return"carousel"}next(){this._slide(ps)}nextWhenVisible(){!document.hidden&&C(this._element)&&this.next()}prev(){this._slide(mi)}pause(H){H||(this._isPaused=!0),n.findOne(".carousel-item-next, .carousel-item-prev",this._element)&&(f(this._element),this.cycle(!0)),clearInterval(this._interval),this._interval=null}cycle(H){H||(this._isPaused=!1),this._interval&&(clearInterval(this._interval),this._interval=null),this._config&&this._config.interval&&!this._isPaused&&(this._updateInterval(),this._interval=setInterval((document.visibilityState?this.nextWhenVisible:this.next).bind(this),this._config.interval))}to(H){this._activeElement=n.findOne(".active.carousel-item",this._element);const ie=this._getItemIndex(this._activeElement);if(H>this._items.length-1||H<0)return;if(this._isSliding)return void Ze.one(this._element,"slid.bs.carousel",()=>this.to(H));if(ie===H)return this.pause(),void this.cycle();const Ce=H>ie?ps:mi;this._slide(Ce,this._items[H])}_getConfig(H){return H={...es,...Gt.getDataAttributes(this._element),...typeof H=="object"?H:{}},T("carousel",H,js),H}_handleSwipe(){const H=Math.abs(this.touchDeltaX);if(H<=40)return;const ie=H/this.touchDeltaX;this.touchDeltaX=0,ie&&this._slide(ie>0?ws:$i)}_addEventListeners(){this._config.keyboard&&Ze.on(this._element,"keydown.bs.carousel",H=>this._keydown(H)),this._config.pause==="hover"&&(Ze.on(this._element,"mouseenter.bs.carousel",H=>this.pause(H)),Ze.on(this._element,"mouseleave.bs.carousel",H=>this.cycle(H))),this._config.touch&&this._touchSupported&&this._addTouchEventListeners()}_addTouchEventListeners(){const H=Ae=>{!this._pointerEvent||Ae.pointerType!=="pen"&&Ae.pointerType!=="touch"?this._pointerEvent||(this.touchStartX=Ae.touches[0].clientX):this.touchStartX=Ae.clientX},ie=Ae=>{this.touchDeltaX=Ae.touches&&Ae.touches.length>1?0:Ae.touches[0].clientX-this.touchStartX},Ce=Ae=>{!this._pointerEvent||Ae.pointerType!=="pen"&&Ae.pointerType!=="touch"||(this.touchDeltaX=Ae.clientX-this.touchStartX),this._handleSwipe(),this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(nt=>this.cycle(nt),500+this._config.interval))};n.find(".carousel-item img",this._element).forEach(Ae=>{Ze.on(Ae,"dragstart.bs.carousel",nt=>nt.preventDefault())}),this._pointerEvent?(Ze.on(this._element,"pointerdown.bs.carousel",Ae=>H(Ae)),Ze.on(this._element,"pointerup.bs.carousel",Ae=>Ce(Ae)),this._element.classList.add("pointer-event")):(Ze.on(this._element,"touchstart.bs.carousel",Ae=>H(Ae)),Ze.on(this._element,"touchmove.bs.carousel",Ae=>ie(Ae)),Ze.on(this._element,"touchend.bs.carousel",Ae=>Ce(Ae)))}_keydown(H){if(/input|textarea/i.test(H.target.tagName))return;const ie=pn[H.key];ie&&(H.preventDefault(),this._slide(ie))}_getItemIndex(H){return this._items=H&&H.parentNode?n.find(".carousel-item",H.parentNode):[],this._items.indexOf(H)}_getItemByOrder(H,ie){const Ce=H===ps;return me(this._items,ie,Ce,this._config.wrap)}_triggerSlideEvent(H,ie){const Ce=this._getItemIndex(H),Ae=this._getItemIndex(n.findOne(".active.carousel-item",this._element));return Ze.trigger(this._element,"slide.bs.carousel",{relatedTarget:H,direction:ie,from:Ae,to:Ce})}_setActiveIndicatorElement(H){if(this._indicatorsElement){const ie=n.findOne(".active",this._indicatorsElement);ie.classList.remove("active"),ie.removeAttribute("aria-current");const Ce=n.find("[data-bs-target]",this._indicatorsElement);for(let Ae=0;Ae<Ce.length;Ae++)if(Number.parseInt(Ce[Ae].getAttribute("data-bs-slide-to"),10)===this._getItemIndex(H)){Ce[Ae].classList.add("active"),Ce[Ae].setAttribute("aria-current","true");break}}}_updateInterval(){const H=this._activeElement||n.findOne(".active.carousel-item",this._element);if(!H)return;const ie=Number.parseInt(H.getAttribute("data-bs-interval"),10);ie?(this._config.defaultInterval=this._config.defaultInterval||this._config.interval,this._config.interval=ie):this._config.interval=this._config.defaultInterval||this._config.interval}_slide(H,ie){const Ce=this._directionToOrder(H),Ae=n.findOne(".active.carousel-item",this._element),nt=this._getItemIndex(Ae),Dt=ie||this._getItemByOrder(Ce,Ae),Ai=this._getItemIndex(Dt),Di=!!this._interval,Ki=Ce===ps,Es=Ki?"carousel-item-start":"carousel-item-end",Ht=Ki?"carousel-item-next":"carousel-item-prev",Xs=this._orderToDirection(Ce);if(Dt&&Dt.classList.contains("active"))return void(this._isSliding=!1);if(this._isSliding||this._triggerSlideEvent(Dt,Xs).defaultPrevented||!Ae||!Dt)return;this._isSliding=!0,Di&&this.pause(),this._setActiveIndicatorElement(Dt),this._activeElement=Dt;const ks=()=>{Ze.trigger(this._element,"slid.bs.carousel",{relatedTarget:Dt,direction:Xs,from:nt,to:Ai})};if(this._element.classList.contains("slide")){Dt.classList.add(Ht),F(Dt),Ae.classList.add(Es),Dt.classList.add(Es);const nn=()=>{Dt.classList.remove(Es,Ht),Dt.classList.add("active"),Ae.classList.remove("active",Ht,Es),this._isSliding=!1,setTimeout(ks,0)};this._queueCallback(nn,Ae,!0)}else Ae.classList.remove("active"),Dt.classList.add("active"),this._isSliding=!1,ks();Di&&this.cycle()}_directionToOrder(H){return[ws,$i].includes(H)?K()?H===$i?mi:ps:H===$i?ps:mi:H}_orderToDirection(H){return[ps,mi].includes(H)?K()?H===mi?$i:ws:H===mi?ws:$i:H}static carouselInterface(H,ie){const Ce=Mt.getOrCreateInstance(H,ie);let{_config:Ae}=Ce;typeof ie=="object"&&(Ae={...Ae,...ie});const nt=typeof ie=="string"?ie:Ae.slide;if(typeof ie=="number")Ce.to(ie);else if(typeof nt=="string"){if(Ce[nt]===void 0)throw new TypeError(`No method named "${nt}"`);Ce[nt]()}else Ae.interval&&Ae.ride&&(Ce.pause(),Ce.cycle())}static jQueryInterface(H){return this.each(function(){Mt.carouselInterface(this,H)})}static dataApiClickHandler(H){const ie=d(this);if(!ie||!ie.classList.contains("carousel"))return;const Ce={...Gt.getDataAttributes(ie),...Gt.getDataAttributes(this)},Ae=this.getAttribute("data-bs-slide-to");Ae&&(Ce.interval=!1),Mt.carouselInterface(ie,Ce),Ae&&Mt.getInstance(ie).to(Ae),H.preventDefault()}}Ze.on(document,"click.bs.carousel.data-api","[data-bs-slide], [data-bs-slide-to]",Mt.dataApiClickHandler),Ze.on(window,"load.bs.carousel.data-api",()=>{const Ne=n.find('[data-bs-ride="carousel"]');for(let H=0,ie=Ne.length;H<ie;H++)Mt.carouselInterface(Ne[H],Mt.getInstance(Ne[H]))}),te(Mt);const Mi={toggle:!0,parent:""},Fe={toggle:"boolean",parent:"(string|element)"};class Pi extends jt{constructor(H,ie){super(H),this._isTransitioning=!1,this._config=this._getConfig(ie),this._triggerArray=n.find(`[data-bs-toggle="collapse"][href="#${this._element.id}"],[data-bs-toggle="collapse"][data-bs-target="#${this._element.id}"]`);const Ce=n.find('[data-bs-toggle="collapse"]');for(let Ae=0,nt=Ce.length;Ae<nt;Ae++){const Dt=Ce[Ae],Ai=c(Dt),Di=n.find(Ai).filter(Ki=>Ki===this._element);Ai!==null&&Di.length&&(this._selector=Ai,this._triggerArray.push(Dt))}this._parent=this._config.parent?this._getParent():null,this._config.parent||this._addAriaAndCollapsedClass(this._element,this._triggerArray),this._config.toggle&&this.toggle()}static get Default(){return Mi}static get NAME(){return"collapse"}toggle(){this._element.classList.contains("show")?this.hide():this.show()}show(){if(this._isTransitioning||this._element.classList.contains("show"))return;let H,ie;this._parent&&(H=n.find(".show, .collapsing",this._parent).filter(Dt=>typeof this._config.parent=="string"?Dt.getAttribute("data-bs-parent")===this._config.parent:Dt.classList.contains("collapse")),H.length===0&&(H=null));const Ce=n.findOne(this._selector);if(H){const Dt=H.find(Ai=>Ce!==Ai);if(ie=Dt?Pi.getInstance(Dt):null,ie&&ie._isTransitioning)return}if(Ze.trigger(this._element,"show.bs.collapse").defaultPrevented)return;H&&H.forEach(Dt=>{Ce!==Dt&&Pi.collapseInterface(Dt,"hide"),ie||wi.set(Dt,"bs.collapse",null)});const Ae=this._getDimension();this._element.classList.remove("collapse"),this._element.classList.add("collapsing"),this._element.style[Ae]=0,this._triggerArray.length&&this._triggerArray.forEach(Dt=>{Dt.classList.remove("collapsed"),Dt.setAttribute("aria-expanded",!0)}),this.setTransitioning(!0);const nt="scroll"+(Ae[0].toUpperCase()+Ae.slice(1));this._queueCallback(()=>{this._element.classList.remove("collapsing"),this._element.classList.add("collapse","show"),this._element.style[Ae]="",this.setTransitioning(!1),Ze.trigger(this._element,"shown.bs.collapse")},this._element,!0),this._element.style[Ae]=this._element[nt]+"px"}hide(){if(this._isTransitioning||!this._element.classList.contains("show")||Ze.trigger(this._element,"hide.bs.collapse").defaultPrevented)return;const H=this._getDimension();this._element.style[H]=this._element.getBoundingClientRect()[H]+"px",F(this._element),this._element.classList.add("collapsing"),this._element.classList.remove("collapse","show");const ie=this._triggerArray.length;if(ie>0)for(let Ce=0;Ce<ie;Ce++){const Ae=this._triggerArray[Ce],nt=d(Ae);nt&&!nt.classList.contains("show")&&(Ae.classList.add("collapsed"),Ae.setAttribute("aria-expanded",!1))}this.setTransitioning(!0),this._element.style[H]="",this._queueCallback(()=>{this.setTransitioning(!1),this._element.classList.remove("collapsing"),this._element.classList.add("collapse"),Ze.trigger(this._element,"hidden.bs.collapse")},this._element,!0)}setTransitioning(H){this._isTransitioning=H}_getConfig(H){return(H={...Mi,...H}).toggle=!!H.toggle,T("collapse",H,Fe),H}_getDimension(){return this._element.classList.contains("width")?"width":"height"}_getParent(){let{parent:H}=this._config;H=b(H);const ie=`[data-bs-toggle="collapse"][data-bs-parent="${H}"]`;return n.find(ie,H).forEach(Ce=>{const Ae=d(Ce);this._addAriaAndCollapsedClass(Ae,[Ce])}),H}_addAriaAndCollapsedClass(H,ie){if(!H||!ie.length)return;const Ce=H.classList.contains("show");ie.forEach(Ae=>{Ce?Ae.classList.remove("collapsed"):Ae.classList.add("collapsed"),Ae.setAttribute("aria-expanded",Ce)})}static collapseInterface(H,ie){let Ce=Pi.getInstance(H);const Ae={...Mi,...Gt.getDataAttributes(H),...typeof ie=="object"&&ie?ie:{}};if(!Ce&&Ae.toggle&&typeof ie=="string"&&/show|hide/.test(ie)&&(Ae.toggle=!1),Ce||(Ce=new Pi(H,Ae)),typeof ie=="string"){if(Ce[ie]===void 0)throw new TypeError(`No method named "${ie}"`);Ce[ie]()}}static jQueryInterface(H){return this.each(function(){Pi.collapseInterface(this,H)})}}Ze.on(document,"click.bs.collapse.data-api",'[data-bs-toggle="collapse"]',function(Ne){(Ne.target.tagName==="A"||Ne.delegateTarget&&Ne.delegateTarget.tagName==="A")&&Ne.preventDefault();const H=Gt.getDataAttributes(this),ie=c(this);n.find(ie).forEach(Ce=>{const Ae=Pi.getInstance(Ce);let nt;Ae?(Ae._parent===null&&typeof H.parent=="string"&&(Ae._config.parent=H.parent,Ae._parent=Ae._getParent()),nt="toggle"):nt=H,Pi.collapseInterface(Ce,nt)})}),te(Pi);const qs=new RegExp("ArrowUp|ArrowDown|Escape"),Bt=K()?"top-end":"top-start",ts=K()?"top-start":"top-end",de=K()?"bottom-end":"bottom-start",Te=K()?"bottom-start":"bottom-end",Me=K()?"left-start":"right-start",Xe=K()?"right-start":"left-start",mt={offset:[0,2],boundary:"clippingParents",reference:"toggle",display:"dynamic",popperConfig:null,autoClose:!0},ft={offset:"(array|string|function)",boundary:"(string|element)",reference:"(string|element|object)",display:"string",popperConfig:"(null|object|function)",autoClose:"(boolean|string)"};class wt extends jt{constructor(H,ie){super(H),this._popper=null,this._config=this._getConfig(ie),this._menu=this._getMenuElement(),this._inNavbar=this._detectNavbar(),this._addEventListeners()}static get Default(){return mt}static get DefaultType(){return ft}static get NAME(){return"dropdown"}toggle(){P(this._element)||(this._element.classList.contains("show")?this.hide():this.show())}show(){if(P(this._element)||this._menu.classList.contains("show"))return;const H=wt.getParentFromElement(this._element),ie={relatedTarget:this._element};if(!Ze.trigger(this._element,"show.bs.dropdown",ie).defaultPrevented){if(this._inNavbar)Gt.setDataAttribute(this._menu,"popper","none");else{if(i===void 0)throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org)");let Ce=this._element;this._config.reference==="parent"?Ce=H:m(this._config.reference)?Ce=b(this._config.reference):typeof this._config.reference=="object"&&(Ce=this._config.reference);const Ae=this._getPopperConfig(),nt=Ae.modifiers.find(Dt=>Dt.name==="applyStyles"&&Dt.enabled===!1);this._popper=i.createPopper(Ce,this._menu,Ae),nt&&Gt.setDataAttribute(this._menu,"popper","static")}"ontouchstart"in document.documentElement&&!H.closest(".navbar-nav")&&[].concat(...document.body.children).forEach(Ce=>Ze.on(Ce,"mouseover",L)),this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.toggle("show"),this._element.classList.toggle("show"),Ze.trigger(this._element,"shown.bs.dropdown",ie)}}hide(){if(P(this._element)||!this._menu.classList.contains("show"))return;const H={relatedTarget:this._element};this._completeHide(H)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_addEventListeners(){Ze.on(this._element,"click.bs.dropdown",H=>{H.preventDefault(),this.toggle()})}_completeHide(H){Ze.trigger(this._element,"hide.bs.dropdown",H).defaultPrevented||("ontouchstart"in document.documentElement&&[].concat(...document.body.children).forEach(ie=>Ze.off(ie,"mouseover",L)),this._popper&&this._popper.destroy(),this._menu.classList.remove("show"),this._element.classList.remove("show"),this._element.setAttribute("aria-expanded","false"),Gt.removeDataAttribute(this._menu,"popper"),Ze.trigger(this._element,"hidden.bs.dropdown",H))}_getConfig(H){if(H={...this.constructor.Default,...Gt.getDataAttributes(this._element),...H},T("dropdown",H,this.constructor.DefaultType),typeof H.reference=="object"&&!m(H.reference)&&typeof H.reference.getBoundingClientRect!="function")throw new TypeError("dropdown".toUpperCase()+': Option "reference" provided type "object" without a required "getBoundingClientRect" method.');return H}_getMenuElement(){return n.next(this._element,".dropdown-menu")[0]}_getPlacement(){const H=this._element.parentNode;if(H.classList.contains("dropend"))return Me;if(H.classList.contains("dropstart"))return Xe;const ie=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return H.classList.contains("dropup")?ie?ts:Bt:ie?Te:de}_detectNavbar(){return this._element.closest(".navbar")!==null}_getOffset(){const{offset:H}=this._config;return typeof H=="string"?H.split(",").map(ie=>Number.parseInt(ie,10)):typeof H=="function"?ie=>H(ie,this._element):H}_getPopperConfig(){const H={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return this._config.display==="static"&&(H.modifiers=[{name:"applyStyles",enabled:!1}]),{...H,...typeof this._config.popperConfig=="function"?this._config.popperConfig(H):this._config.popperConfig}}_selectMenuItem({key:H,target:ie}){const Ce=n.find(".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",this._menu).filter(C);Ce.length&&me(Ce,ie,H==="ArrowDown",!Ce.includes(ie)).focus()}static dropdownInterface(H,ie){const Ce=wt.getOrCreateInstance(H,ie);if(typeof ie=="string"){if(Ce[ie]===void 0)throw new TypeError(`No method named "${ie}"`);Ce[ie]()}}static jQueryInterface(H){return this.each(function(){wt.dropdownInterface(this,H)})}static clearMenus(H){if(H&&(H.button===2||H.type==="keyup"&&H.key!=="Tab"))return;const ie=n.find('[data-bs-toggle="dropdown"]');for(let Ce=0,Ae=ie.length;Ce<Ae;Ce++){const nt=wt.getInstance(ie[Ce]);if(!nt||nt._config.autoClose===!1||!nt._element.classList.contains("show"))continue;const Dt={relatedTarget:nt._element};if(H){const Ai=H.composedPath(),Di=Ai.includes(nt._menu);if(Ai.includes(nt._element)||nt._config.autoClose==="inside"&&!Di||nt._config.autoClose==="outside"&&Di||nt._menu.contains(H.target)&&(H.type==="keyup"&&H.key==="Tab"||/input|select|option|textarea|form/i.test(H.target.tagName)))continue;H.type==="click"&&(Dt.clickEvent=H)}nt._completeHide(Dt)}}static getParentFromElement(H){return d(H)||H.parentNode}static dataApiKeydownHandler(H){if(/input|textarea/i.test(H.target.tagName)?H.key==="Space"||H.key!=="Escape"&&(H.key!=="ArrowDown"&&H.key!=="ArrowUp"||H.target.closest(".dropdown-menu")):!qs.test(H.key))return;const ie=this.classList.contains("show");if(!ie&&H.key==="Escape"||(H.preventDefault(),H.stopPropagation(),P(this)))return;const Ce=()=>this.matches('[data-bs-toggle="dropdown"]')?this:n.prev(this,'[data-bs-toggle="dropdown"]')[0];return H.key==="Escape"?(Ce().focus(),void wt.clearMenus()):H.key==="ArrowUp"||H.key==="ArrowDown"?(ie||Ce().click(),void wt.getInstance(Ce())._selectMenuItem(H)):void(ie&&H.key!=="Space"||wt.clearMenus())}}Ze.on(document,"keydown.bs.dropdown.data-api",'[data-bs-toggle="dropdown"]',wt.dataApiKeydownHandler),Ze.on(document,"keydown.bs.dropdown.data-api",".dropdown-menu",wt.dataApiKeydownHandler),Ze.on(document,"click.bs.dropdown.data-api",wt.clearMenus),Ze.on(document,"keyup.bs.dropdown.data-api",wt.clearMenus),Ze.on(document,"click.bs.dropdown.data-api",'[data-bs-toggle="dropdown"]',function(Ne){Ne.preventDefault(),wt.dropdownInterface(this)}),te(wt);class $t{constructor(){this._element=document.body}getWidth(){const H=document.documentElement.clientWidth;return Math.abs(window.innerWidth-H)}hide(){const H=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,"paddingRight",ie=>ie+H),this._setElementAttributes(".fixed-top, .fixed-bottom, .is-fixed, .sticky-top","paddingRight",ie=>ie+H),this._setElementAttributes(".sticky-top","marginRight",ie=>ie-H)}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(H,ie,Ce){const Ae=this.getWidth();this._applyManipulationCallback(H,nt=>{if(nt!==this._element&&window.innerWidth>nt.clientWidth+Ae)return;this._saveInitialAttribute(nt,ie);const Dt=window.getComputedStyle(nt)[ie];nt.style[ie]=Ce(Number.parseFloat(Dt))+"px"})}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,"paddingRight"),this._resetElementAttributes(".fixed-top, .fixed-bottom, .is-fixed, .sticky-top","paddingRight"),this._resetElementAttributes(".sticky-top","marginRight")}_saveInitialAttribute(H,ie){const Ce=H.style[ie];Ce&&Gt.setDataAttribute(H,ie,Ce)}_resetElementAttributes(H,ie){this._applyManipulationCallback(H,Ce=>{const Ae=Gt.getDataAttribute(Ce,ie);Ae===void 0?Ce.style.removeProperty(ie):(Gt.removeDataAttribute(Ce,ie),Ce.style[ie]=Ae)})}_applyManipulationCallback(H,ie){m(H)?ie(H):n.find(H,this._element).forEach(ie)}isOverflowing(){return this.getWidth()>0}}const oe={isVisible:!0,isAnimated:!1,rootElement:"body",clickCallback:null},et={isVisible:"boolean",isAnimated:"boolean",rootElement:"(element|string)",clickCallback:"(function|null)"};class ht{constructor(H){this._config=this._getConfig(H),this._isAppended=!1,this._element=null}show(H){this._config.isVisible?(this._append(),this._config.isAnimated&&F(this._getElement()),this._getElement().classList.add("show"),this._emulateAnimation(()=>{ee(H)})):ee(H)}hide(H){this._config.isVisible?(this._getElement().classList.remove("show"),this._emulateAnimation(()=>{this.dispose(),ee(H)})):ee(H)}_getElement(){if(!this._element){const H=document.createElement("div");H.className="modal-backdrop",this._config.isAnimated&&H.classList.add("fade"),this._element=H}return this._element}_getConfig(H){return(H={...oe,...typeof H=="object"?H:{}}).rootElement=b(H.rootElement),T("backdrop",H,et),H}_append(){this._isAppended||(this._config.rootElement.appendChild(this._getElement()),Ze.on(this._getElement(),"mousedown.bs.backdrop",()=>{ee(this._config.clickCallback)}),this._isAppended=!0)}dispose(){this._isAppended&&(Ze.off(this._element,"mousedown.bs.backdrop"),this._element.remove(),this._isAppended=!1)}_emulateAnimation(H){A(H,this._getElement(),this._config.isAnimated)}}const pt={backdrop:!0,keyboard:!0,focus:!0},ke={backdrop:"(boolean|string)",keyboard:"boolean",focus:"boolean"};class He extends jt{constructor(H,ie){super(H),this._config=this._getConfig(ie),this._dialog=n.findOne(".modal-dialog",this._element),this._backdrop=this._initializeBackDrop(),this._isShown=!1,this._ignoreBackdropClick=!1,this._isTransitioning=!1,this._scrollBar=new $t}static get Default(){return pt}static get NAME(){return"modal"}toggle(H){return this._isShown?this.hide():this.show(H)}show(H){this._isShown||this._isTransitioning||Ze.trigger(this._element,"show.bs.modal",{relatedTarget:H}).defaultPrevented||(this._isShown=!0,this._isAnimated()&&(this._isTransitioning=!0),this._scrollBar.hide(),document.body.classList.add("modal-open"),this._adjustDialog(),this._setEscapeEvent(),this._setResizeEvent(),Ze.on(this._element,"click.dismiss.bs.modal",'[data-bs-dismiss="modal"]',ie=>this.hide(ie)),Ze.on(this._dialog,"mousedown.dismiss.bs.modal",()=>{Ze.one(this._element,"mouseup.dismiss.bs.modal",ie=>{ie.target===this._element&&(this._ignoreBackdropClick=!0)})}),this._showBackdrop(()=>this._showElement(H)))}hide(H){if(H&&["A","AREA"].includes(H.target.tagName)&&H.preventDefault(),!this._isShown||this._isTransitioning||Ze.trigger(this._element,"hide.bs.modal").defaultPrevented)return;this._isShown=!1;const ie=this._isAnimated();ie&&(this._isTransitioning=!0),this._setEscapeEvent(),this._setResizeEvent(),Ze.off(document,"focusin.bs.modal"),this._element.classList.remove("show"),Ze.off(this._element,"click.dismiss.bs.modal"),Ze.off(this._dialog,"mousedown.dismiss.bs.modal"),this._queueCallback(()=>this._hideModal(),this._element,ie)}dispose(){[window,this._dialog].forEach(H=>Ze.off(H,".bs.modal")),this._backdrop.dispose(),super.dispose(),Ze.off(document,"focusin.bs.modal")}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new ht({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_getConfig(H){return H={...pt,...Gt.getDataAttributes(this._element),...typeof H=="object"?H:{}},T("modal",H,ke),H}_showElement(H){const ie=this._isAnimated(),Ce=n.findOne(".modal-body",this._dialog);this._element.parentNode&&this._element.parentNode.nodeType===Node.ELEMENT_NODE||document.body.appendChild(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0,Ce&&(Ce.scrollTop=0),ie&&F(this._element),this._element.classList.add("show"),this._config.focus&&this._enforceFocus(),this._queueCallback(()=>{this._config.focus&&this._element.focus(),this._isTransitioning=!1,Ze.trigger(this._element,"shown.bs.modal",{relatedTarget:H})},this._dialog,ie)}_enforceFocus(){Ze.off(document,"focusin.bs.modal"),Ze.on(document,"focusin.bs.modal",H=>{document===H.target||this._element===H.target||this._element.contains(H.target)||this._element.focus()})}_setEscapeEvent(){this._isShown?Ze.on(this._element,"keydown.dismiss.bs.modal",H=>{this._config.keyboard&&H.key==="Escape"?(H.preventDefault(),this.hide()):this._config.keyboard||H.key!=="Escape"||this._triggerBackdropTransition()}):Ze.off(this._element,"keydown.dismiss.bs.modal")}_setResizeEvent(){this._isShown?Ze.on(window,"resize.bs.modal",()=>this._adjustDialog()):Ze.off(window,"resize.bs.modal")}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove("modal-open"),this._resetAdjustments(),this._scrollBar.reset(),Ze.trigger(this._element,"hidden.bs.modal")})}_showBackdrop(H){Ze.on(this._element,"click.dismiss.bs.modal",ie=>{this._ignoreBackdropClick?this._ignoreBackdropClick=!1:ie.target===ie.currentTarget&&(this._config.backdrop===!0?this.hide():this._config.backdrop==="static"&&this._triggerBackdropTransition())}),this._backdrop.show(H)}_isAnimated(){return this._element.classList.contains("fade")}_triggerBackdropTransition(){if(Ze.trigger(this._element,"hidePrevented.bs.modal").defaultPrevented)return;const{classList:H,scrollHeight:ie,style:Ce}=this._element,Ae=ie>document.documentElement.clientHeight;!Ae&&Ce.overflowY==="hidden"||H.contains("modal-static")||(Ae||(Ce.overflowY="hidden"),H.add("modal-static"),this._queueCallback(()=>{H.remove("modal-static"),Ae||this._queueCallback(()=>{Ce.overflowY=""},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const H=this._element.scrollHeight>document.documentElement.clientHeight,ie=this._scrollBar.getWidth(),Ce=ie>0;(!Ce&&H&&!K()||Ce&&!H&&K())&&(this._element.style.paddingLeft=ie+"px"),(Ce&&!H&&!K()||!Ce&&H&&K())&&(this._element.style.paddingRight=ie+"px")}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(H,ie){return this.each(function(){const Ce=He.getOrCreateInstance(this,H);if(typeof H=="string"){if(Ce[H]===void 0)throw new TypeError(`No method named "${H}"`);Ce[H](ie)}})}}Ze.on(document,"click.bs.modal.data-api",'[data-bs-toggle="modal"]',function(Ne){const H=d(this);["A","AREA"].includes(this.tagName)&&Ne.preventDefault(),Ze.one(H,"show.bs.modal",ie=>{ie.defaultPrevented||Ze.one(H,"hidden.bs.modal",()=>{C(this)&&this.focus()})}),He.getOrCreateInstance(H).toggle(this)}),te(He);const ne={backdrop:!0,keyboard:!0,scroll:!1},tt={backdrop:"boolean",keyboard:"boolean",scroll:"boolean"};class xt extends jt{constructor(H,ie){super(H),this._config=this._getConfig(ie),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._addEventListeners()}static get NAME(){return"offcanvas"}static get Default(){return ne}toggle(H){return this._isShown?this.hide():this.show(H)}show(H){this._isShown||Ze.trigger(this._element,"show.bs.offcanvas",{relatedTarget:H}).defaultPrevented||(this._isShown=!0,this._element.style.visibility="visible",this._backdrop.show(),this._config.scroll||(new $t().hide(),this._enforceFocusOnElement(this._element)),this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add("show"),this._queueCallback(()=>{Ze.trigger(this._element,"shown.bs.offcanvas",{relatedTarget:H})},this._element,!0))}hide(){this._isShown&&(Ze.trigger(this._element,"hide.bs.offcanvas").defaultPrevented||(Ze.off(document,"focusin.bs.offcanvas"),this._element.blur(),this._isShown=!1,this._element.classList.remove("show"),this._backdrop.hide(),this._queueCallback(()=>{this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._element.style.visibility="hidden",this._config.scroll||new $t().reset(),Ze.trigger(this._element,"hidden.bs.offcanvas")},this._element,!0)))}dispose(){this._backdrop.dispose(),super.dispose(),Ze.off(document,"focusin.bs.offcanvas")}_getConfig(H){return H={...ne,...Gt.getDataAttributes(this._element),...typeof H=="object"?H:{}},T("offcanvas",H,tt),H}_initializeBackDrop(){return new ht({isVisible:this._config.backdrop,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:()=>this.hide()})}_enforceFocusOnElement(H){Ze.off(document,"focusin.bs.offcanvas"),Ze.on(document,"focusin.bs.offcanvas",ie=>{document===ie.target||H===ie.target||H.contains(ie.target)||H.focus()}),H.focus()}_addEventListeners(){Ze.on(this._element,"click.dismiss.bs.offcanvas",'[data-bs-dismiss="offcanvas"]',()=>this.hide()),Ze.on(this._element,"keydown.dismiss.bs.offcanvas",H=>{this._config.keyboard&&H.key==="Escape"&&this.hide()})}static jQueryInterface(H){return this.each(function(){const ie=xt.getOrCreateInstance(this,H);if(typeof H=="string"){if(ie[H]===void 0||H.startsWith("_")||H==="constructor")throw new TypeError(`No method named "${H}"`);ie[H](this)}})}}Ze.on(document,"click.bs.offcanvas.data-api",'[data-bs-toggle="offcanvas"]',function(Ne){const H=d(this);if(["A","AREA"].includes(this.tagName)&&Ne.preventDefault(),P(this))return;Ze.one(H,"hidden.bs.offcanvas",()=>{C(this)&&this.focus()});const ie=n.findOne(".offcanvas.show");ie&&ie!==H&&xt.getInstance(ie).hide(),xt.getOrCreateInstance(H).toggle(this)}),Ze.on(window,"load.bs.offcanvas.data-api",()=>n.find(".offcanvas.show").forEach(Ne=>xt.getOrCreateInstance(Ne).show())),te(xt);const z=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),We=/^(?:(?:https?|mailto|ftp|tel|file):|[^#&/:?]*(?:[#/?]|$))/i,qe=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[\d+/a-z]+=*$/i,le=(Ne,H)=>{const ie=Ne.nodeName.toLowerCase();if(H.includes(ie))return!z.has(ie)||!!(We.test(Ne.nodeValue)||qe.test(Ne.nodeValue));const Ce=H.filter(Ae=>Ae instanceof RegExp);for(let Ae=0,nt=Ce.length;Ae<nt;Ae++)if(Ce[Ae].test(ie))return!0;return!1};function De(Ne,H,ie){if(!Ne.length)return Ne;if(ie&&typeof ie=="function")return ie(Ne);const Ce=new window.DOMParser().parseFromString(Ne,"text/html"),Ae=Object.keys(H),nt=[].concat(...Ce.body.querySelectorAll("*"));for(let Dt=0,Ai=nt.length;Dt<Ai;Dt++){const Di=nt[Dt],Ki=Di.nodeName.toLowerCase();if(!Ae.includes(Ki)){Di.remove();continue}const Es=[].concat(...Di.attributes),Ht=[].concat(H["*"]||[],H[Ki]||[]);Es.forEach(Xs=>{le(Xs,Ht)||Di.removeAttribute(Xs.nodeName)})}return Ce.body.innerHTML}const Ge=new RegExp("(^|\\s)bs-tooltip\\S+","g"),Ot=new Set(["sanitize","allowList","sanitizeFn"]),Ct={animation:"boolean",template:"string",title:"(string|element|function)",trigger:"string",delay:"(number|object)",html:"boolean",selector:"(string|boolean)",placement:"(string|function)",offset:"(array|string|function)",container:"(string|element|boolean)",fallbackPlacements:"array",boundary:"(string|element)",customClass:"(string|function)",sanitize:"boolean",sanitizeFn:"(null|function)",allowList:"object",popperConfig:"(null|object|function)"},It={AUTO:"auto",TOP:"top",RIGHT:K()?"left":"right",BOTTOM:"bottom",LEFT:K()?"right":"left"},ni={animation:!0,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,selector:!1,placement:"top",offset:[0,0],container:!1,fallbackPlacements:["top","right","bottom","left"],boundary:"clippingParents",customClass:"",sanitize:!0,sanitizeFn:null,allowList:{"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],div:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},popperConfig:null},Zs={HIDE:"hide.bs.tooltip",HIDDEN:"hidden.bs.tooltip",SHOW:"show.bs.tooltip",SHOWN:"shown.bs.tooltip",INSERTED:"inserted.bs.tooltip",CLICK:"click.bs.tooltip",FOCUSIN:"focusin.bs.tooltip",FOCUSOUT:"focusout.bs.tooltip",MOUSEENTER:"mouseenter.bs.tooltip",MOUSELEAVE:"mouseleave.bs.tooltip"};class bi extends jt{constructor(H,ie){if(i===void 0)throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org)");super(H),this._isEnabled=!0,this._timeout=0,this._hoverState="",this._activeTrigger={},this._popper=null,this._config=this._getConfig(ie),this.tip=null,this._setListeners()}static get Default(){return ni}static get NAME(){return"tooltip"}static get Event(){return Zs}static get DefaultType(){return Ct}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(H){if(this._isEnabled)if(H){const ie=this._initializeOnDelegatedTarget(H);ie._activeTrigger.click=!ie._activeTrigger.click,ie._isWithActiveTrigger()?ie._enter(null,ie):ie._leave(null,ie)}else{if(this.getTipElement().classList.contains("show"))return void this._leave(null,this);this._enter(null,this)}}dispose(){clearTimeout(this._timeout),Ze.off(this._element.closest(".modal"),"hide.bs.modal",this._hideModalHandler),this.tip&&this.tip.remove(),this._popper&&this._popper.destroy(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!this.isWithContent()||!this._isEnabled)return;const H=Ze.trigger(this._element,this.constructor.Event.SHOW),ie=x(this._element),Ce=ie===null?this._element.ownerDocument.documentElement.contains(this._element):ie.contains(this._element);if(H.defaultPrevented||!Ce)return;const Ae=this.getTipElement(),nt=o(this.constructor.NAME);Ae.setAttribute("id",nt),this._element.setAttribute("aria-describedby",nt),this.setContent(),this._config.animation&&Ae.classList.add("fade");const Dt=typeof this._config.placement=="function"?this._config.placement.call(this,Ae,this._element):this._config.placement,Ai=this._getAttachment(Dt);this._addAttachmentClass(Ai);const{container:Di}=this._config;wi.set(Ae,this.constructor.DATA_KEY,this),this._element.ownerDocument.documentElement.contains(this.tip)||(Di.appendChild(Ae),Ze.trigger(this._element,this.constructor.Event.INSERTED)),this._popper?this._popper.update():this._popper=i.createPopper(this._element,Ae,this._getPopperConfig(Ai)),Ae.classList.add("show");const Ki=typeof this._config.customClass=="function"?this._config.customClass():this._config.customClass;Ki&&Ae.classList.add(...Ki.split(" ")),"ontouchstart"in document.documentElement&&[].concat(...document.body.children).forEach(Ht=>{Ze.on(Ht,"mouseover",L)});const Es=this.tip.classList.contains("fade");this._queueCallback(()=>{const Ht=this._hoverState;this._hoverState=null,Ze.trigger(this._element,this.constructor.Event.SHOWN),Ht==="out"&&this._leave(null,this)},this.tip,Es)}hide(){if(!this._popper)return;const H=this.getTipElement();if(Ze.trigger(this._element,this.constructor.Event.HIDE).defaultPrevented)return;H.classList.remove("show"),"ontouchstart"in document.documentElement&&[].concat(...document.body.children).forEach(Ce=>Ze.off(Ce,"mouseover",L)),this._activeTrigger.click=!1,this._activeTrigger.focus=!1,this._activeTrigger.hover=!1;const ie=this.tip.classList.contains("fade");this._queueCallback(()=>{this._isWithActiveTrigger()||(this._hoverState!=="show"&&H.remove(),this._cleanTipClass(),this._element.removeAttribute("aria-describedby"),Ze.trigger(this._element,this.constructor.Event.HIDDEN),this._popper&&(this._popper.destroy(),this._popper=null))},this.tip,ie),this._hoverState=""}update(){this._popper!==null&&this._popper.update()}isWithContent(){return!!this.getTitle()}getTipElement(){if(this.tip)return this.tip;const H=document.createElement("div");return H.innerHTML=this._config.template,this.tip=H.children[0],this.tip}setContent(){const H=this.getTipElement();this.setElementContent(n.findOne(".tooltip-inner",H),this.getTitle()),H.classList.remove("fade","show")}setElementContent(H,ie){if(H!==null)return m(ie)?(ie=b(ie),void(this._config.html?ie.parentNode!==H&&(H.innerHTML="",H.appendChild(ie)):H.textContent=ie.textContent)):void(this._config.html?(this._config.sanitize&&(ie=De(ie,this._config.allowList,this._config.sanitizeFn)),H.innerHTML=ie):H.textContent=ie)}getTitle(){let H=this._element.getAttribute("data-bs-original-title");return H||(H=typeof this._config.title=="function"?this._config.title.call(this._element):this._config.title),H}updateAttachment(H){return H==="right"?"end":H==="left"?"start":H}_initializeOnDelegatedTarget(H,ie){const Ce=this.constructor.DATA_KEY;return(ie=ie||wi.get(H.delegateTarget,Ce))||(ie=new this.constructor(H.delegateTarget,this._getDelegateConfig()),wi.set(H.delegateTarget,Ce,ie)),ie}_getOffset(){const{offset:H}=this._config;return typeof H=="string"?H.split(",").map(ie=>Number.parseInt(ie,10)):typeof H=="function"?ie=>H(ie,this._element):H}_getPopperConfig(H){const ie={placement:H,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"onChange",enabled:!0,phase:"afterWrite",fn:Ce=>this._handlePopperPlacementChange(Ce)}],onFirstUpdate:Ce=>{Ce.options.placement!==Ce.placement&&this._handlePopperPlacementChange(Ce)}};return{...ie,...typeof this._config.popperConfig=="function"?this._config.popperConfig(ie):this._config.popperConfig}}_addAttachmentClass(H){this.getTipElement().classList.add("bs-tooltip-"+this.updateAttachment(H))}_getAttachment(H){return It[H.toUpperCase()]}_setListeners(){this._config.trigger.split(" ").forEach(H=>{if(H==="click")Ze.on(this._element,this.constructor.Event.CLICK,this._config.selector,ie=>this.toggle(ie));else if(H!=="manual"){const ie=H==="hover"?this.constructor.Event.MOUSEENTER:this.constructor.Event.FOCUSIN,Ce=H==="hover"?this.constructor.Event.MOUSELEAVE:this.constructor.Event.FOCUSOUT;Ze.on(this._element,ie,this._config.selector,Ae=>this._enter(Ae)),Ze.on(this._element,Ce,this._config.selector,Ae=>this._leave(Ae))}}),this._hideModalHandler=()=>{this._element&&this.hide()},Ze.on(this._element.closest(".modal"),"hide.bs.modal",this._hideModalHandler),this._config.selector?this._config={...this._config,trigger:"manual",selector:""}:this._fixTitle()}_fixTitle(){const H=this._element.getAttribute("title"),ie=typeof this._element.getAttribute("data-bs-original-title");(H||ie!=="string")&&(this._element.setAttribute("data-bs-original-title",H||""),!H||this._element.getAttribute("aria-label")||this._element.textContent||this._element.setAttribute("aria-label",H),this._element.setAttribute("title",""))}_enter(H,ie){ie=this._initializeOnDelegatedTarget(H,ie),H&&(ie._activeTrigger[H.type==="focusin"?"focus":"hover"]=!0),ie.getTipElement().classList.contains("show")||ie._hoverState==="show"?ie._hoverState="show":(clearTimeout(ie._timeout),ie._hoverState="show",ie._config.delay&&ie._config.delay.show?ie._timeout=setTimeout(()=>{ie._hoverState==="show"&&ie.show()},ie._config.delay.show):ie.show())}_leave(H,ie){ie=this._initializeOnDelegatedTarget(H,ie),H&&(ie._activeTrigger[H.type==="focusout"?"focus":"hover"]=ie._element.contains(H.relatedTarget)),ie._isWithActiveTrigger()||(clearTimeout(ie._timeout),ie._hoverState="out",ie._config.delay&&ie._config.delay.hide?ie._timeout=setTimeout(()=>{ie._hoverState==="out"&&ie.hide()},ie._config.delay.hide):ie.hide())}_isWithActiveTrigger(){for(const H in this._activeTrigger)if(this._activeTrigger[H])return!0;return!1}_getConfig(H){const ie=Gt.getDataAttributes(this._element);return Object.keys(ie).forEach(Ce=>{Ot.has(Ce)&&delete ie[Ce]}),(H={...this.constructor.Default,...ie,...typeof H=="object"&&H?H:{}}).container=H.container===!1?document.body:b(H.container),typeof H.delay=="number"&&(H.delay={show:H.delay,hide:H.delay}),typeof H.title=="number"&&(H.title=H.title.toString()),typeof H.content=="number"&&(H.content=H.content.toString()),T("tooltip",H,this.constructor.DefaultType),H.sanitize&&(H.template=De(H.template,H.allowList,H.sanitizeFn)),H}_getDelegateConfig(){const H={};if(this._config)for(const ie in this._config)this.constructor.Default[ie]!==this._config[ie]&&(H[ie]=this._config[ie]);return H}_cleanTipClass(){const H=this.getTipElement(),ie=H.getAttribute("class").match(Ge);ie!==null&&ie.length>0&&ie.map(Ce=>Ce.trim()).forEach(Ce=>H.classList.remove(Ce))}_handlePopperPlacementChange(H){const{state:ie}=H;ie&&(this.tip=ie.elements.popper,this._cleanTipClass(),this._addAttachmentClass(this._getAttachment(ie.placement)))}static jQueryInterface(H){return this.each(function(){const ie=bi.getOrCreateInstance(this,H);if(typeof H=="string"){if(ie[H]===void 0)throw new TypeError(`No method named "${H}"`);ie[H]()}})}}te(bi);const Oi=new RegExp("(^|\\s)bs-popover\\S+","g"),gs={...bi.Default,placement:"right",offset:[0,8],trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>'},qi={...bi.DefaultType,content:"(string|element|function)"},Gs={HIDE:"hide.bs.popover",HIDDEN:"hidden.bs.popover",SHOW:"show.bs.popover",SHOWN:"shown.bs.popover",INSERTED:"inserted.bs.popover",CLICK:"click.bs.popover",FOCUSIN:"focusin.bs.popover",FOCUSOUT:"focusout.bs.popover",MOUSEENTER:"mouseenter.bs.popover",MOUSELEAVE:"mouseleave.bs.popover"};class Mn extends bi{static get Default(){return gs}static get NAME(){return"popover"}static get Event(){return Gs}static get DefaultType(){return qi}isWithContent(){return this.getTitle()||this._getContent()}getTipElement(){return this.tip||(this.tip=super.getTipElement(),this.getTitle()||n.findOne(".popover-header",this.tip).remove(),this._getContent()||n.findOne(".popover-body",this.tip).remove()),this.tip}setContent(){const H=this.getTipElement();this.setElementContent(n.findOne(".popover-header",H),this.getTitle());let ie=this._getContent();typeof ie=="function"&&(ie=ie.call(this._element)),this.setElementContent(n.findOne(".popover-body",H),ie),H.classList.remove("fade","show")}_addAttachmentClass(H){this.getTipElement().classList.add("bs-popover-"+this.updateAttachment(H))}_getContent(){return this._element.getAttribute("data-bs-content")||this._config.content}_cleanTipClass(){const H=this.getTipElement(),ie=H.getAttribute("class").match(Oi);ie!==null&&ie.length>0&&ie.map(Ce=>Ce.trim()).forEach(Ce=>H.classList.remove(Ce))}static jQueryInterface(H){return this.each(function(){const ie=Mn.getOrCreateInstance(this,H);if(typeof H=="string"){if(ie[H]===void 0)throw new TypeError(`No method named "${H}"`);ie[H]()}})}}te(Mn);const Sn={offset:10,method:"auto",target:""},ji={offset:"number",method:"string",target:"(string|element)"};class os extends jt{constructor(H,ie){super(H),this._scrollElement=this._element.tagName==="BODY"?window:this._element,this._config=this._getConfig(ie),this._selector=`${this._config.target} .nav-link, ${this._config.target} .list-group-item, ${this._config.target} .dropdown-item`,this._offsets=[],this._targets=[],this._activeTarget=null,this._scrollHeight=0,Ze.on(this._scrollElement,"scroll.bs.scrollspy",()=>this._process()),this.refresh(),this._process()}static get Default(){return Sn}static get NAME(){return"scrollspy"}refresh(){const H=this._scrollElement===this._scrollElement.window?"offset":"position",ie=this._config.method==="auto"?H:this._config.method,Ce=ie==="position"?this._getScrollTop():0;this._offsets=[],this._targets=[],this._scrollHeight=this._getScrollHeight(),n.find(this._selector).map(Ae=>{const nt=c(Ae),Dt=nt?n.findOne(nt):null;if(Dt){const Ai=Dt.getBoundingClientRect();if(Ai.width||Ai.height)return[Gt[ie](Dt).top+Ce,nt]}return null}).filter(Ae=>Ae).sort((Ae,nt)=>Ae[0]-nt[0]).forEach(Ae=>{this._offsets.push(Ae[0]),this._targets.push(Ae[1])})}dispose(){Ze.off(this._scrollElement,".bs.scrollspy"),super.dispose()}_getConfig(H){if(typeof(H={...Sn,...Gt.getDataAttributes(this._element),...typeof H=="object"&&H?H:{}}).target!="string"&&m(H.target)){let{id:ie}=H.target;ie||(ie=o("scrollspy"),H.target.id=ie),H.target="#"+ie}return T("scrollspy",H,ji),H}_getScrollTop(){return this._scrollElement===window?this._scrollElement.pageYOffset:this._scrollElement.scrollTop}_getScrollHeight(){return this._scrollElement.scrollHeight||Math.max(document.body.scrollHeight,document.documentElement.scrollHeight)}_getOffsetHeight(){return this._scrollElement===window?window.innerHeight:this._scrollElement.getBoundingClientRect().height}_process(){const H=this._getScrollTop()+this._config.offset,ie=this._getScrollHeight(),Ce=this._config.offset+ie-this._getOffsetHeight();if(this._scrollHeight!==ie&&this.refresh(),H>=Ce){const Ae=this._targets[this._targets.length-1];this._activeTarget!==Ae&&this._activate(Ae)}else{if(this._activeTarget&&H<this._offsets[0]&&this._offsets[0]>0)return this._activeTarget=null,void this._clear();for(let Ae=this._offsets.length;Ae--;)this._activeTarget!==this._targets[Ae]&&H>=this._offsets[Ae]&&(this._offsets[Ae+1]===void 0||H<this._offsets[Ae+1])&&this._activate(this._targets[Ae])}}_activate(H){this._activeTarget=H,this._clear();const ie=this._selector.split(",").map(Ae=>`${Ae}[data-bs-target="${H}"],${Ae}[href="${H}"]`),Ce=n.findOne(ie.join(","));Ce.classList.contains("dropdown-item")?(n.findOne(".dropdown-toggle",Ce.closest(".dropdown")).classList.add("active"),Ce.classList.add("active")):(Ce.classList.add("active"),n.parents(Ce,".nav, .list-group").forEach(Ae=>{n.prev(Ae,".nav-link, .list-group-item").forEach(nt=>nt.classList.add("active")),n.prev(Ae,".nav-item").forEach(nt=>{n.children(nt,".nav-link").forEach(Dt=>Dt.classList.add("active"))})})),Ze.trigger(this._scrollElement,"activate.bs.scrollspy",{relatedTarget:H})}_clear(){n.find(this._selector).filter(H=>H.classList.contains("active")).forEach(H=>H.classList.remove("active"))}static jQueryInterface(H){return this.each(function(){const ie=os.getOrCreateInstance(this,H);if(typeof H=="string"){if(ie[H]===void 0)throw new TypeError(`No method named "${H}"`);ie[H]()}})}}Ze.on(window,"load.bs.scrollspy.data-api",()=>{n.find('[data-bs-spy="scroll"]').forEach(Ne=>new os(Ne))}),te(os);class Ts extends jt{static get NAME(){return"tab"}show(){if(this._element.parentNode&&this._element.parentNode.nodeType===Node.ELEMENT_NODE&&this._element.classList.contains("active"))return;let H;const ie=d(this._element),Ce=this._element.closest(".nav, .list-group");if(Ce){const Dt=Ce.nodeName==="UL"||Ce.nodeName==="OL"?":scope > li > .active":".active";H=n.find(Dt,Ce),H=H[H.length-1]}const Ae=H?Ze.trigger(H,"hide.bs.tab",{relatedTarget:this._element}):null;if(Ze.trigger(this._element,"show.bs.tab",{relatedTarget:H}).defaultPrevented||Ae!==null&&Ae.defaultPrevented)return;this._activate(this._element,Ce);const nt=()=>{Ze.trigger(H,"hidden.bs.tab",{relatedTarget:this._element}),Ze.trigger(this._element,"shown.bs.tab",{relatedTarget:H})};ie?this._activate(ie,ie.parentNode,nt):nt()}_activate(H,ie,Ce){const Ae=(!ie||ie.nodeName!=="UL"&&ie.nodeName!=="OL"?n.children(ie,".active"):n.find(":scope > li > .active",ie))[0],nt=Ce&&Ae&&Ae.classList.contains("fade"),Dt=()=>this._transitionComplete(H,Ae,Ce);Ae&&nt?(Ae.classList.remove("show"),this._queueCallback(Dt,H,!0)):Dt()}_transitionComplete(H,ie,Ce){if(ie){ie.classList.remove("active");const nt=n.findOne(":scope > .dropdown-menu .active",ie.parentNode);nt&&nt.classList.remove("active"),ie.getAttribute("role")==="tab"&&ie.setAttribute("aria-selected",!1)}H.classList.add("active"),H.getAttribute("role")==="tab"&&H.setAttribute("aria-selected",!0),F(H),H.classList.contains("fade")&&H.classList.add("show");let Ae=H.parentNode;if(Ae&&Ae.nodeName==="LI"&&(Ae=Ae.parentNode),Ae&&Ae.classList.contains("dropdown-menu")){const nt=H.closest(".dropdown");nt&&n.find(".dropdown-toggle",nt).forEach(Dt=>Dt.classList.add("active")),H.setAttribute("aria-expanded",!0)}Ce&&Ce()}static jQueryInterface(H){return this.each(function(){const ie=Ts.getOrCreateInstance(this);if(typeof H=="string"){if(ie[H]===void 0)throw new TypeError(`No method named "${H}"`);ie[H]()}})}}Ze.on(document,"click.bs.tab.data-api",'[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',function(Ne){["A","AREA"].includes(this.tagName)&&Ne.preventDefault(),P(this)||Ts.getOrCreateInstance(this).show()}),te(Ts);const _s={animation:"boolean",autohide:"boolean",delay:"number"},ss={animation:!0,autohide:!0,delay:5e3};class sn extends jt{constructor(H,ie){super(H),this._config=this._getConfig(ie),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get DefaultType(){return _s}static get Default(){return ss}static get NAME(){return"toast"}show(){Ze.trigger(this._element,"show.bs.toast").defaultPrevented||(this._clearTimeout(),this._config.animation&&this._element.classList.add("fade"),this._element.classList.remove("hide"),F(this._element),this._element.classList.add("showing"),this._queueCallback(()=>{this._element.classList.remove("showing"),this._element.classList.add("show"),Ze.trigger(this._element,"shown.bs.toast"),this._maybeScheduleHide()},this._element,this._config.animation))}hide(){this._element.classList.contains("show")&&(Ze.trigger(this._element,"hide.bs.toast").defaultPrevented||(this._element.classList.remove("show"),this._queueCallback(()=>{this._element.classList.add("hide"),Ze.trigger(this._element,"hidden.bs.toast")},this._element,this._config.animation)))}dispose(){this._clearTimeout(),this._element.classList.contains("show")&&this._element.classList.remove("show"),super.dispose()}_getConfig(H){return H={...ss,...Gt.getDataAttributes(this._element),...typeof H=="object"&&H?H:{}},T("toast",H,this.constructor.DefaultType),H}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(H,ie){switch(H.type){case"mouseover":case"mouseout":this._hasMouseInteraction=ie;break;case"focusin":case"focusout":this._hasKeyboardInteraction=ie}if(ie)return void this._clearTimeout();const Ce=H.relatedTarget;this._element===Ce||this._element.contains(Ce)||this._maybeScheduleHide()}_setListeners(){Ze.on(this._element,"click.dismiss.bs.toast",'[data-bs-dismiss="toast"]',()=>this.hide()),Ze.on(this._element,"mouseover.bs.toast",H=>this._onInteraction(H,!0)),Ze.on(this._element,"mouseout.bs.toast",H=>this._onInteraction(H,!1)),Ze.on(this._element,"focusin.bs.toast",H=>this._onInteraction(H,!0)),Ze.on(this._element,"focusout.bs.toast",H=>this._onInteraction(H,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(H){return this.each(function(){const ie=sn.getOrCreateInstance(this,H);if(typeof H=="string"){if(ie[H]===void 0)throw new TypeError(`No method named "${H}"`);ie[H](this)}})}}return te(sn),{Alert:Yt,Button:Ei,Carousel:Mt,Collapse:Pi,Dropdown:wt,Modal:He,Offcanvas:xt,Popover:Mn,ScrollSpy:os,Tab:Ts,Toast:sn,Tooltip:bi}});/*!
Chosen, a Select Box Enhancer for jQuery and Prototype
by Patrick Filler for Harvest, http://getharvest.com

Version 1.5.1
Full source at https://github.com/harvesthq/chosen
Copyright (c) 2011-2016 Harvest http://getharvest.com

MIT License, https://github.com/harvesthq/chosen/blob/master/LICENSE.md
This file is generated by `grunt build`, do not edit it by hand.
*/(function(){var g,t,i,n,o,l={}.hasOwnProperty,c=function(d,f){for(var m in f)l.call(f,m)&&(d[m]=f[m]);function b(){this.constructor=d}return b.prototype=f.prototype,d.prototype=new b,d.__super__=f.prototype,d};n=function(){function d(){this.options_index=0,this.parsed=[]}return d.prototype.add_node=function(f){return f.nodeName.toUpperCase()==="OPTGROUP"?this.add_group(f):this.add_option(f)},d.prototype.add_group=function(f){var m,b,T,C,P,x;for(m=this.parsed.length,this.parsed.push({array_index:m,group:!0,label:this.escapeExpression(f.label),title:f.title?f.title:void 0,children:0,disabled:f.disabled,classes:f.className}),P=f.childNodes,x=[],T=0,C=P.length;T<C;T++)b=P[T],x.push(this.add_option(b,m,f.disabled));return x},d.prototype.add_option=function(f,m,b){if(f.nodeName.toUpperCase()==="OPTION")return f.text!==""?(m!=null&&(this.parsed[m].children+=1),this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,value:f.value,text:f.text,html:f.innerHTML,title:f.title?f.title:void 0,selected:f.selected,disabled:b===!0?b:f.disabled,group_array_index:m,group_label:m!=null?this.parsed[m].label:null,classes:f.className,style:f.style.cssText})):this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,empty:!0}),this.options_index+=1},d.prototype.escapeExpression=function(f){var m,b;return f==null||f===!1?"":/[\&\<\>\"\'\`]/.test(f)?(m={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},b=/&(?!\w+;)|[\<\>\"\'\`]/g,f.replace(b,function(T){return m[T]||"&amp;"})):f},d}(),n.select_to_array=function(d){var f,m,b,T,C;for(m=new n,C=d.childNodes,b=0,T=C.length;b<T;b++)f=C[b],m.add_node(f);return m.parsed},t=function(){function d(f,m){this.form_field=f,this.options=m??{},d.browser_is_supported()&&(this.is_multiple=this.form_field.multiple,this.set_default_text(),this.set_default_values(),this.setup(),this.set_up_html(),this.register_observers(),this.on_ready())}return d.prototype.set_default_values=function(){var f=this;return this.click_test_action=function(m){return f.test_active_click(m)},this.activate_action=function(m){return f.activate_field(m)},this.active_field=!1,this.mouse_on_container=!1,this.results_showing=!1,this.result_highlighted=null,this.allow_single_deselect=this.options.allow_single_deselect!=null&&this.form_field.options[0]!=null&&this.form_field.options[0].text===""?this.options.allow_single_deselect:!1,this.disable_search_threshold=this.options.disable_search_threshold||0,this.disable_search=this.options.disable_search||!1,this.enable_split_word_search=this.options.enable_split_word_search!=null?this.options.enable_split_word_search:!0,this.group_search=this.options.group_search!=null?this.options.group_search:!0,this.search_contains=this.options.search_contains||!1,this.single_backstroke_delete=this.options.single_backstroke_delete!=null?this.options.single_backstroke_delete:!0,this.max_selected_options=this.options.max_selected_options||1/0,this.inherit_select_classes=this.options.inherit_select_classes||!1,this.display_selected_options=this.options.display_selected_options!=null?this.options.display_selected_options:!0,this.display_disabled_options=this.options.display_disabled_options!=null?this.options.display_disabled_options:!0,this.include_group_label_in_selected=this.options.include_group_label_in_selected||!1,this.max_shown_results=this.options.max_shown_results||Number.POSITIVE_INFINITY},d.prototype.set_default_text=function(){return this.form_field.getAttribute("data-placeholder")?this.default_text=this.form_field.getAttribute("data-placeholder"):this.is_multiple?this.default_text=this.options.placeholder_text_multiple||this.options.placeholder_text||d.default_multiple_text:this.default_text=this.options.placeholder_text_single||this.options.placeholder_text||d.default_single_text,this.results_none_found=this.form_field.getAttribute("data-no_results_text")||this.options.no_results_text||d.default_no_result_text},d.prototype.choice_label=function(f){return this.include_group_label_in_selected&&f.group_label!=null?"<b class='group-name'>"+f.group_label+"</b>"+f.html:f.html},d.prototype.mouse_enter=function(){return this.mouse_on_container=!0},d.prototype.mouse_leave=function(){return this.mouse_on_container=!1},d.prototype.input_focus=function(f){var m=this;if(this.is_multiple){if(!this.active_field)return setTimeout(function(){return m.container_mousedown()},50)}else if(!this.active_field)return this.activate_field()},d.prototype.input_blur=function(f){var m=this;if(!this.mouse_on_container)return this.active_field=!1,setTimeout(function(){return m.blur_test()},100)},d.prototype.results_option_build=function(f){var m,b,T,C,P,x,L;for(m="",C=0,L=this.results_data,P=0,x=L.length;P<x&&(b=L[P],T="",b.group?T=this.result_add_group(b):T=this.result_add_option(b),T!==""&&(C++,m+=T),f!=null&&f.first&&(b.selected&&this.is_multiple?this.choice_build(b):b.selected&&!this.is_multiple&&this.single_set_selected_text(this.choice_label(b))),!(C>=this.max_shown_results));P++);return m},d.prototype.result_add_option=function(f){var m,b;return!f.search_match||!this.include_option_in_results(f)?"":(m=[],!f.disabled&&!(f.selected&&this.is_multiple)&&m.push("active-result"),f.disabled&&!(f.selected&&this.is_multiple)&&m.push("disabled-result"),f.selected&&m.push("result-selected"),f.group_array_index!=null&&m.push("group-option"),f.classes!==""&&m.push(f.classes),b=document.createElement("li"),b.className=m.join(" "),b.style.cssText=f.style,b.setAttribute("data-option-array-index",f.array_index),b.innerHTML=f.search_text,f.title&&(b.title=f.title),this.outerHTML(b))},d.prototype.result_add_group=function(f){var m,b;return!(f.search_match||f.group_match)||!(f.active_options>0)?"":(m=[],m.push("group-result"),f.classes&&m.push(f.classes),b=document.createElement("li"),b.className=m.join(" "),b.innerHTML=f.search_text,f.title&&(b.title=f.title),this.outerHTML(b))},d.prototype.results_update_field=function(){if(this.set_default_text(),this.is_multiple||this.results_reset_cleanup(),this.result_clear_highlight(),this.results_build(),this.results_showing)return this.winnow_results()},d.prototype.reset_single_select_options=function(){var f,m,b,T,C;for(T=this.results_data,C=[],m=0,b=T.length;m<b;m++)f=T[m],f.selected?C.push(f.selected=!1):C.push(void 0);return C},d.prototype.results_toggle=function(){return this.results_showing?this.results_hide():this.results_show()},d.prototype.results_search=function(f){return this.results_showing?this.winnow_results():this.results_show()},d.prototype.winnow_results=function(){var f,m,b,T,C,P,x,L,F,X,re,K;for(this.no_results_clear(),T=0,P=this.get_search_text(),f=P.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),F=new RegExp(f,"i"),b=this.get_search_regex(f),K=this.results_data,X=0,re=K.length;X<re;X++)m=K[X],m.search_match=!1,C=null,this.include_option_in_results(m)&&(m.group&&(m.group_match=!1,m.active_options=0),m.group_array_index!=null&&this.results_data[m.group_array_index]&&(C=this.results_data[m.group_array_index],C.active_options===0&&C.search_match&&(T+=1),C.active_options+=1),m.search_text=m.group?m.label:m.html,m.group&&!this.group_search||(m.search_match=this.search_string_match(m.search_text,b),m.search_match&&!m.group&&(T+=1),m.search_match?(P.length&&(x=m.search_text.search(F),L=m.search_text.substr(0,x+P.length)+"</em>"+m.search_text.substr(x+P.length),m.search_text=L.substr(0,x)+"<em>"+L.substr(x)),C!=null&&(C.group_match=!0)):m.group_array_index!=null&&this.results_data[m.group_array_index].search_match&&(m.search_match=!0)));return this.result_clear_highlight(),T<1&&P.length?(this.update_results_content(""),this.no_results(P)):(this.update_results_content(this.results_option_build()),this.winnow_results_set_highlight())},d.prototype.get_search_regex=function(f){var m;return m=this.search_contains?"":"^",new RegExp(m+f,"i")},d.prototype.search_string_match=function(f,m){var b,T,C,P;if(m.test(f))return!0;if(this.enable_split_word_search&&(f.indexOf(" ")>=0||f.indexOf("[")===0)&&(T=f.replace(/\[|\]/g,"").split(" "),T.length)){for(C=0,P=T.length;C<P;C++)if(b=T[C],m.test(b))return!0}},d.prototype.choices_count=function(){var f,m,b,T;if(this.selected_option_count!=null)return this.selected_option_count;for(this.selected_option_count=0,T=this.form_field.options,m=0,b=T.length;m<b;m++)f=T[m],f.selected&&(this.selected_option_count+=1);return this.selected_option_count},d.prototype.choices_click=function(f){if(f.preventDefault(),!(this.results_showing||this.is_disabled))return this.results_show()},d.prototype.keyup_checker=function(f){var m,b;switch(m=(b=f.which)!=null?b:f.keyCode,this.search_field_scale(),m){case 8:if(this.is_multiple&&this.backstroke_length<1&&this.choices_count()>0)return this.keydown_backstroke();if(!this.pending_backstroke)return this.result_clear_highlight(),this.results_search();break;case 13:if(f.preventDefault(),this.results_showing)return this.result_select(f);break;case 27:return this.results_showing&&this.results_hide(),!0;case 9:case 38:case 40:case 16:case 91:case 17:case 18:break;default:return this.results_search()}},d.prototype.clipboard_event_checker=function(f){var m=this;return setTimeout(function(){return m.results_search()},50)},d.prototype.container_width=function(){return this.options.width!=null?this.options.width:""+this.form_field.offsetWidth+"px"},d.prototype.include_option_in_results=function(f){return!(this.is_multiple&&!this.display_selected_options&&f.selected||!this.display_disabled_options&&f.disabled||f.empty)},d.prototype.search_results_touchstart=function(f){return this.touch_started=!0,this.search_results_mouseover(f)},d.prototype.search_results_touchmove=function(f){return this.touch_started=!1,this.search_results_mouseout(f)},d.prototype.search_results_touchend=function(f){if(this.touch_started)return this.search_results_mouseup(f)},d.prototype.outerHTML=function(f){var m;return f.outerHTML?f.outerHTML:(m=document.createElement("div"),m.appendChild(f),m.innerHTML)},d.browser_is_supported=function(){return/iP(od|hone)/i.test(window.navigator.userAgent)||/Android/i.test(window.navigator.userAgent)&&/Mobile/i.test(window.navigator.userAgent)||/IEMobile/i.test(window.navigator.userAgent)||/Windows Phone/i.test(window.navigator.userAgent)||/BlackBerry/i.test(window.navigator.userAgent)||/BB10/i.test(window.navigator.userAgent)?!1:window.navigator.appName==="Microsoft Internet Explorer"?document.documentMode>=8:!0},d.default_multiple_text="Select Some Options",d.default_single_text="Select an Option",d.default_no_result_text="No results match",d}(),g=jQuery,g.fn.extend({chosen:function(d){return t.browser_is_supported()?this.each(function(f){var m,b;if(m=g(this),b=m.data("chosen"),d==="destroy"){b instanceof i&&b.destroy();return}b instanceof i||m.data("chosen",new i(this,d))}):this}}),i=function(d){c(f,d);function f(){return o=f.__super__.constructor.apply(this,arguments),o}return f.prototype.setup=function(){return this.form_field_jq=g(this.form_field),this.current_selectedIndex=this.form_field.selectedIndex,this.is_rtl=this.form_field_jq.hasClass("chosen-rtl")},f.prototype.set_up_html=function(){var m,b;return m=["chosen-container"],m.push("chosen-container-"+(this.is_multiple?"multi":"single")),this.inherit_select_classes&&this.form_field.className&&m.push(this.form_field.className),this.is_rtl&&m.push("chosen-rtl"),b={class:m.join(" "),style:"width: "+this.container_width()+";",title:this.form_field.title},this.form_field.id.length&&(b.id=this.form_field.id.replace(/[^\w]/g,"_")+"_chosen"),this.container=g("<div />",b),this.is_multiple?this.container.html('<ul class="chosen-choices"><li class="search-field"><input type="text" value="'+this.default_text+'" class="default" autocomplete="off" style="width:25px;" /></li></ul><div class="chosen-drop"><ul class="chosen-results"></ul></div>'):this.container.html('<a class="chosen-single chosen-default"><span>'+this.default_text+'</span><div><b></b></div></a><div class="chosen-drop"><div class="chosen-search"><input type="text" autocomplete="off" /></div><ul class="chosen-results"></ul></div>'),this.form_field_jq.hide().after(this.container),this.dropdown=this.container.find("div.chosen-drop").first(),this.search_field=this.container.find("input").first(),this.search_results=this.container.find("ul.chosen-results").first(),this.search_field_scale(),this.search_no_results=this.container.find("li.no-results").first(),this.is_multiple?(this.search_choices=this.container.find("ul.chosen-choices").first(),this.search_container=this.container.find("li.search-field").first()):(this.search_container=this.container.find("div.chosen-search").first(),this.selected_item=this.container.find(".chosen-single").first()),this.results_build(),this.set_tab_index(),this.set_label_behavior()},f.prototype.on_ready=function(){return this.form_field_jq.trigger("chosen:ready",{chosen:this})},f.prototype.register_observers=function(){var m=this;return this.container.bind("touchstart.chosen",function(b){return m.container_mousedown(b),b.preventDefault()}),this.container.bind("touchend.chosen",function(b){return m.container_mouseup(b),b.preventDefault()}),this.container.bind("mousedown.chosen",function(b){m.container_mousedown(b)}),this.container.bind("mouseup.chosen",function(b){m.container_mouseup(b)}),this.container.bind("mouseenter.chosen",function(b){m.mouse_enter(b)}),this.container.bind("mouseleave.chosen",function(b){m.mouse_leave(b)}),this.search_results.bind("mouseup.chosen",function(b){m.search_results_mouseup(b)}),this.search_results.bind("mouseover.chosen",function(b){m.search_results_mouseover(b)}),this.search_results.bind("mouseout.chosen",function(b){m.search_results_mouseout(b)}),this.search_results.bind("mousewheel.chosen DOMMouseScroll.chosen",function(b){m.search_results_mousewheel(b)}),this.search_results.bind("touchstart.chosen",function(b){m.search_results_touchstart(b)}),this.search_results.bind("touchmove.chosen",function(b){m.search_results_touchmove(b)}),this.search_results.bind("touchend.chosen",function(b){m.search_results_touchend(b)}),this.form_field_jq.bind("chosen:updated.chosen",function(b){m.results_update_field(b)}),this.form_field_jq.bind("chosen:activate.chosen",function(b){m.activate_field(b)}),this.form_field_jq.bind("chosen:open.chosen",function(b){m.container_mousedown(b)}),this.form_field_jq.bind("chosen:close.chosen",function(b){m.input_blur(b)}),this.search_field.bind("blur.chosen",function(b){m.input_blur(b)}),this.search_field.bind("keyup.chosen",function(b){m.keyup_checker(b)}),this.search_field.bind("keydown.chosen",function(b){m.keydown_checker(b)}),this.search_field.bind("focus.chosen",function(b){m.input_focus(b)}),this.search_field.bind("cut.chosen",function(b){m.clipboard_event_checker(b)}),this.search_field.bind("paste.chosen",function(b){m.clipboard_event_checker(b)}),this.is_multiple?this.search_choices.bind("click.chosen",function(b){m.choices_click(b)}):this.container.bind("click.chosen",function(b){b.preventDefault()})},f.prototype.destroy=function(){return g(this.container[0].ownerDocument).unbind("click.chosen",this.click_test_action),this.search_field[0].tabIndex&&(this.form_field_jq[0].tabIndex=this.search_field[0].tabIndex),this.container.remove(),this.form_field_jq.removeData("chosen"),this.form_field_jq.show()},f.prototype.search_field_disabled=function(){if(this.is_disabled=this.form_field_jq[0].disabled,this.is_disabled)return this.container.addClass("chosen-disabled"),this.search_field[0].disabled=!0,this.is_multiple||this.selected_item.unbind("focus.chosen",this.activate_action),this.close_field();if(this.container.removeClass("chosen-disabled"),this.search_field[0].disabled=!1,!this.is_multiple)return this.selected_item.bind("focus.chosen",this.activate_action)},f.prototype.container_mousedown=function(m){if(!this.is_disabled&&(m&&m.type==="mousedown"&&!this.results_showing&&m.preventDefault(),!(m!=null&&g(m.target).hasClass("search-choice-close"))))return this.active_field?!this.is_multiple&&m&&(g(m.target)[0]===this.selected_item[0]||g(m.target).parents("a.chosen-single").length)&&(m.preventDefault(),this.results_toggle()):(this.is_multiple&&this.search_field.val(""),g(this.container[0].ownerDocument).bind("click.chosen",this.click_test_action),this.results_show()),this.activate_field()},f.prototype.container_mouseup=function(m){if(m.target.nodeName==="ABBR"&&!this.is_disabled)return this.results_reset(m)},f.prototype.search_results_mousewheel=function(m){var b;if(m.originalEvent&&(b=m.originalEvent.deltaY||-m.originalEvent.wheelDelta||m.originalEvent.detail),b!=null)return m.preventDefault(),m.type==="DOMMouseScroll"&&(b=b*40),this.search_results.scrollTop(b+this.search_results.scrollTop())},f.prototype.blur_test=function(m){if(!this.active_field&&this.container.hasClass("chosen-container-active"))return this.close_field()},f.prototype.close_field=function(){return g(this.container[0].ownerDocument).unbind("click.chosen",this.click_test_action),this.active_field=!1,this.results_hide(),this.container.removeClass("chosen-container-active"),this.clear_backstroke(),this.show_search_field_default(),this.search_field_scale()},f.prototype.activate_field=function(){return this.container.addClass("chosen-container-active"),this.active_field=!0,this.search_field.val(this.search_field.val()),this.search_field.focus()},f.prototype.test_active_click=function(m){var b;return b=g(m.target).closest(".chosen-container"),b.length&&this.container[0]===b[0]?this.active_field=!0:this.close_field()},f.prototype.results_build=function(){return this.parsing=!0,this.selected_option_count=null,this.results_data=n.select_to_array(this.form_field),this.is_multiple?this.search_choices.find("li.search-choice").remove():this.is_multiple||(this.single_set_selected_text(),this.disable_search||this.form_field.options.length<=this.disable_search_threshold?(this.search_field[0].readOnly=!0,this.container.addClass("chosen-container-single-nosearch")):(this.search_field[0].readOnly=!1,this.container.removeClass("chosen-container-single-nosearch"))),this.update_results_content(this.results_option_build({first:!0})),this.search_field_disabled(),this.show_search_field_default(),this.search_field_scale(),this.parsing=!1},f.prototype.result_do_highlight=function(m){var b,T,C,P,x;if(m.length){if(this.result_clear_highlight(),this.result_highlight=m,this.result_highlight.addClass("highlighted"),C=parseInt(this.search_results.css("maxHeight"),10),x=this.search_results.scrollTop(),P=C+x,T=this.result_highlight.position().top+this.search_results.scrollTop(),b=T+this.result_highlight.outerHeight(),b>=P)return this.search_results.scrollTop(b-C>0?b-C:0);if(T<x)return this.search_results.scrollTop(T)}},f.prototype.result_clear_highlight=function(){return this.result_highlight&&this.result_highlight.removeClass("highlighted"),this.result_highlight=null},f.prototype.results_show=function(){return this.is_multiple&&this.max_selected_options<=this.choices_count()?(this.form_field_jq.trigger("chosen:maxselected",{chosen:this}),!1):(this.container.addClass("chosen-with-drop"),this.results_showing=!0,this.search_field.focus(),this.search_field.val(this.search_field.val()),this.winnow_results(),this.form_field_jq.trigger("chosen:showing_dropdown",{chosen:this}))},f.prototype.update_results_content=function(m){return this.search_results.html(m)},f.prototype.results_hide=function(){return this.results_showing&&(this.result_clear_highlight(),this.container.removeClass("chosen-with-drop"),this.form_field_jq.trigger("chosen:hiding_dropdown",{chosen:this})),this.results_showing=!1},f.prototype.set_tab_index=function(m){var b;if(this.form_field.tabIndex)return b=this.form_field.tabIndex,this.form_field.tabIndex=-1,this.search_field[0].tabIndex=b},f.prototype.set_label_behavior=function(){var m=this;if(this.form_field_label=this.form_field_jq.parents("label"),!this.form_field_label.length&&this.form_field.id.length&&(this.form_field_label=g("label[for='"+this.form_field.id+"']")),this.form_field_label.length>0)return this.form_field_label.bind("click.chosen",function(b){return m.is_multiple?m.container_mousedown(b):m.activate_field()})},f.prototype.show_search_field_default=function(){return this.is_multiple&&this.choices_count()<1&&!this.active_field?(this.search_field.val(this.default_text),this.search_field.addClass("default")):(this.search_field.val(""),this.search_field.removeClass("default"))},f.prototype.search_results_mouseup=function(m){var b;if(b=g(m.target).hasClass("active-result")?g(m.target):g(m.target).parents(".active-result").first(),b.length)return this.result_highlight=b,this.result_select(m),this.search_field.focus()},f.prototype.search_results_mouseover=function(m){var b;if(b=g(m.target).hasClass("active-result")?g(m.target):g(m.target).parents(".active-result").first(),b)return this.result_do_highlight(b)},f.prototype.search_results_mouseout=function(m){if(g(m.target).hasClass("active-result"))return this.result_clear_highlight()},f.prototype.choice_build=function(m){var b,T,C=this;return b=g("<li />",{class:"search-choice"}).html("<span>"+this.choice_label(m)+"</span>"),m.disabled?b.addClass("search-choice-disabled"):(T=g("<a />",{class:"search-choice-close","data-option-array-index":m.array_index}),T.bind("click.chosen",function(P){return C.choice_destroy_link_click(P)}),b.append(T)),this.search_container.before(b)},f.prototype.choice_destroy_link_click=function(m){if(m.preventDefault(),m.stopPropagation(),!this.is_disabled)return this.choice_destroy(g(m.target))},f.prototype.choice_destroy=function(m){if(this.result_deselect(m[0].getAttribute("data-option-array-index")))return this.show_search_field_default(),this.is_multiple&&this.choices_count()>0&&this.search_field.val().length<1&&this.results_hide(),m.parents("li").first().remove(),this.search_field_scale()},f.prototype.results_reset=function(){if(this.reset_single_select_options(),this.form_field.options[0].selected=!0,this.single_set_selected_text(),this.show_search_field_default(),this.results_reset_cleanup(),this.form_field_jq.trigger("change"),this.active_field)return this.results_hide()},f.prototype.results_reset_cleanup=function(){return this.current_selectedIndex=this.form_field.selectedIndex,this.selected_item.find("abbr").remove()},f.prototype.result_select=function(m){var b,T;if(this.result_highlight)return b=this.result_highlight,this.result_clear_highlight(),this.is_multiple&&this.max_selected_options<=this.choices_count()?(this.form_field_jq.trigger("chosen:maxselected",{chosen:this}),!1):(this.is_multiple?b.removeClass("active-result"):this.reset_single_select_options(),b.addClass("result-selected"),T=this.results_data[b[0].getAttribute("data-option-array-index")],T.selected=!0,this.form_field.options[T.options_index].selected=!0,this.selected_option_count=null,this.is_multiple?this.choice_build(T):this.single_set_selected_text(this.choice_label(T)),(m.metaKey||m.ctrlKey)&&this.is_multiple||this.results_hide(),this.show_search_field_default(),(this.is_multiple||this.form_field.selectedIndex!==this.current_selectedIndex)&&this.form_field_jq.trigger("change",{selected:this.form_field.options[T.options_index].value}),this.current_selectedIndex=this.form_field.selectedIndex,m.preventDefault(),this.search_field_scale())},f.prototype.single_set_selected_text=function(m){return m==null&&(m=this.default_text),m===this.default_text?this.selected_item.addClass("chosen-default"):(this.single_deselect_control_build(),this.selected_item.removeClass("chosen-default")),this.selected_item.find("span").html(m)},f.prototype.result_deselect=function(m){var b;return b=this.results_data[m],this.form_field.options[b.options_index].disabled?!1:(b.selected=!1,this.form_field.options[b.options_index].selected=!1,this.selected_option_count=null,this.result_clear_highlight(),this.results_showing&&this.winnow_results(),this.form_field_jq.trigger("change",{deselected:this.form_field.options[b.options_index].value}),this.search_field_scale(),!0)},f.prototype.single_deselect_control_build=function(){if(this.allow_single_deselect)return this.selected_item.find("abbr").length||this.selected_item.find("span").first().after('<abbr class="search-choice-close"></abbr>'),this.selected_item.addClass("chosen-single-with-deselect")},f.prototype.get_search_text=function(){return g("<div/>").text(g.trim(this.search_field.val())).html()},f.prototype.winnow_results_set_highlight=function(){var m,b;if(b=this.is_multiple?[]:this.search_results.find(".result-selected.active-result"),m=b.length?b.first():this.search_results.find(".active-result").first(),m!=null)return this.result_do_highlight(m)},f.prototype.no_results=function(m){var b;return b=g('<li class="no-results">'+this.results_none_found+' "<span></span>"</li>'),b.find("span").first().html(m),this.search_results.append(b),this.form_field_jq.trigger("chosen:no_results",{chosen:this})},f.prototype.no_results_clear=function(){return this.search_results.find(".no-results").remove()},f.prototype.keydown_arrow=function(){var m;if(this.results_showing&&this.result_highlight){if(m=this.result_highlight.nextAll("li.active-result").first(),m)return this.result_do_highlight(m)}else return this.results_show()},f.prototype.keyup_arrow=function(){var m;if(!this.results_showing&&!this.is_multiple)return this.results_show();if(this.result_highlight)return m=this.result_highlight.prevAll("li.active-result"),m.length?this.result_do_highlight(m.first()):(this.choices_count()>0&&this.results_hide(),this.result_clear_highlight())},f.prototype.keydown_backstroke=function(){var m;if(this.pending_backstroke)return this.choice_destroy(this.pending_backstroke.find("a").first()),this.clear_backstroke();if(m=this.search_container.siblings("li.search-choice").last(),m.length&&!m.hasClass("search-choice-disabled"))return this.pending_backstroke=m,this.single_backstroke_delete?this.keydown_backstroke():this.pending_backstroke.addClass("search-choice-focus")},f.prototype.clear_backstroke=function(){return this.pending_backstroke&&this.pending_backstroke.removeClass("search-choice-focus"),this.pending_backstroke=null},f.prototype.keydown_checker=function(m){var b,T;switch(b=(T=m.which)!=null?T:m.keyCode,this.search_field_scale(),b!==8&&this.pending_backstroke&&this.clear_backstroke(),b){case 8:this.backstroke_length=this.search_field.val().length;break;case 9:this.results_showing&&!this.is_multiple&&this.result_select(m),this.mouse_on_container=!1;break;case 13:this.results_showing&&m.preventDefault();break;case 32:this.disable_search&&m.preventDefault();break;case 38:m.preventDefault(),this.keyup_arrow();break;case 40:m.preventDefault(),this.keydown_arrow();break}},f.prototype.search_field_scale=function(){var m,b,T,C,P,x,L,F;if(this.is_multiple){for(x=0,C="position:absolute; left: -1000px; top: -1000px; display:none;",P=["font-size","font-style","font-weight","font-family","line-height","text-transform","letter-spacing"],L=0,F=P.length;L<F;L++)T=P[L],C+=T+":"+this.search_field.css(T)+";";return m=g("<div />",{style:C}),m.text(this.search_field.val()),g("body").append(m),x=m.width()+25,m.remove(),b=this.container.outerWidth(),x>b-10&&(x=b-10),this.search_field.css({width:x+"px"})}},f}(t)}).call(void 0);(function(g,t){typeof exports=="object"&&typeof module<"u"?t(exports,require("jszip")):typeof define=="function"&&define.amd?define(["exports","jszip"],t):(g=typeof globalThis<"u"?globalThis:g||self,t(g.docx={},g.JSZip))})(void 0,function(g,t){var i;(function(ue){ue.OfficeDocument="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",ue.FontTable="http://schemas.openxmlformats.org/officeDocument/2006/relationships/fontTable",ue.Image="http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",ue.Numbering="http://schemas.openxmlformats.org/officeDocument/2006/relationships/numbering",ue.Styles="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",ue.StylesWithEffects="http://schemas.microsoft.com/office/2007/relationships/stylesWithEffects",ue.Theme="http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",ue.Settings="http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings",ue.WebSettings="http://schemas.openxmlformats.org/officeDocument/2006/relationships/webSettings",ue.Hyperlink="http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",ue.Footnotes="http://schemas.openxmlformats.org/officeDocument/2006/relationships/footnotes",ue.Endnotes="http://schemas.openxmlformats.org/officeDocument/2006/relationships/endnotes",ue.Footer="http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer",ue.Header="http://schemas.openxmlformats.org/officeDocument/2006/relationships/header",ue.ExtendedProperties="http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",ue.CoreProperties="http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",ue.CustomProperties="http://schemas.openxmlformats.org/package/2006/relationships/metadata/custom-properties",ue.Comments="http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",ue.CommentsExtended="http://schemas.microsoft.com/office/2011/relationships/commentsExtended",ue.AltChunk="http://schemas.openxmlformats.org/officeDocument/2006/relationships/aFChunk"})(i||(i={}));function n(ue,S){return S.elements(ue).map(k=>({id:S.attr(k,"Id"),type:S.attr(k,"Type"),target:S.attr(k,"Target"),targetMode:S.attr(k,"TargetMode")}))}function o(ue){return ue==null?void 0:ue.replace(/[ .]+/g,"-").replace(/[&]+/g,"and").toLowerCase()}function l(ue){return/^[^"'].*\s.*[^"']$/.test(ue)?`'${ue}'`:ue}function c(ue){let S=ue.lastIndexOf("/")+1,k=S==0?"":ue.substring(0,S),V=S==0?ue:ue.substring(S);return[k,V]}function d(ue,S){try{const k="http://docx/";return new URL(ue,k+S).toString().substring(k.length)}catch{return`${S}${ue}`}}function f(ue,S){return ue.reduce((k,V)=>(k[S(V)]=V,k),{})}function m(ue){return new Promise((S,k)=>{const V=new FileReader;V.onloadend=()=>S(V.result),V.onerror=()=>k(),V.readAsDataURL(ue)})}function b(ue){return ue&&typeof ue=="object"&&!Array.isArray(ue)}function T(ue){return typeof ue=="string"||ue instanceof String}function C(ue,...S){if(!S.length)return ue;const k=S.shift();if(b(ue)&&b(k))for(const V in k)if(b(k[V])){const he=ue[V]??(ue[V]={});C(he,k[V])}else ue[V]=k[V];return C(ue,...S)}function P(ue){return Array.isArray(ue)?ue:[ue]}function x(ue,S,k){return S>ue?S:k<ue?k:ue}const L={wordml:"http://schemas.openxmlformats.org/wordprocessingml/2006/main"},F={Dxa:{mul:.05,unit:"pt"},Emu:{mul:1/12700,unit:"pt"},FontSize:{mul:.5,unit:"pt"},Border:{mul:.125,unit:"pt",min:.25,max:12},Point:{mul:1,unit:"pt"},Percent:{mul:.02,unit:"%"}};function X(ue,S=F.Dxa){if(ue==null||/.+(p[xt]|[%])$/.test(ue))return ue;var k=parseInt(ue)*S.mul;return S.min&&S.max&&(k=x(k,S.min,S.max)),`${k.toFixed(2)}${S.unit}`}function re(ue,S=!1){switch(ue){case"1":return!0;case"0":return!1;case"on":return!0;case"off":return!1;case"true":return!0;case"false":return!1;default:return S}}function K(ue,S,k){if(ue.namespaceURI!=L.wordml)return!1;switch(ue.localName){case"color":S.color=k.attr(ue,"val");break;case"sz":S.fontSize=k.lengthAttr(ue,"val",F.FontSize);break;default:return!1}return!0}function te(ue,S=!1){S&&(ue=ue.replace(/<[?].*[?]>/,"")),ue=A(ue);const k=new DOMParser().parseFromString(ue,"application/xml"),V=ee(k);if(V)throw new Error(V);return k}function ee(ue){var S;return(S=ue.getElementsByTagName("parsererror")[0])==null?void 0:S.textContent}function A(ue){return ue.charCodeAt(0)===65279?ue.substring(1):ue}function me(ue){return new XMLSerializer().serializeToString(ue)}class fe{elements(S,k=null){const V=[];for(let he=0,we=S.childNodes.length;he<we;he++){let rt=S.childNodes.item(he);rt.nodeType==1&&(k==null||rt.localName==k)&&V.push(rt)}return V}element(S,k){for(let V=0,he=S.childNodes.length;V<he;V++){let we=S.childNodes.item(V);if(we.nodeType==1&&we.localName==k)return we}return null}elementAttr(S,k,V){var he=this.element(S,k);return he?this.attr(he,V):void 0}attrs(S){return Array.from(S.attributes)}attr(S,k){for(let V=0,he=S.attributes.length;V<he;V++){let we=S.attributes.item(V);if(we.localName==k)return we.value}return null}intAttr(S,k,V=null){var he=this.attr(S,k);return he?parseInt(he):V}hexAttr(S,k,V=null){var he=this.attr(S,k);return he?parseInt(he,16):V}floatAttr(S,k,V=null){var he=this.attr(S,k);return he?parseFloat(he):V}boolAttr(S,k,V=null){return re(this.attr(S,k),V)}lengthAttr(S,k,V=F.Dxa){return X(this.attr(S,k),V)}}const J=new fe;class ye{constructor(S,k){this._package=S,this.path=k}async load(){this.rels=await this._package.loadRelationships(this.path);const S=await this._package.load(this.path),k=this._package.parseXmlDocument(S);this._package.options.keepOrigin&&(this._xmlDocument=k),this.parseXml(k.firstElementChild)}save(){this._package.update(this.path,me(this._xmlDocument))}parseXml(S){}}const Oe={embedRegular:"regular",embedBold:"bold",embedItalic:"italic",embedBoldItalic:"boldItalic"};function ot(ue,S){return S.elements(ue).map(k=>Tt(k,S))}function Tt(ue,S){let k={name:S.attr(ue,"name"),embedFontRefs:[]};for(let V of S.elements(ue))switch(V.localName){case"family":k.family=S.attr(V,"val");break;case"altName":k.altName=S.attr(V,"val");break;case"embedRegular":case"embedBold":case"embedItalic":case"embedBoldItalic":k.embedFontRefs.push(dt(V,S));break}return k}function dt(ue,S){return{id:S.attr(ue,"id"),key:S.attr(ue,"fontKey"),type:Oe[ue.localName]}}class kt extends ye{parseXml(S){this.fonts=ot(S,this._package.xmlParser)}}class $e{constructor(S,k){this._zip=S,this.options=k,this.xmlParser=new fe}get(S){const k=vt(S);return this._zip.files[k]??this._zip.files[k.replace(/\//g,"\\")]}update(S,k){this._zip.file(S,k)}static async load(S,k){const V=await t.loadAsync(S);return new $e(V,k)}save(S="blob"){return this._zip.generateAsync({type:S})}load(S,k="string"){var V;return((V=this.get(S))==null?void 0:V.async(k))??Promise.resolve(null)}async loadRelationships(S=null){let k="_rels/.rels";if(S!=null){const[he,we]=c(S);k=`${he}_rels/${we}.rels`}const V=await this.load(k);return V?n(this.parseXmlDocument(V).firstElementChild,this.xmlParser):null}parseXmlDocument(S){return te(S,this.options.trimXmlDeclaration)}}function vt(ue){return ue.startsWith("/")?ue.substr(1):ue}class Jt extends ye{constructor(S,k,V){super(S,k),this._documentParser=V}parseXml(S){this.body=this._documentParser.parseDocumentFile(S)}}function di(ue,S){return{type:S.attr(ue,"val"),color:S.attr(ue,"color"),size:S.lengthAttr(ue,"sz",F.Border),offset:S.lengthAttr(ue,"space",F.Point),frame:S.boolAttr(ue,"frame"),shadow:S.boolAttr(ue,"shadow")}}function Ut(ue,S){var k={};for(let V of S.elements(ue))switch(V.localName){case"left":k.left=di(V,S);break;case"top":k.top=di(V,S);break;case"right":k.right=di(V,S);break;case"bottom":k.bottom=di(V,S);break}return k}var ui;(function(ue){ue.Continuous="continuous",ue.NextPage="nextPage",ue.NextColumn="nextColumn",ue.EvenPage="evenPage",ue.OddPage="oddPage"})(ui||(ui={}));function qt(ue,S=J){var k={};for(let V of S.elements(ue))switch(V.localName){case"pgSz":k.pageSize={width:S.lengthAttr(V,"w"),height:S.lengthAttr(V,"h"),orientation:S.attr(V,"orient")};break;case"type":k.type=S.attr(V,"val");break;case"pgMar":k.pageMargins={left:S.lengthAttr(V,"left"),right:S.lengthAttr(V,"right"),top:S.lengthAttr(V,"top"),bottom:S.lengthAttr(V,"bottom"),header:S.lengthAttr(V,"header"),footer:S.lengthAttr(V,"footer"),gutter:S.lengthAttr(V,"gutter")};break;case"cols":k.columns=Ze(V,S);break;case"headerReference":(k.headerRefs??(k.headerRefs=[])).push(wi(V,S));break;case"footerReference":(k.footerRefs??(k.footerRefs=[])).push(wi(V,S));break;case"titlePg":k.titlePage=S.boolAttr(V,"val",!0);break;case"pgBorders":k.pageBorders=Ut(V,S);break;case"pgNumType":k.pageNumber=ki(V,S);break}return k}function Ze(ue,S){return{numberOfColumns:S.intAttr(ue,"num"),space:S.lengthAttr(ue,"space"),separator:S.boolAttr(ue,"sep"),equalWidth:S.boolAttr(ue,"equalWidth",!0),columns:S.elements(ue,"col").map(k=>({width:S.lengthAttr(k,"w"),space:S.lengthAttr(k,"space")}))}}function ki(ue,S){return{chapSep:S.attr(ue,"chapSep"),chapStyle:S.attr(ue,"chapStyle"),format:S.attr(ue,"fmt"),start:S.intAttr(ue,"start")}}function wi(ue,S){return{id:S.attr(ue,"id"),type:S.attr(ue,"type")}}function jt(ue,S){return{before:S.lengthAttr(ue,"before"),after:S.lengthAttr(ue,"after"),line:S.intAttr(ue,"line"),lineRule:S.attr(ue,"lineRule")}}function Yt(ue,S){let k={};for(let V of S.elements(ue))Ei(V,k,S);return k}function Ei(ue,S,k){return!!K(ue,S,k)}function ii(ue,S){let k={};for(let V of S.elements(ue))hi(V,k,S);return k}function hi(ue,S,k){if(ue.namespaceURI!=L.wordml)return!1;if(K(ue,S,k))return!0;switch(ue.localName){case"tabs":S.tabs=Gt(ue,k);break;case"sectPr":S.sectionProps=qt(ue,k);break;case"numPr":S.numbering=es(ue,k);break;case"spacing":return S.lineSpacing=jt(ue,k),!1;case"textAlignment":return S.textAlignment=k.attr(ue,"val"),!1;case"keepLines":S.keepLines=k.boolAttr(ue,"val",!0);break;case"keepNext":S.keepNext=k.boolAttr(ue,"val",!0);break;case"pageBreakBefore":S.pageBreakBefore=k.boolAttr(ue,"val",!0);break;case"outlineLvl":S.outlineLevel=k.intAttr(ue,"val");break;case"pStyle":S.styleName=k.attr(ue,"val");break;case"rPr":S.runProps=Yt(ue,k);break;default:return!1}return!0}function Gt(ue,S){return S.elements(ue,"tab").map(k=>({position:S.lengthAttr(k,"pos"),leader:S.attr(k,"leader"),style:S.attr(k,"val")}))}function es(ue,S){var k={};for(let V of S.elements(ue))switch(V.localName){case"numId":k.id=S.attr(V,"val");break;case"ilvl":k.level=S.intAttr(V,"val");break}return k}function js(ue,S){let k={numberings:[],abstractNumberings:[],bulletPictures:[]};for(let V of S.elements(ue))switch(V.localName){case"num":k.numberings.push(ps(V,S));break;case"abstractNum":k.abstractNumberings.push(mi(V,S));break;case"numPicBullet":k.bulletPictures.push(pn(V,S));break}return k}function ps(ue,S){let k={id:S.attr(ue,"numId"),overrides:[]};for(let V of S.elements(ue))switch(V.localName){case"abstractNumId":k.abstractId=S.attr(V,"val");break;case"lvlOverride":k.overrides.push(ws(V,S));break}return k}function mi(ue,S){let k={id:S.attr(ue,"abstractNumId"),levels:[]};for(let V of S.elements(ue))switch(V.localName){case"name":k.name=S.attr(V,"val");break;case"multiLevelType":k.multiLevelType=S.attr(V,"val");break;case"numStyleLink":k.numberingStyleLink=S.attr(V,"val");break;case"styleLink":k.styleLink=S.attr(V,"val");break;case"lvl":k.levels.push($i(V,S));break}return k}function $i(ue,S){let k={level:S.intAttr(ue,"ilvl")};for(let V of S.elements(ue))switch(V.localName){case"start":k.start=S.attr(V,"val");break;case"lvlRestart":k.restart=S.intAttr(V,"val");break;case"numFmt":k.format=S.attr(V,"val");break;case"lvlText":k.text=S.attr(V,"val");break;case"lvlJc":k.justification=S.attr(V,"val");break;case"lvlPicBulletId":k.bulletPictureId=S.attr(V,"val");break;case"pStyle":k.paragraphStyle=S.attr(V,"val");break;case"pPr":k.paragraphProps=ii(V,S);break;case"rPr":k.runProps=Yt(V,S);break}return k}function ws(ue,S){let k={level:S.intAttr(ue,"ilvl")};for(let V of S.elements(ue))switch(V.localName){case"startOverride":k.start=S.intAttr(V,"val");break;case"lvl":k.numberingLevel=$i(V,S);break}return k}function pn(ue,S){var k=S.element(ue,"pict"),V=k&&S.element(k,"shape"),he=V&&S.element(V,"imagedata");return he?{id:S.attr(ue,"numPicBulletId"),referenceId:S.attr(he,"id"),style:S.attr(V,"style")}:null}class Mt extends ye{constructor(S,k,V){super(S,k),this._documentParser=V}parseXml(S){Object.assign(this,js(S,this._package.xmlParser)),this.domNumberings=this._documentParser.parseNumberingFile(S)}}class Mi extends ye{constructor(S,k,V){super(S,k),this._documentParser=V}parseXml(S){this.styles=this._documentParser.parseStylesFile(S)}}var Fe;(function(ue){ue.Document="document",ue.Paragraph="paragraph",ue.Run="run",ue.Break="break",ue.NoBreakHyphen="noBreakHyphen",ue.Table="table",ue.Row="row",ue.Cell="cell",ue.Hyperlink="hyperlink",ue.SmartTag="smartTag",ue.Drawing="drawing",ue.Image="image",ue.Text="text",ue.Tab="tab",ue.Symbol="symbol",ue.BookmarkStart="bookmarkStart",ue.BookmarkEnd="bookmarkEnd",ue.Footer="footer",ue.Header="header",ue.FootnoteReference="footnoteReference",ue.EndnoteReference="endnoteReference",ue.Footnote="footnote",ue.Endnote="endnote",ue.SimpleField="simpleField",ue.ComplexField="complexField",ue.Instruction="instruction",ue.VmlPicture="vmlPicture",ue.MmlMath="mmlMath",ue.MmlMathParagraph="mmlMathParagraph",ue.MmlFraction="mmlFraction",ue.MmlFunction="mmlFunction",ue.MmlFunctionName="mmlFunctionName",ue.MmlNumerator="mmlNumerator",ue.MmlDenominator="mmlDenominator",ue.MmlRadical="mmlRadical",ue.MmlBase="mmlBase",ue.MmlDegree="mmlDegree",ue.MmlSuperscript="mmlSuperscript",ue.MmlSubscript="mmlSubscript",ue.MmlPreSubSuper="mmlPreSubSuper",ue.MmlSubArgument="mmlSubArgument",ue.MmlSuperArgument="mmlSuperArgument",ue.MmlNary="mmlNary",ue.MmlDelimiter="mmlDelimiter",ue.MmlRun="mmlRun",ue.MmlEquationArray="mmlEquationArray",ue.MmlLimit="mmlLimit",ue.MmlLimitLower="mmlLimitLower",ue.MmlMatrix="mmlMatrix",ue.MmlMatrixRow="mmlMatrixRow",ue.MmlBox="mmlBox",ue.MmlBar="mmlBar",ue.MmlGroupChar="mmlGroupChar",ue.VmlElement="vmlElement",ue.Inserted="inserted",ue.Deleted="deleted",ue.DeletedText="deletedText",ue.Comment="comment",ue.CommentReference="commentReference",ue.CommentRangeStart="commentRangeStart",ue.CommentRangeEnd="commentRangeEnd",ue.AltChunk="altChunk"})(Fe||(Fe={}));class Pi{constructor(){this.children=[],this.cssStyle={}}}class qs extends Pi{constructor(){super(...arguments),this.type=Fe.Header}}class Bt extends Pi{constructor(){super(...arguments),this.type=Fe.Footer}}class ts extends ye{constructor(S,k,V){super(S,k),this._documentParser=V}parseXml(S){this.rootElement=this.createRootElement(),this.rootElement.children=this._documentParser.parseBodyElements(S)}}class de extends ts{createRootElement(){return new qs}}class Te extends ts{createRootElement(){return new Bt}}function Me(ue,S){const k={};for(let V of S.elements(ue))switch(V.localName){case"Template":k.template=V.textContent;break;case"Pages":k.pages=Xe(V.textContent);break;case"Words":k.words=Xe(V.textContent);break;case"Characters":k.characters=Xe(V.textContent);break;case"Application":k.application=V.textContent;break;case"Lines":k.lines=Xe(V.textContent);break;case"Paragraphs":k.paragraphs=Xe(V.textContent);break;case"Company":k.company=V.textContent;break;case"AppVersion":k.appVersion=V.textContent;break}return k}function Xe(ue){if(!(typeof ue>"u"))return parseInt(ue)}class mt extends ye{parseXml(S){this.props=Me(S,this._package.xmlParser)}}function ft(ue,S){const k={};for(let V of S.elements(ue))switch(V.localName){case"title":k.title=V.textContent;break;case"description":k.description=V.textContent;break;case"subject":k.subject=V.textContent;break;case"creator":k.creator=V.textContent;break;case"keywords":k.keywords=V.textContent;break;case"language":k.language=V.textContent;break;case"lastModifiedBy":k.lastModifiedBy=V.textContent;break;case"revision":V.textContent&&(k.revision=parseInt(V.textContent));break}return k}class wt extends ye{parseXml(S){this.props=ft(S,this._package.xmlParser)}}class $t{}function oe(ue,S){var k=new $t,V=S.element(ue,"themeElements");for(let he of S.elements(V))switch(he.localName){case"clrScheme":k.colorScheme=et(he,S);break;case"fontScheme":k.fontScheme=ht(he,S);break}return k}function et(ue,S){var k={name:S.attr(ue,"name"),colors:{}};for(let we of S.elements(ue)){var V=S.element(we,"srgbClr"),he=S.element(we,"sysClr");V?k.colors[we.localName]=S.attr(V,"val"):he&&(k.colors[we.localName]=S.attr(he,"lastClr"))}return k}function ht(ue,S){var k={name:S.attr(ue,"name")};for(let V of S.elements(ue))switch(V.localName){case"majorFont":k.majorFont=pt(V,S);break;case"minorFont":k.minorFont=pt(V,S);break}return k}function pt(ue,S){return{latinTypeface:S.elementAttr(ue,"latin","typeface"),eaTypeface:S.elementAttr(ue,"ea","typeface"),csTypeface:S.elementAttr(ue,"cs","typeface")}}class ke extends ye{constructor(S,k){super(S,k)}parseXml(S){this.theme=oe(S,this._package.xmlParser)}}class He{}class ne extends He{constructor(){super(...arguments),this.type=Fe.Footnote}}class tt extends He{constructor(){super(...arguments),this.type=Fe.Endnote}}class xt extends ye{constructor(S,k,V){super(S,k),this._documentParser=V}}class z extends xt{constructor(S,k,V){super(S,k,V)}parseXml(S){this.notes=this._documentParser.parseNotes(S,"footnote",ne)}}class We extends xt{constructor(S,k,V){super(S,k,V)}parseXml(S){this.notes=this._documentParser.parseNotes(S,"endnote",tt)}}function qe(ue,S){var k={};for(let V of S.elements(ue))switch(V.localName){case"defaultTabStop":k.defaultTabStop=S.lengthAttr(V,"val");break;case"footnotePr":k.footnoteProps=le(V,S);break;case"endnotePr":k.endnoteProps=le(V,S);break;case"autoHyphenation":k.autoHyphenation=S.boolAttr(V,"val");break}return k}function le(ue,S){var k={defaultNoteIds:[]};for(let V of S.elements(ue))switch(V.localName){case"numFmt":k.nummeringFormat=S.attr(V,"val");break;case"footnote":case"endnote":k.defaultNoteIds.push(S.attr(V,"id"));break}return k}class De extends ye{constructor(S,k){super(S,k)}parseXml(S){this.settings=qe(S,this._package.xmlParser)}}function Ge(ue,S){return S.elements(ue,"property").map(k=>{const V=k.firstChild;return{formatId:S.attr(k,"fmtid"),name:S.attr(k,"name"),type:V.nodeName,value:V.textContent}})}class Ot extends ye{parseXml(S){this.props=Ge(S,this._package.xmlParser)}}class Ct extends ye{constructor(S,k,V){super(S,k),this._documentParser=V}parseXml(S){this.comments=this._documentParser.parseComments(S),this.commentMap=f(this.comments,k=>k.id)}}class It extends ye{constructor(S,k){super(S,k),this.comments=[]}parseXml(S){const k=this._package.xmlParser;for(let V of k.elements(S,"commentEx"))this.comments.push({paraId:k.attr(V,"paraId"),paraIdParent:k.attr(V,"paraIdParent"),done:k.boolAttr(V,"done")});this.commentMap=f(this.comments,V=>V.paraId)}}const ni=[{type:i.OfficeDocument,target:"word/document.xml"},{type:i.ExtendedProperties,target:"docProps/app.xml"},{type:i.CoreProperties,target:"docProps/core.xml"},{type:i.CustomProperties,target:"docProps/custom.xml"}];class Zs{constructor(){this.parts=[],this.partsMap={}}static async load(S,k,V){var he=new Zs;return he._options=V,he._parser=k,he._package=await $e.load(S,V),he.rels=await he._package.loadRelationships(),await Promise.all(ni.map(we=>{const rt=he.rels.find(Le=>Le.type===we.type)??we;return he.loadRelationshipPart(rt.target,rt.type)})),he}save(S="blob"){return this._package.save(S)}async loadRelationshipPart(S,k){var he;if(this.partsMap[S])return this.partsMap[S];if(!this._package.get(S))return null;let V=null;switch(k){case i.OfficeDocument:this.documentPart=V=new Jt(this._package,S,this._parser);break;case i.FontTable:this.fontTablePart=V=new kt(this._package,S);break;case i.Numbering:this.numberingPart=V=new Mt(this._package,S,this._parser);break;case i.Styles:this.stylesPart=V=new Mi(this._package,S,this._parser);break;case i.Theme:this.themePart=V=new ke(this._package,S);break;case i.Footnotes:this.footnotesPart=V=new z(this._package,S,this._parser);break;case i.Endnotes:this.endnotesPart=V=new We(this._package,S,this._parser);break;case i.Footer:V=new Te(this._package,S,this._parser);break;case i.Header:V=new de(this._package,S,this._parser);break;case i.CoreProperties:this.corePropsPart=V=new wt(this._package,S);break;case i.ExtendedProperties:this.extendedPropsPart=V=new mt(this._package,S);break;case i.CustomProperties:V=new Ot(this._package,S);break;case i.Settings:this.settingsPart=V=new De(this._package,S);break;case i.Comments:this.commentsPart=V=new Ct(this._package,S,this._parser);break;case i.CommentsExtended:this.commentsExtendedPart=V=new It(this._package,S);break}if(V==null)return Promise.resolve(null);if(this.partsMap[S]=V,this.parts.push(V),await V.load(),((he=V.rels)==null?void 0:he.length)>0){const[we]=c(V.path);await Promise.all(V.rels.map(rt=>this.loadRelationshipPart(d(rt.target,we),rt.type)))}return V}async loadDocumentImage(S,k){const V=await this.loadResource(k??this.documentPart,S,"blob");return this.blobToURL(V)}async loadNumberingImage(S){const k=await this.loadResource(this.numberingPart,S,"blob");return this.blobToURL(k)}async loadFont(S,k){const V=await this.loadResource(this.fontTablePart,S,"uint8array");return V&&this.blobToURL(new Blob([bi(V,k)]))}async loadAltChunk(S,k){return await this.loadResource(k??this.documentPart,S,"string")}blobToURL(S){return S?this._options.useBase64URL?m(S):URL.createObjectURL(S):null}findPartByRelId(S,k=null){var V=(k.rels??this.rels).find(we=>we.id==S);const he=k?c(k.path)[0]:"";return V?this.partsMap[d(V.target,he)]:null}getPathById(S,k){const V=S.rels.find(we=>we.id==k),[he]=c(S.path);return V?d(V.target,he):null}loadResource(S,k,V){const he=this.getPathById(S,k);return he?this._package.load(he,V):Promise.resolve(null)}}function bi(ue,S){const V=S.replace(/{|}|-/g,""),he=new Array(16);for(let we=0;we<16;we++)he[16-we-1]=parseInt(V.substr(we*2,2),16);for(let we=0;we<32;we++)ue[we]=ue[we]^he[we%16];return ue}function Oi(ue,S){return{type:Fe.BookmarkStart,id:S.attr(ue,"id"),name:S.attr(ue,"name"),colFirst:S.intAttr(ue,"colFirst"),colLast:S.intAttr(ue,"colLast")}}function gs(ue,S){return{type:Fe.BookmarkEnd,id:S.attr(ue,"id")}}class qi extends Pi{constructor(){super(...arguments),this.type=Fe.VmlElement,this.attrs={}}}function Gs(ue,S){var k=new qi;switch(ue.localName){case"rect":k.tagName="rect",Object.assign(k.attrs,{width:"100%",height:"100%"});break;case"oval":k.tagName="ellipse",Object.assign(k.attrs,{cx:"50%",cy:"50%",rx:"50%",ry:"50%"});break;case"line":k.tagName="line";break;case"shape":k.tagName="g";break;case"textbox":k.tagName="foreignObject",Object.assign(k.attrs,{width:"100%",height:"100%"});break;default:return null}for(const V of J.attrs(ue))switch(V.localName){case"style":k.cssStyleText=V.value;break;case"fillcolor":k.attrs.fill=V.value;break;case"from":const[he,we]=ji(V.value);Object.assign(k.attrs,{x1:he,y1:we});break;case"to":const[rt,Le]=ji(V.value);Object.assign(k.attrs,{x2:rt,y2:Le});break}for(const V of J.elements(ue))switch(V.localName){case"stroke":Object.assign(k.attrs,Mn(V));break;case"fill":Object.assign(k.attrs,Sn());break;case"imagedata":k.tagName="image",Object.assign(k.attrs,{width:"100%",height:"100%"}),k.imageHref={id:J.attr(V,"id"),title:J.attr(V,"title")};break;case"txbxContent":k.children.push(...S.parseBodyElements(V));break;default:const he=Gs(V,S);he&&k.children.push(he);break}return k}function Mn(ue){return{stroke:J.attr(ue,"color"),"stroke-width":J.lengthAttr(ue,"weight",F.Emu)??"1px"}}function Sn(ue){return{}}function ji(ue){return ue.split(",")}class os extends Pi{constructor(){super(...arguments),this.type=Fe.Comment}}class Ts extends Pi{constructor(S){super(),this.id=S,this.type=Fe.CommentReference}}class _s extends Pi{constructor(S){super(),this.id=S,this.type=Fe.CommentRangeStart}}class ss extends Pi{constructor(S){super(),this.id=S,this.type=Fe.CommentRangeEnd}}var sn={shd:"inherit",color:"black",borderColor:"black",highlight:"transparent"};const Ne=[],H={oMath:Fe.MmlMath,oMathPara:Fe.MmlMathParagraph,f:Fe.MmlFraction,func:Fe.MmlFunction,fName:Fe.MmlFunctionName,num:Fe.MmlNumerator,den:Fe.MmlDenominator,rad:Fe.MmlRadical,deg:Fe.MmlDegree,e:Fe.MmlBase,sSup:Fe.MmlSuperscript,sSub:Fe.MmlSubscript,sPre:Fe.MmlPreSubSuper,sup:Fe.MmlSuperArgument,sub:Fe.MmlSubArgument,d:Fe.MmlDelimiter,nary:Fe.MmlNary,eqArr:Fe.MmlEquationArray,lim:Fe.MmlLimit,limLow:Fe.MmlLimitLower,m:Fe.MmlMatrix,mr:Fe.MmlMatrixRow,box:Fe.MmlBox,bar:Fe.MmlBar,groupChr:Fe.MmlGroupChar};class ie{constructor(S){this.options={ignoreWidth:!1,debug:!1,...S}}parseNotes(S,k,V){var he=[];for(let we of J.elements(S,k)){const rt=new V;rt.id=J.attr(we,"id"),rt.noteType=J.attr(we,"type"),rt.children=this.parseBodyElements(we),he.push(rt)}return he}parseComments(S){var k=[];for(let V of J.elements(S,"comment")){const he=new os;he.id=J.attr(V,"id"),he.author=J.attr(V,"author"),he.initials=J.attr(V,"initials"),he.date=J.attr(V,"date"),he.children=this.parseBodyElements(V),k.push(he)}return k}parseDocumentFile(S){var k=J.element(S,"body"),V=J.element(S,"background"),he=J.element(k,"sectPr");return{type:Fe.Document,children:this.parseBodyElements(k),props:he?qt(he,J):{},cssStyle:V?this.parseBackground(V):{}}}parseBackground(S){var k={},V=Ae.colorAttr(S,"color");return V&&(k["background-color"]=V),k}parseBodyElements(S){var k=[];for(let V of J.elements(S))switch(V.localName){case"p":k.push(this.parseParagraph(V));break;case"altChunk":k.push(this.parseAltChunk(V));break;case"tbl":k.push(this.parseTable(V));break;case"sdt":k.push(...this.parseSdt(V,he=>this.parseBodyElements(he)));break}return k}parseStylesFile(S){var k=[];return Ae.foreach(S,V=>{switch(V.localName){case"style":k.push(this.parseStyle(V));break;case"docDefaults":k.push(this.parseDefaultStyles(V));break}}),k}parseDefaultStyles(S){var k={id:null,name:null,target:null,basedOn:null,styles:[]};return Ae.foreach(S,V=>{switch(V.localName){case"rPrDefault":var he=J.element(V,"rPr");he&&k.styles.push({target:"span",values:this.parseDefaultProperties(he,{})});break;case"pPrDefault":var we=J.element(V,"pPr");we&&k.styles.push({target:"p",values:this.parseDefaultProperties(we,{})});break}}),k}parseStyle(S){var k={id:J.attr(S,"styleId"),isDefault:J.boolAttr(S,"default"),name:null,target:null,basedOn:null,styles:[],linked:null};switch(J.attr(S,"type")){case"paragraph":k.target="p";break;case"table":k.target="table";break;case"character":k.target="span";break}return Ae.foreach(S,V=>{switch(V.localName){case"basedOn":k.basedOn=J.attr(V,"val");break;case"name":k.name=J.attr(V,"val");break;case"link":k.linked=J.attr(V,"val");break;case"next":k.next=J.attr(V,"val");break;case"aliases":k.aliases=J.attr(V,"val").split(",");break;case"pPr":k.styles.push({target:"p",values:this.parseDefaultProperties(V,{})}),k.paragraphProps=ii(V,J);break;case"rPr":k.styles.push({target:"span",values:this.parseDefaultProperties(V,{})}),k.runProps=Yt(V,J);break;case"tblPr":case"tcPr":k.styles.push({target:"td",values:this.parseDefaultProperties(V,{})});break;case"tblStylePr":for(let he of this.parseTableStyle(V))k.styles.push(he);break;case"rsid":case"qFormat":case"hidden":case"semiHidden":case"unhideWhenUsed":case"autoRedefine":case"uiPriority":break;default:this.options.debug&&console.warn(`DOCX: Unknown style element: ${V.localName}`)}}),k}parseTableStyle(S){var k=[],V=J.attr(S,"type"),he="",we="";switch(V){case"firstRow":we=".first-row",he="tr.first-row td";break;case"lastRow":we=".last-row",he="tr.last-row td";break;case"firstCol":we=".first-col",he="td.first-col";break;case"lastCol":we=".last-col",he="td.last-col";break;case"band1Vert":we=":not(.no-vband)",he="td.odd-col";break;case"band2Vert":we=":not(.no-vband)",he="td.even-col";break;case"band1Horz":we=":not(.no-hband)",he="tr.odd-row";break;case"band2Horz":we=":not(.no-hband)",he="tr.even-row";break;default:return[]}return Ae.foreach(S,rt=>{switch(rt.localName){case"pPr":k.push({target:`${he} p`,mod:we,values:this.parseDefaultProperties(rt,{})});break;case"rPr":k.push({target:`${he} span`,mod:we,values:this.parseDefaultProperties(rt,{})});break;case"tblPr":case"tcPr":k.push({target:he,mod:we,values:this.parseDefaultProperties(rt,{})});break}}),k}parseNumberingFile(S){var k=[],V={},he=[];return Ae.foreach(S,we=>{switch(we.localName){case"abstractNum":this.parseAbstractNumbering(we,he).forEach(Rt=>k.push(Rt));break;case"numPicBullet":he.push(this.parseNumberingPicBullet(we));break;case"num":var rt=J.attr(we,"numId"),Le=J.elementAttr(we,"abstractNumId","val");V[Le]=rt;break}}),k.forEach(we=>we.id=V[we.id]),k}parseNumberingPicBullet(S){var k=J.element(S,"pict"),V=k&&J.element(k,"shape"),he=V&&J.element(V,"imagedata");return he?{id:J.intAttr(S,"numPicBulletId"),src:J.attr(he,"id"),style:J.attr(V,"style")}:null}parseAbstractNumbering(S,k){var V=[],he=J.attr(S,"abstractNumId");return Ae.foreach(S,we=>{switch(we.localName){case"lvl":V.push(this.parseNumberingLevel(he,we,k));break}}),V}parseNumberingLevel(S,k,V){var he={id:S,level:J.intAttr(k,"ilvl"),start:1,pStyleName:void 0,pStyle:{},rStyle:{},suff:"tab"};return Ae.foreach(k,we=>{switch(we.localName){case"start":he.start=J.intAttr(we,"val");break;case"pPr":this.parseDefaultProperties(we,he.pStyle);break;case"rPr":this.parseDefaultProperties(we,he.rStyle);break;case"lvlPicBulletId":var rt=J.intAttr(we,"val");he.bullet=V.find(Le=>(Le==null?void 0:Le.id)==rt);break;case"lvlText":he.levelText=J.attr(we,"val");break;case"pStyle":he.pStyleName=J.attr(we,"val");break;case"numFmt":he.format=J.attr(we,"val");break;case"suff":he.suff=J.attr(we,"val");break}}),he}parseSdt(S,k){const V=J.element(S,"sdtContent");return V?k(V):[]}parseInserted(S,k){var V;return{type:Fe.Inserted,children:((V=k(S))==null?void 0:V.children)??[]}}parseDeleted(S,k){var V;return{type:Fe.Deleted,children:((V=k(S))==null?void 0:V.children)??[]}}parseAltChunk(S){return{type:Fe.AltChunk,children:[],id:J.attr(S,"id")}}parseParagraph(S){var k={type:Fe.Paragraph,children:[]};for(let V of J.elements(S))switch(V.localName){case"pPr":this.parseParagraphProperties(V,k);break;case"r":k.children.push(this.parseRun(V,k));break;case"hyperlink":k.children.push(this.parseHyperlink(V,k));break;case"smartTag":k.children.push(this.parseSmartTag(V,k));break;case"bookmarkStart":k.children.push(Oi(V,J));break;case"bookmarkEnd":k.children.push(gs(V,J));break;case"commentRangeStart":k.children.push(new _s(J.attr(V,"id")));break;case"commentRangeEnd":k.children.push(new ss(J.attr(V,"id")));break;case"oMath":case"oMathPara":k.children.push(this.parseMathElement(V));break;case"sdt":k.children.push(...this.parseSdt(V,he=>this.parseParagraph(he).children));break;case"ins":k.children.push(this.parseInserted(V,he=>this.parseParagraph(he)));break;case"del":k.children.push(this.parseDeleted(V,he=>this.parseParagraph(he)));break}return k}parseParagraphProperties(S,k){this.parseDefaultProperties(S,k.cssStyle={},null,V=>{if(hi(V,k,J))return!0;switch(V.localName){case"pStyle":k.styleName=J.attr(V,"val");break;case"cnfStyle":k.className=nt.classNameOfCnfStyle(V);break;case"framePr":this.parseFrame(V,k);break;case"rPr":break;default:return!1}return!0})}parseFrame(S,k){var V=J.attr(S,"dropCap");V=="drop"&&(k.cssStyle.float="left")}parseHyperlink(S,k){var V={type:Fe.Hyperlink,parent:k,children:[]};return V.anchor=J.attr(S,"anchor"),V.id=J.attr(S,"id"),Ae.foreach(S,he=>{switch(he.localName){case"r":V.children.push(this.parseRun(he,V));break}}),V}parseSmartTag(S,k){var V={type:Fe.SmartTag,parent:k,children:[]},he=J.attr(S,"uri"),we=J.attr(S,"element");return he&&(V.uri=he),we&&(V.element=we),Ae.foreach(S,rt=>{switch(rt.localName){case"r":V.children.push(this.parseRun(rt,V));break}}),V}parseRun(S,k){var V={type:Fe.Run,parent:k,children:[]};return Ae.foreach(S,he=>{switch(he=this.checkAlternateContent(he),he.localName){case"t":V.children.push({type:Fe.Text,text:he.textContent});break;case"delText":V.children.push({type:Fe.DeletedText,text:he.textContent});break;case"commentReference":V.children.push(new Ts(J.attr(he,"id")));break;case"fldSimple":V.children.push({type:Fe.SimpleField,instruction:J.attr(he,"instr"),lock:J.boolAttr(he,"lock",!1),dirty:J.boolAttr(he,"dirty",!1)});break;case"instrText":V.fieldRun=!0,V.children.push({type:Fe.Instruction,text:he.textContent});break;case"fldChar":V.fieldRun=!0,V.children.push({type:Fe.ComplexField,charType:J.attr(he,"fldCharType"),lock:J.boolAttr(he,"lock",!1),dirty:J.boolAttr(he,"dirty",!1)});break;case"noBreakHyphen":V.children.push({type:Fe.NoBreakHyphen});break;case"br":V.children.push({type:Fe.Break,break:J.attr(he,"type")||"textWrapping"});break;case"lastRenderedPageBreak":V.children.push({type:Fe.Break,break:"lastRenderedPageBreak"});break;case"sym":V.children.push({type:Fe.Symbol,font:l(J.attr(he,"font")),char:J.attr(he,"char")});break;case"tab":V.children.push({type:Fe.Tab});break;case"footnoteReference":V.children.push({type:Fe.FootnoteReference,id:J.attr(he,"id")});break;case"endnoteReference":V.children.push({type:Fe.EndnoteReference,id:J.attr(he,"id")});break;case"drawing":let we=this.parseDrawing(he);we&&(V.children=[we]);break;case"pict":V.children.push(this.parseVmlPicture(he));break;case"rPr":this.parseRunProperties(he,V);break}}),V}parseMathElement(S){const k=`${S.localName}Pr`,V={type:H[S.localName],children:[]};for(const we of J.elements(S))if(H[we.localName])V.children.push(this.parseMathElement(we));else if(we.localName=="r"){var he=this.parseRun(we);he.type=Fe.MmlRun,V.children.push(he)}else we.localName==k&&(V.props=this.parseMathProperies(we));return V}parseMathProperies(S){const k={};for(const V of J.elements(S))switch(V.localName){case"chr":k.char=J.attr(V,"val");break;case"vertJc":k.verticalJustification=J.attr(V,"val");break;case"pos":k.position=J.attr(V,"val");break;case"degHide":k.hideDegree=J.boolAttr(V,"val");break;case"begChr":k.beginChar=J.attr(V,"val");break;case"endChr":k.endChar=J.attr(V,"val");break}return k}parseRunProperties(S,k){this.parseDefaultProperties(S,k.cssStyle={},null,V=>{switch(V.localName){case"rStyle":k.styleName=J.attr(V,"val");break;case"vertAlign":k.verticalAlign=nt.valueOfVertAlign(V,!0);break;default:return!1}return!0})}parseVmlPicture(S){const k={type:Fe.VmlPicture,children:[]};for(const V of J.elements(S)){const he=Gs(V,this);he&&k.children.push(he)}return k}checkAlternateContent(S){var we;if(S.localName!="AlternateContent")return S;var k=J.element(S,"Choice");if(k){var V=J.attr(k,"Requires"),he=S.lookupNamespaceURI(V);if(Ne.includes(he))return k.firstElementChild}return(we=J.element(S,"Fallback"))==null?void 0:we.firstElementChild}parseDrawing(S){for(var k of J.elements(S))switch(k.localName){case"inline":case"anchor":return this.parseDrawingWrapper(k)}}parseDrawingWrapper(S){var k={type:Fe.Drawing,children:[],cssStyle:{}},V=S.localName=="anchor";let he=null,we=J.boolAttr(S,"simplePos");J.boolAttr(S,"behindDoc");let rt={relative:"page",align:"left",offset:"0"},Le={relative:"page",align:"top",offset:"0"};for(var Rt of J.elements(S))switch(Rt.localName){case"simplePos":we&&(rt.offset=J.lengthAttr(Rt,"x",F.Emu),Le.offset=J.lengthAttr(Rt,"y",F.Emu));break;case"extent":k.cssStyle.width=J.lengthAttr(Rt,"cx",F.Emu),k.cssStyle.height=J.lengthAttr(Rt,"cy",F.Emu);break;case"positionH":case"positionV":if(!we){let zi=Rt.localName=="positionH"?rt:Le;var Ls=J.element(Rt,"align"),Ss=J.element(Rt,"posOffset");zi.relative=J.attr(Rt,"relativeFrom")??zi.relative,Ls&&(zi.align=Ls.textContent),Ss&&(zi.offset=Ae.sizeValue(Ss,F.Emu))}break;case"wrapTopAndBottom":he="wrapTopAndBottom";break;case"wrapNone":he="wrapNone";break;case"graphic":var ns=this.parseGraphic(Rt);ns&&k.children.push(ns);break}return he=="wrapTopAndBottom"?(k.cssStyle.display="block",rt.align&&(k.cssStyle["text-align"]=rt.align,k.cssStyle.width="100%")):he=="wrapNone"?(k.cssStyle.display="block",k.cssStyle.position="relative",k.cssStyle.width="0px",k.cssStyle.height="0px",rt.offset&&(k.cssStyle.left=rt.offset),Le.offset&&(k.cssStyle.top=Le.offset)):V&&(rt.align=="left"||rt.align=="right")&&(k.cssStyle.float=rt.align),k}parseGraphic(S){var k=J.element(S,"graphicData");for(let V of J.elements(k))switch(V.localName){case"pic":return this.parsePicture(V)}return null}parsePicture(S){var k={type:Fe.Image,src:"",cssStyle:{}},V=J.element(S,"blipFill"),he=J.element(V,"blip");k.src=J.attr(he,"embed");var we=J.element(S,"spPr"),rt=J.element(we,"xfrm");k.cssStyle.position="relative";for(var Le of J.elements(rt))switch(Le.localName){case"ext":k.cssStyle.width=J.lengthAttr(Le,"cx",F.Emu),k.cssStyle.height=J.lengthAttr(Le,"cy",F.Emu);break;case"off":k.cssStyle.left=J.lengthAttr(Le,"x",F.Emu),k.cssStyle.top=J.lengthAttr(Le,"y",F.Emu);break}return k}parseTable(S){var k={type:Fe.Table,children:[]};return Ae.foreach(S,V=>{switch(V.localName){case"tr":k.children.push(this.parseTableRow(V));break;case"tblGrid":k.columns=this.parseTableColumns(V);break;case"tblPr":this.parseTableProperties(V,k);break}}),k}parseTableColumns(S){var k=[];return Ae.foreach(S,V=>{switch(V.localName){case"gridCol":k.push({width:J.lengthAttr(V,"w")});break}}),k}parseTableProperties(S,k){switch(k.cssStyle={},k.cellStyle={},this.parseDefaultProperties(S,k.cssStyle,k.cellStyle,V=>{switch(V.localName){case"tblStyle":k.styleName=J.attr(V,"val");break;case"tblLook":k.className=nt.classNameOftblLook(V);break;case"tblpPr":this.parseTablePosition(V,k);break;case"tblStyleColBandSize":k.colBandSize=J.intAttr(V,"val");break;case"tblStyleRowBandSize":k.rowBandSize=J.intAttr(V,"val");break;default:return!1}return!0}),k.cssStyle["text-align"]){case"center":delete k.cssStyle["text-align"],k.cssStyle["margin-left"]="auto",k.cssStyle["margin-right"]="auto";break;case"right":delete k.cssStyle["text-align"],k.cssStyle["margin-left"]="auto";break}}parseTablePosition(S,k){var V=J.lengthAttr(S,"topFromText"),he=J.lengthAttr(S,"bottomFromText"),we=J.lengthAttr(S,"rightFromText"),rt=J.lengthAttr(S,"leftFromText");k.cssStyle.float="left",k.cssStyle["margin-bottom"]=nt.addSize(k.cssStyle["margin-bottom"],he),k.cssStyle["margin-left"]=nt.addSize(k.cssStyle["margin-left"],rt),k.cssStyle["margin-right"]=nt.addSize(k.cssStyle["margin-right"],we),k.cssStyle["margin-top"]=nt.addSize(k.cssStyle["margin-top"],V)}parseTableRow(S){var k={type:Fe.Row,children:[]};return Ae.foreach(S,V=>{switch(V.localName){case"tc":k.children.push(this.parseTableCell(V));break;case"trPr":this.parseTableRowProperties(V,k);break}}),k}parseTableRowProperties(S,k){k.cssStyle=this.parseDefaultProperties(S,{},null,V=>{switch(V.localName){case"cnfStyle":k.className=nt.classNameOfCnfStyle(V);break;case"tblHeader":k.isHeader=J.boolAttr(V,"val");break;default:return!1}return!0})}parseTableCell(S){var k={type:Fe.Cell,children:[]};return Ae.foreach(S,V=>{switch(V.localName){case"tbl":k.children.push(this.parseTable(V));break;case"p":k.children.push(this.parseParagraph(V));break;case"tcPr":this.parseTableCellProperties(V,k);break}}),k}parseTableCellProperties(S,k){k.cssStyle=this.parseDefaultProperties(S,{},null,V=>{switch(V.localName){case"gridSpan":k.span=J.intAttr(V,"val",null);break;case"vMerge":k.verticalMerge=J.attr(V,"val")??"continue";break;case"cnfStyle":k.className=nt.classNameOfCnfStyle(V);break;default:return!1}return!0}),this.parseTableCellVerticalText(S,k)}parseTableCellVerticalText(S,k){const V={btLr:{writingMode:"vertical-rl",transform:"rotate(180deg)"},lrTb:{writingMode:"vertical-lr",transform:"none"},tbRl:{writingMode:"vertical-rl",transform:"none"}};Ae.foreach(S,he=>{if(he.localName==="textDirection"){const we=J.attr(he,"val"),rt=V[we]||{writingMode:"horizontal-tb"};k.cssStyle["writing-mode"]=rt.writingMode,k.cssStyle.transform=rt.transform}})}parseDefaultProperties(S,k=null,V=null,he=null){return k=k||{},Ae.foreach(S,we=>{if(!(he!=null&&he(we)))switch(we.localName){case"jc":k["text-align"]=nt.valueOfJc(we);break;case"textAlignment":k["vertical-align"]=nt.valueOfTextAlignment(we);break;case"color":k.color=Ae.colorAttr(we,"val",null,sn.color);break;case"sz":k["font-size"]=k["min-height"]=J.lengthAttr(we,"val",F.FontSize);break;case"shd":k["background-color"]=Ae.colorAttr(we,"fill",null,sn.shd);break;case"highlight":k["background-color"]=Ae.colorAttr(we,"val",null,sn.highlight);break;case"vertAlign":break;case"position":k.verticalAlign=J.lengthAttr(we,"val",F.FontSize);break;case"tcW":if(this.options.ignoreWidth)break;case"tblW":k.width=nt.valueOfSize(we,"w");break;case"trHeight":this.parseTrHeight(we,k);break;case"strike":k["text-decoration"]=J.boolAttr(we,"val",!0)?"line-through":"none";break;case"b":k["font-weight"]=J.boolAttr(we,"val",!0)?"bold":"normal";break;case"i":k["font-style"]=J.boolAttr(we,"val",!0)?"italic":"normal";break;case"caps":k["text-transform"]=J.boolAttr(we,"val",!0)?"uppercase":"none";break;case"smallCaps":k["font-variant"]=J.boolAttr(we,"val",!0)?"small-caps":"none";break;case"u":this.parseUnderline(we,k);break;case"ind":case"tblInd":this.parseIndentation(we,k);break;case"rFonts":this.parseFont(we,k);break;case"tblBorders":this.parseBorderProperties(we,V||k);break;case"tblCellSpacing":k["border-spacing"]=nt.valueOfMargin(we),k["border-collapse"]="separate";break;case"pBdr":this.parseBorderProperties(we,k);break;case"bdr":k.border=nt.valueOfBorder(we);break;case"tcBorders":this.parseBorderProperties(we,k);break;case"vanish":J.boolAttr(we,"val",!0)&&(k.display="none");break;case"kern":break;case"noWrap":break;case"tblCellMar":case"tcMar":this.parseMarginProperties(we,V||k);break;case"tblLayout":k["table-layout"]=nt.valueOfTblLayout(we);break;case"vAlign":k["vertical-align"]=nt.valueOfTextAlignment(we);break;case"spacing":S.localName=="pPr"&&this.parseSpacing(we,k);break;case"wordWrap":J.boolAttr(we,"val")&&(k["overflow-wrap"]="break-word");break;case"suppressAutoHyphens":k.hyphens=J.boolAttr(we,"val",!0)?"none":"auto";break;case"lang":k.$lang=J.attr(we,"val");break;case"bCs":case"iCs":case"szCs":case"tabs":case"outlineLvl":case"contextualSpacing":case"tblStyleColBandSize":case"tblStyleRowBandSize":case"webHidden":case"pageBreakBefore":case"suppressLineNumbers":case"keepLines":case"keepNext":case"widowControl":case"bidi":case"rtl":case"noProof":break;default:this.options.debug&&console.warn(`DOCX: Unknown document element: ${S.localName}.${we.localName}`);break}}),k}parseUnderline(S,k){var V=J.attr(S,"val");if(V!=null){switch(V){case"dash":case"dashDotDotHeavy":case"dashDotHeavy":case"dashedHeavy":case"dashLong":case"dashLongHeavy":case"dotDash":case"dotDotDash":k["text-decoration"]="underline dashed";break;case"dotted":case"dottedHeavy":k["text-decoration"]="underline dotted";break;case"double":k["text-decoration"]="underline double";break;case"single":case"thick":k["text-decoration"]="underline";break;case"wave":case"wavyDouble":case"wavyHeavy":k["text-decoration"]="underline wavy";break;case"words":k["text-decoration"]="underline";break;case"none":k["text-decoration"]="none";break}var he=Ae.colorAttr(S,"color");he&&(k["text-decoration-color"]=he)}}parseFont(S,k){var V=J.attr(S,"ascii"),he=nt.themeValue(S,"asciiTheme"),we=J.attr(S,"eastAsia"),rt=[V,he,we].filter(Le=>Le).map(Le=>l(Le));rt.length>0&&(k["font-family"]=[...new Set(rt)].join(", "))}parseIndentation(S,k){var V=J.lengthAttr(S,"firstLine"),he=J.lengthAttr(S,"hanging"),we=J.lengthAttr(S,"left"),rt=J.lengthAttr(S,"start"),Le=J.lengthAttr(S,"right"),Rt=J.lengthAttr(S,"end");V&&(k["text-indent"]=V),he&&(k["text-indent"]=`-${he}`),(we||rt)&&(k["margin-left"]=we||rt),(Le||Rt)&&(k["margin-right"]=Le||Rt)}parseSpacing(S,k){var V=J.lengthAttr(S,"before"),he=J.lengthAttr(S,"after"),we=J.intAttr(S,"line",null),rt=J.attr(S,"lineRule");if(V&&(k["margin-top"]=V),he&&(k["margin-bottom"]=he),we!==null)switch(rt){case"auto":k["line-height"]=`${(we/240).toFixed(2)}`;break;case"atLeast":k["line-height"]=`calc(100% + ${we/20}pt)`;break;default:k["line-height"]=k["min-height"]=`${we/20}pt`;break}}parseMarginProperties(S,k){Ae.foreach(S,V=>{switch(V.localName){case"left":k["padding-left"]=nt.valueOfMargin(V);break;case"right":k["padding-right"]=nt.valueOfMargin(V);break;case"top":k["padding-top"]=nt.valueOfMargin(V);break;case"bottom":k["padding-bottom"]=nt.valueOfMargin(V);break}})}parseTrHeight(S,k){switch(J.attr(S,"hRule")){case"exact":k.height=J.lengthAttr(S,"val");break;case"atLeast":default:k.height=J.lengthAttr(S,"val");break}}parseBorderProperties(S,k){Ae.foreach(S,V=>{switch(V.localName){case"start":case"left":k["border-left"]=nt.valueOfBorder(V);break;case"end":case"right":k["border-right"]=nt.valueOfBorder(V);break;case"top":k["border-top"]=nt.valueOfBorder(V);break;case"bottom":k["border-bottom"]=nt.valueOfBorder(V);break}})}}const Ce=["black","blue","cyan","darkBlue","darkCyan","darkGray","darkGreen","darkMagenta","darkRed","darkYellow","green","lightGray","magenta","none","red","white","yellow"];class Ae{static foreach(S,k){for(var V=0;V<S.childNodes.length;V++){let he=S.childNodes[V];he.nodeType==Node.ELEMENT_NODE&&k(he)}}static colorAttr(S,k,V=null,he="black"){var we=J.attr(S,k);if(we)return we=="auto"?he:Ce.includes(we)?we:`#${we}`;var rt=J.attr(S,"themeColor");return rt?`var(--docx-${rt}-color)`:V}static sizeValue(S,k=F.Dxa){return X(S.textContent,k)}}class nt{static themeValue(S,k){var V=J.attr(S,k);return V?`var(--docx-${V}-font)`:null}static valueOfSize(S,k){var V=F.Dxa;switch(J.attr(S,"type")){case"dxa":break;case"pct":V=F.Percent;break;case"auto":return"auto"}return J.lengthAttr(S,k,V)}static valueOfMargin(S){return J.lengthAttr(S,"w")}static valueOfBorder(S){var k=J.attr(S,"val");if(k=="nil")return"none";var V=Ae.colorAttr(S,"color"),he=J.lengthAttr(S,"sz",F.Border);return`${he} solid ${V=="auto"?sn.borderColor:V}`}static valueOfTblLayout(S){var k=J.attr(S,"val");return k=="fixed"?"fixed":"auto"}static classNameOfCnfStyle(S){const k=J.attr(S,"val");return["first-row","last-row","first-col","last-col","odd-col","even-col","odd-row","even-row","ne-cell","nw-cell","se-cell","sw-cell"].filter((he,we)=>k[we]=="1").join(" ")}static valueOfJc(S){var k=J.attr(S,"val");switch(k){case"start":case"left":return"left";case"center":return"center";case"end":case"right":return"right";case"both":return"justify"}return k}static valueOfVertAlign(S,k=!1){var V=J.attr(S,"val");switch(V){case"subscript":return"sub";case"superscript":return k?"sup":"super"}return k?null:V}static valueOfTextAlignment(S){var k=J.attr(S,"val");switch(k){case"auto":case"baseline":return"baseline";case"top":return"top";case"center":return"middle";case"bottom":return"bottom"}return k}static addSize(S,k){return S==null?k:k==null?S:`calc(${S} + ${k})`}static classNameOftblLook(S){const k=J.hexAttr(S,"val",0);let V="";return(J.boolAttr(S,"firstRow")||k&32)&&(V+=" first-row"),(J.boolAttr(S,"lastRow")||k&64)&&(V+=" last-row"),(J.boolAttr(S,"firstColumn")||k&128)&&(V+=" first-col"),(J.boolAttr(S,"lastColumn")||k&256)&&(V+=" last-col"),(J.boolAttr(S,"noHBand")||k&512)&&(V+=" no-hband"),(J.boolAttr(S,"noVBand")||k&1024)&&(V+=" no-vband"),V.trim()}}const Dt={pos:0,leader:"none",style:"left"},Ai=50;function Di(ue=document.body){const S=document.createElement("div");S.style.width="100pt",ue.appendChild(S);const k=100/S.offsetWidth;return ue.removeChild(S),k}function Ki(ue,S,k,V=72/96){const he=ue.closest("p"),we=ue.getBoundingClientRect(),rt=he.getBoundingClientRect(),Le=getComputedStyle(he),Rt=(S==null?void 0:S.length)>0?S.map(nr=>({pos:Es(nr.position),leader:nr.leader,style:nr.style})).sort((nr,bs)=>nr.pos-bs.pos):[Dt],Ls=Rt[Rt.length-1],Ss=rt.width*V,ns=Es(k);let zi=Ls.pos+ns;if(zi<Ss)for(;zi<Ss&&Rt.length<Ai;zi+=ns)Rt.push({...Dt,pos:zi});const On=parseFloat(Le.marginLeft),Na=rt.left+On,vr=(we.left-Na)*V,xn=Rt.find(nr=>nr.style!="clear"&&nr.pos>vr);if(xn==null)return;let Oo=1;if(xn.style=="right"||xn.style=="center"){const nr=Array.from(he.querySelectorAll(`.${ue.className}`)),bs=nr.indexOf(ue)+1,ho=document.createRange();ho.setStart(ue,1),bs<nr.length?ho.setEndBefore(nr[bs]):ho.setEndAfter(he);const Wr=xn.style=="center"?.5:1,Fh=ho.getBoundingClientRect(),fT=Fh.left+Wr*Fh.width-(rt.left-On);Oo=xn.pos-fT*V}else Oo=xn.pos-vr;switch(ue.innerHTML="&nbsp;",ue.style.textDecoration="inherit",ue.style.wordSpacing=`${Oo.toFixed(0)}pt`,xn.leader){case"dot":case"middleDot":ue.style.textDecoration="underline",ue.style.textDecorationStyle="dotted";break;case"hyphen":case"heavy":case"underscore":ue.style.textDecoration="underline";break}}function Es(ue){return parseFloat(ue)}const Ht={svg:"http://www.w3.org/2000/svg",mathML:"http://www.w3.org/1998/Math/MathML"};class Xs{constructor(S){this.htmlDocument=S,this.className="docx",this.styleMap={},this.currentPart=null,this.tableVerticalMerges=[],this.currentVerticalMerge=null,this.tableCellPositions=[],this.currentCellPosition=null,this.footnoteMap={},this.endnoteMap={},this.currentEndnoteIds=[],this.usedHederFooterParts=[],this.currentTabs=[],this.commentMap={},this.tasks=[],this.postRenderTasks=[]}async render(S,k,V=null,he){var rt;this.document=S,this.options=he,this.className=he.className,this.rootSelector=he.inWrapper?`.${this.className}-wrapper`:":root",this.styleMap=null,this.tasks=[],this.options.renderComments&&globalThis.Highlight&&(this.commentHighlight=new Highlight),V=V||k,ks(V),ks(k),V.appendChild(this.createComment("docxjs library predefined styles")),V.appendChild(this.renderDefaultStyle()),S.themePart&&(V.appendChild(this.createComment("docxjs document theme values")),this.renderTheme(S.themePart,V)),S.stylesPart!=null&&(this.styleMap=this.processStyles(S.stylesPart.styles),V.appendChild(this.createComment("docxjs document styles")),V.appendChild(this.renderStyles(S.stylesPart.styles))),S.numberingPart&&(this.prodessNumberings(S.numberingPart.domNumberings),V.appendChild(this.createComment("docxjs document numbering styles")),V.appendChild(this.renderNumbering(S.numberingPart.domNumberings,V))),S.footnotesPart&&(this.footnoteMap=f(S.footnotesPart.notes,Le=>Le.id)),S.endnotesPart&&(this.endnoteMap=f(S.endnotesPart.notes,Le=>Le.id)),S.settingsPart&&(this.defaultTabSize=(rt=S.settingsPart.settings)==null?void 0:rt.defaultTabStop),!he.ignoreFonts&&S.fontTablePart&&this.renderFontTable(S.fontTablePart,V);var we=this.renderSections(S.documentPart.body);this.options.inWrapper?k.appendChild(this.renderWrapper(we)):nn(k,we),this.commentHighlight&&he.renderComments&&CSS.highlights.set(`${this.className}-comments`,this.commentHighlight),this.postRenderTasks.forEach(Le=>Le()),await Promise.allSettled(this.tasks),this.refreshTabStops()}renderTheme(S,k){var Le,Rt;const V={},he=(Le=S.theme)==null?void 0:Le.fontScheme;he&&(he.majorFont&&(V["--docx-majorHAnsi-font"]=he.majorFont.latinTypeface),he.minorFont&&(V["--docx-minorHAnsi-font"]=he.minorFont.latinTypeface));const we=(Rt=S.theme)==null?void 0:Rt.colorScheme;if(we)for(let[Ls,Ss]of Object.entries(we.colors))V[`--docx-${Ls}-color`]=`#${Ss}`;const rt=this.styleToString(`.${this.className}`,V);k.appendChild(this.createStyleElement(rt))}renderFontTable(S,k){for(let V of S.fonts)for(let he of V.embedFontRefs)this.tasks.push(this.document.loadFont(he.id,he.key).then(we=>{const rt={"font-family":l(V.name),src:`url(${we})`};(he.type=="bold"||he.type=="boldItalic")&&(rt["font-weight"]="bold"),(he.type=="italic"||he.type=="boldItalic")&&(rt["font-style"]="italic");const Le=this.styleToString("@font-face",rt);k.appendChild(this.createComment(`docxjs ${V.name} font`)),k.appendChild(this.createStyleElement(Le))}))}processStyleName(S){return S?`${this.className}_${o(S)}`:this.className}processStyles(S){const k=f(S.filter(he=>he.id!=null),he=>he.id);for(const he of S.filter(we=>we.basedOn)){var V=k[he.basedOn];if(V){he.paragraphProps=C(he.paragraphProps,V.paragraphProps),he.runProps=C(he.runProps,V.runProps);for(const we of V.styles){const rt=he.styles.find(Le=>Le.target==we.target);rt?this.copyStyleProperties(we.values,rt.values):he.styles.push({...we,values:{...we.values}})}}else this.options.debug&&console.warn(`Can't find base style ${he.basedOn}`)}for(let he of S)he.cssName=this.processStyleName(he.id);return k}prodessNumberings(S){var k;for(let V of S.filter(he=>he.pStyleName)){const he=this.findStyle(V.pStyleName);(k=he==null?void 0:he.paragraphProps)!=null&&k.numbering&&(he.paragraphProps.numbering.level=V.level)}}processElement(S){if(S.children)for(var k of S.children)k.parent=S,k.type==Fe.Table?this.processTable(k):this.processElement(k)}processTable(S){for(var k of S.children)for(var V of k.children)V.cssStyle=this.copyStyleProperties(S.cellStyle,V.cssStyle,["border-left","border-right","border-top","border-bottom","padding-left","padding-right","padding-top","padding-bottom"]),this.processElement(V)}copyStyleProperties(S,k,V=null){if(!S)return k;k==null&&(k={}),V==null&&(V=Object.getOwnPropertyNames(S));for(var he of V)S.hasOwnProperty(he)&&!k.hasOwnProperty(he)&&(k[he]=S[he]);return k}createPageElement(S,k){var V=this.createElement("section",{className:S});return k&&(k.pageMargins&&(V.style.paddingLeft=k.pageMargins.left,V.style.paddingRight=k.pageMargins.right,V.style.paddingTop=k.pageMargins.top,V.style.paddingBottom=k.pageMargins.bottom),k.pageSize&&(this.options.ignoreWidth||(V.style.width=k.pageSize.width),this.options.ignoreHeight||(V.style.minHeight=k.pageSize.height))),V}createSectionContent(S){var k=this.createElement("article");return S.columns&&S.columns.numberOfColumns&&(k.style.columnCount=`${S.columns.numberOfColumns}`,k.style.columnGap=S.columns.space,S.columns.separator&&(k.style.columnRule="1px solid black")),k}renderSections(S){const k=[];this.processElement(S);const V=this.splitBySection(S.children,S.props),he=this.groupByPageBreaks(V);let we=null;for(let Le=0,Rt=he.length;Le<Rt;Le++){this.currentFootnoteIds=[];let Ss=he[Le][0].sectProps;const ns=this.createPageElement(this.className,Ss);this.renderStyleValues(S.cssStyle,ns),this.options.renderHeaders&&this.renderHeaderFooter(Ss.headerRefs,Ss,k.length,we!=Ss,ns);for(const zi of he[Le]){var rt=this.createSectionContent(zi.sectProps);this.renderElements(zi.elements,rt),ns.appendChild(rt),Ss=zi.sectProps}this.options.renderFootnotes&&this.renderNotes(this.currentFootnoteIds,this.footnoteMap,ns),this.options.renderEndnotes&&Le==Rt-1&&this.renderNotes(this.currentEndnoteIds,this.endnoteMap,ns),this.options.renderFooters&&this.renderHeaderFooter(Ss.footerRefs,Ss,k.length,we!=Ss,ns),k.push(ns),we=Ss}return k}renderHeaderFooter(S,k,V,he,we){if(S){var rt=(k.titlePage&&he?S.find(Rt=>Rt.type=="first"):null)??(V%2==1?S.find(Rt=>Rt.type=="even"):null)??S.find(Rt=>Rt.type=="default"),Le=rt&&this.document.findPartByRelId(rt.id,this.document.documentPart);if(Le){this.currentPart=Le,this.usedHederFooterParts.includes(Le.path)||(this.processElement(Le.rootElement),this.usedHederFooterParts.push(Le.path));const[Rt]=this.renderElements([Le.rootElement],we);k!=null&&k.pageMargins&&(Le.rootElement.type===Fe.Header?(Rt.style.marginTop=`calc(${k.pageMargins.header} - ${k.pageMargins.top})`,Rt.style.minHeight=`calc(${k.pageMargins.top} - ${k.pageMargins.header})`):Le.rootElement.type===Fe.Footer&&(Rt.style.marginBottom=`calc(${k.pageMargins.footer} - ${k.pageMargins.bottom})`,Rt.style.minHeight=`calc(${k.pageMargins.bottom} - ${k.pageMargins.footer})`)),this.currentPart=null}}}isPageBreakElement(S){return S.type!=Fe.Break?!1:S.break=="lastRenderedPageBreak"?!this.options.ignoreLastRenderedPageBreak:S.break=="page"}isPageBreakSection(S,k){var V,he,we,rt,Le,Rt;return!S||!k?!1:((V=S.pageSize)==null?void 0:V.orientation)!=((he=k.pageSize)==null?void 0:he.orientation)||((we=S.pageSize)==null?void 0:we.width)!=((rt=k.pageSize)==null?void 0:rt.width)||((Le=S.pageSize)==null?void 0:Le.height)!=((Rt=k.pageSize)==null?void 0:Rt.height)}splitBySection(S,k){var ns;var V={sectProps:null,elements:[],pageBreak:!1},he=[V];for(let zi of S){if(zi.type==Fe.Paragraph){const On=this.findStyle(zi.styleName);(ns=On==null?void 0:On.paragraphProps)!=null&&ns.pageBreakBefore&&(V.sectProps=we,V.pageBreak=!0,V={sectProps:null,elements:[],pageBreak:!1},he.push(V))}if(V.elements.push(zi),zi.type==Fe.Paragraph){const On=zi;var we=On.sectionProps,rt=-1,Le=-1;if(this.options.breakPages&&On.children&&(rt=On.children.findIndex(Na=>{var vr;return Le=((vr=Na.children)==null?void 0:vr.findIndex(this.isPageBreakElement.bind(this)))??-1,Le!=-1})),(we||rt!=-1)&&(V.sectProps=we,V.pageBreak=rt!=-1,V={sectProps:null,elements:[],pageBreak:!1},he.push(V)),rt!=-1){let Na=On.children[rt],vr=Le<Na.children.length-1;if(rt<On.children.length-1||vr){var Rt=zi.children,Ls={...zi,children:Rt.slice(rt)};if(zi.children=Rt.slice(0,rt),V.elements.push(Ls),vr){let xn=Na.children,Oo={...Na,children:xn.slice(0,Le)};zi.children.push(Oo),Na.children=xn.slice(Le)}}}}}let Ss=null;for(let zi=he.length-1;zi>=0;zi--)he[zi].sectProps==null?he[zi].sectProps=Ss??k:Ss=he[zi].sectProps;return he}groupByPageBreaks(S){let k=[],V;const he=[k];for(let we of S)k.push(we),(this.options.ignoreLastRenderedPageBreak||we.pageBreak||this.isPageBreakSection(V,we.sectProps))&&he.push(k=[]),V=we.sectProps;return he.filter(we=>we.length>0)}renderWrapper(S){return this.createElement("div",{className:`${this.className}-wrapper`},S)}renderDefaultStyle(){var S=this.className,k=`
.${S}-wrapper { background: gray; padding: 30px; padding-bottom: 0px; display: flex; flex-flow: column; align-items: center; } 
.${S}-wrapper>section.${S} { background: white; box-shadow: 0 0 10px rgba(0, 0, 0, 0.5); margin-bottom: 30px; }`;this.options.hideWrapperOnPrint&&(k=`@media not print { ${k} }`);var V=`${k}
.${S} { color: black; hyphens: auto; text-underline-position: from-font; }
section.${S} { box-sizing: border-box; display: flex; flex-flow: column nowrap; position: relative; overflow: hidden; }
section.${S}>article { margin-bottom: auto; z-index: 1; }
section.${S}>footer { z-index: 1; }
.${S} table { border-collapse: collapse; }
.${S} table td, .${S} table th { vertical-align: top; }
.${S} p { margin: 0pt; min-height: 1em; }
.${S} span { white-space: pre-wrap; overflow-wrap: break-word; }
.${S} a { color: inherit; text-decoration: inherit; }
.${S} svg { fill: transparent; }
`;return this.options.renderComments&&(V+=`
.${S}-comment-ref { cursor: default; }
.${S}-comment-popover { display: none; z-index: 1000; padding: 0.5rem; background: white; position: absolute; box-shadow: 0 0 0.25rem rgba(0, 0, 0, 0.25); width: 30ch; }
.${S}-comment-ref:hover~.${S}-comment-popover { display: block; }
.${S}-comment-author,.${S}-comment-date { font-size: 0.875rem; color: #888; }
`),this.createStyleElement(V)}renderNumbering(S,k){var V="",he=[];for(var we of S){var rt=`p.${this.numberingClass(we.id,we.level)}`,Le="none";if(we.bullet){let Rt=`--${this.className}-${we.bullet.src}`.toLowerCase();V+=this.styleToString(`${rt}:before`,{content:"' '",display:"inline-block",background:`var(${Rt})`},we.bullet.style),this.tasks.push(this.document.loadNumberingImage(we.bullet.src).then(Ls=>{var Ss=`${this.rootSelector} { ${Rt}: url(${Ls}) }`;k.appendChild(this.createStyleElement(Ss))}))}else if(we.levelText){let Rt=this.numberingCounter(we.id,we.level);const Ls=Rt+" "+(we.start-1);we.level>0&&(V+=this.styleToString(`p.${this.numberingClass(we.id,we.level-1)}`,{"counter-set":Ls})),he.push(Ls),V+=this.styleToString(`${rt}:before`,{content:this.levelTextToContent(we.levelText,we.suff,we.id,this.numFormatToCssValue(we.format)),"counter-increment":Rt,...we.rStyle})}else Le=this.numFormatToCssValue(we.format);V+=this.styleToString(rt,{display:"list-item","list-style-position":"inside","list-style-type":Le,...we.pStyle})}return he.length>0&&(V+=this.styleToString(this.rootSelector,{"counter-reset":he.join(" ")})),this.createStyleElement(V)}renderStyles(S){var k="";const V=this.styleMap,he=f(S.filter(Rt=>Rt.isDefault),Rt=>Rt.target);for(const Rt of S){var we=Rt.styles;if(Rt.linked){var rt=Rt.linked&&V[Rt.linked];rt?we=we.concat(rt.styles):this.options.debug&&console.warn(`Can't find linked style ${Rt.linked}`)}for(const Ls of we){var Le=`${Rt.target??""}.${Rt.cssName}`;Rt.target!=Ls.target&&(Le+=` ${Ls.target}`),he[Rt.target]==Rt&&(Le=`.${this.className} ${Rt.target}, `+Le),k+=this.styleToString(Le,Ls.values)}}return this.createStyleElement(k)}renderNotes(S,k,V){var he=S.map(rt=>k[rt]).filter(rt=>rt);if(he.length>0){var we=this.createElement("ol",null,this.renderElements(he));V.appendChild(we)}}renderElement(S){switch(S.type){case Fe.Paragraph:return this.renderParagraph(S);case Fe.BookmarkStart:return this.renderBookmarkStart(S);case Fe.BookmarkEnd:return null;case Fe.Run:return this.renderRun(S);case Fe.Table:return this.renderTable(S);case Fe.Row:return this.renderTableRow(S);case Fe.Cell:return this.renderTableCell(S);case Fe.Hyperlink:return this.renderHyperlink(S);case Fe.SmartTag:return this.renderSmartTag(S);case Fe.Drawing:return this.renderDrawing(S);case Fe.Image:return this.renderImage(S);case Fe.Text:return this.renderText(S);case Fe.Text:return this.renderText(S);case Fe.DeletedText:return this.renderDeletedText(S);case Fe.Tab:return this.renderTab(S);case Fe.Symbol:return this.renderSymbol(S);case Fe.Break:return this.renderBreak(S);case Fe.Footer:return this.renderContainer(S,"footer");case Fe.Header:return this.renderContainer(S,"header");case Fe.Footnote:case Fe.Endnote:return this.renderContainer(S,"li");case Fe.FootnoteReference:return this.renderFootnoteReference(S);case Fe.EndnoteReference:return this.renderEndnoteReference(S);case Fe.NoBreakHyphen:return this.createElement("wbr");case Fe.VmlPicture:return this.renderVmlPicture(S);case Fe.VmlElement:return this.renderVmlElement(S);case Fe.MmlMath:return this.renderContainerNS(S,Ht.mathML,"math",{xmlns:Ht.mathML});case Fe.MmlMathParagraph:return this.renderContainer(S,"span");case Fe.MmlFraction:return this.renderContainerNS(S,Ht.mathML,"mfrac");case Fe.MmlBase:return this.renderContainerNS(S,Ht.mathML,S.parent.type==Fe.MmlMatrixRow?"mtd":"mrow");case Fe.MmlNumerator:case Fe.MmlDenominator:case Fe.MmlFunction:case Fe.MmlLimit:case Fe.MmlBox:return this.renderContainerNS(S,Ht.mathML,"mrow");case Fe.MmlGroupChar:return this.renderMmlGroupChar(S);case Fe.MmlLimitLower:return this.renderContainerNS(S,Ht.mathML,"munder");case Fe.MmlMatrix:return this.renderContainerNS(S,Ht.mathML,"mtable");case Fe.MmlMatrixRow:return this.renderContainerNS(S,Ht.mathML,"mtr");case Fe.MmlRadical:return this.renderMmlRadical(S);case Fe.MmlSuperscript:return this.renderContainerNS(S,Ht.mathML,"msup");case Fe.MmlSubscript:return this.renderContainerNS(S,Ht.mathML,"msub");case Fe.MmlDegree:case Fe.MmlSuperArgument:case Fe.MmlSubArgument:return this.renderContainerNS(S,Ht.mathML,"mn");case Fe.MmlFunctionName:return this.renderContainerNS(S,Ht.mathML,"ms");case Fe.MmlDelimiter:return this.renderMmlDelimiter(S);case Fe.MmlRun:return this.renderMmlRun(S);case Fe.MmlNary:return this.renderMmlNary(S);case Fe.MmlPreSubSuper:return this.renderMmlPreSubSuper(S);case Fe.MmlBar:return this.renderMmlBar(S);case Fe.MmlEquationArray:return this.renderMllList(S);case Fe.Inserted:return this.renderInserted(S);case Fe.Deleted:return this.renderDeleted(S);case Fe.CommentRangeStart:return this.renderCommentRangeStart(S);case Fe.CommentRangeEnd:return this.renderCommentRangeEnd(S);case Fe.CommentReference:return this.renderCommentReference(S);case Fe.AltChunk:return this.renderAltChunk(S)}return null}renderElements(S,k){if(S==null)return null;var V=S.flatMap(he=>this.renderElement(he)).filter(he=>he!=null);return k&&nn(k,V),V}renderContainer(S,k,V){return this.createElement(k,V,this.renderElements(S.children))}renderContainerNS(S,k,V,he){return this.createElementNS(k,V,he,this.renderElements(S.children))}renderParagraph(S){var we,rt;var k=this.renderContainer(S,"p");const V=this.findStyle(S.styleName);S.tabs??(S.tabs=(we=V==null?void 0:V.paragraphProps)==null?void 0:we.tabs),this.renderClass(S,k),this.renderStyleValues(S.cssStyle,k),this.renderCommonProperties(k.style,S);const he=S.numbering??((rt=V==null?void 0:V.paragraphProps)==null?void 0:rt.numbering);return he&&k.classList.add(this.numberingClass(he.id,he.level)),k}renderRunProperties(S,k){this.renderCommonProperties(S,k)}renderCommonProperties(S,k){k!=null&&(k.color&&(S.color=k.color),k.fontSize&&(S["font-size"]=k.fontSize))}renderHyperlink(S){var k=this.renderContainer(S,"a");this.renderStyleValues(S.cssStyle,k);let V="";if(S.id){const he=this.document.documentPart.rels.find(we=>we.id==S.id&&we.targetMode==="External");V=(he==null?void 0:he.target)??V}return S.anchor&&(V+=`#${S.anchor}`),k.href=V,k}renderSmartTag(S){return this.renderContainer(S,"span")}renderCommentRangeStart(S){var he;if(!this.options.renderComments)return null;const k=new Range;(he=this.commentHighlight)==null||he.add(k);const V=this.htmlDocument.createComment(`start of comment #${S.id}`);return this.later(()=>k.setStart(V,0)),this.commentMap[S.id]=k,V}renderCommentRangeEnd(S){if(!this.options.renderComments)return null;const k=this.commentMap[S.id],V=this.htmlDocument.createComment(`end of comment #${S.id}`);return this.later(()=>k==null?void 0:k.setEnd(V,0)),V}renderCommentReference(S){var rt;if(!this.options.renderComments)return null;var k=(rt=this.document.commentsPart)==null?void 0:rt.commentMap[S.id];if(!k)return null;const V=new DocumentFragment,he=this.createElement("span",{className:`${this.className}-comment-ref`},["ð¬"]),we=this.createElement("div",{className:`${this.className}-comment-popover`});return this.renderCommentContent(k,we),V.appendChild(this.htmlDocument.createComment(`comment #${k.id} by ${k.author} on ${k.date}`)),V.appendChild(he),V.appendChild(we),V}renderAltChunk(S){if(!this.options.renderAltChunks)return null;var k=this.createElement("iframe");return this.tasks.push(this.document.loadAltChunk(S.id,this.currentPart).then(V=>{k.srcdoc=V})),k}renderCommentContent(S,k){k.appendChild(this.createElement("div",{className:`${this.className}-comment-author`},[S.author])),k.appendChild(this.createElement("div",{className:`${this.className}-comment-date`},[new Date(S.date).toLocaleString()])),this.renderElements(S.children,k)}renderDrawing(S){var k=this.renderContainer(S,"div");return k.style.display="inline-block",k.style.position="relative",k.style.textIndent="0px",this.renderStyleValues(S.cssStyle,k),k}renderImage(S){let k=this.createElement("img");return this.renderStyleValues(S.cssStyle,k),this.document&&this.tasks.push(this.document.loadDocumentImage(S.src,this.currentPart).then(V=>{k.src=V})),k}renderText(S){return this.htmlDocument.createTextNode(S.text)}renderDeletedText(S){return this.options.renderEndnotes?this.htmlDocument.createTextNode(S.text):null}renderBreak(S){return S.break=="textWrapping"?this.createElement("br"):null}renderInserted(S){return this.options.renderChanges?this.renderContainer(S,"ins"):this.renderElements(S.children)}renderDeleted(S){return this.options.renderChanges?this.renderContainer(S,"del"):null}renderSymbol(S){var k=this.createElement("span");return k.style.fontFamily=S.font,k.innerHTML=`&#x${S.char};`,k}renderFootnoteReference(S){var k=this.createElement("sup");return this.currentFootnoteIds.push(S.id),k.textContent=`${this.currentFootnoteIds.length}`,k}renderEndnoteReference(S){var k=this.createElement("sup");return this.currentEndnoteIds.push(S.id),k.textContent=`${this.currentEndnoteIds.length}`,k}renderTab(S){var he;var k=this.createElement("span");if(k.innerHTML="&emsp;",this.options.experimental){k.className=this.tabStopClass();var V=(he=hs(S,Fe.Paragraph))==null?void 0:he.tabs;this.currentTabs.push({stops:V,span:k})}return k}renderBookmarkStart(S){return this.createElement("span",{id:S.name})}renderRun(S){if(S.fieldRun)return null;const k=this.createElement("span");if(S.id&&(k.id=S.id),this.renderClass(S,k),this.renderStyleValues(S.cssStyle,k),S.verticalAlign){const V=this.createElement(S.verticalAlign);this.renderElements(S.children,V),k.appendChild(V)}else this.renderElements(S.children,k);return k}renderTable(S){let k=this.createElement("table");return this.tableCellPositions.push(this.currentCellPosition),this.tableVerticalMerges.push(this.currentVerticalMerge),this.currentVerticalMerge={},this.currentCellPosition={col:0,row:0},S.columns&&k.appendChild(this.renderTableColumns(S.columns)),this.renderClass(S,k),this.renderElements(S.children,k),this.renderStyleValues(S.cssStyle,k),this.currentVerticalMerge=this.tableVerticalMerges.pop(),this.currentCellPosition=this.tableCellPositions.pop(),k}renderTableColumns(S){let k=this.createElement("colgroup");for(let V of S){let he=this.createElement("col");V.width&&(he.style.width=V.width),k.appendChild(he)}return k}renderTableRow(S){let k=this.renderContainer(S,"tr");return this.currentCellPosition.col=0,this.renderClass(S,k),this.renderStyleValues(S.cssStyle,k),this.currentCellPosition.row++,k}renderTableCell(S){let k=this.renderContainer(S,"td");const V=this.currentCellPosition.col;return S.verticalMerge?S.verticalMerge=="restart"?(this.currentVerticalMerge[V]=k,k.rowSpan=1):this.currentVerticalMerge[V]&&(this.currentVerticalMerge[V].rowSpan+=1,k.style.display="none"):this.currentVerticalMerge[V]=null,this.renderClass(S,k),this.renderStyleValues(S.cssStyle,k),S.span&&(k.colSpan=S.span),this.currentCellPosition.col+=k.colSpan,k}renderVmlPicture(S){return this.renderContainer(S,"div")}renderVmlElement(S){var he,we;var k=this.createSvgElement("svg");k.setAttribute("style",S.cssStyleText);const V=this.renderVmlChildElement(S);return(he=S.imageHref)!=null&&he.id&&this.tasks.push((we=this.document)==null?void 0:we.loadDocumentImage(S.imageHref.id,this.currentPart).then(rt=>V.setAttribute("href",rt))),k.appendChild(V),requestAnimationFrame(()=>{const rt=k.firstElementChild.getBBox();k.setAttribute("width",`${Math.ceil(rt.x+rt.width)}`),k.setAttribute("height",`${Math.ceil(rt.y+rt.height)}`)}),k}renderVmlChildElement(S){const k=this.createSvgElement(S.tagName);Object.entries(S.attrs).forEach(([V,he])=>k.setAttribute(V,he));for(let V of S.children)V.type==Fe.VmlElement?k.appendChild(this.renderVmlChildElement(V)):k.appendChild(...P(this.renderElement(V)));return k}renderMmlRadical(S){var he;const k=S.children.find(we=>we.type==Fe.MmlBase);if((he=S.props)!=null&&he.hideDegree)return this.createElementNS(Ht.mathML,"msqrt",null,this.renderElements([k]));const V=S.children.find(we=>we.type==Fe.MmlDegree);return this.createElementNS(Ht.mathML,"mroot",null,this.renderElements([k,V]))}renderMmlDelimiter(S){const k=[];return k.push(this.createElementNS(Ht.mathML,"mo",null,[S.props.beginChar??"("])),k.push(...this.renderElements(S.children)),k.push(this.createElementNS(Ht.mathML,"mo",null,[S.props.endChar??")"])),this.createElementNS(Ht.mathML,"mrow",null,k)}renderMmlNary(S){var Ls;const k=[],V=f(S.children,Ss=>Ss.type),he=V[Fe.MmlSuperArgument],we=V[Fe.MmlSubArgument],rt=he?this.createElementNS(Ht.mathML,"mo",null,P(this.renderElement(he))):null,Le=we?this.createElementNS(Ht.mathML,"mo",null,P(this.renderElement(we))):null,Rt=this.createElementNS(Ht.mathML,"mo",null,[((Ls=S.props)==null?void 0:Ls.char)??"â«"]);return rt||Le?k.push(this.createElementNS(Ht.mathML,"munderover",null,[Rt,Le,rt])):rt?k.push(this.createElementNS(Ht.mathML,"mover",null,[Rt,rt])):Le?k.push(this.createElementNS(Ht.mathML,"munder",null,[Rt,Le])):k.push(Rt),k.push(...this.renderElements(V[Fe.MmlBase].children)),this.createElementNS(Ht.mathML,"mrow",null,k)}renderMmlPreSubSuper(S){const k=[],V=f(S.children,Ls=>Ls.type),he=V[Fe.MmlSuperArgument],we=V[Fe.MmlSubArgument],rt=he?this.createElementNS(Ht.mathML,"mo",null,P(this.renderElement(he))):null,Le=we?this.createElementNS(Ht.mathML,"mo",null,P(this.renderElement(we))):null,Rt=this.createElementNS(Ht.mathML,"mo",null);return k.push(this.createElementNS(Ht.mathML,"msubsup",null,[Rt,Le,rt])),k.push(...this.renderElements(V[Fe.MmlBase].children)),this.createElementNS(Ht.mathML,"mrow",null,k)}renderMmlGroupChar(S){const k=S.props.verticalJustification==="bot"?"mover":"munder",V=this.renderContainerNS(S,Ht.mathML,k);return S.props.char&&V.appendChild(this.createElementNS(Ht.mathML,"mo",null,[S.props.char])),V}renderMmlBar(S){const k=this.renderContainerNS(S,Ht.mathML,"mrow");switch(S.props.position){case"top":k.style.textDecoration="overline";break;case"bottom":k.style.textDecoration="underline";break}return k}renderMmlRun(S){const k=this.createElementNS(Ht.mathML,"ms",null,this.renderElements(S.children));return this.renderClass(S,k),this.renderStyleValues(S.cssStyle,k),k}renderMllList(S){const k=this.createElementNS(Ht.mathML,"mtable");this.renderClass(S,k),this.renderStyleValues(S.cssStyle,k);for(let V of this.renderElements(S.children))k.appendChild(this.createElementNS(Ht.mathML,"mtr",null,[this.createElementNS(Ht.mathML,"mtd",null,[V])]));return k}renderStyleValues(S,k){for(let V in S)V.startsWith("$")?k.setAttribute(V.slice(1),S[V]):k.style[V]=S[V]}renderClass(S,k){S.className&&(k.className=S.className),S.styleName&&k.classList.add(this.processStyleName(S.styleName))}findStyle(S){var k;return S&&((k=this.styleMap)==null?void 0:k[S])}numberingClass(S,k){return`${this.className}-num-${S}-${k}`}tabStopClass(){return`${this.className}-tab-stop`}styleToString(S,k,V=null){let he=`${S} {\r
`;for(const we in k)we.startsWith("$")||(he+=`  ${we}: ${k[we]};\r
`);return V&&(he+=V),he+`}\r
`}numberingCounter(S,k){return`${this.className}-num-${S}-${k}`}levelTextToContent(S,k,V,he){const we={tab:"\\9",space:"\\a0"};var rt=S.replace(/%\d*/g,Le=>{let Rt=parseInt(Le.substring(1),10)-1;return`"counter(${this.numberingCounter(V,Rt)}, ${he})"`});return`"${rt}${we[k]??""}"`}numFormatToCssValue(S){var k={none:"none",bullet:"disc",decimal:"decimal",lowerLetter:"lower-alpha",upperLetter:"upper-alpha",lowerRoman:"lower-roman",upperRoman:"upper-roman",decimalZero:"decimal-leading-zero",aiueo:"katakana",aiueoFullWidth:"katakana",chineseCounting:"simp-chinese-informal",chineseCountingThousand:"simp-chinese-informal",chineseLegalSimplified:"simp-chinese-formal",chosung:"hangul-consonant",ideographDigital:"cjk-ideographic",ideographTraditional:"cjk-heavenly-stem",ideographLegalTraditional:"trad-chinese-formal",ideographZodiac:"cjk-earthly-branch",iroha:"katakana-iroha",irohaFullWidth:"katakana-iroha",japaneseCounting:"japanese-informal",japaneseDigitalTenThousand:"cjk-decimal",japaneseLegal:"japanese-formal",thaiNumbers:"thai",koreanCounting:"korean-hangul-formal",koreanDigital:"korean-hangul-formal",koreanDigital2:"korean-hanja-informal",hebrew1:"hebrew",hebrew2:"hebrew",hindiNumbers:"devanagari",ganada:"hangul",taiwaneseCounting:"cjk-ideographic",taiwaneseCountingThousand:"cjk-ideographic",taiwaneseDigital:"cjk-decimal"};return k[S]??S}refreshTabStops(){this.options.experimental&&setTimeout(()=>{const S=Di();for(let k of this.currentTabs)Ki(k.span,k.stops,this.defaultTabSize,S)},500)}createElementNS(S,k,V,he){var we=S?this.htmlDocument.createElementNS(S,k):this.htmlDocument.createElement(k);return Object.assign(we,V),he&&nn(we,he),we}createElement(S,k,V){return this.createElementNS(void 0,S,k,V)}createSvgElement(S,k,V){return this.createElementNS(Ht.svg,S,k,V)}createStyleElement(S){return this.createElement("style",{innerHTML:S})}createComment(S){return this.htmlDocument.createComment(S)}later(S){this.postRenderTasks.push(S)}}function ks(ue){ue.innerHTML=""}function nn(ue,S){S.forEach(k=>ue.appendChild(T(k)?document.createTextNode(k):k))}function hs(ue,S){for(var k=ue.parent;k!=null&&k.type!=S;)k=k.parent;return k}const yn={ignoreHeight:!1,ignoreWidth:!1,ignoreFonts:!1,breakPages:!0,debug:!1,experimental:!1,className:"docx",inWrapper:!0,hideWrapperOnPrint:!1,trimXmlDeclaration:!0,ignoreLastRenderedPageBreak:!0,renderHeaders:!0,renderFooters:!0,renderFootnotes:!0,renderEndnotes:!0,useBase64URL:!1,renderChanges:!1,renderComments:!1,renderAltChunks:!0};function Gn(ue,S){const k={...yn,...S};return Zs.load(ue,new ie(k),k)}async function sr(ue,S,k,V){const he={...yn,...V};return await new Xs(window.document).render(ue,S,k,he)}async function La(ue,S,k,V){const he=await Gn(ue,V);return await sr(he,S,k,V),he}g.defaultOptions=yn,g.parseAsync=Gn,g.renderAsync=La,g.renderDocument=sr});/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(g){if(typeof exports=="object"&&typeof module<"u")module.exports=g();else if(typeof define=="function"&&define.amd)define([],g);else{var t;typeof window<"u"?t=window:typeof global<"u"?t=global:typeof self<"u"?t=self:t=this,t.JSZip=g()}})(function(){return function g(t,i,n){function o(d,f){if(!i[d]){if(!t[d]){var m=typeof require=="function"&&require;if(!f&&m)return m(d,!0);if(l)return l(d,!0);var b=new Error("Cannot find module '"+d+"'");throw b.code="MODULE_NOT_FOUND",b}var T=i[d]={exports:{}};t[d][0].call(T.exports,function(C){var P=t[d][1][C];return o(P||C)},T,T.exports,g,t,i,n)}return i[d].exports}for(var l=typeof require=="function"&&require,c=0;c<n.length;c++)o(n[c]);return o}({1:[function(g,t,i){var n=g("./utils"),o=g("./support"),l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";i.encode=function(c){for(var d=[],f,m,b,T,C,P,x,L=0,F=c.length,X=F,re=n.getTypeOf(c)!=="string";L<c.length;)X=F-L,re?(f=c[L++],m=L<F?c[L++]:0,b=L<F?c[L++]:0):(f=c.charCodeAt(L++),m=L<F?c.charCodeAt(L++):0,b=L<F?c.charCodeAt(L++):0),T=f>>2,C=(f&3)<<4|m>>4,P=X>1?(m&15)<<2|b>>6:64,x=X>2?b&63:64,d.push(l.charAt(T)+l.charAt(C)+l.charAt(P)+l.charAt(x));return d.join("")},i.decode=function(c){var d,f,m,b,T,C,P,x=0,L=0,F="data:";if(c.substr(0,F.length)===F)throw new Error("Invalid base64 input, it looks like a data url.");c=c.replace(/[^A-Za-z0-9+/=]/g,"");var X=c.length*3/4;if(c.charAt(c.length-1)===l.charAt(64)&&X--,c.charAt(c.length-2)===l.charAt(64)&&X--,X%1!==0)throw new Error("Invalid base64 input, bad content length.");var re;for(o.uint8array?re=new Uint8Array(X|0):re=new Array(X|0);x<c.length;)b=l.indexOf(c.charAt(x++)),T=l.indexOf(c.charAt(x++)),C=l.indexOf(c.charAt(x++)),P=l.indexOf(c.charAt(x++)),d=b<<2|T>>4,f=(T&15)<<4|C>>2,m=(C&3)<<6|P,re[L++]=d,C!==64&&(re[L++]=f),P!==64&&(re[L++]=m);return re}},{"./support":30,"./utils":32}],2:[function(g,t,i){var n=g("./external"),o=g("./stream/DataWorker"),l=g("./stream/Crc32Probe"),c=g("./stream/DataLengthProbe");function d(f,m,b,T,C){this.compressedSize=f,this.uncompressedSize=m,this.crc32=b,this.compression=T,this.compressedContent=C}d.prototype={getContentWorker:function(){var f=new o(n.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new c("data_length")),m=this;return f.on("end",function(){if(this.streamInfo.data_length!==m.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),f},getCompressedWorker:function(){return new o(n.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},d.createWorkerFrom=function(f,m,b){return f.pipe(new l).pipe(new c("uncompressedSize")).pipe(m.compressWorker(b)).pipe(new c("compressedSize")).withStreamInfo("compression",m)},t.exports=d},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(g,t,i){var n=g("./stream/GenericWorker");i.STORE={magic:"\0\0",compressWorker:function(){return new n("STORE compression")},uncompressWorker:function(){return new n("STORE decompression")}},i.DEFLATE=g("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(g,t,i){var n=g("./utils");function o(){for(var f,m=[],b=0;b<256;b++){f=b;for(var T=0;T<8;T++)f=f&1?3988292384^f>>>1:f>>>1;m[b]=f}return m}var l=o();function c(f,m,b,T){var C=l,P=T+b;f=f^-1;for(var x=T;x<P;x++)f=f>>>8^C[(f^m[x])&255];return f^-1}function d(f,m,b,T){var C=l,P=T+b;f=f^-1;for(var x=T;x<P;x++)f=f>>>8^C[(f^m.charCodeAt(x))&255];return f^-1}t.exports=function(m,b){if(typeof m>"u"||!m.length)return 0;var T=n.getTypeOf(m)!=="string";return T?c(b|0,m,m.length,0):d(b|0,m,m.length,0)}},{"./utils":32}],5:[function(g,t,i){i.base64=!1,i.binary=!1,i.dir=!1,i.createFolders=!0,i.date=null,i.compression=null,i.compressionOptions=null,i.comment=null,i.unixPermissions=null,i.dosPermissions=null},{}],6:[function(g,t,i){var n=null;typeof Promise<"u"?n=Promise:n=g("lie"),t.exports={Promise:n}},{lie:37}],7:[function(g,t,i){var n=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",o=g("pako"),l=g("./utils"),c=g("./stream/GenericWorker"),d=n?"uint8array":"array";i.magic="\b\0";function f(m,b){c.call(this,"FlateWorker/"+m),this._pako=null,this._pakoAction=m,this._pakoOptions=b,this.meta={}}l.inherits(f,c),f.prototype.processChunk=function(m){this.meta=m.meta,this._pako===null&&this._createPako(),this._pako.push(l.transformTo(d,m.data),!1)},f.prototype.flush=function(){c.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},f.prototype.cleanUp=function(){c.prototype.cleanUp.call(this),this._pako=null},f.prototype._createPako=function(){this._pako=new o[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var m=this;this._pako.onData=function(b){m.push({data:b,meta:m.meta})}},i.compressWorker=function(m){return new f("Deflate",m)},i.uncompressWorker=function(){return new f("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(g,t,i){var n=g("../utils"),o=g("../stream/GenericWorker"),l=g("../utf8"),c=g("../crc32"),d=g("../signature"),f=function(L,F){var X="",re;for(re=0;re<F;re++)X+=String.fromCharCode(L&255),L=L>>>8;return X},m=function(L,F){var X=L;return L||(X=F?16893:33204),(X&65535)<<16},b=function(L){return(L||0)&63},T=function(L,F,X,re,K,te){var ee=L.file,A=L.compression,me=te!==l.utf8encode,fe=n.transformTo("string",te(ee.name)),J=n.transformTo("string",l.utf8encode(ee.name)),ye=ee.comment,Oe=n.transformTo("string",te(ye)),ot=n.transformTo("string",l.utf8encode(ye)),Tt=J.length!==ee.name.length,dt=ot.length!==ye.length,kt,$e,vt="",Jt="",di="",Ut=ee.dir,ui=ee.date,qt={crc32:0,compressedSize:0,uncompressedSize:0};(!F||X)&&(qt.crc32=L.crc32,qt.compressedSize=L.compressedSize,qt.uncompressedSize=L.uncompressedSize);var Ze=0;F&&(Ze|=8),!me&&(Tt||dt)&&(Ze|=2048);var ki=0,wi=0;Ut&&(ki|=16),K==="UNIX"?(wi=798,ki|=m(ee.unixPermissions,Ut)):(wi=20,ki|=b(ee.dosPermissions)),kt=ui.getUTCHours(),kt=kt<<6,kt=kt|ui.getUTCMinutes(),kt=kt<<5,kt=kt|ui.getUTCSeconds()/2,$e=ui.getUTCFullYear()-1980,$e=$e<<4,$e=$e|ui.getUTCMonth()+1,$e=$e<<5,$e=$e|ui.getUTCDate(),Tt&&(Jt=f(1,1)+f(c(fe),4)+J,vt+="up"+f(Jt.length,2)+Jt),dt&&(di=f(1,1)+f(c(Oe),4)+ot,vt+="uc"+f(di.length,2)+di);var jt="";jt+=`
\0`,jt+=f(Ze,2),jt+=A.magic,jt+=f(kt,2),jt+=f($e,2),jt+=f(qt.crc32,4),jt+=f(qt.compressedSize,4),jt+=f(qt.uncompressedSize,4),jt+=f(fe.length,2),jt+=f(vt.length,2);var Yt=d.LOCAL_FILE_HEADER+jt+fe+vt,Ei=d.CENTRAL_FILE_HEADER+f(wi,2)+jt+f(Oe.length,2)+"\0\0\0\0"+f(ki,4)+f(re,4)+fe+vt+Oe;return{fileRecord:Yt,dirRecord:Ei}},C=function(L,F,X,re,K){var te="",ee=n.transformTo("string",K(re));return te=d.CENTRAL_DIRECTORY_END+"\0\0\0\0"+f(L,2)+f(L,2)+f(F,4)+f(X,4)+f(ee.length,2)+ee,te},P=function(L){var F="";return F=d.DATA_DESCRIPTOR+f(L.crc32,4)+f(L.compressedSize,4)+f(L.uncompressedSize,4),F};function x(L,F,X,re){o.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=F,this.zipPlatform=X,this.encodeFileName=re,this.streamFiles=L,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}n.inherits(x,o),x.prototype.push=function(L){var F=L.meta.percent||0,X=this.entriesCount,re=this._sources.length;this.accumulate?this.contentBuffer.push(L):(this.bytesWritten+=L.data.length,o.prototype.push.call(this,{data:L.data,meta:{currentFile:this.currentFile,percent:X?(F+100*(X-re-1))/X:100}}))},x.prototype.openedSource=function(L){this.currentSourceOffset=this.bytesWritten,this.currentFile=L.file.name;var F=this.streamFiles&&!L.file.dir;if(F){var X=T(L,F,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:X.fileRecord,meta:{percent:0}})}else this.accumulate=!0},x.prototype.closedSource=function(L){this.accumulate=!1;var F=this.streamFiles&&!L.file.dir,X=T(L,F,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(X.dirRecord),F)this.push({data:P(L),meta:{percent:100}});else for(this.push({data:X.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},x.prototype.flush=function(){for(var L=this.bytesWritten,F=0;F<this.dirRecords.length;F++)this.push({data:this.dirRecords[F],meta:{percent:100}});var X=this.bytesWritten-L,re=C(this.dirRecords.length,X,L,this.zipComment,this.encodeFileName);this.push({data:re,meta:{percent:100}})},x.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},x.prototype.registerPrevious=function(L){this._sources.push(L);var F=this;return L.on("data",function(X){F.processChunk(X)}),L.on("end",function(){F.closedSource(F.previous.streamInfo),F._sources.length?F.prepareNextSource():F.end()}),L.on("error",function(X){F.error(X)}),this},x.prototype.resume=function(){if(!o.prototype.resume.call(this))return!1;if(!this.previous&&this._sources.length)return this.prepareNextSource(),!0;if(!this.previous&&!this._sources.length&&!this.generatedError)return this.end(),!0},x.prototype.error=function(L){var F=this._sources;if(!o.prototype.error.call(this,L))return!1;for(var X=0;X<F.length;X++)try{F[X].error(L)}catch{}return!0},x.prototype.lock=function(){o.prototype.lock.call(this);for(var L=this._sources,F=0;F<L.length;F++)L[F].lock()},t.exports=x},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(g,t,i){var n=g("../compressions"),o=g("./ZipFileWorker"),l=function(c,d){var f=c||d,m=n[f];if(!m)throw new Error(f+" is not a valid compression method !");return m};i.generateWorker=function(c,d,f){var m=new o(d.streamFiles,f,d.platform,d.encodeFileName),b=0;try{c.forEach(function(T,C){b++;var P=l(C.options.compression,d.compression),x=C.options.compressionOptions||d.compressionOptions||{},L=C.dir,F=C.date;C._compressWorker(P,x).withStreamInfo("file",{name:T,dir:L,date:F,comment:C.comment||"",unixPermissions:C.unixPermissions,dosPermissions:C.dosPermissions}).pipe(m)}),m.entriesCount=b}catch(T){m.error(T)}return m}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(g,t,i){function n(){if(!(this instanceof n))return new n;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var o=new n;for(var l in this)typeof this[l]!="function"&&(o[l]=this[l]);return o}}n.prototype=g("./object"),n.prototype.loadAsync=g("./load"),n.support=g("./support"),n.defaults=g("./defaults"),n.version="3.10.1",n.loadAsync=function(o,l){return new n().loadAsync(o,l)},n.external=g("./external"),t.exports=n},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(g,t,i){var n=g("./utils"),o=g("./external"),l=g("./utf8"),c=g("./zipEntries"),d=g("./stream/Crc32Probe"),f=g("./nodejsUtils");function m(b){return new o.Promise(function(T,C){var P=b.decompressed.getContentWorker().pipe(new d);P.on("error",function(x){C(x)}).on("end",function(){P.streamInfo.crc32!==b.decompressed.crc32?C(new Error("Corrupted zip : CRC32 mismatch")):T()}).resume()})}t.exports=function(b,T){var C=this;return T=n.extend(T||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:l.utf8decode}),f.isNode&&f.isStream(b)?o.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):n.prepareContent("the loaded zip file",b,!0,T.optimizedBinaryString,T.base64).then(function(P){var x=new c(T);return x.load(P),x}).then(function(x){var L=[o.Promise.resolve(x)],F=x.files;if(T.checkCRC32)for(var X=0;X<F.length;X++)L.push(m(F[X]));return o.Promise.all(L)}).then(function(x){for(var L=x.shift(),F=L.files,X=0;X<F.length;X++){var re=F[X],K=re.fileNameStr,te=n.resolve(re.fileNameStr);C.file(te,re.decompressed,{binary:!0,optimizedBinaryString:!0,date:re.date,dir:re.dir,comment:re.fileCommentStr.length?re.fileCommentStr:null,unixPermissions:re.unixPermissions,dosPermissions:re.dosPermissions,createFolders:T.createFolders}),re.dir||(C.file(te).unsafeOriginalName=K)}return L.zipComment.length&&(C.comment=L.zipComment),C})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(g,t,i){var n=g("../utils"),o=g("../stream/GenericWorker");function l(c,d){o.call(this,"Nodejs stream input adapter for "+c),this._upstreamEnded=!1,this._bindStream(d)}n.inherits(l,o),l.prototype._bindStream=function(c){var d=this;this._stream=c,c.pause(),c.on("data",function(f){d.push({data:f,meta:{percent:0}})}).on("error",function(f){d.isPaused?this.generatedError=f:d.error(f)}).on("end",function(){d.isPaused?d._upstreamEnded=!0:d.end()})},l.prototype.pause=function(){return o.prototype.pause.call(this)?(this._stream.pause(),!0):!1},l.prototype.resume=function(){return o.prototype.resume.call(this)?(this._upstreamEnded?this.end():this._stream.resume(),!0):!1},t.exports=l},{"../stream/GenericWorker":28,"../utils":32}],13:[function(g,t,i){var n=g("readable-stream").Readable,o=g("../utils");o.inherits(l,n);function l(c,d,f){n.call(this,d),this._helper=c;var m=this;c.on("data",function(b,T){m.push(b)||m._helper.pause(),f&&f(T)}).on("error",function(b){m.emit("error",b)}).on("end",function(){m.push(null)})}l.prototype._read=function(){this._helper.resume()},t.exports=l},{"../utils":32,"readable-stream":16}],14:[function(g,t,i){t.exports={isNode:typeof Buffer<"u",newBufferFrom:function(n,o){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(n,o);if(typeof n=="number")throw new Error('The "data" argument must not be a number');return new Buffer(n,o)},allocBuffer:function(n){if(Buffer.alloc)return Buffer.alloc(n);var o=new Buffer(n);return o.fill(0),o},isBuffer:function(n){return Buffer.isBuffer(n)},isStream:function(n){return n&&typeof n.on=="function"&&typeof n.pause=="function"&&typeof n.resume=="function"}}},{}],15:[function(g,t,i){var n=g("./utf8"),o=g("./utils"),l=g("./stream/GenericWorker"),c=g("./stream/StreamHelper"),d=g("./defaults"),f=g("./compressedObject"),m=g("./zipObject"),b=g("./generate"),T=g("./nodejsUtils"),C=g("./nodejs/NodejsStreamInputAdapter"),P=function(K,te,ee){var A=o.getTypeOf(te),me,fe=o.extend(ee||{},d);fe.date=fe.date||new Date,fe.compression!==null&&(fe.compression=fe.compression.toUpperCase()),typeof fe.unixPermissions=="string"&&(fe.unixPermissions=parseInt(fe.unixPermissions,8)),fe.unixPermissions&&fe.unixPermissions&16384&&(fe.dir=!0),fe.dosPermissions&&fe.dosPermissions&16&&(fe.dir=!0),fe.dir&&(K=L(K)),fe.createFolders&&(me=x(K))&&F.call(this,me,!0);var J=A==="string"&&fe.binary===!1&&fe.base64===!1;(!ee||typeof ee.binary>"u")&&(fe.binary=!J);var ye=te instanceof f&&te.uncompressedSize===0;(ye||fe.dir||!te||te.length===0)&&(fe.base64=!1,fe.binary=!0,te="",fe.compression="STORE",A="string");var Oe=null;te instanceof f||te instanceof l?Oe=te:T.isNode&&T.isStream(te)?Oe=new C(K,te):Oe=o.prepareContent(K,te,fe.binary,fe.optimizedBinaryString,fe.base64);var ot=new m(K,Oe,fe);this.files[K]=ot},x=function(K){K.slice(-1)==="/"&&(K=K.substring(0,K.length-1));var te=K.lastIndexOf("/");return te>0?K.substring(0,te):""},L=function(K){return K.slice(-1)!=="/"&&(K+="/"),K},F=function(K,te){return te=typeof te<"u"?te:d.createFolders,K=L(K),this.files[K]||P.call(this,K,null,{dir:!0,createFolders:te}),this.files[K]};function X(K){return Object.prototype.toString.call(K)==="[object RegExp]"}var re={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(K){var te,ee,A;for(te in this.files)A=this.files[te],ee=te.slice(this.root.length,te.length),ee&&te.slice(0,this.root.length)===this.root&&K(ee,A)},filter:function(K){var te=[];return this.forEach(function(ee,A){K(ee,A)&&te.push(A)}),te},file:function(K,te,ee){if(arguments.length===1)if(X(K)){var A=K;return this.filter(function(fe,J){return!J.dir&&A.test(fe)})}else{var me=this.files[this.root+K];return me&&!me.dir?me:null}else K=this.root+K,P.call(this,K,te,ee);return this},folder:function(K){if(!K)return this;if(X(K))return this.filter(function(me,fe){return fe.dir&&K.test(me)});var te=this.root+K,ee=F.call(this,te),A=this.clone();return A.root=ee.name,A},remove:function(K){K=this.root+K;var te=this.files[K];if(te||(K.slice(-1)!=="/"&&(K+="/"),te=this.files[K]),te&&!te.dir)delete this.files[K];else for(var ee=this.filter(function(me,fe){return fe.name.slice(0,K.length)===K}),A=0;A<ee.length;A++)delete this.files[ee[A].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(K){var te,ee={};try{if(ee=o.extend(K||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:n.utf8encode}),ee.type=ee.type.toLowerCase(),ee.compression=ee.compression.toUpperCase(),ee.type==="binarystring"&&(ee.type="string"),!ee.type)throw new Error("No output type specified.");o.checkSupport(ee.type),(ee.platform==="darwin"||ee.platform==="freebsd"||ee.platform==="linux"||ee.platform==="sunos")&&(ee.platform="UNIX"),ee.platform==="win32"&&(ee.platform="DOS");var A=ee.comment||this.comment||"";te=b.generateWorker(this,ee,A)}catch(me){te=new l("error"),te.error(me)}return new c(te,ee.type||"string",ee.mimeType)},generateAsync:function(K,te){return this.generateInternalStream(K).accumulate(te)},generateNodeStream:function(K,te){return K=K||{},K.type||(K.type="nodebuffer"),this.generateInternalStream(K).toNodejsStream(te)}};t.exports=re},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(g,t,i){t.exports=g("stream")},{stream:void 0}],17:[function(g,t,i){var n=g("./DataReader"),o=g("../utils");function l(c){n.call(this,c);for(var d=0;d<this.data.length;d++)c[d]=c[d]&255}o.inherits(l,n),l.prototype.byteAt=function(c){return this.data[this.zero+c]},l.prototype.lastIndexOfSignature=function(c){for(var d=c.charCodeAt(0),f=c.charCodeAt(1),m=c.charCodeAt(2),b=c.charCodeAt(3),T=this.length-4;T>=0;--T)if(this.data[T]===d&&this.data[T+1]===f&&this.data[T+2]===m&&this.data[T+3]===b)return T-this.zero;return-1},l.prototype.readAndCheckSignature=function(c){var d=c.charCodeAt(0),f=c.charCodeAt(1),m=c.charCodeAt(2),b=c.charCodeAt(3),T=this.readData(4);return d===T[0]&&f===T[1]&&m===T[2]&&b===T[3]},l.prototype.readData=function(c){if(this.checkOffset(c),c===0)return[];var d=this.data.slice(this.zero+this.index,this.zero+this.index+c);return this.index+=c,d},t.exports=l},{"../utils":32,"./DataReader":18}],18:[function(g,t,i){var n=g("../utils");function o(l){this.data=l,this.length=l.length,this.index=0,this.zero=0}o.prototype={checkOffset:function(l){this.checkIndex(this.index+l)},checkIndex:function(l){if(this.length<this.zero+l||l<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+l+"). Corrupted zip ?")},setIndex:function(l){this.checkIndex(l),this.index=l},skip:function(l){this.setIndex(this.index+l)},byteAt:function(){},readInt:function(l){var c=0,d;for(this.checkOffset(l),d=this.index+l-1;d>=this.index;d--)c=(c<<8)+this.byteAt(d);return this.index+=l,c},readString:function(l){return n.transformTo("string",this.readData(l))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var l=this.readInt(4);return new Date(Date.UTC((l>>25&127)+1980,(l>>21&15)-1,l>>16&31,l>>11&31,l>>5&63,(l&31)<<1))}},t.exports=o},{"../utils":32}],19:[function(g,t,i){var n=g("./Uint8ArrayReader"),o=g("../utils");function l(c){n.call(this,c)}o.inherits(l,n),l.prototype.readData=function(c){this.checkOffset(c);var d=this.data.slice(this.zero+this.index,this.zero+this.index+c);return this.index+=c,d},t.exports=l},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(g,t,i){var n=g("./DataReader"),o=g("../utils");function l(c){n.call(this,c)}o.inherits(l,n),l.prototype.byteAt=function(c){return this.data.charCodeAt(this.zero+c)},l.prototype.lastIndexOfSignature=function(c){return this.data.lastIndexOf(c)-this.zero},l.prototype.readAndCheckSignature=function(c){var d=this.readData(4);return c===d},l.prototype.readData=function(c){this.checkOffset(c);var d=this.data.slice(this.zero+this.index,this.zero+this.index+c);return this.index+=c,d},t.exports=l},{"../utils":32,"./DataReader":18}],21:[function(g,t,i){var n=g("./ArrayReader"),o=g("../utils");function l(c){n.call(this,c)}o.inherits(l,n),l.prototype.readData=function(c){if(this.checkOffset(c),c===0)return new Uint8Array(0);var d=this.data.subarray(this.zero+this.index,this.zero+this.index+c);return this.index+=c,d},t.exports=l},{"../utils":32,"./ArrayReader":17}],22:[function(g,t,i){var n=g("../utils"),o=g("../support"),l=g("./ArrayReader"),c=g("./StringReader"),d=g("./NodeBufferReader"),f=g("./Uint8ArrayReader");t.exports=function(m){var b=n.getTypeOf(m);return n.checkSupport(b),b==="string"&&!o.uint8array?new c(m):b==="nodebuffer"?new d(m):o.uint8array?new f(n.transformTo("uint8array",m)):new l(n.transformTo("array",m))}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(g,t,i){i.LOCAL_FILE_HEADER="PK",i.CENTRAL_FILE_HEADER="PK",i.CENTRAL_DIRECTORY_END="PK",i.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",i.ZIP64_CENTRAL_DIRECTORY_END="PK",i.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(g,t,i){var n=g("./GenericWorker"),o=g("../utils");function l(c){n.call(this,"ConvertWorker to "+c),this.destType=c}o.inherits(l,n),l.prototype.processChunk=function(c){this.push({data:o.transformTo(this.destType,c.data),meta:c.meta})},t.exports=l},{"../utils":32,"./GenericWorker":28}],25:[function(g,t,i){var n=g("./GenericWorker"),o=g("../crc32"),l=g("../utils");function c(){n.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}l.inherits(c,n),c.prototype.processChunk=function(d){this.streamInfo.crc32=o(d.data,this.streamInfo.crc32||0),this.push(d)},t.exports=c},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(g,t,i){var n=g("../utils"),o=g("./GenericWorker");function l(c){o.call(this,"DataLengthProbe for "+c),this.propName=c,this.withStreamInfo(c,0)}n.inherits(l,o),l.prototype.processChunk=function(c){if(c){var d=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=d+c.data.length}o.prototype.processChunk.call(this,c)},t.exports=l},{"../utils":32,"./GenericWorker":28}],27:[function(g,t,i){var n=g("../utils"),o=g("./GenericWorker"),l=16*1024;function c(d){o.call(this,"DataWorker");var f=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,d.then(function(m){f.dataIsReady=!0,f.data=m,f.max=m&&m.length||0,f.type=n.getTypeOf(m),f.isPaused||f._tickAndRepeat()},function(m){f.error(m)})}n.inherits(c,o),c.prototype.cleanUp=function(){o.prototype.cleanUp.call(this),this.data=null},c.prototype.resume=function(){return o.prototype.resume.call(this)?(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,n.delay(this._tickAndRepeat,[],this)),!0):!1},c.prototype._tickAndRepeat=function(){this._tickScheduled=!1,!(this.isPaused||this.isFinished)&&(this._tick(),this.isFinished||(n.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},c.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var d=l,f=null,m=Math.min(this.max,this.index+d);if(this.index>=this.max)return this.end();switch(this.type){case"string":f=this.data.substring(this.index,m);break;case"uint8array":f=this.data.subarray(this.index,m);break;case"array":case"nodebuffer":f=this.data.slice(this.index,m);break}return this.index=m,this.push({data:f,meta:{percent:this.max?this.index/this.max*100:0}})},t.exports=c},{"../utils":32,"./GenericWorker":28}],28:[function(g,t,i){function n(o){this.name=o||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}n.prototype={push:function(o){this.emit("data",o)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(o){this.emit("error",o)}return!0},error:function(o){return this.isFinished?!1:(this.isPaused?this.generatedError=o:(this.isFinished=!0,this.emit("error",o),this.previous&&this.previous.error(o),this.cleanUp()),!0)},on:function(o,l){return this._listeners[o].push(l),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(o,l){if(this._listeners[o])for(var c=0;c<this._listeners[o].length;c++)this._listeners[o][c].call(this,l)},pipe:function(o){return o.registerPrevious(this)},registerPrevious:function(o){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=o.streamInfo,this.mergeStreamInfo(),this.previous=o;var l=this;return o.on("data",function(c){l.processChunk(c)}),o.on("end",function(){l.end()}),o.on("error",function(c){l.error(c)}),this},pause:function(){return this.isPaused||this.isFinished?!1:(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;this.isPaused=!1;var o=!1;return this.generatedError&&(this.error(this.generatedError),o=!0),this.previous&&this.previous.resume(),!o},flush:function(){},processChunk:function(o){this.push(o)},withStreamInfo:function(o,l){return this.extraStreamInfo[o]=l,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var o in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,o)&&(this.streamInfo[o]=this.extraStreamInfo[o])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var o="Worker "+this.name;return this.previous?this.previous+" -> "+o:o}},t.exports=n},{}],29:[function(g,t,i){var n=g("../utils"),o=g("./ConvertWorker"),l=g("./GenericWorker"),c=g("../base64"),d=g("../support"),f=g("../external"),m=null;if(d.nodestream)try{m=g("../nodejs/NodejsStreamOutputAdapter")}catch{}function b(x,L,F){switch(x){case"blob":return n.newBlob(n.transformTo("arraybuffer",L),F);case"base64":return c.encode(L);default:return n.transformTo(x,L)}}function T(x,L){var F,X=0,re=null,K=0;for(F=0;F<L.length;F++)K+=L[F].length;switch(x){case"string":return L.join("");case"array":return Array.prototype.concat.apply([],L);case"uint8array":for(re=new Uint8Array(K),F=0;F<L.length;F++)re.set(L[F],X),X+=L[F].length;return re;case"nodebuffer":return Buffer.concat(L);default:throw new Error("concat : unsupported type '"+x+"'")}}function C(x,L){return new f.Promise(function(F,X){var re=[],K=x._internalType,te=x._outputType,ee=x._mimeType;x.on("data",function(A,me){re.push(A),L&&L(me)}).on("error",function(A){re=[],X(A)}).on("end",function(){try{var A=b(te,T(K,re),ee);F(A)}catch(me){X(me)}re=[]}).resume()})}function P(x,L,F){var X=L;switch(L){case"blob":case"arraybuffer":X="uint8array";break;case"base64":X="string";break}try{this._internalType=X,this._outputType=L,this._mimeType=F,n.checkSupport(X),this._worker=x.pipe(new o(X)),x.lock()}catch(re){this._worker=new l("error"),this._worker.error(re)}}P.prototype={accumulate:function(x){return C(this,x)},on:function(x,L){var F=this;return x==="data"?this._worker.on(x,function(X){L.call(F,X.data,X.meta)}):this._worker.on(x,function(){n.delay(L,arguments,F)}),this},resume:function(){return n.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(x){if(n.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new m(this,{objectMode:this._outputType!=="nodebuffer"},x)}},t.exports=P},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(g,t,i){if(i.base64=!0,i.array=!0,i.string=!0,i.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",i.nodebuffer=typeof Buffer<"u",i.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")i.blob=!1;else{var n=new ArrayBuffer(0);try{i.blob=new Blob([n],{type:"application/zip"}).size===0}catch{try{var o=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder,l=new o;l.append(n),i.blob=l.getBlob("application/zip").size===0}catch{i.blob=!1}}}try{i.nodestream=!!g("readable-stream").Readable}catch{i.nodestream=!1}},{"readable-stream":16}],31:[function(g,t,i){for(var n=g("./utils"),o=g("./support"),l=g("./nodejsUtils"),c=g("./stream/GenericWorker"),d=new Array(256),f=0;f<256;f++)d[f]=f>=252?6:f>=248?5:f>=240?4:f>=224?3:f>=192?2:1;d[254]=d[254]=1;var m=function(x){var L,F,X,re,K,te=x.length,ee=0;for(re=0;re<te;re++)F=x.charCodeAt(re),(F&64512)===55296&&re+1<te&&(X=x.charCodeAt(re+1),(X&64512)===56320&&(F=65536+(F-55296<<10)+(X-56320),re++)),ee+=F<128?1:F<2048?2:F<65536?3:4;for(o.uint8array?L=new Uint8Array(ee):L=new Array(ee),K=0,re=0;K<ee;re++)F=x.charCodeAt(re),(F&64512)===55296&&re+1<te&&(X=x.charCodeAt(re+1),(X&64512)===56320&&(F=65536+(F-55296<<10)+(X-56320),re++)),F<128?L[K++]=F:F<2048?(L[K++]=192|F>>>6,L[K++]=128|F&63):F<65536?(L[K++]=224|F>>>12,L[K++]=128|F>>>6&63,L[K++]=128|F&63):(L[K++]=240|F>>>18,L[K++]=128|F>>>12&63,L[K++]=128|F>>>6&63,L[K++]=128|F&63);return L},b=function(x,L){var F;for(L=L||x.length,L>x.length&&(L=x.length),F=L-1;F>=0&&(x[F]&192)===128;)F--;return F<0||F===0?L:F+d[x[F]]>L?F:L},T=function(x){var L,F,X,re,K=x.length,te=new Array(K*2);for(F=0,L=0;L<K;){if(X=x[L++],X<128){te[F++]=X;continue}if(re=d[X],re>4){te[F++]=65533,L+=re-1;continue}for(X&=re===2?31:re===3?15:7;re>1&&L<K;)X=X<<6|x[L++]&63,re--;if(re>1){te[F++]=65533;continue}X<65536?te[F++]=X:(X-=65536,te[F++]=55296|X>>10&1023,te[F++]=56320|X&1023)}return te.length!==F&&(te.subarray?te=te.subarray(0,F):te.length=F),n.applyFromCharCode(te)};i.utf8encode=function(L){return o.nodebuffer?l.newBufferFrom(L,"utf-8"):m(L)},i.utf8decode=function(L){return o.nodebuffer?n.transformTo("nodebuffer",L).toString("utf-8"):(L=n.transformTo(o.uint8array?"uint8array":"array",L),T(L))};function C(){c.call(this,"utf-8 decode"),this.leftOver=null}n.inherits(C,c),C.prototype.processChunk=function(x){var L=n.transformTo(o.uint8array?"uint8array":"array",x.data);if(this.leftOver&&this.leftOver.length){if(o.uint8array){var F=L;L=new Uint8Array(F.length+this.leftOver.length),L.set(this.leftOver,0),L.set(F,this.leftOver.length)}else L=this.leftOver.concat(L);this.leftOver=null}var X=b(L),re=L;X!==L.length&&(o.uint8array?(re=L.subarray(0,X),this.leftOver=L.subarray(X,L.length)):(re=L.slice(0,X),this.leftOver=L.slice(X,L.length))),this.push({data:i.utf8decode(re),meta:x.meta})},C.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:i.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},i.Utf8DecodeWorker=C;function P(){c.call(this,"utf-8 encode")}n.inherits(P,c),P.prototype.processChunk=function(x){this.push({data:i.utf8encode(x.data),meta:x.meta})},i.Utf8EncodeWorker=P},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(g,t,i){var n=g("./support"),o=g("./base64"),l=g("./nodejsUtils"),c=g("./external");g("setimmediate");function d(x){var L=null;return n.uint8array?L=new Uint8Array(x.length):L=new Array(x.length),m(x,L)}i.newBlob=function(x,L){i.checkSupport("blob");try{return new Blob([x],{type:L})}catch{try{var F=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder,X=new F;return X.append(x),X.getBlob(L)}catch{throw new Error("Bug : can't construct the Blob.")}}};function f(x){return x}function m(x,L){for(var F=0;F<x.length;++F)L[F]=x.charCodeAt(F)&255;return L}var b={stringifyByChunk:function(x,L,F){var X=[],re=0,K=x.length;if(K<=F)return String.fromCharCode.apply(null,x);for(;re<K;)L==="array"||L==="nodebuffer"?X.push(String.fromCharCode.apply(null,x.slice(re,Math.min(re+F,K)))):X.push(String.fromCharCode.apply(null,x.subarray(re,Math.min(re+F,K)))),re+=F;return X.join("")},stringifyByChar:function(x){for(var L="",F=0;F<x.length;F++)L+=String.fromCharCode(x[F]);return L},applyCanBeUsed:{uint8array:function(){try{return n.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return n.nodebuffer&&String.fromCharCode.apply(null,l.allocBuffer(1)).length===1}catch{return!1}}()}};function T(x){var L=65536,F=i.getTypeOf(x),X=!0;if(F==="uint8array"?X=b.applyCanBeUsed.uint8array:F==="nodebuffer"&&(X=b.applyCanBeUsed.nodebuffer),X)for(;L>1;)try{return b.stringifyByChunk(x,F,L)}catch{L=Math.floor(L/2)}return b.stringifyByChar(x)}i.applyFromCharCode=T;function C(x,L){for(var F=0;F<x.length;F++)L[F]=x[F];return L}var P={};P.string={string:f,array:function(x){return m(x,new Array(x.length))},arraybuffer:function(x){return P.string.uint8array(x).buffer},uint8array:function(x){return m(x,new Uint8Array(x.length))},nodebuffer:function(x){return m(x,l.allocBuffer(x.length))}},P.array={string:T,array:f,arraybuffer:function(x){return new Uint8Array(x).buffer},uint8array:function(x){return new Uint8Array(x)},nodebuffer:function(x){return l.newBufferFrom(x)}},P.arraybuffer={string:function(x){return T(new Uint8Array(x))},array:function(x){return C(new Uint8Array(x),new Array(x.byteLength))},arraybuffer:f,uint8array:function(x){return new Uint8Array(x)},nodebuffer:function(x){return l.newBufferFrom(new Uint8Array(x))}},P.uint8array={string:T,array:function(x){return C(x,new Array(x.length))},arraybuffer:function(x){return x.buffer},uint8array:f,nodebuffer:function(x){return l.newBufferFrom(x)}},P.nodebuffer={string:T,array:function(x){return C(x,new Array(x.length))},arraybuffer:function(x){return P.nodebuffer.uint8array(x).buffer},uint8array:function(x){return C(x,new Uint8Array(x.length))},nodebuffer:f},i.transformTo=function(x,L){if(L||(L=""),!x)return L;i.checkSupport(x);var F=i.getTypeOf(L),X=P[F][x](L);return X},i.resolve=function(x){for(var L=x.split("/"),F=[],X=0;X<L.length;X++){var re=L[X];re==="."||re===""&&X!==0&&X!==L.length-1||(re===".."?F.pop():F.push(re))}return F.join("/")},i.getTypeOf=function(x){if(typeof x=="string")return"string";if(Object.prototype.toString.call(x)==="[object Array]")return"array";if(n.nodebuffer&&l.isBuffer(x))return"nodebuffer";if(n.uint8array&&x instanceof Uint8Array)return"uint8array";if(n.arraybuffer&&x instanceof ArrayBuffer)return"arraybuffer"},i.checkSupport=function(x){var L=n[x.toLowerCase()];if(!L)throw new Error(x+" is not supported by this platform")},i.MAX_VALUE_16BITS=65535,i.MAX_VALUE_32BITS=-1,i.pretty=function(x){var L="",F,X;for(X=0;X<(x||"").length;X++)F=x.charCodeAt(X),L+="\\x"+(F<16?"0":"")+F.toString(16).toUpperCase();return L},i.delay=function(x,L,F){setImmediate(function(){x.apply(F||null,L||[])})},i.inherits=function(x,L){var F=function(){};F.prototype=L.prototype,x.prototype=new F},i.extend=function(){var x={},L,F;for(L=0;L<arguments.length;L++)for(F in arguments[L])Object.prototype.hasOwnProperty.call(arguments[L],F)&&typeof x[F]>"u"&&(x[F]=arguments[L][F]);return x},i.prepareContent=function(x,L,F,X,re){var K=c.Promise.resolve(L).then(function(te){var ee=n.blob&&(te instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(te))!==-1);return ee&&typeof FileReader<"u"?new c.Promise(function(A,me){var fe=new FileReader;fe.onload=function(J){A(J.target.result)},fe.onerror=function(J){me(J.target.error)},fe.readAsArrayBuffer(te)}):te});return K.then(function(te){var ee=i.getTypeOf(te);return ee?(ee==="arraybuffer"?te=i.transformTo("uint8array",te):ee==="string"&&(re?te=o.decode(te):F&&X!==!0&&(te=d(te))),te):c.Promise.reject(new Error("Can't read the data of '"+x+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(g,t,i){var n=g("./reader/readerFor"),o=g("./utils"),l=g("./signature"),c=g("./zipEntry"),d=g("./support");function f(m){this.files=[],this.loadOptions=m}f.prototype={checkSignature:function(m){if(!this.reader.readAndCheckSignature(m)){this.reader.index-=4;var b=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+o.pretty(b)+", expected "+o.pretty(m)+")")}},isSignature:function(m,b){var T=this.reader.index;this.reader.setIndex(m);var C=this.reader.readString(4),P=C===b;return this.reader.setIndex(T),P},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var m=this.reader.readData(this.zipCommentLength),b=d.uint8array?"uint8array":"array",T=o.transformTo(b,m);this.zipComment=this.loadOptions.decodeFileName(T)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var m=this.zip64EndOfCentralSize-44,b=0,T,C,P;b<m;)T=this.reader.readInt(2),C=this.reader.readInt(4),P=this.reader.readData(C),this.zip64ExtensibleData[T]={id:T,length:C,value:P}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var m,b;for(m=0;m<this.files.length;m++)b=this.files[m],this.reader.setIndex(b.localHeaderOffset),this.checkSignature(l.LOCAL_FILE_HEADER),b.readLocalPart(this.reader),b.handleUTF8(),b.processAttributes()},readCentralDir:function(){var m;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(l.CENTRAL_FILE_HEADER);)m=new c({zip64:this.zip64},this.loadOptions),m.readCentralPart(this.reader),this.files.push(m);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var m=this.reader.lastIndexOfSignature(l.CENTRAL_DIRECTORY_END);if(m<0){var b=!this.isSignature(0,l.LOCAL_FILE_HEADER);throw b?new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html"):new Error("Corrupted zip: can't find end of central directory")}this.reader.setIndex(m);var T=m;if(this.checkSignature(l.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===o.MAX_VALUE_16BITS||this.diskWithCentralDirStart===o.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===o.MAX_VALUE_16BITS||this.centralDirRecords===o.MAX_VALUE_16BITS||this.centralDirSize===o.MAX_VALUE_32BITS||this.centralDirOffset===o.MAX_VALUE_32BITS){if(this.zip64=!0,m=this.reader.lastIndexOfSignature(l.ZIP64_CENTRAL_DIRECTORY_LOCATOR),m<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(m),this.checkSignature(l.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,l.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(l.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(l.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var C=this.centralDirOffset+this.centralDirSize;this.zip64&&(C+=20,C+=12+this.zip64EndOfCentralSize);var P=T-C;if(P>0)this.isSignature(T,l.CENTRAL_FILE_HEADER)||(this.reader.zero=P);else if(P<0)throw new Error("Corrupted zip: missing "+Math.abs(P)+" bytes.")},prepareReader:function(m){this.reader=n(m)},load:function(m){this.prepareReader(m),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},t.exports=f},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(g,t,i){var n=g("./reader/readerFor"),o=g("./utils"),l=g("./compressedObject"),c=g("./crc32"),d=g("./utf8"),f=g("./compressions"),m=g("./support"),b=0,T=3,C=function(x){for(var L in f)if(Object.prototype.hasOwnProperty.call(f,L)&&f[L].magic===x)return f[L];return null};function P(x,L){this.options=x,this.loadOptions=L}P.prototype={isEncrypted:function(){return(this.bitFlag&1)===1},useUTF8:function(){return(this.bitFlag&2048)===2048},readLocalPart:function(x){var L,F;if(x.skip(22),this.fileNameLength=x.readInt(2),F=x.readInt(2),this.fileName=x.readData(this.fileNameLength),x.skip(F),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(L=C(this.compressionMethod),L===null)throw new Error("Corrupted zip : compression "+o.pretty(this.compressionMethod)+" unknown (inner file : "+o.transformTo("string",this.fileName)+")");this.decompressed=new l(this.compressedSize,this.uncompressedSize,this.crc32,L,x.readData(this.compressedSize))},readCentralPart:function(x){this.versionMadeBy=x.readInt(2),x.skip(2),this.bitFlag=x.readInt(2),this.compressionMethod=x.readString(2),this.date=x.readDate(),this.crc32=x.readInt(4),this.compressedSize=x.readInt(4),this.uncompressedSize=x.readInt(4);var L=x.readInt(2);if(this.extraFieldsLength=x.readInt(2),this.fileCommentLength=x.readInt(2),this.diskNumberStart=x.readInt(2),this.internalFileAttributes=x.readInt(2),this.externalFileAttributes=x.readInt(4),this.localHeaderOffset=x.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");x.skip(L),this.readExtraFields(x),this.parseZIP64ExtraField(x),this.fileComment=x.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var x=this.versionMadeBy>>8;this.dir=!!(this.externalFileAttributes&16),x===b&&(this.dosPermissions=this.externalFileAttributes&63),x===T&&(this.unixPermissions=this.externalFileAttributes>>16&65535),!this.dir&&this.fileNameStr.slice(-1)==="/"&&(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var x=n(this.extraFields[1].value);this.uncompressedSize===o.MAX_VALUE_32BITS&&(this.uncompressedSize=x.readInt(8)),this.compressedSize===o.MAX_VALUE_32BITS&&(this.compressedSize=x.readInt(8)),this.localHeaderOffset===o.MAX_VALUE_32BITS&&(this.localHeaderOffset=x.readInt(8)),this.diskNumberStart===o.MAX_VALUE_32BITS&&(this.diskNumberStart=x.readInt(4))}},readExtraFields:function(x){var L=x.index+this.extraFieldsLength,F,X,re;for(this.extraFields||(this.extraFields={});x.index+4<L;)F=x.readInt(2),X=x.readInt(2),re=x.readData(X),this.extraFields[F]={id:F,length:X,value:re};x.setIndex(L)},handleUTF8:function(){var x=m.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=d.utf8decode(this.fileName),this.fileCommentStr=d.utf8decode(this.fileComment);else{var L=this.findExtraFieldUnicodePath();if(L!==null)this.fileNameStr=L;else{var F=o.transformTo(x,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(F)}var X=this.findExtraFieldUnicodeComment();if(X!==null)this.fileCommentStr=X;else{var re=o.transformTo(x,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(re)}}},findExtraFieldUnicodePath:function(){var x=this.extraFields[28789];if(x){var L=n(x.value);return L.readInt(1)!==1||c(this.fileName)!==L.readInt(4)?null:d.utf8decode(L.readData(x.length-5))}return null},findExtraFieldUnicodeComment:function(){var x=this.extraFields[25461];if(x){var L=n(x.value);return L.readInt(1)!==1||c(this.fileComment)!==L.readInt(4)?null:d.utf8decode(L.readData(x.length-5))}return null}},t.exports=P},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(g,t,i){var n=g("./stream/StreamHelper"),o=g("./stream/DataWorker"),l=g("./utf8"),c=g("./compressedObject"),d=g("./stream/GenericWorker"),f=function(C,P,x){this.name=C,this.dir=x.dir,this.date=x.date,this.comment=x.comment,this.unixPermissions=x.unixPermissions,this.dosPermissions=x.dosPermissions,this._data=P,this._dataBinary=x.binary,this.options={compression:x.compression,compressionOptions:x.compressionOptions}};f.prototype={internalStream:function(C){var P=null,x="string";try{if(!C)throw new Error("No output type specified.");x=C.toLowerCase();var L=x==="string"||x==="text";(x==="binarystring"||x==="text")&&(x="string"),P=this._decompressWorker();var F=!this._dataBinary;F&&!L&&(P=P.pipe(new l.Utf8EncodeWorker)),!F&&L&&(P=P.pipe(new l.Utf8DecodeWorker))}catch(X){P=new d("error"),P.error(X)}return new n(P,x,"")},async:function(C,P){return this.internalStream(C).accumulate(P)},nodeStream:function(C,P){return this.internalStream(C||"nodebuffer").toNodejsStream(P)},_compressWorker:function(C,P){if(this._data instanceof c&&this._data.compression.magic===C.magic)return this._data.getCompressedWorker();var x=this._decompressWorker();return this._dataBinary||(x=x.pipe(new l.Utf8EncodeWorker)),c.createWorkerFrom(x,C,P)},_decompressWorker:function(){return this._data instanceof c?this._data.getContentWorker():this._data instanceof d?this._data:new o(this._data)}};for(var m=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],b=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},T=0;T<m.length;T++)f.prototype[m[T]]=b;t.exports=f},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(g,t,i){(function(n){var o=n.MutationObserver||n.WebKitMutationObserver,l;if(o){var c=0,d=new o(C),f=n.document.createTextNode("");d.observe(f,{characterData:!0}),l=function(){f.data=c=++c%2}}else if(!n.setImmediate&&typeof n.MessageChannel<"u"){var m=new n.MessageChannel;m.port1.onmessage=C,l=function(){m.port2.postMessage(0)}}else"document"in n&&"onreadystatechange"in n.document.createElement("script")?l=function(){var x=n.document.createElement("script");x.onreadystatechange=function(){C(),x.onreadystatechange=null,x.parentNode.removeChild(x),x=null},n.document.documentElement.appendChild(x)}:l=function(){setTimeout(C,0)};var b,T=[];function C(){b=!0;for(var x,L,F=T.length;F;){for(L=T,T=[],x=-1;++x<F;)L[x]();F=T.length}b=!1}t.exports=P;function P(x){T.push(x)===1&&!b&&l()}}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(g,t,i){var n=g("immediate");function o(){}var l={},c=["REJECTED"],d=["FULFILLED"],f=["PENDING"];t.exports=m;function m(K){if(typeof K!="function")throw new TypeError("resolver must be a function");this.state=f,this.queue=[],this.outcome=void 0,K!==o&&P(this,K)}m.prototype.finally=function(K){if(typeof K!="function")return this;var te=this.constructor;return this.then(ee,A);function ee(me){function fe(){return me}return te.resolve(K()).then(fe)}function A(me){function fe(){throw me}return te.resolve(K()).then(fe)}},m.prototype.catch=function(K){return this.then(null,K)},m.prototype.then=function(K,te){if(typeof K!="function"&&this.state===d||typeof te!="function"&&this.state===c)return this;var ee=new this.constructor(o);if(this.state!==f){var A=this.state===d?K:te;T(ee,A,this.outcome)}else this.queue.push(new b(ee,K,te));return ee};function b(K,te,ee){this.promise=K,typeof te=="function"&&(this.onFulfilled=te,this.callFulfilled=this.otherCallFulfilled),typeof ee=="function"&&(this.onRejected=ee,this.callRejected=this.otherCallRejected)}b.prototype.callFulfilled=function(K){l.resolve(this.promise,K)},b.prototype.otherCallFulfilled=function(K){T(this.promise,this.onFulfilled,K)},b.prototype.callRejected=function(K){l.reject(this.promise,K)},b.prototype.otherCallRejected=function(K){T(this.promise,this.onRejected,K)};function T(K,te,ee){n(function(){var A;try{A=te(ee)}catch(me){return l.reject(K,me)}A===K?l.reject(K,new TypeError("Cannot resolve promise with itself")):l.resolve(K,A)})}l.resolve=function(K,te){var ee=x(C,te);if(ee.status==="error")return l.reject(K,ee.value);var A=ee.value;if(A)P(K,A);else{K.state=d,K.outcome=te;for(var me=-1,fe=K.queue.length;++me<fe;)K.queue[me].callFulfilled(te)}return K},l.reject=function(K,te){K.state=c,K.outcome=te;for(var ee=-1,A=K.queue.length;++ee<A;)K.queue[ee].callRejected(te);return K};function C(K){var te=K&&K.then;if(K&&(typeof K=="object"||typeof K=="function")&&typeof te=="function")return function(){te.apply(K,arguments)}}function P(K,te){var ee=!1;function A(ye){ee||(ee=!0,l.reject(K,ye))}function me(ye){ee||(ee=!0,l.resolve(K,ye))}function fe(){te(me,A)}var J=x(fe);J.status==="error"&&A(J.value)}function x(K,te){var ee={};try{ee.value=K(te),ee.status="success"}catch(A){ee.status="error",ee.value=A}return ee}m.resolve=L;function L(K){return K instanceof this?K:l.resolve(new this(o),K)}m.reject=F;function F(K){var te=new this(o);return l.reject(te,K)}m.all=X;function X(K){var te=this;if(Object.prototype.toString.call(K)!=="[object Array]")return this.reject(new TypeError("must be an array"));var ee=K.length,A=!1;if(!ee)return this.resolve([]);for(var me=new Array(ee),fe=0,J=-1,ye=new this(o);++J<ee;)Oe(K[J],J);return ye;function Oe(ot,Tt){te.resolve(ot).then(dt,function(kt){A||(A=!0,l.reject(ye,kt))});function dt(kt){me[Tt]=kt,++fe===ee&&!A&&(A=!0,l.resolve(ye,me))}}}m.race=re;function re(K){var te=this;if(Object.prototype.toString.call(K)!=="[object Array]")return this.reject(new TypeError("must be an array"));var ee=K.length,A=!1;if(!ee)return this.resolve([]);for(var me=-1,fe=new this(o);++me<ee;)J(K[me]);return fe;function J(ye){te.resolve(ye).then(function(Oe){A||(A=!0,l.resolve(fe,Oe))},function(Oe){A||(A=!0,l.reject(fe,Oe))})}}},{immediate:36}],38:[function(g,t,i){var n=g("./lib/utils/common").assign,o=g("./lib/deflate"),l=g("./lib/inflate"),c=g("./lib/zlib/constants"),d={};n(d,o,l,c),t.exports=d},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(g,t,i){var n=g("./zlib/deflate"),o=g("./utils/common"),l=g("./utils/strings"),c=g("./zlib/messages"),d=g("./zlib/zstream"),f=Object.prototype.toString,m=0,b=4,T=0,C=1,P=2,x=-1,L=0,F=8;function X(ee){if(!(this instanceof X))return new X(ee);this.options=o.assign({level:x,method:F,chunkSize:16384,windowBits:15,memLevel:8,strategy:L,to:""},ee||{});var A=this.options;A.raw&&A.windowBits>0?A.windowBits=-A.windowBits:A.gzip&&A.windowBits>0&&A.windowBits<16&&(A.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new d,this.strm.avail_out=0;var me=n.deflateInit2(this.strm,A.level,A.method,A.windowBits,A.memLevel,A.strategy);if(me!==T)throw new Error(c[me]);if(A.header&&n.deflateSetHeader(this.strm,A.header),A.dictionary){var fe;if(typeof A.dictionary=="string"?fe=l.string2buf(A.dictionary):f.call(A.dictionary)==="[object ArrayBuffer]"?fe=new Uint8Array(A.dictionary):fe=A.dictionary,me=n.deflateSetDictionary(this.strm,fe),me!==T)throw new Error(c[me]);this._dict_set=!0}}X.prototype.push=function(ee,A){var me=this.strm,fe=this.options.chunkSize,J,ye;if(this.ended)return!1;ye=A===~~A?A:A===!0?b:m,typeof ee=="string"?me.input=l.string2buf(ee):f.call(ee)==="[object ArrayBuffer]"?me.input=new Uint8Array(ee):me.input=ee,me.next_in=0,me.avail_in=me.input.length;do{if(me.avail_out===0&&(me.output=new o.Buf8(fe),me.next_out=0,me.avail_out=fe),J=n.deflate(me,ye),J!==C&&J!==T)return this.onEnd(J),this.ended=!0,!1;(me.avail_out===0||me.avail_in===0&&(ye===b||ye===P))&&(this.options.to==="string"?this.onData(l.buf2binstring(o.shrinkBuf(me.output,me.next_out))):this.onData(o.shrinkBuf(me.output,me.next_out)))}while((me.avail_in>0||me.avail_out===0)&&J!==C);return ye===b?(J=n.deflateEnd(this.strm),this.onEnd(J),this.ended=!0,J===T):(ye===P&&(this.onEnd(T),me.avail_out=0),!0)},X.prototype.onData=function(ee){this.chunks.push(ee)},X.prototype.onEnd=function(ee){ee===T&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=ee,this.msg=this.strm.msg};function re(ee,A){var me=new X(A);if(me.push(ee,!0),me.err)throw me.msg||c[me.err];return me.result}function K(ee,A){return A=A||{},A.raw=!0,re(ee,A)}function te(ee,A){return A=A||{},A.gzip=!0,re(ee,A)}i.Deflate=X,i.deflate=re,i.deflateRaw=K,i.gzip=te},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(g,t,i){var n=g("./zlib/inflate"),o=g("./utils/common"),l=g("./utils/strings"),c=g("./zlib/constants"),d=g("./zlib/messages"),f=g("./zlib/zstream"),m=g("./zlib/gzheader"),b=Object.prototype.toString;function T(x){if(!(this instanceof T))return new T(x);this.options=o.assign({chunkSize:16384,windowBits:0,to:""},x||{});var L=this.options;L.raw&&L.windowBits>=0&&L.windowBits<16&&(L.windowBits=-L.windowBits,L.windowBits===0&&(L.windowBits=-15)),L.windowBits>=0&&L.windowBits<16&&!(x&&x.windowBits)&&(L.windowBits+=32),L.windowBits>15&&L.windowBits<48&&(L.windowBits&15)===0&&(L.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new f,this.strm.avail_out=0;var F=n.inflateInit2(this.strm,L.windowBits);if(F!==c.Z_OK)throw new Error(d[F]);this.header=new m,n.inflateGetHeader(this.strm,this.header)}T.prototype.push=function(x,L){var F=this.strm,X=this.options.chunkSize,re=this.options.dictionary,K,te,ee,A,me,fe,J=!1;if(this.ended)return!1;te=L===~~L?L:L===!0?c.Z_FINISH:c.Z_NO_FLUSH,typeof x=="string"?F.input=l.binstring2buf(x):b.call(x)==="[object ArrayBuffer]"?F.input=new Uint8Array(x):F.input=x,F.next_in=0,F.avail_in=F.input.length;do{if(F.avail_out===0&&(F.output=new o.Buf8(X),F.next_out=0,F.avail_out=X),K=n.inflate(F,c.Z_NO_FLUSH),K===c.Z_NEED_DICT&&re&&(typeof re=="string"?fe=l.string2buf(re):b.call(re)==="[object ArrayBuffer]"?fe=new Uint8Array(re):fe=re,K=n.inflateSetDictionary(this.strm,fe)),K===c.Z_BUF_ERROR&&J===!0&&(K=c.Z_OK,J=!1),K!==c.Z_STREAM_END&&K!==c.Z_OK)return this.onEnd(K),this.ended=!0,!1;F.next_out&&(F.avail_out===0||K===c.Z_STREAM_END||F.avail_in===0&&(te===c.Z_FINISH||te===c.Z_SYNC_FLUSH))&&(this.options.to==="string"?(ee=l.utf8border(F.output,F.next_out),A=F.next_out-ee,me=l.buf2string(F.output,ee),F.next_out=A,F.avail_out=X-A,A&&o.arraySet(F.output,F.output,ee,A,0),this.onData(me)):this.onData(o.shrinkBuf(F.output,F.next_out))),F.avail_in===0&&F.avail_out===0&&(J=!0)}while((F.avail_in>0||F.avail_out===0)&&K!==c.Z_STREAM_END);return K===c.Z_STREAM_END&&(te=c.Z_FINISH),te===c.Z_FINISH?(K=n.inflateEnd(this.strm),this.onEnd(K),this.ended=!0,K===c.Z_OK):(te===c.Z_SYNC_FLUSH&&(this.onEnd(c.Z_OK),F.avail_out=0),!0)},T.prototype.onData=function(x){this.chunks.push(x)},T.prototype.onEnd=function(x){x===c.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=x,this.msg=this.strm.msg};function C(x,L){var F=new T(L);if(F.push(x,!0),F.err)throw F.msg||d[F.err];return F.result}function P(x,L){return L=L||{},L.raw=!0,C(x,L)}i.Inflate=T,i.inflate=C,i.inflateRaw=P,i.ungzip=C},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(g,t,i){var n=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";i.assign=function(c){for(var d=Array.prototype.slice.call(arguments,1);d.length;){var f=d.shift();if(f){if(typeof f!="object")throw new TypeError(f+"must be non-object");for(var m in f)f.hasOwnProperty(m)&&(c[m]=f[m])}}return c},i.shrinkBuf=function(c,d){return c.length===d?c:c.subarray?c.subarray(0,d):(c.length=d,c)};var o={arraySet:function(c,d,f,m,b){if(d.subarray&&c.subarray){c.set(d.subarray(f,f+m),b);return}for(var T=0;T<m;T++)c[b+T]=d[f+T]},flattenChunks:function(c){var d,f,m,b,T,C;for(m=0,d=0,f=c.length;d<f;d++)m+=c[d].length;for(C=new Uint8Array(m),b=0,d=0,f=c.length;d<f;d++)T=c[d],C.set(T,b),b+=T.length;return C}},l={arraySet:function(c,d,f,m,b){for(var T=0;T<m;T++)c[b+T]=d[f+T]},flattenChunks:function(c){return[].concat.apply([],c)}};i.setTyped=function(c){c?(i.Buf8=Uint8Array,i.Buf16=Uint16Array,i.Buf32=Int32Array,i.assign(i,o)):(i.Buf8=Array,i.Buf16=Array,i.Buf32=Array,i.assign(i,l))},i.setTyped(n)},{}],42:[function(g,t,i){var n=g("./common"),o=!0,l=!0;try{String.fromCharCode.apply(null,[0])}catch{o=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{l=!1}for(var c=new n.Buf8(256),d=0;d<256;d++)c[d]=d>=252?6:d>=248?5:d>=240?4:d>=224?3:d>=192?2:1;c[254]=c[254]=1,i.string2buf=function(m){var b,T,C,P,x,L=m.length,F=0;for(P=0;P<L;P++)T=m.charCodeAt(P),(T&64512)===55296&&P+1<L&&(C=m.charCodeAt(P+1),(C&64512)===56320&&(T=65536+(T-55296<<10)+(C-56320),P++)),F+=T<128?1:T<2048?2:T<65536?3:4;for(b=new n.Buf8(F),x=0,P=0;x<F;P++)T=m.charCodeAt(P),(T&64512)===55296&&P+1<L&&(C=m.charCodeAt(P+1),(C&64512)===56320&&(T=65536+(T-55296<<10)+(C-56320),P++)),T<128?b[x++]=T:T<2048?(b[x++]=192|T>>>6,b[x++]=128|T&63):T<65536?(b[x++]=224|T>>>12,b[x++]=128|T>>>6&63,b[x++]=128|T&63):(b[x++]=240|T>>>18,b[x++]=128|T>>>12&63,b[x++]=128|T>>>6&63,b[x++]=128|T&63);return b};function f(m,b){if(b<65537&&(m.subarray&&l||!m.subarray&&o))return String.fromCharCode.apply(null,n.shrinkBuf(m,b));for(var T="",C=0;C<b;C++)T+=String.fromCharCode(m[C]);return T}i.buf2binstring=function(m){return f(m,m.length)},i.binstring2buf=function(m){for(var b=new n.Buf8(m.length),T=0,C=b.length;T<C;T++)b[T]=m.charCodeAt(T);return b},i.buf2string=function(m,b){var T,C,P,x,L=b||m.length,F=new Array(L*2);for(C=0,T=0;T<L;){if(P=m[T++],P<128){F[C++]=P;continue}if(x=c[P],x>4){F[C++]=65533,T+=x-1;continue}for(P&=x===2?31:x===3?15:7;x>1&&T<L;)P=P<<6|m[T++]&63,x--;if(x>1){F[C++]=65533;continue}P<65536?F[C++]=P:(P-=65536,F[C++]=55296|P>>10&1023,F[C++]=56320|P&1023)}return f(F,C)},i.utf8border=function(m,b){var T;for(b=b||m.length,b>m.length&&(b=m.length),T=b-1;T>=0&&(m[T]&192)===128;)T--;return T<0||T===0?b:T+c[m[T]]>b?T:b}},{"./common":41}],43:[function(g,t,i){function n(o,l,c,d){for(var f=o&65535|0,m=o>>>16&65535|0,b=0;c!==0;){b=c>2e3?2e3:c,c-=b;do f=f+l[d++]|0,m=m+f|0;while(--b);f%=65521,m%=65521}return f|m<<16|0}t.exports=n},{}],44:[function(g,t,i){t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(g,t,i){function n(){for(var c,d=[],f=0;f<256;f++){c=f;for(var m=0;m<8;m++)c=c&1?3988292384^c>>>1:c>>>1;d[f]=c}return d}var o=n();function l(c,d,f,m){var b=o,T=m+f;c^=-1;for(var C=m;C<T;C++)c=c>>>8^b[(c^d[C])&255];return c^-1}t.exports=l},{}],46:[function(g,t,i){var n=g("../utils/common"),o=g("./trees"),l=g("./adler32"),c=g("./crc32"),d=g("./messages"),f=0,m=1,b=3,T=4,C=5,P=0,x=1,L=-2,F=-3,X=-5,re=-1,K=1,te=2,ee=3,A=4,me=0,fe=2,J=8,ye=9,Oe=15,ot=8,Tt=29,dt=256,kt=dt+1+Tt,$e=30,vt=19,Jt=2*kt+1,di=15,Ut=3,ui=258,qt=ui+Ut+1,Ze=32,ki=42,wi=69,jt=73,Yt=91,Ei=103,ii=113,hi=666,Gt=1,es=2,js=3,ps=4,mi=3;function $i(z,We){return z.msg=d[We],We}function ws(z){return(z<<1)-(z>4?9:0)}function pn(z){for(var We=z.length;--We>=0;)z[We]=0}function Mt(z){var We=z.state,qe=We.pending;qe>z.avail_out&&(qe=z.avail_out),qe!==0&&(n.arraySet(z.output,We.pending_buf,We.pending_out,qe,z.next_out),z.next_out+=qe,We.pending_out+=qe,z.total_out+=qe,z.avail_out-=qe,We.pending-=qe,We.pending===0&&(We.pending_out=0))}function Mi(z,We){o._tr_flush_block(z,z.block_start>=0?z.block_start:-1,z.strstart-z.block_start,We),z.block_start=z.strstart,Mt(z.strm)}function Fe(z,We){z.pending_buf[z.pending++]=We}function Pi(z,We){z.pending_buf[z.pending++]=We>>>8&255,z.pending_buf[z.pending++]=We&255}function qs(z,We,qe,le){var De=z.avail_in;return De>le&&(De=le),De===0?0:(z.avail_in-=De,n.arraySet(We,z.input,z.next_in,De,qe),z.state.wrap===1?z.adler=l(z.adler,We,De,qe):z.state.wrap===2&&(z.adler=c(z.adler,We,De,qe)),z.next_in+=De,z.total_in+=De,De)}function Bt(z,We){var qe=z.max_chain_length,le=z.strstart,De,Ge,Ot=z.prev_length,Ct=z.nice_match,It=z.strstart>z.w_size-qt?z.strstart-(z.w_size-qt):0,ni=z.window,Zs=z.w_mask,bi=z.prev,Oi=z.strstart+ui,gs=ni[le+Ot-1],qi=ni[le+Ot];z.prev_length>=z.good_match&&(qe>>=2),Ct>z.lookahead&&(Ct=z.lookahead);do if(De=We,!(ni[De+Ot]!==qi||ni[De+Ot-1]!==gs||ni[De]!==ni[le]||ni[++De]!==ni[le+1])){le+=2,De++;do;while(ni[++le]===ni[++De]&&ni[++le]===ni[++De]&&ni[++le]===ni[++De]&&ni[++le]===ni[++De]&&ni[++le]===ni[++De]&&ni[++le]===ni[++De]&&ni[++le]===ni[++De]&&ni[++le]===ni[++De]&&le<Oi);if(Ge=ui-(Oi-le),le=Oi-ui,Ge>Ot){if(z.match_start=We,Ot=Ge,Ge>=Ct)break;gs=ni[le+Ot-1],qi=ni[le+Ot]}}while((We=bi[We&Zs])>It&&--qe!==0);return Ot<=z.lookahead?Ot:z.lookahead}function ts(z){var We=z.w_size,qe,le,De,Ge,Ot;do{if(Ge=z.window_size-z.lookahead-z.strstart,z.strstart>=We+(We-qt)){n.arraySet(z.window,z.window,We,We,0),z.match_start-=We,z.strstart-=We,z.block_start-=We,le=z.hash_size,qe=le;do De=z.head[--qe],z.head[qe]=De>=We?De-We:0;while(--le);le=We,qe=le;do De=z.prev[--qe],z.prev[qe]=De>=We?De-We:0;while(--le);Ge+=We}if(z.strm.avail_in===0)break;if(le=qs(z.strm,z.window,z.strstart+z.lookahead,Ge),z.lookahead+=le,z.lookahead+z.insert>=Ut)for(Ot=z.strstart-z.insert,z.ins_h=z.window[Ot],z.ins_h=(z.ins_h<<z.hash_shift^z.window[Ot+1])&z.hash_mask;z.insert&&(z.ins_h=(z.ins_h<<z.hash_shift^z.window[Ot+Ut-1])&z.hash_mask,z.prev[Ot&z.w_mask]=z.head[z.ins_h],z.head[z.ins_h]=Ot,Ot++,z.insert--,!(z.lookahead+z.insert<Ut)););}while(z.lookahead<qt&&z.strm.avail_in!==0)}function de(z,We){var qe=65535;for(qe>z.pending_buf_size-5&&(qe=z.pending_buf_size-5);;){if(z.lookahead<=1){if(ts(z),z.lookahead===0&&We===f)return Gt;if(z.lookahead===0)break}z.strstart+=z.lookahead,z.lookahead=0;var le=z.block_start+qe;if((z.strstart===0||z.strstart>=le)&&(z.lookahead=z.strstart-le,z.strstart=le,Mi(z,!1),z.strm.avail_out===0)||z.strstart-z.block_start>=z.w_size-qt&&(Mi(z,!1),z.strm.avail_out===0))return Gt}return z.insert=0,We===T?(Mi(z,!0),z.strm.avail_out===0?js:ps):(z.strstart>z.block_start&&(Mi(z,!1),z.strm.avail_out===0),Gt)}function Te(z,We){for(var qe,le;;){if(z.lookahead<qt){if(ts(z),z.lookahead<qt&&We===f)return Gt;if(z.lookahead===0)break}if(qe=0,z.lookahead>=Ut&&(z.ins_h=(z.ins_h<<z.hash_shift^z.window[z.strstart+Ut-1])&z.hash_mask,qe=z.prev[z.strstart&z.w_mask]=z.head[z.ins_h],z.head[z.ins_h]=z.strstart),qe!==0&&z.strstart-qe<=z.w_size-qt&&(z.match_length=Bt(z,qe)),z.match_length>=Ut)if(le=o._tr_tally(z,z.strstart-z.match_start,z.match_length-Ut),z.lookahead-=z.match_length,z.match_length<=z.max_lazy_match&&z.lookahead>=Ut){z.match_length--;do z.strstart++,z.ins_h=(z.ins_h<<z.hash_shift^z.window[z.strstart+Ut-1])&z.hash_mask,qe=z.prev[z.strstart&z.w_mask]=z.head[z.ins_h],z.head[z.ins_h]=z.strstart;while(--z.match_length!==0);z.strstart++}else z.strstart+=z.match_length,z.match_length=0,z.ins_h=z.window[z.strstart],z.ins_h=(z.ins_h<<z.hash_shift^z.window[z.strstart+1])&z.hash_mask;else le=o._tr_tally(z,0,z.window[z.strstart]),z.lookahead--,z.strstart++;if(le&&(Mi(z,!1),z.strm.avail_out===0))return Gt}return z.insert=z.strstart<Ut-1?z.strstart:Ut-1,We===T?(Mi(z,!0),z.strm.avail_out===0?js:ps):z.last_lit&&(Mi(z,!1),z.strm.avail_out===0)?Gt:es}function Me(z,We){for(var qe,le,De;;){if(z.lookahead<qt){if(ts(z),z.lookahead<qt&&We===f)return Gt;if(z.lookahead===0)break}if(qe=0,z.lookahead>=Ut&&(z.ins_h=(z.ins_h<<z.hash_shift^z.window[z.strstart+Ut-1])&z.hash_mask,qe=z.prev[z.strstart&z.w_mask]=z.head[z.ins_h],z.head[z.ins_h]=z.strstart),z.prev_length=z.match_length,z.prev_match=z.match_start,z.match_length=Ut-1,qe!==0&&z.prev_length<z.max_lazy_match&&z.strstart-qe<=z.w_size-qt&&(z.match_length=Bt(z,qe),z.match_length<=5&&(z.strategy===K||z.match_length===Ut&&z.strstart-z.match_start>4096)&&(z.match_length=Ut-1)),z.prev_length>=Ut&&z.match_length<=z.prev_length){De=z.strstart+z.lookahead-Ut,le=o._tr_tally(z,z.strstart-1-z.prev_match,z.prev_length-Ut),z.lookahead-=z.prev_length-1,z.prev_length-=2;do++z.strstart<=De&&(z.ins_h=(z.ins_h<<z.hash_shift^z.window[z.strstart+Ut-1])&z.hash_mask,qe=z.prev[z.strstart&z.w_mask]=z.head[z.ins_h],z.head[z.ins_h]=z.strstart);while(--z.prev_length!==0);if(z.match_available=0,z.match_length=Ut-1,z.strstart++,le&&(Mi(z,!1),z.strm.avail_out===0))return Gt}else if(z.match_available){if(le=o._tr_tally(z,0,z.window[z.strstart-1]),le&&Mi(z,!1),z.strstart++,z.lookahead--,z.strm.avail_out===0)return Gt}else z.match_available=1,z.strstart++,z.lookahead--}return z.match_available&&(le=o._tr_tally(z,0,z.window[z.strstart-1]),z.match_available=0),z.insert=z.strstart<Ut-1?z.strstart:Ut-1,We===T?(Mi(z,!0),z.strm.avail_out===0?js:ps):z.last_lit&&(Mi(z,!1),z.strm.avail_out===0)?Gt:es}function Xe(z,We){for(var qe,le,De,Ge,Ot=z.window;;){if(z.lookahead<=ui){if(ts(z),z.lookahead<=ui&&We===f)return Gt;if(z.lookahead===0)break}if(z.match_length=0,z.lookahead>=Ut&&z.strstart>0&&(De=z.strstart-1,le=Ot[De],le===Ot[++De]&&le===Ot[++De]&&le===Ot[++De])){Ge=z.strstart+ui;do;while(le===Ot[++De]&&le===Ot[++De]&&le===Ot[++De]&&le===Ot[++De]&&le===Ot[++De]&&le===Ot[++De]&&le===Ot[++De]&&le===Ot[++De]&&De<Ge);z.match_length=ui-(Ge-De),z.match_length>z.lookahead&&(z.match_length=z.lookahead)}if(z.match_length>=Ut?(qe=o._tr_tally(z,1,z.match_length-Ut),z.lookahead-=z.match_length,z.strstart+=z.match_length,z.match_length=0):(qe=o._tr_tally(z,0,z.window[z.strstart]),z.lookahead--,z.strstart++),qe&&(Mi(z,!1),z.strm.avail_out===0))return Gt}return z.insert=0,We===T?(Mi(z,!0),z.strm.avail_out===0?js:ps):z.last_lit&&(Mi(z,!1),z.strm.avail_out===0)?Gt:es}function mt(z,We){for(var qe;;){if(z.lookahead===0&&(ts(z),z.lookahead===0)){if(We===f)return Gt;break}if(z.match_length=0,qe=o._tr_tally(z,0,z.window[z.strstart]),z.lookahead--,z.strstart++,qe&&(Mi(z,!1),z.strm.avail_out===0))return Gt}return z.insert=0,We===T?(Mi(z,!0),z.strm.avail_out===0?js:ps):z.last_lit&&(Mi(z,!1),z.strm.avail_out===0)?Gt:es}function ft(z,We,qe,le,De){this.good_length=z,this.max_lazy=We,this.nice_length=qe,this.max_chain=le,this.func=De}var wt;wt=[new ft(0,0,0,0,de),new ft(4,4,8,4,Te),new ft(4,5,16,8,Te),new ft(4,6,32,32,Te),new ft(4,4,16,16,Me),new ft(8,16,32,32,Me),new ft(8,16,128,128,Me),new ft(8,32,128,256,Me),new ft(32,128,258,1024,Me),new ft(32,258,258,4096,Me)];function $t(z){z.window_size=2*z.w_size,pn(z.head),z.max_lazy_match=wt[z.level].max_lazy,z.good_match=wt[z.level].good_length,z.nice_match=wt[z.level].nice_length,z.max_chain_length=wt[z.level].max_chain,z.strstart=0,z.block_start=0,z.lookahead=0,z.insert=0,z.match_length=z.prev_length=Ut-1,z.match_available=0,z.ins_h=0}function oe(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=J,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new n.Buf16(Jt*2),this.dyn_dtree=new n.Buf16((2*$e+1)*2),this.bl_tree=new n.Buf16((2*vt+1)*2),pn(this.dyn_ltree),pn(this.dyn_dtree),pn(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new n.Buf16(di+1),this.heap=new n.Buf16(2*kt+1),pn(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new n.Buf16(2*kt+1),pn(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function et(z){var We;return!z||!z.state?$i(z,L):(z.total_in=z.total_out=0,z.data_type=fe,We=z.state,We.pending=0,We.pending_out=0,We.wrap<0&&(We.wrap=-We.wrap),We.status=We.wrap?ki:ii,z.adler=We.wrap===2?0:1,We.last_flush=f,o._tr_init(We),P)}function ht(z){var We=et(z);return We===P&&$t(z.state),We}function pt(z,We){return!z||!z.state||z.state.wrap!==2?L:(z.state.gzhead=We,P)}function ke(z,We,qe,le,De,Ge){if(!z)return L;var Ot=1;if(We===re&&(We=6),le<0?(Ot=0,le=-le):le>15&&(Ot=2,le-=16),De<1||De>ye||qe!==J||le<8||le>15||We<0||We>9||Ge<0||Ge>A)return $i(z,L);le===8&&(le=9);var Ct=new oe;return z.state=Ct,Ct.strm=z,Ct.wrap=Ot,Ct.gzhead=null,Ct.w_bits=le,Ct.w_size=1<<Ct.w_bits,Ct.w_mask=Ct.w_size-1,Ct.hash_bits=De+7,Ct.hash_size=1<<Ct.hash_bits,Ct.hash_mask=Ct.hash_size-1,Ct.hash_shift=~~((Ct.hash_bits+Ut-1)/Ut),Ct.window=new n.Buf8(Ct.w_size*2),Ct.head=new n.Buf16(Ct.hash_size),Ct.prev=new n.Buf16(Ct.w_size),Ct.lit_bufsize=1<<De+6,Ct.pending_buf_size=Ct.lit_bufsize*4,Ct.pending_buf=new n.Buf8(Ct.pending_buf_size),Ct.d_buf=1*Ct.lit_bufsize,Ct.l_buf=3*Ct.lit_bufsize,Ct.level=We,Ct.strategy=Ge,Ct.method=qe,ht(z)}function He(z,We){return ke(z,We,J,Oe,ot,me)}function ne(z,We){var qe,le,De,Ge;if(!z||!z.state||We>C||We<0)return z?$i(z,L):L;if(le=z.state,!z.output||!z.input&&z.avail_in!==0||le.status===hi&&We!==T)return $i(z,z.avail_out===0?X:L);if(le.strm=z,qe=le.last_flush,le.last_flush=We,le.status===ki)if(le.wrap===2)z.adler=0,Fe(le,31),Fe(le,139),Fe(le,8),le.gzhead?(Fe(le,(le.gzhead.text?1:0)+(le.gzhead.hcrc?2:0)+(le.gzhead.extra?4:0)+(le.gzhead.name?8:0)+(le.gzhead.comment?16:0)),Fe(le,le.gzhead.time&255),Fe(le,le.gzhead.time>>8&255),Fe(le,le.gzhead.time>>16&255),Fe(le,le.gzhead.time>>24&255),Fe(le,le.level===9?2:le.strategy>=te||le.level<2?4:0),Fe(le,le.gzhead.os&255),le.gzhead.extra&&le.gzhead.extra.length&&(Fe(le,le.gzhead.extra.length&255),Fe(le,le.gzhead.extra.length>>8&255)),le.gzhead.hcrc&&(z.adler=c(z.adler,le.pending_buf,le.pending,0)),le.gzindex=0,le.status=wi):(Fe(le,0),Fe(le,0),Fe(le,0),Fe(le,0),Fe(le,0),Fe(le,le.level===9?2:le.strategy>=te||le.level<2?4:0),Fe(le,mi),le.status=ii);else{var Ot=J+(le.w_bits-8<<4)<<8,Ct=-1;le.strategy>=te||le.level<2?Ct=0:le.level<6?Ct=1:le.level===6?Ct=2:Ct=3,Ot|=Ct<<6,le.strstart!==0&&(Ot|=Ze),Ot+=31-Ot%31,le.status=ii,Pi(le,Ot),le.strstart!==0&&(Pi(le,z.adler>>>16),Pi(le,z.adler&65535)),z.adler=1}if(le.status===wi)if(le.gzhead.extra){for(De=le.pending;le.gzindex<(le.gzhead.extra.length&65535)&&!(le.pending===le.pending_buf_size&&(le.gzhead.hcrc&&le.pending>De&&(z.adler=c(z.adler,le.pending_buf,le.pending-De,De)),Mt(z),De=le.pending,le.pending===le.pending_buf_size));)Fe(le,le.gzhead.extra[le.gzindex]&255),le.gzindex++;le.gzhead.hcrc&&le.pending>De&&(z.adler=c(z.adler,le.pending_buf,le.pending-De,De)),le.gzindex===le.gzhead.extra.length&&(le.gzindex=0,le.status=jt)}else le.status=jt;if(le.status===jt)if(le.gzhead.name){De=le.pending;do{if(le.pending===le.pending_buf_size&&(le.gzhead.hcrc&&le.pending>De&&(z.adler=c(z.adler,le.pending_buf,le.pending-De,De)),Mt(z),De=le.pending,le.pending===le.pending_buf_size)){Ge=1;break}le.gzindex<le.gzhead.name.length?Ge=le.gzhead.name.charCodeAt(le.gzindex++)&255:Ge=0,Fe(le,Ge)}while(Ge!==0);le.gzhead.hcrc&&le.pending>De&&(z.adler=c(z.adler,le.pending_buf,le.pending-De,De)),Ge===0&&(le.gzindex=0,le.status=Yt)}else le.status=Yt;if(le.status===Yt)if(le.gzhead.comment){De=le.pending;do{if(le.pending===le.pending_buf_size&&(le.gzhead.hcrc&&le.pending>De&&(z.adler=c(z.adler,le.pending_buf,le.pending-De,De)),Mt(z),De=le.pending,le.pending===le.pending_buf_size)){Ge=1;break}le.gzindex<le.gzhead.comment.length?Ge=le.gzhead.comment.charCodeAt(le.gzindex++)&255:Ge=0,Fe(le,Ge)}while(Ge!==0);le.gzhead.hcrc&&le.pending>De&&(z.adler=c(z.adler,le.pending_buf,le.pending-De,De)),Ge===0&&(le.status=Ei)}else le.status=Ei;if(le.status===Ei&&(le.gzhead.hcrc?(le.pending+2>le.pending_buf_size&&Mt(z),le.pending+2<=le.pending_buf_size&&(Fe(le,z.adler&255),Fe(le,z.adler>>8&255),z.adler=0,le.status=ii)):le.status=ii),le.pending!==0){if(Mt(z),z.avail_out===0)return le.last_flush=-1,P}else if(z.avail_in===0&&ws(We)<=ws(qe)&&We!==T)return $i(z,X);if(le.status===hi&&z.avail_in!==0)return $i(z,X);if(z.avail_in!==0||le.lookahead!==0||We!==f&&le.status!==hi){var It=le.strategy===te?mt(le,We):le.strategy===ee?Xe(le,We):wt[le.level].func(le,We);if((It===js||It===ps)&&(le.status=hi),It===Gt||It===js)return z.avail_out===0&&(le.last_flush=-1),P;if(It===es&&(We===m?o._tr_align(le):We!==C&&(o._tr_stored_block(le,0,0,!1),We===b&&(pn(le.head),le.lookahead===0&&(le.strstart=0,le.block_start=0,le.insert=0))),Mt(z),z.avail_out===0))return le.last_flush=-1,P}return We!==T?P:le.wrap<=0?x:(le.wrap===2?(Fe(le,z.adler&255),Fe(le,z.adler>>8&255),Fe(le,z.adler>>16&255),Fe(le,z.adler>>24&255),Fe(le,z.total_in&255),Fe(le,z.total_in>>8&255),Fe(le,z.total_in>>16&255),Fe(le,z.total_in>>24&255)):(Pi(le,z.adler>>>16),Pi(le,z.adler&65535)),Mt(z),le.wrap>0&&(le.wrap=-le.wrap),le.pending!==0?P:x)}function tt(z){var We;return!z||!z.state?L:(We=z.state.status,We!==ki&&We!==wi&&We!==jt&&We!==Yt&&We!==Ei&&We!==ii&&We!==hi?$i(z,L):(z.state=null,We===ii?$i(z,F):P))}function xt(z,We){var qe=We.length,le,De,Ge,Ot,Ct,It,ni,Zs;if(!z||!z.state||(le=z.state,Ot=le.wrap,Ot===2||Ot===1&&le.status!==ki||le.lookahead))return L;for(Ot===1&&(z.adler=l(z.adler,We,qe,0)),le.wrap=0,qe>=le.w_size&&(Ot===0&&(pn(le.head),le.strstart=0,le.block_start=0,le.insert=0),Zs=new n.Buf8(le.w_size),n.arraySet(Zs,We,qe-le.w_size,le.w_size,0),We=Zs,qe=le.w_size),Ct=z.avail_in,It=z.next_in,ni=z.input,z.avail_in=qe,z.next_in=0,z.input=We,ts(le);le.lookahead>=Ut;){De=le.strstart,Ge=le.lookahead-(Ut-1);do le.ins_h=(le.ins_h<<le.hash_shift^le.window[De+Ut-1])&le.hash_mask,le.prev[De&le.w_mask]=le.head[le.ins_h],le.head[le.ins_h]=De,De++;while(--Ge);le.strstart=De,le.lookahead=Ut-1,ts(le)}return le.strstart+=le.lookahead,le.block_start=le.strstart,le.insert=le.lookahead,le.lookahead=0,le.match_length=le.prev_length=Ut-1,le.match_available=0,z.next_in=It,z.input=ni,z.avail_in=Ct,le.wrap=Ot,P}i.deflateInit=He,i.deflateInit2=ke,i.deflateReset=ht,i.deflateResetKeep=et,i.deflateSetHeader=pt,i.deflate=ne,i.deflateEnd=tt,i.deflateSetDictionary=xt,i.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(g,t,i){function n(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}t.exports=n},{}],48:[function(g,t,i){var n=30,o=12;t.exports=function(c,d){var f,m,b,T,C,P,x,L,F,X,re,K,te,ee,A,me,fe,J,ye,Oe,ot,Tt,dt,kt,$e;f=c.state,m=c.next_in,kt=c.input,b=m+(c.avail_in-5),T=c.next_out,$e=c.output,C=T-(d-c.avail_out),P=T+(c.avail_out-257),x=f.dmax,L=f.wsize,F=f.whave,X=f.wnext,re=f.window,K=f.hold,te=f.bits,ee=f.lencode,A=f.distcode,me=(1<<f.lenbits)-1,fe=(1<<f.distbits)-1;e:do{te<15&&(K+=kt[m++]<<te,te+=8,K+=kt[m++]<<te,te+=8),J=ee[K&me];t:for(;;){if(ye=J>>>24,K>>>=ye,te-=ye,ye=J>>>16&255,ye===0)$e[T++]=J&65535;else if(ye&16){Oe=J&65535,ye&=15,ye&&(te<ye&&(K+=kt[m++]<<te,te+=8),Oe+=K&(1<<ye)-1,K>>>=ye,te-=ye),te<15&&(K+=kt[m++]<<te,te+=8,K+=kt[m++]<<te,te+=8),J=A[K&fe];i:for(;;){if(ye=J>>>24,K>>>=ye,te-=ye,ye=J>>>16&255,ye&16){if(ot=J&65535,ye&=15,te<ye&&(K+=kt[m++]<<te,te+=8,te<ye&&(K+=kt[m++]<<te,te+=8)),ot+=K&(1<<ye)-1,ot>x){c.msg="invalid distance too far back",f.mode=n;break e}if(K>>>=ye,te-=ye,ye=T-C,ot>ye){if(ye=ot-ye,ye>F&&f.sane){c.msg="invalid distance too far back",f.mode=n;break e}if(Tt=0,dt=re,X===0){if(Tt+=L-ye,ye<Oe){Oe-=ye;do $e[T++]=re[Tt++];while(--ye);Tt=T-ot,dt=$e}}else if(X<ye){if(Tt+=L+X-ye,ye-=X,ye<Oe){Oe-=ye;do $e[T++]=re[Tt++];while(--ye);if(Tt=0,X<Oe){ye=X,Oe-=ye;do $e[T++]=re[Tt++];while(--ye);Tt=T-ot,dt=$e}}}else if(Tt+=X-ye,ye<Oe){Oe-=ye;do $e[T++]=re[Tt++];while(--ye);Tt=T-ot,dt=$e}for(;Oe>2;)$e[T++]=dt[Tt++],$e[T++]=dt[Tt++],$e[T++]=dt[Tt++],Oe-=3;Oe&&($e[T++]=dt[Tt++],Oe>1&&($e[T++]=dt[Tt++]))}else{Tt=T-ot;do $e[T++]=$e[Tt++],$e[T++]=$e[Tt++],$e[T++]=$e[Tt++],Oe-=3;while(Oe>2);Oe&&($e[T++]=$e[Tt++],Oe>1&&($e[T++]=$e[Tt++]))}}else if((ye&64)===0){J=A[(J&65535)+(K&(1<<ye)-1)];continue i}else{c.msg="invalid distance code",f.mode=n;break e}break}}else if((ye&64)===0){J=ee[(J&65535)+(K&(1<<ye)-1)];continue t}else if(ye&32){f.mode=o;break e}else{c.msg="invalid literal/length code",f.mode=n;break e}break}}while(m<b&&T<P);Oe=te>>3,m-=Oe,te-=Oe<<3,K&=(1<<te)-1,c.next_in=m,c.next_out=T,c.avail_in=m<b?5+(b-m):5-(m-b),c.avail_out=T<P?257+(P-T):257-(T-P),f.hold=K,f.bits=te}},{}],49:[function(g,t,i){var n=g("../utils/common"),o=g("./adler32"),l=g("./crc32"),c=g("./inffast"),d=g("./inftrees"),f=0,m=1,b=2,T=4,C=5,P=6,x=0,L=1,F=2,X=-2,re=-3,K=-4,te=-5,ee=8,A=1,me=2,fe=3,J=4,ye=5,Oe=6,ot=7,Tt=8,dt=9,kt=10,$e=11,vt=12,Jt=13,di=14,Ut=15,ui=16,qt=17,Ze=18,ki=19,wi=20,jt=21,Yt=22,Ei=23,ii=24,hi=25,Gt=26,es=27,js=28,ps=29,mi=30,$i=31,ws=32,pn=852,Mt=592,Mi=15,Fe=Mi;function Pi(ke){return(ke>>>24&255)+(ke>>>8&65280)+((ke&65280)<<8)+((ke&255)<<24)}function qs(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new n.Buf16(320),this.work=new n.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function Bt(ke){var He;return!ke||!ke.state?X:(He=ke.state,ke.total_in=ke.total_out=He.total=0,ke.msg="",He.wrap&&(ke.adler=He.wrap&1),He.mode=A,He.last=0,He.havedict=0,He.dmax=32768,He.head=null,He.hold=0,He.bits=0,He.lencode=He.lendyn=new n.Buf32(pn),He.distcode=He.distdyn=new n.Buf32(Mt),He.sane=1,He.back=-1,x)}function ts(ke){var He;return!ke||!ke.state?X:(He=ke.state,He.wsize=0,He.whave=0,He.wnext=0,Bt(ke))}function de(ke,He){var ne,tt;return!ke||!ke.state||(tt=ke.state,He<0?(ne=0,He=-He):(ne=(He>>4)+1,He<48&&(He&=15)),He&&(He<8||He>15))?X:(tt.window!==null&&tt.wbits!==He&&(tt.window=null),tt.wrap=ne,tt.wbits=He,ts(ke))}function Te(ke,He){var ne,tt;return ke?(tt=new qs,ke.state=tt,tt.window=null,ne=de(ke,He),ne!==x&&(ke.state=null),ne):X}function Me(ke){return Te(ke,Fe)}var Xe=!0,mt,ft;function wt(ke){if(Xe){var He;for(mt=new n.Buf32(512),ft=new n.Buf32(32),He=0;He<144;)ke.lens[He++]=8;for(;He<256;)ke.lens[He++]=9;for(;He<280;)ke.lens[He++]=7;for(;He<288;)ke.lens[He++]=8;for(d(m,ke.lens,0,288,mt,0,ke.work,{bits:9}),He=0;He<32;)ke.lens[He++]=5;d(b,ke.lens,0,32,ft,0,ke.work,{bits:5}),Xe=!1}ke.lencode=mt,ke.lenbits=9,ke.distcode=ft,ke.distbits=5}function $t(ke,He,ne,tt){var xt,z=ke.state;return z.window===null&&(z.wsize=1<<z.wbits,z.wnext=0,z.whave=0,z.window=new n.Buf8(z.wsize)),tt>=z.wsize?(n.arraySet(z.window,He,ne-z.wsize,z.wsize,0),z.wnext=0,z.whave=z.wsize):(xt=z.wsize-z.wnext,xt>tt&&(xt=tt),n.arraySet(z.window,He,ne-tt,xt,z.wnext),tt-=xt,tt?(n.arraySet(z.window,He,ne-tt,tt,0),z.wnext=tt,z.whave=z.wsize):(z.wnext+=xt,z.wnext===z.wsize&&(z.wnext=0),z.whave<z.wsize&&(z.whave+=xt))),0}function oe(ke,He){var ne,tt,xt,z,We,qe,le,De,Ge,Ot,Ct,It,ni,Zs,bi=0,Oi,gs,qi,Gs,Mn,Sn,ji,os,Ts=new n.Buf8(4),_s,ss,sn=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!ke||!ke.state||!ke.output||!ke.input&&ke.avail_in!==0)return X;ne=ke.state,ne.mode===vt&&(ne.mode=Jt),We=ke.next_out,xt=ke.output,le=ke.avail_out,z=ke.next_in,tt=ke.input,qe=ke.avail_in,De=ne.hold,Ge=ne.bits,Ot=qe,Ct=le,os=x;e:for(;;)switch(ne.mode){case A:if(ne.wrap===0){ne.mode=Jt;break}for(;Ge<16;){if(qe===0)break e;qe--,De+=tt[z++]<<Ge,Ge+=8}if(ne.wrap&2&&De===35615){ne.check=0,Ts[0]=De&255,Ts[1]=De>>>8&255,ne.check=l(ne.check,Ts,2,0),De=0,Ge=0,ne.mode=me;break}if(ne.flags=0,ne.head&&(ne.head.done=!1),!(ne.wrap&1)||(((De&255)<<8)+(De>>8))%31){ke.msg="incorrect header check",ne.mode=mi;break}if((De&15)!==ee){ke.msg="unknown compression method",ne.mode=mi;break}if(De>>>=4,Ge-=4,ji=(De&15)+8,ne.wbits===0)ne.wbits=ji;else if(ji>ne.wbits){ke.msg="invalid window size",ne.mode=mi;break}ne.dmax=1<<ji,ke.adler=ne.check=1,ne.mode=De&512?kt:vt,De=0,Ge=0;break;case me:for(;Ge<16;){if(qe===0)break e;qe--,De+=tt[z++]<<Ge,Ge+=8}if(ne.flags=De,(ne.flags&255)!==ee){ke.msg="unknown compression method",ne.mode=mi;break}if(ne.flags&57344){ke.msg="unknown header flags set",ne.mode=mi;break}ne.head&&(ne.head.text=De>>8&1),ne.flags&512&&(Ts[0]=De&255,Ts[1]=De>>>8&255,ne.check=l(ne.check,Ts,2,0)),De=0,Ge=0,ne.mode=fe;case fe:for(;Ge<32;){if(qe===0)break e;qe--,De+=tt[z++]<<Ge,Ge+=8}ne.head&&(ne.head.time=De),ne.flags&512&&(Ts[0]=De&255,Ts[1]=De>>>8&255,Ts[2]=De>>>16&255,Ts[3]=De>>>24&255,ne.check=l(ne.check,Ts,4,0)),De=0,Ge=0,ne.mode=J;case J:for(;Ge<16;){if(qe===0)break e;qe--,De+=tt[z++]<<Ge,Ge+=8}ne.head&&(ne.head.xflags=De&255,ne.head.os=De>>8),ne.flags&512&&(Ts[0]=De&255,Ts[1]=De>>>8&255,ne.check=l(ne.check,Ts,2,0)),De=0,Ge=0,ne.mode=ye;case ye:if(ne.flags&1024){for(;Ge<16;){if(qe===0)break e;qe--,De+=tt[z++]<<Ge,Ge+=8}ne.length=De,ne.head&&(ne.head.extra_len=De),ne.flags&512&&(Ts[0]=De&255,Ts[1]=De>>>8&255,ne.check=l(ne.check,Ts,2,0)),De=0,Ge=0}else ne.head&&(ne.head.extra=null);ne.mode=Oe;case Oe:if(ne.flags&1024&&(It=ne.length,It>qe&&(It=qe),It&&(ne.head&&(ji=ne.head.extra_len-ne.length,ne.head.extra||(ne.head.extra=new Array(ne.head.extra_len)),n.arraySet(ne.head.extra,tt,z,It,ji)),ne.flags&512&&(ne.check=l(ne.check,tt,It,z)),qe-=It,z+=It,ne.length-=It),ne.length))break e;ne.length=0,ne.mode=ot;case ot:if(ne.flags&2048){if(qe===0)break e;It=0;do ji=tt[z+It++],ne.head&&ji&&ne.length<65536&&(ne.head.name+=String.fromCharCode(ji));while(ji&&It<qe);if(ne.flags&512&&(ne.check=l(ne.check,tt,It,z)),qe-=It,z+=It,ji)break e}else ne.head&&(ne.head.name=null);ne.length=0,ne.mode=Tt;case Tt:if(ne.flags&4096){if(qe===0)break e;It=0;do ji=tt[z+It++],ne.head&&ji&&ne.length<65536&&(ne.head.comment+=String.fromCharCode(ji));while(ji&&It<qe);if(ne.flags&512&&(ne.check=l(ne.check,tt,It,z)),qe-=It,z+=It,ji)break e}else ne.head&&(ne.head.comment=null);ne.mode=dt;case dt:if(ne.flags&512){for(;Ge<16;){if(qe===0)break e;qe--,De+=tt[z++]<<Ge,Ge+=8}if(De!==(ne.check&65535)){ke.msg="header crc mismatch",ne.mode=mi;break}De=0,Ge=0}ne.head&&(ne.head.hcrc=ne.flags>>9&1,ne.head.done=!0),ke.adler=ne.check=0,ne.mode=vt;break;case kt:for(;Ge<32;){if(qe===0)break e;qe--,De+=tt[z++]<<Ge,Ge+=8}ke.adler=ne.check=Pi(De),De=0,Ge=0,ne.mode=$e;case $e:if(ne.havedict===0)return ke.next_out=We,ke.avail_out=le,ke.next_in=z,ke.avail_in=qe,ne.hold=De,ne.bits=Ge,F;ke.adler=ne.check=1,ne.mode=vt;case vt:if(He===C||He===P)break e;case Jt:if(ne.last){De>>>=Ge&7,Ge-=Ge&7,ne.mode=es;break}for(;Ge<3;){if(qe===0)break e;qe--,De+=tt[z++]<<Ge,Ge+=8}switch(ne.last=De&1,De>>>=1,Ge-=1,De&3){case 0:ne.mode=di;break;case 1:if(wt(ne),ne.mode=wi,He===P){De>>>=2,Ge-=2;break e}break;case 2:ne.mode=qt;break;case 3:ke.msg="invalid block type",ne.mode=mi}De>>>=2,Ge-=2;break;case di:for(De>>>=Ge&7,Ge-=Ge&7;Ge<32;){if(qe===0)break e;qe--,De+=tt[z++]<<Ge,Ge+=8}if((De&65535)!==(De>>>16^65535)){ke.msg="invalid stored block lengths",ne.mode=mi;break}if(ne.length=De&65535,De=0,Ge=0,ne.mode=Ut,He===P)break e;case Ut:ne.mode=ui;case ui:if(It=ne.length,It){if(It>qe&&(It=qe),It>le&&(It=le),It===0)break e;n.arraySet(xt,tt,z,It,We),qe-=It,z+=It,le-=It,We+=It,ne.length-=It;break}ne.mode=vt;break;case qt:for(;Ge<14;){if(qe===0)break e;qe--,De+=tt[z++]<<Ge,Ge+=8}if(ne.nlen=(De&31)+257,De>>>=5,Ge-=5,ne.ndist=(De&31)+1,De>>>=5,Ge-=5,ne.ncode=(De&15)+4,De>>>=4,Ge-=4,ne.nlen>286||ne.ndist>30){ke.msg="too many length or distance symbols",ne.mode=mi;break}ne.have=0,ne.mode=Ze;case Ze:for(;ne.have<ne.ncode;){for(;Ge<3;){if(qe===0)break e;qe--,De+=tt[z++]<<Ge,Ge+=8}ne.lens[sn[ne.have++]]=De&7,De>>>=3,Ge-=3}for(;ne.have<19;)ne.lens[sn[ne.have++]]=0;if(ne.lencode=ne.lendyn,ne.lenbits=7,_s={bits:ne.lenbits},os=d(f,ne.lens,0,19,ne.lencode,0,ne.work,_s),ne.lenbits=_s.bits,os){ke.msg="invalid code lengths set",ne.mode=mi;break}ne.have=0,ne.mode=ki;case ki:for(;ne.have<ne.nlen+ne.ndist;){for(;bi=ne.lencode[De&(1<<ne.lenbits)-1],Oi=bi>>>24,gs=bi>>>16&255,qi=bi&65535,!(Oi<=Ge);){if(qe===0)break e;qe--,De+=tt[z++]<<Ge,Ge+=8}if(qi<16)De>>>=Oi,Ge-=Oi,ne.lens[ne.have++]=qi;else{if(qi===16){for(ss=Oi+2;Ge<ss;){if(qe===0)break e;qe--,De+=tt[z++]<<Ge,Ge+=8}if(De>>>=Oi,Ge-=Oi,ne.have===0){ke.msg="invalid bit length repeat",ne.mode=mi;break}ji=ne.lens[ne.have-1],It=3+(De&3),De>>>=2,Ge-=2}else if(qi===17){for(ss=Oi+3;Ge<ss;){if(qe===0)break e;qe--,De+=tt[z++]<<Ge,Ge+=8}De>>>=Oi,Ge-=Oi,ji=0,It=3+(De&7),De>>>=3,Ge-=3}else{for(ss=Oi+7;Ge<ss;){if(qe===0)break e;qe--,De+=tt[z++]<<Ge,Ge+=8}De>>>=Oi,Ge-=Oi,ji=0,It=11+(De&127),De>>>=7,Ge-=7}if(ne.have+It>ne.nlen+ne.ndist){ke.msg="invalid bit length repeat",ne.mode=mi;break}for(;It--;)ne.lens[ne.have++]=ji}}if(ne.mode===mi)break;if(ne.lens[256]===0){ke.msg="invalid code -- missing end-of-block",ne.mode=mi;break}if(ne.lenbits=9,_s={bits:ne.lenbits},os=d(m,ne.lens,0,ne.nlen,ne.lencode,0,ne.work,_s),ne.lenbits=_s.bits,os){ke.msg="invalid literal/lengths set",ne.mode=mi;break}if(ne.distbits=6,ne.distcode=ne.distdyn,_s={bits:ne.distbits},os=d(b,ne.lens,ne.nlen,ne.ndist,ne.distcode,0,ne.work,_s),ne.distbits=_s.bits,os){ke.msg="invalid distances set",ne.mode=mi;break}if(ne.mode=wi,He===P)break e;case wi:ne.mode=jt;case jt:if(qe>=6&&le>=258){ke.next_out=We,ke.avail_out=le,ke.next_in=z,ke.avail_in=qe,ne.hold=De,ne.bits=Ge,c(ke,Ct),We=ke.next_out,xt=ke.output,le=ke.avail_out,z=ke.next_in,tt=ke.input,qe=ke.avail_in,De=ne.hold,Ge=ne.bits,ne.mode===vt&&(ne.back=-1);break}for(ne.back=0;bi=ne.lencode[De&(1<<ne.lenbits)-1],Oi=bi>>>24,gs=bi>>>16&255,qi=bi&65535,!(Oi<=Ge);){if(qe===0)break e;qe--,De+=tt[z++]<<Ge,Ge+=8}if(gs&&(gs&240)===0){for(Gs=Oi,Mn=gs,Sn=qi;bi=ne.lencode[Sn+((De&(1<<Gs+Mn)-1)>>Gs)],Oi=bi>>>24,gs=bi>>>16&255,qi=bi&65535,!(Gs+Oi<=Ge);){if(qe===0)break e;qe--,De+=tt[z++]<<Ge,Ge+=8}De>>>=Gs,Ge-=Gs,ne.back+=Gs}if(De>>>=Oi,Ge-=Oi,ne.back+=Oi,ne.length=qi,gs===0){ne.mode=Gt;break}if(gs&32){ne.back=-1,ne.mode=vt;break}if(gs&64){ke.msg="invalid literal/length code",ne.mode=mi;break}ne.extra=gs&15,ne.mode=Yt;case Yt:if(ne.extra){for(ss=ne.extra;Ge<ss;){if(qe===0)break e;qe--,De+=tt[z++]<<Ge,Ge+=8}ne.length+=De&(1<<ne.extra)-1,De>>>=ne.extra,Ge-=ne.extra,ne.back+=ne.extra}ne.was=ne.length,ne.mode=Ei;case Ei:for(;bi=ne.distcode[De&(1<<ne.distbits)-1],Oi=bi>>>24,gs=bi>>>16&255,qi=bi&65535,!(Oi<=Ge);){if(qe===0)break e;qe--,De+=tt[z++]<<Ge,Ge+=8}if((gs&240)===0){for(Gs=Oi,Mn=gs,Sn=qi;bi=ne.distcode[Sn+((De&(1<<Gs+Mn)-1)>>Gs)],Oi=bi>>>24,gs=bi>>>16&255,qi=bi&65535,!(Gs+Oi<=Ge);){if(qe===0)break e;qe--,De+=tt[z++]<<Ge,Ge+=8}De>>>=Gs,Ge-=Gs,ne.back+=Gs}if(De>>>=Oi,Ge-=Oi,ne.back+=Oi,gs&64){ke.msg="invalid distance code",ne.mode=mi;break}ne.offset=qi,ne.extra=gs&15,ne.mode=ii;case ii:if(ne.extra){for(ss=ne.extra;Ge<ss;){if(qe===0)break e;qe--,De+=tt[z++]<<Ge,Ge+=8}ne.offset+=De&(1<<ne.extra)-1,De>>>=ne.extra,Ge-=ne.extra,ne.back+=ne.extra}if(ne.offset>ne.dmax){ke.msg="invalid distance too far back",ne.mode=mi;break}ne.mode=hi;case hi:if(le===0)break e;if(It=Ct-le,ne.offset>It){if(It=ne.offset-It,It>ne.whave&&ne.sane){ke.msg="invalid distance too far back",ne.mode=mi;break}It>ne.wnext?(It-=ne.wnext,ni=ne.wsize-It):ni=ne.wnext-It,It>ne.length&&(It=ne.length),Zs=ne.window}else Zs=xt,ni=We-ne.offset,It=ne.length;It>le&&(It=le),le-=It,ne.length-=It;do xt[We++]=Zs[ni++];while(--It);ne.length===0&&(ne.mode=jt);break;case Gt:if(le===0)break e;xt[We++]=ne.length,le--,ne.mode=jt;break;case es:if(ne.wrap){for(;Ge<32;){if(qe===0)break e;qe--,De|=tt[z++]<<Ge,Ge+=8}if(Ct-=le,ke.total_out+=Ct,ne.total+=Ct,Ct&&(ke.adler=ne.check=ne.flags?l(ne.check,xt,Ct,We-Ct):o(ne.check,xt,Ct,We-Ct)),Ct=le,(ne.flags?De:Pi(De))!==ne.check){ke.msg="incorrect data check",ne.mode=mi;break}De=0,Ge=0}ne.mode=js;case js:if(ne.wrap&&ne.flags){for(;Ge<32;){if(qe===0)break e;qe--,De+=tt[z++]<<Ge,Ge+=8}if(De!==(ne.total&4294967295)){ke.msg="incorrect length check",ne.mode=mi;break}De=0,Ge=0}ne.mode=ps;case ps:os=L;break e;case mi:os=re;break e;case $i:return K;case ws:default:return X}return ke.next_out=We,ke.avail_out=le,ke.next_in=z,ke.avail_in=qe,ne.hold=De,ne.bits=Ge,(ne.wsize||Ct!==ke.avail_out&&ne.mode<mi&&(ne.mode<es||He!==T))&&$t(ke,ke.output,ke.next_out,Ct-ke.avail_out),Ot-=ke.avail_in,Ct-=ke.avail_out,ke.total_in+=Ot,ke.total_out+=Ct,ne.total+=Ct,ne.wrap&&Ct&&(ke.adler=ne.check=ne.flags?l(ne.check,xt,Ct,ke.next_out-Ct):o(ne.check,xt,Ct,ke.next_out-Ct)),ke.data_type=ne.bits+(ne.last?64:0)+(ne.mode===vt?128:0)+(ne.mode===wi||ne.mode===Ut?256:0),(Ot===0&&Ct===0||He===T)&&os===x&&(os=te),os}function et(ke){if(!ke||!ke.state)return X;var He=ke.state;return He.window&&(He.window=null),ke.state=null,x}function ht(ke,He){var ne;return!ke||!ke.state||(ne=ke.state,(ne.wrap&2)===0)?X:(ne.head=He,He.done=!1,x)}function pt(ke,He){var ne=He.length,tt,xt,z;return!ke||!ke.state||(tt=ke.state,tt.wrap!==0&&tt.mode!==$e)?X:tt.mode===$e&&(xt=1,xt=o(xt,He,ne,0),xt!==tt.check)?re:(z=$t(ke,He,ne,ne),z?(tt.mode=$i,K):(tt.havedict=1,x))}i.inflateReset=ts,i.inflateReset2=de,i.inflateResetKeep=Bt,i.inflateInit=Me,i.inflateInit2=Te,i.inflate=oe,i.inflateEnd=et,i.inflateGetHeader=ht,i.inflateSetDictionary=pt,i.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(g,t,i){var n=g("../utils/common"),o=15,l=852,c=592,d=0,f=1,m=2,b=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],T=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],C=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],P=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(L,F,X,re,K,te,ee,A){var me=A.bits,fe=0,J=0,ye=0,Oe=0,ot=0,Tt=0,dt=0,kt=0,$e=0,vt=0,Jt,di,Ut,ui,qt,Ze=null,ki=0,wi,jt=new n.Buf16(o+1),Yt=new n.Buf16(o+1),Ei=null,ii=0,hi,Gt,es;for(fe=0;fe<=o;fe++)jt[fe]=0;for(J=0;J<re;J++)jt[F[X+J]]++;for(ot=me,Oe=o;Oe>=1&&jt[Oe]===0;Oe--);if(ot>Oe&&(ot=Oe),Oe===0)return K[te++]=1<<24|64<<16|0,K[te++]=1<<24|64<<16|0,A.bits=1,0;for(ye=1;ye<Oe&&jt[ye]===0;ye++);for(ot<ye&&(ot=ye),kt=1,fe=1;fe<=o;fe++)if(kt<<=1,kt-=jt[fe],kt<0)return-1;if(kt>0&&(L===d||Oe!==1))return-1;for(Yt[1]=0,fe=1;fe<o;fe++)Yt[fe+1]=Yt[fe]+jt[fe];for(J=0;J<re;J++)F[X+J]!==0&&(ee[Yt[F[X+J]]++]=J);if(L===d?(Ze=Ei=ee,wi=19):L===f?(Ze=b,ki-=257,Ei=T,ii-=257,wi=256):(Ze=C,Ei=P,wi=-1),vt=0,J=0,fe=ye,qt=te,Tt=ot,dt=0,Ut=-1,$e=1<<ot,ui=$e-1,L===f&&$e>l||L===m&&$e>c)return 1;for(;;){hi=fe-dt,ee[J]<wi?(Gt=0,es=ee[J]):ee[J]>wi?(Gt=Ei[ii+ee[J]],es=Ze[ki+ee[J]]):(Gt=96,es=0),Jt=1<<fe-dt,di=1<<Tt,ye=di;do di-=Jt,K[qt+(vt>>dt)+di]=hi<<24|Gt<<16|es|0;while(di!==0);for(Jt=1<<fe-1;vt&Jt;)Jt>>=1;if(Jt!==0?(vt&=Jt-1,vt+=Jt):vt=0,J++,--jt[fe]===0){if(fe===Oe)break;fe=F[X+ee[J]]}if(fe>ot&&(vt&ui)!==Ut){for(dt===0&&(dt=ot),qt+=ye,Tt=fe-dt,kt=1<<Tt;Tt+dt<Oe&&(kt-=jt[Tt+dt],!(kt<=0));)Tt++,kt<<=1;if($e+=1<<Tt,L===f&&$e>l||L===m&&$e>c)return 1;Ut=vt&ui,K[Ut]=ot<<24|Tt<<16|qt-te|0}}return vt!==0&&(K[qt+vt]=fe-dt<<24|64<<16|0),A.bits=ot,0}},{"../utils/common":41}],51:[function(g,t,i){t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(g,t,i){var n=g("../utils/common"),o=4,l=0,c=1,d=2;function f(oe){for(var et=oe.length;--et>=0;)oe[et]=0}var m=0,b=1,T=2,C=3,P=258,x=29,L=256,F=L+1+x,X=30,re=19,K=2*F+1,te=15,ee=16,A=7,me=256,fe=16,J=17,ye=18,Oe=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],ot=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Tt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],dt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],kt=512,$e=new Array((F+2)*2);f($e);var vt=new Array(X*2);f(vt);var Jt=new Array(kt);f(Jt);var di=new Array(P-C+1);f(di);var Ut=new Array(x);f(Ut);var ui=new Array(X);f(ui);function qt(oe,et,ht,pt,ke){this.static_tree=oe,this.extra_bits=et,this.extra_base=ht,this.elems=pt,this.max_length=ke,this.has_stree=oe&&oe.length}var Ze,ki,wi;function jt(oe,et){this.dyn_tree=oe,this.max_code=0,this.stat_desc=et}function Yt(oe){return oe<256?Jt[oe]:Jt[256+(oe>>>7)]}function Ei(oe,et){oe.pending_buf[oe.pending++]=et&255,oe.pending_buf[oe.pending++]=et>>>8&255}function ii(oe,et,ht){oe.bi_valid>ee-ht?(oe.bi_buf|=et<<oe.bi_valid&65535,Ei(oe,oe.bi_buf),oe.bi_buf=et>>ee-oe.bi_valid,oe.bi_valid+=ht-ee):(oe.bi_buf|=et<<oe.bi_valid&65535,oe.bi_valid+=ht)}function hi(oe,et,ht){ii(oe,ht[et*2],ht[et*2+1])}function Gt(oe,et){var ht=0;do ht|=oe&1,oe>>>=1,ht<<=1;while(--et>0);return ht>>>1}function es(oe){oe.bi_valid===16?(Ei(oe,oe.bi_buf),oe.bi_buf=0,oe.bi_valid=0):oe.bi_valid>=8&&(oe.pending_buf[oe.pending++]=oe.bi_buf&255,oe.bi_buf>>=8,oe.bi_valid-=8)}function js(oe,et){var ht=et.dyn_tree,pt=et.max_code,ke=et.stat_desc.static_tree,He=et.stat_desc.has_stree,ne=et.stat_desc.extra_bits,tt=et.stat_desc.extra_base,xt=et.stat_desc.max_length,z,We,qe,le,De,Ge,Ot=0;for(le=0;le<=te;le++)oe.bl_count[le]=0;for(ht[oe.heap[oe.heap_max]*2+1]=0,z=oe.heap_max+1;z<K;z++)We=oe.heap[z],le=ht[ht[We*2+1]*2+1]+1,le>xt&&(le=xt,Ot++),ht[We*2+1]=le,!(We>pt)&&(oe.bl_count[le]++,De=0,We>=tt&&(De=ne[We-tt]),Ge=ht[We*2],oe.opt_len+=Ge*(le+De),He&&(oe.static_len+=Ge*(ke[We*2+1]+De)));if(Ot!==0){do{for(le=xt-1;oe.bl_count[le]===0;)le--;oe.bl_count[le]--,oe.bl_count[le+1]+=2,oe.bl_count[xt]--,Ot-=2}while(Ot>0);for(le=xt;le!==0;le--)for(We=oe.bl_count[le];We!==0;)qe=oe.heap[--z],!(qe>pt)&&(ht[qe*2+1]!==le&&(oe.opt_len+=(le-ht[qe*2+1])*ht[qe*2],ht[qe*2+1]=le),We--)}}function ps(oe,et,ht){var pt=new Array(te+1),ke=0,He,ne;for(He=1;He<=te;He++)pt[He]=ke=ke+ht[He-1]<<1;for(ne=0;ne<=et;ne++){var tt=oe[ne*2+1];tt!==0&&(oe[ne*2]=Gt(pt[tt]++,tt))}}function mi(){var oe,et,ht,pt,ke,He=new Array(te+1);for(ht=0,pt=0;pt<x-1;pt++)for(Ut[pt]=ht,oe=0;oe<1<<Oe[pt];oe++)di[ht++]=pt;for(di[ht-1]=pt,ke=0,pt=0;pt<16;pt++)for(ui[pt]=ke,oe=0;oe<1<<ot[pt];oe++)Jt[ke++]=pt;for(ke>>=7;pt<X;pt++)for(ui[pt]=ke<<7,oe=0;oe<1<<ot[pt]-7;oe++)Jt[256+ke++]=pt;for(et=0;et<=te;et++)He[et]=0;for(oe=0;oe<=143;)$e[oe*2+1]=8,oe++,He[8]++;for(;oe<=255;)$e[oe*2+1]=9,oe++,He[9]++;for(;oe<=279;)$e[oe*2+1]=7,oe++,He[7]++;for(;oe<=287;)$e[oe*2+1]=8,oe++,He[8]++;for(ps($e,F+1,He),oe=0;oe<X;oe++)vt[oe*2+1]=5,vt[oe*2]=Gt(oe,5);Ze=new qt($e,Oe,L+1,F,te),ki=new qt(vt,ot,0,X,te),wi=new qt(new Array(0),Tt,0,re,A)}function $i(oe){var et;for(et=0;et<F;et++)oe.dyn_ltree[et*2]=0;for(et=0;et<X;et++)oe.dyn_dtree[et*2]=0;for(et=0;et<re;et++)oe.bl_tree[et*2]=0;oe.dyn_ltree[me*2]=1,oe.opt_len=oe.static_len=0,oe.last_lit=oe.matches=0}function ws(oe){oe.bi_valid>8?Ei(oe,oe.bi_buf):oe.bi_valid>0&&(oe.pending_buf[oe.pending++]=oe.bi_buf),oe.bi_buf=0,oe.bi_valid=0}function pn(oe,et,ht,pt){ws(oe),Ei(oe,ht),Ei(oe,~ht),n.arraySet(oe.pending_buf,oe.window,et,ht,oe.pending),oe.pending+=ht}function Mt(oe,et,ht,pt){var ke=et*2,He=ht*2;return oe[ke]<oe[He]||oe[ke]===oe[He]&&pt[et]<=pt[ht]}function Mi(oe,et,ht){for(var pt=oe.heap[ht],ke=ht<<1;ke<=oe.heap_len&&(ke<oe.heap_len&&Mt(et,oe.heap[ke+1],oe.heap[ke],oe.depth)&&ke++,!Mt(et,pt,oe.heap[ke],oe.depth));)oe.heap[ht]=oe.heap[ke],ht=ke,ke<<=1;oe.heap[ht]=pt}function Fe(oe,et,ht){var pt,ke,He=0,ne,tt;if(oe.last_lit!==0)do pt=oe.pending_buf[oe.d_buf+He*2]<<8|oe.pending_buf[oe.d_buf+He*2+1],ke=oe.pending_buf[oe.l_buf+He],He++,pt===0?hi(oe,ke,et):(ne=di[ke],hi(oe,ne+L+1,et),tt=Oe[ne],tt!==0&&(ke-=Ut[ne],ii(oe,ke,tt)),pt--,ne=Yt(pt),hi(oe,ne,ht),tt=ot[ne],tt!==0&&(pt-=ui[ne],ii(oe,pt,tt)));while(He<oe.last_lit);hi(oe,me,et)}function Pi(oe,et){var ht=et.dyn_tree,pt=et.stat_desc.static_tree,ke=et.stat_desc.has_stree,He=et.stat_desc.elems,ne,tt,xt=-1,z;for(oe.heap_len=0,oe.heap_max=K,ne=0;ne<He;ne++)ht[ne*2]!==0?(oe.heap[++oe.heap_len]=xt=ne,oe.depth[ne]=0):ht[ne*2+1]=0;for(;oe.heap_len<2;)z=oe.heap[++oe.heap_len]=xt<2?++xt:0,ht[z*2]=1,oe.depth[z]=0,oe.opt_len--,ke&&(oe.static_len-=pt[z*2+1]);for(et.max_code=xt,ne=oe.heap_len>>1;ne>=1;ne--)Mi(oe,ht,ne);z=He;do ne=oe.heap[1],oe.heap[1]=oe.heap[oe.heap_len--],Mi(oe,ht,1),tt=oe.heap[1],oe.heap[--oe.heap_max]=ne,oe.heap[--oe.heap_max]=tt,ht[z*2]=ht[ne*2]+ht[tt*2],oe.depth[z]=(oe.depth[ne]>=oe.depth[tt]?oe.depth[ne]:oe.depth[tt])+1,ht[ne*2+1]=ht[tt*2+1]=z,oe.heap[1]=z++,Mi(oe,ht,1);while(oe.heap_len>=2);oe.heap[--oe.heap_max]=oe.heap[1],js(oe,et),ps(ht,xt,oe.bl_count)}function qs(oe,et,ht){var pt,ke=-1,He,ne=et[0*2+1],tt=0,xt=7,z=4;for(ne===0&&(xt=138,z=3),et[(ht+1)*2+1]=65535,pt=0;pt<=ht;pt++)He=ne,ne=et[(pt+1)*2+1],!(++tt<xt&&He===ne)&&(tt<z?oe.bl_tree[He*2]+=tt:He!==0?(He!==ke&&oe.bl_tree[He*2]++,oe.bl_tree[fe*2]++):tt<=10?oe.bl_tree[J*2]++:oe.bl_tree[ye*2]++,tt=0,ke=He,ne===0?(xt=138,z=3):He===ne?(xt=6,z=3):(xt=7,z=4))}function Bt(oe,et,ht){var pt,ke=-1,He,ne=et[0*2+1],tt=0,xt=7,z=4;for(ne===0&&(xt=138,z=3),pt=0;pt<=ht;pt++)if(He=ne,ne=et[(pt+1)*2+1],!(++tt<xt&&He===ne)){if(tt<z)do hi(oe,He,oe.bl_tree);while(--tt!==0);else He!==0?(He!==ke&&(hi(oe,He,oe.bl_tree),tt--),hi(oe,fe,oe.bl_tree),ii(oe,tt-3,2)):tt<=10?(hi(oe,J,oe.bl_tree),ii(oe,tt-3,3)):(hi(oe,ye,oe.bl_tree),ii(oe,tt-11,7));tt=0,ke=He,ne===0?(xt=138,z=3):He===ne?(xt=6,z=3):(xt=7,z=4)}}function ts(oe){var et;for(qs(oe,oe.dyn_ltree,oe.l_desc.max_code),qs(oe,oe.dyn_dtree,oe.d_desc.max_code),Pi(oe,oe.bl_desc),et=re-1;et>=3&&oe.bl_tree[dt[et]*2+1]===0;et--);return oe.opt_len+=3*(et+1)+5+5+4,et}function de(oe,et,ht,pt){var ke;for(ii(oe,et-257,5),ii(oe,ht-1,5),ii(oe,pt-4,4),ke=0;ke<pt;ke++)ii(oe,oe.bl_tree[dt[ke]*2+1],3);Bt(oe,oe.dyn_ltree,et-1),Bt(oe,oe.dyn_dtree,ht-1)}function Te(oe){var et=4093624447,ht;for(ht=0;ht<=31;ht++,et>>>=1)if(et&1&&oe.dyn_ltree[ht*2]!==0)return l;if(oe.dyn_ltree[9*2]!==0||oe.dyn_ltree[10*2]!==0||oe.dyn_ltree[13*2]!==0)return c;for(ht=32;ht<L;ht++)if(oe.dyn_ltree[ht*2]!==0)return c;return l}var Me=!1;function Xe(oe){Me||(mi(),Me=!0),oe.l_desc=new jt(oe.dyn_ltree,Ze),oe.d_desc=new jt(oe.dyn_dtree,ki),oe.bl_desc=new jt(oe.bl_tree,wi),oe.bi_buf=0,oe.bi_valid=0,$i(oe)}function mt(oe,et,ht,pt){ii(oe,(m<<1)+(pt?1:0),3),pn(oe,et,ht)}function ft(oe){ii(oe,b<<1,3),hi(oe,me,$e),es(oe)}function wt(oe,et,ht,pt){var ke,He,ne=0;oe.level>0?(oe.strm.data_type===d&&(oe.strm.data_type=Te(oe)),Pi(oe,oe.l_desc),Pi(oe,oe.d_desc),ne=ts(oe),ke=oe.opt_len+3+7>>>3,He=oe.static_len+3+7>>>3,He<=ke&&(ke=He)):ke=He=ht+5,ht+4<=ke&&et!==-1?mt(oe,et,ht,pt):oe.strategy===o||He===ke?(ii(oe,(b<<1)+(pt?1:0),3),Fe(oe,$e,vt)):(ii(oe,(T<<1)+(pt?1:0),3),de(oe,oe.l_desc.max_code+1,oe.d_desc.max_code+1,ne+1),Fe(oe,oe.dyn_ltree,oe.dyn_dtree)),$i(oe),pt&&ws(oe)}function $t(oe,et,ht){return oe.pending_buf[oe.d_buf+oe.last_lit*2]=et>>>8&255,oe.pending_buf[oe.d_buf+oe.last_lit*2+1]=et&255,oe.pending_buf[oe.l_buf+oe.last_lit]=ht&255,oe.last_lit++,et===0?oe.dyn_ltree[ht*2]++:(oe.matches++,et--,oe.dyn_ltree[(di[ht]+L+1)*2]++,oe.dyn_dtree[Yt(et)*2]++),oe.last_lit===oe.lit_bufsize-1}i._tr_init=Xe,i._tr_stored_block=mt,i._tr_flush_block=wt,i._tr_tally=$t,i._tr_align=ft},{"../utils/common":41}],53:[function(g,t,i){function n(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}t.exports=n},{}],54:[function(g,t,i){(function(n){(function(o,l){if(o.setImmediate)return;var c=1,d={},f=!1,m=o.document,b;function T(A){typeof A!="function"&&(A=new Function(""+A));for(var me=new Array(arguments.length-1),fe=0;fe<me.length;fe++)me[fe]=arguments[fe+1];var J={callback:A,args:me};return d[c]=J,b(c),c++}function C(A){delete d[A]}function P(A){var me=A.callback,fe=A.args;switch(fe.length){case 0:me();break;case 1:me(fe[0]);break;case 2:me(fe[0],fe[1]);break;case 3:me(fe[0],fe[1],fe[2]);break;default:me.apply(l,fe);break}}function x(A){if(f)setTimeout(x,0,A);else{var me=d[A];if(me){f=!0;try{P(me)}finally{C(A),f=!1}}}}function L(){b=function(A){process.nextTick(function(){x(A)})}}function F(){if(o.postMessage&&!o.importScripts){var A=!0,me=o.onmessage;return o.onmessage=function(){A=!1},o.postMessage("","*"),o.onmessage=me,A}}function X(){var A="setImmediate$"+Math.random()+"$",me=function(fe){fe.source===o&&typeof fe.data=="string"&&fe.data.indexOf(A)===0&&x(+fe.data.slice(A.length))};o.addEventListener?o.addEventListener("message",me,!1):o.attachEvent("onmessage",me),b=function(fe){o.postMessage(A+fe,"*")}}function re(){var A=new MessageChannel;A.port1.onmessage=function(me){var fe=me.data;x(fe)},b=function(me){A.port2.postMessage(me)}}function K(){var A=m.documentElement;b=function(me){var fe=m.createElement("script");fe.onreadystatechange=function(){x(me),fe.onreadystatechange=null,A.removeChild(fe),fe=null},A.appendChild(fe)}}function te(){b=function(A){setTimeout(x,0,A)}}var ee=Object.getPrototypeOf&&Object.getPrototypeOf(o);ee=ee&&ee.setTimeout?ee:o,{}.toString.call(o.process)==="[object process]"?L():F()?X():o.MessageChannel?re():m&&"onreadystatechange"in m.createElement("script")?K():te(),ee.setImmediate=T,ee.clearImmediate=C})(typeof self>"u"?typeof n>"u"?this:n:self)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)});$(function(){$(".chzn-select").chosen()});const na=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),KA=[.001,0,0,.001,0,0],SA=1.35,so={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},kh={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},WV="pdfjs_internal_editor_",Li={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,SIGNATURE:101},as={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35,DRAW_STEP:41},lM={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},Mr={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},Jb={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Pn={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},Wg={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},nT={ERRORS:0,WARNINGS:1,INFOS:5},ry={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},PE={moveTo:0,lineTo:1,curveTo:2,closePath:3},uM={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let Sx=nT.WARNINGS;function qV(g){Number.isInteger(g)&&(Sx=g)}function GV(){return Sx}function xx(g){Sx>=nT.INFOS&&console.log(`Info: ${g}`)}function Ri(g){Sx>=nT.WARNINGS&&console.log(`Warning: ${g}`)}function Bs(g){throw new Error(g)}function Vn(g,t){g||Bs(t)}function XV(g){switch(g==null?void 0:g.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function $k(g,t=null,i=null){if(!g)return null;if(i&&typeof g=="string"){if(i.addDefaultProtocol&&g.startsWith("www.")){const o=g.match(/\./g);(o==null?void 0:o.length)>=2&&(g=`http://${g}`)}if(i.tryConvertEncoding)try{g=JV(g)}catch{}}const n=t?URL.parse(g,t):URL.parse(g);return XV(n)?n:null}function zk(g,t,i=!1){const n=URL.parse(g);return n?(n.hash=t,n.href):i&&$k(g,"http://example.com")?g.split("#",1)[0]+`${t?`#${t}`:""}`:""}function is(g,t,i,n=!1){return Object.defineProperty(g,t,{value:i,enumerable:!n,configurable:!0,writable:!1}),i}const ag=function(){function t(i,n){this.message=i,this.name=n}return t.prototype=new Error,t.constructor=t,t}();class zN extends ag{constructor(t,i){super(t,"PasswordException"),this.code=i}}class xA extends ag{constructor(t,i){super(t,"UnknownErrorException"),this.details=i}}let $S=class extends ag{constructor(t){super(t,"InvalidPDFException")}},ay=class extends ag{constructor(t,i,n){super(t,"ResponseException"),this.status=i,this.missing=n}};class KV extends ag{constructor(t){super(t,"FormatError")}}let Mh=class extends ag{constructor(t){super(t,"AbortException")}};function hM(g){(typeof g!="object"||(g==null?void 0:g.length)===void 0)&&Bs("Invalid argument for bytesToString");const t=g.length,i=8192;if(t<i)return String.fromCharCode.apply(null,g);const n=[];for(let o=0;o<t;o+=i){const l=Math.min(o+i,t),c=g.subarray(o,l);n.push(String.fromCharCode.apply(null,c))}return n.join("")}function rT(g){typeof g!="string"&&Bs("Invalid argument for stringToBytes");const t=g.length,i=new Uint8Array(t);for(let n=0;n<t;++n)i[n]=g.charCodeAt(n)&255;return i}function YV(g){return String.fromCharCode(g>>24&255,g>>16&255,g>>8&255,g&255)}function ZV(){const g=new Uint8Array(4);return g[0]=1,new Uint32Array(g.buffer,0,1)[0]===1}function QV(){try{return new Function(""),!0}catch{return!1}}class yr{static get isLittleEndian(){return is(this,"isLittleEndian",ZV())}static get isEvalSupported(){return is(this,"isEvalSupported",QV())}static get isOffscreenCanvasSupported(){return is(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return is(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){const{platform:t,userAgent:i}=navigator;return is(this,"platform",{isAndroid:i.includes("Android"),isLinux:t.includes("Linux"),isMac:t.includes("Mac"),isWindows:t.includes("Win"),isFirefox:i.includes("Firefox")})}static get isCSSRoundSupported(){var t,i;return is(this,"isCSSRoundSupported",(i=(t=globalThis.CSS)==null?void 0:t.supports)==null?void 0:i.call(t,"width: round(1.5px, 1px)"))}}const AA=Array.from(Array(256).keys(),g=>g.toString(16).padStart(2,"0"));var Nh,GA,qE,YA;let oi=(GA=class{static makeHexColor(t,i,n){return`#${AA[t]}${AA[i]}${AA[n]}`}static scaleMinMax(t,i){let n;t[0]?(t[0]<0&&(n=i[0],i[0]=i[2],i[2]=n),i[0]*=t[0],i[2]*=t[0],t[3]<0&&(n=i[1],i[1]=i[3],i[3]=n),i[1]*=t[3],i[3]*=t[3]):(n=i[0],i[0]=i[1],i[1]=n,n=i[2],i[2]=i[3],i[3]=n,t[1]<0&&(n=i[1],i[1]=i[3],i[3]=n),i[1]*=t[1],i[3]*=t[1],t[2]<0&&(n=i[0],i[0]=i[2],i[2]=n),i[0]*=t[2],i[2]*=t[2]),i[0]+=t[4],i[1]+=t[5],i[2]+=t[4],i[3]+=t[5]}static transform(t,i){return[t[0]*i[0]+t[2]*i[1],t[1]*i[0]+t[3]*i[1],t[0]*i[2]+t[2]*i[3],t[1]*i[2]+t[3]*i[3],t[0]*i[4]+t[2]*i[5]+t[4],t[1]*i[4]+t[3]*i[5]+t[5]]}static applyTransform(t,i,n=0){const o=t[n],l=t[n+1];t[n]=o*i[0]+l*i[2]+i[4],t[n+1]=o*i[1]+l*i[3]+i[5]}static applyTransformToBezier(t,i,n=0){const o=i[0],l=i[1],c=i[2],d=i[3],f=i[4],m=i[5];for(let b=0;b<6;b+=2){const T=t[n+b],C=t[n+b+1];t[n+b]=T*o+C*c+f,t[n+b+1]=T*l+C*d+m}}static applyInverseTransform(t,i){const n=t[0],o=t[1],l=i[0]*i[3]-i[1]*i[2];t[0]=(n*i[3]-o*i[2]+i[2]*i[5]-i[4]*i[3])/l,t[1]=(-n*i[1]+o*i[0]+i[4]*i[1]-i[5]*i[0])/l}static axialAlignedBoundingBox(t,i,n){const o=i[0],l=i[1],c=i[2],d=i[3],f=i[4],m=i[5],b=t[0],T=t[1],C=t[2],P=t[3];let x=o*b+f,L=x,F=o*C+f,X=F,re=d*T+m,K=re,te=d*P+m,ee=te;if(l!==0||c!==0){const A=l*b,me=l*C,fe=c*T,J=c*P;x+=fe,X+=fe,F+=J,L+=J,re+=A,ee+=A,te+=me,K+=me}n[0]=Math.min(n[0],x,F,L,X),n[1]=Math.min(n[1],re,te,K,ee),n[2]=Math.max(n[2],x,F,L,X),n[3]=Math.max(n[3],re,te,K,ee)}static inverseTransform(t){const i=t[0]*t[3]-t[1]*t[2];return[t[3]/i,-t[1]/i,-t[2]/i,t[0]/i,(t[2]*t[5]-t[4]*t[3])/i,(t[4]*t[1]-t[5]*t[0])/i]}static singularValueDecompose2dScale(t,i){const n=t[0],o=t[1],l=t[2],c=t[3],d=n**2+o**2,f=n*l+o*c,m=l**2+c**2,b=(d+m)/2,T=Math.sqrt(b**2-(d*m-f**2));i[0]=Math.sqrt(b+T||1),i[1]=Math.sqrt(b-T||1)}static normalizeRect(t){const i=t.slice(0);return t[0]>t[2]&&(i[0]=t[2],i[2]=t[0]),t[1]>t[3]&&(i[1]=t[3],i[3]=t[1]),i}static intersect(t,i){const n=Math.max(Math.min(t[0],t[2]),Math.min(i[0],i[2])),o=Math.min(Math.max(t[0],t[2]),Math.max(i[0],i[2]));if(n>o)return null;const l=Math.max(Math.min(t[1],t[3]),Math.min(i[1],i[3])),c=Math.min(Math.max(t[1],t[3]),Math.max(i[1],i[3]));return l>c?null:[n,l,o,c]}static pointBoundingBox(t,i,n){n[0]=Math.min(n[0],t),n[1]=Math.min(n[1],i),n[2]=Math.max(n[2],t),n[3]=Math.max(n[3],i)}static rectBoundingBox(t,i,n,o,l){l[0]=Math.min(l[0],t,n),l[1]=Math.min(l[1],i,o),l[2]=Math.max(l[2],t,n),l[3]=Math.max(l[3],i,o)}static bezierBoundingBox(t,i,n,o,l,c,d,f,m){m[0]=Math.min(m[0],t,d),m[1]=Math.min(m[1],i,f),m[2]=Math.max(m[2],t,d),m[3]=Math.max(m[3],i,f),R(this,Nh,YA).call(this,t,n,l,d,i,o,c,f,3*(-t+3*(n-l)+d),6*(t-2*n+l),3*(n-t),m),R(this,Nh,YA).call(this,t,n,l,d,i,o,c,f,3*(-i+3*(o-c)+f),6*(i-2*o+c),3*(o-i),m)}},Nh=new WeakSet,qE=function(t,i,n,o,l,c,d,f,m,b){if(m<=0||m>=1)return;const T=1-m,C=m*m,P=C*m,x=T*(T*(T*t+3*m*i)+3*C*n)+P*o,L=T*(T*(T*l+3*m*c)+3*C*d)+P*f;b[0]=Math.min(b[0],x),b[1]=Math.min(b[1],L),b[2]=Math.max(b[2],x),b[3]=Math.max(b[3],L)},YA=function(t,i,n,o,l,c,d,f,m,b,T,C){if(Math.abs(m)<1e-12){Math.abs(b)>=1e-12&&R(this,Nh,qE).call(this,t,i,n,o,l,c,d,f,-T/b,C);return}const P=b**2-4*T*m;if(P<0)return;const x=Math.sqrt(P),L=2*m;R(this,Nh,qE).call(this,t,i,n,o,l,c,d,f,(-b+x)/L,C),R(this,Nh,qE).call(this,t,i,n,o,l,c,d,f,(-b-x)/L,C)},j(GA,Nh),GA);function JV(g){return decodeURIComponent(escape(g))}let CA=null,WN=null;function cM(g){return CA||(CA=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,WN=new Map([["ï¬","Å¿t"]])),g.replaceAll(CA,(t,i,n)=>i?i.normalize("NFKC"):WN.get(n))}function Wk(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const g=new Uint8Array(32);return crypto.getRandomValues(g),hM(g)}const qk="pdfjs_internal_id_";function e$(g,t,i){if(!Array.isArray(i)||i.length<2)return!1;const[n,o,...l]=i;if(!g(n)&&!Number.isInteger(n)||!t(o))return!1;const c=l.length;let d=!0;switch(o.name){case"XYZ":if(c<2||c>3)return!1;break;case"Fit":case"FitB":return c===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(c>1)return!1;break;case"FitR":if(c!==4)return!1;d=!1;break;default:return!1}for(const f of l)if(!(typeof f=="number"||d&&f===null))return!1;return!0}function Vr(g,t,i){return Math.min(Math.max(g,t),i)}function dM(g){return Uint8Array.prototype.toBase64?g.toBase64():btoa(hM(g))}function t$(g){return Uint8Array.fromBase64?Uint8Array.fromBase64(g):rT(atob(g))}typeof Promise.try!="function"&&(Promise.try=function(g,...t){return new Promise(i=>{i(g(...t))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(g){return g.reduce((t,i)=>t+i,0)});const Au="http://www.w3.org/2000/svg";var hu;let ng=(hu=class{},St(hu,"CSS",96),St(hu,"PDF",72),St(hu,"PDF_TO_CSS_UNITS",hu.CSS/hu.PDF),hu);async function d_(g,t="text"){if(bb(g,document.baseURI)){const i=await fetch(g);if(!i.ok)throw new Error(i.statusText);switch(t){case"arraybuffer":return i.arrayBuffer();case"blob":return i.blob();case"json":return i.json()}return i.text()}return new Promise((i,n)=>{const o=new XMLHttpRequest;o.open("GET",g,!0),o.responseType=t,o.onreadystatechange=()=>{if(o.readyState===XMLHttpRequest.DONE){if(o.status===200||o.status===0){switch(t){case"arraybuffer":case"blob":case"json":i(o.response);return}i(o.responseText);return}n(new Error(o.statusText))}},o.send(null)})}class aT{constructor({viewBox:t,userUnit:i,scale:n,rotation:o,offsetX:l=0,offsetY:c=0,dontFlip:d=!1}){this.viewBox=t,this.userUnit=i,this.scale=n,this.rotation=o,this.offsetX=l,this.offsetY=c,n*=i;const f=(t[2]+t[0])/2,m=(t[3]+t[1])/2;let b,T,C,P;switch(o%=360,o<0&&(o+=360),o){case 180:b=-1,T=0,C=0,P=1;break;case 90:b=0,T=1,C=1,P=0;break;case 270:b=0,T=-1,C=-1,P=0;break;case 0:b=1,T=0,C=0,P=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}d&&(C=-C,P=-P);let x,L,F,X;b===0?(x=Math.abs(m-t[1])*n+l,L=Math.abs(f-t[0])*n+c,F=(t[3]-t[1])*n,X=(t[2]-t[0])*n):(x=Math.abs(f-t[0])*n+l,L=Math.abs(m-t[1])*n+c,F=(t[2]-t[0])*n,X=(t[3]-t[1])*n),this.transform=[b*n,T*n,C*n,P*n,x-b*n*f-C*n*m,L-T*n*f-P*n*m],this.width=F,this.height=X}get rawDims(){const t=this.viewBox;return is(this,"rawDims",{pageWidth:t[2]-t[0],pageHeight:t[3]-t[1],pageX:t[0],pageY:t[1]})}clone({scale:t=this.scale,rotation:i=this.rotation,offsetX:n=this.offsetX,offsetY:o=this.offsetY,dontFlip:l=!1}={}){return new aT({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:t,rotation:i,offsetX:n,offsetY:o,dontFlip:l})}convertToViewportPoint(t,i){const n=[t,i];return oi.applyTransform(n,this.transform),n}convertToViewportRectangle(t){const i=[t[0],t[1]];oi.applyTransform(i,this.transform);const n=[t[2],t[3]];return oi.applyTransform(n,this.transform),[i[0],i[1],n[0],n[1]]}convertToPdfPoint(t,i){const n=[t,i];return oi.applyInverseTransform(n,this.transform),n}}let Ax=class extends ag{constructor(t,i=0){super(t,"RenderingCancelledException"),this.extraDelay=i}};function oT(g){const t=g.length;let i=0;for(;i<t&&g[i].trim()==="";)i++;return g.substring(i,i+5).toLowerCase()==="data:"}function Cx(g){return typeof g=="string"&&/\.pdf$/i.test(g)}function fM(g){return[g]=g.split(/[#?]/,1),g.substring(g.lastIndexOf("/")+1)}function pM(g,t="document.pdf"){if(typeof g!="string")return t;if(oT(g))return Ri('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const i=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,n=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,o=i.exec(g);let l=n.exec(o[1])||n.exec(o[2])||n.exec(o[3]);if(l&&(l=l[0],l.includes("%")))try{l=n.exec(decodeURIComponent(l))[0]}catch{}return l||t}class qN{constructor(){St(this,"started",Object.create(null));St(this,"times",[])}time(t){t in this.started&&Ri(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||Ri(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let i=0;for(const{name:n}of this.times)i=Math.max(n.length,i);for(const{name:n,start:o,end:l}of this.times)t.push(`${n.padEnd(i)} ${l-o}ms
`);return t.join("")}}function bb(g,t){const i=t?URL.parse(g,t):URL.parse(g);return(i==null?void 0:i.protocol)==="http:"||(i==null?void 0:i.protocol)==="https:"}function Mo(g){g.preventDefault()}function Nn(g){g.preventDefault(),g.stopPropagation()}function i$(g){console.log("Deprecated API usage: "+g)}var XA,fy;let Gk=(XA=class{static toDateObject(t){if(!t||typeof t!="string")return null;u(this,fy)||D(this,fy,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const i=u(this,fy).exec(t);if(!i)return null;const n=parseInt(i[1],10);let o=parseInt(i[2],10);o=o>=1&&o<=12?o-1:0;let l=parseInt(i[3],10);l=l>=1&&l<=31?l:1;let c=parseInt(i[4],10);c=c>=0&&c<=23?c:0;let d=parseInt(i[5],10);d=d>=0&&d<=59?d:0;let f=parseInt(i[6],10);f=f>=0&&f<=59?f:0;const m=i[7]||"Z";let b=parseInt(i[8],10);b=b>=0&&b<=23?b:0;let T=parseInt(i[9],10)||0;return T=T>=0&&T<=59?T:0,m==="-"?(c+=b,d+=T):m==="+"&&(c-=b,d-=T),new Date(Date.UTC(n,o,l,c,d,f))}},fy=new WeakMap,j(XA,fy),XA);function gM(g,{scale:t=1,rotation:i=0}){const{width:n,height:o}=g.attributes.style,l=[0,0,parseInt(n),parseInt(o)];return new aT({viewBox:l,userUnit:1,scale:t,rotation:i})}function Xk(g){if(g.startsWith("#")){const t=parseInt(g.slice(1),16);return[(t&16711680)>>16,(t&65280)>>8,t&255]}return g.startsWith("rgb(")?g.slice(4,-1).split(",").map(t=>parseInt(t)):g.startsWith("rgba(")?g.slice(5,-1).split(",").map(t=>parseInt(t)).slice(0,3):(Ri(`Not a valid color format: "${g}"`),[0,0,0])}function s$(g){const t=document.createElement("span");t.style.visibility="hidden",t.style.colorScheme="only light",document.body.append(t);for(const i of g.keys()){t.style.color=i;const n=window.getComputedStyle(t).color;g.set(i,Xk(n))}t.remove()}function _n(g){const{a:t,b:i,c:n,d:o,e:l,f:c}=g.getTransform();return[t,i,n,o,l,c]}function Nl(g){const{a:t,b:i,c:n,d:o,e:l,f:c}=g.getTransform().invertSelf();return[t,i,n,o,l,c]}function kd(g,t,i=!1,n=!0){if(t instanceof aT){const{pageWidth:o,pageHeight:l}=t.rawDims,{style:c}=g,d=yr.isCSSRoundSupported,f=`var(--total-scale-factor) * ${o}px`,m=`var(--total-scale-factor) * ${l}px`,b=d?`round(down, ${f}, var(--scale-round-x))`:`calc(${f})`,T=d?`round(down, ${m}, var(--scale-round-y))`:`calc(${m})`;!i||t.rotation%180===0?(c.width=b,c.height=T):(c.width=T,c.height=b)}n&&g.setAttribute("data-main-rotation",t.rotation)}let Pd=class ZA{constructor(){const{pixelRatio:t}=ZA;this.sx=t,this.sy=t}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(t,i,n,o,l=-1){let c=1/0,d=1/0,f=1/0;n=ZA.capPixels(n,l),n>0&&(c=Math.sqrt(n/(t*i))),o!==-1&&(d=o/t,f=o/i);const m=Math.min(c,d,f);return this.sx>m||this.sy>m?(this.sx=m,this.sy=m,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(t,i){if(i>=0){const n=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+i/100));return t>0?Math.min(t,n):n}return t}};const zS=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];var lc,hf,bo,uc,py,um,gy,QS,mM,Ir,_M,bM,yb,yM,GE;const Du=class Du{constructor(t){j(this,Ir);j(this,lc,null);j(this,hf,null);j(this,bo);j(this,uc,null);j(this,py,null);j(this,um,null);D(this,bo,t),u(Du,gy)||D(Du,gy,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"}))}render(){const t=D(this,lc,document.createElement("div"));t.classList.add("editToolbar","hidden"),t.setAttribute("role","toolbar");const i=u(this,bo)._uiManager._signal;t.addEventListener("contextmenu",Mo,{signal:i}),t.addEventListener("pointerdown",R(Du,QS,mM),{signal:i});const n=D(this,uc,document.createElement("div"));n.className="buttons",t.append(n);const o=u(this,bo).toolbarPosition;if(o){const{style:l}=t,c=u(this,bo)._uiManager.direction==="ltr"?1-o[0]:o[0];l.insetInlineEnd=`${100*c}%`,l.top=`calc(${100*o[1]}% + var(--editor-toolbar-vert-offset))`}return R(this,Ir,yM).call(this),t}get div(){return u(this,lc)}hide(){var t;u(this,lc).classList.add("hidden"),(t=u(this,hf))==null||t.hideDropdown()}show(){var t;u(this,lc).classList.remove("hidden"),(t=u(this,py))==null||t.shown()}async addAltText(t){const i=await t.render();R(this,Ir,yb).call(this,i),u(this,uc).prepend(i,u(this,Ir,GE)),D(this,py,t)}addColorPicker(t){D(this,hf,t);const i=t.renderButton();R(this,Ir,yb).call(this,i),u(this,uc).prepend(i,u(this,Ir,GE))}async addEditSignatureButton(t){const i=D(this,um,await t.renderEditButton(u(this,bo)));R(this,Ir,yb).call(this,i),u(this,uc).prepend(i,u(this,Ir,GE))}updateEditSignatureButton(t){u(this,um)&&(u(this,um).title=t)}remove(){var t;u(this,lc).remove(),(t=u(this,hf))==null||t.destroy(),D(this,hf,null)}};lc=new WeakMap,hf=new WeakMap,bo=new WeakMap,uc=new WeakMap,py=new WeakMap,um=new WeakMap,gy=new WeakMap,QS=new WeakSet,mM=function(t){t.stopPropagation()},Ir=new WeakSet,_M=function(t){u(this,bo)._focusEventsAllowed=!1,Nn(t)},bM=function(t){u(this,bo)._focusEventsAllowed=!0,Nn(t)},yb=function(t){const i=u(this,bo)._uiManager._signal;t.addEventListener("focusin",R(this,Ir,_M).bind(this),{capture:!0,signal:i}),t.addEventListener("focusout",R(this,Ir,bM).bind(this),{capture:!0,signal:i}),t.addEventListener("contextmenu",Mo,{signal:i})},yM=function(){const{editorType:t,_uiManager:i}=u(this,bo),n=document.createElement("button");n.className="delete",n.tabIndex=0,n.setAttribute("data-l10n-id",u(Du,gy)[t]),R(this,Ir,yb).call(this,n),n.addEventListener("click",o=>{i.delete()},{signal:i._signal}),u(this,uc).append(n)},GE=function(){const t=document.createElement("div");return t.className="divider",t},j(Du,QS),j(Du,gy,null);let QA=Du;var my,cf,df,Id,vM,wM,TM;class n${constructor(t){j(this,Id);j(this,my,null);j(this,cf,null);j(this,df);D(this,df,t)}show(t,i,n){const[o,l]=R(this,Id,wM).call(this,i,n),{style:c}=u(this,cf)||D(this,cf,R(this,Id,vM).call(this));t.append(u(this,cf)),c.insetInlineEnd=`${100*o}%`,c.top=`calc(${100*l}% + var(--editor-toolbar-vert-offset))`}hide(){u(this,cf).remove()}}my=new WeakMap,cf=new WeakMap,df=new WeakMap,Id=new WeakSet,vM=function(){const t=D(this,cf,document.createElement("div"));t.className="editToolbar",t.setAttribute("role","toolbar"),t.addEventListener("contextmenu",Mo,{signal:u(this,df)._signal});const i=D(this,my,document.createElement("div"));return i.className="buttons",t.append(i),R(this,Id,TM).call(this),t},wM=function(t,i){let n=0,o=0;for(const l of t){const c=l.y+l.height;if(c<n)continue;const d=l.x+(i?l.width:0);if(c>n){o=d,n=c;continue}i?d>o&&(o=d):d<o&&(o=d)}return[i?1-o:o,n]},TM=function(){const t=document.createElement("button");t.className="highlightButton",t.tabIndex=0,t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const i=document.createElement("span");t.append(i),i.className="visuallyHidden",i.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const n=u(this,df)._signal;t.addEventListener("contextmenu",Mo,{signal:n}),t.addEventListener("click",()=>{u(this,df).highlightSelection("floating_button")},{signal:n}),u(this,my).append(t)};function EM(g,t,i){for(const n of i)t.addEventListener(n,g[n].bind(g))}var JS;class r${constructor(){j(this,JS,0)}get id(){return`${WV}${Yn(this,JS)._++}`}}JS=new WeakMap;var hm,_y,Fr,cm,XE;const cP=class cP{constructor(){j(this,cm);j(this,hm,Wk());j(this,_y,0);j(this,Fr,null)}static get _isSVGFittingCanvas(){const t='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',n=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),o=new Image;o.src=t;const l=o.decode().then(()=>(n.drawImage(o,0,0,1,1,0,0,1,3),new Uint32Array(n.getImageData(0,0,1,1).data.buffer)[0]===0));return is(this,"_isSVGFittingCanvas",l)}async getFromFile(t){const{lastModified:i,name:n,size:o,type:l}=t;return R(this,cm,XE).call(this,`${i}_${n}_${o}_${l}`,t)}async getFromUrl(t){return R(this,cm,XE).call(this,t,t)}async getFromBlob(t,i){const n=await i;return R(this,cm,XE).call(this,t,n)}async getFromId(t){u(this,Fr)||D(this,Fr,new Map);const i=u(this,Fr).get(t);if(!i)return null;if(i.bitmap)return i.refCounter+=1,i;if(i.file)return this.getFromFile(i.file);if(i.blobPromise){const{blobPromise:n}=i;return delete i.blobPromise,this.getFromBlob(i.id,n)}return this.getFromUrl(i.url)}getFromCanvas(t,i){u(this,Fr)||D(this,Fr,new Map);let n=u(this,Fr).get(t);if(n!=null&&n.bitmap)return n.refCounter+=1,n;const o=new OffscreenCanvas(i.width,i.height);return o.getContext("2d").drawImage(i,0,0),n={bitmap:o.transferToImageBitmap(),id:`image_${u(this,hm)}_${Yn(this,_y)._++}`,refCounter:1,isSvg:!1},u(this,Fr).set(t,n),u(this,Fr).set(n.id,n),n}getSvgUrl(t){const i=u(this,Fr).get(t);return i!=null&&i.isSvg?i.svgUrl:null}deleteId(t){var o;u(this,Fr)||D(this,Fr,new Map);const i=u(this,Fr).get(t);if(!i||(i.refCounter-=1,i.refCounter!==0))return;const{bitmap:n}=i;if(!i.url&&!i.file){const l=new OffscreenCanvas(n.width,n.height);l.getContext("bitmaprenderer").transferFromImageBitmap(n),i.blobPromise=l.convertToBlob()}(o=n.close)==null||o.call(n),i.bitmap=null}isValidId(t){return t.startsWith(`image_${u(this,hm)}_`)}};hm=new WeakMap,_y=new WeakMap,Fr=new WeakMap,cm=new WeakSet,XE=async function(t,i){u(this,Fr)||D(this,Fr,new Map);let n=u(this,Fr).get(t);if(n===null)return null;if(n!=null&&n.bitmap)return n.refCounter+=1,n;try{n||(n={bitmap:null,id:`image_${u(this,hm)}_${Yn(this,_y)._++}`,refCounter:0,isSvg:!1});let o;if(typeof i=="string"?(n.url=i,o=await d_(i,"blob")):i instanceof File?o=n.file=i:i instanceof Blob&&(o=i),o.type==="image/svg+xml"){const l=cP._isSVGFittingCanvas,c=new FileReader,d=new Image,f=new Promise((m,b)=>{d.onload=()=>{n.bitmap=d,n.isSvg=!0,m()},c.onload=async()=>{const T=n.svgUrl=c.result;d.src=await l?`${T}#svgView(preserveAspectRatio(none))`:T},d.onerror=c.onerror=b});c.readAsDataURL(o),await f}else n.bitmap=await createImageBitmap(o);n.refCounter=1}catch(o){Ri(o),n=null}return u(this,Fr).set(t,n),n&&u(this,Fr).set(n.id,n),n};let JA=cP;var Dn,hc,by,mn;class a${constructor(t=128){j(this,Dn,[]);j(this,hc,!1);j(this,by);j(this,mn,-1);D(this,by,t)}add({cmd:t,undo:i,post:n,mustExec:o,type:l=NaN,overwriteIfSameType:c=!1,keepUndo:d=!1}){if(o&&t(),u(this,hc))return;const f={cmd:t,undo:i,post:n,type:l};if(u(this,mn)===-1){u(this,Dn).length>0&&(u(this,Dn).length=0),D(this,mn,0),u(this,Dn).push(f);return}if(c&&u(this,Dn)[u(this,mn)].type===l){d&&(f.undo=u(this,Dn)[u(this,mn)].undo),u(this,Dn)[u(this,mn)]=f;return}const m=u(this,mn)+1;m===u(this,by)?u(this,Dn).splice(0,1):(D(this,mn,m),m<u(this,Dn).length&&u(this,Dn).splice(m)),u(this,Dn).push(f)}undo(){if(u(this,mn)===-1)return;D(this,hc,!0);const{undo:t,post:i}=u(this,Dn)[u(this,mn)];t(),i==null||i(),D(this,hc,!1),D(this,mn,u(this,mn)-1)}redo(){if(u(this,mn)<u(this,Dn).length-1){D(this,mn,u(this,mn)+1),D(this,hc,!0);const{cmd:t,post:i}=u(this,Dn)[u(this,mn)];t(),i==null||i(),D(this,hc,!1)}}hasSomethingToUndo(){return u(this,mn)!==-1}hasSomethingToRedo(){return u(this,mn)<u(this,Dn).length-1}cleanType(t){if(u(this,mn)!==-1){for(let i=u(this,mn);i>=0;i--)if(u(this,Dn)[i].type!==t){u(this,Dn).splice(i+1,u(this,mn)-i),D(this,mn,i);return}u(this,Dn).length=0,D(this,mn,-1)}}destroy(){D(this,Dn,null)}}Dn=new WeakMap,hc=new WeakMap,by=new WeakMap,mn=new WeakMap;var ex,SM;class lT{constructor(t){j(this,ex);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:i}=yr.platform;for(const[n,o,l={}]of t)for(const c of n){const d=c.startsWith("mac+");i&&d?(this.callbacks.set(c.slice(4),{callback:o,options:l}),this.allKeys.add(c.split("+").at(-1))):!i&&!d&&(this.callbacks.set(c,{callback:o,options:l}),this.allKeys.add(c.split("+").at(-1)))}}exec(t,i){if(!this.allKeys.has(i.key))return;const n=this.callbacks.get(R(this,ex,SM).call(this,i));if(!n)return;const{callback:o,options:{bubbles:l=!1,args:c=[],checker:d=null}}=n;d&&!d(t,i)||(o.bind(t,...c,i)(),l||Nn(i))}}ex=new WeakSet,SM=function(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const i=this.buffer.join("+");return this.buffer.length=0,i};const tx=class tx{get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return s$(t),is(this,"_colors",t)}convert(t){const i=Xk(t);if(!window.matchMedia("(forced-colors: active)").matches)return i;for(const[n,o]of this._colors)if(o.every((l,c)=>l===i[c]))return tx._colorsMapping.get(n);return i}getHexCode(t){const i=this._colors.get(t);return i?oi.makeHexColor(...i):t}};St(tx,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let eC=tx;var dm,ja,Zn,Er,fm,Nu,pm,yo,cc,dc,gm,ff,Bl,Wo,pf,yy,vy,mm,wy,Ul,fc,_m,pc,jl,ix,gc,Ty,mc,gf,mf,_c,Ey,dr,Is,Ru,bc,_f,Sy,xy,yc,Hl,Mu,Ay,vo,Dh,Vt,KE,tC,xM,AM,YE,CM,kM,PM,iC,DM,sC,nC,IM,Qr,Cu,LM,NM,rC,RM,vb,aC;let o_=(Dh=class{constructor(t,i,n,o,l,c,d,f,m,b,T,C,P,x){j(this,Vt);j(this,dm,new AbortController);j(this,ja,null);j(this,Zn,new Map);j(this,Er,new Map);j(this,fm,null);j(this,Nu,null);j(this,pm,null);j(this,yo,new a$);j(this,cc,null);j(this,dc,null);j(this,gm,0);j(this,ff,new Set);j(this,Bl,null);j(this,Wo,null);j(this,pf,new Set);St(this,"_editorUndoBar",null);j(this,yy,!1);j(this,vy,!1);j(this,mm,!1);j(this,wy,null);j(this,Ul,null);j(this,fc,null);j(this,_m,null);j(this,pc,!1);j(this,jl,null);j(this,ix,new r$);j(this,gc,!1);j(this,Ty,!1);j(this,mc,null);j(this,gf,null);j(this,mf,null);j(this,_c,null);j(this,Ey,null);j(this,dr,Li.NONE);j(this,Is,new Set);j(this,Ru,null);j(this,bc,null);j(this,_f,null);j(this,Sy,null);j(this,xy,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});j(this,yc,[0,0]);j(this,Hl,null);j(this,Mu,null);j(this,Ay,null);j(this,vo,null);const L=this._signal=u(this,dm).signal;D(this,Mu,t),D(this,Ay,i),D(this,fm,n),D(this,bc,o),this._eventBus=l,l._on("editingaction",this.onEditingAction.bind(this),{signal:L}),l._on("pagechanging",this.onPageChanging.bind(this),{signal:L}),l._on("scalechanging",this.onScaleChanging.bind(this),{signal:L}),l._on("rotationchanging",this.onRotationChanging.bind(this),{signal:L}),l._on("setpreference",this.onSetPreference.bind(this),{signal:L}),l._on("switchannotationeditorparams",F=>this.updateParams(F.type,F.value),{signal:L}),R(this,Vt,CM).call(this),R(this,Vt,IM).call(this),R(this,Vt,iC).call(this),D(this,Nu,c.annotationStorage),D(this,wy,c.filterFactory),D(this,_f,d),D(this,_m,f||null),D(this,yy,m),D(this,vy,b),D(this,mm,T),D(this,Ey,C||null),this.viewParameters={realScale:ng.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=P||null,this._supportsPinchToZoom=x!==!1}static get _keyboardManager(){const t=Dh.prototype,i=c=>u(c,Mu).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&c.hasSomethingToControl(),n=(c,{target:d})=>{if(d instanceof HTMLInputElement){const{type:f}=d;return f!=="text"&&f!=="number"}return!0},o=this.TRANSLATE_SMALL,l=this.TRANSLATE_BIG;return is(this,"_keyboardManager",new lT([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:n}],[["ctrl+z","mac+meta+z"],t.undo,{checker:n}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:n}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:n}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(c,{target:d})=>!(d instanceof HTMLButtonElement)&&u(c,Mu).contains(d)&&!c.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(c,{target:d})=>!(d instanceof HTMLButtonElement)&&u(c,Mu).contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-o,0],checker:i}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-l,0],checker:i}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[o,0],checker:i}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[l,0],checker:i}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-o],checker:i}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-l],checker:i}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,o],checker:i}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,l],checker:i}]]))}destroy(){var t,i,n,o,l,c,d,f;(t=u(this,vo))==null||t.resolve(),D(this,vo,null),(i=u(this,dm))==null||i.abort(),D(this,dm,null),this._signal=null;for(const m of u(this,Er).values())m.destroy();u(this,Er).clear(),u(this,Zn).clear(),u(this,pf).clear(),(n=u(this,_c))==null||n.clear(),D(this,ja,null),u(this,Is).clear(),u(this,yo).destroy(),(o=u(this,fm))==null||o.destroy(),(l=u(this,bc))==null||l.destroy(),(c=u(this,jl))==null||c.hide(),D(this,jl,null),(d=u(this,mf))==null||d.destroy(),D(this,mf,null),u(this,Ul)&&(clearTimeout(u(this,Ul)),D(this,Ul,null)),u(this,Hl)&&(clearTimeout(u(this,Hl)),D(this,Hl,null)),(f=this._editorUndoBar)==null||f.destroy()}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return u(this,Ey)}get useNewAltTextFlow(){return u(this,vy)}get useNewAltTextWhenAddingImage(){return u(this,mm)}get hcmFilter(){return is(this,"hcmFilter",u(this,_f)?u(this,wy).addHCMFilter(u(this,_f).foreground,u(this,_f).background):"none")}get direction(){return is(this,"direction",getComputedStyle(u(this,Mu)).direction)}get highlightColors(){return is(this,"highlightColors",u(this,_m)?new Map(u(this,_m).split(",").map(t=>t.split("=").map(i=>i.trim()))):null)}get highlightColorNames(){return is(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}setCurrentDrawingSession(t){t?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),D(this,dc,t)}setMainHighlightColorPicker(t){D(this,mf,t)}editAltText(t,i=!1){var n;(n=u(this,fm))==null||n.editAltText(this,t,i)}getSignature(t){var i;(i=u(this,bc))==null||i.getSignature({uiManager:this,editor:t})}get signatureManager(){return u(this,bc)}switchToMode(t,i){this._eventBus.on("annotationeditormodechanged",i,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,i){this._eventBus.dispatch("setpreference",{source:this,name:t,value:i})}onSetPreference({name:t,value:i}){switch(t){case"enableNewAltTextWhenAddingImage":D(this,mm,i);break}}onPageChanging({pageNumber:t}){D(this,gm,t-1)}focusMainContainer(){u(this,Mu).focus()}findParent(t,i){for(const n of u(this,Er).values()){const{x:o,y:l,width:c,height:d}=n.div.getBoundingClientRect();if(t>=o&&t<=o+c&&i>=l&&i<=l+d)return n}return null}disableUserSelect(t=!1){u(this,Ay).classList.toggle("noUserSelect",t)}addShouldRescale(t){u(this,pf).add(t)}removeShouldRescale(t){u(this,pf).delete(t)}onScaleChanging({scale:t}){var i;this.commitOrRemove(),this.viewParameters.realScale=t*ng.PDF_TO_CSS_UNITS;for(const n of u(this,pf))n.onScaleChanging();(i=u(this,dc))==null||i.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}highlightSelection(t=""){const i=document.getSelection();if(!i||i.isCollapsed)return;const{anchorNode:n,anchorOffset:o,focusNode:l,focusOffset:c}=i,d=i.toString(),m=R(this,Vt,KE).call(this,i).closest(".textLayer"),b=this.getSelectionBoxes(m);if(!b)return;i.empty();const T=R(this,Vt,tC).call(this,m),C=u(this,dr)===Li.NONE,P=()=>{T==null||T.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:b,anchorNode:n,anchorOffset:o,focusNode:l,focusOffset:c,text:d}),C&&this.showAllEditors("highlight",!0,!0)};if(C){this.switchToMode(Li.HIGHLIGHT,P);return}P()}addToAnnotationStorage(t){!t.isEmpty()&&u(this,Nu)&&!u(this,Nu).has(t.id)&&u(this,Nu).setValue(t.id,t)}blur(){if(this.isShiftKeyDown=!1,u(this,pc)&&(D(this,pc,!1),R(this,Vt,YE).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const i of u(this,Is))if(i.div.contains(t)){D(this,gf,[i,t]),i._focusEventsAllowed=!1;break}}focus(){if(!u(this,gf))return;const[t,i]=u(this,gf);D(this,gf,null),i.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),i.focus()}addEditListeners(){R(this,Vt,iC).call(this),R(this,Vt,sC).call(this)}removeEditListeners(){R(this,Vt,DM).call(this),R(this,Vt,nC).call(this)}dragOver(t){for(const{type:i}of t.dataTransfer.items)for(const n of u(this,Wo))if(n.isHandlingMimeForPasting(i)){t.dataTransfer.dropEffect="copy",t.preventDefault();return}}drop(t){for(const i of t.dataTransfer.items)for(const n of u(this,Wo))if(n.isHandlingMimeForPasting(i.type)){n.paste(i,this.currentLayer),t.preventDefault();return}}copy(t){var n;if(t.preventDefault(),(n=u(this,ja))==null||n.commitOrRemove(),!this.hasSelection)return;const i=[];for(const o of u(this,Is)){const l=o.serialize(!0);l&&i.push(l)}i.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(i))}cut(t){this.copy(t),this.delete()}async paste(t){t.preventDefault();const{clipboardData:i}=t;for(const l of i.items)for(const c of u(this,Wo))if(c.isHandlingMimeForPasting(l.type)){c.paste(l,this.currentLayer);return}let n=i.getData("application/pdfjs");if(!n)return;try{n=JSON.parse(n)}catch(l){Ri(`paste: "${l.message}".`);return}if(!Array.isArray(n))return;this.unselectAll();const o=this.currentLayer;try{const l=[];for(const f of n){const m=await o.deserialize(f);if(!m)return;l.push(m)}const c=()=>{for(const f of l)R(this,Vt,rC).call(this,f);R(this,Vt,aC).call(this,l)},d=()=>{for(const f of l)f.remove()};this.addCommands({cmd:c,undo:d,mustExec:!0})}catch(l){Ri(`paste: "${l.message}".`)}}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),u(this,dr)!==Li.NONE&&!this.isEditorHandlingKeyboard&&Dh._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,u(this,pc)&&(D(this,pc,!1),R(this,Vt,YE).call(this,"main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}setEditingState(t){t?(R(this,Vt,kM).call(this),R(this,Vt,sC).call(this),R(this,Vt,Qr).call(this,{isEditing:u(this,dr)!==Li.NONE,isEmpty:R(this,Vt,vb).call(this),hasSomethingToUndo:u(this,yo).hasSomethingToUndo(),hasSomethingToRedo:u(this,yo).hasSomethingToRedo(),hasSelectedEditor:!1})):(R(this,Vt,PM).call(this),R(this,Vt,nC).call(this),R(this,Vt,Qr).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!u(this,Wo)){D(this,Wo,t);for(const i of u(this,Wo))R(this,Vt,Cu).call(this,i.defaultPropertiesToUpdate)}}getId(){return u(this,ix).id}get currentLayer(){return u(this,Er).get(u(this,gm))}getLayer(t){return u(this,Er).get(t)}get currentPageIndex(){return u(this,gm)}addLayer(t){u(this,Er).set(t.pageIndex,t),u(this,gc)?t.enable():t.disable()}removeLayer(t){u(this,Er).delete(t.pageIndex)}async updateMode(t,i=null,n=!1){var o,l,c;if(u(this,dr)!==t&&!(u(this,vo)&&(await u(this,vo).promise,!u(this,vo)))){if(D(this,vo,Promise.withResolvers()),(o=u(this,dc))==null||o.commitOrRemove(),D(this,dr,t),t===Li.NONE){this.setEditingState(!1),R(this,Vt,NM).call(this),(l=this._editorUndoBar)==null||l.hide(),u(this,vo).resolve();return}t===Li.SIGNATURE&&await((c=u(this,bc))==null?void 0:c.loadSignatures()),this.setEditingState(!0),await R(this,Vt,LM).call(this),this.unselectAll();for(const d of u(this,Er).values())d.updateMode(t);if(!i){n&&this.addNewEditorFromKeyboard(),u(this,vo).resolve();return}for(const d of u(this,Zn).values())d.annotationElementId===i||d.id===i?(this.setSelected(d),d.enterInEditMode()):d.unselect();u(this,vo).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t.mode!==u(this,dr)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...t})}updateParams(t,i){var n;if(u(this,Wo)){switch(t){case as.CREATE:this.currentLayer.addNewEditor(i);return;case as.HIGHLIGHT_DEFAULT_COLOR:(n=u(this,mf))==null||n.updateColor(i);break;case as.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(u(this,Sy)||D(this,Sy,new Map)).set(t,i),this.showAllEditors("highlight",i);break}for(const o of u(this,Is))o.updateParams(t,i);for(const o of u(this,Wo))o.updateDefaultParams(t,i)}}showAllEditors(t,i,n=!1){var l;for(const c of u(this,Zn).values())c.editorType===t&&c.show(i);(((l=u(this,Sy))==null?void 0:l.get(as.HIGHLIGHT_SHOW_ALL))??!0)!==i&&R(this,Vt,Cu).call(this,[[as.HIGHLIGHT_SHOW_ALL,i]])}enableWaiting(t=!1){if(u(this,Ty)!==t){D(this,Ty,t);for(const i of u(this,Er).values())t?i.disableClick():i.enableClick(),i.div.classList.toggle("waiting",t)}}getEditors(t){const i=[];for(const n of u(this,Zn).values())n.pageIndex===t&&i.push(n);return i}getEditor(t){return u(this,Zn).get(t)}addEditor(t){u(this,Zn).set(t.id,t)}removeEditor(t){var i,n;t.div.contains(document.activeElement)&&(u(this,Ul)&&clearTimeout(u(this,Ul)),D(this,Ul,setTimeout(()=>{this.focusMainContainer(),D(this,Ul,null)},0))),u(this,Zn).delete(t.id),t.annotationElementId&&((i=u(this,_c))==null||i.delete(t.annotationElementId)),this.unselect(t),(!t.annotationElementId||!u(this,ff).has(t.annotationElementId))&&((n=u(this,Nu))==null||n.remove(t.id))}addDeletedAnnotationElement(t){u(this,ff).add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return u(this,ff).has(t)}removeDeletedAnnotationElement(t){u(this,ff).delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}setActiveEditor(t){u(this,ja)!==t&&(D(this,ja,t),t&&R(this,Vt,Cu).call(this,t.propertiesToUpdate))}updateUI(t){u(this,Vt,RM)===t&&R(this,Vt,Cu).call(this,t.propertiesToUpdate)}updateUIForDefaultProperties(t){R(this,Vt,Cu).call(this,t.defaultPropertiesToUpdate)}toggleSelected(t){if(u(this,Is).has(t)){u(this,Is).delete(t),t.unselect(),R(this,Vt,Qr).call(this,{hasSelectedEditor:this.hasSelection});return}u(this,Is).add(t),t.select(),R(this,Vt,Cu).call(this,t.propertiesToUpdate),R(this,Vt,Qr).call(this,{hasSelectedEditor:!0})}setSelected(t){var i;(i=u(this,dc))==null||i.commitOrRemove();for(const n of u(this,Is))n!==t&&n.unselect();u(this,Is).clear(),u(this,Is).add(t),t.select(),R(this,Vt,Cu).call(this,t.propertiesToUpdate),R(this,Vt,Qr).call(this,{hasSelectedEditor:!0})}isSelected(t){return u(this,Is).has(t)}get firstSelectedEditor(){return u(this,Is).values().next().value}unselect(t){t.unselect(),u(this,Is).delete(t),R(this,Vt,Qr).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return u(this,Is).size!==0}get isEnterHandled(){return u(this,Is).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){var t;u(this,yo).undo(),R(this,Vt,Qr).call(this,{hasSomethingToUndo:u(this,yo).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:R(this,Vt,vb).call(this)}),(t=this._editorUndoBar)==null||t.hide()}redo(){u(this,yo).redo(),R(this,Vt,Qr).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:u(this,yo).hasSomethingToRedo(),isEmpty:R(this,Vt,vb).call(this)})}addCommands(t){u(this,yo).add(t),R(this,Vt,Qr).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:R(this,Vt,vb).call(this)})}cleanUndoStack(t){u(this,yo).cleanType(t)}delete(){var l;this.commitOrRemove();const t=(l=this.currentLayer)==null?void 0:l.endDrawingSession(!0);if(!this.hasSelection&&!t)return;const i=t?[t]:[...u(this,Is)],n=()=>{var c;(c=this._editorUndoBar)==null||c.show(o,i.length===1?i[0].editorType:i.length);for(const d of i)d.remove()},o=()=>{for(const c of i)R(this,Vt,rC).call(this,c)};this.addCommands({cmd:n,undo:o,mustExec:!0})}commitOrRemove(){var t;(t=u(this,ja))==null||t.commitOrRemove()}hasSomethingToControl(){return u(this,ja)||this.hasSelection}selectAll(){for(const t of u(this,Is))t.commit();R(this,Vt,aC).call(this,u(this,Zn).values())}unselectAll(){var t;if(!(u(this,ja)&&(u(this,ja).commitOrRemove(),u(this,dr)!==Li.NONE))&&!((t=u(this,dc))!=null&&t.commitOrRemove())&&this.hasSelection){for(const i of u(this,Is))i.unselect();u(this,Is).clear(),R(this,Vt,Qr).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(t,i,n=!1){if(n||this.commitOrRemove(),!this.hasSelection)return;u(this,yc)[0]+=t,u(this,yc)[1]+=i;const[o,l]=u(this,yc),c=[...u(this,Is)],d=1e3;u(this,Hl)&&clearTimeout(u(this,Hl)),D(this,Hl,setTimeout(()=>{D(this,Hl,null),u(this,yc)[0]=u(this,yc)[1]=0,this.addCommands({cmd:()=>{for(const f of c)u(this,Zn).has(f.id)&&(f.translateInPage(o,l),f.translationDone())},undo:()=>{for(const f of c)u(this,Zn).has(f.id)&&(f.translateInPage(-o,-l),f.translationDone())},mustExec:!1})},d));for(const f of c)f.translateInPage(t,i),f.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),D(this,Bl,new Map);for(const t of u(this,Is))u(this,Bl).set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!u(this,Bl))return!1;this.disableUserSelect(!1);const t=u(this,Bl);D(this,Bl,null);let i=!1;for(const[{x:o,y:l,pageIndex:c},d]of t)d.newX=o,d.newY=l,d.newPageIndex=c,i||(i=o!==d.savedX||l!==d.savedY||c!==d.savedPageIndex);if(!i)return!1;const n=(o,l,c,d)=>{if(u(this,Zn).has(o.id)){const f=u(this,Er).get(d);f?o._setParentAndPosition(f,l,c):(o.pageIndex=d,o.x=l,o.y=c)}};return this.addCommands({cmd:()=>{for(const[o,{newX:l,newY:c,newPageIndex:d}]of t)n(o,l,c,d)},undo:()=>{for(const[o,{savedX:l,savedY:c,savedPageIndex:d}]of t)n(o,l,c,d)},mustExec:!0}),!0}dragSelectedEditors(t,i){if(u(this,Bl))for(const n of u(this,Bl).keys())n.drag(t,i)}rebuild(t){if(t.parent===null){const i=this.getLayer(t.pageIndex);i?(i.changeParent(t),i.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){var t;return((t=this.getActive())==null?void 0:t.shouldGetKeyboardEvents())||u(this,Is).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return u(this,ja)===t}getActive(){return u(this,ja)}getMode(){return u(this,dr)}get imageManager(){return is(this,"imageManager",new JA)}getSelectionBoxes(t){if(!t)return null;const i=document.getSelection();for(let m=0,b=i.rangeCount;m<b;m++)if(!t.contains(i.getRangeAt(m).commonAncestorContainer))return null;const{x:n,y:o,width:l,height:c}=t.getBoundingClientRect();let d;switch(t.getAttribute("data-main-rotation")){case"90":d=(m,b,T,C)=>({x:(b-o)/c,y:1-(m+T-n)/l,width:C/c,height:T/l});break;case"180":d=(m,b,T,C)=>({x:1-(m+T-n)/l,y:1-(b+C-o)/c,width:T/l,height:C/c});break;case"270":d=(m,b,T,C)=>({x:1-(b+C-o)/c,y:(m-n)/l,width:C/c,height:T/l});break;default:d=(m,b,T,C)=>({x:(m-n)/l,y:(b-o)/c,width:T/l,height:C/c});break}const f=[];for(let m=0,b=i.rangeCount;m<b;m++){const T=i.getRangeAt(m);if(!T.collapsed)for(const{x:C,y:P,width:x,height:L}of T.getClientRects())x===0||L===0||f.push(d(C,P,x,L))}return f.length===0?null:f}addChangedExistingAnnotation({annotationElementId:t,id:i}){(u(this,pm)||D(this,pm,new Map)).set(t,i)}removeChangedExistingAnnotation({annotationElementId:t}){var i;(i=u(this,pm))==null||i.delete(t)}renderAnnotationElement(t){var o;const i=(o=u(this,pm))==null?void 0:o.get(t.data.id);if(!i)return;const n=u(this,Nu).getRawValue(i);n&&(u(this,dr)===Li.NONE&&!n.hasBeenModified||n.renderAnnotationElement(t))}setMissingCanvas(t,i,n){var l;const o=(l=u(this,_c))==null?void 0:l.get(t);o&&(o.setCanvas(i,n),u(this,_c).delete(t))}addMissingCanvas(t,i){(u(this,_c)||D(this,_c,new Map)).set(t,i)}},dm=new WeakMap,ja=new WeakMap,Zn=new WeakMap,Er=new WeakMap,fm=new WeakMap,Nu=new WeakMap,pm=new WeakMap,yo=new WeakMap,cc=new WeakMap,dc=new WeakMap,gm=new WeakMap,ff=new WeakMap,Bl=new WeakMap,Wo=new WeakMap,pf=new WeakMap,yy=new WeakMap,vy=new WeakMap,mm=new WeakMap,wy=new WeakMap,Ul=new WeakMap,fc=new WeakMap,_m=new WeakMap,pc=new WeakMap,jl=new WeakMap,ix=new WeakMap,gc=new WeakMap,Ty=new WeakMap,mc=new WeakMap,gf=new WeakMap,mf=new WeakMap,_c=new WeakMap,Ey=new WeakMap,dr=new WeakMap,Is=new WeakMap,Ru=new WeakMap,bc=new WeakMap,_f=new WeakMap,Sy=new WeakMap,xy=new WeakMap,yc=new WeakMap,Hl=new WeakMap,Mu=new WeakMap,Ay=new WeakMap,vo=new WeakMap,Vt=new WeakSet,KE=function({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t},tC=function(t){const{currentLayer:i}=this;if(i.hasTextLayer(t))return i;for(const n of u(this,Er).values())if(n.hasTextLayer(t))return n;return null},xM=function(){const t=document.getSelection();if(!t||t.isCollapsed)return;const n=R(this,Vt,KE).call(this,t).closest(".textLayer"),o=this.getSelectionBoxes(n);o&&(u(this,jl)||D(this,jl,new n$(this)),u(this,jl).show(n,o,this.direction==="ltr"))},AM=function(){var l,c,d;const t=document.getSelection();if(!t||t.isCollapsed){u(this,Ru)&&((l=u(this,jl))==null||l.hide(),D(this,Ru,null),R(this,Vt,Qr).call(this,{hasSelectedText:!1}));return}const{anchorNode:i}=t;if(i===u(this,Ru))return;const o=R(this,Vt,KE).call(this,t).closest(".textLayer");if(!o){u(this,Ru)&&((c=u(this,jl))==null||c.hide(),D(this,Ru,null),R(this,Vt,Qr).call(this,{hasSelectedText:!1}));return}if((d=u(this,jl))==null||d.hide(),D(this,Ru,i),R(this,Vt,Qr).call(this,{hasSelectedText:!0}),!(u(this,dr)!==Li.HIGHLIGHT&&u(this,dr)!==Li.NONE)&&(u(this,dr)===Li.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),D(this,pc,this.isShiftKeyDown),!this.isShiftKeyDown)){const f=u(this,dr)===Li.HIGHLIGHT?R(this,Vt,tC).call(this,o):null;f==null||f.toggleDrawing();const m=new AbortController,b=this.combinedSignal(m),T=C=>{C.type==="pointerup"&&C.button!==0||(m.abort(),f==null||f.toggleDrawing(!0),C.type==="pointerup"&&R(this,Vt,YE).call(this,"main_toolbar"))};window.addEventListener("pointerup",T,{signal:b}),window.addEventListener("blur",T,{signal:b})}},YE=function(t=""){u(this,dr)===Li.HIGHLIGHT?this.highlightSelection(t):u(this,yy)&&R(this,Vt,xM).call(this)},CM=function(){document.addEventListener("selectionchange",R(this,Vt,AM).bind(this),{signal:this._signal})},kM=function(){if(u(this,fc))return;D(this,fc,new AbortController);const t=this.combinedSignal(u(this,fc));window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})},PM=function(){var t;(t=u(this,fc))==null||t.abort(),D(this,fc,null)},iC=function(){if(u(this,mc))return;D(this,mc,new AbortController);const t=this.combinedSignal(u(this,mc));window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})},DM=function(){var t;(t=u(this,mc))==null||t.abort(),D(this,mc,null)},sC=function(){if(u(this,cc))return;D(this,cc,new AbortController);const t=this.combinedSignal(u(this,cc));document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})},nC=function(){var t;(t=u(this,cc))==null||t.abort(),D(this,cc,null)},IM=function(){const t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})},Qr=function(t){Object.entries(t).some(([n,o])=>u(this,xy)[n]!==o)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(u(this,xy),t)}),u(this,dr)===Li.HIGHLIGHT&&t.hasSelectedEditor===!1&&R(this,Vt,Cu).call(this,[[as.HIGHLIGHT_FREE,!0]]))},Cu=function(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})},LM=async function(){if(!u(this,gc)){D(this,gc,!0);const t=[];for(const i of u(this,Er).values())t.push(i.enable());await Promise.all(t);for(const i of u(this,Zn).values())i.enable()}},NM=function(){if(this.unselectAll(),u(this,gc)){D(this,gc,!1);for(const t of u(this,Er).values())t.disable();for(const t of u(this,Zn).values())t.disable()}},rC=function(t){const i=u(this,Er).get(t.pageIndex);i?i.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))},RM=function(){let t=null;for(t of u(this,Is));return t},vb=function(){if(u(this,Zn).size===0)return!0;if(u(this,Zn).size===1)for(const t of u(this,Zn).values())return t.isEmpty();return!1},aC=function(t){for(const i of u(this,Is))i.unselect();u(this,Is).clear();for(const i of t)i.isEmpty()||(u(this,Is).add(i),i.select());R(this,Vt,Qr).call(this,{hasSelectedEditor:this.hasSelection})},St(Dh,"TRANSLATE_SMALL",1),St(Dh,"TRANSLATE_BIG",10),Dh);var fr,Vl,qo,bm,$l,Ha,ym,zl,va,Ou,bf,Wl,vc,yl,wb,ZE;const Jr=class Jr{constructor(t){j(this,yl);j(this,fr,null);j(this,Vl,!1);j(this,qo,null);j(this,bm,null);j(this,$l,null);j(this,Ha,null);j(this,ym,!1);j(this,zl,null);j(this,va,null);j(this,Ou,null);j(this,bf,null);j(this,Wl,!1);D(this,va,t),D(this,Wl,t._uiManager.useNewAltTextFlow),u(Jr,vc)||D(Jr,vc,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(t){Jr._l10n??(Jr._l10n=t)}async render(){const t=D(this,qo,document.createElement("button"));t.className="altText",t.tabIndex="0";const i=D(this,bm,document.createElement("span"));t.append(i),u(this,Wl)?(t.classList.add("new"),t.setAttribute("data-l10n-id",u(Jr,vc).missing),i.setAttribute("data-l10n-id",u(Jr,vc)["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),i.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const n=u(this,va)._uiManager._signal;t.addEventListener("contextmenu",Mo,{signal:n}),t.addEventListener("pointerdown",l=>l.stopPropagation(),{signal:n});const o=l=>{l.preventDefault(),u(this,va)._uiManager.editAltText(u(this,va)),u(this,Wl)&&u(this,va)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:u(this,yl,wb)}})};return t.addEventListener("click",o,{capture:!0,signal:n}),t.addEventListener("keydown",l=>{l.target===t&&l.key==="Enter"&&(D(this,ym,!0),o(l))},{signal:n}),await R(this,yl,ZE).call(this),t}finish(){u(this,qo)&&(u(this,qo).focus({focusVisible:u(this,ym)}),D(this,ym,!1))}isEmpty(){return u(this,Wl)?u(this,fr)===null:!u(this,fr)&&!u(this,Vl)}hasData(){return u(this,Wl)?u(this,fr)!==null||!!u(this,Ou):this.isEmpty()}get guessedText(){return u(this,Ou)}async setGuessedText(t){u(this,fr)===null&&(D(this,Ou,t),D(this,bf,await Jr._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t})),R(this,yl,ZE).call(this))}toggleAltTextBadge(t=!1){var i;if(!u(this,Wl)||u(this,fr)){(i=u(this,zl))==null||i.remove(),D(this,zl,null);return}if(!u(this,zl)){const n=D(this,zl,document.createElement("div"));n.className="noAltTextBadge",u(this,va).div.append(n)}u(this,zl).classList.toggle("hidden",!t)}serialize(t){let i=u(this,fr);return!t&&u(this,Ou)===i&&(i=u(this,bf)),{altText:i,decorative:u(this,Vl),guessedText:u(this,Ou),textWithDisclaimer:u(this,bf)}}get data(){return{altText:u(this,fr),decorative:u(this,Vl)}}set data({altText:t,decorative:i,guessedText:n,textWithDisclaimer:o,cancel:l=!1}){n&&(D(this,Ou,n),D(this,bf,o)),!(u(this,fr)===t&&u(this,Vl)===i)&&(l||(D(this,fr,t),D(this,Vl,i)),R(this,yl,ZE).call(this))}toggle(t=!1){u(this,qo)&&(!t&&u(this,Ha)&&(clearTimeout(u(this,Ha)),D(this,Ha,null)),u(this,qo).disabled=!t)}shown(){u(this,va)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:u(this,yl,wb)}})}destroy(){var t,i;(t=u(this,qo))==null||t.remove(),D(this,qo,null),D(this,bm,null),D(this,$l,null),(i=u(this,zl))==null||i.remove(),D(this,zl,null)}};fr=new WeakMap,Vl=new WeakMap,qo=new WeakMap,bm=new WeakMap,$l=new WeakMap,Ha=new WeakMap,ym=new WeakMap,zl=new WeakMap,va=new WeakMap,Ou=new WeakMap,bf=new WeakMap,Wl=new WeakMap,vc=new WeakMap,yl=new WeakSet,wb=function(){return u(this,fr)&&"added"||u(this,fr)===null&&this.guessedText&&"review"||"missing"},ZE=async function(){var o,l,c;const t=u(this,qo);if(!t)return;if(u(this,Wl)){if(t.classList.toggle("done",!!u(this,fr)),t.setAttribute("data-l10n-id",u(Jr,vc)[u(this,yl,wb)]),(o=u(this,bm))==null||o.setAttribute("data-l10n-id",u(Jr,vc)[`${u(this,yl,wb)}-label`]),!u(this,fr)){(l=u(this,$l))==null||l.remove();return}}else{if(!u(this,fr)&&!u(this,Vl)){t.classList.remove("done"),(c=u(this,$l))==null||c.remove();return}t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let i=u(this,$l);if(!i){D(this,$l,i=document.createElement("span")),i.className="tooltip",i.setAttribute("role","tooltip"),i.id=`alt-text-tooltip-${u(this,va).id}`;const d=100,f=u(this,va)._uiManager._signal;f.addEventListener("abort",()=>{clearTimeout(u(this,Ha)),D(this,Ha,null)},{once:!0}),t.addEventListener("mouseenter",()=>{D(this,Ha,setTimeout(()=>{D(this,Ha,null),u(this,$l).classList.add("show"),u(this,va)._reportTelemetry({action:"alt_text_tooltip"})},d))},{signal:f}),t.addEventListener("mouseleave",()=>{var m;u(this,Ha)&&(clearTimeout(u(this,Ha)),D(this,Ha,null)),(m=u(this,$l))==null||m.classList.remove("show")},{signal:f})}u(this,Vl)?i.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(i.removeAttribute("data-l10n-id"),i.textContent=u(this,fr)),i.parentNode||t.append(i);const n=u(this,va).getElementForAltText();n==null||n.setAttribute("aria-describedby",i.id)},j(Jr,vc,null),St(Jr,"_l10n",null);let WS=Jr;var vm,yf,Cy,ky,Py,Dy,Iy,Fu,vf,Bu,wf,Uu,Ld,MM,OM,FM,wm;let Kk=(wm=class{constructor({container:t,isPinchingDisabled:i=null,isPinchingStopped:n=null,onPinchStart:o=null,onPinching:l=null,onPinchEnd:c=null,signal:d}){j(this,Ld);j(this,vm);j(this,yf,!1);j(this,Cy,null);j(this,ky);j(this,Py);j(this,Dy);j(this,Iy);j(this,Fu,null);j(this,vf);j(this,Bu,null);j(this,wf);j(this,Uu,null);D(this,vm,t),D(this,Cy,n),D(this,ky,i),D(this,Py,o),D(this,Dy,l),D(this,Iy,c),D(this,wf,new AbortController),D(this,vf,AbortSignal.any([d,u(this,wf).signal])),t.addEventListener("touchstart",R(this,Ld,MM).bind(this),{passive:!1,signal:u(this,vf)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/Pd.pixelRatio}destroy(){var t,i;(t=u(this,wf))==null||t.abort(),D(this,wf,null),(i=u(this,Fu))==null||i.abort(),D(this,Fu,null)}},vm=new WeakMap,yf=new WeakMap,Cy=new WeakMap,ky=new WeakMap,Py=new WeakMap,Dy=new WeakMap,Iy=new WeakMap,Fu=new WeakMap,vf=new WeakMap,Bu=new WeakMap,wf=new WeakMap,Uu=new WeakMap,Ld=new WeakSet,MM=function(t){var o,l,c;if((o=u(this,ky))!=null&&o.call(this))return;if(t.touches.length===1){if(u(this,Fu))return;const d=D(this,Fu,new AbortController),f=AbortSignal.any([u(this,vf),d.signal]),m=u(this,vm),b={capture:!0,signal:f,passive:!1},T=C=>{var P;C.pointerType==="touch"&&((P=u(this,Fu))==null||P.abort(),D(this,Fu,null))};m.addEventListener("pointerdown",C=>{C.pointerType==="touch"&&(Nn(C),T(C))},b),m.addEventListener("pointerup",T,b),m.addEventListener("pointercancel",T,b);return}if(!u(this,Uu)){D(this,Uu,new AbortController);const d=AbortSignal.any([u(this,vf),u(this,Uu).signal]),f=u(this,vm),m={signal:d,capture:!1,passive:!1};f.addEventListener("touchmove",R(this,Ld,OM).bind(this),m);const b=R(this,Ld,FM).bind(this);f.addEventListener("touchend",b,m),f.addEventListener("touchcancel",b,m),m.capture=!0,f.addEventListener("pointerdown",Nn,m),f.addEventListener("pointermove",Nn,m),f.addEventListener("pointercancel",Nn,m),f.addEventListener("pointerup",Nn,m),(l=u(this,Py))==null||l.call(this)}if(Nn(t),t.touches.length!==2||(c=u(this,Cy))!=null&&c.call(this)){D(this,Bu,null);return}let[i,n]=t.touches;i.identifier>n.identifier&&([i,n]=[n,i]),D(this,Bu,{touch0X:i.screenX,touch0Y:i.screenY,touch1X:n.screenX,touch1Y:n.screenY})},OM=function(t){var te;if(!u(this,Bu)||t.touches.length!==2)return;Nn(t);let[i,n]=t.touches;i.identifier>n.identifier&&([i,n]=[n,i]);const{screenX:o,screenY:l}=i,{screenX:c,screenY:d}=n,f=u(this,Bu),{touch0X:m,touch0Y:b,touch1X:T,touch1Y:C}=f,P=T-m,x=C-b,L=c-o,F=d-l,X=Math.hypot(L,F)||1,re=Math.hypot(P,x)||1;if(!u(this,yf)&&Math.abs(re-X)<=wm.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(f.touch0X=o,f.touch0Y=l,f.touch1X=c,f.touch1Y=d,!u(this,yf)){D(this,yf,!0);return}const K=[(o+c)/2,(l+d)/2];(te=u(this,Dy))==null||te.call(this,K,re,X)},FM=function(t){var i;t.touches.length>=2||(u(this,Uu)&&(u(this,Uu).abort(),D(this,Uu,null),(i=u(this,Iy))==null||i.call(this)),u(this,Bu)&&(Nn(t),D(this,Bu,null),D(this,yf,!1)))},wm);var Tf,Go,tn,Tm,wc,Ly,Ef,Sr,Sf,ju,Tc,Ny,xf,Va,Ry,Af,Hu,ql,Em,Sm,wo,Cf,My,sx,vi,oC,Oy,lC,QE,BM,UM,uC,JE,hC,jM,HM,VM,cC,$M,dC,zM,WM,qM,fC,Tb;const Wi=class Wi{constructor(t){j(this,vi);j(this,Tf,null);j(this,Go,null);j(this,tn,null);j(this,Tm,!1);j(this,wc,null);j(this,Ly,"");j(this,Ef,!1);j(this,Sr,null);j(this,Sf,null);j(this,ju,null);j(this,Tc,null);j(this,Ny,"");j(this,xf,!1);j(this,Va,null);j(this,Ry,!1);j(this,Af,!1);j(this,Hu,!1);j(this,ql,null);j(this,Em,0);j(this,Sm,0);j(this,wo,null);j(this,Cf,null);St(this,"isSelected",!1);St(this,"_isCopy",!1);St(this,"_editToolbar",null);St(this,"_initialOptions",Object.create(null));St(this,"_initialData",null);St(this,"_isVisible",!0);St(this,"_uiManager",null);St(this,"_focusEventsAllowed",!0);j(this,My,!1);j(this,sx,Wi._zIndex++);this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null;const{rotation:i,rawDims:{pageWidth:n,pageHeight:o,pageX:l,pageY:c}}=this.parent.viewport;this.rotation=i,this.pageRotation=(360+i-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[n,o],this.pageTranslation=[l,c];const[d,f]=this.parentDimensions;this.x=t.x/d,this.y=t.y/f,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const t=Wi.prototype._resizeWithKeyboard,i=o_.TRANSLATE_SMALL,n=o_.TRANSLATE_BIG;return is(this,"_resizerKeyboardManager",new lT([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-i,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-n,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[i,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[n,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-i]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-n]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,i]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,n]}],[["Escape","mac+Escape"],Wi.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get isDrawer(){return!1}static get _defaultLineColor(){return is(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const i=new o$({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});i.annotationElementId=t.annotationElementId,i.deleted=!0,i._uiManager.addToAnnotationStorage(i)}static initialize(t,i){if(Wi._l10n??(Wi._l10n=t),Wi._l10nResizer||(Wi._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),Wi._borderLineWidth!==-1)return;const n=getComputedStyle(document.documentElement);Wi._borderLineWidth=parseFloat(n.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,i){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,i){Bs("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return u(this,My)}set _isDraggable(t){var i;D(this,My,t),(i=this.div)==null||i.classList.toggle("draggable",t)}get isEnterHandled(){return!0}center(){const[t,i]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*i/(t*2),this.y+=this.width*t/(i*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*i/(t*2),this.y-=this.width*t/(i*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=u(this,sx)}setParent(t){t!==null?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):R(this,vi,Tb).call(this),this.parent=t}focusin(t){this._focusEventsAllowed&&(u(this,xf)?D(this,xf,!1):this.parent.setSelected(this))}focusout(t){var n;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const i=t.relatedTarget;i!=null&&i.closest(`#${this.id}`)||(t.preventDefault(),(n=this.parent)!=null&&n.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,i,n,o){const[l,c]=this.parentDimensions;[n,o]=this.screenToPageTranslation(n,o),this.x=(t+n)/l,this.y=(i+o)/c,this.fixAndSetPosition()}_moveAfterPaste(t,i){const[n,o]=this.parentDimensions;this.setAt(t*n,i*o,this.width*n,this.height*o),this._onTranslated()}translate(t,i){R(this,vi,oC).call(this,this.parentDimensions,t,i)}translateInPage(t,i){u(this,Va)||D(this,Va,[this.x,this.y,this.width,this.height]),R(this,vi,oC).call(this,this.pageDimensions,t,i),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(t,i){u(this,Va)||D(this,Va,[this.x,this.y,this.width,this.height]);const{div:n,parentDimensions:[o,l]}=this;if(this.x+=t/o,this.y+=i/l,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:T,y:C}=this.div.getBoundingClientRect();this.parent.findNewParent(this,T,C)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:c,y:d}=this;const[f,m]=this.getBaseTranslation();c+=f,d+=m;const{style:b}=n;b.left=`${(100*c).toFixed(2)}%`,b.top=`${(100*d).toFixed(2)}%`,this._onTranslating(c,d),n.scrollIntoView({block:"nearest"})}_onTranslating(t,i){}_onTranslated(t,i){}get _hasBeenMoved(){return!!u(this,Va)&&(u(this,Va)[0]!==this.x||u(this,Va)[1]!==this.y)}get _hasBeenResized(){return!!u(this,Va)&&(u(this,Va)[2]!==this.width||u(this,Va)[3]!==this.height)}getBaseTranslation(){const[t,i]=this.parentDimensions,{_borderLineWidth:n}=Wi,o=n/t,l=n/i;switch(this.rotation){case 90:return[-o,l];case 180:return[o,l];case 270:return[o,-l];default:return[-o,-l]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const{div:{style:i},pageDimensions:[n,o]}=this;let{x:l,y:c,width:d,height:f}=this;if(d*=n,f*=o,l*=n,c*=o,this._mustFixPosition)switch(t){case 0:l=Vr(l,0,n-d),c=Vr(c,0,o-f);break;case 90:l=Vr(l,0,n-f),c=Vr(c,d,o);break;case 180:l=Vr(l,d,n),c=Vr(c,f,o);break;case 270:l=Vr(l,f,n),c=Vr(c,0,o-d);break}this.x=l/=n,this.y=c/=o;const[m,b]=this.getBaseTranslation();l+=m,c+=b,i.left=`${(100*l).toFixed(2)}%`,i.top=`${(100*c).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(t,i){var n;return R(n=Wi,Oy,lC).call(n,t,i,this.parentRotation)}pageTranslationToScreen(t,i){var n;return R(n=Wi,Oy,lC).call(n,t,i,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[i,n]}=this;return[i*t,n*t]}setDims(t,i){const[n,o]=this.parentDimensions,{style:l}=this.div;l.width=`${(100*t/n).toFixed(2)}%`,u(this,Ef)||(l.height=`${(100*i/o).toFixed(2)}%`)}fixDims(){const{style:t}=this.div,{height:i,width:n}=t,o=n.endsWith("%"),l=!u(this,Ef)&&i.endsWith("%");if(o&&l)return;const[c,d]=this.parentDimensions;o||(t.width=`${(100*parseFloat(n)/c).toFixed(2)}%`),!u(this,Ef)&&!l&&(t.height=`${(100*parseFloat(i)/d).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}_onResized(){}static _round(t){return Math.round(t*1e4)/1e4}_onResizing(){}altTextFinish(){var t;(t=u(this,tn))==null||t.finish()}async addEditToolbar(){return this._editToolbar||u(this,Af)?this._editToolbar:(this._editToolbar=new QA(this),this.div.append(this._editToolbar.render()),u(this,tn)&&await this._editToolbar.addAltText(u(this,tn)),this._editToolbar)}removeEditToolbar(){var t;this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,(t=u(this,tn))==null||t.destroy())}addContainer(t){var n;const i=(n=this._editToolbar)==null?void 0:n.div;i?i.before(t):this.div.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){u(this,tn)||(WS.initialize(Wi._l10n),D(this,tn,new WS(this)),u(this,Tf)&&(u(this,tn).data=u(this,Tf),D(this,Tf,null)),await this.addEditToolbar())}get altTextData(){var t;return(t=u(this,tn))==null?void 0:t.data}set altTextData(t){u(this,tn)&&(u(this,tn).data=t)}get guessedAltText(){var t;return(t=u(this,tn))==null?void 0:t.guessedText}async setGuessedAltText(t){var i;await((i=u(this,tn))==null?void 0:i.setGuessedText(t))}serializeAltText(t){var i;return(i=u(this,tn))==null?void 0:i.serialize(t)}hasAltText(){return!!u(this,tn)&&!u(this,tn).isEmpty()}hasAltTextData(){var t;return((t=u(this,tn))==null?void 0:t.hasData())??!1}render(){var c;const t=this.div=document.createElement("div");t.setAttribute("data-editor-rotation",(360-this.rotation)%360),t.className=this.name,t.setAttribute("id",this.id),t.tabIndex=u(this,Tm)?-1:0,t.setAttribute("role","application"),this.defaultL10nId&&t.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||t.classList.add("hidden"),this.setInForeground(),R(this,vi,dC).call(this);const[i,n]=this.parentDimensions;this.parentRotation%180!==0&&(t.style.maxWidth=`${(100*n/i).toFixed(2)}%`,t.style.maxHeight=`${(100*i/n).toFixed(2)}%`);const[o,l]=this.getInitialTranslation();return this.translate(o,l),EM(this,t,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(u(this,Cf)||D(this,Cf,new Kk({container:t,isPinchingDisabled:()=>!this.isSelected,onPinchStart:R(this,vi,jM).bind(this),onPinching:R(this,vi,HM).bind(this),onPinchEnd:R(this,vi,VM).bind(this),signal:this._uiManager._signal}))),(c=this._uiManager._editorUndoBar)==null||c.hide(),t}pointerdown(t){const{isMac:i}=yr.platform;if(t.button!==0||t.ctrlKey&&i){t.preventDefault();return}if(D(this,xf,!0),this._isDraggable){R(this,vi,$M).call(this,t);return}R(this,vi,cC).call(this,t)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){u(this,ql)&&clearTimeout(u(this,ql)),D(this,ql,setTimeout(()=>{var t;D(this,ql,null),(t=this.parent)==null||t.moveEditorInDOM(this)},0))}_setParentAndPosition(t,i,n){t.changeParent(this),this.x=i,this.y=n,this.fixAndSetPosition(),this._onTranslated()}getRect(t,i,n=this.rotation){const o=this.parentScale,[l,c]=this.pageDimensions,[d,f]=this.pageTranslation,m=t/o,b=i/o,T=this.x*l,C=this.y*c,P=this.width*l,x=this.height*c;switch(n){case 0:return[T+m+d,c-C-b-x+f,T+m+P+d,c-C-b+f];case 90:return[T+b+d,c-C+m+f,T+b+x+d,c-C+m+P+f];case 180:return[T-m-P+d,c-C+b+f,T-m+d,c-C+b+x+f];case 270:return[T-b-x+d,c-C-m-P+f,T-b+d,c-C-m+f];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,i){const[n,o,l,c]=t,d=l-n,f=c-o;switch(this.rotation){case 0:return[n,i-c,d,f];case 90:return[n,i-o,f,d];case 180:return[l,i-o,d,f];case 270:return[l,i-c,f,d];default:throw new Error("Invalid rotation")}}onceAdded(t){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),D(this,Af,!0),!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),D(this,Af,!1),!0):!1}isInEditMode(){return u(this,Af)}shouldGetKeyboardEvents(){return u(this,Hu)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:t,left:i,bottom:n,right:o}=this.getClientDimensions(),{innerHeight:l,innerWidth:c}=window;return i<c&&o>0&&t<l&&n>0}rebuild(){R(this,vi,dC).call(this)}rotate(t){}resize(){}serializeDeleted(){var t;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((t=this._initialData)==null?void 0:t.popupRef)||""}}serialize(t=!1,i=null){Bs("An editor must be serializable")}static async deserialize(t,i,n){const o=new this.prototype.constructor({parent:i,id:i.getNextId(),uiManager:n});o.rotation=t.rotation,D(o,Tf,t.accessibilityData),o._isCopy=t.isCopy||!1;const[l,c]=o.pageDimensions,[d,f,m,b]=o.getRectInCurrentCoords(t.rect,c);return o.x=d/l,o.y=f/c,o.width=m/l,o.height=b/c,o}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var t,i;if((t=u(this,Tc))==null||t.abort(),D(this,Tc,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),u(this,ql)&&(clearTimeout(u(this,ql)),D(this,ql,null)),R(this,vi,Tb).call(this),this.removeEditToolbar(),u(this,wo)){for(const n of u(this,wo).values())clearTimeout(n);D(this,wo,null)}this.parent=null,(i=u(this,Cf))==null||i.destroy(),D(this,Cf,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(R(this,vi,BM).call(this),u(this,Sr).classList.remove("hidden"))}get toolbarPosition(){return null}keydown(t){if(!this.isResizable||t.target!==this.div||t.key!=="Enter")return;this._uiManager.setSelected(this),D(this,ju,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const i=u(this,Sr).children;if(!u(this,Go)){D(this,Go,Array.from(i));const c=R(this,vi,zM).bind(this),d=R(this,vi,WM).bind(this),f=this._uiManager._signal;for(const m of u(this,Go)){const b=m.getAttribute("data-resizer-name");m.setAttribute("role","spinbutton"),m.addEventListener("keydown",c,{signal:f}),m.addEventListener("blur",d,{signal:f}),m.addEventListener("focus",R(this,vi,qM).bind(this,b),{signal:f}),m.setAttribute("data-l10n-id",Wi._l10nResizer[b])}}const n=u(this,Go)[0];let o=0;for(const c of i){if(c===n)break;o++}const l=(360-this.rotation+this.parentRotation)%360/90*(u(this,Go).length/4);if(l!==o){if(l<o)for(let d=0;d<o-l;d++)u(this,Sr).append(u(this,Sr).firstChild);else if(l>o)for(let d=0;d<l-o;d++)u(this,Sr).firstChild.before(u(this,Sr).lastChild);let c=0;for(const d of i){const m=u(this,Go)[c++].getAttribute("data-resizer-name");d.setAttribute("data-l10n-id",Wi._l10nResizer[m])}}R(this,vi,fC).call(this,0),D(this,Hu,!0),u(this,Sr).firstChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}_resizeWithKeyboard(t,i){u(this,Hu)&&R(this,vi,hC).call(this,u(this,Ny),{deltaX:t,deltaY:i,fromKeyboard:!0})}_stopResizingWithKeyboard(){R(this,vi,Tb).call(this),this.div.focus()}select(){var t,i,n;if(!(this.isSelected&&this._editToolbar)){if(this.isSelected=!0,this.makeResizable(),(t=this.div)==null||t.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var o,l;(o=this.div)!=null&&o.classList.contains("selectedEditor")&&((l=this._editToolbar)==null||l.show())});return}(i=this._editToolbar)==null||i.show(),(n=u(this,tn))==null||n.toggleAltTextBadge(!1)}}unselect(){var t,i,n,o,l;this.isSelected&&(this.isSelected=!1,(t=u(this,Sr))==null||t.classList.add("hidden"),(i=this.div)==null||i.classList.remove("selectedEditor"),(n=this.div)!=null&&n.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(o=this._editToolbar)==null||o.hide(),(l=u(this,tn))==null||l.toggleAltTextBadge(!0))}updateParams(t,i){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(t){this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.id})}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return u(this,Ry)}set isEditing(t){D(this,Ry,t),this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(t,i){D(this,Ef,!0);const n=t/i,{style:o}=this.div;o.aspectRatio=n,o.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,i=!1){if(i){u(this,wo)||D(this,wo,new Map);const{action:n}=t;let o=u(this,wo).get(n);o&&clearTimeout(o),o=setTimeout(()=>{this._reportTelemetry(t),u(this,wo).delete(n),u(this,wo).size===0&&D(this,wo,null)},Wi._telemetryTimeout),u(this,wo).set(n,o);return}t.type||(t.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),D(this,Tm,!1)}disable(){this.div&&(this.div.tabIndex=-1),D(this,Tm,!0)}renderAnnotationElement(t){let i=t.container.querySelector(".annotationContent");if(!i)i=document.createElement("div"),i.classList.add("annotationContent",this.editorType),t.container.prepend(i);else if(i.nodeName==="CANVAS"){const n=i;i=document.createElement("div"),i.classList.add("annotationContent",this.editorType),n.before(i)}return i}resetAnnotationElement(t){const{firstChild:i}=t.container;(i==null?void 0:i.nodeName)==="DIV"&&i.classList.contains("annotationContent")&&i.remove()}};Tf=new WeakMap,Go=new WeakMap,tn=new WeakMap,Tm=new WeakMap,wc=new WeakMap,Ly=new WeakMap,Ef=new WeakMap,Sr=new WeakMap,Sf=new WeakMap,ju=new WeakMap,Tc=new WeakMap,Ny=new WeakMap,xf=new WeakMap,Va=new WeakMap,Ry=new WeakMap,Af=new WeakMap,Hu=new WeakMap,ql=new WeakMap,Em=new WeakMap,Sm=new WeakMap,wo=new WeakMap,Cf=new WeakMap,My=new WeakMap,sx=new WeakMap,vi=new WeakSet,oC=function([t,i],n,o){[n,o]=this.screenToPageTranslation(n,o),this.x+=n/t,this.y+=o/i,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},Oy=new WeakSet,lC=function(t,i,n){switch(n){case 90:return[i,-t];case 180:return[-t,-i];case 270:return[-i,t];default:return[t,i]}},QE=function(t){switch(t){case 90:{const[i,n]=this.pageDimensions;return[0,-i/n,n/i,0]}case 180:return[-1,0,0,-1];case 270:{const[i,n]=this.pageDimensions;return[0,i/n,-n/i,0]}default:return[1,0,0,1]}},BM=function(){if(u(this,Sr))return;D(this,Sr,document.createElement("div")),u(this,Sr).classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],i=this._uiManager._signal;for(const n of t){const o=document.createElement("div");u(this,Sr).append(o),o.classList.add("resizer",n),o.setAttribute("data-resizer-name",n),o.addEventListener("pointerdown",R(this,vi,UM).bind(this,n),{signal:i}),o.addEventListener("contextmenu",Mo,{signal:i}),o.tabIndex=-1}this.div.prepend(u(this,Sr))},UM=function(t,i){var b;i.preventDefault();const{isMac:n}=yr.platform;if(i.button!==0||i.ctrlKey&&n)return;(b=u(this,tn))==null||b.toggle(!1);const o=this._isDraggable;this._isDraggable=!1,D(this,Sf,[i.screenX,i.screenY]);const l=new AbortController,c=this._uiManager.combinedSignal(l);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",R(this,vi,hC).bind(this,t),{passive:!0,capture:!0,signal:c}),window.addEventListener("touchmove",Nn,{passive:!1,signal:c}),window.addEventListener("contextmenu",Mo,{signal:c}),D(this,ju,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const d=this.parent.div.style.cursor,f=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(i.target).cursor;const m=()=>{var T;l.abort(),this.parent.togglePointerEvents(!0),(T=u(this,tn))==null||T.toggle(!0),this._isDraggable=o,this.parent.div.style.cursor=d,this.div.style.cursor=f,R(this,vi,JE).call(this)};window.addEventListener("pointerup",m,{signal:c}),window.addEventListener("blur",m,{signal:c})},uC=function(t,i,n,o){this.width=n,this.height=o,this.x=t,this.y=i;const[l,c]=this.parentDimensions;this.setDims(l*n,c*o),this.fixAndSetPosition(),this._onResized()},JE=function(){if(!u(this,ju))return;const{savedX:t,savedY:i,savedWidth:n,savedHeight:o}=u(this,ju);D(this,ju,null);const l=this.x,c=this.y,d=this.width,f=this.height;l===t&&c===i&&d===n&&f===o||this.addCommands({cmd:R(this,vi,uC).bind(this,l,c,d,f),undo:R(this,vi,uC).bind(this,t,i,n,o),mustExec:!0})},hC=function(t,i){const[n,o]=this.parentDimensions,l=this.x,c=this.y,d=this.width,f=this.height,m=Wi.MIN_SIZE/n,b=Wi.MIN_SIZE/o,T=R(this,vi,QE).call(this,this.rotation),C=($e,vt)=>[T[0]*$e+T[2]*vt,T[1]*$e+T[3]*vt],P=R(this,vi,QE).call(this,360-this.rotation),x=($e,vt)=>[P[0]*$e+P[2]*vt,P[1]*$e+P[3]*vt];let L,F,X=!1,re=!1;switch(t){case"topLeft":X=!0,L=($e,vt)=>[0,0],F=($e,vt)=>[$e,vt];break;case"topMiddle":L=($e,vt)=>[$e/2,0],F=($e,vt)=>[$e/2,vt];break;case"topRight":X=!0,L=($e,vt)=>[$e,0],F=($e,vt)=>[0,vt];break;case"middleRight":re=!0,L=($e,vt)=>[$e,vt/2],F=($e,vt)=>[0,vt/2];break;case"bottomRight":X=!0,L=($e,vt)=>[$e,vt],F=($e,vt)=>[0,0];break;case"bottomMiddle":L=($e,vt)=>[$e/2,vt],F=($e,vt)=>[$e/2,0];break;case"bottomLeft":X=!0,L=($e,vt)=>[0,vt],F=($e,vt)=>[$e,0];break;case"middleLeft":re=!0,L=($e,vt)=>[0,vt/2],F=($e,vt)=>[$e,vt/2];break}const K=L(d,f),te=F(d,f);let ee=C(...te);const A=Wi._round(l+ee[0]),me=Wi._round(c+ee[1]);let fe=1,J=1,ye,Oe;if(i.fromKeyboard)({deltaX:ye,deltaY:Oe}=i);else{const{screenX:$e,screenY:vt}=i,[Jt,di]=u(this,Sf);[ye,Oe]=this.screenToPageTranslation($e-Jt,vt-di),u(this,Sf)[0]=$e,u(this,Sf)[1]=vt}if([ye,Oe]=x(ye/n,Oe/o),X){const $e=Math.hypot(d,f);fe=J=Math.max(Math.min(Math.hypot(te[0]-K[0]-ye,te[1]-K[1]-Oe)/$e,1/d,1/f),m/d,b/f)}else re?fe=Vr(Math.abs(te[0]-K[0]-ye),m,1)/d:J=Vr(Math.abs(te[1]-K[1]-Oe),b,1)/f;const ot=Wi._round(d*fe),Tt=Wi._round(f*J);ee=C(...F(ot,Tt));const dt=A-ee[0],kt=me-ee[1];u(this,Va)||D(this,Va,[this.x,this.y,this.width,this.height]),this.width=ot,this.height=Tt,this.x=dt,this.y=kt,this.setDims(n*ot,o*Tt),this.fixAndSetPosition(),this._onResizing()},jM=function(){var t;D(this,ju,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),(t=u(this,tn))==null||t.toggle(!1),this.parent.togglePointerEvents(!1)},HM=function(t,i,n){let l=.7*(n/i)+1-.7;if(l===1)return;const c=R(this,vi,QE).call(this,this.rotation),d=(A,me)=>[c[0]*A+c[2]*me,c[1]*A+c[3]*me],[f,m]=this.parentDimensions,b=this.x,T=this.y,C=this.width,P=this.height,x=Wi.MIN_SIZE/f,L=Wi.MIN_SIZE/m;l=Math.max(Math.min(l,1/C,1/P),x/C,L/P);const F=Wi._round(C*l),X=Wi._round(P*l);if(F===C&&X===P)return;u(this,Va)||D(this,Va,[b,T,C,P]);const re=d(C/2,P/2),K=Wi._round(b+re[0]),te=Wi._round(T+re[1]),ee=d(F/2,X/2);this.x=K-ee[0],this.y=te-ee[1],this.width=F,this.height=X,this.setDims(f*F,m*X),this.fixAndSetPosition(),this._onResizing()},VM=function(){var t;(t=u(this,tn))==null||t.toggle(!0),this.parent.togglePointerEvents(!0),R(this,vi,JE).call(this)},cC=function(t){const{isMac:i}=yr.platform;t.ctrlKey&&!i||t.shiftKey||t.metaKey&&i?this.parent.toggleSelected(this):this.parent.setSelected(this)},$M=function(t){const{isSelected:i}=this;this._uiManager.setUpDragSession();let n=!1;const o=new AbortController,l=this._uiManager.combinedSignal(o),c={capture:!0,passive:!1,signal:l},d=m=>{o.abort(),D(this,wc,null),D(this,xf,!1),this._uiManager.endDragSession()||R(this,vi,cC).call(this,m),n&&this._onStopDragging()};i&&(D(this,Em,t.clientX),D(this,Sm,t.clientY),D(this,wc,t.pointerId),D(this,Ly,t.pointerType),window.addEventListener("pointermove",m=>{n||(n=!0,this._onStartDragging());const{clientX:b,clientY:T,pointerId:C}=m;if(C!==u(this,wc)){Nn(m);return}const[P,x]=this.screenToPageTranslation(b-u(this,Em),T-u(this,Sm));D(this,Em,b),D(this,Sm,T),this._uiManager.dragSelectedEditors(P,x)},c),window.addEventListener("touchmove",Nn,c),window.addEventListener("pointerdown",m=>{m.pointerType===u(this,Ly)&&(u(this,Cf)||m.isPrimary)&&d(m),Nn(m)},c));const f=m=>{if(!u(this,wc)||u(this,wc)===m.pointerId){d(m);return}Nn(m)};window.addEventListener("pointerup",f,{signal:l}),window.addEventListener("blur",f,{signal:l})},dC=function(){if(u(this,Tc)||!this.div)return;D(this,Tc,new AbortController);const t=this._uiManager.combinedSignal(u(this,Tc));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:t}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:t})},zM=function(t){Wi._resizerKeyboardManager.exec(this,t)},WM=function(t){var i;u(this,Hu)&&((i=t.relatedTarget)==null?void 0:i.parentNode)!==u(this,Sr)&&R(this,vi,Tb).call(this)},qM=function(t){D(this,Ny,u(this,Hu)?t:"")},fC=function(t){if(u(this,Go))for(const i of u(this,Go))i.tabIndex=t},Tb=function(){D(this,Hu,!1),R(this,vi,fC).call(this,-1),R(this,vi,JE).call(this)},j(Wi,Oy),St(Wi,"_l10n",null),St(Wi,"_l10nResizer",null),St(Wi,"_borderLineWidth",-1),St(Wi,"_colorManager",new eC),St(Wi,"_zIndex",1),St(Wi,"_telemetryTimeout",1e3);let Ys=Wi;class o$ extends Ys{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const GN=3285377520,_o=4294901760,Rl=65535;class GM{constructor(t){this.h1=t?t&4294967295:GN,this.h2=t?t&4294967295:GN}update(t){let i,n;if(typeof t=="string"){i=new Uint8Array(t.length*2),n=0;for(let L=0,F=t.length;L<F;L++){const X=t.charCodeAt(L);X<=255?i[n++]=X:(i[n++]=X>>>8,i[n++]=X&255)}}else if(ArrayBuffer.isView(t))i=t.slice(),n=i.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const o=n>>2,l=n-o*4,c=new Uint32Array(i.buffer,0,o);let d=0,f=0,m=this.h1,b=this.h2;const T=3432918353,C=461845907,P=T&Rl,x=C&Rl;for(let L=0;L<o;L++)L&1?(d=c[L],d=d*T&_o|d*P&Rl,d=d<<15|d>>>17,d=d*C&_o|d*x&Rl,m^=d,m=m<<13|m>>>19,m=m*5+3864292196):(f=c[L],f=f*T&_o|f*P&Rl,f=f<<15|f>>>17,f=f*C&_o|f*x&Rl,b^=f,b=b<<13|b>>>19,b=b*5+3864292196);switch(d=0,l){case 3:d^=i[o*4+2]<<16;case 2:d^=i[o*4+1]<<8;case 1:d^=i[o*4],d=d*T&_o|d*P&Rl,d=d<<15|d>>>17,d=d*C&_o|d*x&Rl,o&1?m^=d:b^=d}this.h1=m,this.h2=b}hexdigest(){let t=this.h1,i=this.h2;return t^=i>>>1,t=t*3981806797&_o|t*36045&Rl,i=i*4283543511&_o|((i<<16|t>>>16)*2950163797&_o)>>>16,t^=i>>>1,t=t*444984403&_o|t*60499&Rl,i=i*3301882366&_o|((i<<16|t>>>16)*3120437893&_o)>>>16,t^=i>>>1,(t>>>0).toString(16).padStart(8,"0")+(i>>>0).toString(16).padStart(8,"0")}}const pC=Object.freeze({map:null,hash:"",transfer:void 0});var kf,Pf,xr,nx,XM;class Yk{constructor(){j(this,nx);j(this,kf,!1);j(this,Pf,null);j(this,xr,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,i){const n=u(this,xr).get(t);return n===void 0?i:Object.assign(i,n)}getRawValue(t){return u(this,xr).get(t)}remove(t){if(u(this,xr).delete(t),u(this,xr).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const i of u(this,xr).values())if(i instanceof Ys)return;this.onAnnotationEditor(null)}}setValue(t,i){const n=u(this,xr).get(t);let o=!1;if(n!==void 0)for(const[l,c]of Object.entries(i))n[l]!==c&&(o=!0,n[l]=c);else o=!0,u(this,xr).set(t,i);o&&R(this,nx,XM).call(this),i instanceof Ys&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(i.constructor._type)}has(t){return u(this,xr).has(t)}get size(){return u(this,xr).size}resetModified(){u(this,kf)&&(D(this,kf,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new KM(this)}get serializable(){if(u(this,xr).size===0)return pC;const t=new Map,i=new GM,n=[],o=Object.create(null);let l=!1;for(const[c,d]of u(this,xr)){const f=d instanceof Ys?d.serialize(!1,o):d;f&&(t.set(c,f),i.update(`${c}:${JSON.stringify(f)}`),l||(l=!!f.bitmap))}if(l)for(const c of t.values())c.bitmap&&n.push(c.bitmap);return t.size>0?{map:t,hash:i.hexdigest(),transfer:n}:pC}get editorStats(){let t=null;const i=new Map;for(const n of u(this,xr).values()){if(!(n instanceof Ys))continue;const o=n.telemetryFinalData;if(!o)continue;const{type:l}=o;i.has(l)||i.set(l,Object.getPrototypeOf(n).constructor),t||(t=Object.create(null));const c=t[l]||(t[l]=new Map);for(const[d,f]of Object.entries(o)){if(d==="type")continue;let m=c.get(d);m||(m=new Map,c.set(d,m));const b=m.get(f)??0;m.set(f,b+1)}}for(const[n,o]of i)t[n]=o.computeTelemetryFinalData(t[n]);return t}resetModifiedIds(){D(this,Pf,null)}get modifiedIds(){if(u(this,Pf))return u(this,Pf);const t=[];for(const i of u(this,xr).values())!(i instanceof Ys)||!i.annotationElementId||!i.serialize()||t.push(i.annotationElementId);return D(this,Pf,{ids:new Set(t),hash:t.join(",")})}[Symbol.iterator](){return u(this,xr).entries()}}kf=new WeakMap,Pf=new WeakMap,xr=new WeakMap,nx=new WeakSet,XM=function(){u(this,kf)||(D(this,kf,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var Fy;class KM extends Yk{constructor(i){super();j(this,Fy);const{map:n,hash:o,transfer:l}=i.serializable,c=structuredClone(n,l?{transfer:l}:null);D(this,Fy,{map:c,hash:o,transfer:l})}get print(){Bs("Should not call PrintAnnotationStorage.print")}get serializable(){return u(this,Fy)}get modifiedIds(){return is(this,"modifiedIds",{ids:new Set,hash:""})}}Fy=new WeakMap;var xm;class l${constructor({ownerDocument:t=globalThis.document,styleElement:i=null}){j(this,xm,new Set);this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const i=this.styleElement.sheet;i.insertRule(t,i.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),u(this,xm).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,disableFontFace:i,_inspectFont:n}){if(!(!t||u(this,xm).has(t.loadedName))){if(Vn(!i,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:o,src:l,style:c}=t,d=new FontFace(o,l,c);this.addNativeFontFace(d);try{await d.load(),u(this,xm).add(o),n==null||n(t)}catch{Ri(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(d)}return}Bs("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo){await this.loadSystemFont(t);return}if(this.isFontLoadingAPISupported){const n=t.createNativeFontFace();if(n){this.addNativeFontFace(n);try{await n.loaded}catch(o){throw Ri(`Failed to load font '${n.family}': '${o}'.`),t.disableFontFace=!0,o}}return}const i=t.createFontFaceRule();if(i){if(this.insertRule(i),this.isSyncFontLoadingSupported)return;await new Promise(n=>{const o=this._queueLoadingCallback(n);this._prepareFontLoadEvent(t,o)})}}get isFontLoadingAPISupported(){var i;const t=!!((i=this._document)!=null&&i.fonts);return is(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){return is(this,"isSyncFontLoadingSupported",na||yr.platform.isFirefox)}_queueLoadingCallback(t){function i(){for(Vn(!o.done,"completeRequest() cannot be called twice."),o.done=!0;n.length>0&&n[0].done;){const l=n.shift();setTimeout(l.callback,0)}}const{loadingRequests:n}=this,o={done:!1,complete:i,callback:t};return n.push(o),o}get _loadTestFont(){const t=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return is(this,"_loadTestFont",t)}_prepareFontLoadEvent(t,i){function n(te,ee){return te.charCodeAt(ee)<<24|te.charCodeAt(ee+1)<<16|te.charCodeAt(ee+2)<<8|te.charCodeAt(ee+3)&255}function o(te,ee,A,me){const fe=te.substring(0,ee),J=te.substring(ee+A);return fe+me+J}let l,c;const d=this._document.createElement("canvas");d.width=1,d.height=1;const f=d.getContext("2d");let m=0;function b(te,ee){if(++m>30){Ri("Load test font never loaded."),ee();return}if(f.font="30px "+te,f.fillText(".",0,20),f.getImageData(0,0,1,1).data[3]>0){ee();return}setTimeout(b.bind(null,te,ee))}const T=`lt${Date.now()}${this.loadTestFontId++}`;let C=this._loadTestFont;C=o(C,976,T.length,T);const x=16,L=1482184792;let F=n(C,x);for(l=0,c=T.length-3;l<c;l+=4)F=F-L+n(T,l)|0;l<T.length&&(F=F-L+n(T+"XXX",l)|0),C=o(C,x,4,YV(F));const X=`url(data:font/opentype;base64,${btoa(C)});`,re=`@font-face {font-family:"${T}";src:${X}}`;this.insertRule(re);const K=this._document.createElement("div");K.style.visibility="hidden",K.style.width=K.style.height="10px",K.style.position="absolute",K.style.top=K.style.left="0px";for(const te of[t.loadedName,T]){const ee=this._document.createElement("span");ee.textContent="Hi",ee.style.fontFamily=te,K.append(ee)}this._document.body.append(K),b(T,()=>{K.remove(),i.complete()})}}xm=new WeakMap;class u${constructor(t,i=null){this.compiledGlyphs=Object.create(null);for(const n in t)this[n]=t[n];this._inspectFont=i}createNativeFontFace(){var i;if(!this.data||this.disableFontFace)return null;let t;if(!this.cssFontInfo)t=new FontFace(this.loadedName,this.data,{});else{const n={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(n.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,n)}return(i=this._inspectFont)==null||i.call(this,this),t}createFontFaceRule(){var n;if(!this.data||this.disableFontFace)return null;const t=`url(data:${this.mimetype};base64,${dM(this.data)});`;let i;if(!this.cssFontInfo)i=`@font-face {font-family:"${this.loadedName}";src:${t}}`;else{let o=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(o+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),i=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${o}src:${t}}`}return(n=this._inspectFont)==null||n.call(this,this,t),i}getPathGenerator(t,i){if(this.compiledGlyphs[i]!==void 0)return this.compiledGlyphs[i];const n=this.loadedName+"_path_"+i;let o;try{o=t.get(n)}catch(c){Ri(`getPathGenerator - ignoring character: "${c}".`)}const l=new Path2D(o||"");return this.fontExtraProperties||t.delete(n),this.compiledGlyphs[i]=l}}function h$(g){if(g instanceof URL)return g.href;if(typeof g=="string"){if(na)return g;const t=URL.parse(g,window.location);if(t)return t.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function c$(g){if(na&&typeof Buffer<"u"&&g instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(g instanceof Uint8Array&&g.byteLength===g.buffer.byteLength)return g;if(typeof g=="string")return rT(g);if(g instanceof ArrayBuffer||ArrayBuffer.isView(g)||typeof g=="object"&&!isNaN(g==null?void 0:g.length))return new Uint8Array(g);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function DE(g){if(typeof g!="string")return null;if(g.endsWith("/"))return g;throw new Error(`Invalid factory url: "${g}" must include trailing slash.`)}const gC=g=>typeof g=="object"&&Number.isInteger(g==null?void 0:g.num)&&g.num>=0&&Number.isInteger(g==null?void 0:g.gen)&&g.gen>=0,d$=g=>typeof g=="object"&&typeof(g==null?void 0:g.name)=="string",YM=e$.bind(null,gC,d$);var Vu,rx;class f${constructor(){j(this,Vu,new Map);j(this,rx,Promise.resolve())}postMessage(t,i){const n={data:structuredClone(t,i?{transfer:i}:null)};u(this,rx).then(()=>{for(const[o]of u(this,Vu))o.call(this,n)})}addEventListener(t,i,n=null){let o=null;if((n==null?void 0:n.signal)instanceof AbortSignal){const{signal:l}=n;if(l.aborted){Ri("LoopbackPort - cannot use an `aborted` signal.");return}const c=()=>this.removeEventListener(t,i);o=()=>l.removeEventListener("abort",c),l.addEventListener("abort",c)}u(this,Vu).set(i,o)}removeEventListener(t,i){const n=u(this,Vu).get(i);n==null||n(),u(this,Vu).delete(i)}terminate(){for(const[,t]of u(this,Vu))t==null||t();u(this,Vu).clear()}}Vu=new WeakMap,rx=new WeakMap;const IE={DATA:1,ERROR:2},jn={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function XN(){}function ya(g){if(g instanceof Mh||g instanceof $S||g instanceof zN||g instanceof ay||g instanceof xA)return g;switch(g instanceof Error||typeof g=="object"&&g!==null||Bs('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),g.name){case"AbortException":return new Mh(g.message);case"InvalidPDFException":return new $S(g.message);case"PasswordException":return new zN(g.message,g.code);case"ResponseException":return new ay(g.message,g.status,g.missing);case"UnknownErrorException":return new xA(g.message,g.details)}return new xA(g.message,g.toString())}var Am,Ro,ZM,QM,JM,eS;class Eb{constructor(t,i,n){j(this,Ro);j(this,Am,new AbortController);this.sourceName=t,this.targetName=i,this.comObj=n,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),n.addEventListener("message",R(this,Ro,ZM).bind(this),{signal:u(this,Am).signal})}on(t,i){const n=this.actionHandler;if(n[t])throw new Error(`There is already an actionName called "${t}"`);n[t]=i}send(t,i,n){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:i},n)}sendWithPromise(t,i,n){const o=this.callbackId++,l=Promise.withResolvers();this.callbackCapabilities[o]=l;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:o,data:i},n)}catch(c){l.reject(c)}return l.promise}sendWithStream(t,i,n,o){const l=this.streamId++,c=this.sourceName,d=this.targetName,f=this.comObj;return new ReadableStream({start:m=>{const b=Promise.withResolvers();return this.streamControllers[l]={controller:m,startCall:b,pullCall:null,cancelCall:null,isClosed:!1},f.postMessage({sourceName:c,targetName:d,action:t,streamId:l,data:i,desiredSize:m.desiredSize},o),b.promise},pull:m=>{const b=Promise.withResolvers();return this.streamControllers[l].pullCall=b,f.postMessage({sourceName:c,targetName:d,stream:jn.PULL,streamId:l,desiredSize:m.desiredSize}),b.promise},cancel:m=>{Vn(m instanceof Error,"cancel must have a valid reason");const b=Promise.withResolvers();return this.streamControllers[l].cancelCall=b,this.streamControllers[l].isClosed=!0,f.postMessage({sourceName:c,targetName:d,stream:jn.CANCEL,streamId:l,reason:ya(m)}),b.promise}},n)}destroy(){var t;(t=u(this,Am))==null||t.abort(),D(this,Am,null)}}Am=new WeakMap,Ro=new WeakSet,ZM=function({data:t}){if(t.targetName!==this.sourceName)return;if(t.stream){R(this,Ro,JM).call(this,t);return}if(t.callback){const n=t.callbackId,o=this.callbackCapabilities[n];if(!o)throw new Error(`Cannot resolve callback ${n}`);if(delete this.callbackCapabilities[n],t.callback===IE.DATA)o.resolve(t.data);else if(t.callback===IE.ERROR)o.reject(ya(t.reason));else throw new Error("Unexpected callback case");return}const i=this.actionHandler[t.action];if(!i)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const n=this.sourceName,o=t.sourceName,l=this.comObj;Promise.try(i,t.data).then(function(c){l.postMessage({sourceName:n,targetName:o,callback:IE.DATA,callbackId:t.callbackId,data:c})},function(c){l.postMessage({sourceName:n,targetName:o,callback:IE.ERROR,callbackId:t.callbackId,reason:ya(c)})});return}if(t.streamId){R(this,Ro,QM).call(this,t);return}i(t.data)},QM=function(t){const i=t.streamId,n=this.sourceName,o=t.sourceName,l=this.comObj,c=this,d=this.actionHandler[t.action],f={enqueue(m,b=1,T){if(this.isCancelled)return;const C=this.desiredSize;this.desiredSize-=b,C>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),l.postMessage({sourceName:n,targetName:o,stream:jn.ENQUEUE,streamId:i,chunk:m},T)},close(){this.isCancelled||(this.isCancelled=!0,l.postMessage({sourceName:n,targetName:o,stream:jn.CLOSE,streamId:i}),delete c.streamSinks[i])},error(m){Vn(m instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,l.postMessage({sourceName:n,targetName:o,stream:jn.ERROR,streamId:i,reason:ya(m)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};f.sinkCapability.resolve(),f.ready=f.sinkCapability.promise,this.streamSinks[i]=f,Promise.try(d,t.data,f).then(function(){l.postMessage({sourceName:n,targetName:o,stream:jn.START_COMPLETE,streamId:i,success:!0})},function(m){l.postMessage({sourceName:n,targetName:o,stream:jn.START_COMPLETE,streamId:i,reason:ya(m)})})},JM=function(t){const i=t.streamId,n=this.sourceName,o=t.sourceName,l=this.comObj,c=this.streamControllers[i],d=this.streamSinks[i];switch(t.stream){case jn.START_COMPLETE:t.success?c.startCall.resolve():c.startCall.reject(ya(t.reason));break;case jn.PULL_COMPLETE:t.success?c.pullCall.resolve():c.pullCall.reject(ya(t.reason));break;case jn.PULL:if(!d){l.postMessage({sourceName:n,targetName:o,stream:jn.PULL_COMPLETE,streamId:i,success:!0});break}d.desiredSize<=0&&t.desiredSize>0&&d.sinkCapability.resolve(),d.desiredSize=t.desiredSize,Promise.try(d.onPull||XN).then(function(){l.postMessage({sourceName:n,targetName:o,stream:jn.PULL_COMPLETE,streamId:i,success:!0})},function(m){l.postMessage({sourceName:n,targetName:o,stream:jn.PULL_COMPLETE,streamId:i,reason:ya(m)})});break;case jn.ENQUEUE:if(Vn(c,"enqueue should have stream controller"),c.isClosed)break;c.controller.enqueue(t.chunk);break;case jn.CLOSE:if(Vn(c,"close should have stream controller"),c.isClosed)break;c.isClosed=!0,c.controller.close(),R(this,Ro,eS).call(this,c,i);break;case jn.ERROR:Vn(c,"error should have stream controller"),c.controller.error(ya(t.reason)),R(this,Ro,eS).call(this,c,i);break;case jn.CANCEL_COMPLETE:t.success?c.cancelCall.resolve():c.cancelCall.reject(ya(t.reason)),R(this,Ro,eS).call(this,c,i);break;case jn.CANCEL:if(!d)break;const f=ya(t.reason);Promise.try(d.onCancel||XN,f).then(function(){l.postMessage({sourceName:n,targetName:o,stream:jn.CANCEL_COMPLETE,streamId:i,success:!0})},function(m){l.postMessage({sourceName:n,targetName:o,stream:jn.CANCEL_COMPLETE,streamId:i,reason:ya(m)})}),d.sinkCapability.reject(f),d.isCancelled=!0,delete this.streamSinks[i];break;default:throw new Error("Unexpected stream case")}},eS=async function(t,i){var n,o,l;await Promise.allSettled([(n=t.startCall)==null?void 0:n.promise,(o=t.pullCall)==null?void 0:o.promise,(l=t.cancelCall)==null?void 0:l.promise]),delete this.streamControllers[i]};var By;class eO{constructor({enableHWA:t=!1}){j(this,By,!1);D(this,By,t)}create(t,i){if(t<=0||i<=0)throw new Error("Invalid canvas size");const n=this._createCanvas(t,i);return{canvas:n,context:n.getContext("2d",{willReadFrequently:!u(this,By)})}}reset(t,i,n){if(!t.canvas)throw new Error("Canvas is not specified");if(i<=0||n<=0)throw new Error("Invalid canvas size");t.canvas.width=i,t.canvas.height=n}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,i){Bs("Abstract method `_createCanvas` called.")}}By=new WeakMap;class p$ extends eO{constructor({ownerDocument:t=globalThis.document,enableHWA:i=!1}){super({enableHWA:i}),this._document=t}_createCanvas(t,i){const n=this._document.createElement("canvas");return n.width=t,n.height=i,n}}class tO{constructor({baseUrl:t=null,isCompressed:i=!0}){this.baseUrl=t,this.isCompressed=i}async fetch({name:t}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const i=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(i).then(n=>({cMapData:n,isCompressed:this.isCompressed})).catch(n=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${i}`)})}async _fetch(t){Bs("Abstract method `_fetch` called.")}}class KN extends tO{async _fetch(t){const i=await d_(t,this.isCompressed?"arraybuffer":"text");return i instanceof ArrayBuffer?new Uint8Array(i):rT(i)}}class iO{addFilter(t){return"none"}addHCMFilter(t,i){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,i,n,o,l){return"none"}destroy(t=!1){}}var Df,Cm,$u,zu,Br,If,Lf,Kt,Or,Sb,qg,tS,Gg,sO,mC,Xg,xb,Ab,_C,Cb;class g$ extends iO{constructor({docId:i,ownerDocument:n=globalThis.document}){super();j(this,Kt);j(this,Df);j(this,Cm);j(this,$u);j(this,zu);j(this,Br);j(this,If);j(this,Lf,0);D(this,zu,i),D(this,Br,n)}addFilter(i){if(!i)return"none";let n=u(this,Kt,Or).get(i);if(n)return n;const[o,l,c]=R(this,Kt,tS).call(this,i),d=i.length===1?o:`${o}${l}${c}`;if(n=u(this,Kt,Or).get(d),n)return u(this,Kt,Or).set(i,n),n;const f=`g_${u(this,zu)}_transfer_map_${Yn(this,Lf)._++}`,m=R(this,Kt,Gg).call(this,f);u(this,Kt,Or).set(i,m),u(this,Kt,Or).set(d,m);const b=R(this,Kt,Xg).call(this,f);return R(this,Kt,Ab).call(this,o,l,c,b),m}addHCMFilter(i,n){var x;const o=`${i}-${n}`,l="base";let c=u(this,Kt,Sb).get(l);if((c==null?void 0:c.key)===o||(c?((x=c.filter)==null||x.remove(),c.key=o,c.url="none",c.filter=null):(c={key:o,url:"none",filter:null},u(this,Kt,Sb).set(l,c)),!i||!n))return c.url;const d=R(this,Kt,Cb).call(this,i);i=oi.makeHexColor(...d);const f=R(this,Kt,Cb).call(this,n);if(n=oi.makeHexColor(...f),u(this,Kt,qg).style.color="",i==="#000000"&&n==="#ffffff"||i===n)return c.url;const m=new Array(256);for(let L=0;L<=255;L++){const F=L/255;m[L]=F<=.03928?F/12.92:((F+.055)/1.055)**2.4}const b=m.join(","),T=`g_${u(this,zu)}_hcm_filter`,C=c.filter=R(this,Kt,Xg).call(this,T);R(this,Kt,Ab).call(this,b,b,b,C),R(this,Kt,mC).call(this,C);const P=(L,F)=>{const X=d[L]/255,re=f[L]/255,K=new Array(F+1);for(let te=0;te<=F;te++)K[te]=X+te/F*(re-X);return K.join(",")};return R(this,Kt,Ab).call(this,P(0,5),P(1,5),P(2,5),C),c.url=R(this,Kt,Gg).call(this,T),c.url}addAlphaFilter(i){let n=u(this,Kt,Or).get(i);if(n)return n;const[o]=R(this,Kt,tS).call(this,[i]),l=`alpha_${o}`;if(n=u(this,Kt,Or).get(l),n)return u(this,Kt,Or).set(i,n),n;const c=`g_${u(this,zu)}_alpha_map_${Yn(this,Lf)._++}`,d=R(this,Kt,Gg).call(this,c);u(this,Kt,Or).set(i,d),u(this,Kt,Or).set(l,d);const f=R(this,Kt,Xg).call(this,c);return R(this,Kt,_C).call(this,o,f),d}addLuminosityFilter(i){let n=u(this,Kt,Or).get(i||"luminosity");if(n)return n;let o,l;if(i?([o]=R(this,Kt,tS).call(this,[i]),l=`luminosity_${o}`):l="luminosity",n=u(this,Kt,Or).get(l),n)return u(this,Kt,Or).set(i,n),n;const c=`g_${u(this,zu)}_luminosity_map_${Yn(this,Lf)._++}`,d=R(this,Kt,Gg).call(this,c);u(this,Kt,Or).set(i,d),u(this,Kt,Or).set(l,d);const f=R(this,Kt,Xg).call(this,c);return R(this,Kt,sO).call(this,f),i&&R(this,Kt,_C).call(this,o,f),d}addHighlightHCMFilter(i,n,o,l,c){var re;const d=`${n}-${o}-${l}-${c}`;let f=u(this,Kt,Sb).get(i);if((f==null?void 0:f.key)===d||(f?((re=f.filter)==null||re.remove(),f.key=d,f.url="none",f.filter=null):(f={key:d,url:"none",filter:null},u(this,Kt,Sb).set(i,f)),!n||!o))return f.url;const[m,b]=[n,o].map(R(this,Kt,Cb).bind(this));let T=Math.round(.2126*m[0]+.7152*m[1]+.0722*m[2]),C=Math.round(.2126*b[0]+.7152*b[1]+.0722*b[2]),[P,x]=[l,c].map(R(this,Kt,Cb).bind(this));C<T&&([T,C,P,x]=[C,T,x,P]),u(this,Kt,qg).style.color="";const L=(K,te,ee)=>{const A=new Array(256),me=(C-T)/ee,fe=K/255,J=(te-K)/(255*ee);let ye=0;for(let Oe=0;Oe<=ee;Oe++){const ot=Math.round(T+Oe*me),Tt=fe+Oe*J;for(let dt=ye;dt<=ot;dt++)A[dt]=Tt;ye=ot+1}for(let Oe=ye;Oe<256;Oe++)A[Oe]=A[ye-1];return A.join(",")},F=`g_${u(this,zu)}_hcm_${i}_filter`,X=f.filter=R(this,Kt,Xg).call(this,F);return R(this,Kt,mC).call(this,X),R(this,Kt,Ab).call(this,L(P[0],x[0],5),L(P[1],x[1],5),L(P[2],x[2],5),X),f.url=R(this,Kt,Gg).call(this,F),f.url}destroy(i=!1){var n,o,l,c;i&&((n=u(this,If))!=null&&n.size)||((o=u(this,$u))==null||o.parentNode.parentNode.remove(),D(this,$u,null),(l=u(this,Cm))==null||l.clear(),D(this,Cm,null),(c=u(this,If))==null||c.clear(),D(this,If,null),D(this,Lf,0))}}Df=new WeakMap,Cm=new WeakMap,$u=new WeakMap,zu=new WeakMap,Br=new WeakMap,If=new WeakMap,Lf=new WeakMap,Kt=new WeakSet,Or=function(){return u(this,Cm)||D(this,Cm,new Map)},Sb=function(){return u(this,If)||D(this,If,new Map)},qg=function(){if(!u(this,$u)){const i=u(this,Br).createElement("div"),{style:n}=i;n.visibility="hidden",n.contain="strict",n.width=n.height=0,n.position="absolute",n.top=n.left=0,n.zIndex=-1;const o=u(this,Br).createElementNS(Au,"svg");o.setAttribute("width",0),o.setAttribute("height",0),D(this,$u,u(this,Br).createElementNS(Au,"defs")),i.append(o),o.append(u(this,$u)),u(this,Br).body.append(i)}return u(this,$u)},tS=function(i){if(i.length===1){const m=i[0],b=new Array(256);for(let C=0;C<256;C++)b[C]=m[C]/255;const T=b.join(",");return[T,T,T]}const[n,o,l]=i,c=new Array(256),d=new Array(256),f=new Array(256);for(let m=0;m<256;m++)c[m]=n[m]/255,d[m]=o[m]/255,f[m]=l[m]/255;return[c.join(","),d.join(","),f.join(",")]},Gg=function(i){if(u(this,Df)===void 0){D(this,Df,"");const n=u(this,Br).URL;n!==u(this,Br).baseURI&&(oT(n)?Ri('#createUrl: ignore "data:"-URL for performance reasons.'):D(this,Df,zk(n,"")))}return`url(${u(this,Df)}#${i})`},sO=function(i){const n=u(this,Br).createElementNS(Au,"feColorMatrix");n.setAttribute("type","matrix"),n.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),i.append(n)},mC=function(i){const n=u(this,Br).createElementNS(Au,"feColorMatrix");n.setAttribute("type","matrix"),n.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),i.append(n)},Xg=function(i){const n=u(this,Br).createElementNS(Au,"filter");return n.setAttribute("color-interpolation-filters","sRGB"),n.setAttribute("id",i),u(this,Kt,qg).append(n),n},xb=function(i,n,o){const l=u(this,Br).createElementNS(Au,n);l.setAttribute("type","discrete"),l.setAttribute("tableValues",o),i.append(l)},Ab=function(i,n,o,l){const c=u(this,Br).createElementNS(Au,"feComponentTransfer");l.append(c),R(this,Kt,xb).call(this,c,"feFuncR",i),R(this,Kt,xb).call(this,c,"feFuncG",n),R(this,Kt,xb).call(this,c,"feFuncB",o)},_C=function(i,n){const o=u(this,Br).createElementNS(Au,"feComponentTransfer");n.append(o),R(this,Kt,xb).call(this,o,"feFuncA",i)},Cb=function(i){return u(this,Kt,qg).style.color=i,Xk(getComputedStyle(u(this,Kt,qg)).getPropertyValue("color"))};class nO{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const i=`${this.baseUrl}${t}`;return this._fetch(i).catch(n=>{throw new Error(`Unable to load font data at: ${i}`)})}async _fetch(t){Bs("Abstract method `_fetch` called.")}}class YN extends nO{async _fetch(t){const i=await d_(t,"arraybuffer");return new Uint8Array(i)}}class rO{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!t)throw new Error("Wasm filename must be specified.");const i=`${this.baseUrl}${t}`;return this._fetch(i).catch(n=>{throw new Error(`Unable to load wasm data at: ${i}`)})}async _fetch(t){Bs("Abstract method `_fetch` called.")}}class ZN extends rO{async _fetch(t){const i=await d_(t,"arraybuffer");return new Uint8Array(i)}}na&&Ri("Please use the `legacy` build in Node.js environments.");async function Zk(g){const i=await process.getBuiltinModule("fs").promises.readFile(g);return new Uint8Array(i)}class m$ extends iO{}class _$ extends eO{_createCanvas(t,i){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(t,i)}}class b$ extends tO{async _fetch(t){return Zk(t)}}class y$ extends nO{async _fetch(t){return Zk(t)}}class v$ extends rO{async _fetch(t){return Zk(t)}}const Pr={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function bC(g,t){if(!t)return;const i=t[2]-t[0],n=t[3]-t[1],o=new Path2D;o.rect(t[0],t[1],i,n),g.clip(o)}class Qk{isModifyingCurrentTransform(){return!1}getPattern(){Bs("Abstract method `getPattern` called.")}}class w$ extends Qk{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}_createGradient(t){let i;this._type==="axial"?i=t.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(i=t.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const n of this._colorStops)i.addColorStop(n[0],n[1]);return i}getPattern(t,i,n,o){let l;if(o===Pr.STROKE||o===Pr.FILL){const c=i.current.getClippedPathBoundingBox(o,_n(t))||[0,0,0,0],d=Math.ceil(c[2]-c[0])||1,f=Math.ceil(c[3]-c[1])||1,m=i.cachedCanvases.getCanvas("pattern",d,f),b=m.context;b.clearRect(0,0,b.canvas.width,b.canvas.height),b.beginPath(),b.rect(0,0,b.canvas.width,b.canvas.height),b.translate(-c[0],-c[1]),n=oi.transform(n,[1,0,0,1,c[0],c[1]]),b.transform(...i.baseTransform),this.matrix&&b.transform(...this.matrix),bC(b,this._bbox),b.fillStyle=this._createGradient(b),b.fill(),l=t.createPattern(m.canvas,"no-repeat");const T=new DOMMatrix(n);l.setTransform(T)}else bC(t,this._bbox),l=this._createGradient(t);return l}}function kA(g,t,i,n,o,l,c,d){const f=t.coords,m=t.colors,b=g.data,T=g.width*4;let C;f[i+1]>f[n+1]&&(C=i,i=n,n=C,C=l,l=c,c=C),f[n+1]>f[o+1]&&(C=n,n=o,o=C,C=c,c=d,d=C),f[i+1]>f[n+1]&&(C=i,i=n,n=C,C=l,l=c,c=C);const P=(f[i]+t.offsetX)*t.scaleX,x=(f[i+1]+t.offsetY)*t.scaleY,L=(f[n]+t.offsetX)*t.scaleX,F=(f[n+1]+t.offsetY)*t.scaleY,X=(f[o]+t.offsetX)*t.scaleX,re=(f[o+1]+t.offsetY)*t.scaleY;if(x>=re)return;const K=m[l],te=m[l+1],ee=m[l+2],A=m[c],me=m[c+1],fe=m[c+2],J=m[d],ye=m[d+1],Oe=m[d+2],ot=Math.round(x),Tt=Math.round(re);let dt,kt,$e,vt,Jt,di,Ut,ui;for(let qt=ot;qt<=Tt;qt++){if(qt<F){const Yt=qt<x?0:(x-qt)/(x-F);dt=P-(P-L)*Yt,kt=K-(K-A)*Yt,$e=te-(te-me)*Yt,vt=ee-(ee-fe)*Yt}else{let Yt;qt>re?Yt=1:F===re?Yt=0:Yt=(F-qt)/(F-re),dt=L-(L-X)*Yt,kt=A-(A-J)*Yt,$e=me-(me-ye)*Yt,vt=fe-(fe-Oe)*Yt}let Ze;qt<x?Ze=0:qt>re?Ze=1:Ze=(x-qt)/(x-re),Jt=P-(P-X)*Ze,di=K-(K-J)*Ze,Ut=te-(te-ye)*Ze,ui=ee-(ee-Oe)*Ze;const ki=Math.round(Math.min(dt,Jt)),wi=Math.round(Math.max(dt,Jt));let jt=T*qt+ki*4;for(let Yt=ki;Yt<=wi;Yt++)Ze=(dt-Yt)/(dt-Jt),Ze<0?Ze=0:Ze>1&&(Ze=1),b[jt++]=kt-(kt-di)*Ze|0,b[jt++]=$e-($e-Ut)*Ze|0,b[jt++]=vt-(vt-ui)*Ze|0,b[jt++]=255}}function T$(g,t,i){const n=t.coords,o=t.colors;let l,c;switch(t.type){case"lattice":const d=t.verticesPerRow,f=Math.floor(n.length/d)-1,m=d-1;for(l=0;l<f;l++){let b=l*d;for(let T=0;T<m;T++,b++)kA(g,i,n[b],n[b+1],n[b+d],o[b],o[b+1],o[b+d]),kA(g,i,n[b+d+1],n[b+1],n[b+d],o[b+d+1],o[b+1],o[b+d])}break;case"triangles":for(l=0,c=n.length;l<c;l+=3)kA(g,i,n[l],n[l+1],n[l+2],o[l],o[l+1],o[l+2]);break;default:throw new Error("illegal figure")}}class E$ extends Qk{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[6],this._background=t[7],this.matrix=null}_createMeshCanvas(t,i,n){const d=Math.floor(this._bounds[0]),f=Math.floor(this._bounds[1]),m=Math.ceil(this._bounds[2])-d,b=Math.ceil(this._bounds[3])-f,T=Math.min(Math.ceil(Math.abs(m*t[0]*1.1)),3e3),C=Math.min(Math.ceil(Math.abs(b*t[1]*1.1)),3e3),P=m/T,x=b/C,L={coords:this._coords,colors:this._colors,offsetX:-d,offsetY:-f,scaleX:1/P,scaleY:1/x},F=T+2*2,X=C+2*2,re=n.getCanvas("mesh",F,X),K=re.context,te=K.createImageData(T,C);if(i){const A=te.data;for(let me=0,fe=A.length;me<fe;me+=4)A[me]=i[0],A[me+1]=i[1],A[me+2]=i[2],A[me+3]=255}for(const A of this._figures)T$(te,A,L);return K.putImageData(te,2,2),{canvas:re.canvas,offsetX:d-2*P,offsetY:f-2*x,scaleX:P,scaleY:x}}isModifyingCurrentTransform(){return!0}getPattern(t,i,n,o){bC(t,this._bbox);const l=new Float32Array(2);if(o===Pr.SHADING)oi.singularValueDecompose2dScale(_n(t),l);else if(this.matrix){oi.singularValueDecompose2dScale(this.matrix,l);const[d,f]=l;oi.singularValueDecompose2dScale(i.baseTransform,l),l[0]*=d,l[1]*=f}else oi.singularValueDecompose2dScale(i.baseTransform,l);const c=this._createMeshCanvas(l,o===Pr.SHADING?null:this._background,i.cachedCanvases);return o!==Pr.SHADING&&(t.setTransform(...i.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(c.offsetX,c.offsetY),t.scale(c.scaleX,c.scaleY),t.createPattern(c.canvas,"no-repeat")}}class S$ extends Qk{getPattern(){return"hotpink"}}function x$(g){switch(g[0]){case"RadialAxial":return new w$(g);case"Mesh":return new E$(g);case"Dummy":return new S$}throw new Error(`Unknown IR type: ${g[0]}`)}const QN={COLORED:1,UNCOLORED:2},ax=class ax{constructor(t,i,n,o){this.color=t[1],this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.ctx=i,this.canvasGraphicsFactory=n,this.baseTransform=o}createPatternCanvas(t){const{bbox:i,operatorList:n,paintType:o,tilingType:l,color:c,canvasGraphicsFactory:d}=this;let{xstep:f,ystep:m}=this;f=Math.abs(f),m=Math.abs(m),xx("TilingType: "+l);const b=i[0],T=i[1],C=i[2],P=i[3],x=C-b,L=P-T,F=new Float32Array(2);oi.singularValueDecompose2dScale(this.matrix,F);const[X,re]=F;oi.singularValueDecompose2dScale(this.baseTransform,F);const K=X*F[0],te=re*F[1];let ee=x,A=L,me=!1,fe=!1;const J=Math.ceil(f*K),ye=Math.ceil(m*te),Oe=Math.ceil(x*K),ot=Math.ceil(L*te);J>=Oe?ee=f:me=!0,ye>=ot?A=m:fe=!0;const Tt=this.getSizeAndScale(ee,this.ctx.canvas.width,K),dt=this.getSizeAndScale(A,this.ctx.canvas.height,te),kt=t.cachedCanvases.getCanvas("pattern",Tt.size,dt.size),$e=kt.context,vt=d.createCanvasGraphics($e);if(vt.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(vt,o,c),$e.translate(-Tt.scale*b,-dt.scale*T),vt.transform(Tt.scale,0,0,dt.scale,0,0),$e.save(),this.clipBbox(vt,b,T,C,P),vt.baseTransform=_n(vt.ctx),vt.executeOperatorList(n),vt.endDrawing(),$e.restore(),me||fe){const Jt=kt.canvas;me&&(ee=f),fe&&(A=m);const di=this.getSizeAndScale(ee,this.ctx.canvas.width,K),Ut=this.getSizeAndScale(A,this.ctx.canvas.height,te),ui=di.size,qt=Ut.size,Ze=t.cachedCanvases.getCanvas("pattern-workaround",ui,qt),ki=Ze.context,wi=me?Math.floor(x/f):0,jt=fe?Math.floor(L/m):0;for(let Yt=0;Yt<=wi;Yt++)for(let Ei=0;Ei<=jt;Ei++)ki.drawImage(Jt,ui*Yt,qt*Ei,ui,qt,0,0,ui,qt);return{canvas:Ze.canvas,scaleX:di.scale,scaleY:Ut.scale,offsetX:b,offsetY:T}}return{canvas:kt.canvas,scaleX:Tt.scale,scaleY:dt.scale,offsetX:b,offsetY:T}}getSizeAndScale(t,i,n){const o=Math.max(ax.MAX_PATTERN_SIZE,i);let l=Math.ceil(t*n);return l>=o?l=o:n=l/t,{scale:n,size:l}}clipBbox(t,i,n,o,l){const c=o-i,d=l-n;t.ctx.rect(i,n,c,d),oi.axialAlignedBoundingBox([i,n,o,l],_n(t.ctx),t.current.minMax),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,i,n){const o=t.ctx,l=t.current;switch(i){case QN.COLORED:const{fillStyle:c,strokeStyle:d}=this.ctx;o.fillStyle=l.fillColor=c,o.strokeStyle=l.strokeColor=d;break;case QN.UNCOLORED:o.fillStyle=o.strokeStyle=n,l.fillColor=l.strokeColor=n;break;default:throw new KV(`Unsupported paint type: ${i}`)}}isModifyingCurrentTransform(){return!1}getPattern(t,i,n,o){let l=n;o!==Pr.SHADING&&(l=oi.transform(l,i.baseTransform),this.matrix&&(l=oi.transform(l,this.matrix)));const c=this.createPatternCanvas(i);let d=new DOMMatrix(l);d=d.translate(c.offsetX,c.offsetY),d=d.scale(1/c.scaleX,1/c.scaleY);const f=t.createPattern(c.canvas,"repeat");return f.setTransform(d),f}};St(ax,"MAX_PATTERN_SIZE",3e3);let yC=ax;function A$({src:g,srcPos:t=0,dest:i,width:n,height:o,nonBlackColor:l=4294967295,inverseDecode:c=!1}){const d=yr.isLittleEndian?4278190080:255,[f,m]=c?[l,d]:[d,l],b=n>>3,T=n&7,C=g.length;i=new Uint32Array(i.buffer);let P=0;for(let x=0;x<o;x++){for(const F=t+b;t<F;t++){const X=t<C?g[t]:255;i[P++]=X&128?m:f,i[P++]=X&64?m:f,i[P++]=X&32?m:f,i[P++]=X&16?m:f,i[P++]=X&8?m:f,i[P++]=X&4?m:f,i[P++]=X&2?m:f,i[P++]=X&1?m:f}if(T===0)continue;const L=t<C?g[t++]:255;for(let F=0;F<T;F++)i[P++]=L&1<<7-F?m:f}return{srcPos:t,destPos:P}}const JN=16,eR=100,C$=15,tR=10,ka=16,PA=new DOMMatrix,ro=new Float32Array(2),im=new Float32Array([1/0,1/0,-1/0,-1/0]);function k$(g,t){if(g._removeMirroring)throw new Error("Context is already forwarding operations.");g.__originalSave=g.save,g.__originalRestore=g.restore,g.__originalRotate=g.rotate,g.__originalScale=g.scale,g.__originalTranslate=g.translate,g.__originalTransform=g.transform,g.__originalSetTransform=g.setTransform,g.__originalResetTransform=g.resetTransform,g.__originalClip=g.clip,g.__originalMoveTo=g.moveTo,g.__originalLineTo=g.lineTo,g.__originalBezierCurveTo=g.bezierCurveTo,g.__originalRect=g.rect,g.__originalClosePath=g.closePath,g.__originalBeginPath=g.beginPath,g._removeMirroring=()=>{g.save=g.__originalSave,g.restore=g.__originalRestore,g.rotate=g.__originalRotate,g.scale=g.__originalScale,g.translate=g.__originalTranslate,g.transform=g.__originalTransform,g.setTransform=g.__originalSetTransform,g.resetTransform=g.__originalResetTransform,g.clip=g.__originalClip,g.moveTo=g.__originalMoveTo,g.lineTo=g.__originalLineTo,g.bezierCurveTo=g.__originalBezierCurveTo,g.rect=g.__originalRect,g.closePath=g.__originalClosePath,g.beginPath=g.__originalBeginPath,delete g._removeMirroring},g.save=function(){t.save(),this.__originalSave()},g.restore=function(){t.restore(),this.__originalRestore()},g.translate=function(i,n){t.translate(i,n),this.__originalTranslate(i,n)},g.scale=function(i,n){t.scale(i,n),this.__originalScale(i,n)},g.transform=function(i,n,o,l,c,d){t.transform(i,n,o,l,c,d),this.__originalTransform(i,n,o,l,c,d)},g.setTransform=function(i,n,o,l,c,d){t.setTransform(i,n,o,l,c,d),this.__originalSetTransform(i,n,o,l,c,d)},g.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},g.rotate=function(i){t.rotate(i),this.__originalRotate(i)},g.clip=function(i){t.clip(i),this.__originalClip(i)},g.moveTo=function(i,n){t.moveTo(i,n),this.__originalMoveTo(i,n)},g.lineTo=function(i,n){t.lineTo(i,n),this.__originalLineTo(i,n)},g.bezierCurveTo=function(i,n,o,l,c,d){t.bezierCurveTo(i,n,o,l,c,d),this.__originalBezierCurveTo(i,n,o,l,c,d)},g.rect=function(i,n,o,l){t.rect(i,n,o,l),this.__originalRect(i,n,o,l)},g.closePath=function(){t.closePath(),this.__originalClosePath()},g.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}class P${constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,i,n){let o;return this.cache[t]!==void 0?(o=this.cache[t],this.canvasFactory.reset(o,i,n)):(o=this.canvasFactory.create(i,n),this.cache[t]=o),o}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const i=this.cache[t];this.canvasFactory.destroy(i),delete this.cache[t]}}}function LE(g,t,i,n,o,l,c,d,f,m){const[b,T,C,P,x,L]=_n(g);if(T===0&&C===0){const re=c*b+x,K=Math.round(re),te=d*P+L,ee=Math.round(te),A=(c+f)*b+x,me=Math.abs(Math.round(A)-K)||1,fe=(d+m)*P+L,J=Math.abs(Math.round(fe)-ee)||1;return g.setTransform(Math.sign(b),0,0,Math.sign(P),K,ee),g.drawImage(t,i,n,o,l,0,0,me,J),g.setTransform(b,T,C,P,x,L),[me,J]}if(b===0&&P===0){const re=d*C+x,K=Math.round(re),te=c*T+L,ee=Math.round(te),A=(d+m)*C+x,me=Math.abs(Math.round(A)-K)||1,fe=(c+f)*T+L,J=Math.abs(Math.round(fe)-ee)||1;return g.setTransform(0,Math.sign(T),Math.sign(C),0,K,ee),g.drawImage(t,i,n,o,l,0,0,J,me),g.setTransform(b,T,C,P,x,L),[J,me]}g.drawImage(t,i,n,o,l,c,d,f,m);const F=Math.hypot(b,T),X=Math.hypot(C,P);return[F*f,X*m]}class iR{constructor(t,i){St(this,"alphaIsShape",!1);St(this,"fontSize",0);St(this,"fontSizeScale",1);St(this,"textMatrix",null);St(this,"textMatrixScale",1);St(this,"fontMatrix",KA);St(this,"leading",0);St(this,"x",0);St(this,"y",0);St(this,"lineX",0);St(this,"lineY",0);St(this,"charSpacing",0);St(this,"wordSpacing",0);St(this,"textHScale",1);St(this,"textRenderingMode",Mr.FILL);St(this,"textRise",0);St(this,"fillColor","#000000");St(this,"strokeColor","#000000");St(this,"patternFill",!1);St(this,"patternStroke",!1);St(this,"fillAlpha",1);St(this,"strokeAlpha",1);St(this,"lineWidth",1);St(this,"activeSMask",null);St(this,"transferMaps","none");this.clipBox=new Float32Array([0,0,t,i]),this.minMax=im.slice()}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t.minMax=this.minMax.slice(),t}getPathBoundingBox(t=Pr.FILL,i=null){const n=this.minMax.slice();if(t===Pr.STROKE){i||Bs("Stroke bounding box must include transform."),oi.singularValueDecompose2dScale(i,ro);const o=ro[0]*this.lineWidth/2,l=ro[1]*this.lineWidth/2;n[0]-=o,n[1]-=l,n[2]+=o,n[3]+=l}return n}updateClipFromPath(){const t=oi.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(t){this.clipBox.set(t,0),this.minMax.set(im,0)}getClippedPathBoundingBox(t=Pr.FILL,i=null){return oi.intersect(this.clipBox,this.getPathBoundingBox(t,i))}}function sR(g,t){if(t instanceof ImageData){g.putImageData(t,0,0);return}const i=t.height,n=t.width,o=i%ka,l=(i-o)/ka,c=o===0?l:l+1,d=g.createImageData(n,ka);let f=0,m;const b=t.data,T=d.data;let C,P,x,L;if(t.kind===Jb.GRAYSCALE_1BPP){const F=b.byteLength,X=new Uint32Array(T.buffer,0,T.byteLength>>2),re=X.length,K=n+7>>3,te=4294967295,ee=yr.isLittleEndian?4278190080:255;for(C=0;C<c;C++){for(x=C<l?ka:o,m=0,P=0;P<x;P++){const A=F-f;let me=0;const fe=A>K?n:A*8-7,J=fe&-8;let ye=0,Oe=0;for(;me<J;me+=8)Oe=b[f++],X[m++]=Oe&128?te:ee,X[m++]=Oe&64?te:ee,X[m++]=Oe&32?te:ee,X[m++]=Oe&16?te:ee,X[m++]=Oe&8?te:ee,X[m++]=Oe&4?te:ee,X[m++]=Oe&2?te:ee,X[m++]=Oe&1?te:ee;for(;me<fe;me++)ye===0&&(Oe=b[f++],ye=128),X[m++]=Oe&ye?te:ee,ye>>=1}for(;m<re;)X[m++]=0;g.putImageData(d,0,C*ka)}}else if(t.kind===Jb.RGBA_32BPP){for(P=0,L=n*ka*4,C=0;C<l;C++)T.set(b.subarray(f,f+L)),f+=L,g.putImageData(d,0,P),P+=ka;C<c&&(L=n*o*4,T.set(b.subarray(f,f+L)),g.putImageData(d,0,P))}else if(t.kind===Jb.RGB_24BPP)for(x=ka,L=n*x,C=0;C<c;C++){for(C>=l&&(x=o,L=n*x),m=0,P=L;P--;)T[m++]=b[f++],T[m++]=b[f++],T[m++]=b[f++],T[m++]=255;g.putImageData(d,0,C*ka)}else throw new Error(`bad image kind: ${t.kind}`)}function nR(g,t){if(t.bitmap){g.drawImage(t.bitmap,0,0);return}const i=t.height,n=t.width,o=i%ka,l=(i-o)/ka,c=o===0?l:l+1,d=g.createImageData(n,ka);let f=0;const m=t.data,b=d.data;for(let T=0;T<c;T++){const C=T<l?ka:o;({srcPos:f}=A$({src:m,srcPos:f,dest:b,width:n,height:C,nonBlackColor:0})),g.putImageData(d,0,T*ka)}}function db(g,t){const i=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const n of i)g[n]!==void 0&&(t[n]=g[n]);g.setLineDash!==void 0&&(t.setLineDash(g.getLineDash()),t.lineDashOffset=g.lineDashOffset)}function NE(g){g.strokeStyle=g.fillStyle="#000000",g.fillRule="nonzero",g.globalAlpha=1,g.lineWidth=1,g.lineCap="butt",g.lineJoin="miter",g.miterLimit=10,g.globalCompositeOperation="source-over",g.font="10px sans-serif",g.setLineDash!==void 0&&(g.setLineDash([]),g.lineDashOffset=0);const{filter:t}=g;t!=="none"&&t!==""&&(g.filter="none")}function rR(g,t){if(t)return!0;oi.singularValueDecompose2dScale(g,ro);const i=Math.fround(Pd.pixelRatio*ng.PDF_TO_CSS_UNITS);return ro[0]<=i&&ro[1]<=i}const D$=["butt","round","square"],I$=["miter","round","bevel"],L$={},aR={};var vl,vC,wC,TC;const dP=class dP{constructor(t,i,n,o,l,{optionalContentConfig:c,markedContentStack:d=null},f,m){j(this,vl);this.ctx=t,this.current=new iR(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=i,this.objs=n,this.canvasFactory=o,this.filterFactory=l,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=d||[],this.optionalContentConfig=c,this.cachedCanvases=new P$(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=f,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=m,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(t,i=null){return typeof t=="string"?t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t):i}beginDrawing({transform:t,viewport:i,transparency:n=!1,background:o=null}){const l=this.ctx.canvas.width,c=this.ctx.canvas.height,d=this.ctx.fillStyle;if(this.ctx.fillStyle=o||"#ffffff",this.ctx.fillRect(0,0,l,c),this.ctx.fillStyle=d,n){const f=this.cachedCanvases.getCanvas("transparent",l,c);this.compositeCtx=this.ctx,this.transparentCanvas=f.canvas,this.ctx=f.context,this.ctx.save(),this.ctx.transform(..._n(this.compositeCtx))}this.ctx.save(),NE(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...i.transform),this.viewportScale=i.scale,this.baseTransform=_n(this.ctx)}executeOperatorList(t,i,n,o){const l=t.argsArray,c=t.fnArray;let d=i||0;const f=l.length;if(f===d)return d;const m=f-d>tR&&typeof n=="function",b=m?Date.now()+C$:0;let T=0;const C=this.commonObjs,P=this.objs;let x;for(;;){if(o!==void 0&&d===o.nextBreakPoint)return o.breakIt(d,n),d;if(x=c[d],x!==ry.dependency)this[x].apply(this,l[d]);else for(const L of l[d]){const F=L.startsWith("g_")?C:P;if(!F.has(L))return F.get(L,n),d}if(d++,d===f)return d;if(m&&++T>tR){if(Date.now()>b)return n(),d;T=0}}}endDrawing(){R(this,vl,vC).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const i of t.values())typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement&&(i.width=i.height=0);t.clear()}this._cachedBitmapsMap.clear(),R(this,vl,wC).call(this)}_scaleImage(t,i){const n=t.width??t.displayWidth,o=t.height??t.displayHeight;let l=Math.max(Math.hypot(i[0],i[1]),1),c=Math.max(Math.hypot(i[2],i[3]),1),d=n,f=o,m="prescale1",b,T;for(;l>2&&d>1||c>2&&f>1;){let C=d,P=f;l>2&&d>1&&(C=d>=16384?Math.floor(d/2)-1||1:Math.ceil(d/2),l/=d/C),c>2&&f>1&&(P=f>=16384?Math.floor(f/2)-1||1:Math.ceil(f)/2,c/=f/P),b=this.cachedCanvases.getCanvas(m,C,P),T=b.context,T.clearRect(0,0,C,P),T.drawImage(t,0,0,d,f,0,0,C,P),t=b.canvas,d=C,f=P,m=m==="prescale1"?"prescale2":"prescale1"}return{img:t,paintWidth:d,paintHeight:f}}_createMaskCanvas(t){const i=this.ctx,{width:n,height:o}=t,l=this.current.fillColor,c=this.current.patternFill,d=_n(i);let f,m,b,T;if((t.bitmap||t.data)&&t.count>1){const J=t.bitmap||t.data.buffer;m=JSON.stringify(c?d:[d.slice(0,4),l]),f=this._cachedBitmapsMap.get(J),f||(f=new Map,this._cachedBitmapsMap.set(J,f));const ye=f.get(m);if(ye&&!c){const Oe=Math.round(Math.min(d[0],d[2])+d[4]),ot=Math.round(Math.min(d[1],d[3])+d[5]);return{canvas:ye,offsetX:Oe,offsetY:ot}}b=ye}b||(T=this.cachedCanvases.getCanvas("maskCanvas",n,o),nR(T.context,t));let C=oi.transform(d,[1/n,0,0,-1/o,0,0]);C=oi.transform(C,[1,0,0,1,0,-o]);const P=im.slice();oi.axialAlignedBoundingBox([0,0,n,o],C,P);const[x,L,F,X]=P,re=Math.round(F-x)||1,K=Math.round(X-L)||1,te=this.cachedCanvases.getCanvas("fillCanvas",re,K),ee=te.context,A=x,me=L;ee.translate(-A,-me),ee.transform(...C),b||(b=this._scaleImage(T.canvas,Nl(ee)),b=b.img,f&&c&&f.set(m,b)),ee.imageSmoothingEnabled=rR(_n(ee),t.interpolate),LE(ee,b,0,0,b.width,b.height,0,0,n,o),ee.globalCompositeOperation="source-in";const fe=oi.transform(Nl(ee),[1,0,0,1,-A,-me]);return ee.fillStyle=c?l.getPattern(i,this,fe,Pr.FILL):l,ee.fillRect(0,0,n,o),f&&!c&&(this.cachedCanvases.delete("fillCanvas"),f.set(m,te.canvas)),{canvas:te.canvas,offsetX:Math.round(A),offsetY:Math.round(me)}}setLineWidth(t){t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(t){this.ctx.lineCap=D$[t]}setLineJoin(t){this.ctx.lineJoin=I$[t]}setMiterLimit(t){this.ctx.miterLimit=t}setDash(t,i){const n=this.ctx;n.setLineDash!==void 0&&(n.setLineDash(t),n.lineDashOffset=i)}setRenderingIntent(t){}setFlatness(t){}setGState(t){for(const[i,n]of t)switch(i){case"LW":this.setLineWidth(n);break;case"LC":this.setLineCap(n);break;case"LJ":this.setLineJoin(n);break;case"ML":this.setMiterLimit(n);break;case"D":this.setDash(n[0],n[1]);break;case"RI":this.setRenderingIntent(n);break;case"FL":this.setFlatness(n);break;case"Font":this.setFont(n[0],n[1]);break;case"CA":this.current.strokeAlpha=n;break;case"ca":this.ctx.globalAlpha=this.current.fillAlpha=n;break;case"BM":this.ctx.globalCompositeOperation=n;break;case"SMask":this.current.activeSMask=n?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(n);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,i=this.ctx.canvas.height,n="smaskGroupAt"+this.groupLevel,o=this.cachedCanvases.getCanvas(n,t,i);this.suspendedCtx=this.ctx;const l=this.ctx=o.context;l.setTransform(this.suspendedCtx.getTransform()),db(this.suspendedCtx,l),k$(l,this.suspendedCtx),this.setGState([["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),db(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const i=this.current.activeSMask,n=this.suspendedCtx;this.composeSMask(n,i,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,i,n,o){const l=o[0],c=o[1],d=o[2]-l,f=o[3]-c;d===0||f===0||(this.genericComposeSMask(i.context,n,d,f,i.subtype,i.backdrop,i.transferMap,l,c,i.offsetX,i.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(n.canvas,0,0),t.restore())}genericComposeSMask(t,i,n,o,l,c,d,f,m,b,T){let C=t.canvas,P=f-b,x=m-T;if(c)if(P<0||x<0||P+n>C.width||x+o>C.height){const F=this.cachedCanvases.getCanvas("maskExtension",n,o),X=F.context;X.drawImage(C,-P,-x),X.globalCompositeOperation="destination-atop",X.fillStyle=c,X.fillRect(0,0,n,o),X.globalCompositeOperation="source-over",C=F.canvas,P=x=0}else{t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const F=new Path2D;F.rect(P,x,n,o),t.clip(F),t.globalCompositeOperation="destination-atop",t.fillStyle=c,t.fillRect(P,x,n,o),t.restore()}i.save(),i.globalAlpha=1,i.setTransform(1,0,0,1,0,0),l==="Alpha"&&d?i.filter=this.filterFactory.addAlphaFilter(d):l==="Luminosity"&&(i.filter=this.filterFactory.addLuminosityFilter(d));const L=new Path2D;L.rect(f,m,n,o),i.clip(L),i.globalCompositeOperation="destination-in",i.drawImage(C,P,x,n,o,f,m,n,o),i.restore()}save(){this.inSMaskMode&&db(this.ctx,this.suspendedCtx),this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone()}restore(){if(this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&db(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(t,i,n,o,l,c){this.ctx.transform(t,i,n,o,l,c),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,i,n){let[o]=i;if(!n){o||(o=i[0]=new Path2D),this[t](o);return}if(!(o instanceof Path2D)){const l=i[0]=new Path2D;for(let c=0,d=o.length;c<d;)switch(o[c++]){case PE.moveTo:l.moveTo(o[c++],o[c++]);break;case PE.lineTo:l.lineTo(o[c++],o[c++]);break;case PE.curveTo:l.bezierCurveTo(o[c++],o[c++],o[c++],o[c++],o[c++],o[c++]);break;case PE.closePath:l.closePath();break;default:Ri(`Unrecognized drawing path operator: ${o[c-1]}`);break}o=l}oi.axialAlignedBoundingBox(n,_n(this.ctx),this.current.minMax),this[t](o)}closePath(){this.ctx.closePath()}stroke(t,i=!0){const n=this.ctx,o=this.current.strokeColor;if(n.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof o=="object"&&(o!=null&&o.getPattern)){const l=o.isModifyingCurrentTransform()?n.getTransform():null;if(n.save(),n.strokeStyle=o.getPattern(n,this,Nl(n),Pr.STROKE),l){const c=new Path2D;c.addPath(t,n.getTransform().invertSelf().multiplySelf(l)),t=c}this.rescaleAndStroke(t,!1),n.restore()}else this.rescaleAndStroke(t,!0);i&&this.consumePath(t,this.current.getClippedPathBoundingBox(Pr.STROKE,_n(this.ctx))),n.globalAlpha=this.current.fillAlpha}closeStroke(t){this.stroke(t)}fill(t,i=!0){const n=this.ctx,o=this.current.fillColor,l=this.current.patternFill;let c=!1;if(l){const f=o.isModifyingCurrentTransform()?n.getTransform():null;if(n.save(),n.fillStyle=o.getPattern(n,this,Nl(n),Pr.FILL),f){const m=new Path2D;m.addPath(t,n.getTransform().invertSelf().multiplySelf(f)),t=m}c=!0}const d=this.current.getClippedPathBoundingBox();this.contentVisible&&d!==null&&(this.pendingEOFill?(n.fill(t,"evenodd"),this.pendingEOFill=!1):n.fill(t)),c&&n.restore(),i&&this.consumePath(t,d)}eoFill(t){this.pendingEOFill=!0,this.fill(t)}fillStroke(t){this.fill(t,!1),this.stroke(t,!1),this.consumePath(t)}eoFillStroke(t){this.pendingEOFill=!0,this.fillStroke(t)}closeFillStroke(t){this.fillStroke(t)}closeEOFillStroke(t){this.pendingEOFill=!0,this.fillStroke(t)}endPath(t){this.consumePath(t)}rawFillPath(t){this.ctx.fill(t)}clip(){this.pendingClip=L$}eoClip(){this.pendingClip=aR}beginText(){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const t=this.pendingTextPaths,i=this.ctx;if(t===void 0)return;const n=new Path2D,o=i.getTransform().invertSelf();for(const{transform:l,x:c,y:d,fontSize:f,path:m}of t)n.addPath(m,new DOMMatrix(l).preMultiplySelf(o).translate(c,d).scale(f,-f));i.clip(n),delete this.pendingTextPaths}setCharSpacing(t){this.current.charSpacing=t}setWordSpacing(t){this.current.wordSpacing=t}setHScale(t){this.current.textHScale=t/100}setLeading(t){this.current.leading=-t}setFont(t,i){var b;const n=this.commonObjs.get(t),o=this.current;if(!n)throw new Error(`Can't find font for ${t}`);if(o.fontMatrix=n.fontMatrix||KA,(o.fontMatrix[0]===0||o.fontMatrix[3]===0)&&Ri("Invalid font matrix for font "+t),i<0?(i=-i,o.fontDirection=-1):o.fontDirection=1,this.current.font=n,this.current.fontSize=i,n.isType3Font)return;const l=n.loadedName||"sans-serif",c=((b=n.systemFontInfo)==null?void 0:b.css)||`"${l}", ${n.fallbackName}`;let d="normal";n.black?d="900":n.bold&&(d="bold");const f=n.italic?"italic":"normal";let m=i;i<JN?m=JN:i>eR&&(m=eR),this.current.fontSizeScale=i/m,this.ctx.font=`${f} ${d} ${m}px ${c}`}setTextRenderingMode(t){this.current.textRenderingMode=t}setTextRise(t){this.current.textRise=t}moveText(t,i){this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=i}setLeadingMoveText(t,i){this.setLeading(-i),this.moveText(t,i)}setTextMatrix(t){const{current:i}=this;i.textMatrix=t,i.textMatrixScale=Math.hypot(t[0],t[1]),i.x=i.lineX=0,i.y=i.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(t,i,n,o,l){const c=this.ctx,d=this.current,f=d.font,m=d.textRenderingMode,b=d.fontSize/d.fontSizeScale,T=m&Mr.FILL_STROKE_MASK,C=!!(m&Mr.ADD_TO_PATH_FLAG),P=d.patternFill&&!f.missingFile,x=d.patternStroke&&!f.missingFile;let L;if((f.disableFontFace||C||P||x)&&(L=f.getPathGenerator(this.commonObjs,t)),f.disableFontFace||P||x){c.save(),c.translate(i,n),c.scale(b,-b);let F;if((T===Mr.FILL||T===Mr.FILL_STROKE)&&(o?(F=c.getTransform(),c.setTransform(...o),c.fill(R(this,vl,TC).call(this,L,F,o))):c.fill(L)),T===Mr.STROKE||T===Mr.FILL_STROKE)if(l){F||(F=c.getTransform()),c.setTransform(...l);const{a:X,b:re,c:K,d:te}=F,ee=oi.inverseTransform(l),A=oi.transform([X,re,K,te,0,0],ee);oi.singularValueDecompose2dScale(A,ro),c.lineWidth*=Math.max(ro[0],ro[1])/b,c.stroke(R(this,vl,TC).call(this,L,F,l))}else c.lineWidth/=b,c.stroke(L);c.restore()}else(T===Mr.FILL||T===Mr.FILL_STROKE)&&c.fillText(t,i,n),(T===Mr.STROKE||T===Mr.FILL_STROKE)&&c.strokeText(t,i,n);C&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:_n(c),x:i,y:n,fontSize:b,path:L})}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const i=t.getImageData(0,0,10,10).data;let n=!1;for(let o=3;o<i.length;o+=4)if(i[o]>0&&i[o]<255){n=!0;break}return is(this,"isFontSubpixelAAEnabled",n)}showText(t){const i=this.current,n=i.font;if(n.isType3Font)return this.showType3Text(t);const o=i.fontSize;if(o===0)return;const l=this.ctx,c=i.fontSizeScale,d=i.charSpacing,f=i.wordSpacing,m=i.fontDirection,b=i.textHScale*m,T=t.length,C=n.vertical,P=C?1:-1,x=n.defaultVMetrics,L=o*i.fontMatrix[0],F=i.textRenderingMode===Mr.FILL&&!n.disableFontFace&&!i.patternFill;l.save(),i.textMatrix&&l.transform(...i.textMatrix),l.translate(i.x,i.y+i.textRise),m>0?l.scale(b,-1):l.scale(b,1);let X,re;if(i.patternFill){l.save();const me=i.fillColor.getPattern(l,this,Nl(l),Pr.FILL);X=_n(l),l.restore(),l.fillStyle=me}if(i.patternStroke){l.save();const me=i.strokeColor.getPattern(l,this,Nl(l),Pr.STROKE);re=_n(l),l.restore(),l.strokeStyle=me}let K=i.lineWidth;const te=i.textMatrixScale;if(te===0||K===0){const me=i.textRenderingMode&Mr.FILL_STROKE_MASK;(me===Mr.STROKE||me===Mr.FILL_STROKE)&&(K=this.getSinglePixelWidth())}else K/=te;if(c!==1&&(l.scale(c,c),K/=c),l.lineWidth=K,n.isInvalidPDFjsFont){const me=[];let fe=0;for(const J of t)me.push(J.unicode),fe+=J.width;l.fillText(me.join(""),0,0),i.x+=fe*L*b,l.restore(),this.compose();return}let ee=0,A;for(A=0;A<T;++A){const me=t[A];if(typeof me=="number"){ee+=P*me*o/1e3;continue}let fe=!1;const J=(me.isSpace?f:0)+d,ye=me.fontChar,Oe=me.accent;let ot,Tt,dt=me.width;if(C){const $e=me.vmetric||x,vt=-(me.vmetric?$e[1]:dt*.5)*L,Jt=$e[2]*L;dt=$e?-$e[0]:dt,ot=vt/c,Tt=(ee+Jt)/c}else ot=ee/c,Tt=0;if(n.remeasure&&dt>0){const $e=l.measureText(ye).width*1e3/o*c;if(dt<$e&&this.isFontSubpixelAAEnabled){const vt=dt/$e;fe=!0,l.save(),l.scale(vt,1),ot/=vt}else dt!==$e&&(ot+=(dt-$e)/2e3*o/c)}if(this.contentVisible&&(me.isInFont||n.missingFile)){if(F&&!Oe)l.fillText(ye,ot,Tt);else if(this.paintChar(ye,ot,Tt,X,re),Oe){const $e=ot+o*Oe.offset.x/c,vt=Tt-o*Oe.offset.y/c;this.paintChar(Oe.fontChar,$e,vt,X,re)}}const kt=C?dt*L-J*m:dt*L+J*m;ee+=kt,fe&&l.restore()}C?i.y-=ee:i.x+=ee*b,l.restore(),this.compose()}showType3Text(t){const i=this.ctx,n=this.current,o=n.font,l=n.fontSize,c=n.fontDirection,d=o.vertical?1:-1,f=n.charSpacing,m=n.wordSpacing,b=n.textHScale*c,T=n.fontMatrix||KA,C=t.length,P=n.textRenderingMode===Mr.INVISIBLE;let x,L,F,X;if(!(P||l===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,i.save(),n.textMatrix&&i.transform(...n.textMatrix),i.translate(n.x,n.y+n.textRise),i.scale(b,c),x=0;x<C;++x){if(L=t[x],typeof L=="number"){X=d*L*l/1e3,this.ctx.translate(X,0),n.x+=X*b;continue}const re=(L.isSpace?m:0)+f,K=o.charProcOperatorList[L.operatorListId];K?this.contentVisible&&(this.save(),i.scale(l,l),i.transform(...T),this.executeOperatorList(K),this.restore()):Ri(`Type3 character "${L.operatorListId}" is not available.`);const te=[L.width,0];oi.applyTransform(te,T),F=te[0]*l+re,i.translate(F,0),n.x+=F*b}i.restore()}}setCharWidth(t,i){}setCharWidthAndBounds(t,i,n,o,l,c){const d=new Path2D;d.rect(n,o,l-n,c-o),this.ctx.clip(d),this.endPath()}getColorN_Pattern(t){let i;if(t[0]==="TilingPattern"){const n=this.baseTransform||_n(this.ctx),o={createCanvasGraphics:l=>new dP(l,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};i=new yC(t,this.ctx,o,n)}else i=this._getPattern(t[1],t[2]);return i}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(t){this.ctx.strokeStyle=this.current.strokeColor=t,this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(t){this.ctx.fillStyle=this.current.fillColor=t,this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(t,i=null){let n;return this.cachedPatterns.has(t)?n=this.cachedPatterns.get(t):(n=x$(this.getObject(t)),this.cachedPatterns.set(t,n)),i&&(n.matrix=i),n}shadingFill(t){if(!this.contentVisible)return;const i=this.ctx;this.save();const n=this._getPattern(t);i.fillStyle=n.getPattern(i,this,Nl(i),Pr.SHADING);const o=Nl(i);if(o){const{width:l,height:c}=i.canvas,d=im.slice();oi.axialAlignedBoundingBox([0,0,l,c],o,d);const[f,m,b,T]=d;this.ctx.fillRect(f,m,b-f,T-m)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){Bs("Should not call beginInlineImage")}beginImageData(){Bs("Should not call beginImageData")}paintFormXObjectBegin(t,i){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),t&&this.transform(...t),this.baseTransform=_n(this.ctx),i)){oi.axialAlignedBoundingBox(i,this.baseTransform,this.current.minMax);const[n,o,l,c]=i,d=new Path2D;d.rect(n,o,l-n,c-o),this.ctx.clip(d),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const i=this.ctx;t.isolated||xx("TODO: Support non-isolated groups."),t.knockout&&Ri("Knockout groups not supported.");const n=_n(i);if(t.matrix&&i.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let o=im.slice();oi.axialAlignedBoundingBox(t.bbox,_n(i),o);const l=[0,0,i.canvas.width,i.canvas.height];o=oi.intersect(o,l)||[0,0,0,0];const c=Math.floor(o[0]),d=Math.floor(o[1]),f=Math.max(Math.ceil(o[2])-c,1),m=Math.max(Math.ceil(o[3])-d,1);this.current.startNewPathAndClipBox([0,0,f,m]);let b="groupAt"+this.groupLevel;t.smask&&(b+="_smask_"+this.smaskCounter++%2);const T=this.cachedCanvases.getCanvas(b,f,m),C=T.context;C.translate(-c,-d),C.transform(...n);let P=new Path2D;const[x,L,F,X]=t.bbox;if(P.rect(x,L,F-x,X-L),t.matrix){const re=new Path2D;re.addPath(P,new DOMMatrix(t.matrix)),P=re}C.clip(P),t.smask?this.smaskStack.push({canvas:T.canvas,context:C,offsetX:c,offsetY:d,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}):(i.setTransform(1,0,0,1,0,0),i.translate(c,d),i.save()),db(i,C),this.ctx=C,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(i),this.groupLevel++}endGroup(t){if(!this.contentVisible)return;this.groupLevel--;const i=this.ctx,n=this.groupStack.pop();if(this.ctx=n,this.ctx.imageSmoothingEnabled=!1,t.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const o=_n(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...o);const l=im.slice();oi.axialAlignedBoundingBox([0,0,i.canvas.width,i.canvas.height],o,l),this.ctx.drawImage(i.canvas,0,0),this.ctx.restore(),this.compose(l)}}beginAnnotation(t,i,n,o,l){if(R(this,vl,vC).call(this),NE(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),i){const c=i[2]-i[0],d=i[3]-i[1];if(l&&this.annotationCanvasMap){n=n.slice(),n[4]-=i[0],n[5]-=i[1],i=i.slice(),i[0]=i[1]=0,i[2]=c,i[3]=d,oi.singularValueDecompose2dScale(_n(this.ctx),ro);const{viewportScale:f}=this,m=Math.ceil(c*this.outputScaleX*f),b=Math.ceil(d*this.outputScaleY*f);this.annotationCanvas=this.canvasFactory.create(m,b);const{canvas:T,context:C}=this.annotationCanvas;this.annotationCanvasMap.set(t,T),this.annotationCanvas.savedCtx=this.ctx,this.ctx=C,this.ctx.save(),this.ctx.setTransform(ro[0],0,0,-ro[1],0,d*ro[1]),NE(this.ctx)}else{NE(this.ctx),this.endPath();const f=new Path2D;f.rect(i[0],i[1],c,d),this.ctx.clip(f)}}this.current=new iR(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...n),this.transform(...o)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),R(this,vl,wC).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t){if(!this.contentVisible)return;const i=t.count;t=this.getObject(t.data,t),t.count=i;const n=this.ctx,o=this._createMaskCanvas(t),l=o.canvas;n.save(),n.setTransform(1,0,0,1,0,0),n.drawImage(l,o.offsetX,o.offsetY),n.restore(),this.compose()}paintImageMaskXObjectRepeat(t,i,n=0,o=0,l,c){if(!this.contentVisible)return;t=this.getObject(t.data,t);const d=this.ctx;d.save();const f=_n(d);d.transform(i,n,o,l,0,0);const m=this._createMaskCanvas(t);d.setTransform(1,0,0,1,m.offsetX-f[4],m.offsetY-f[5]);for(let b=0,T=c.length;b<T;b+=2){const C=oi.transform(f,[i,n,o,l,c[b],c[b+1]]);d.drawImage(m.canvas,C[4],C[5])}d.restore(),this.compose()}paintImageMaskXObjectGroup(t){if(!this.contentVisible)return;const i=this.ctx,n=this.current.fillColor,o=this.current.patternFill;for(const l of t){const{data:c,width:d,height:f,transform:m}=l,b=this.cachedCanvases.getCanvas("maskCanvas",d,f),T=b.context;T.save();const C=this.getObject(c,l);nR(T,C),T.globalCompositeOperation="source-in",T.fillStyle=o?n.getPattern(T,this,Nl(i),Pr.FILL):n,T.fillRect(0,0,d,f),T.restore(),i.save(),i.transform(...m),i.scale(1,-1),LE(i,b.canvas,0,0,d,f,0,-1,1,1),i.restore()}this.compose()}paintImageXObject(t){if(!this.contentVisible)return;const i=this.getObject(t);if(!i){Ri("Dependent image isn't ready yet");return}this.paintInlineImageXObject(i)}paintImageXObjectRepeat(t,i,n,o){if(!this.contentVisible)return;const l=this.getObject(t);if(!l){Ri("Dependent image isn't ready yet");return}const c=l.width,d=l.height,f=[];for(let m=0,b=o.length;m<b;m+=2)f.push({transform:[i,0,0,n,o[m],o[m+1]],x:0,y:0,w:c,h:d});this.paintInlineImageXObjectGroup(l,f)}applyTransferMapsToCanvas(t){return this.current.transferMaps!=="none"&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if(this.current.transferMaps==="none")return t.bitmap;const{bitmap:i,width:n,height:o}=t,l=this.cachedCanvases.getCanvas("inlineImage",n,o),c=l.context;return c.filter=this.current.transferMaps,c.drawImage(i,0,0),c.filter="none",l.canvas}paintInlineImageXObject(t){if(!this.contentVisible)return;const i=t.width,n=t.height,o=this.ctx;this.save();const{filter:l}=o;l!=="none"&&l!==""&&(o.filter="none"),o.scale(1/i,-1/n);let c;if(t.bitmap)c=this.applyTransferMapsToBitmap(t);else if(typeof HTMLElement=="function"&&t instanceof HTMLElement||!t.data)c=t;else{const m=this.cachedCanvases.getCanvas("inlineImage",i,n).context;sR(m,t),c=this.applyTransferMapsToCanvas(m)}const d=this._scaleImage(c,Nl(o));o.imageSmoothingEnabled=rR(_n(o),t.interpolate),LE(o,d.img,0,0,d.paintWidth,d.paintHeight,0,-n,i,n),this.compose(),this.restore()}paintInlineImageXObjectGroup(t,i){if(!this.contentVisible)return;const n=this.ctx;let o;if(t.bitmap)o=t.bitmap;else{const l=t.width,c=t.height,f=this.cachedCanvases.getCanvas("inlineImage",l,c).context;sR(f,t),o=this.applyTransferMapsToCanvas(f)}for(const l of i)n.save(),n.transform(...l.transform),n.scale(1,-1),LE(n,o,l.x,l.y,l.w,l.h,0,-1,1,1),n.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t){}markPointProps(t,i){}beginMarkedContent(t){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,i){t==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(i)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(t,i){const n=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(i);const o=this.ctx;this.pendingClip&&(n||(this.pendingClip===aR?o.clip(t,"evenodd"):o.clip(t)),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=_n(this.ctx);if(t[1]===0&&t[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const i=Math.abs(t[0]*t[3]-t[2]*t[1]),n=Math.hypot(t[0],t[2]),o=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(n,o)/i}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:t}=this.current,{a:i,b:n,c:o,d:l}=this.ctx.getTransform();let c,d;if(n===0&&o===0){const f=Math.abs(i),m=Math.abs(l);if(f===m)if(t===0)c=d=1/f;else{const b=f*t;c=d=b<1?1/b:1}else if(t===0)c=1/f,d=1/m;else{const b=f*t,T=m*t;c=b<1?1/b:1,d=T<1?1/T:1}}else{const f=Math.abs(i*l-n*o),m=Math.hypot(i,n),b=Math.hypot(o,l);if(t===0)c=b/f,d=m/f;else{const T=t*f;c=b>T?b/T:1,d=m>T?m/T:1}}this._cachedScaleForStroking[0]=c,this._cachedScaleForStroking[1]=d}return this._cachedScaleForStroking}rescaleAndStroke(t,i){const{ctx:n,current:{lineWidth:o}}=this,[l,c]=this.getScaleForStroking();if(l===c){n.lineWidth=(o||1)*l,n.stroke(t);return}const d=n.getLineDash();i&&n.save(),n.scale(l,c),PA.a=1/l,PA.d=1/c;const f=new Path2D;if(f.addPath(t,PA),d.length>0){const m=Math.max(l,c);n.setLineDash(d.map(b=>b/m)),n.lineDashOffset/=m}n.lineWidth=o||1,n.stroke(f),i&&n.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}};vl=new WeakSet,vC=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},wC=function(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(t!=="none"){const i=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=i}}},TC=function(t,i,n){const o=new Path2D;return o.addPath(t,new DOMMatrix(n).invertSelf().multiplySelf(i)),o};let rm=dP;for(const g in ry)rm.prototype[g]!==void 0&&(rm.prototype[ry[g]]=rm.prototype[g]);var WE,Uy,jy;let oc=(WE=class{static get workerPort(){return u(this,Uy)}static set workerPort(t){if(!(typeof Worker<"u"&&t instanceof Worker)&&t!==null)throw new Error("Invalid `workerPort` type.");D(this,Uy,t)}static get workerSrc(){return u(this,jy)}static set workerSrc(t){if(typeof t!="string")throw new Error("Invalid `workerSrc` type.");D(this,jy,t)}},Uy=new WeakMap,jy=new WeakMap,j(WE,Uy,null),j(WE,jy,""),WE);var km,Hy;class N${constructor({parsedData:t,rawData:i}){j(this,km);j(this,Hy);D(this,km,t),D(this,Hy,i)}getRaw(){return u(this,Hy)}get(t){return u(this,km).get(t)??null}[Symbol.iterator](){return u(this,km).entries()}}km=new WeakMap,Hy=new WeakMap;const Kg=Symbol("INTERNAL");var Vy,$y,zy,Pm;class R${constructor(t,{name:i,intent:n,usage:o,rbGroups:l}){j(this,Vy,!1);j(this,$y,!1);j(this,zy,!1);j(this,Pm,!0);D(this,Vy,!!(t&so.DISPLAY)),D(this,$y,!!(t&so.PRINT)),this.name=i,this.intent=n,this.usage=o,this.rbGroups=l}get visible(){if(u(this,zy))return u(this,Pm);if(!u(this,Pm))return!1;const{print:t,view:i}=this.usage;return u(this,Vy)?(i==null?void 0:i.viewState)!=="OFF":u(this,$y)?(t==null?void 0:t.printState)!=="OFF":!0}_setVisible(t,i,n=!1){t!==Kg&&Bs("Internal method `_setVisible` called."),D(this,zy,n),D(this,Pm,i)}}Vy=new WeakMap,$y=new WeakMap,zy=new WeakMap,Pm=new WeakMap;var Ec,Os,Dm,Im,Wy,EC;class M${constructor(t,i=so.DISPLAY){j(this,Wy);j(this,Ec,null);j(this,Os,new Map);j(this,Dm,null);j(this,Im,null);if(this.renderingIntent=i,this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,D(this,Im,t.order);for(const n of t.groups)u(this,Os).set(n.id,new R$(i,n));if(t.baseState==="OFF")for(const n of u(this,Os).values())n._setVisible(Kg,!1);for(const n of t.on)u(this,Os).get(n)._setVisible(Kg,!0);for(const n of t.off)u(this,Os).get(n)._setVisible(Kg,!1);D(this,Dm,this.getHash())}}isVisible(t){if(u(this,Os).size===0)return!0;if(!t)return xx("Optional content group not defined."),!0;if(t.type==="OCG")return u(this,Os).has(t.id)?u(this,Os).get(t.id).visible:(Ri(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return R(this,Wy,EC).call(this,t.expression);if(!t.policy||t.policy==="AnyOn"){for(const i of t.ids){if(!u(this,Os).has(i))return Ri(`Optional content group not found: ${i}`),!0;if(u(this,Os).get(i).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const i of t.ids){if(!u(this,Os).has(i))return Ri(`Optional content group not found: ${i}`),!0;if(!u(this,Os).get(i).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const i of t.ids){if(!u(this,Os).has(i))return Ri(`Optional content group not found: ${i}`),!0;if(!u(this,Os).get(i).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const i of t.ids){if(!u(this,Os).has(i))return Ri(`Optional content group not found: ${i}`),!0;if(u(this,Os).get(i).visible)return!1}return!0}return Ri(`Unknown optional content policy ${t.policy}.`),!0}return Ri(`Unknown group type ${t.type}.`),!0}setVisibility(t,i=!0,n=!0){var l;const o=u(this,Os).get(t);if(!o){Ri(`Optional content group not found: ${t}`);return}if(n&&i&&o.rbGroups.length)for(const c of o.rbGroups)for(const d of c)d!==t&&((l=u(this,Os).get(d))==null||l._setVisible(Kg,!1,!0));o._setVisible(Kg,!!i,!0),D(this,Ec,null)}setOCGState({state:t,preserveRB:i}){let n;for(const o of t){switch(o){case"ON":case"OFF":case"Toggle":n=o;continue}const l=u(this,Os).get(o);if(l)switch(n){case"ON":this.setVisibility(o,!0,i);break;case"OFF":this.setVisibility(o,!1,i);break;case"Toggle":this.setVisibility(o,!l.visible,i);break}}D(this,Ec,null)}get hasInitialVisibility(){return u(this,Dm)===null||this.getHash()===u(this,Dm)}getOrder(){return u(this,Os).size?u(this,Im)?u(this,Im).slice():[...u(this,Os).keys()]:null}getGroup(t){return u(this,Os).get(t)||null}getHash(){if(u(this,Ec)!==null)return u(this,Ec);const t=new GM;for(const[i,n]of u(this,Os))t.update(`${i}:${n.visible}`);return D(this,Ec,t.hexdigest())}[Symbol.iterator](){return u(this,Os).entries()}}Ec=new WeakMap,Os=new WeakMap,Dm=new WeakMap,Im=new WeakMap,Wy=new WeakSet,EC=function(t){const i=t.length;if(i<2)return!0;const n=t[0];for(let o=1;o<i;o++){const l=t[o];let c;if(Array.isArray(l))c=R(this,Wy,EC).call(this,l);else if(u(this,Os).has(l))c=u(this,Os).get(l).visible;else return Ri(`Optional content group not found: ${l}`),!0;switch(n){case"And":if(!c)return!1;break;case"Or":if(c)return!0;break;case"Not":return!c;default:return!0}}return n==="And"};class O${constructor(t,{disableRange:i=!1,disableStream:n=!1}){Vn(t,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:o,initialData:l,progressiveDone:c,contentDispositionFilename:d}=t;if(this._queuedChunks=[],this._progressiveDone=c,this._contentDispositionFilename=d,(l==null?void 0:l.length)>0){const f=l instanceof Uint8Array&&l.byteLength===l.buffer.byteLength?l.buffer:new Uint8Array(l).buffer;this._queuedChunks.push(f)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!n,this._isRangeSupported=!i,this._contentLength=o,this._fullRequestReader=null,this._rangeReaders=[],t.addRangeListener((f,m)=>{this._onReceiveData({begin:f,chunk:m})}),t.addProgressListener((f,m)=>{this._onProgress({loaded:f,total:m})}),t.addProgressiveReadListener(f=>{this._onReceiveData({chunk:f})}),t.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),t.transportReady()}_onReceiveData({begin:t,chunk:i}){const n=i instanceof Uint8Array&&i.byteLength===i.buffer.byteLength?i.buffer:new Uint8Array(i).buffer;if(t===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(n):this._queuedChunks.push(n);else{const o=this._rangeReaders.some(function(l){return l._begin!==t?!1:(l._enqueue(n),!0)});Vn(o,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}_onProgress(t){var i,n,o,l;t.total===void 0?(n=(i=this._rangeReaders[0])==null?void 0:i.onProgress)==null||n.call(i,{loaded:t.loaded}):(l=(o=this._fullRequestReader)==null?void 0:o.onProgress)==null||l.call(o,{loaded:t.loaded,total:t.total})}_onProgressiveDone(){var t;(t=this._fullRequestReader)==null||t.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(t){const i=this._rangeReaders.indexOf(t);i>=0&&this._rangeReaders.splice(i,1)}getFullReader(){Vn(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;return this._queuedChunks=null,new F$(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,i){if(i<=this._progressiveDataLength)return null;const n=new B$(this,t,i);return this._pdfDataRangeTransport.requestDataRange(t,i),this._rangeReaders.push(n),n}cancelAllRequests(t){var i;(i=this._fullRequestReader)==null||i.cancel(t);for(const n of this._rangeReaders.slice(0))n.cancel(t);this._pdfDataRangeTransport.abort()}}class F${constructor(t,i,n=!1,o=null){this._stream=t,this._done=n||!1,this._filename=Cx(o)?o:null,this._queuedChunks=i||[],this._loaded=0;for(const l of this._queuedChunks)this._loaded+=l.byteLength;this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class B${constructor(t,i,n){this._stream=t,this._begin=i,this._end=n,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(t){if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const i=this._queuedChunk;return this._queuedChunk=null,{value:i,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function U$(g){let t=!0,i=n("filename\\*","i").exec(g);if(i){i=i[1];let b=d(i);return b=unescape(b),b=f(b),b=m(b),l(b)}if(i=c(g),i){const b=m(i);return l(b)}if(i=n("filename","i").exec(g),i){i=i[1];let b=d(i);return b=m(b),l(b)}function n(b,T){return new RegExp("(?:^|;)\\s*"+b+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',T)}function o(b,T){if(b){if(!/^[\x00-\xFF]+$/.test(T))return T;try{const C=new TextDecoder(b,{fatal:!0}),P=rT(T);T=C.decode(P),t=!1}catch{}}return T}function l(b){return t&&/[\x80-\xff]/.test(b)&&(b=o("utf-8",b),t&&(b=o("iso-8859-1",b))),b}function c(b){const T=[];let C;const P=n("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(C=P.exec(b))!==null;){let[,L,F,X]=C;if(L=parseInt(L,10),L in T){if(L===0)break;continue}T[L]=[F,X]}const x=[];for(let L=0;L<T.length&&L in T;++L){let[F,X]=T[L];X=d(X),F&&(X=unescape(X),L===0&&(X=f(X))),x.push(X)}return x.join("")}function d(b){if(b.startsWith('"')){const T=b.slice(1).split('\\"');for(let C=0;C<T.length;++C){const P=T[C].indexOf('"');P!==-1&&(T[C]=T[C].slice(0,P),T.length=C+1),T[C]=T[C].replaceAll(/\\(.)/g,"$1")}b=T.join('"')}return b}function f(b){const T=b.indexOf("'");if(T===-1)return b;const C=b.slice(0,T),x=b.slice(T+1).replace(/^[^']*'/,"");return o(C,x)}function m(b){return!b.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(b)?b:b.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(T,C,P,x){if(P==="q"||P==="Q")return x=x.replaceAll("_"," "),x=x.replaceAll(/=([0-9a-fA-F]{2})/g,function(L,F){return String.fromCharCode(parseInt(F,16))}),o(C,x);try{x=atob(x)}catch{}return o(C,x)})}return""}function aO(g,t){const i=new Headers;if(!g||!t||typeof t!="object")return i;for(const n in t){const o=t[n];o!==void 0&&i.append(n,o)}return i}function kx(g){var t;return((t=URL.parse(g))==null?void 0:t.origin)??null}function oO({responseHeaders:g,isHttp:t,rangeChunkSize:i,disableRange:n}){const o={allowRangeRequests:!1,suggestedLength:void 0},l=parseInt(g.get("Content-Length"),10);return!Number.isInteger(l)||(o.suggestedLength=l,l<=2*i)||n||!t||g.get("Accept-Ranges")!=="bytes"||(g.get("Content-Encoding")||"identity")!=="identity"||(o.allowRangeRequests=!0),o}function lO(g){const t=g.get("Content-Disposition");if(t){let i=U$(t);if(i.includes("%"))try{i=decodeURIComponent(i)}catch{}if(Cx(i))return i}return null}function uT(g,t){return new ay(`Unexpected server response (${g}) while retrieving PDF "${t}".`,g,g===404||g===0&&t.startsWith("file:"))}function uO(g){return g===200||g===206}function hO(g,t,i){return{method:"GET",headers:g,signal:i.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function cO(g){return g instanceof Uint8Array?g.buffer:g instanceof ArrayBuffer?g:(Ri(`getArrayBuffer - unexpected data format: ${g}`),new Uint8Array(g).buffer)}class j${constructor(t){St(this,"_responseOrigin",null);this.source=t,this.isHttp=/^https?:/i.test(t.url),this.headers=aO(this.isHttp,t.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}getFullReader(){return Vn(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new H$(this),this._fullRequestReader}getRangeReader(t,i){if(i<=this._progressiveDataLength)return null;const n=new V$(this,t,i);return this._rangeRequestReaders.push(n),n}cancelAllRequests(t){var i;(i=this._fullRequestReader)==null||i.cancel(t);for(const n of this._rangeRequestReaders.slice(0))n.cancel(t)}}class H${constructor(t){this._stream=t,this._reader=null,this._loaded=0,this._filename=null;const i=t.source;this._withCredentials=i.withCredentials||!1,this._contentLength=i.length,this._headersCapability=Promise.withResolvers(),this._disableRange=i.disableRange||!1,this._rangeChunkSize=i.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!i.disableStream,this._isRangeSupported=!i.disableRange;const n=new Headers(t.headers),o=i.url;fetch(o,hO(n,this._withCredentials,this._abortController)).then(l=>{if(t._responseOrigin=kx(l.url),!uO(l.status))throw uT(l.status,o);this._reader=l.body.getReader(),this._headersCapability.resolve();const c=l.headers,{allowRangeRequests:d,suggestedLength:f}=oO({responseHeaders:c,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=d,this._contentLength=f||this._contentLength,this._filename=lO(c),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Mh("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;await this._headersCapability.promise;const{value:t,done:i}=await this._reader.read();return i?{value:t,done:i}:(this._loaded+=t.byteLength,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded,total:this._contentLength}),{value:cO(t),done:!1})}cancel(t){var i;(i=this._reader)==null||i.cancel(t),this._abortController.abort()}}class V${constructor(t,i,n){this._stream=t,this._reader=null,this._loaded=0;const o=t.source;this._withCredentials=o.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!o.disableStream,this._abortController=new AbortController;const l=new Headers(t.headers);l.append("Range",`bytes=${i}-${n-1}`);const c=o.url;fetch(c,hO(l,this._withCredentials,this._abortController)).then(d=>{const f=kx(d.url);if(f!==t._responseOrigin)throw new Error(`Expected range response-origin "${f}" to match "${t._responseOrigin}".`);if(!uO(d.status))throw uT(d.status,c);this._readCapability.resolve(),this._reader=d.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;await this._readCapability.promise;const{value:t,done:i}=await this._reader.read();return i?{value:t,done:i}:(this._loaded+=t.byteLength,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded}),{value:cO(t),done:!1})}cancel(t){var i;(i=this._reader)==null||i.cancel(t),this._abortController.abort()}}const DA=200,IA=206;function $$(g){const t=g.response;return typeof t!="string"?t:rT(t).buffer}class z${constructor({url:t,httpHeaders:i,withCredentials:n}){St(this,"_responseOrigin",null);this.url=t,this.isHttp=/^https?:/i.test(t),this.headers=aO(this.isHttp,i),this.withCredentials=n||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(t){const i=new XMLHttpRequest,n=this.currXhrId++,o=this.pendingRequests[n]={xhr:i};i.open("GET",this.url),i.withCredentials=this.withCredentials;for(const[l,c]of this.headers)i.setRequestHeader(l,c);return this.isHttp&&"begin"in t&&"end"in t?(i.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),o.expectedStatus=IA):o.expectedStatus=DA,i.responseType="arraybuffer",Vn(t.onError,"Expected `onError` callback to be provided."),i.onerror=()=>{t.onError(i.status)},i.onreadystatechange=this.onStateChange.bind(this,n),i.onprogress=this.onProgress.bind(this,n),o.onHeadersReceived=t.onHeadersReceived,o.onDone=t.onDone,o.onError=t.onError,o.onProgress=t.onProgress,i.send(null),n}onProgress(t,i){var o;const n=this.pendingRequests[t];n&&((o=n.onProgress)==null||o.call(n,i))}onStateChange(t,i){const n=this.pendingRequests[t];if(!n)return;const o=n.xhr;if(o.readyState>=2&&n.onHeadersReceived&&(n.onHeadersReceived(),delete n.onHeadersReceived),o.readyState!==4||!(t in this.pendingRequests))return;if(delete this.pendingRequests[t],o.status===0&&this.isHttp){n.onError(o.status);return}const l=o.status||DA;if(!(l===DA&&n.expectedStatus===IA)&&l!==n.expectedStatus){n.onError(o.status);return}const d=$$(o);if(l===IA){const f=o.getResponseHeader("Content-Range"),m=/bytes (\d+)-(\d+)\/(\d+)/.exec(f);m?n.onDone({begin:parseInt(m[1],10),chunk:d}):(Ri('Missing or invalid "Content-Range" header.'),n.onError(0))}else d?n.onDone({begin:0,chunk:d}):n.onError(o.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const i=this.pendingRequests[t].xhr;delete this.pendingRequests[t],i.abort()}}class W${constructor(t){this._source=t,this._manager=new z$(t),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const i=this._rangeRequestReaders.indexOf(t);i>=0&&this._rangeRequestReaders.splice(i,1)}getFullReader(){return Vn(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new q$(this._manager,this._source),this._fullRequestReader}getRangeReader(t,i){const n=new G$(this._manager,t,i);return n.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(n),n}cancelAllRequests(t){var i;(i=this._fullRequestReader)==null||i.cancel(t);for(const n of this._rangeRequestReaders.slice(0))n.cancel(t)}}class q${constructor(t,i){this._manager=t,this._url=i.url,this._fullRequestId=t.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=i.disableRange||!1,this._contentLength=i.length,this._rangeChunkSize=i.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,i=this._manager.getRequestXhr(t);this._manager._responseOrigin=kx(i.responseURL);const n=i.getAllResponseHeaders(),o=new Headers(n?n.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(d=>{const[f,...m]=d.split(": ");return[f,m.join(": ")]}):[]),{allowRangeRequests:l,suggestedLength:c}=oO({responseHeaders:o,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});l&&(this._isRangeSupported=!0),this._contentLength=c||this._contentLength,this._filename=lO(o),this._isRangeSupported&&this._manager.abortRequest(t),this._headersCapability.resolve()}_onDone(t){if(t&&(this._requests.length>0?this._requests.shift().resolve({value:t.chunk,done:!1}):this._cachedChunks.push(t.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){this._storedError=uT(t,this._url),this._headersCapability.reject(this._storedError);for(const i of this._requests)i.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(t){var i;(i=this.onProgress)==null||i.call(this,{loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class G${constructor(t,i,n){this._manager=t,this._url=t.url,this._requestId=t.request({begin:i,end:n,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){var i;const t=kx((i=this._manager.getRequestXhr(this._requestId))==null?void 0:i.responseURL);t!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${t}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){var t;(t=this.onClosed)==null||t.call(this,this)}_onDone(t){const i=t.chunk;this._requests.length>0?this._requests.shift().resolve({value:i,done:!1}):this._queuedChunk=i,this._done=!0;for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(t){this._storedError??(this._storedError=uT(t,this._url));for(const i of this._requests)i.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(t){var i;this.isStreamingSupported||(i=this.onProgress)==null||i.call(this,{loaded:t.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const i=this._queuedChunk;return this._queuedChunk=null,{value:i,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const X$=/^[a-z][a-z0-9\-+.]+:/i;function K$(g){if(X$.test(g))return new URL(g);const t=process.getBuiltinModule("url");return new URL(t.pathToFileURL(g))}class Y${constructor(t){this.source=t,this.url=K$(t.url),Vn(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}getFullReader(){return Vn(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new Z$(this),this._fullRequestReader}getRangeReader(t,i){if(i<=this._progressiveDataLength)return null;const n=new Q$(this,t,i);return this._rangeRequestReaders.push(n),n}cancelAllRequests(t){var i;(i=this._fullRequestReader)==null||i.cancel(t);for(const n of this._rangeRequestReaders.slice(0))n.cancel(t)}}class Z${constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;const i=t.source;this._contentLength=i.length,this._loaded=0,this._filename=null,this._disableRange=i.disableRange||!1,this._rangeChunkSize=i.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!i.disableStream,this._isRangeSupported=!i.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const n=process.getBuiltinModule("fs");n.promises.lstat(this._url).then(o=>{this._contentLength=o.size,this._setReadableStream(n.createReadStream(this._url)),this._headersCapability.resolve()},o=>{o.code==="ENOENT"&&(o=uT(0,this._url.href)),this._storedError=o,this._headersCapability.reject(o)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",i=>{this._error(i)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Mh("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class Q${constructor(t,i,n){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const o=t.source;this._isStreamingSupported=!o.disableStream;const l=process.getBuiltinModule("fs");this._setReadableStream(l.createReadStream(this._url,{start:i,end:n-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",i=>{this._error(i)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const fb=Symbol("INITIAL_DATA");var $a,qy,SC;class dO{constructor(){j(this,qy);j(this,$a,Object.create(null))}get(t,i=null){if(i){const o=R(this,qy,SC).call(this,t);return o.promise.then(()=>i(o.data)),null}const n=u(this,$a)[t];if(!n||n.data===fb)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return n.data}has(t){const i=u(this,$a)[t];return!!i&&i.data!==fb}delete(t){const i=u(this,$a)[t];return!i||i.data===fb?!1:(delete u(this,$a)[t],!0)}resolve(t,i=null){const n=R(this,qy,SC).call(this,t);n.data=i,n.resolve()}clear(){var t;for(const i in u(this,$a)){const{data:n}=u(this,$a)[i];(t=n==null?void 0:n.bitmap)==null||t.close()}D(this,$a,Object.create(null))}*[Symbol.iterator](){for(const t in u(this,$a)){const{data:i}=u(this,$a)[t];i!==fb&&(yield[t,i])}}}$a=new WeakMap,qy=new WeakSet,SC=function(t){var i;return(i=u(this,$a))[t]||(i[t]={...Promise.withResolvers(),data:fb})};const J$=1e5,oR=30;var rM,Sc,wa,Gy,Xy,Nf,Wu,Ky,Yy,Rf,Lm,Nm,xc,Rm,Zy,Mm,Mf,Qy,Jy,En,Om,Of,ev,Ac,Fm,Oh,fO,pO,xC,lo,iS,AC,gO,mO;let qS=(En=class{constructor({textContentSource:t,container:i,viewport:n}){j(this,Oh);j(this,Sc,Promise.withResolvers());j(this,wa,null);j(this,Gy,!1);j(this,Xy,!!((rM=globalThis.FontInspector)!=null&&rM.enabled));j(this,Nf,null);j(this,Wu,null);j(this,Ky,0);j(this,Yy,0);j(this,Rf,null);j(this,Lm,null);j(this,Nm,0);j(this,xc,0);j(this,Rm,Object.create(null));j(this,Zy,[]);j(this,Mm,null);j(this,Mf,[]);j(this,Qy,new WeakMap);j(this,Jy,null);var f;if(t instanceof ReadableStream)D(this,Mm,t);else if(typeof t=="object")D(this,Mm,new ReadableStream({start(m){m.enqueue(t),m.close()}}));else throw new Error('No "textContentSource" parameter specified.');D(this,wa,D(this,Lm,i)),D(this,xc,n.scale*Pd.pixelRatio),D(this,Nm,n.rotation),D(this,Wu,{div:null,properties:null,ctx:null});const{pageWidth:o,pageHeight:l,pageX:c,pageY:d}=n.rawDims;D(this,Jy,[1,0,0,-1,-c,d+l]),D(this,Yy,o),D(this,Ky,l),R(f=En,lo,gO).call(f),kd(i,n),u(this,Sc).promise.finally(()=>{u(En,Fm).delete(this),D(this,Wu,null),D(this,Rm,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:t,isFirefox:i}=yr.platform;return is(this,"fontFamilyMap",new Map([["sans-serif",`${t&&i?"Calibri, ":""}sans-serif`],["monospace",`${t&&i?"Lucida Console, ":""}monospace`]]))}render(){const t=()=>{u(this,Rf).read().then(({value:i,done:n})=>{if(n){u(this,Sc).resolve();return}u(this,Nf)??D(this,Nf,i.lang),Object.assign(u(this,Rm),i.styles),R(this,Oh,fO).call(this,i.items),t()},u(this,Sc).reject)};return D(this,Rf,u(this,Mm).getReader()),u(En,Fm).add(this),t(),u(this,Sc).promise}update({viewport:t,onBefore:i=null}){var l;const n=t.scale*Pd.pixelRatio,o=t.rotation;if(o!==u(this,Nm)&&(i==null||i(),D(this,Nm,o),kd(u(this,Lm),{rotation:o})),n!==u(this,xc)){i==null||i(),D(this,xc,n);const c={div:null,properties:null,ctx:R(l=En,lo,iS).call(l,u(this,Nf))};for(const d of u(this,Mf))c.properties=u(this,Qy).get(d),c.div=d,R(this,Oh,xC).call(this,c)}}cancel(){var i;const t=new Mh("TextLayer task cancelled.");(i=u(this,Rf))==null||i.cancel(t).catch(()=>{}),D(this,Rf,null),u(this,Sc).reject(t)}get textDivs(){return u(this,Mf)}get textContentItemsStr(){return u(this,Zy)}static cleanup(){if(!(u(this,Fm).size>0)){u(this,Om).clear();for(const{canvas:t}of u(this,Of).values())t.remove();u(this,Of).clear()}}},Sc=new WeakMap,wa=new WeakMap,Gy=new WeakMap,Xy=new WeakMap,Nf=new WeakMap,Wu=new WeakMap,Ky=new WeakMap,Yy=new WeakMap,Rf=new WeakMap,Lm=new WeakMap,Nm=new WeakMap,xc=new WeakMap,Rm=new WeakMap,Zy=new WeakMap,Mm=new WeakMap,Mf=new WeakMap,Qy=new WeakMap,Jy=new WeakMap,Om=new WeakMap,Of=new WeakMap,ev=new WeakMap,Ac=new WeakMap,Fm=new WeakMap,Oh=new WeakSet,fO=function(t){var o,l;if(u(this,Gy))return;(l=u(this,Wu)).ctx??(l.ctx=R(o=En,lo,iS).call(o,u(this,Nf)));const i=u(this,Mf),n=u(this,Zy);for(const c of t){if(i.length>J$){Ri("Ignoring additional textDivs for performance reasons."),D(this,Gy,!0);return}if(c.str===void 0){if(c.type==="beginMarkedContentProps"||c.type==="beginMarkedContent"){const d=u(this,wa);D(this,wa,document.createElement("span")),u(this,wa).classList.add("markedContent"),c.id!==null&&u(this,wa).setAttribute("id",`${c.id}`),d.append(u(this,wa))}else c.type==="endMarkedContent"&&D(this,wa,u(this,wa).parentNode);continue}n.push(c.str),R(this,Oh,pO).call(this,c)}},pO=function(t){var L;const i=document.createElement("span"),n={angle:0,canvasWidth:0,hasText:t.str!=="",hasEOL:t.hasEOL,fontSize:0};u(this,Mf).push(i);const o=oi.transform(u(this,Jy),t.transform);let l=Math.atan2(o[1],o[0]);const c=u(this,Rm)[t.fontName];c.vertical&&(l+=Math.PI/2);let d=u(this,Xy)&&c.fontSubstitution||c.fontFamily;d=En.fontFamilyMap.get(d)||d;const f=Math.hypot(o[2],o[3]),m=f*R(L=En,lo,mO).call(L,d,c,u(this,Nf));let b,T;l===0?(b=o[4],T=o[5]-m):(b=o[4]+m*Math.sin(l),T=o[5]-m*Math.cos(l));const C="calc(var(--total-scale-factor) *",P=i.style;u(this,wa)===u(this,Lm)?(P.left=`${(100*b/u(this,Yy)).toFixed(2)}%`,P.top=`${(100*T/u(this,Ky)).toFixed(2)}%`):(P.left=`${C}${b.toFixed(2)}px)`,P.top=`${C}${T.toFixed(2)}px)`),P.fontSize=`${C}${(u(En,Ac)*f).toFixed(2)}px)`,P.fontFamily=d,n.fontSize=f,i.setAttribute("role","presentation"),i.textContent=t.str,i.dir=t.dir,u(this,Xy)&&(i.dataset.fontName=c.fontSubstitutionLoadedName||t.fontName),l!==0&&(n.angle=l*(180/Math.PI));let x=!1;if(t.str.length>1)x=!0;else if(t.str!==" "&&t.transform[0]!==t.transform[3]){const F=Math.abs(t.transform[0]),X=Math.abs(t.transform[3]);F!==X&&Math.max(F,X)/Math.min(F,X)>1.5&&(x=!0)}if(x&&(n.canvasWidth=c.vertical?t.height:t.width),u(this,Qy).set(i,n),u(this,Wu).div=i,u(this,Wu).properties=n,R(this,Oh,xC).call(this,u(this,Wu)),n.hasText&&u(this,wa).append(i),n.hasEOL){const F=document.createElement("br");F.setAttribute("role","presentation"),u(this,wa).append(F)}},xC=function(t){var d;const{div:i,properties:n,ctx:o}=t,{style:l}=i;let c="";if(u(En,Ac)>1&&(c=`scale(${1/u(En,Ac)})`),n.canvasWidth!==0&&n.hasText){const{fontFamily:f}=l,{canvasWidth:m,fontSize:b}=n;R(d=En,lo,AC).call(d,o,b*u(this,xc),f);const{width:T}=o.measureText(i.textContent);T>0&&(c=`scaleX(${m*u(this,xc)/T}) ${c}`)}n.angle!==0&&(c=`rotate(${n.angle}deg) ${c}`),c.length>0&&(l.transform=c)},lo=new WeakSet,iS=function(t=null){let i=u(this,Of).get(t||(t=""));if(!i){const n=document.createElement("canvas");n.className="hiddenCanvasElement",n.lang=t,document.body.append(n),i=n.getContext("2d",{alpha:!1,willReadFrequently:!0}),u(this,Of).set(t,i),u(this,ev).set(i,{size:0,family:""})}return i},AC=function(t,i,n){const o=u(this,ev).get(t);i===o.size&&n===o.family||(t.font=`${i}px ${n}`,o.size=i,o.family=n)},gO=function(){if(u(this,Ac)!==null)return;const t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.style.position="absolute",t.textContent="X",document.body.append(t),D(this,Ac,t.getBoundingClientRect().height),t.remove()},mO=function(t,i,n){const o=u(this,Om).get(t);if(o)return o;const l=R(this,lo,iS).call(this,n);l.canvas.width=l.canvas.height=oR,R(this,lo,AC).call(this,l,oR,t);const c=l.measureText(""),d=c.fontBoundingBoxAscent,f=Math.abs(c.fontBoundingBoxDescent);l.canvas.width=l.canvas.height=0;let m=.8;return d?m=d/(d+f):(yr.platform.isFirefox&&Ri("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),i.ascent?m=i.ascent:i.descent&&(m=1+i.descent)),u(this,Om).set(t,m),m},j(En,lo),j(En,Om,new Map),j(En,Of,new Map),j(En,ev,new WeakMap),j(En,Ac,null),j(En,Fm,new Set),En);class oy{static textContent(t){const i=[],n={items:i,styles:Object.create(null)};function o(l){var f;if(!l)return;let c=null;const d=l.name;if(d==="#text")c=l.value;else if(oy.shouldBuildText(d))(f=l==null?void 0:l.attributes)!=null&&f.textContent?c=l.attributes.textContent:l.value&&(c=l.value);else return;if(c!==null&&i.push({str:c}),!!l.children)for(const m of l.children)o(m)}return o(t),n}static shouldBuildText(t){return!(t==="textarea"||t==="input"||t==="option"||t==="select")}}const ez=100;function _O(g={}){typeof g=="string"||g instanceof URL?g={url:g}:(g instanceof ArrayBuffer||ArrayBuffer.isView(g))&&(g={data:g});const t=new CC,{docId:i}=t,n=g.url?h$(g.url):null,o=g.data?c$(g.data):null,l=g.httpHeaders||null,c=g.withCredentials===!0,d=g.password??null,f=g.range instanceof Jk?g.range:null,m=Number.isInteger(g.rangeChunkSize)&&g.rangeChunkSize>0?g.rangeChunkSize:2**16;let b=g.worker instanceof GS?g.worker:null;const T=g.verbosity,C=typeof g.docBaseUrl=="string"&&!oT(g.docBaseUrl)?g.docBaseUrl:null,P=DE(g.cMapUrl),x=g.cMapPacked!==!1,L=g.CMapReaderFactory||(na?b$:KN),F=DE(g.iccUrl),X=DE(g.standardFontDataUrl),re=g.StandardFontDataFactory||(na?y$:YN),K=DE(g.wasmUrl),te=g.WasmFactory||(na?v$:ZN),ee=g.stopAtErrors!==!0,A=Number.isInteger(g.maxImageSize)&&g.maxImageSize>-1?g.maxImageSize:-1,me=g.isEvalSupported!==!1,fe=typeof g.isOffscreenCanvasSupported=="boolean"?g.isOffscreenCanvasSupported:!na,J=typeof g.isImageDecoderSupported=="boolean"?g.isImageDecoderSupported:!na&&(yr.platform.isFirefox||!globalThis.chrome),ye=Number.isInteger(g.canvasMaxAreaInBytes)?g.canvasMaxAreaInBytes:-1,Oe=typeof g.disableFontFace=="boolean"?g.disableFontFace:na,ot=g.fontExtraProperties===!0,Tt=g.enableXfa===!0,dt=g.ownerDocument||globalThis.document,kt=g.disableRange===!0,$e=g.disableStream===!0,vt=g.disableAutoFetch===!0,Jt=g.pdfBug===!0,di=g.CanvasFactory||(na?_$:p$),Ut=g.FilterFactory||(na?m$:g$),ui=g.enableHWA===!0,qt=g.useWasm!==!1,Ze=f?f.length:g.length??NaN,ki=typeof g.useSystemFonts=="boolean"?g.useSystemFonts:!na&&!Oe,wi=typeof g.useWorkerFetch=="boolean"?g.useWorkerFetch:!!(L===KN&&re===YN&&te===ZN&&P&&X&&K&&bb(P,document.baseURI)&&bb(X,document.baseURI)&&bb(K,document.baseURI)),jt=null;qV(T);const Yt={canvasFactory:new di({ownerDocument:dt,enableHWA:ui}),filterFactory:new Ut({docId:i,ownerDocument:dt}),cMapReaderFactory:wi?null:new L({baseUrl:P,isCompressed:x}),standardFontDataFactory:wi?null:new re({baseUrl:X}),wasmFactory:wi?null:new te({baseUrl:K})};b||(b=GS.create({verbosity:T,port:oc.workerPort}),t._worker=b);const Ei={docId:i,apiVersion:"5.3.33",data:o,password:d,disableAutoFetch:vt,rangeChunkSize:m,length:Ze,docBaseUrl:C,enableXfa:Tt,evaluatorOptions:{maxImageSize:A,disableFontFace:Oe,ignoreErrors:ee,isEvalSupported:me,isOffscreenCanvasSupported:fe,isImageDecoderSupported:J,canvasMaxAreaInBytes:ye,fontExtraProperties:ot,useSystemFonts:ki,useWasm:qt,useWorkerFetch:wi,cMapUrl:P,iccUrl:F,standardFontDataUrl:X,wasmUrl:K}},ii={ownerDocument:dt,pdfBug:Jt,styleElement:jt,loadingParams:{disableAutoFetch:vt,enableXfa:Tt}};return b.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");if(b.destroyed)throw new Error("Worker was destroyed");const hi=b.messageHandler.sendWithPromise("GetDocRequest",Ei,o?[o.buffer]:null);let Gt;if(f)Gt=new O$(f,{disableRange:kt,disableStream:$e});else if(!o){if(!n)throw new Error("getDocument - no `url` parameter provided.");const es=bb(n)?j$:na?Y$:W$;Gt=new es({url:n,length:Ze,httpHeaders:l,withCredentials:c,rangeChunkSize:m,disableRange:kt,disableStream:$e})}return hi.then(es=>{if(t.destroyed)throw new Error("Loading aborted");if(b.destroyed)throw new Error("Worker was destroyed");const js=new Eb(i,es,b.port),ps=new sz(js,t,Gt,ii,Yt);t._transport=ps,js.send("Ready",null)})}).catch(t._capability.reject),t}var ox;const lx=class lx{constructor(){St(this,"_capability",Promise.withResolvers());St(this,"_transport",null);St(this,"_worker",null);St(this,"docId",`d${Yn(lx,ox)._++}`);St(this,"destroyed",!1);St(this,"onPassword",null);St(this,"onProgress",null)}get promise(){return this._capability.promise}async destroy(){var t,i,n,o;this.destroyed=!0;try{(t=this._worker)!=null&&t.port&&(this._worker._pendingDestroy=!0),await((i=this._transport)==null?void 0:i.destroy())}catch(l){throw(n=this._worker)!=null&&n.port&&delete this._worker._pendingDestroy,l}this._transport=null,(o=this._worker)==null||o.destroy(),this._worker=null}async getData(){return this._transport.getData()}};ox=new WeakMap,j(lx,ox,0);let CC=lx;var Ff,tv,iv,sv,nv,aM;let Jk=(aM=class{constructor(t,i,n=!1,o=null){j(this,Ff,Promise.withResolvers());j(this,tv,[]);j(this,iv,[]);j(this,sv,[]);j(this,nv,[]);this.length=t,this.initialData=i,this.progressiveDone=n,this.contentDispositionFilename=o}addRangeListener(t){u(this,nv).push(t)}addProgressListener(t){u(this,sv).push(t)}addProgressiveReadListener(t){u(this,iv).push(t)}addProgressiveDoneListener(t){u(this,tv).push(t)}onDataRange(t,i){for(const n of u(this,nv))n(t,i)}onDataProgress(t,i){u(this,Ff).promise.then(()=>{for(const n of u(this,sv))n(t,i)})}onDataProgressiveRead(t){u(this,Ff).promise.then(()=>{for(const i of u(this,iv))i(t)})}onDataProgressiveDone(){u(this,Ff).promise.then(()=>{for(const t of u(this,tv))t()})}transportReady(){u(this,Ff).resolve()}requestDataRange(t,i){Bs("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}},Ff=new WeakMap,tv=new WeakMap,iv=new WeakMap,sv=new WeakMap,nv=new WeakMap,aM);class tz{constructor(t,i){this._pdfInfo=t,this._transport=i}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return is(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:i}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(i)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var qu,Bf,kb;class iz{constructor(t,i,n,o=!1){j(this,Bf);j(this,qu,!1);this._pageIndex=t,this._pageInfo=i,this._transport=n,this._stats=o?new qN:null,this._pdfBug=o,this.commonObjs=n.commonObjs,this.objs=new dO,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:i=this.rotate,offsetX:n=0,offsetY:o=0,dontFlip:l=!1}={}){return new aT({viewBox:this.view,userUnit:this.userUnit,scale:t,rotation:i,offsetX:n,offsetY:o,dontFlip:l})}getAnnotations({intent:t="display"}={}){const{renderingIntent:i}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,i)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return is(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var t;return((t=this._transport._htmlForXfa)==null?void 0:t.children[this._pageIndex])||null}render({canvasContext:t,viewport:i,intent:n="display",annotationMode:o=kh.ENABLE,transform:l=null,background:c=null,optionalContentConfigPromise:d=null,annotationCanvasMap:f=null,pageColors:m=null,printAnnotationStorage:b=null,isEditing:T=!1}){var te,ee;(te=this._stats)==null||te.time("Overall");const C=this._transport.getRenderingIntent(n,o,b,T),{renderingIntent:P,cacheKey:x}=C;D(this,qu,!1),d||(d=this._transport.getOptionalContentConfig(P));let L=this._intentStates.get(x);L||(L=Object.create(null),this._intentStates.set(x,L)),L.streamReaderCancelTimeout&&(clearTimeout(L.streamReaderCancelTimeout),L.streamReaderCancelTimeout=null);const F=!!(P&so.PRINT);L.displayReadyCapability||(L.displayReadyCapability=Promise.withResolvers(),L.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(ee=this._stats)==null||ee.time("Page Request"),this._pumpOperatorList(C));const X=A=>{var me;L.renderTasks.delete(re),F&&D(this,qu,!0),R(this,Bf,kb).call(this),A?(re.capability.reject(A),this._abortOperatorList({intentState:L,reason:A instanceof Error?A:new Error(A)})):re.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(me=globalThis.Stats)!=null&&me.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},re=new kC({callback:X,params:{canvasContext:t,viewport:i,transform:l,background:c},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:f,operatorList:L.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!F,pdfBug:this._pdfBug,pageColors:m});(L.renderTasks||(L.renderTasks=new Set)).add(re);const K=re.task;return Promise.all([L.displayReadyCapability.promise,d]).then(([A,me])=>{var fe;if(this.destroyed){X();return}if((fe=this._stats)==null||fe.time("Rendering"),!(me.renderingIntent&P))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");re.initializeGraphics({transparency:A,optionalContentConfig:me}),re.operatorListChanged()}).catch(X),K}getOperatorList({intent:t="display",annotationMode:i=kh.ENABLE,printAnnotationStorage:n=null,isEditing:o=!1}={}){var m;function l(){d.operatorList.lastChunk&&(d.opListReadCapability.resolve(d.operatorList),d.renderTasks.delete(f))}const c=this._transport.getRenderingIntent(t,i,n,o,!0);let d=this._intentStates.get(c.cacheKey);d||(d=Object.create(null),this._intentStates.set(c.cacheKey,d));let f;return d.opListReadCapability||(f=Object.create(null),f.operatorListChanged=l,d.opListReadCapability=Promise.withResolvers(),(d.renderTasks||(d.renderTasks=new Set)).add(f),d.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(m=this._stats)==null||m.time("Page Request"),this._pumpOperatorList(c)),d.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:i=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:i===!0},{highWaterMark:100,size(o){return o.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(n=>oy.textContent(n));const i=this.streamTextContent(t);return new Promise(function(n,o){function l(){c.read().then(function({value:f,done:m}){if(m){n(d);return}d.lang??(d.lang=f.lang),Object.assign(d.styles,f.styles),d.items.push(...f.items),l()},o)}const c=i.getReader(),d={items:[],styles:Object.create(null),lang:null};l()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const i of this._intentStates.values())if(this._abortOperatorList({intentState:i,reason:new Error("Page was destroyed."),force:!0}),!i.opListReadCapability)for(const n of i.renderTasks)t.push(n.completed),n.cancel();return this.objs.clear(),D(this,qu,!1),Promise.all(t)}cleanup(t=!1){D(this,qu,!0);const i=R(this,Bf,kb).call(this);return t&&i&&this._stats&&(this._stats=new qN),i}_startRenderPage(t,i){var o,l;const n=this._intentStates.get(i);n&&((o=this._stats)==null||o.timeEnd("Page Request"),(l=n.displayReadyCapability)==null||l.resolve(t))}_renderPageChunk(t,i){for(let n=0,o=t.length;n<o;n++)i.operatorList.fnArray.push(t.fnArray[n]),i.operatorList.argsArray.push(t.argsArray[n]);i.operatorList.lastChunk=t.lastChunk,i.operatorList.separateAnnots=t.separateAnnots;for(const n of i.renderTasks)n.operatorListChanged();t.lastChunk&&R(this,Bf,kb).call(this)}_pumpOperatorList({renderingIntent:t,cacheKey:i,annotationStorageSerializable:n,modifiedIds:o}){const{map:l,transfer:c}=n,f=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:i,annotationStorage:l,modifiedIds:o},c).getReader(),m=this._intentStates.get(i);m.streamReader=f;const b=()=>{f.read().then(({value:T,done:C})=>{if(C){m.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(T,m),b())},T=>{if(m.streamReader=null,!this._transport.destroyed){if(m.operatorList){m.operatorList.lastChunk=!0;for(const C of m.renderTasks)C.operatorListChanged();R(this,Bf,kb).call(this)}if(m.displayReadyCapability)m.displayReadyCapability.reject(T);else if(m.opListReadCapability)m.opListReadCapability.reject(T);else throw T}})};b()}_abortOperatorList({intentState:t,reason:i,force:n=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!n){if(t.renderTasks.size>0)return;if(i instanceof Ax){let o=ez;i.extraDelay>0&&i.extraDelay<1e3&&(o+=i.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:i,force:!0})},o);return}}if(t.streamReader.cancel(new Mh(i.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[o,l]of this._intentStates)if(l===t){this._intentStates.delete(o);break}this.cleanup()}}}get stats(){return this._stats}}qu=new WeakMap,Bf=new WeakSet,kb=function(){if(!u(this,qu)||this.destroyed)return!1;for(const{renderTasks:t,operatorList:i}of this._intentStates.values())if(t.size>0||!i.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),D(this,qu,!1),!0};var Cc,Xo,Gu,Uf,zs,ux,jf,Hf,ra,sS,bO,yO,Pb,Bm,nS;let GS=(zs=class{constructor({name:t=null,port:i=null,verbosity:n=GV()}={}){j(this,ra);j(this,Cc,Promise.withResolvers());j(this,Xo,null);j(this,Gu,null);j(this,Uf,null);if(this.name=t,this.destroyed=!1,this.verbosity=n,i){if(u(zs,Hf).has(i))throw new Error("Cannot use more than one PDFWorker per port.");u(zs,Hf).set(i,this),R(this,ra,bO).call(this,i)}else R(this,ra,yO).call(this)}get promise(){return u(this,Cc).promise}get port(){return u(this,Gu)}get messageHandler(){return u(this,Xo)}destroy(){var t,i;this.destroyed=!0,(t=u(this,Uf))==null||t.terminate(),D(this,Uf,null),u(zs,Hf).delete(u(this,Gu)),D(this,Gu,null),(i=u(this,Xo))==null||i.destroy(),D(this,Xo,null)}static create(t){const i=u(this,Hf).get(t==null?void 0:t.port);if(i){if(i._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return i}return new zs(t)}static get workerSrc(){if(oc.workerSrc)return oc.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return is(this,"_setupFakeWorkerGlobal",(async()=>u(this,Bm,nS)?u(this,Bm,nS):(await import(this.workerSrc)).WorkerMessageHandler)())}},Cc=new WeakMap,Xo=new WeakMap,Gu=new WeakMap,Uf=new WeakMap,ux=new WeakMap,jf=new WeakMap,Hf=new WeakMap,ra=new WeakSet,sS=function(){u(this,Cc).resolve(),u(this,Xo).send("configure",{verbosity:this.verbosity})},bO=function(t){D(this,Gu,t),D(this,Xo,new Eb("main","worker",t)),u(this,Xo).on("ready",()=>{}),R(this,ra,sS).call(this)},yO=function(){if(u(zs,jf)||u(zs,Bm,nS)){R(this,ra,Pb).call(this);return}let{workerSrc:t}=zs;try{zs._isSameOrigin(window.location,t)||(t=zs._createCDNWrapper(new URL(t,window.location).href));const i=new Worker(t,{type:"module"}),n=new Eb("main","worker",i),o=()=>{l.abort(),n.destroy(),i.terminate(),this.destroyed?u(this,Cc).reject(new Error("Worker was destroyed")):R(this,ra,Pb).call(this)},l=new AbortController;i.addEventListener("error",()=>{u(this,Uf)||o()},{signal:l.signal}),n.on("test",d=>{if(l.abort(),this.destroyed||!d){o();return}D(this,Xo,n),D(this,Gu,i),D(this,Uf,i),R(this,ra,sS).call(this)}),n.on("ready",d=>{if(l.abort(),this.destroyed){o();return}try{c()}catch{R(this,ra,Pb).call(this)}});const c=()=>{const d=new Uint8Array;n.send("test",d,[d.buffer])};c();return}catch{xx("The worker has been disabled.")}R(this,ra,Pb).call(this)},Pb=function(){u(zs,jf)||(Ri("Setting up fake worker."),D(zs,jf,!0)),zs._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){u(this,Cc).reject(new Error("Worker was destroyed"));return}const i=new f$;D(this,Gu,i);const n=`fake${Yn(zs,ux)._++}`,o=new Eb(n+"_worker",n,i);t.setup(o,i),D(this,Xo,new Eb(n,n+"_worker",i)),R(this,ra,sS).call(this)}).catch(t=>{u(this,Cc).reject(new Error(`Setting up fake worker failed: "${t.message}".`))})},Bm=new WeakSet,nS=function(){var t;try{return((t=globalThis.pdfjsWorker)==null?void 0:t.WorkerMessageHandler)||null}catch{return null}},j(zs,Bm),j(zs,ux,0),j(zs,jf,!1),j(zs,Hf,new WeakMap),na&&(D(zs,jf,!0),oc.workerSrc||(oc.workerSrc="./pdf.worker.mjs")),zs._isSameOrigin=(t,i)=>{const n=URL.parse(t);if(!(n!=null&&n.origin)||n.origin==="null")return!1;const o=new URL(i,n);return n.origin===o.origin},zs._createCDNWrapper=t=>{const i=`await import("${t}");`;return URL.createObjectURL(new Blob([i],{type:"text/javascript"}))},zs.fromPort=t=>{if(i$("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!(t!=null&&t.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return zs.create(t)},zs);var Xu,Gl,Um,jm,Ku,Vf,Db;class sz{constructor(t,i,n,o,l){j(this,Vf);j(this,Xu,new Map);j(this,Gl,new Map);j(this,Um,new Map);j(this,jm,new Map);j(this,Ku,null);this.messageHandler=t,this.loadingTask=i,this.commonObjs=new dO,this.fontLoader=new l$({ownerDocument:o.ownerDocument,styleElement:o.styleElement}),this.loadingParams=o.loadingParams,this._params=o,this.canvasFactory=l.canvasFactory,this.filterFactory=l.filterFactory,this.cMapReaderFactory=l.cMapReaderFactory,this.standardFontDataFactory=l.standardFontDataFactory,this.wasmFactory=l.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=n,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}get annotationStorage(){return is(this,"annotationStorage",new Yk)}getRenderingIntent(t,i=kh.ENABLE,n=null,o=!1,l=!1){let c=so.DISPLAY,d=pC;switch(t){case"any":c=so.ANY;break;case"display":break;case"print":c=so.PRINT;break;default:Ri(`getRenderingIntent - invalid intent: ${t}`)}const f=c&so.PRINT&&n instanceof KM?n:this.annotationStorage;switch(i){case kh.DISABLE:c+=so.ANNOTATIONS_DISABLE;break;case kh.ENABLE:break;case kh.ENABLE_FORMS:c+=so.ANNOTATIONS_FORMS;break;case kh.ENABLE_STORAGE:c+=so.ANNOTATIONS_STORAGE,d=f.serializable;break;default:Ri(`getRenderingIntent - invalid annotationMode: ${i}`)}o&&(c+=so.IS_EDITING),l&&(c+=so.OPLIST);const{ids:m,hash:b}=f.modifiedIds,T=[c,d.hash,b];return{renderingIntent:c,cacheKey:T.join("_"),annotationStorageSerializable:d,modifiedIds:m}}destroy(){var n;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(n=u(this,Ku))==null||n.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const o of u(this,Gl).values())t.push(o._destroy());u(this,Gl).clear(),u(this,Um).clear(),u(this,jm).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const i=this.messageHandler.sendWithPromise("Terminate",null);return t.push(i),Promise.all(t).then(()=>{var o,l;this.commonObjs.clear(),this.fontLoader.clear(),u(this,Xu).clear(),this.filterFactory.destroy(),qS.cleanup(),(o=this._networkStream)==null||o.cancelAllRequests(new Mh("Worker was terminated.")),(l=this.messageHandler)==null||l.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:i}=this;t.on("GetReader",(n,o)=>{Vn(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=l=>{this._lastProgress={loaded:l.loaded,total:l.total}},o.onPull=()=>{this._fullReader.read().then(function({value:l,done:c}){if(c){o.close();return}Vn(l instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),o.enqueue(new Uint8Array(l),1,[l])}).catch(l=>{o.error(l)})},o.onCancel=l=>{this._fullReader.cancel(l),o.ready.catch(c=>{if(!this.destroyed)throw c})}}),t.on("ReaderHeadersReady",async n=>{var d;await this._fullReader.headersReady;const{isStreamingSupported:o,isRangeSupported:l,contentLength:c}=this._fullReader;return(!o||!l)&&(this._lastProgress&&((d=i.onProgress)==null||d.call(i,this._lastProgress)),this._fullReader.onProgress=f=>{var m;(m=i.onProgress)==null||m.call(i,{loaded:f.loaded,total:f.total})}),{isStreamingSupported:o,isRangeSupported:l,contentLength:c}}),t.on("GetRangeReader",(n,o)=>{Vn(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const l=this._networkStream.getRangeReader(n.begin,n.end);if(!l){o.close();return}o.onPull=()=>{l.read().then(function({value:c,done:d}){if(d){o.close();return}Vn(c instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),o.enqueue(new Uint8Array(c),1,[c])}).catch(c=>{o.error(c)})},o.onCancel=c=>{l.cancel(c),o.ready.catch(d=>{if(!this.destroyed)throw d})}}),t.on("GetDoc",({pdfInfo:n})=>{this._numPages=n.numPages,this._htmlForXfa=n.htmlForXfa,delete n.htmlForXfa,i._capability.resolve(new tz(n,this))}),t.on("DocException",n=>{i._capability.reject(ya(n))}),t.on("PasswordRequest",n=>{D(this,Ku,Promise.withResolvers());try{if(!i.onPassword)throw ya(n);const o=l=>{l instanceof Error?u(this,Ku).reject(l):u(this,Ku).resolve({password:l})};i.onPassword(o,n.code)}catch(o){u(this,Ku).reject(o)}return u(this,Ku).promise}),t.on("DataLoaded",n=>{var o;(o=i.onProgress)==null||o.call(i,{loaded:n.length,total:n.length}),this.downloadInfoCapability.resolve(n)}),t.on("StartRenderPage",n=>{if(this.destroyed)return;u(this,Gl).get(n.pageIndex)._startRenderPage(n.transparency,n.cacheKey)}),t.on("commonobj",([n,o,l])=>{var c;if(this.destroyed||this.commonObjs.has(n))return null;switch(o){case"Font":if("error"in l){const b=l.error;Ri(`Error during font loading: ${b}`),this.commonObjs.resolve(n,b);break}const d=this._params.pdfBug&&((c=globalThis.FontInspector)!=null&&c.enabled)?(b,T)=>globalThis.FontInspector.fontAdded(b,T):null,f=new u$(l,d);this.fontLoader.bind(f).catch(()=>t.sendWithPromise("FontFallback",{id:n})).finally(()=>{!f.fontExtraProperties&&f.data&&(f.data=null),this.commonObjs.resolve(n,f)});break;case"CopyLocalImage":const{imageRef:m}=l;Vn(m,"The imageRef must be defined.");for(const b of u(this,Gl).values())for(const[,T]of b.objs)if((T==null?void 0:T.ref)===m)return T.dataLen?(this.commonObjs.resolve(n,structuredClone(T)),T.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(n,l);break;default:throw new Error(`Got unknown common object type ${o}`)}return null}),t.on("obj",([n,o,l,c])=>{var f;if(this.destroyed)return;const d=u(this,Gl).get(o);if(!d.objs.has(n)){if(d._intentStates.size===0){(f=c==null?void 0:c.bitmap)==null||f.close();return}switch(l){case"Image":case"Pattern":d.objs.resolve(n,c);break;default:throw new Error(`Got unknown object type ${l}`)}}}),t.on("DocProgress",n=>{var o;this.destroyed||(o=i.onProgress)==null||o.call(i,{loaded:n.loaded,total:n.total})}),t.on("FetchBinaryData",async n=>{if(this.destroyed)throw new Error("Worker was destroyed.");const o=this[n.type];if(!o)throw new Error(`${n.type} not initialized, see the \`useWorkerFetch\` parameter.`);return o.fetch(n)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var n;this.annotationStorage.size<=0&&Ri("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:i}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:((n=this._fullReader)==null?void 0:n.filename)??null},i).finally(()=>{this.annotationStorage.resetModified()})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const i=t-1,n=u(this,Um).get(i);if(n)return n;const o=this.messageHandler.sendWithPromise("GetPage",{pageIndex:i}).then(l=>{if(this.destroyed)throw new Error("Transport destroyed");l.refStr&&u(this,jm).set(l.refStr,t);const c=new iz(i,l,this,this._params.pdfBug);return u(this,Gl).set(i,c),c});return u(this,Um).set(i,o),o}getPageIndex(t){return gC(t)?this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(t,i){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:i})}getFieldObjects(){return R(this,Vf,Db).call(this,"GetFieldObjects")}hasJSActions(){return R(this,Vf,Db).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return R(this,Vf,Db).call(this,"GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return R(this,Vf,Db).call(this,"GetOptionalContentConfig").then(i=>new M$(i,t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",i=u(this,Xu).get(t);if(i)return i;const n=this.messageHandler.sendWithPromise(t,null).then(o=>{var l,c;return{info:o[0],metadata:o[1]?new N$(o[1]):null,contentDispositionFilename:((l=this._fullReader)==null?void 0:l.filename)??null,contentLength:((c=this._fullReader)==null?void 0:c.contentLength)??null}});return u(this,Xu).set(t,n),n}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const i of u(this,Gl).values())if(!i.cleanup())throw new Error(`startCleanup: Page ${i.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),u(this,Xu).clear(),this.filterFactory.destroy(!0),qS.cleanup()}}cachedPageNumber(t){if(!gC(t))return null;const i=t.gen===0?`${t.num}R`:`${t.num}R${t.gen}`;return u(this,jm).get(i)??null}}Xu=new WeakMap,Gl=new WeakMap,Um=new WeakMap,jm=new WeakMap,Ku=new WeakMap,Vf=new WeakSet,Db=function(t,i=null){const n=u(this,Xu).get(t);if(n)return n;const o=this.messageHandler.sendWithPromise(t,i);return u(this,Xu).set(t,o),o};var kc;class nz{constructor(t){j(this,kc,null);St(this,"onContinue",null);St(this,"onError",null);D(this,kc,t)}get promise(){return u(this,kc).capability.promise}cancel(t=0){u(this,kc).cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=u(this,kc).operatorList;if(!t)return!1;const{annotationCanvasMap:i}=u(this,kc);return t.form||t.canvas&&(i==null?void 0:i.size)>0}}kc=new WeakMap;var Pc,$f;const of=class of{constructor({callback:t,params:i,objs:n,commonObjs:o,annotationCanvasMap:l,operatorList:c,pageIndex:d,canvasFactory:f,filterFactory:m,useRequestAnimationFrame:b=!1,pdfBug:T=!1,pageColors:C=null}){j(this,Pc,null);this.callback=t,this.params=i,this.objs=n,this.commonObjs=o,this.annotationCanvasMap=l,this.operatorListIdx=null,this.operatorList=c,this._pageIndex=d,this.canvasFactory=f,this.filterFactory=m,this._pdfBug=T,this.pageColors=C,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=b===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new nz(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=i.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:i}){var d,f;if(this.cancelled)return;if(this._canvas){if(u(of,$f).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");u(of,$f).add(this._canvas)}this._pdfBug&&((d=globalThis.StepperManager)!=null&&d.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:n,viewport:o,transform:l,background:c}=this.params;this.gfx=new rm(n,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:i},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:l,viewport:o,transparency:t,background:c}),this.operatorListIdx=0,this.graphicsReady=!0,(f=this.graphicsReadyCallback)==null||f.call(this)}cancel(t=null,i=0){var n,o,l;this.running=!1,this.cancelled=!0,(n=this.gfx)==null||n.endDrawing(),u(this,Pc)&&(window.cancelAnimationFrame(u(this,Pc)),D(this,Pc,null)),u(of,$f).delete(this._canvas),t||(t=new Ax(`Rendering cancelled, page ${this._pageIndex+1}`,i)),this.callback(t),(l=(o=this.task).onError)==null||l.call(o,t)}operatorListChanged(){var t;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(t=this.stepper)==null||t.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?D(this,Pc,window.requestAnimationFrame(()=>{D(this,Pc,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),u(of,$f).delete(this._canvas),this.callback())))}};Pc=new WeakMap,$f=new WeakMap,j(of,$f,new WeakSet);let kC=of;const vO="5.3.33",wO="7e8587428";function lR(g){return Math.floor(Math.max(0,Math.min(1,g))*255).toString(16).padStart(2,"0")}function pb(g){return Math.max(0,Math.min(255,255*g))}class uR{static CMYK_G([t,i,n,o]){return["G",1-Math.min(1,.3*t+.59*n+.11*i+o)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return t=pb(t),[t,t,t]}static G_HTML([t]){const i=lR(t);return`#${i}${i}${i}`}static RGB_G([t,i,n]){return["G",.3*t+.59*i+.11*n]}static RGB_rgb(t){return t.map(pb)}static RGB_HTML(t){return`#${t.map(lR).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,i,n,o]){return["RGB",1-Math.min(1,t+o),1-Math.min(1,n+o),1-Math.min(1,i+o)]}static CMYK_rgb([t,i,n,o]){return[pb(1-Math.min(1,t+o)),pb(1-Math.min(1,n+o)),pb(1-Math.min(1,i+o))]}static CMYK_HTML(t){const i=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(i)}static RGB_CMYK([t,i,n]){const o=1-t,l=1-i,c=1-n,d=Math.min(o,l,c);return["CMYK",o,l,c,d]}}class rz{create(t,i,n=!1){if(t<=0||i<=0)throw new Error("Invalid SVG dimensions");const o=this._createSVG("svg:svg");return o.setAttribute("version","1.1"),n||(o.setAttribute("width",`${t}px`),o.setAttribute("height",`${i}px`)),o.setAttribute("preserveAspectRatio","none"),o.setAttribute("viewBox",`0 0 ${t} ${i}`),o}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){Bs("Abstract method `_createSVG` called.")}}let ly=class extends rz{_createSVG(t){return document.createElementNS(Au,t)}},eP=class{static setupStorage(t,i,n,o,l){const c=o.getValue(i,{value:null});switch(n.name){case"textarea":if(c.value!==null&&(t.textContent=c.value),l==="print")break;t.addEventListener("input",d=>{o.setValue(i,{value:d.target.value})});break;case"input":if(n.attributes.type==="radio"||n.attributes.type==="checkbox"){if(c.value===n.attributes.xfaOn?t.setAttribute("checked",!0):c.value===n.attributes.xfaOff&&t.removeAttribute("checked"),l==="print")break;t.addEventListener("change",d=>{o.setValue(i,{value:d.target.checked?d.target.getAttribute("xfaOn"):d.target.getAttribute("xfaOff")})})}else{if(c.value!==null&&t.setAttribute("value",c.value),l==="print")break;t.addEventListener("input",d=>{o.setValue(i,{value:d.target.value})})}break;case"select":if(c.value!==null){t.setAttribute("value",c.value);for(const d of n.children)d.attributes.value===c.value?d.attributes.selected=!0:d.attributes.hasOwnProperty("selected")&&delete d.attributes.selected}t.addEventListener("input",d=>{const f=d.target.options,m=f.selectedIndex===-1?"":f[f.selectedIndex].value;o.setValue(i,{value:m})});break}}static setAttributes({html:t,element:i,storage:n=null,intent:o,linkService:l}){const{attributes:c}=i,d=t instanceof HTMLAnchorElement;c.type==="radio"&&(c.name=`${c.name}-${o}`);for(const[f,m]of Object.entries(c))if(m!=null)switch(f){case"class":m.length&&t.setAttribute(f,m.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",m);break;case"style":Object.assign(t.style,m);break;case"textContent":t.textContent=m;break;default:(!d||f!=="href"&&f!=="newWindow")&&t.setAttribute(f,m)}d&&l.addLinkAttributes(t,c.href,c.newWindow),n&&c.dataId&&this.setupStorage(t,c.dataId,i,n)}static render(t){var T,C;const i=t.annotationStorage,n=t.linkService,o=t.xfaHtml,l=t.intent||"display",c=document.createElement(o.name);o.attributes&&this.setAttributes({html:c,element:o,intent:l,linkService:n});const d=l!=="richText",f=t.div;if(f.append(c),t.viewport){const P=`matrix(${t.viewport.transform.join(",")})`;f.style.transform=P}d&&f.setAttribute("class","xfaLayer xfaFont");const m=[];if(o.children.length===0){if(o.value){const P=document.createTextNode(o.value);c.append(P),d&&oy.shouldBuildText(o.name)&&m.push(P)}return{textDivs:m}}const b=[[o,-1,c]];for(;b.length>0;){const[P,x,L]=b.at(-1);if(x+1===P.children.length){b.pop();continue}const F=P.children[++b.at(-1)[1]];if(F===null)continue;const{name:X}=F;if(X==="#text"){const K=document.createTextNode(F.value);m.push(K),L.append(K);continue}const re=(T=F==null?void 0:F.attributes)!=null&&T.xmlns?document.createElementNS(F.attributes.xmlns,X):document.createElement(X);if(L.append(re),F.attributes&&this.setAttributes({html:re,element:F,storage:i,intent:l,linkService:n}),((C=F.children)==null?void 0:C.length)>0)b.push([F,-1,re]);else if(F.value){const K=document.createTextNode(F.value);d&&oy.shouldBuildText(X)&&m.push(K),re.append(K)}}for(const P of f.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))P.setAttribute("readOnly",!0);return{textDivs:m}}static update(t){const i=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=i,t.div.hidden=!1}};const hT=1e3,az=9,rg=new WeakSet;class hR{static create(t){switch(t.data.annotationType){case Pn.LINK:return new TO(t);case Pn.TEXT:return new oz(t);case Pn.WIDGET:switch(t.data.fieldType){case"Tx":return new lz(t);case"Btn":return t.data.radioButton?new xO(t):t.data.checkBox?new hz(t):new cz(t);case"Ch":return new dz(t);case"Sig":return new uz(t)}return new og(t);case Pn.POPUP:return new DC(t);case Pn.FREETEXT:return new DO(t);case Pn.LINE:return new pz(t);case Pn.SQUARE:return new gz(t);case Pn.CIRCLE:return new mz(t);case Pn.POLYLINE:return new IO(t);case Pn.CARET:return new bz(t);case Pn.INK:return new tP(t);case Pn.POLYGON:return new _z(t);case Pn.HIGHLIGHT:return new LO(t);case Pn.UNDERLINE:return new yz(t);case Pn.SQUIGGLY:return new vz(t);case Pn.STRIKEOUT:return new wz(t);case Pn.STAMP:return new NO(t);case Pn.FILEATTACHMENT:return new Tz(t);default:return new Rn(t)}}}var zf,Hm,Vm,rv,PC;const fP=class fP{constructor(t,{isRenderable:i=!1,ignoreBorder:n=!1,createQuadrilaterals:o=!1}={}){j(this,rv);j(this,zf,null);j(this,Hm,!1);j(this,Vm,null);this.isRenderable=i,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,i&&(this.container=this._createContainer(n)),o&&this._createQuadrilaterals()}static _hasPopupData({titleObj:t,contentsObj:i,richText:n}){return!!(t!=null&&t.str||i!=null&&i.str||n!=null&&n.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return fP._hasPopupData(this.data)}updateEdited(t){var n;if(!this.container)return;u(this,zf)||D(this,zf,{rect:this.data.rect.slice(0)});const{rect:i}=t;i&&R(this,rv,PC).call(this,i),(n=u(this,Vm))==null||n.popup.updateEdited(t)}resetEdited(){var t;u(this,zf)&&(R(this,rv,PC).call(this,u(this,zf).rect),(t=u(this,Vm))==null||t.popup.resetEdited(),D(this,zf,null))}_createContainer(t){const{data:i,parent:{page:n,viewport:o}}=this,l=document.createElement("section");l.setAttribute("data-annotation-id",i.id),this instanceof og||(l.tabIndex=hT);const{style:c}=l;if(c.zIndex=this.parent.zIndex++,i.alternativeText&&(l.title=i.alternativeText),i.noRotate&&l.classList.add("norotate"),!i.rect||this instanceof DC){const{rotation:L}=i;return!i.hasOwnCanvas&&L!==0&&this.setRotation(L,l),l}const{width:d,height:f}=this;if(!t&&i.borderStyle.width>0){c.borderWidth=`${i.borderStyle.width}px`;const L=i.borderStyle.horizontalCornerRadius,F=i.borderStyle.verticalCornerRadius;if(L>0||F>0){const re=`calc(${L}px * var(--total-scale-factor)) / calc(${F}px * var(--total-scale-factor))`;c.borderRadius=re}else if(this instanceof xO){const re=`calc(${d}px * var(--total-scale-factor)) / calc(${f}px * var(--total-scale-factor))`;c.borderRadius=re}switch(i.borderStyle.style){case Wg.SOLID:c.borderStyle="solid";break;case Wg.DASHED:c.borderStyle="dashed";break;case Wg.BEVELED:Ri("Unimplemented border style: beveled");break;case Wg.INSET:Ri("Unimplemented border style: inset");break;case Wg.UNDERLINE:c.borderBottomStyle="solid";break}const X=i.borderColor||null;X?(D(this,Hm,!0),c.borderColor=oi.makeHexColor(X[0]|0,X[1]|0,X[2]|0)):c.borderWidth=0}const m=oi.normalizeRect([i.rect[0],n.view[3]-i.rect[1]+n.view[1],i.rect[2],n.view[3]-i.rect[3]+n.view[1]]),{pageWidth:b,pageHeight:T,pageX:C,pageY:P}=o.rawDims;c.left=`${100*(m[0]-C)/b}%`,c.top=`${100*(m[1]-P)/T}%`;const{rotation:x}=i;return i.hasOwnCanvas||x===0?(c.width=`${100*d/b}%`,c.height=`${100*f/T}%`):this.setRotation(x,l),l}setRotation(t,i=this.container){if(!this.data.rect)return;const{pageWidth:n,pageHeight:o}=this.parent.viewport.rawDims;let{width:l,height:c}=this;t%180!==0&&([l,c]=[c,l]),i.style.width=`${100*l/n}%`,i.style.height=`${100*c/o}%`,i.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(i,n,o)=>{const l=o.detail[i],c=l[0],d=l.slice(1);o.target.style[n]=uR[`${c}_HTML`](d),this.annotationStorage.setValue(this.data.id,{[n]:uR[`${c}_rgb`](d)})};return is(this,"_commonActions",{display:i=>{const{display:n}=i.detail,o=n%2===1;this.container.style.visibility=o?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:o,noPrint:n===1||n===2})},print:i=>{this.annotationStorage.setValue(this.data.id,{noPrint:!i.detail.print})},hidden:i=>{const{hidden:n}=i.detail;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:n,noView:n})},focus:i=>{setTimeout(()=>i.target.focus({preventScroll:!1}),0)},userName:i=>{i.target.title=i.detail.userName},readonly:i=>{i.target.disabled=i.detail.readonly},required:i=>{this._setRequired(i.target,i.detail.required)},bgColor:i=>{t("bgColor","backgroundColor",i)},fillColor:i=>{t("fillColor","backgroundColor",i)},fgColor:i=>{t("fgColor","color",i)},textColor:i=>{t("textColor","color",i)},borderColor:i=>{t("borderColor","borderColor",i)},strokeColor:i=>{t("strokeColor","borderColor",i)},rotation:i=>{const n=i.detail.rotation;this.setRotation(n),this.annotationStorage.setValue(this.data.id,{rotation:n})}})}_dispatchEventFromSandbox(t,i){const n=this._commonActions;for(const o of Object.keys(i.detail)){const l=t[o]||n[o];l==null||l(i)}}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const i=this.annotationStorage.getRawValue(this.data.id);if(!i)return;const n=this._commonActions;for(const[o,l]of Object.entries(i)){const c=n[o];if(c){const d={detail:{[o]:l},target:t};c(d),delete i[o]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[i,n,o,l]=this.data.rect.map(L=>Math.fround(L));if(t.length===8){const[L,F,X,re]=t.subarray(2,6);if(o===L&&l===F&&i===X&&n===re)return}const{style:c}=this.container;let d;if(u(this,Hm)){const{borderColor:L,borderWidth:F}=c;c.borderWidth=0,d=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${L}" stroke-width="${F}">`],this.container.classList.add("hasBorder")}const f=o-i,m=l-n,{svgFactory:b}=this,T=b.createElement("svg");T.classList.add("quadrilateralsContainer"),T.setAttribute("width",0),T.setAttribute("height",0);const C=b.createElement("defs");T.append(C);const P=b.createElement("clipPath"),x=`clippath_${this.data.id}`;P.setAttribute("id",x),P.setAttribute("clipPathUnits","objectBoundingBox"),C.append(P);for(let L=2,F=t.length;L<F;L+=8){const X=t[L],re=t[L+1],K=t[L+2],te=t[L+3],ee=b.createElement("rect"),A=(K-i)/f,me=(l-re)/m,fe=(X-K)/f,J=(re-te)/m;ee.setAttribute("x",A),ee.setAttribute("y",me),ee.setAttribute("width",fe),ee.setAttribute("height",J),P.append(ee),d==null||d.push(`<rect vector-effect="non-scaling-stroke" x="${A}" y="${me}" width="${fe}" height="${J}"/>`)}u(this,Hm)&&(d.push("</g></svg>')"),c.backgroundImage=d.join("")),this.container.append(T),this.container.style.clipPath=`url(#${x})`}_createPopup(){const{data:t}=this,i=D(this,Vm,new DC({data:{color:t.color,titleObj:t.titleObj,modificationDate:t.modificationDate,contentsObj:t.contentsObj,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation},parent:this.parent,elements:[this]}));this.parent.div.append(i.render())}render(){Bs("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,i=null){const n=[];if(this._fieldObjects){const o=this._fieldObjects[t];if(o)for(const{page:l,id:c,exportValues:d}of o){if(l===-1||c===i)continue;const f=typeof d=="string"?d:null,m=document.querySelector(`[data-element-id="${c}"]`);if(m&&!rg.has(m)){Ri(`_getElementsByName - element not allowed: ${c}`);continue}n.push({id:c,exportValue:f,domElement:m})}return n}for(const o of document.getElementsByName(t)){const{exportValue:l}=o,c=o.getAttribute("data-element-id");c!==i&&rg.has(o)&&n.push({id:c,exportValue:l,domElement:o})}return n}show(){var t;this.container&&(this.container.hidden=!1),(t=this.popup)==null||t.maybeShow()}hide(){var t;this.container&&(this.container.hidden=!0),(t=this.popup)==null||t.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const i of t)i.classList.add("highlightArea");else t.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:i}}=this;this.container.addEventListener("dblclick",()=>{var n;(n=this.linkService.eventBus)==null||n.dispatch("switchannotationeditormode",{source:this,mode:t,editId:i})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}};zf=new WeakMap,Hm=new WeakMap,Vm=new WeakMap,rv=new WeakSet,PC=function(t){const{container:{style:i},data:{rect:n,rotation:o},parent:{viewport:{rawDims:{pageWidth:l,pageHeight:c,pageX:d,pageY:f}}}}=this;n==null||n.splice(0,4,...t),i.left=`${100*(t[0]-d)/l}%`,i.top=`${100*(c-t[3]+f)/c}%`,o===0?(i.width=`${100*(t[2]-t[0])/l}%`,i.height=`${100*(t[3]-t[1])/c}%`):this.setRotation(o)};let Rn=fP;var ao,ef,EO,SO;class TO extends Rn{constructor(i,n=null){super(i,{isRenderable:!0,ignoreBorder:!!(n!=null&&n.ignoreBorder),createQuadrilaterals:!0});j(this,ao);this.isTooltipOnly=i.data.isTooltipOnly}render(){const{data:i,linkService:n}=this,o=document.createElement("a");o.setAttribute("data-element-id",i.id);let l=!1;return i.url?(n.addLinkAttributes(o,i.url,i.newWindow),l=!0):i.action?(this._bindNamedAction(o,i.action),l=!0):i.attachment?(R(this,ao,EO).call(this,o,i.attachment,i.attachmentDest),l=!0):i.setOCGState?(R(this,ao,SO).call(this,o,i.setOCGState),l=!0):i.dest?(this._bindLink(o,i.dest),l=!0):(i.actions&&(i.actions.Action||i.actions["Mouse Up"]||i.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(o,i),l=!0),i.resetForm?(this._bindResetFormAction(o,i.resetForm),l=!0):this.isTooltipOnly&&!l&&(this._bindLink(o,""),l=!0)),this.container.classList.add("linkAnnotation"),l&&this.container.append(o),this.container}_bindLink(i,n){i.href=this.linkService.getDestinationHash(n),i.onclick=()=>(n&&this.linkService.goToDestination(n),!1),(n||n==="")&&R(this,ao,ef).call(this)}_bindNamedAction(i,n){i.href=this.linkService.getAnchorUrl(""),i.onclick=()=>(this.linkService.executeNamedAction(n),!1),R(this,ao,ef).call(this)}_bindJSAction(i,n){i.href=this.linkService.getAnchorUrl("");const o=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const l of Object.keys(n.actions)){const c=o.get(l);c&&(i[c]=()=>{var d;return(d=this.linkService.eventBus)==null||d.dispatch("dispatcheventinsandbox",{source:this,detail:{id:n.id,name:l}}),!1})}i.onclick||(i.onclick=()=>!1),R(this,ao,ef).call(this)}_bindResetFormAction(i,n){const o=i.onclick;if(o||(i.href=this.linkService.getAnchorUrl("")),R(this,ao,ef).call(this),!this._fieldObjects){Ri('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),o||(i.onclick=()=>!1);return}i.onclick=()=>{var T;o==null||o();const{fields:l,refs:c,include:d}=n,f=[];if(l.length!==0||c.length!==0){const C=new Set(c);for(const P of l){const x=this._fieldObjects[P]||[];for(const{id:L}of x)C.add(L)}for(const P of Object.values(this._fieldObjects))for(const x of P)C.has(x.id)===d&&f.push(x)}else for(const C of Object.values(this._fieldObjects))f.push(...C);const m=this.annotationStorage,b=[];for(const C of f){const{id:P}=C;switch(b.push(P),C.type){case"text":{const L=C.defaultValue||"";m.setValue(P,{value:L});break}case"checkbox":case"radiobutton":{const L=C.defaultValue===C.exportValues;m.setValue(P,{value:L});break}case"combobox":case"listbox":{const L=C.defaultValue||"";m.setValue(P,{value:L});break}default:continue}const x=document.querySelector(`[data-element-id="${P}"]`);if(x){if(!rg.has(x)){Ri(`_bindResetFormAction - element not allowed: ${P}`);continue}}else continue;x.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((T=this.linkService.eventBus)==null||T.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:b,name:"ResetForm"}})),!1}}}ao=new WeakSet,ef=function(){this.container.setAttribute("data-internal-link","")},EO=function(i,n,o=null){i.href=this.linkService.getAnchorUrl(""),n.description&&(i.title=n.description),i.onclick=()=>{var l;return(l=this.downloadManager)==null||l.openOrDownloadData(n.content,n.filename,o),!1},R(this,ao,ef).call(this)},SO=function(i,n){i.href=this.linkService.getAnchorUrl(""),i.onclick=()=>(this.linkService.executeSetOCGState(n),!1),R(this,ao,ef).call(this)};class oz extends Rn{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(t),this.container}}class og extends Rn{render(){return this.container}showElementAndHideCanvas(t){var i;this.data.hasOwnCanvas&&(((i=t.previousSibling)==null?void 0:i.nodeName)==="CANVAS"&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return yr.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,i,n,o,l){n.includes("mouse")?t.addEventListener(n,c=>{var d;(d=this.linkService.eventBus)==null||d.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:o,value:l(c),shift:c.shiftKey,modifier:this._getKeyModifier(c)}})}):t.addEventListener(n,c=>{var d;if(n==="blur"){if(!i.focused||!c.relatedTarget)return;i.focused=!1}else if(n==="focus"){if(i.focused)return;i.focused=!0}l&&((d=this.linkService.eventBus)==null||d.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:o,value:l(c)}}))})}_setEventListeners(t,i,n,o){var l,c,d;for(const[f,m]of n)(m==="Action"||(l=this.data.actions)!=null&&l[m])&&((m==="Focus"||m==="Blur")&&(i||(i={focused:!1})),this._setEventListener(t,i,f,m,o),m==="Focus"&&!((c=this.data.actions)!=null&&c.Blur)?this._setEventListener(t,i,"blur","Blur",null):m==="Blur"&&!((d=this.data.actions)!=null&&d.Focus)&&this._setEventListener(t,i,"focus","Focus",null))}_setBackgroundColor(t){const i=this.data.backgroundColor||null;t.style.backgroundColor=i===null?"transparent":oi.makeHexColor(i[0],i[1],i[2])}_setTextStyle(t){const i=["left","center","right"],{fontColor:n}=this.data.defaultAppearanceData,o=this.data.defaultAppearanceData.fontSize||az,l=t.style;let c;const d=2,f=m=>Math.round(10*m)/10;if(this.data.multiLine){const m=Math.abs(this.data.rect[3]-this.data.rect[1]-d),b=Math.round(m/(SA*o))||1,T=m/b;c=Math.min(o,f(T/SA))}else{const m=Math.abs(this.data.rect[3]-this.data.rect[1]-d);c=Math.min(o,f(m/SA))}l.fontSize=`calc(${c}px * var(--total-scale-factor))`,l.color=oi.makeHexColor(n[0],n[1],n[2]),this.data.textAlignment!==null&&(l.textAlign=i[this.data.textAlignment])}_setRequired(t,i){i?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",i)}}class lz extends og{constructor(t){const i=t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:i})}setPropertyOnSiblings(t,i,n,o){const l=this.annotationStorage;for(const c of this._getElementsByName(t.name,t.id))c.domElement&&(c.domElement[i]=n),l.setValue(c.id,{[o]:n})}render(){var o,l;const t=this.annotationStorage,i=this.data.id;this.container.classList.add("textWidgetAnnotation");let n=null;if(this.renderForms){const c=t.getValue(i,{value:this.data.fieldValue});let d=c.value||"";const f=t.getValue(i,{charLimit:this.data.maxLen}).charLimit;f&&d.length>f&&(d=d.slice(0,f));let m=c.formattedValue||((o=this.data.textContent)==null?void 0:o.join(`
`))||null;m&&this.data.comb&&(m=m.replaceAll(/\s+/g,""));const b={userValue:d,formattedValue:m,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(n=document.createElement("textarea"),n.textContent=m??d,this.data.doNotScroll&&(n.style.overflowY="hidden")):(n=document.createElement("input"),n.type=this.data.password?"password":"text",n.setAttribute("value",m??d),this.data.doNotScroll&&(n.style.overflowX="hidden")),this.data.hasOwnCanvas&&(n.hidden=!0),rg.add(n),n.setAttribute("data-element-id",i),n.disabled=this.data.readOnly,n.name=this.data.fieldName,n.tabIndex=hT,this._setRequired(n,this.data.required),f&&(n.maxLength=f),n.addEventListener("input",C=>{t.setValue(i,{value:C.target.value}),this.setPropertyOnSiblings(n,"value",C.target.value,"value"),b.formattedValue=null}),n.addEventListener("resetform",C=>{const P=this.data.defaultFieldValue??"";n.value=b.userValue=P,b.formattedValue=null});let T=C=>{const{formattedValue:P}=b;P!=null&&(C.target.value=P),C.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){n.addEventListener("focus",P=>{var L;if(b.focused)return;const{target:x}=P;b.userValue&&(x.value=b.userValue),b.lastCommittedValue=x.value,b.commitKey=1,(L=this.data.actions)!=null&&L.Focus||(b.focused=!0)}),n.addEventListener("updatefromsandbox",P=>{this.showElementAndHideCanvas(P.target);const x={value(L){b.userValue=L.detail.value??"",t.setValue(i,{value:b.userValue.toString()}),L.target.value=b.userValue},formattedValue(L){const{formattedValue:F}=L.detail;b.formattedValue=F,F!=null&&L.target!==document.activeElement&&(L.target.value=F),t.setValue(i,{formattedValue:F})},selRange(L){L.target.setSelectionRange(...L.detail.selRange)},charLimit:L=>{var K;const{charLimit:F}=L.detail,{target:X}=L;if(F===0){X.removeAttribute("maxLength");return}X.setAttribute("maxLength",F);let re=b.userValue;!re||re.length<=F||(re=re.slice(0,F),X.value=b.userValue=re,t.setValue(i,{value:re}),(K=this.linkService.eventBus)==null||K.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:re,willCommit:!0,commitKey:1,selStart:X.selectionStart,selEnd:X.selectionEnd}}))}};this._dispatchEventFromSandbox(x,P)}),n.addEventListener("keydown",P=>{var F;b.commitKey=1;let x=-1;if(P.key==="Escape"?x=0:P.key==="Enter"&&!this.data.multiLine?x=2:P.key==="Tab"&&(b.commitKey=3),x===-1)return;const{value:L}=P.target;b.lastCommittedValue!==L&&(b.lastCommittedValue=L,b.userValue=L,(F=this.linkService.eventBus)==null||F.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:L,willCommit:!0,commitKey:x,selStart:P.target.selectionStart,selEnd:P.target.selectionEnd}}))});const C=T;T=null,n.addEventListener("blur",P=>{var L,F;if(!b.focused||!P.relatedTarget)return;(L=this.data.actions)!=null&&L.Blur||(b.focused=!1);const{value:x}=P.target;b.userValue=x,b.lastCommittedValue!==x&&((F=this.linkService.eventBus)==null||F.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:x,willCommit:!0,commitKey:b.commitKey,selStart:P.target.selectionStart,selEnd:P.target.selectionEnd}})),C(P)}),(l=this.data.actions)!=null&&l.Keystroke&&n.addEventListener("beforeinput",P=>{var ee;b.lastCommittedValue=null;const{data:x,target:L}=P,{value:F,selectionStart:X,selectionEnd:re}=L;let K=X,te=re;switch(P.inputType){case"deleteWordBackward":{const A=F.substring(0,X).match(/\w*[^\w]*$/);A&&(K-=A[0].length);break}case"deleteWordForward":{const A=F.substring(X).match(/^[^\w]*\w*/);A&&(te+=A[0].length);break}case"deleteContentBackward":X===re&&(K-=1);break;case"deleteContentForward":X===re&&(te+=1);break}P.preventDefault(),(ee=this.linkService.eventBus)==null||ee.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:F,change:x||"",willCommit:!1,selStart:K,selEnd:te}})}),this._setEventListeners(n,b,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],P=>P.target.value)}if(T&&n.addEventListener("blur",T),this.data.comb){const P=(this.data.rect[2]-this.data.rect[0])/f;n.classList.add("comb"),n.style.letterSpacing=`calc(${P}px * var(--total-scale-factor) - 1ch)`}}else n=document.createElement("div"),n.textContent=this.data.fieldValue,n.style.verticalAlign="middle",n.style.display="table-cell",this.data.hasOwnCanvas&&(n.hidden=!0);return this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class uz extends og{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class hz extends og{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,i=this.data,n=i.id;let o=t.getValue(n,{value:i.exportValue===i.fieldValue}).value;typeof o=="string"&&(o=o!=="Off",t.setValue(n,{value:o})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const l=document.createElement("input");return rg.add(l),l.setAttribute("data-element-id",n),l.disabled=i.readOnly,this._setRequired(l,this.data.required),l.type="checkbox",l.name=i.fieldName,o&&l.setAttribute("checked",!0),l.setAttribute("exportValue",i.exportValue),l.tabIndex=hT,l.addEventListener("change",c=>{const{name:d,checked:f}=c.target;for(const m of this._getElementsByName(d,n)){const b=f&&m.exportValue===i.exportValue;m.domElement&&(m.domElement.checked=b),t.setValue(m.id,{value:b})}t.setValue(n,{value:f})}),l.addEventListener("resetform",c=>{const d=i.defaultFieldValue||"Off";c.target.checked=d===i.exportValue}),this.enableScripting&&this.hasJSActions&&(l.addEventListener("updatefromsandbox",c=>{const d={value(f){f.target.checked=f.detail.value!=="Off",t.setValue(n,{value:f.target.checked})}};this._dispatchEventFromSandbox(d,c)}),this._setEventListeners(l,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],c=>c.target.checked)),this._setBackgroundColor(l),this._setDefaultPropertiesFromJS(l),this.container.append(l),this.container}}class xO extends og{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,i=this.data,n=i.id;let o=t.getValue(n,{value:i.fieldValue===i.buttonValue}).value;if(typeof o=="string"&&(o=o!==i.buttonValue,t.setValue(n,{value:o})),o)for(const c of this._getElementsByName(i.fieldName,n))t.setValue(c.id,{value:!1});const l=document.createElement("input");if(rg.add(l),l.setAttribute("data-element-id",n),l.disabled=i.readOnly,this._setRequired(l,this.data.required),l.type="radio",l.name=i.fieldName,o&&l.setAttribute("checked",!0),l.tabIndex=hT,l.addEventListener("change",c=>{const{name:d,checked:f}=c.target;for(const m of this._getElementsByName(d,n))t.setValue(m.id,{value:!1});t.setValue(n,{value:f})}),l.addEventListener("resetform",c=>{const d=i.defaultFieldValue;c.target.checked=d!=null&&d===i.buttonValue}),this.enableScripting&&this.hasJSActions){const c=i.buttonValue;l.addEventListener("updatefromsandbox",d=>{const f={value:m=>{const b=c===m.detail.value;for(const T of this._getElementsByName(m.target.name)){const C=b&&T.id===n;T.domElement&&(T.domElement.checked=C),t.setValue(T.id,{value:C})}}};this._dispatchEventFromSandbox(f,d)}),this._setEventListeners(l,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],d=>d.target.checked)}return this._setBackgroundColor(l),this._setDefaultPropertiesFromJS(l),this.container.append(l),this.container}}class cz extends TO{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const i=t.lastChild;return this.enableScripting&&this.hasJSActions&&i&&(this._setDefaultPropertiesFromJS(i),i.addEventListener("updatefromsandbox",n=>{this._dispatchEventFromSandbox({},n)})),t}}class dz extends og{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,i=this.data.id,n=t.getValue(i,{value:this.data.fieldValue}),o=document.createElement("select");rg.add(o),o.setAttribute("data-element-id",i),o.disabled=this.data.readOnly,this._setRequired(o,this.data.required),o.name=this.data.fieldName,o.tabIndex=hT;let l=this.data.combo&&this.data.options.length>0;this.data.combo||(o.size=this.data.options.length,this.data.multiSelect&&(o.multiple=!0)),o.addEventListener("resetform",b=>{const T=this.data.defaultFieldValue;for(const C of o.options)C.selected=C.value===T});for(const b of this.data.options){const T=document.createElement("option");T.textContent=b.displayValue,T.value=b.exportValue,n.value.includes(b.exportValue)&&(T.setAttribute("selected",!0),l=!1),o.append(T)}let c=null;if(l){const b=document.createElement("option");b.value=" ",b.setAttribute("hidden",!0),b.setAttribute("selected",!0),o.prepend(b),c=()=>{b.remove(),o.removeEventListener("input",c),c=null},o.addEventListener("input",c)}const d=b=>{const T=b?"value":"textContent",{options:C,multiple:P}=o;return P?Array.prototype.filter.call(C,x=>x.selected).map(x=>x[T]):C.selectedIndex===-1?null:C[C.selectedIndex][T]};let f=d(!1);const m=b=>{const T=b.target.options;return Array.prototype.map.call(T,C=>({displayValue:C.textContent,exportValue:C.value}))};return this.enableScripting&&this.hasJSActions?(o.addEventListener("updatefromsandbox",b=>{const T={value(C){c==null||c();const P=C.detail.value,x=new Set(Array.isArray(P)?P:[P]);for(const L of o.options)L.selected=x.has(L.value);t.setValue(i,{value:d(!0)}),f=d(!1)},multipleSelection(C){o.multiple=!0},remove(C){const P=o.options,x=C.detail.remove;P[x].selected=!1,o.remove(x),P.length>0&&Array.prototype.findIndex.call(P,F=>F.selected)===-1&&(P[0].selected=!0),t.setValue(i,{value:d(!0),items:m(C)}),f=d(!1)},clear(C){for(;o.length!==0;)o.remove(0);t.setValue(i,{value:null,items:[]}),f=d(!1)},insert(C){const{index:P,displayValue:x,exportValue:L}=C.detail.insert,F=o.children[P],X=document.createElement("option");X.textContent=x,X.value=L,F?F.before(X):o.append(X),t.setValue(i,{value:d(!0),items:m(C)}),f=d(!1)},items(C){const{items:P}=C.detail;for(;o.length!==0;)o.remove(0);for(const x of P){const{displayValue:L,exportValue:F}=x,X=document.createElement("option");X.textContent=L,X.value=F,o.append(X)}o.options.length>0&&(o.options[0].selected=!0),t.setValue(i,{value:d(!0),items:m(C)}),f=d(!1)},indices(C){const P=new Set(C.detail.indices);for(const x of C.target.options)x.selected=P.has(x.index);t.setValue(i,{value:d(!0)}),f=d(!1)},editable(C){C.target.disabled=!C.detail.editable}};this._dispatchEventFromSandbox(T,b)}),o.addEventListener("input",b=>{var P;const T=d(!0),C=d(!1);t.setValue(i,{value:T}),b.preventDefault(),(P=this.linkService.eventBus)==null||P.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:f,change:C,changeEx:T,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(o,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],b=>b.target.value)):o.addEventListener("input",function(b){t.setValue(i,{value:d(!0)})}),this.data.combo&&this._setTextStyle(o),this._setBackgroundColor(o),this._setDefaultPropertiesFromJS(o),this.container.append(o),this.container}}class DC extends Rn{constructor(t){const{data:i,elements:n}=t;super(t,{isRenderable:Rn._hasPopupData(i)}),this.elements=n,this.popup=null}render(){this.container.classList.add("popupAnnotation");const t=this.popup=new fz({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),i=[];for(const n of this.elements)n.popup=t,n.container.ariaHasPopup="dialog",i.push(n.data.id),n.addHighlightArea();return this.container.setAttribute("aria-controls",i.map(n=>`${qk}${n}`).join(",")),this.container}}var $m,hx,cx,zm,Wm,wn,Yu,qm,av,ov,Gm,Zu,Ko,Qu,lv,Ju,uv,Wf,qf,Us,rS,IC,AO,CO,kO,PO,aS,oS,LC;class fz{constructor({container:t,color:i,elements:n,titleObj:o,modificationDate:l,contentsObj:c,richText:d,parent:f,rect:m,parentRect:b,open:T}){j(this,Us);j(this,$m,R(this,Us,kO).bind(this));j(this,hx,R(this,Us,LC).bind(this));j(this,cx,R(this,Us,oS).bind(this));j(this,zm,R(this,Us,aS).bind(this));j(this,Wm,null);j(this,wn,null);j(this,Yu,null);j(this,qm,null);j(this,av,null);j(this,ov,null);j(this,Gm,null);j(this,Zu,!1);j(this,Ko,null);j(this,Qu,null);j(this,lv,null);j(this,Ju,null);j(this,uv,null);j(this,Wf,null);j(this,qf,!1);var C;D(this,wn,t),D(this,uv,o),D(this,Yu,c),D(this,Ju,d),D(this,ov,f),D(this,Wm,i),D(this,lv,m),D(this,Gm,b),D(this,av,n),D(this,qm,Gk.toDateObject(l)),this.trigger=n.flatMap(P=>P.getElementsToTriggerPopup());for(const P of this.trigger)P.addEventListener("click",u(this,zm)),P.addEventListener("mouseenter",u(this,cx)),P.addEventListener("mouseleave",u(this,hx)),P.classList.add("popupTriggerArea");for(const P of n)(C=P.container)==null||C.addEventListener("keydown",u(this,$m));u(this,wn).hidden=!0,T&&R(this,Us,aS).call(this)}render(){if(u(this,Ko))return;const t=D(this,Ko,document.createElement("div"));if(t.className="popup",u(this,Wm)){const l=t.style.outlineColor=oi.makeHexColor(...u(this,Wm));t.style.backgroundColor=`color-mix(in srgb, ${l} 30%, white)`}const i=document.createElement("span");i.className="header";const n=document.createElement("h1");if(i.append(n),{dir:n.dir,str:n.textContent}=u(this,uv),t.append(i),u(this,qm)){const l=document.createElement("span");l.classList.add("popupDate"),l.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),l.setAttribute("data-l10n-args",JSON.stringify({dateObj:u(this,qm).valueOf()})),i.append(l)}const o=u(this,Us,rS);if(o)eP.render({xfaHtml:o,intent:"richText",div:t}),t.lastChild.classList.add("richText","popupContent");else{const l=this._formatContents(u(this,Yu));t.append(l)}u(this,wn).append(t)}_formatContents({str:t,dir:i}){const n=document.createElement("p");n.classList.add("popupContent"),n.dir=i;const o=t.split(/(?:\r\n?|\n)/);for(let l=0,c=o.length;l<c;++l){const d=o[l];n.append(document.createTextNode(d)),l<c-1&&n.append(document.createElement("br"))}return n}updateEdited({rect:t,popupContent:i}){var n;u(this,Wf)||D(this,Wf,{contentsObj:u(this,Yu),richText:u(this,Ju)}),t&&D(this,Qu,null),i&&(D(this,Ju,R(this,Us,CO).call(this,i)),D(this,Yu,null)),(n=u(this,Ko))==null||n.remove(),D(this,Ko,null)}resetEdited(){var t;u(this,Wf)&&({contentsObj:Yn(this,Yu)._,richText:Yn(this,Ju)._}=u(this,Wf),D(this,Wf,null),(t=u(this,Ko))==null||t.remove(),D(this,Ko,null),D(this,Qu,null))}forceHide(){D(this,qf,this.isVisible),u(this,qf)&&(u(this,wn).hidden=!0)}maybeShow(){u(this,qf)&&(u(this,Ko)||R(this,Us,oS).call(this),D(this,qf,!1),u(this,wn).hidden=!1)}get isVisible(){return u(this,wn).hidden===!1}}$m=new WeakMap,hx=new WeakMap,cx=new WeakMap,zm=new WeakMap,Wm=new WeakMap,wn=new WeakMap,Yu=new WeakMap,qm=new WeakMap,av=new WeakMap,ov=new WeakMap,Gm=new WeakMap,Zu=new WeakMap,Ko=new WeakMap,Qu=new WeakMap,lv=new WeakMap,Ju=new WeakMap,uv=new WeakMap,Wf=new WeakMap,qf=new WeakMap,Us=new WeakSet,rS=function(){const t=u(this,Ju),i=u(this,Yu);return t!=null&&t.str&&(!(i!=null&&i.str)||i.str===t.str)&&u(this,Ju).html||null},IC=function(){var t,i,n;return((n=(i=(t=u(this,Us,rS))==null?void 0:t.attributes)==null?void 0:i.style)==null?void 0:n.fontSize)||0},AO=function(){var t,i,n;return((n=(i=(t=u(this,Us,rS))==null?void 0:t.attributes)==null?void 0:i.style)==null?void 0:n.color)||null},CO=function(t){const i=[],n={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:i}]}},o={style:{color:u(this,Us,AO),fontSize:u(this,Us,IC)?`calc(${u(this,Us,IC)}px * var(--total-scale-factor))`:""}};for(const l of t.split(`
`))i.push({name:"span",value:l,attributes:o});return n},kO=function(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||(t.key==="Enter"||t.key==="Escape"&&u(this,Zu))&&R(this,Us,aS).call(this)},PO=function(){if(u(this,Qu)!==null)return;const{page:{view:t},viewport:{rawDims:{pageWidth:i,pageHeight:n,pageX:o,pageY:l}}}=u(this,ov);let c=!!u(this,Gm),d=c?u(this,Gm):u(this,lv);for(const x of u(this,av))if(!d||oi.intersect(x.data.rect,d)!==null){d=x.data.rect,c=!0;break}const f=oi.normalizeRect([d[0],t[3]-d[1]+t[1],d[2],t[3]-d[3]+t[1]]),b=c?d[2]-d[0]+5:0,T=f[0]+b,C=f[1];D(this,Qu,[100*(T-o)/i,100*(C-l)/n]);const{style:P}=u(this,wn);P.left=`${u(this,Qu)[0]}%`,P.top=`${u(this,Qu)[1]}%`},aS=function(){D(this,Zu,!u(this,Zu)),u(this,Zu)?(R(this,Us,oS).call(this),u(this,wn).addEventListener("click",u(this,zm)),u(this,wn).addEventListener("keydown",u(this,$m))):(R(this,Us,LC).call(this),u(this,wn).removeEventListener("click",u(this,zm)),u(this,wn).removeEventListener("keydown",u(this,$m)))},oS=function(){u(this,Ko)||this.render(),this.isVisible?u(this,Zu)&&u(this,wn).classList.add("focused"):(R(this,Us,PO).call(this),u(this,wn).hidden=!1,u(this,wn).style.zIndex=parseInt(u(this,wn).style.zIndex)+1e3)},LC=function(){u(this,wn).classList.remove("focused"),!(u(this,Zu)||!this.isVisible)&&(u(this,wn).hidden=!0,u(this,wn).style.zIndex=parseInt(u(this,wn).style.zIndex)-1e3)};class DO extends Rn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=Li.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const i of this.textContent){const n=document.createElement("span");n.textContent=i,t.append(n)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var hv;class pz extends Rn{constructor(i){super(i,{isRenderable:!0,ignoreBorder:!0});j(this,hv,null)}render(){this.container.classList.add("lineAnnotation");const{data:i,width:n,height:o}=this,l=this.svgFactory.create(n,o,!0),c=D(this,hv,this.svgFactory.createElement("svg:line"));return c.setAttribute("x1",i.rect[2]-i.lineCoordinates[0]),c.setAttribute("y1",i.rect[3]-i.lineCoordinates[1]),c.setAttribute("x2",i.rect[2]-i.lineCoordinates[2]),c.setAttribute("y2",i.rect[3]-i.lineCoordinates[3]),c.setAttribute("stroke-width",i.borderStyle.width||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),l.append(c),this.container.append(l),!i.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return u(this,hv)}addHighlightArea(){this.container.classList.add("highlightArea")}}hv=new WeakMap;var cv;class gz extends Rn{constructor(i){super(i,{isRenderable:!0,ignoreBorder:!0});j(this,cv,null)}render(){this.container.classList.add("squareAnnotation");const{data:i,width:n,height:o}=this,l=this.svgFactory.create(n,o,!0),c=i.borderStyle.width,d=D(this,cv,this.svgFactory.createElement("svg:rect"));return d.setAttribute("x",c/2),d.setAttribute("y",c/2),d.setAttribute("width",n-c),d.setAttribute("height",o-c),d.setAttribute("stroke-width",c||1),d.setAttribute("stroke","transparent"),d.setAttribute("fill","transparent"),l.append(d),this.container.append(l),!i.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return u(this,cv)}addHighlightArea(){this.container.classList.add("highlightArea")}}cv=new WeakMap;var dv;class mz extends Rn{constructor(i){super(i,{isRenderable:!0,ignoreBorder:!0});j(this,dv,null)}render(){this.container.classList.add("circleAnnotation");const{data:i,width:n,height:o}=this,l=this.svgFactory.create(n,o,!0),c=i.borderStyle.width,d=D(this,dv,this.svgFactory.createElement("svg:ellipse"));return d.setAttribute("cx",n/2),d.setAttribute("cy",o/2),d.setAttribute("rx",n/2-c/2),d.setAttribute("ry",o/2-c/2),d.setAttribute("stroke-width",c||1),d.setAttribute("stroke","transparent"),d.setAttribute("fill","transparent"),l.append(d),this.container.append(l),!i.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return u(this,dv)}addHighlightArea(){this.container.classList.add("highlightArea")}}dv=new WeakMap;var fv;class IO extends Rn{constructor(i){super(i,{isRenderable:!0,ignoreBorder:!0});j(this,fv,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:i,vertices:n,borderStyle:o,popupRef:l},width:c,height:d}=this;if(!n)return this.container;const f=this.svgFactory.create(c,d,!0);let m=[];for(let T=0,C=n.length;T<C;T+=2){const P=n[T]-i[0],x=i[3]-n[T+1];m.push(`${P},${x}`)}m=m.join(" ");const b=D(this,fv,this.svgFactory.createElement(this.svgElementName));return b.setAttribute("points",m),b.setAttribute("stroke-width",o.width||1),b.setAttribute("stroke","transparent"),b.setAttribute("fill","transparent"),f.append(b),this.container.append(f),!l&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return u(this,fv)}addHighlightArea(){this.container.classList.add("highlightArea")}}fv=new WeakMap;class _z extends IO{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class bz extends Rn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var pv,Gf,gv,NC;class tP extends Rn{constructor(i){super(i,{isRenderable:!0,ignoreBorder:!0});j(this,gv);j(this,pv,null);j(this,Gf,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?Li.HIGHLIGHT:Li.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:i,rotation:n,inkLists:o,borderStyle:l,popupRef:c}}=this,{transform:d,width:f,height:m}=R(this,gv,NC).call(this,n,i),b=this.svgFactory.create(f,m,!0),T=D(this,pv,this.svgFactory.createElement("svg:g"));b.append(T),T.setAttribute("stroke-width",l.width||1),T.setAttribute("stroke-linecap","round"),T.setAttribute("stroke-linejoin","round"),T.setAttribute("stroke-miterlimit",10),T.setAttribute("stroke","transparent"),T.setAttribute("fill","transparent"),T.setAttribute("transform",d);for(let C=0,P=o.length;C<P;C++){const x=this.svgFactory.createElement(this.svgElementName);u(this,Gf).push(x),x.setAttribute("points",o[C].join(",")),T.append(x)}return!c&&this.hasPopupData&&this._createPopup(),this.container.append(b),this._editOnDoubleClick(),this.container}updateEdited(i){super.updateEdited(i);const{thickness:n,points:o,rect:l}=i,c=u(this,pv);if(n>=0&&c.setAttribute("stroke-width",n||1),o)for(let d=0,f=u(this,Gf).length;d<f;d++)u(this,Gf)[d].setAttribute("points",o[d].join(","));if(l){const{transform:d,width:f,height:m}=R(this,gv,NC).call(this,this.data.rotation,l);c.parentElement.setAttribute("viewBox",`0 0 ${f} ${m}`),c.setAttribute("transform",d)}}getElementsToTriggerPopup(){return u(this,Gf)}addHighlightArea(){this.container.classList.add("highlightArea")}}pv=new WeakMap,Gf=new WeakMap,gv=new WeakSet,NC=function(i,n){switch(i){case 90:return{transform:`rotate(90) translate(${-n[0]},${n[1]}) scale(1,-1)`,width:n[3]-n[1],height:n[2]-n[0]};case 180:return{transform:`rotate(180) translate(${-n[2]},${n[1]}) scale(1,-1)`,width:n[2]-n[0],height:n[3]-n[1]};case 270:return{transform:`rotate(270) translate(${-n[2]},${n[3]}) scale(1,-1)`,width:n[3]-n[1],height:n[2]-n[0]};default:return{transform:`translate(${-n[0]},${n[3]}) scale(1,-1)`,width:n[2]-n[0],height:n[3]-n[1]}}};class LO extends Rn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=Li.HIGHLIGHT}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),this.container}}class yz extends Rn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class vz extends Rn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class wz extends Rn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class NO extends Rn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=Li.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var mv,_v,RC;class Tz extends Rn{constructor(i){var o;super(i,{isRenderable:!0});j(this,_v);j(this,mv,null);const{file:n}=this.data;this.filename=n.filename,this.content=n.content,(o=this.linkService.eventBus)==null||o.dispatch("fileattachmentannotation",{source:this,...n})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:i,data:n}=this;let o;n.hasAppearance||n.fillAlpha===0?o=document.createElement("div"):(o=document.createElement("img"),o.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(n.name)?"paperclip":"pushpin"}.svg`,n.fillAlpha&&n.fillAlpha<1&&(o.style=`filter: opacity(${Math.round(n.fillAlpha*100)}%);`)),o.addEventListener("dblclick",R(this,_v,RC).bind(this)),D(this,mv,o);const{isMac:l}=yr.platform;return i.addEventListener("keydown",c=>{c.key==="Enter"&&(l?c.metaKey:c.ctrlKey)&&R(this,_v,RC).call(this)}),!n.popupRef&&this.hasPopupData?this._createPopup():o.classList.add("popupTriggerArea"),i.append(o),i}getElementsToTriggerPopup(){return u(this,mv)}addHighlightArea(){this.container.classList.add("highlightArea")}}mv=new WeakMap,_v=new WeakSet,RC=function(){var i;(i=this.downloadManager)==null||i.openOrDownloadData(this.content,this.filename)};var bv,Xf,Dc,yv,Nd,MC,OC,Xm;let RO=(Xm=class{constructor({div:t,accessibilityManager:i,annotationCanvasMap:n,annotationEditorUIManager:o,page:l,viewport:c,structTreeLayer:d}){j(this,Nd);j(this,bv,null);j(this,Xf,null);j(this,Dc,new Map);j(this,yv,null);this.div=t,D(this,bv,i),D(this,Xf,n),D(this,yv,d||null),this.page=l,this.viewport=c,this.zIndex=0,this._annotationEditorUIManager=o}hasEditableAnnotations(){return u(this,Dc).size>0}async render(t){var c;const{annotations:i}=t,n=this.div;kd(n,this.viewport);const o=new Map,l={data:null,layer:n,linkService:t.linkService,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new ly,annotationStorage:t.annotationStorage||new Yk,enableScripting:t.enableScripting===!0,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const d of i){if(d.noHTML)continue;const f=d.annotationType===Pn.POPUP;if(f){const T=o.get(d.id);if(!T)continue;l.elements=T}else if(d.rect[2]===d.rect[0]||d.rect[3]===d.rect[1])continue;l.data=d;const m=hR.create(l);if(!m.isRenderable)continue;if(!f&&d.popupRef){const T=o.get(d.popupRef);T?T.push(m):o.set(d.popupRef,[m])}const b=m.render();d.hidden&&(b.style.visibility="hidden"),await R(this,Nd,MC).call(this,b,d.id),m._isEditable&&(u(this,Dc).set(m.data.id,m),(c=this._annotationEditorUIManager)==null||c.renderAnnotationElement(m))}R(this,Nd,OC).call(this)}async addLinkAnnotations(t,i){const n={data:null,layer:this.div,linkService:i,svgFactory:new ly,parent:this};for(const o of t){o.borderStyle||(o.borderStyle=Xm._defaultBorderStyle),n.data=o;const l=hR.create(n);if(!l.isRenderable)continue;const c=l.render();await R(this,Nd,MC).call(this,c,o.id)}}update({viewport:t}){const i=this.div;this.viewport=t,kd(i,{rotation:t.rotation}),R(this,Nd,OC).call(this),i.hidden=!1}getEditableAnnotations(){return Array.from(u(this,Dc).values())}getEditableAnnotation(t){return u(this,Dc).get(t)}static get _defaultBorderStyle(){return is(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:Wg.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}},bv=new WeakMap,Xf=new WeakMap,Dc=new WeakMap,yv=new WeakMap,Nd=new WeakSet,MC=async function(t,i){var c,d;const n=t.firstChild||t,o=n.id=`${qk}${i}`,l=await((c=u(this,yv))==null?void 0:c.getAriaAttributes(o));if(l)for(const[f,m]of l)n.setAttribute(f,m);this.div.append(t),(d=u(this,bv))==null||d.moveElementInDOM(this.div,t,n,!1)},OC=function(){var i;if(!u(this,Xf))return;const t=this.div;for(const[n,o]of u(this,Xf)){const l=t.querySelector(`[data-annotation-id="${n}"]`);if(!l)continue;o.className="annotationContent";const{firstChild:c}=l;c?c.nodeName==="CANVAS"?c.replaceWith(o):c.classList.contains("annotationContent")?c.after(o):c.before(o):l.append(o);const d=u(this,Dc).get(n);d&&(d._hasNoCanvas?((i=this._annotationEditorUIManager)==null||i.setMissingCanvas(n,l.id,o),d._hasNoCanvas=!1):d.canvas=o)}u(this,Xf).clear()},Xm);const RE=/\r\n?|\n/g;var Yo,za,vv,Kf,Wa,qn,MO,OO,FO,lS,Rh,uS,hS,BO,BC,UO;const Ks=class Ks extends Ys{constructor(i){super({...i,name:"freeTextEditor"});j(this,qn);j(this,Yo);j(this,za,"");j(this,vv,`${this.id}-editor`);j(this,Kf,null);j(this,Wa);D(this,Yo,i.color||Ks._defaultColor||Ys._defaultLineColor),D(this,Wa,i.fontSize||Ks._defaultFontSize)}static get _keyboardManager(){const i=Ks.prototype,n=c=>c.isEmpty(),o=o_.TRANSLATE_SMALL,l=o_.TRANSLATE_BIG;return is(this,"_keyboardManager",new lT([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],i.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],i.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],i._translateEmpty,{args:[-o,0],checker:n}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],i._translateEmpty,{args:[-l,0],checker:n}],[["ArrowRight","mac+ArrowRight"],i._translateEmpty,{args:[o,0],checker:n}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],i._translateEmpty,{args:[l,0],checker:n}],[["ArrowUp","mac+ArrowUp"],i._translateEmpty,{args:[0,-o],checker:n}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],i._translateEmpty,{args:[0,-l],checker:n}],[["ArrowDown","mac+ArrowDown"],i._translateEmpty,{args:[0,o],checker:n}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],i._translateEmpty,{args:[0,l],checker:n}]]))}static initialize(i,n){Ys.initialize(i,n);const o=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(o.getPropertyValue("--freetext-padding"))}static updateDefaultParams(i,n){switch(i){case as.FREETEXT_SIZE:Ks._defaultFontSize=n;break;case as.FREETEXT_COLOR:Ks._defaultColor=n;break}}updateParams(i,n){switch(i){case as.FREETEXT_SIZE:R(this,qn,MO).call(this,n);break;case as.FREETEXT_COLOR:R(this,qn,OO).call(this,n);break}}static get defaultPropertiesToUpdate(){return[[as.FREETEXT_SIZE,Ks._defaultFontSize],[as.FREETEXT_COLOR,Ks._defaultColor||Ys._defaultLineColor]]}get propertiesToUpdate(){return[[as.FREETEXT_SIZE,u(this,Wa)],[as.FREETEXT_COLOR,u(this,Yo)]]}_translateEmpty(i,n){this._uiManager.translateSelectedEditors(i,n,!0)}getInitialTranslation(){const i=this.parentScale;return[-Ks._internalPadding*i,-(Ks._internalPadding+u(this,Wa))*i]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),D(this,Kf,new AbortController);const i=this._uiManager.combinedSignal(u(this,Kf));return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:i}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:i}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:i}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:i}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:i}),!0}disableEditMode(){var i;return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",u(this,vv)),this._isDraggable=!0,(i=u(this,Kf))==null||i.abort(),D(this,Kf,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(i){this._focusEventsAllowed&&(super.focusin(i),i.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(i){var n;this.width||(this.enableEditMode(),i&&this.editorDiv.focus(),(n=this._initialOptions)!=null&&n.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const i=u(this,za),n=D(this,za,R(this,qn,FO).call(this).trimEnd());if(i===n)return;const o=l=>{if(D(this,za,l),!l){this.remove();return}R(this,qn,hS).call(this),this._uiManager.rebuild(this),R(this,qn,lS).call(this)};this.addCommands({cmd:()=>{o(n)},undo:()=>{o(i)},mustExec:!1}),R(this,qn,lS).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(i){i.target===this.div&&i.key==="Enter"&&(this.enterInEditMode(),i.preventDefault())}editorDivKeydown(i){Ks._keyboardManager.exec(this,i)}editorDivFocus(i){this.isEditing=!0}editorDivBlur(i){this.isEditing=!1}editorDivInput(i){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let i,n;(this._isCopy||this.annotationElementId)&&(i=this.x,n=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",u(this,vv)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:o}=this.editorDiv;if(o.fontSize=`calc(${u(this,Wa)}px * var(--total-scale-factor))`,o.color=u(this,Yo),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[l,c]=this.parentDimensions;if(this.annotationElementId){const{position:d}=this._initialData;let[f,m]=this.getInitialTranslation();[f,m]=this.pageTranslationToScreen(f,m);const[b,T]=this.pageDimensions,[C,P]=this.pageTranslation;let x,L;switch(this.rotation){case 0:x=i+(d[0]-C)/b,L=n+this.height-(d[1]-P)/T;break;case 90:x=i+(d[0]-C)/b,L=n-(d[1]-P)/T,[f,m]=[m,-f];break;case 180:x=i-this.width+(d[0]-C)/b,L=n-(d[1]-P)/T,[f,m]=[-f,-m];break;case 270:x=i+(d[0]-C-this.height*T)/b,L=n+(d[1]-P-this.width*b)/T,[f,m]=[-m,f];break}this.setAt(x*l,L*c,f,m)}else this._moveAfterPaste(i,n);R(this,qn,hS).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(i){var x,L,F;const n=i.clipboardData||window.clipboardData,{types:o}=n;if(o.length===1&&o[0]==="text/plain")return;i.preventDefault();const l=R(x=Ks,Rh,BC).call(x,n.getData("text")||"").replaceAll(RE,`
`);if(!l)return;const c=window.getSelection();if(!c.rangeCount)return;this.editorDiv.normalize(),c.deleteFromDocument();const d=c.getRangeAt(0);if(!l.includes(`
`)){d.insertNode(document.createTextNode(l)),this.editorDiv.normalize(),c.collapseToStart();return}const{startContainer:f,startOffset:m}=d,b=[],T=[];if(f.nodeType===Node.TEXT_NODE){const X=f.parentElement;if(T.push(f.nodeValue.slice(m).replaceAll(RE,"")),X!==this.editorDiv){let re=b;for(const K of this.editorDiv.childNodes){if(K===X){re=T;continue}re.push(R(L=Ks,Rh,uS).call(L,K))}}b.push(f.nodeValue.slice(0,m).replaceAll(RE,""))}else if(f===this.editorDiv){let X=b,re=0;for(const K of this.editorDiv.childNodes)re++===m&&(X=T),X.push(R(F=Ks,Rh,uS).call(F,K))}D(this,za,`${b.join(`
`)}${l}${T.join(`
`)}`),R(this,qn,hS).call(this);const C=new Range;let P=Math.sumPrecise(b.map(X=>X.length));for(const{firstChild:X}of this.editorDiv.childNodes)if(X.nodeType===Node.TEXT_NODE){const re=X.nodeValue.length;if(P<=re){C.setStart(X,P),C.setEnd(X,P);break}P-=re}c.removeAllRanges(),c.addRange(C)}get contentDiv(){return this.editorDiv}static async deserialize(i,n,o){var d;let l=null;if(i instanceof DO){const{data:{defaultAppearanceData:{fontSize:f,fontColor:m},rect:b,rotation:T,id:C,popupRef:P},textContent:x,textPosition:L,parent:{page:{pageNumber:F}}}=i;if(!x||x.length===0)return null;l=i={annotationType:Li.FREETEXT,color:Array.from(m),fontSize:f,value:x.join(`
`),position:L,pageIndex:F-1,rect:b.slice(0),rotation:T,id:C,deleted:!1,popupRef:P}}const c=await super.deserialize(i,n,o);return D(c,Wa,i.fontSize),D(c,Yo,oi.makeHexColor(...i.color)),D(c,za,R(d=Ks,Rh,BC).call(d,i.value)),c.annotationElementId=i.id||null,c._initialData=l,c}serialize(i=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const n=Ks._internalPadding*this.parentScale,o=this.getRect(n,n),l=Ys._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:u(this,Yo)),c={annotationType:Li.FREETEXT,color:l,fontSize:u(this,Wa),value:R(this,qn,BO).call(this),pageIndex:this.pageIndex,rect:o,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return i?(c.isCopy=!0,c):this.annotationElementId&&!R(this,qn,UO).call(this,c)?null:(c.id=this.annotationElementId,c)}renderAnnotationElement(i){const n=super.renderAnnotationElement(i);if(this.deleted)return n;const{style:o}=n;o.fontSize=`calc(${u(this,Wa)}px * var(--total-scale-factor))`,o.color=u(this,Yo),n.replaceChildren();for(const c of u(this,za).split(`
`)){const d=document.createElement("div");d.append(c?document.createTextNode(c):document.createElement("br")),n.append(d)}const l=Ks._internalPadding*this.parentScale;return i.updateEdited({rect:this.getRect(l,l),popupContent:u(this,za)}),n}resetAnnotationElement(i){super.resetAnnotationElement(i),i.resetEdited()}};Yo=new WeakMap,za=new WeakMap,vv=new WeakMap,Kf=new WeakMap,Wa=new WeakMap,qn=new WeakSet,MO=function(i){const n=l=>{this.editorDiv.style.fontSize=`calc(${l}px * var(--total-scale-factor))`,this.translate(0,-(l-u(this,Wa))*this.parentScale),D(this,Wa,l),R(this,qn,lS).call(this)},o=u(this,Wa);this.addCommands({cmd:n.bind(this,i),undo:n.bind(this,o),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:as.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},OO=function(i){const n=l=>{D(this,Yo,this.editorDiv.style.color=l)},o=u(this,Yo);this.addCommands({cmd:n.bind(this,i),undo:n.bind(this,o),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:as.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},FO=function(){var o;const i=[];this.editorDiv.normalize();let n=null;for(const l of this.editorDiv.childNodes)(n==null?void 0:n.nodeType)===Node.TEXT_NODE&&l.nodeName==="BR"||(i.push(R(o=Ks,Rh,uS).call(o,l)),n=l);return i.join(`
`)},lS=function(){const[i,n]=this.parentDimensions;let o;if(this.isAttachedToDOM)o=this.div.getBoundingClientRect();else{const{currentLayer:l,div:c}=this,d=c.style.display,f=c.classList.contains("hidden");c.classList.remove("hidden"),c.style.display="hidden",l.div.append(this.div),o=c.getBoundingClientRect(),c.remove(),c.style.display=d,c.classList.toggle("hidden",f)}this.rotation%180===this.parentRotation%180?(this.width=o.width/i,this.height=o.height/n):(this.width=o.height/i,this.height=o.width/n),this.fixAndSetPosition()},Rh=new WeakSet,uS=function(i){return(i.nodeType===Node.TEXT_NODE?i.nodeValue:i.innerText).replaceAll(RE,"")},hS=function(){if(this.editorDiv.replaceChildren(),!!u(this,za))for(const i of u(this,za).split(`
`)){const n=document.createElement("div");n.append(i?document.createTextNode(i):document.createElement("br")),this.editorDiv.append(n)}},BO=function(){return u(this,za).replaceAll("Â "," ")},BC=function(i){return i.replaceAll(" ","Â ")},UO=function(i){const{value:n,fontSize:o,color:l,pageIndex:c}=this._initialData;return this._hasBeenMoved||i.value!==n||i.fontSize!==o||i.color.some((d,f)=>d!==l[f])||i.pageIndex!==c},j(Ks,Rh),St(Ks,"_freeTextDefaultContent",""),St(Ks,"_internalPadding",0),St(Ks,"_defaultColor",null),St(Ks,"_defaultFontSize",10),St(Ks,"_type","freetext"),St(Ks,"_editorType",Li.FREETEXT);let FC=Ks;class Zt{toSVGPath(){Bs("Abstract method `toSVGPath` must be implemented.")}get box(){Bs("Abstract getter `box` must be implemented.")}serialize(t,i){Bs("Abstract method `serialize` must be implemented.")}static _rescale(t,i,n,o,l,c){c||(c=new Float32Array(t.length));for(let d=0,f=t.length;d<f;d+=2)c[d]=i+t[d]*o,c[d+1]=n+t[d+1]*l;return c}static _rescaleAndSwap(t,i,n,o,l,c){c||(c=new Float32Array(t.length));for(let d=0,f=t.length;d<f;d+=2)c[d]=i+t[d+1]*o,c[d+1]=n+t[d]*l;return c}static _translate(t,i,n,o){o||(o=new Float32Array(t.length));for(let l=0,c=t.length;l<c;l+=2)o[l]=i+t[l],o[l+1]=n+t[l+1];return o}static svgRound(t){return Math.round(t*1e4)}static _normalizePoint(t,i,n,o,l){switch(l){case 90:return[1-i/n,t/o];case 180:return[1-t/n,1-i/o];case 270:return[i/n,1-t/o];default:return[t/n,i/o]}}static _normalizePagePoint(t,i,n){switch(n){case 90:return[1-i,t];case 180:return[1-t,1-i];case 270:return[i,1-t];default:return[t,i]}}static createBezierPoints(t,i,n,o,l,c){return[(t+5*n)/6,(i+5*o)/6,(5*n+l)/6,(5*o+c)/6,(n+l)/2,(o+c)/2]}}St(Zt,"PRECISION",1e-4);var qa,Zo,Km,Ym,Xl,Zi,Yf,Zf,wv,Tv,Zm,Qm,Ic,Ev,dx,fx,ir,Ib,jO,HO,VO,$O,zO,WO;const Iu=class Iu{constructor({x:t,y:i},n,o,l,c,d=0){j(this,ir);j(this,qa);j(this,Zo,[]);j(this,Km);j(this,Ym);j(this,Xl,[]);j(this,Zi,new Float32Array(18));j(this,Yf);j(this,Zf);j(this,wv);j(this,Tv);j(this,Zm);j(this,Qm);j(this,Ic,[]);D(this,qa,n),D(this,Qm,l*o),D(this,Ym,c),u(this,Zi).set([NaN,NaN,NaN,NaN,t,i],6),D(this,Km,d),D(this,Tv,u(Iu,Ev)*o),D(this,wv,u(Iu,fx)*o),D(this,Zm,o),u(this,Ic).push(t,i)}isEmpty(){return isNaN(u(this,Zi)[8])}add({x:t,y:i}){var J;D(this,Yf,t),D(this,Zf,i);const[n,o,l,c]=u(this,qa);let[d,f,m,b]=u(this,Zi).subarray(8,12);const T=t-m,C=i-b,P=Math.hypot(T,C);if(P<u(this,wv))return!1;const x=P-u(this,Tv),L=x/P,F=L*T,X=L*C;let re=d,K=f;d=m,f=b,m+=F,b+=X,(J=u(this,Ic))==null||J.push(t,i);const te=-X/x,ee=F/x,A=te*u(this,Qm),me=ee*u(this,Qm);return u(this,Zi).set(u(this,Zi).subarray(2,8),0),u(this,Zi).set([m+A,b+me],4),u(this,Zi).set(u(this,Zi).subarray(14,18),12),u(this,Zi).set([m-A,b-me],16),isNaN(u(this,Zi)[6])?(u(this,Xl).length===0&&(u(this,Zi).set([d+A,f+me],2),u(this,Xl).push(NaN,NaN,NaN,NaN,(d+A-n)/l,(f+me-o)/c),u(this,Zi).set([d-A,f-me],14),u(this,Zo).push(NaN,NaN,NaN,NaN,(d-A-n)/l,(f-me-o)/c)),u(this,Zi).set([re,K,d,f,m,b],6),!this.isEmpty()):(u(this,Zi).set([re,K,d,f,m,b],6),Math.abs(Math.atan2(K-f,re-d)-Math.atan2(X,F))<Math.PI/2?([d,f,m,b]=u(this,Zi).subarray(2,6),u(this,Xl).push(NaN,NaN,NaN,NaN,((d+m)/2-n)/l,((f+b)/2-o)/c),[d,f,re,K]=u(this,Zi).subarray(14,18),u(this,Zo).push(NaN,NaN,NaN,NaN,((re+d)/2-n)/l,((K+f)/2-o)/c),!0):([re,K,d,f,m,b]=u(this,Zi).subarray(0,6),u(this,Xl).push(((re+5*d)/6-n)/l,((K+5*f)/6-o)/c,((5*d+m)/6-n)/l,((5*f+b)/6-o)/c,((d+m)/2-n)/l,((f+b)/2-o)/c),[m,b,d,f,re,K]=u(this,Zi).subarray(12,18),u(this,Zo).push(((re+5*d)/6-n)/l,((K+5*f)/6-o)/c,((5*d+m)/6-n)/l,((5*f+b)/6-o)/c,((d+m)/2-n)/l,((f+b)/2-o)/c),!0))}toSVGPath(){if(this.isEmpty())return"";const t=u(this,Xl),i=u(this,Zo);if(isNaN(u(this,Zi)[6])&&!this.isEmpty())return R(this,ir,jO).call(this);const n=[];n.push(`M${t[4]} ${t[5]}`);for(let o=6;o<t.length;o+=6)isNaN(t[o])?n.push(`L${t[o+4]} ${t[o+5]}`):n.push(`C${t[o]} ${t[o+1]} ${t[o+2]} ${t[o+3]} ${t[o+4]} ${t[o+5]}`);R(this,ir,VO).call(this,n);for(let o=i.length-6;o>=6;o-=6)isNaN(i[o])?n.push(`L${i[o+4]} ${i[o+5]}`):n.push(`C${i[o]} ${i[o+1]} ${i[o+2]} ${i[o+3]} ${i[o+4]} ${i[o+5]}`);return R(this,ir,HO).call(this,n),n.join(" ")}newFreeDrawOutline(t,i,n,o,l,c){return new qO(t,i,n,o,l,c)}getOutlines(){var T;const t=u(this,Xl),i=u(this,Zo),n=u(this,Zi),[o,l,c,d]=u(this,qa),f=new Float32Array((((T=u(this,Ic))==null?void 0:T.length)??0)+2);for(let C=0,P=f.length-2;C<P;C+=2)f[C]=(u(this,Ic)[C]-o)/c,f[C+1]=(u(this,Ic)[C+1]-l)/d;if(f[f.length-2]=(u(this,Yf)-o)/c,f[f.length-1]=(u(this,Zf)-l)/d,isNaN(n[6])&&!this.isEmpty())return R(this,ir,$O).call(this,f);const m=new Float32Array(u(this,Xl).length+24+u(this,Zo).length);let b=t.length;for(let C=0;C<b;C+=2){if(isNaN(t[C])){m[C]=m[C+1]=NaN;continue}m[C]=t[C],m[C+1]=t[C+1]}b=R(this,ir,WO).call(this,m,b);for(let C=i.length-6;C>=6;C-=6)for(let P=0;P<6;P+=2){if(isNaN(i[C+P])){m[b]=m[b+1]=NaN,b+=2;continue}m[b]=i[C+P],m[b+1]=i[C+P+1],b+=2}return R(this,ir,zO).call(this,m,b),this.newFreeDrawOutline(m,f,u(this,qa),u(this,Zm),u(this,Km),u(this,Ym))}};qa=new WeakMap,Zo=new WeakMap,Km=new WeakMap,Ym=new WeakMap,Xl=new WeakMap,Zi=new WeakMap,Yf=new WeakMap,Zf=new WeakMap,wv=new WeakMap,Tv=new WeakMap,Zm=new WeakMap,Qm=new WeakMap,Ic=new WeakMap,Ev=new WeakMap,dx=new WeakMap,fx=new WeakMap,ir=new WeakSet,Ib=function(){const t=u(this,Zi).subarray(4,6),i=u(this,Zi).subarray(16,18),[n,o,l,c]=u(this,qa);return[(u(this,Yf)+(t[0]-i[0])/2-n)/l,(u(this,Zf)+(t[1]-i[1])/2-o)/c,(u(this,Yf)+(i[0]-t[0])/2-n)/l,(u(this,Zf)+(i[1]-t[1])/2-o)/c]},jO=function(){const[t,i,n,o]=u(this,qa),[l,c,d,f]=R(this,ir,Ib).call(this);return`M${(u(this,Zi)[2]-t)/n} ${(u(this,Zi)[3]-i)/o} L${(u(this,Zi)[4]-t)/n} ${(u(this,Zi)[5]-i)/o} L${l} ${c} L${d} ${f} L${(u(this,Zi)[16]-t)/n} ${(u(this,Zi)[17]-i)/o} L${(u(this,Zi)[14]-t)/n} ${(u(this,Zi)[15]-i)/o} Z`},HO=function(t){const i=u(this,Zo);t.push(`L${i[4]} ${i[5]} Z`)},VO=function(t){const[i,n,o,l]=u(this,qa),c=u(this,Zi).subarray(4,6),d=u(this,Zi).subarray(16,18),[f,m,b,T]=R(this,ir,Ib).call(this);t.push(`L${(c[0]-i)/o} ${(c[1]-n)/l} L${f} ${m} L${b} ${T} L${(d[0]-i)/o} ${(d[1]-n)/l}`)},$O=function(t){const i=u(this,Zi),[n,o,l,c]=u(this,qa),[d,f,m,b]=R(this,ir,Ib).call(this),T=new Float32Array(36);return T.set([NaN,NaN,NaN,NaN,(i[2]-n)/l,(i[3]-o)/c,NaN,NaN,NaN,NaN,(i[4]-n)/l,(i[5]-o)/c,NaN,NaN,NaN,NaN,d,f,NaN,NaN,NaN,NaN,m,b,NaN,NaN,NaN,NaN,(i[16]-n)/l,(i[17]-o)/c,NaN,NaN,NaN,NaN,(i[14]-n)/l,(i[15]-o)/c],0),this.newFreeDrawOutline(T,t,u(this,qa),u(this,Zm),u(this,Km),u(this,Ym))},zO=function(t,i){const n=u(this,Zo);return t.set([NaN,NaN,NaN,NaN,n[4],n[5]],i),i+=6},WO=function(t,i){const n=u(this,Zi).subarray(4,6),o=u(this,Zi).subarray(16,18),[l,c,d,f]=u(this,qa),[m,b,T,C]=R(this,ir,Ib).call(this);return t.set([NaN,NaN,NaN,NaN,(n[0]-l)/d,(n[1]-c)/f,NaN,NaN,NaN,NaN,m,b,NaN,NaN,NaN,NaN,T,C,NaN,NaN,NaN,NaN,(o[0]-l)/d,(o[1]-c)/f],i),i+=24},j(Iu,Ev,8),j(Iu,dx,2),j(Iu,fx,u(Iu,Ev)+u(Iu,dx));let XS=Iu;var Jm,Qf,eh,Sv,Ga,xv,In,px,GO;class qO extends Zt{constructor(i,n,o,l,c,d){super();j(this,px);j(this,Jm);j(this,Qf,new Float32Array(4));j(this,eh);j(this,Sv);j(this,Ga);j(this,xv);j(this,In);D(this,In,i),D(this,Ga,n),D(this,Jm,o),D(this,xv,l),D(this,eh,c),D(this,Sv,d),this.lastPoint=[NaN,NaN],R(this,px,GO).call(this,d);const[f,m,b,T]=u(this,Qf);for(let C=0,P=i.length;C<P;C+=2)i[C]=(i[C]-f)/b,i[C+1]=(i[C+1]-m)/T;for(let C=0,P=n.length;C<P;C+=2)n[C]=(n[C]-f)/b,n[C+1]=(n[C+1]-m)/T}toSVGPath(){const i=[`M${u(this,In)[4]} ${u(this,In)[5]}`];for(let n=6,o=u(this,In).length;n<o;n+=6){if(isNaN(u(this,In)[n])){i.push(`L${u(this,In)[n+4]} ${u(this,In)[n+5]}`);continue}i.push(`C${u(this,In)[n]} ${u(this,In)[n+1]} ${u(this,In)[n+2]} ${u(this,In)[n+3]} ${u(this,In)[n+4]} ${u(this,In)[n+5]}`)}return i.push("Z"),i.join(" ")}serialize([i,n,o,l],c){const d=o-i,f=l-n;let m,b;switch(c){case 0:m=Zt._rescale(u(this,In),i,l,d,-f),b=Zt._rescale(u(this,Ga),i,l,d,-f);break;case 90:m=Zt._rescaleAndSwap(u(this,In),i,n,d,f),b=Zt._rescaleAndSwap(u(this,Ga),i,n,d,f);break;case 180:m=Zt._rescale(u(this,In),o,n,-d,f),b=Zt._rescale(u(this,Ga),o,n,-d,f);break;case 270:m=Zt._rescaleAndSwap(u(this,In),o,l,-d,-f),b=Zt._rescaleAndSwap(u(this,Ga),o,l,-d,-f);break}return{outline:Array.from(m),points:[Array.from(b)]}}get box(){return u(this,Qf)}newOutliner(i,n,o,l,c,d=0){return new XS(i,n,o,l,c,d)}getNewOutline(i,n){const[o,l,c,d]=u(this,Qf),[f,m,b,T]=u(this,Jm),C=c*b,P=d*T,x=o*b+f,L=l*T+m,F=this.newOutliner({x:u(this,Ga)[0]*C+x,y:u(this,Ga)[1]*P+L},u(this,Jm),u(this,xv),i,u(this,Sv),n??u(this,eh));for(let X=2;X<u(this,Ga).length;X+=2)F.add({x:u(this,Ga)[X]*C+x,y:u(this,Ga)[X+1]*P+L});return F.getOutlines()}}Jm=new WeakMap,Qf=new WeakMap,eh=new WeakMap,Sv=new WeakMap,Ga=new WeakMap,xv=new WeakMap,In=new WeakMap,px=new WeakSet,GO=function(i){const n=u(this,In);let o=n[4],l=n[5];const c=[o,l,o,l];let d=o,f=l;const m=i?Math.max:Math.min;for(let T=6,C=n.length;T<C;T+=6){const P=n[T+4],x=n[T+5];if(isNaN(n[T]))oi.pointBoundingBox(P,x,c),f<x?(d=P,f=x):f===x&&(d=m(d,P));else{const L=[1/0,1/0,-1/0,-1/0];oi.bezierBoundingBox(o,l,...n.slice(T,T+6),L),oi.rectBoundingBox(...L,c),f<L[3]?(d=L[2],f=L[3]):f===L[3]&&(d=m(d,L[2]))}o=P,l=x}const b=u(this,Qf);b[0]=c[0]-u(this,eh),b[1]=c[1]-u(this,eh),b[2]=c[2]-c[0]+2*u(this,eh),b[3]=c[3]-c[1]+2*u(this,eh),this.lastPoint=[d,f]};var Av,Cv,Lc,Qo,oa,XO,cS,KO,YO,jC;class UC{constructor(t,i=0,n=0,o=!0){j(this,oa);j(this,Av);j(this,Cv);j(this,Lc,[]);j(this,Qo,[]);const l=[1/0,1/0,-1/0,-1/0],c=10**-4;for(const{x:P,y:x,width:L,height:F}of t){const X=Math.floor((P-i)/c)*c,re=Math.ceil((P+L+i)/c)*c,K=Math.floor((x-i)/c)*c,te=Math.ceil((x+F+i)/c)*c,ee=[X,K,te,!0],A=[re,K,te,!1];u(this,Lc).push(ee,A),oi.rectBoundingBox(X,K,re,te,l)}const d=l[2]-l[0]+2*n,f=l[3]-l[1]+2*n,m=l[0]-n,b=l[1]-n,T=u(this,Lc).at(o?-1:-2),C=[T[0],T[2]];for(const P of u(this,Lc)){const[x,L,F]=P;P[0]=(x-m)/d,P[1]=(L-b)/f,P[2]=(F-b)/f}D(this,Av,new Float32Array([m,b,d,f])),D(this,Cv,C)}getOutlines(){u(this,Lc).sort((i,n)=>i[0]-n[0]||i[1]-n[1]||i[2]-n[2]);const t=[];for(const i of u(this,Lc))i[3]?(t.push(...R(this,oa,jC).call(this,i)),R(this,oa,KO).call(this,i)):(R(this,oa,YO).call(this,i),t.push(...R(this,oa,jC).call(this,i)));return R(this,oa,XO).call(this,t)}}Av=new WeakMap,Cv=new WeakMap,Lc=new WeakMap,Qo=new WeakMap,oa=new WeakSet,XO=function(t){const i=[],n=new Set;for(const c of t){const[d,f,m]=c;i.push([d,f,c],[d,m,c])}i.sort((c,d)=>c[1]-d[1]||c[0]-d[0]);for(let c=0,d=i.length;c<d;c+=2){const f=i[c][2],m=i[c+1][2];f.push(m),m.push(f),n.add(f),n.add(m)}const o=[];let l;for(;n.size>0;){const c=n.values().next().value;let[d,f,m,b,T]=c;n.delete(c);let C=d,P=f;for(l=[d,m],o.push(l);;){let x;if(n.has(b))x=b;else if(n.has(T))x=T;else break;n.delete(x),[d,f,m,b,T]=x,C!==d&&(l.push(C,P,d,P===f?f:m),C=d),P=P===f?m:f}l.push(C,P)}return new Ez(o,u(this,Av),u(this,Cv))},cS=function(t){const i=u(this,Qo);let n=0,o=i.length-1;for(;n<=o;){const l=n+o>>1,c=i[l][0];if(c===t)return l;c<t?n=l+1:o=l-1}return o+1},KO=function([,t,i]){const n=R(this,oa,cS).call(this,t);u(this,Qo).splice(n,0,[t,i])},YO=function([,t,i]){const n=R(this,oa,cS).call(this,t);for(let o=n;o<u(this,Qo).length;o++){const[l,c]=u(this,Qo)[o];if(l!==t)break;if(l===t&&c===i){u(this,Qo).splice(o,1);return}}for(let o=n-1;o>=0;o--){const[l,c]=u(this,Qo)[o];if(l!==t)break;if(l===t&&c===i){u(this,Qo).splice(o,1);return}}},jC=function(t){const[i,n,o]=t,l=[[i,n,o]],c=R(this,oa,cS).call(this,o);for(let d=0;d<c;d++){const[f,m]=u(this,Qo)[d];for(let b=0,T=l.length;b<T;b++){const[,C,P]=l[b];if(!(m<=C||P<=f)){if(C>=f){if(P>m)l[b][1]=m;else{if(T===1)return[];l.splice(b,1),b--,T--}continue}l[b][2]=f,P>m&&l.push([i,m,P])}}}return l};var kv,e0;class Ez extends Zt{constructor(i,n,o){super();j(this,kv);j(this,e0);D(this,e0,i),D(this,kv,n),this.lastPoint=o}toSVGPath(){const i=[];for(const n of u(this,e0)){let[o,l]=n;i.push(`M${o} ${l}`);for(let c=2;c<n.length;c+=2){const d=n[c],f=n[c+1];d===o?(i.push(`V${f}`),l=f):f===l&&(i.push(`H${d}`),o=d)}i.push("Z")}return i.join(" ")}serialize([i,n,o,l],c){const d=[],f=o-i,m=l-n;for(const b of u(this,e0)){const T=new Array(b.length);for(let C=0;C<b.length;C+=2)T[C]=i+b[C]*f,T[C+1]=l-b[C+1]*m;d.push(T)}return d}get box(){return u(this,kv)}get classNamesForOutlining(){return["highlightOutline"]}}kv=new WeakMap,e0=new WeakMap;class HC extends XS{newFreeDrawOutline(t,i,n,o,l,c){return new Sz(t,i,n,o,l,c)}}class Sz extends qO{newOutliner(t,i,n,o,l,c=0){return new HC(t,i,n,o,l,c)}}var Jo,Jf,t0,Qn,Pv,i0,Dv,Iv,Nc,el,s0,kr,Lv,Fs,VC,$C,zC,tf,ZO,sc;let iP=(kr=class{constructor({editor:t=null,uiManager:i=null}){j(this,Fs);j(this,Jo,null);j(this,Jf,null);j(this,t0);j(this,Qn,null);j(this,Pv,!1);j(this,i0,!1);j(this,Dv,null);j(this,Iv);j(this,Nc,null);j(this,el,null);j(this,s0);var n;t?(D(this,i0,!1),D(this,s0,as.HIGHLIGHT_COLOR),D(this,Dv,t)):(D(this,i0,!0),D(this,s0,as.HIGHLIGHT_DEFAULT_COLOR)),D(this,el,(t==null?void 0:t._uiManager)||i),D(this,Iv,u(this,el)._eventBus),D(this,t0,(t==null?void 0:t.color)||((n=u(this,el))==null?void 0:n.highlightColors.values().next().value)||"#FFFF98"),u(kr,Lv)||D(kr,Lv,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return is(this,"_keyboardManager",new lT([[["Escape","mac+Escape"],kr.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],kr.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],kr.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],kr.prototype._moveToPrevious],[["Home","mac+Home"],kr.prototype._moveToBeginning],[["End","mac+End"],kr.prototype._moveToEnd]]))}renderButton(){const t=D(this,Jo,document.createElement("button"));t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.setAttribute("aria-haspopup",!0);const i=u(this,el)._signal;t.addEventListener("click",R(this,Fs,tf).bind(this),{signal:i}),t.addEventListener("keydown",R(this,Fs,zC).bind(this),{signal:i});const n=D(this,Jf,document.createElement("span"));return n.className="swatch",n.setAttribute("aria-hidden",!0),n.style.backgroundColor=u(this,t0),t.append(n),t}renderMainDropdown(){const t=D(this,Qn,R(this,Fs,VC).call(this));return t.setAttribute("aria-orientation","horizontal"),t.setAttribute("aria-labelledby","highlightColorPickerLabel"),t}_colorSelectFromKeyboard(t){if(t.target===u(this,Jo)){R(this,Fs,tf).call(this,t);return}const i=t.target.getAttribute("data-color");i&&R(this,Fs,$C).call(this,i,t)}_moveToNext(t){var i,n;if(!u(this,Fs,sc)){R(this,Fs,tf).call(this,t);return}if(t.target===u(this,Jo)){(i=u(this,Qn).firstChild)==null||i.focus();return}(n=t.target.nextSibling)==null||n.focus()}_moveToPrevious(t){var i,n;if(t.target===((i=u(this,Qn))==null?void 0:i.firstChild)||t.target===u(this,Jo)){u(this,Fs,sc)&&this._hideDropdownFromKeyboard();return}u(this,Fs,sc)||R(this,Fs,tf).call(this,t),(n=t.target.previousSibling)==null||n.focus()}_moveToBeginning(t){var i;if(!u(this,Fs,sc)){R(this,Fs,tf).call(this,t);return}(i=u(this,Qn).firstChild)==null||i.focus()}_moveToEnd(t){var i;if(!u(this,Fs,sc)){R(this,Fs,tf).call(this,t);return}(i=u(this,Qn).lastChild)==null||i.focus()}hideDropdown(){var t,i;(t=u(this,Qn))==null||t.classList.add("hidden"),(i=u(this,Nc))==null||i.abort(),D(this,Nc,null)}_hideDropdownFromKeyboard(){var t;if(!u(this,i0)){if(!u(this,Fs,sc)){(t=u(this,Dv))==null||t.unselect();return}this.hideDropdown(),u(this,Jo).focus({preventScroll:!0,focusVisible:u(this,Pv)})}}updateColor(t){if(u(this,Jf)&&(u(this,Jf).style.backgroundColor=t),!u(this,Qn))return;const i=u(this,el).highlightColors.values();for(const n of u(this,Qn).children)n.setAttribute("aria-selected",i.next().value===t)}destroy(){var t,i;(t=u(this,Jo))==null||t.remove(),D(this,Jo,null),D(this,Jf,null),(i=u(this,Qn))==null||i.remove(),D(this,Qn,null)}},Jo=new WeakMap,Jf=new WeakMap,t0=new WeakMap,Qn=new WeakMap,Pv=new WeakMap,i0=new WeakMap,Dv=new WeakMap,Iv=new WeakMap,Nc=new WeakMap,el=new WeakMap,s0=new WeakMap,Lv=new WeakMap,Fs=new WeakSet,VC=function(){const t=document.createElement("div"),i=u(this,el)._signal;t.addEventListener("contextmenu",Mo,{signal:i}),t.className="dropdown",t.role="listbox",t.setAttribute("aria-multiselectable",!1),t.setAttribute("aria-orientation","vertical"),t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[n,o]of u(this,el).highlightColors){const l=document.createElement("button");l.tabIndex="0",l.role="option",l.setAttribute("data-color",o),l.title=n,l.setAttribute("data-l10n-id",u(kr,Lv)[n]);const c=document.createElement("span");l.append(c),c.className="swatch",c.style.backgroundColor=o,l.setAttribute("aria-selected",o===u(this,t0)),l.addEventListener("click",R(this,Fs,$C).bind(this,o),{signal:i}),t.append(l)}return t.addEventListener("keydown",R(this,Fs,zC).bind(this),{signal:i}),t},$C=function(t,i){i.stopPropagation(),u(this,Iv).dispatch("switchannotationeditorparams",{source:this,type:u(this,s0),value:t})},zC=function(t){kr._keyboardManager.exec(this,t)},tf=function(t){if(u(this,Fs,sc)){this.hideDropdown();return}if(D(this,Pv,t.detail===0),u(this,Nc)||(D(this,Nc,new AbortController),window.addEventListener("pointerdown",R(this,Fs,ZO).bind(this),{signal:u(this,el).combinedSignal(u(this,Nc))})),u(this,Qn)){u(this,Qn).classList.remove("hidden");return}const i=D(this,Qn,R(this,Fs,VC).call(this));u(this,Jo).append(i)},ZO=function(t){var i;(i=u(this,Qn))!=null&&i.contains(t.target)||this.hideDropdown()},sc=function(){return u(this,Qn)&&!u(this,Qn).classList.contains("hidden")},j(kr,Lv,null),kr);var n0,Nv,th,ep,r0,Ta,Rv,Mv,tp,To,Xa,Ar,a0,ih,Ur,o0,Eo,Ov,Ui,WC,dS,QO,JO,eF,qC,sf,No,Yg,tF,fS,Lb,iF,sF,nF,rF,aF;const vs=class vs extends Ys{constructor(i){super({...i,name:"highlightEditor"});j(this,Ui);j(this,n0,null);j(this,Nv,0);j(this,th);j(this,ep,null);j(this,r0,null);j(this,Ta,null);j(this,Rv,null);j(this,Mv,0);j(this,tp,null);j(this,To,null);j(this,Xa,null);j(this,Ar,!1);j(this,a0,null);j(this,ih);j(this,Ur,null);j(this,o0,"");j(this,Eo);j(this,Ov,"");this.color=i.color||vs._defaultColor,D(this,Eo,i.thickness||vs._defaultThickness),D(this,ih,i.opacity||vs._defaultOpacity),D(this,th,i.boxes||null),D(this,Ov,i.methodOfCreation||""),D(this,o0,i.text||""),this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",i.highlightId>-1?(D(this,Ar,!0),R(this,Ui,dS).call(this,i),R(this,Ui,sf).call(this)):u(this,th)&&(D(this,n0,i.anchorNode),D(this,Nv,i.anchorOffset),D(this,Rv,i.focusNode),D(this,Mv,i.focusOffset),R(this,Ui,WC).call(this),R(this,Ui,sf).call(this),this.rotate(this.rotation))}static get _keyboardManager(){const i=vs.prototype;return is(this,"_keyboardManager",new lT([[["ArrowLeft","mac+ArrowLeft"],i._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],i._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],i._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],i._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:u(this,Ar)?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:u(this,Eo),methodOfCreation:u(this,Ov)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(i){return{numberOfColors:i.get("color").size}}static initialize(i,n){var o;Ys.initialize(i,n),vs._defaultColor||(vs._defaultColor=((o=n.highlightColors)==null?void 0:o.values().next().value)||"#fff066")}static updateDefaultParams(i,n){switch(i){case as.HIGHLIGHT_DEFAULT_COLOR:vs._defaultColor=n;break;case as.HIGHLIGHT_THICKNESS:vs._defaultThickness=n;break}}translateInPage(i,n){}get toolbarPosition(){return u(this,a0)}updateParams(i,n){switch(i){case as.HIGHLIGHT_COLOR:R(this,Ui,QO).call(this,n);break;case as.HIGHLIGHT_THICKNESS:R(this,Ui,JO).call(this,n);break}}static get defaultPropertiesToUpdate(){return[[as.HIGHLIGHT_DEFAULT_COLOR,vs._defaultColor],[as.HIGHLIGHT_THICKNESS,vs._defaultThickness]]}get propertiesToUpdate(){return[[as.HIGHLIGHT_COLOR,this.color||vs._defaultColor],[as.HIGHLIGHT_THICKNESS,u(this,Eo)||vs._defaultThickness],[as.HIGHLIGHT_FREE,u(this,Ar)]]}async addEditToolbar(){const i=await super.addEditToolbar();return i?(this._uiManager.highlightColors&&(D(this,r0,new iP({editor:this})),i.addColorPicker(u(this,r0))),i):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(R(this,Ui,Lb).call(this))}getBaseTranslation(){return[0,0]}getRect(i,n){return super.getRect(i,n,R(this,Ui,Lb).call(this))}onceAdded(i){this.annotationElementId||this.parent.addUndoableEditor(this),i&&this.div.focus()}remove(){R(this,Ui,qC).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(R(this,Ui,sf).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(i){var o;let n=!1;this.parent&&!i?R(this,Ui,qC).call(this):i&&(R(this,Ui,sf).call(this,i),n=!this.parent&&((o=this.div)==null?void 0:o.classList.contains("selectedEditor"))),super.setParent(i),this.show(this._isVisible),n&&this.select()}rotate(i){var l,c,d;const{drawLayer:n}=this.parent;let o;u(this,Ar)?(i=(i-this.rotation+360)%360,o=R(l=vs,No,Yg).call(l,u(this,To).box,i)):o=R(c=vs,No,Yg).call(c,[this.x,this.y,this.width,this.height],i),n.updateProperties(u(this,Xa),{bbox:o,root:{"data-main-rotation":i}}),n.updateProperties(u(this,Ur),{bbox:R(d=vs,No,Yg).call(d,u(this,Ta).box,i),root:{"data-main-rotation":i}})}render(){if(this.div)return this.div;const i=super.render();u(this,o0)&&(i.setAttribute("aria-label",u(this,o0)),i.setAttribute("role","mark")),u(this,Ar)?i.classList.add("free"):this.div.addEventListener("keydown",R(this,Ui,tF).bind(this),{signal:this._uiManager._signal});const n=D(this,tp,document.createElement("div"));i.append(n),n.setAttribute("aria-hidden","true"),n.className="internal",n.style.clipPath=u(this,ep);const[o,l]=this.parentDimensions;return this.setDims(this.width*o,this.height*l),EM(this,u(this,tp),["pointerover","pointerleave"]),this.enableEditing(),i}pointerover(){var i;this.isSelected||(i=this.parent)==null||i.drawLayer.updateProperties(u(this,Ur),{rootClass:{hovered:!0}})}pointerleave(){var i;this.isSelected||(i=this.parent)==null||i.drawLayer.updateProperties(u(this,Ur),{rootClass:{hovered:!1}})}_moveCaret(i){switch(this.parent.unselect(this),i){case 0:case 2:R(this,Ui,fS).call(this,!0);break;case 1:case 3:R(this,Ui,fS).call(this,!1);break}}select(){var i;super.select(),u(this,Ur)&&((i=this.parent)==null||i.drawLayer.updateProperties(u(this,Ur),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var i;super.unselect(),u(this,Ur)&&((i=this.parent)==null||i.drawLayer.updateProperties(u(this,Ur),{rootClass:{selected:!1}}),u(this,Ar)||R(this,Ui,fS).call(this,!1))}get _mustFixPosition(){return!u(this,Ar)}show(i=this._isVisible){super.show(i),this.parent&&(this.parent.drawLayer.updateProperties(u(this,Xa),{rootClass:{hidden:!i}}),this.parent.drawLayer.updateProperties(u(this,Ur),{rootClass:{hidden:!i}}))}static startHighlighting(i,n,{target:o,x:l,y:c}){const{x:d,y:f,width:m,height:b}=o.getBoundingClientRect(),T=new AbortController,C=i.combinedSignal(T),P=x=>{T.abort(),R(this,No,rF).call(this,i,x)};window.addEventListener("blur",P,{signal:C}),window.addEventListener("pointerup",P,{signal:C}),window.addEventListener("pointerdown",Nn,{capture:!0,passive:!1,signal:C}),window.addEventListener("contextmenu",Mo,{signal:C}),o.addEventListener("pointermove",R(this,No,nF).bind(this,i),{signal:C}),this._freeHighlight=new HC({x:l,y:c},[d,f,m,b],i.scale,this._defaultThickness/2,n,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=i.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(i,n,o){var L,F,X,re;let l=null;if(i instanceof LO){const{data:{quadPoints:K,rect:te,rotation:ee,id:A,color:me,opacity:fe,popupRef:J},parent:{page:{pageNumber:ye}}}=i;l=i={annotationType:Li.HIGHLIGHT,color:Array.from(me),opacity:fe,quadPoints:K,boxes:null,pageIndex:ye-1,rect:te.slice(0),rotation:ee,id:A,deleted:!1,popupRef:J}}else if(i instanceof tP){const{data:{inkLists:K,rect:te,rotation:ee,id:A,color:me,borderStyle:{rawWidth:fe},popupRef:J},parent:{page:{pageNumber:ye}}}=i;l=i={annotationType:Li.HIGHLIGHT,color:Array.from(me),thickness:fe,inkLists:K,boxes:null,pageIndex:ye-1,rect:te.slice(0),rotation:ee,id:A,deleted:!1,popupRef:J}}const{color:c,quadPoints:d,inkLists:f,opacity:m}=i,b=await super.deserialize(i,n,o);b.color=oi.makeHexColor(...c),D(b,ih,m||1),f&&D(b,Eo,i.thickness),b.annotationElementId=i.id||null,b._initialData=l;const[T,C]=b.pageDimensions,[P,x]=b.pageTranslation;if(d){const K=D(b,th,[]);for(let te=0;te<d.length;te+=8)K.push({x:(d[te]-P)/T,y:1-(d[te+1]-x)/C,width:(d[te+2]-d[te])/T,height:(d[te+1]-d[te+5])/C});R(L=b,Ui,WC).call(L),R(F=b,Ui,sf).call(F),b.rotate(b.rotation)}else if(f){D(b,Ar,!0);const K=f[0],te={x:K[0]-P,y:C-(K[1]-x)},ee=new HC(te,[0,0,T,C],1,u(b,Eo)/2,!0,.001);for(let fe=0,J=K.length;fe<J;fe+=2)te.x=K[fe]-P,te.y=C-(K[fe+1]-x),ee.add(te);const{id:A,clipPathId:me}=n.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:b.color,"fill-opacity":b._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:ee.toSVGPath()}},!0,!0);R(X=b,Ui,dS).call(X,{highlightOutlines:ee.getOutlines(),highlightId:A,clipPathId:me}),R(re=b,Ui,sf).call(re),b.rotate(b.parentRotation)}return b}serialize(i=!1){if(this.isEmpty()||i)return null;if(this.deleted)return this.serializeDeleted();const n=this.getRect(0,0),o=Ys._colorManager.convert(this.color),l={annotationType:Li.HIGHLIGHT,color:o,opacity:u(this,ih),thickness:u(this,Eo),quadPoints:R(this,Ui,iF).call(this),outlines:R(this,Ui,sF).call(this,n),pageIndex:this.pageIndex,rect:n,rotation:R(this,Ui,Lb).call(this),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!R(this,Ui,aF).call(this,l)?null:(l.id=this.annotationElementId,l)}renderAnnotationElement(i){return i.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};n0=new WeakMap,Nv=new WeakMap,th=new WeakMap,ep=new WeakMap,r0=new WeakMap,Ta=new WeakMap,Rv=new WeakMap,Mv=new WeakMap,tp=new WeakMap,To=new WeakMap,Xa=new WeakMap,Ar=new WeakMap,a0=new WeakMap,ih=new WeakMap,Ur=new WeakMap,o0=new WeakMap,Eo=new WeakMap,Ov=new WeakMap,Ui=new WeakSet,WC=function(){const i=new UC(u(this,th),.001);D(this,To,i.getOutlines()),[this.x,this.y,this.width,this.height]=u(this,To).box;const n=new UC(u(this,th),.0025,.001,this._uiManager.direction==="ltr");D(this,Ta,n.getOutlines());const{lastPoint:o}=u(this,Ta);D(this,a0,[(o[0]-this.x)/this.width,(o[1]-this.y)/this.height])},dS=function({highlightOutlines:i,highlightId:n,clipPathId:o}){var T,C;if(D(this,To,i),D(this,Ta,i.getNewOutline(u(this,Eo)/2+1.5,.0025)),n>=0)D(this,Xa,n),D(this,ep,o),this.parent.drawLayer.finalizeDraw(n,{bbox:i.box,path:{d:i.toSVGPath()}}),D(this,Ur,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:u(this,Ta).box,path:{d:u(this,Ta).toSVGPath()}},!0));else if(this.parent){const P=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(u(this,Xa),{bbox:R(T=vs,No,Yg).call(T,u(this,To).box,(P-this.rotation+360)%360),path:{d:i.toSVGPath()}}),this.parent.drawLayer.updateProperties(u(this,Ur),{bbox:R(C=vs,No,Yg).call(C,u(this,Ta).box,P),path:{d:u(this,Ta).toSVGPath()}})}const[c,d,f,m]=i.box;switch(this.rotation){case 0:this.x=c,this.y=d,this.width=f,this.height=m;break;case 90:{const[P,x]=this.parentDimensions;this.x=d,this.y=1-c,this.width=f*x/P,this.height=m*P/x;break}case 180:this.x=1-c,this.y=1-d,this.width=f,this.height=m;break;case 270:{const[P,x]=this.parentDimensions;this.x=1-d,this.y=c,this.width=f*x/P,this.height=m*P/x;break}}const{lastPoint:b}=u(this,Ta);D(this,a0,[(b[0]-c)/f,(b[1]-d)/m])},QO=function(i){const n=(c,d)=>{var f,m;this.color=c,D(this,ih,d),(f=this.parent)==null||f.drawLayer.updateProperties(u(this,Xa),{root:{fill:c,"fill-opacity":d}}),(m=u(this,r0))==null||m.updateColor(c)},o=this.color,l=u(this,ih);this.addCommands({cmd:n.bind(this,i,vs._defaultOpacity),undo:n.bind(this,o,l),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:as.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(i)},!0)},JO=function(i){const n=u(this,Eo),o=l=>{D(this,Eo,l),R(this,Ui,eF).call(this,l)};this.addCommands({cmd:o.bind(this,i),undo:o.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:as.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:i},!0)},eF=function(i){if(!u(this,Ar))return;R(this,Ui,dS).call(this,{highlightOutlines:u(this,To).getNewOutline(i/2)}),this.fixAndSetPosition();const[n,o]=this.parentDimensions;this.setDims(this.width*n,this.height*o)},qC=function(){u(this,Xa)===null||!this.parent||(this.parent.drawLayer.remove(u(this,Xa)),D(this,Xa,null),this.parent.drawLayer.remove(u(this,Ur)),D(this,Ur,null))},sf=function(i=this.parent){u(this,Xa)===null&&({id:Yn(this,Xa)._,clipPathId:Yn(this,ep)._}=i.drawLayer.draw({bbox:u(this,To).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":u(this,ih)},rootClass:{highlight:!0,free:u(this,Ar)},path:{d:u(this,To).toSVGPath()}},!1,!0),D(this,Ur,i.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:u(this,Ar)},bbox:u(this,Ta).box,path:{d:u(this,Ta).toSVGPath()}},u(this,Ar))),u(this,tp)&&(u(this,tp).style.clipPath=u(this,ep)))},No=new WeakSet,Yg=function([i,n,o,l],c){switch(c){case 90:return[1-n-l,i,l,o];case 180:return[1-i-o,1-n-l,o,l];case 270:return[n,1-i-o,l,o]}return[i,n,o,l]},tF=function(i){vs._keyboardManager.exec(this,i)},fS=function(i){if(!u(this,n0))return;const n=window.getSelection();i?n.setPosition(u(this,n0),u(this,Nv)):n.setPosition(u(this,Rv),u(this,Mv))},Lb=function(){return u(this,Ar)?this.rotation:0},iF=function(){if(u(this,Ar))return null;const[i,n]=this.pageDimensions,[o,l]=this.pageTranslation,c=u(this,th),d=new Float32Array(c.length*8);let f=0;for(const{x:m,y:b,width:T,height:C}of c){const P=m*i+o,x=(1-b)*n+l;d[f]=d[f+4]=P,d[f+1]=d[f+3]=x,d[f+2]=d[f+6]=P+T*i,d[f+5]=d[f+7]=x-C*n,f+=8}return d},sF=function(i){return u(this,To).serialize(i,R(this,Ui,Lb).call(this))},nF=function(i,n){this._freeHighlight.add(n)&&i.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},rF=function(i,n){this._freeHighlight.isEmpty()?i.drawLayer.remove(this._freeHighlightId):i.createAndAddNewEditor(n,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},aF=function(i){const{color:n}=this._initialData;return i.color.some((o,l)=>o!==n[l])},j(vs,No),St(vs,"_defaultColor",null),St(vs,"_defaultOpacity",1),St(vs,"_defaultThickness",12),St(vs,"_type","highlight"),St(vs,"_editorType",Li.HIGHLIGHT),St(vs,"_freeHighlightId",-1),St(vs,"_freeHighlight",null),St(vs,"_freeHighlightClipId","");let KS=vs;var ip;class oF{constructor(){j(this,ip,Object.create(null))}updateProperty(t,i){this[t]=i,this.updateSVGProperty(t,i)}updateProperties(t){if(t)for(const[i,n]of Object.entries(t))i.startsWith("_")||this.updateProperty(i,n)}updateSVGProperty(t,i){u(this,ip)[t]=i}toSVGProperties(){const t=u(this,ip);return D(this,ip,Object.create(null)),{root:t}}reset(){D(this,ip,Object.create(null))}updateAll(t=this){this.updateProperties(t)}clone(){Bs("Not implemented")}}ip=new WeakMap;var Ka,l0,pr,sp,np,Rc,Mc,Oc,rp,ds,GC,XC,KC,Nb,lF,pS,Rb,Zg;const Qt=class Qt extends Ys{constructor(i){super(i);j(this,ds);j(this,Ka,null);j(this,l0);St(this,"_drawId",null);D(this,l0,i.mustBeCommitted||!1),this._addOutlines(i)}_addOutlines(i){i.drawOutlines&&(R(this,ds,GC).call(this,i),R(this,ds,Nb).call(this))}static _mergeSVGProperties(i,n){const o=new Set(Object.keys(i));for(const[l,c]of Object.entries(n))o.has(l)?Object.assign(i[l],c):i[l]=c;return i}static getDefaultDrawingOptions(i){Bs("Not implemented")}static get typesMap(){Bs("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(i,n){const o=this.typesMap.get(i);o&&this._defaultDrawingOptions.updateProperty(o,n),this._currentParent&&(u(Qt,pr).updateProperty(o,n),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(i,n){const o=this.constructor.typesMap.get(i);o&&this._updateProperty(i,o,n)}static get defaultPropertiesToUpdate(){const i=[],n=this._defaultDrawingOptions;for(const[o,l]of this.typesMap)i.push([o,n[l]]);return i}get propertiesToUpdate(){const i=[],{_drawingOptions:n}=this;for(const[o,l]of this.constructor.typesMap)i.push([o,n[l]]);return i}_updateProperty(i,n,o){const l=this._drawingOptions,c=l[n],d=f=>{var b;l.updateProperty(n,f);const m=u(this,Ka).updateProperty(n,f);m&&R(this,ds,Rb).call(this,m),(b=this.parent)==null||b.drawLayer.updateProperties(this._drawId,l.toSVGProperties())};this.addCommands({cmd:d.bind(this,o),undo:d.bind(this,c),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:i,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var i;(i=this.parent)==null||i.drawLayer.updateProperties(this._drawId,Qt._mergeSVGProperties(u(this,Ka).getPathResizingSVGProperties(R(this,ds,pS).call(this)),{bbox:R(this,ds,Zg).call(this)}))}_onResized(){var i;(i=this.parent)==null||i.drawLayer.updateProperties(this._drawId,Qt._mergeSVGProperties(u(this,Ka).getPathResizedSVGProperties(R(this,ds,pS).call(this)),{bbox:R(this,ds,Zg).call(this)}))}_onTranslating(i,n){var o;(o=this.parent)==null||o.drawLayer.updateProperties(this._drawId,{bbox:R(this,ds,Zg).call(this)})}_onTranslated(){var i;(i=this.parent)==null||i.drawLayer.updateProperties(this._drawId,Qt._mergeSVGProperties(u(this,Ka).getPathTranslatedSVGProperties(R(this,ds,pS).call(this),this.parentDimensions),{bbox:R(this,ds,Zg).call(this)}))}_onStartDragging(){var i;(i=this.parent)==null||i.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var i;(i=this.parent)==null||i.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(i){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,u(this,l0)&&(D(this,l0,!1),this.commit(),this.parent.setSelected(this),i&&this.isOnScreen&&this.div.focus())}remove(){R(this,ds,KC).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(R(this,ds,Nb).call(this),R(this,ds,Rb).call(this,u(this,Ka).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(i){var o;let n=!1;this.parent&&!i?(this._uiManager.removeShouldRescale(this),R(this,ds,KC).call(this)):i&&(this._uiManager.addShouldRescale(this),R(this,ds,Nb).call(this,i),n=!this.parent&&((o=this.div)==null?void 0:o.classList.contains("selectedEditor"))),super.setParent(i),n&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,Qt._mergeSVGProperties({bbox:R(this,ds,Zg).call(this)},u(this,Ka).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&R(this,ds,Rb).call(this,u(this,Ka).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let i,n;this._isCopy&&(i=this.x,n=this.y);const o=super.render();o.classList.add("draw");const l=document.createElement("div");o.append(l),l.setAttribute("aria-hidden","true"),l.className="internal";const[c,d]=this.parentDimensions;return this.setDims(this.width*c,this.height*d),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(i,n),o}static createDrawerInstance(i,n,o,l,c){Bs("Not implemented")}static startDrawing(i,n,o,l){var F;const{target:c,offsetX:d,offsetY:f,pointerId:m,pointerType:b}=l;if(u(Qt,Mc)&&u(Qt,Mc)!==b)return;const{viewport:{rotation:T}}=i,{width:C,height:P}=c.getBoundingClientRect(),x=D(Qt,sp,new AbortController),L=i.combinedSignal(x);if(u(Qt,Rc)||D(Qt,Rc,m),u(Qt,Mc)??D(Qt,Mc,b),window.addEventListener("pointerup",X=>{var re;u(Qt,Rc)===X.pointerId?this._endDraw(X):(re=u(Qt,Oc))==null||re.delete(X.pointerId)},{signal:L}),window.addEventListener("pointercancel",X=>{var re;u(Qt,Rc)===X.pointerId?this._currentParent.endDrawingSession():(re=u(Qt,Oc))==null||re.delete(X.pointerId)},{signal:L}),window.addEventListener("pointerdown",X=>{u(Qt,Mc)===X.pointerType&&((u(Qt,Oc)||D(Qt,Oc,new Set)).add(X.pointerId),u(Qt,pr).isCancellable()&&(u(Qt,pr).removeLastElement(),u(Qt,pr).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:L}),window.addEventListener("contextmenu",Mo,{signal:L}),c.addEventListener("pointermove",this._drawMove.bind(this),{signal:L}),c.addEventListener("touchmove",X=>{X.timeStamp===u(Qt,rp)&&Nn(X)},{signal:L}),i.toggleDrawing(),(F=n._editorUndoBar)==null||F.hide(),u(Qt,pr)){i.drawLayer.updateProperties(this._currentDrawId,u(Qt,pr).startNew(d,f,C,P,T));return}n.updateUIForDefaultProperties(this),D(Qt,pr,this.createDrawerInstance(d,f,C,P,T)),D(Qt,np,this.getDefaultDrawingOptions()),this._currentParent=i,{id:this._currentDrawId}=i.drawLayer.draw(this._mergeSVGProperties(u(Qt,np).toSVGProperties(),u(Qt,pr).defaultSVGProperties),!0,!1)}static _drawMove(i){var c;if(D(Qt,rp,-1),!u(Qt,pr))return;const{offsetX:n,offsetY:o,pointerId:l}=i;if(u(Qt,Rc)===l){if(((c=u(Qt,Oc))==null?void 0:c.size)>=1){this._endDraw(i);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,u(Qt,pr).add(n,o)),D(Qt,rp,i.timeStamp),Nn(i)}}static _cleanup(i){i&&(this._currentDrawId=-1,this._currentParent=null,D(Qt,pr,null),D(Qt,np,null),D(Qt,Mc,null),D(Qt,rp,NaN)),u(Qt,sp)&&(u(Qt,sp).abort(),D(Qt,sp,null),D(Qt,Rc,NaN),D(Qt,Oc,null))}static _endDraw(i){const n=this._currentParent;if(n){if(n.toggleDrawing(!0),this._cleanup(!1),(i==null?void 0:i.target)===n.div&&n.drawLayer.updateProperties(this._currentDrawId,u(Qt,pr).end(i.offsetX,i.offsetY)),this.supportMultipleDrawings){const o=u(Qt,pr),l=this._currentDrawId,c=o.getLastElement();n.addCommands({cmd:()=>{n.drawLayer.updateProperties(l,o.setLastElement(c))},undo:()=>{n.drawLayer.updateProperties(l,o.removeLastElement())},mustExec:!1,type:as.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(i){const n=this._currentParent;if(!n)return null;if(n.toggleDrawing(!0),n.cleanUndoStack(as.DRAW_STEP),!u(Qt,pr).isEmpty()){const{pageDimensions:[o,l],scale:c}=n,d=n.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:u(Qt,pr).getOutlines(o*c,l*c,c,this._INNER_MARGIN),drawingOptions:u(Qt,np),mustBeCommitted:!i});return this._cleanup(!0),d}return n.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(i){}static deserializeDraw(i,n,o,l,c,d){Bs("Not implemented")}static async deserialize(i,n,o){var T,C;const{rawDims:{pageWidth:l,pageHeight:c,pageX:d,pageY:f}}=n.viewport,m=this.deserializeDraw(d,f,l,c,this._INNER_MARGIN,i),b=await super.deserialize(i,n,o);return b.createDrawingOptions(i),R(T=b,ds,GC).call(T,{drawOutlines:m}),R(C=b,ds,Nb).call(C),b.onScaleChanging(),b.rotate(),b}serializeDraw(i){const[n,o]=this.pageTranslation,[l,c]=this.pageDimensions;return u(this,Ka).serialize([n,o,l,c],i)}renderAnnotationElement(i){return i.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};Ka=new WeakMap,l0=new WeakMap,pr=new WeakMap,sp=new WeakMap,np=new WeakMap,Rc=new WeakMap,Mc=new WeakMap,Oc=new WeakMap,rp=new WeakMap,ds=new WeakSet,GC=function({drawOutlines:i,drawId:n,drawingOptions:o}){D(this,Ka,i),this._drawingOptions||(this._drawingOptions=o),n>=0?(this._drawId=n,this.parent.drawLayer.finalizeDraw(n,i.defaultProperties)):this._drawId=R(this,ds,XC).call(this,i,this.parent),R(this,ds,Rb).call(this,i.box)},XC=function(i,n){const{id:o}=n.drawLayer.draw(Qt._mergeSVGProperties(this._drawingOptions.toSVGProperties(),i.defaultSVGProperties),!1,!1);return o},KC=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},Nb=function(i=this.parent){if(!(this._drawId!==null&&this.parent===i)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,i.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=R(this,ds,XC).call(this,u(this,Ka),i)}},lF=function([i,n,o,l]){const{parentDimensions:[c,d],rotation:f}=this;switch(f){case 90:return[n,1-i,o*(d/c),l*(c/d)];case 180:return[1-i,1-n,o,l];case 270:return[1-n,i,o*(d/c),l*(c/d)];default:return[i,n,o,l]}},pS=function(){const{x:i,y:n,width:o,height:l,parentDimensions:[c,d],rotation:f}=this;switch(f){case 90:return[1-n,i,o*(c/d),l*(d/c)];case 180:return[1-i,1-n,o,l];case 270:return[n,1-i,o*(c/d),l*(d/c)];default:return[i,n,o,l]}},Rb=function(i){if([this.x,this.y,this.width,this.height]=R(this,ds,lF).call(this,i),this.div){this.fixAndSetPosition();const[n,o]=this.parentDimensions;this.setDims(this.width*n,this.height*o)}this._onResized()},Zg=function(){const{x:i,y:n,width:o,height:l,rotation:c,parentRotation:d,parentDimensions:[f,m]}=this;switch((c*4+d)/90){case 1:return[1-n-l,i,l,o];case 2:return[1-i-o,1-n-l,o,l];case 3:return[n,1-i-o,l,o];case 4:return[i,n-o*(f/m),l*(m/f),o*(f/m)];case 5:return[1-n,i,o*(f/m),l*(m/f)];case 6:return[1-i-l*(m/f),1-n,l*(m/f),o*(f/m)];case 7:return[n-o*(f/m),1-i-l*(m/f),o*(f/m),l*(m/f)];case 8:return[i-o,n-l,o,l];case 9:return[1-n,i-o,l,o];case 10:return[1-i,1-n,o,l];case 11:return[n-l,1-i,l,o];case 12:return[i-l*(m/f),n,l*(m/f),o*(f/m)];case 13:return[1-n-o*(f/m),i-l*(m/f),o*(f/m),l*(m/f)];case 14:return[1-i,1-n-o*(f/m),l*(m/f),o*(f/m)];case 15:return[n,1-i,o*(f/m),l*(m/f)];default:return[i,n,o,l]}},St(Qt,"_currentDrawId",-1),St(Qt,"_currentParent",null),j(Qt,pr,null),j(Qt,sp,null),j(Qt,np,null),j(Qt,Rc,NaN),j(Qt,Mc,null),j(Qt,Oc,null),j(Qt,rp,NaN),St(Qt,"_INNER_MARGIN",3);let YS=Qt;var Kl,gr,mr,ap,u0,ea,Cr,So,op,lp,up,h0,gS;class xz{constructor(t,i,n,o,l,c){j(this,h0);j(this,Kl,new Float64Array(6));j(this,gr);j(this,mr);j(this,ap);j(this,u0);j(this,ea);j(this,Cr,"");j(this,So,0);j(this,op,new cT);j(this,lp);j(this,up);D(this,lp,n),D(this,up,o),D(this,ap,l),D(this,u0,c),[t,i]=R(this,h0,gS).call(this,t,i);const d=D(this,gr,[NaN,NaN,NaN,NaN,t,i]);D(this,ea,[t,i]),D(this,mr,[{line:d,points:u(this,ea)}]),u(this,Kl).set(d,0)}updateProperty(t,i){t==="stroke-width"&&D(this,u0,i)}isEmpty(){return!u(this,mr)||u(this,mr).length===0}isCancellable(){return u(this,ea).length<=10}add(t,i){[t,i]=R(this,h0,gS).call(this,t,i);const[n,o,l,c]=u(this,Kl).subarray(2,6),d=t-l,f=i-c;return Math.hypot(u(this,lp)*d,u(this,up)*f)<=2?null:(u(this,ea).push(t,i),isNaN(n)?(u(this,Kl).set([l,c,t,i],2),u(this,gr).push(NaN,NaN,NaN,NaN,t,i),{path:{d:this.toSVGPath()}}):(isNaN(u(this,Kl)[0])&&u(this,gr).splice(6,6),u(this,Kl).set([n,o,l,c,t,i],0),u(this,gr).push(...Zt.createBezierPoints(n,o,l,c,t,i)),{path:{d:this.toSVGPath()}}))}end(t,i){const n=this.add(t,i);return n||(u(this,ea).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(t,i,n,o,l){D(this,lp,n),D(this,up,o),D(this,ap,l),[t,i]=R(this,h0,gS).call(this,t,i);const c=D(this,gr,[NaN,NaN,NaN,NaN,t,i]);D(this,ea,[t,i]);const d=u(this,mr).at(-1);return d&&(d.line=new Float32Array(d.line),d.points=new Float32Array(d.points)),u(this,mr).push({line:c,points:u(this,ea)}),u(this,Kl).set(c,0),D(this,So,0),this.toSVGPath(),null}getLastElement(){return u(this,mr).at(-1)}setLastElement(t){return u(this,mr)?(u(this,mr).push(t),D(this,gr,t.line),D(this,ea,t.points),D(this,So,0),{path:{d:this.toSVGPath()}}):u(this,op).setLastElement(t)}removeLastElement(){if(!u(this,mr))return u(this,op).removeLastElement();u(this,mr).pop(),D(this,Cr,"");for(let t=0,i=u(this,mr).length;t<i;t++){const{line:n,points:o}=u(this,mr)[t];D(this,gr,n),D(this,ea,o),D(this,So,0),this.toSVGPath()}return{path:{d:u(this,Cr)}}}toSVGPath(){const t=Zt.svgRound(u(this,gr)[4]),i=Zt.svgRound(u(this,gr)[5]);if(u(this,ea).length===2)return D(this,Cr,`${u(this,Cr)} M ${t} ${i} Z`),u(this,Cr);if(u(this,ea).length<=6){const o=u(this,Cr).lastIndexOf("M");D(this,Cr,`${u(this,Cr).slice(0,o)} M ${t} ${i}`),D(this,So,6)}if(u(this,ea).length===4){const o=Zt.svgRound(u(this,gr)[10]),l=Zt.svgRound(u(this,gr)[11]);return D(this,Cr,`${u(this,Cr)} L ${o} ${l}`),D(this,So,12),u(this,Cr)}const n=[];u(this,So)===0&&(n.push(`M ${t} ${i}`),D(this,So,6));for(let o=u(this,So),l=u(this,gr).length;o<l;o+=6){const[c,d,f,m,b,T]=u(this,gr).slice(o,o+6).map(Zt.svgRound);n.push(`C${c} ${d} ${f} ${m} ${b} ${T}`)}return D(this,Cr,u(this,Cr)+n.join(" ")),D(this,So,u(this,gr).length),u(this,Cr)}getOutlines(t,i,n,o){const l=u(this,mr).at(-1);return l.line=new Float32Array(l.line),l.points=new Float32Array(l.points),u(this,op).build(u(this,mr),t,i,n,u(this,ap),u(this,u0),o),D(this,Kl,null),D(this,gr,null),D(this,mr,null),D(this,Cr,null),u(this,op)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}Kl=new WeakMap,gr=new WeakMap,mr=new WeakMap,ap=new WeakMap,u0=new WeakMap,ea=new WeakMap,Cr=new WeakMap,So=new WeakMap,op=new WeakMap,lp=new WeakMap,up=new WeakMap,h0=new WeakSet,gS=function(t,i){return Zt._normalizePoint(t,i,u(this,lp),u(this,up),u(this,ap))};var ta,Fv,Bv,Ya,Yl,Zl,c0,d0,hp,Dr,ku,uF,hF,cF;class cT extends Zt{constructor(){super(...arguments);j(this,Dr);j(this,ta);j(this,Fv,0);j(this,Bv);j(this,Ya);j(this,Yl);j(this,Zl);j(this,c0);j(this,d0);j(this,hp)}build(i,n,o,l,c,d,f){D(this,Yl,n),D(this,Zl,o),D(this,c0,l),D(this,d0,c),D(this,hp,d),D(this,Bv,f??0),D(this,Ya,i),R(this,Dr,hF).call(this)}get thickness(){return u(this,hp)}setLastElement(i){return u(this,Ya).push(i),{path:{d:this.toSVGPath()}}}removeLastElement(){return u(this,Ya).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const i=[];for(const{line:n}of u(this,Ya)){if(i.push(`M${Zt.svgRound(n[4])} ${Zt.svgRound(n[5])}`),n.length===6){i.push("Z");continue}if(n.length===12&&isNaN(n[6])){i.push(`L${Zt.svgRound(n[10])} ${Zt.svgRound(n[11])}`);continue}for(let o=6,l=n.length;o<l;o+=6){const[c,d,f,m,b,T]=n.subarray(o,o+6).map(Zt.svgRound);i.push(`C${c} ${d} ${f} ${m} ${b} ${T}`)}}return i.join("")}serialize([i,n,o,l],c){const d=[],f=[],[m,b,T,C]=R(this,Dr,uF).call(this);let P,x,L,F,X,re,K,te,ee;switch(u(this,d0)){case 0:ee=Zt._rescale,P=i,x=n+l,L=o,F=-l,X=i+m*o,re=n+(1-b-C)*l,K=i+(m+T)*o,te=n+(1-b)*l;break;case 90:ee=Zt._rescaleAndSwap,P=i,x=n,L=o,F=l,X=i+b*o,re=n+m*l,K=i+(b+C)*o,te=n+(m+T)*l;break;case 180:ee=Zt._rescale,P=i+o,x=n,L=-o,F=l,X=i+(1-m-T)*o,re=n+b*l,K=i+(1-m)*o,te=n+(b+C)*l;break;case 270:ee=Zt._rescaleAndSwap,P=i+o,x=n+l,L=-o,F=-l,X=i+(1-b-C)*o,re=n+(1-m-T)*l,K=i+(1-b)*o,te=n+(1-m)*l;break}for(const{line:A,points:me}of u(this,Ya))d.push(ee(A,P,x,L,F,c?new Array(A.length):null)),f.push(ee(me,P,x,L,F,c?new Array(me.length):null));return{lines:d,points:f,rect:[X,re,K,te]}}static deserialize(i,n,o,l,c,{paths:{lines:d,points:f},rotation:m,thickness:b}){const T=[];let C,P,x,L,F;switch(m){case 0:F=Zt._rescale,C=-i/o,P=n/l+1,x=1/o,L=-1/l;break;case 90:F=Zt._rescaleAndSwap,C=-n/l,P=-i/o,x=1/l,L=1/o;break;case 180:F=Zt._rescale,C=i/o+1,P=-n/l,x=-1/o,L=1/l;break;case 270:F=Zt._rescaleAndSwap,C=n/l+1,P=i/o+1,x=-1/l,L=-1/o;break}if(!d){d=[];for(const re of f){const K=re.length;if(K===2){d.push(new Float32Array([NaN,NaN,NaN,NaN,re[0],re[1]]));continue}if(K===4){d.push(new Float32Array([NaN,NaN,NaN,NaN,re[0],re[1],NaN,NaN,NaN,NaN,re[2],re[3]]));continue}const te=new Float32Array(3*(K-2));d.push(te);let[ee,A,me,fe]=re.subarray(0,4);te.set([NaN,NaN,NaN,NaN,ee,A],0);for(let J=4;J<K;J+=2){const ye=re[J],Oe=re[J+1];te.set(Zt.createBezierPoints(ee,A,me,fe,ye,Oe),(J-2)*3),[ee,A,me,fe]=[me,fe,ye,Oe]}}}for(let re=0,K=d.length;re<K;re++)T.push({line:F(d[re].map(te=>te??NaN),C,P,x,L),points:F(f[re].map(te=>te??NaN),C,P,x,L)});const X=new this.prototype.constructor;return X.build(T,o,l,1,m,b,c),X}get box(){return u(this,ta)}updateProperty(i,n){return i==="stroke-width"?R(this,Dr,cF).call(this,n):null}updateParentDimensions([i,n],o){const[l,c]=R(this,Dr,ku).call(this);D(this,Yl,i),D(this,Zl,n),D(this,c0,o);const[d,f]=R(this,Dr,ku).call(this),m=d-l,b=f-c,T=u(this,ta);return T[0]-=m,T[1]-=b,T[2]+=2*m,T[3]+=2*b,T}updateRotation(i){return D(this,Fv,i),{path:{transform:this.rotationTransform}}}get viewBox(){return u(this,ta).map(Zt.svgRound).join(" ")}get defaultProperties(){const[i,n]=u(this,ta);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Zt.svgRound(i)} ${Zt.svgRound(n)}`}}}get rotationTransform(){const[,,i,n]=u(this,ta);let o=0,l=0,c=0,d=0,f=0,m=0;switch(u(this,Fv)){case 90:l=n/i,c=-i/n,f=i;break;case 180:o=-1,d=-1,f=i,m=n;break;case 270:l=-n/i,c=i/n,m=n;break;default:return""}return`matrix(${o} ${l} ${c} ${d} ${Zt.svgRound(f)} ${Zt.svgRound(m)})`}getPathResizingSVGProperties([i,n,o,l]){const[c,d]=R(this,Dr,ku).call(this),[f,m,b,T]=u(this,ta);if(Math.abs(b-c)<=Zt.PRECISION||Math.abs(T-d)<=Zt.PRECISION){const F=i+o/2-(f+b/2),X=n+l/2-(m+T/2);return{path:{"transform-origin":`${Zt.svgRound(i)} ${Zt.svgRound(n)}`,transform:`${this.rotationTransform} translate(${F} ${X})`}}}const C=(o-2*c)/(b-2*c),P=(l-2*d)/(T-2*d),x=b/o,L=T/l;return{path:{"transform-origin":`${Zt.svgRound(f)} ${Zt.svgRound(m)}`,transform:`${this.rotationTransform} scale(${x} ${L}) translate(${Zt.svgRound(c)} ${Zt.svgRound(d)}) scale(${C} ${P}) translate(${Zt.svgRound(-c)} ${Zt.svgRound(-d)})`}}}getPathResizedSVGProperties([i,n,o,l]){const[c,d]=R(this,Dr,ku).call(this),f=u(this,ta),[m,b,T,C]=f;if(f[0]=i,f[1]=n,f[2]=o,f[3]=l,Math.abs(T-c)<=Zt.PRECISION||Math.abs(C-d)<=Zt.PRECISION){const X=i+o/2-(m+T/2),re=n+l/2-(b+C/2);for(const{line:K,points:te}of u(this,Ya))Zt._translate(K,X,re,K),Zt._translate(te,X,re,te);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Zt.svgRound(i)} ${Zt.svgRound(n)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const P=(o-2*c)/(T-2*c),x=(l-2*d)/(C-2*d),L=-P*(m+c)+i+c,F=-x*(b+d)+n+d;if(P!==1||x!==1||L!==0||F!==0)for(const{line:X,points:re}of u(this,Ya))Zt._rescale(X,L,F,P,x,X),Zt._rescale(re,L,F,P,x,re);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Zt.svgRound(i)} ${Zt.svgRound(n)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([i,n],o){const[l,c]=o,d=u(this,ta),f=i-d[0],m=n-d[1];if(u(this,Yl)===l&&u(this,Zl)===c)for(const{line:b,points:T}of u(this,Ya))Zt._translate(b,f,m,b),Zt._translate(T,f,m,T);else{const b=u(this,Yl)/l,T=u(this,Zl)/c;D(this,Yl,l),D(this,Zl,c);for(const{line:C,points:P}of u(this,Ya))Zt._rescale(C,f,m,b,T,C),Zt._rescale(P,f,m,b,T,P);d[2]*=b,d[3]*=T}return d[0]=i,d[1]=n,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${Zt.svgRound(i)} ${Zt.svgRound(n)}`}}}get defaultSVGProperties(){const i=u(this,ta);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${Zt.svgRound(i[0])} ${Zt.svgRound(i[1])}`,transform:this.rotationTransform||null},bbox:i}}}ta=new WeakMap,Fv=new WeakMap,Bv=new WeakMap,Ya=new WeakMap,Yl=new WeakMap,Zl=new WeakMap,c0=new WeakMap,d0=new WeakMap,hp=new WeakMap,Dr=new WeakSet,ku=function(i=u(this,hp)){const n=u(this,Bv)+i/2*u(this,c0);return u(this,d0)%180===0?[n/u(this,Yl),n/u(this,Zl)]:[n/u(this,Zl),n/u(this,Yl)]},uF=function(){const[i,n,o,l]=u(this,ta),[c,d]=R(this,Dr,ku).call(this,0);return[i+c,n+d,o-2*c,l-2*d]},hF=function(){const i=D(this,ta,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:l}of u(this,Ya)){if(l.length<=12){for(let f=4,m=l.length;f<m;f+=6)oi.pointBoundingBox(l[f],l[f+1],i);continue}let c=l[4],d=l[5];for(let f=6,m=l.length;f<m;f+=6){const[b,T,C,P,x,L]=l.subarray(f,f+6);oi.bezierBoundingBox(c,d,b,T,C,P,x,L,i),c=x,d=L}}const[n,o]=R(this,Dr,ku).call(this);i[0]=Vr(i[0]-n,0,1),i[1]=Vr(i[1]-o,0,1),i[2]=Vr(i[2]+n,0,1),i[3]=Vr(i[3]+o,0,1),i[2]-=i[0],i[3]-=i[1]},cF=function(i){const[n,o]=R(this,Dr,ku).call(this);D(this,hp,i);const[l,c]=R(this,Dr,ku).call(this),[d,f]=[l-n,c-o],m=u(this,ta);return m[0]-=d,m[1]-=f,m[2]+=2*d,m[3]+=2*f,m};class Px extends oF{constructor(t){super(),this._viewParameters=t,super.updateProperties({fill:"none",stroke:Ys._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,i){t==="stroke-width"&&(i??(i=this["stroke-width"]),i*=this._viewParameters.realScale),super.updateSVGProperty(t,i)}clone(){const t=new Px(this._viewParameters);return t.updateAll(this),t}}var gx,dF;const sm=class sm extends YS{constructor(i){super({...i,name:"inkEditor"});j(this,gx);this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(i,n){Ys.initialize(i,n),this._defaultDrawingOptions=new Px(n.viewParameters)}static getDefaultDrawingOptions(i){const n=this._defaultDrawingOptions.clone();return n.updateProperties(i),n}static get supportMultipleDrawings(){return!0}static get typesMap(){return is(this,"typesMap",new Map([[as.INK_THICKNESS,"stroke-width"],[as.INK_COLOR,"stroke"],[as.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(i,n,o,l,c){return new xz(i,n,o,l,c,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(i,n,o,l,c,d){return cT.deserialize(i,n,o,l,c,d)}static async deserialize(i,n,o){let l=null;if(i instanceof tP){const{data:{inkLists:d,rect:f,rotation:m,id:b,color:T,opacity:C,borderStyle:{rawWidth:P},popupRef:x},parent:{page:{pageNumber:L}}}=i;l=i={annotationType:Li.INK,color:Array.from(T),thickness:P,opacity:C,paths:{points:d},boxes:null,pageIndex:L-1,rect:f.slice(0),rotation:m,id:b,deleted:!1,popupRef:x}}const c=await super.deserialize(i,n,o);return c.annotationElementId=i.id||null,c._initialData=l,c}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:i,_drawingOptions:n,parent:o}=this;n.updateSVGProperty("stroke-width"),o.drawLayer.updateProperties(i,n.toSVGProperties())}static onScaleChangingWhenDrawing(){const i=this._currentParent;i&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),i.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:i,thickness:n,opacity:o}){this._drawingOptions=sm.getDefaultDrawingOptions({stroke:oi.makeHexColor(...i),"stroke-width":n,"stroke-opacity":o})}serialize(i=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:n,points:o,rect:l}=this.serializeDraw(i),{_drawingOptions:{stroke:c,"stroke-opacity":d,"stroke-width":f}}=this,m={annotationType:Li.INK,color:Ys._colorManager.convert(c),opacity:d,thickness:f,paths:{lines:n,points:o},pageIndex:this.pageIndex,rect:l,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return i?(m.isCopy=!0,m):this.annotationElementId&&!R(this,gx,dF).call(this,m)?null:(m.id=this.annotationElementId,m)}renderAnnotationElement(i){const{points:n,rect:o}=this.serializeDraw(!1);return i.updateEdited({rect:o,thickness:this._drawingOptions["stroke-width"],points:n}),null}};gx=new WeakSet,dF=function(i){const{color:n,thickness:o,opacity:l,pageIndex:c}=this._initialData;return this._hasBeenMoved||this._hasBeenResized||i.color.some((d,f)=>d!==n[f])||i.thickness!==o||i.opacity!==l||i.pageIndex!==c},St(sm,"_type","ink"),St(sm,"_editorType",Li.INK),St(sm,"_defaultDrawingOptions",null);let YC=sm;class ZC extends cT{toSVGPath(){let t=super.toSVGPath();return t.endsWith("Z")||(t+="Z"),t}}const ME=8,gb=3;var _b,cp,Cs,QC,tl,fF,pF,JC,mS,gF,mF,_F,e2,t2,bF;let af=(_b=class{static extractContoursFromText(t,{fontFamily:i,fontStyle:n,fontWeight:o},l,c,d,f){let m=new OffscreenCanvas(1,1),b=m.getContext("2d",{alpha:!1});const T=200,C=b.font=`${n} ${o} ${T}px ${i}`,{actualBoundingBoxLeft:P,actualBoundingBoxRight:x,actualBoundingBoxAscent:L,actualBoundingBoxDescent:F,fontBoundingBoxAscent:X,fontBoundingBoxDescent:re,width:K}=b.measureText(t),te=1.5,ee=Math.ceil(Math.max(Math.abs(P)+Math.abs(x)||0,K)*te),A=Math.ceil(Math.max(Math.abs(L)+Math.abs(F)||T,Math.abs(X)+Math.abs(re)||T)*te);m=new OffscreenCanvas(ee,A),b=m.getContext("2d",{alpha:!0,willReadFrequently:!0}),b.font=C,b.filter="grayscale(1)",b.fillStyle="white",b.fillRect(0,0,ee,A),b.fillStyle="black",b.fillText(t,ee*(te-1)/2,A*(3-te)/2);const me=R(this,Cs,e2).call(this,b.getImageData(0,0,ee,A).data),fe=R(this,Cs,_F).call(this,me),J=R(this,Cs,t2).call(this,fe),ye=R(this,Cs,JC).call(this,me,ee,A,J);return this.processDrawnLines({lines:{curves:ye,width:ee,height:A},pageWidth:l,pageHeight:c,rotation:d,innerMargin:f,mustSmooth:!0,areContours:!0})}static process(t,i,n,o,l){const[c,d,f]=R(this,Cs,bF).call(this,t),[m,b]=R(this,Cs,mF).call(this,c,d,f,Math.hypot(d,f)*u(this,cp).sigmaSFactor,u(this,cp).sigmaR,u(this,cp).kernelSize),T=R(this,Cs,t2).call(this,b),C=R(this,Cs,JC).call(this,m,d,f,T);return this.processDrawnLines({lines:{curves:C,width:d,height:f},pageWidth:i,pageHeight:n,rotation:o,innerMargin:l,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:t,pageWidth:i,pageHeight:n,rotation:o,innerMargin:l,mustSmooth:c,areContours:d}){o%180!==0&&([i,n]=[n,i]);const{curves:f,width:m,height:b}=t,T=t.thickness??0,C=[],P=Math.min(i/m,n/b),x=P/i,L=P/n,F=[];for(const{points:re}of f){const K=c?R(this,Cs,gF).call(this,re):re;if(!K)continue;F.push(K);const te=K.length,ee=new Float32Array(te),A=new Float32Array(3*(te===2?2:te-2));if(C.push({line:A,points:ee}),te===2){ee[0]=K[0]*x,ee[1]=K[1]*L,A.set([NaN,NaN,NaN,NaN,ee[0],ee[1]],0);continue}let[me,fe,J,ye]=K;me*=x,fe*=L,J*=x,ye*=L,ee.set([me,fe,J,ye],0),A.set([NaN,NaN,NaN,NaN,me,fe],0);for(let Oe=4;Oe<te;Oe+=2){const ot=ee[Oe]=K[Oe]*x,Tt=ee[Oe+1]=K[Oe+1]*L;A.set(Zt.createBezierPoints(me,fe,J,ye,ot,Tt),(Oe-2)*3),[me,fe,J,ye]=[J,ye,ot,Tt]}}if(C.length===0)return null;const X=d?new ZC:new cT;return X.build(C,i,n,1,o,d?0:T,l),{outline:X,newCurves:F,areContours:d,thickness:T,width:m,height:b}}static async compressSignature({outlines:t,areContours:i,thickness:n,width:o,height:l}){let c=1/0,d=-1/0,f=0;for(const K of t){f+=K.length;for(let te=2,ee=K.length;te<ee;te++){const A=K[te]-K[te-2];c=Math.min(c,A),d=Math.max(d,A)}}let m;c>=-128&&d<=127?m=Int8Array:c>=-32768&&d<=32767?m=Int16Array:m=Int32Array;const b=t.length,T=ME+gb*b,C=new Uint32Array(T);let P=0;C[P++]=T*Uint32Array.BYTES_PER_ELEMENT+(f-2*b)*m.BYTES_PER_ELEMENT,C[P++]=0,C[P++]=o,C[P++]=l,C[P++]=i?0:1,C[P++]=Math.max(0,Math.floor(n??0)),C[P++]=b,C[P++]=m.BYTES_PER_ELEMENT;for(const K of t)C[P++]=K.length-2,C[P++]=K[0],C[P++]=K[1];const x=new CompressionStream("deflate-raw"),L=x.writable.getWriter();await L.ready,L.write(C);const F=m.prototype.constructor;for(const K of t){const te=new F(K.length-2);for(let ee=2,A=K.length;ee<A;ee++)te[ee-2]=K[ee]-K[ee-2];L.write(te)}L.close();const X=await new Response(x.readable).arrayBuffer(),re=new Uint8Array(X);return dM(re)}static async decompressSignature(t){try{const i=t$(t),{readable:n,writable:o}=new DecompressionStream("deflate-raw"),l=o.getWriter();await l.ready,l.write(i).then(async()=>{await l.ready,await l.close()}).catch(()=>{});let c=null,d=0;for await(const K of n)c||(c=new Uint8Array(new Uint32Array(K.buffer,0,4)[0])),c.set(K,d),d+=K.length;const f=new Uint32Array(c.buffer,0,c.length>>2),m=f[1];if(m!==0)throw new Error(`Invalid version: ${m}`);const b=f[2],T=f[3],C=f[4]===0,P=f[5],x=f[6],L=f[7],F=[],X=(ME+gb*x)*Uint32Array.BYTES_PER_ELEMENT;let re;switch(L){case Int8Array.BYTES_PER_ELEMENT:re=new Int8Array(c.buffer,X);break;case Int16Array.BYTES_PER_ELEMENT:re=new Int16Array(c.buffer,X);break;case Int32Array.BYTES_PER_ELEMENT:re=new Int32Array(c.buffer,X);break}d=0;for(let K=0;K<x;K++){const te=f[gb*K+ME],ee=new Float32Array(te+2);F.push(ee);for(let A=0;A<gb-1;A++)ee[A]=f[gb*K+ME+A+1];for(let A=0;A<te;A++)ee[A+2]=ee[A]+re[d++]}return{areContours:C,thickness:P,outlines:F,width:b,height:T}}catch(i){return Ri(`decompressSignature: ${i}`),null}}},cp=new WeakMap,Cs=new WeakSet,QC=function(t,i,n,o){return n-=t,o-=i,n===0?o>0?0:4:n===1?o+6:2-o},tl=new WeakMap,fF=function(t,i,n,o,l,c,d){const f=R(this,Cs,QC).call(this,n,o,l,c);for(let m=0;m<8;m++){const b=(-m+f-d+16)%8,T=u(this,tl)[2*b],C=u(this,tl)[2*b+1];if(t[(n+T)*i+(o+C)]!==0)return b}return-1},pF=function(t,i,n,o,l,c,d){const f=R(this,Cs,QC).call(this,n,o,l,c);for(let m=0;m<8;m++){const b=(m+f+d+16)%8,T=u(this,tl)[2*b],C=u(this,tl)[2*b+1];if(t[(n+T)*i+(o+C)]!==0)return b}return-1},JC=function(t,i,n,o){const l=t.length,c=new Int32Array(l);for(let b=0;b<l;b++)c[b]=t[b]<=o?1:0;for(let b=1;b<n-1;b++)c[b*i]=c[b*i+i-1]=0;for(let b=0;b<i;b++)c[b]=c[i*n-1-b]=0;let d=1,f;const m=[];for(let b=1;b<n-1;b++){f=1;for(let T=1;T<i-1;T++){const C=b*i+T,P=c[C];if(P===0)continue;let x=b,L=T;if(P===1&&c[C-1]===0)d+=1,L-=1;else if(P>=1&&c[C+1]===0)d+=1,L+=1,P>1&&(f=P);else{P!==1&&(f=Math.abs(P));continue}const F=[T,b],X=L===T+1,re={isHole:X,points:F,id:d,parent:0};m.push(re);let K;for(const Oe of m)if(Oe.id===f){K=Oe;break}K?K.isHole?re.parent=X?K.parent:f:re.parent=X?f:K.parent:re.parent=X?f:0;const te=R(this,Cs,fF).call(this,c,i,b,T,x,L,0);if(te===-1){c[C]=-d,c[C]!==1&&(f=Math.abs(c[C]));continue}let ee=u(this,tl)[2*te],A=u(this,tl)[2*te+1];const me=b+ee,fe=T+A;x=me,L=fe;let J=b,ye=T;for(;;){const Oe=R(this,Cs,pF).call(this,c,i,J,ye,x,L,1);ee=u(this,tl)[2*Oe],A=u(this,tl)[2*Oe+1];const ot=J+ee,Tt=ye+A;F.push(Tt,ot);const dt=J*i+ye;if(c[dt+1]===0?c[dt]=-d:c[dt]===1&&(c[dt]=d),ot===b&&Tt===T&&J===me&&ye===fe){c[C]!==1&&(f=Math.abs(c[C]));break}else x=J,L=ye,J=ot,ye=Tt}}}return m},mS=function(t,i,n,o){if(n-i<=4){for(let me=i;me<n-2;me+=2)o.push(t[me],t[me+1]);return}const l=t[i],c=t[i+1],d=t[n-4]-l,f=t[n-3]-c,m=Math.hypot(d,f),b=d/m,T=f/m,C=b*c-T*l,P=f/d,x=1/m,L=Math.atan(P),F=Math.cos(L),X=Math.sin(L),re=x*(Math.abs(F)+Math.abs(X)),K=x*(1-re+re**2),te=Math.max(Math.atan(Math.abs(X+F)*K),Math.atan(Math.abs(X-F)*K));let ee=0,A=i;for(let me=i+2;me<n-2;me+=2){const fe=Math.abs(C-b*t[me+1]+T*t[me]);fe>ee&&(A=me,ee=fe)}ee>(m*te)**2?(R(this,Cs,mS).call(this,t,i,A+2,o),R(this,Cs,mS).call(this,t,A,n,o)):o.push(l,c)},gF=function(t){const i=[],n=t.length;return R(this,Cs,mS).call(this,t,0,n,i),i.push(t[n-2],t[n-1]),i.length<=4?null:i},mF=function(t,i,n,o,l,c){const d=new Float32Array(c**2),f=-2*o**2,m=c>>1;for(let L=0;L<c;L++){const F=(L-m)**2;for(let X=0;X<c;X++)d[L*c+X]=Math.exp((F+(X-m)**2)/f)}const b=new Float32Array(256),T=-2*l**2;for(let L=0;L<256;L++)b[L]=Math.exp(L**2/T);const C=t.length,P=new Uint8Array(C),x=new Uint32Array(256);for(let L=0;L<n;L++)for(let F=0;F<i;F++){const X=L*i+F,re=t[X];let K=0,te=0;for(let A=0;A<c;A++){const me=L+A-m;if(!(me<0||me>=n))for(let fe=0;fe<c;fe++){const J=F+fe-m;if(J<0||J>=i)continue;const ye=t[me*i+J],Oe=d[A*c+fe]*b[Math.abs(ye-re)];K+=ye*Oe,te+=Oe}}const ee=P[X]=Math.round(K/te);x[ee]++}return[P,x]},_F=function(t){const i=new Uint32Array(256);for(const n of t)i[n]++;return i},e2=function(t){const i=t.length,n=new Uint8ClampedArray(i>>2);let o=-1/0,l=1/0;for(let d=0,f=n.length;d<f;d++){if(t[(d<<2)+3]===0){o=n[d]=255;continue}const b=n[d]=t[d<<2];b>o&&(o=b),b<l&&(l=b)}const c=255/(o-l);for(let d=0;d<i;d++)n[d]=(n[d]-l)*c;return n},t2=function(t){let i,n=-1/0,o=-1/0;const l=t.findIndex(f=>f!==0);let c=l,d=l;for(i=l;i<256;i++){const f=t[i];f>n&&(i-c>o&&(o=i-c,d=i-1),n=f,c=i)}for(i=d-1;i>=0&&!(t[i]>t[i+1]);i--);return i},bF=function(t){const i=t,{width:n,height:o}=t,{maxDim:l}=u(this,cp);let c=n,d=o;if(n>l||o>l){let C=n,P=o,x=Math.log2(Math.max(n,o)/l);const L=Math.floor(x);x=x===L?L-1:L;for(let X=0;X<x;X++){c=Math.ceil(C/2),d=Math.ceil(P/2);const re=new OffscreenCanvas(c,d);re.getContext("2d").drawImage(t,0,0,C,P,0,0,c,d),C=c,P=d,t!==i&&t.close(),t=re.transferToImageBitmap()}const F=Math.min(l/c,l/d);c=Math.round(c*F),d=Math.round(d*F)}const m=new OffscreenCanvas(c,d).getContext("2d",{willReadFrequently:!0});m.filter="grayscale(1)",m.drawImage(t,0,0,t.width,t.height,0,0,c,d);const b=m.getImageData(0,0,c,d).data;return[R(this,Cs,e2).call(this,b),c,d]},j(_b,Cs),j(_b,cp,{maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16}),j(_b,tl,new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1])),_b);class sP extends oF{constructor(){super(),super.updateProperties({fill:Ys._defaultLineColor,"stroke-width":0})}clone(){const t=new sP;return t.updateAll(this),t}}class nP extends Px{constructor(t){super(t),super.updateProperties({stroke:Ys._defaultLineColor,"stroke-width":1})}clone(){const t=new nP(this._viewParameters);return t.updateAll(this),t}}var Fc,Za,Bc,Uc;const Ua=class Ua extends YS{constructor(i){super({...i,mustBeCommitted:!0,name:"signatureEditor"});j(this,Fc,!1);j(this,Za,null);j(this,Bc,null);j(this,Uc,null);this._willKeepAspectRatio=!0,D(this,Bc,i.signatureData||null),D(this,Za,null),this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(i,n){Ys.initialize(i,n),this._defaultDrawingOptions=new sP,this._defaultDrawnSignatureOptions=new nP(n.viewParameters)}static getDefaultDrawingOptions(i){const n=this._defaultDrawingOptions.clone();return n.updateProperties(i),n}static get supportMultipleDrawings(){return!1}static get typesMap(){return is(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!u(this,Za)}}static computeTelemetryFinalData(i){const n=i.get("hasDescription");return{hasAltText:n.get(!0)??0,hasNoAltText:n.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let i,n;const{_isCopy:o}=this;if(o&&(this._isCopy=!1,i=this.x,n=this.y),super.render(),this._drawId===null)if(u(this,Bc)){const{lines:l,mustSmooth:c,areContours:d,description:f,uuid:m,heightInPage:b}=u(this,Bc),{rawDims:{pageWidth:T,pageHeight:C},rotation:P}=this.parent.viewport,x=af.processDrawnLines({lines:l,pageWidth:T,pageHeight:C,rotation:P,innerMargin:Ua._INNER_MARGIN,mustSmooth:c,areContours:d});this.addSignature(x,b,f,m)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);return o&&(this._isCopy=!0,this._moveAfterPaste(i,n)),this.div}setUuid(i){D(this,Uc,i),this.addEditToolbar()}getUuid(){return u(this,Uc)}get description(){return u(this,Za)}set description(i){D(this,Za,i),super.addEditToolbar().then(n=>{n==null||n.updateEditSignatureButton(i)})}getSignaturePreview(){const{newCurves:i,areContours:n,thickness:o,width:l,height:c}=u(this,Bc),d=Math.max(l,c),f=af.processDrawnLines({lines:{curves:i.map(m=>({points:m})),thickness:o,width:l,height:c},pageWidth:d,pageHeight:d,rotation:0,innerMargin:0,mustSmooth:!1,areContours:n});return{areContours:n,outline:f.outline}}async addEditToolbar(){const i=await super.addEditToolbar();return i?(this._uiManager.signatureManager&&u(this,Za)!==null&&(await i.addEditSignatureButton(this._uiManager.signatureManager,u(this,Uc),u(this,Za)),i.show()),i):null}addSignature(i,n,o,l){const{x:c,y:d}=this,{outline:f}=D(this,Bc,i);D(this,Fc,f instanceof ZC),D(this,Za,o),this.div.setAttribute("data-l10n-args",JSON.stringify({description:o}));let m;u(this,Fc)?m=Ua.getDefaultDrawingOptions():(m=Ua._defaultDrawnSignatureOptions.clone(),m.updateProperties({"stroke-width":f.thickness})),this._addOutlines({drawOutlines:f,drawingOptions:m});const[b,T]=this.parentDimensions,[,C]=this.pageDimensions;let P=n/C;P=P>=1?.5:P,this.width*=P/this.height,this.width>=1&&(P*=.9/this.width,this.width=.9),this.height=P,this.setDims(b*this.width,T*this.height),this.x=c,this.y=d,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(l),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!l,hasDescription:!!o}}),this.div.hidden=!1}getFromImage(i){const{rawDims:{pageWidth:n,pageHeight:o},rotation:l}=this.parent.viewport;return af.process(i,n,o,l,Ua._INNER_MARGIN)}getFromText(i,n){const{rawDims:{pageWidth:o,pageHeight:l},rotation:c}=this.parent.viewport;return af.extractContoursFromText(i,n,o,l,c,Ua._INNER_MARGIN)}getDrawnSignature(i){const{rawDims:{pageWidth:n,pageHeight:o},rotation:l}=this.parent.viewport;return af.processDrawnLines({lines:i,pageWidth:n,pageHeight:o,rotation:l,innerMargin:Ua._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:i,thickness:n}){i?this._drawingOptions=Ua.getDefaultDrawingOptions():(this._drawingOptions=Ua._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":n}))}serialize(i=!1){if(this.isEmpty())return null;const{lines:n,points:o,rect:l}=this.serializeDraw(i),{_drawingOptions:{"stroke-width":c}}=this,d={annotationType:Li.SIGNATURE,isSignature:!0,areContours:u(this,Fc),color:[0,0,0],thickness:u(this,Fc)?0:c,pageIndex:this.pageIndex,rect:l,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return i?(d.paths={lines:n,points:o},d.uuid=u(this,Uc),d.isCopy=!0):d.lines=n,u(this,Za)&&(d.accessibilityData={type:"Figure",alt:u(this,Za)}),d}static deserializeDraw(i,n,o,l,c,d){return d.areContours?ZC.deserialize(i,n,o,l,c,d):cT.deserialize(i,n,o,l,c,d)}static async deserialize(i,n,o){var c;const l=await super.deserialize(i,n,o);return D(l,Fc,i.areContours),D(l,Za,((c=i.accessibilityData)==null?void 0:c.alt)||""),D(l,Uc,i.uuid),l}};Fc=new WeakMap,Za=new WeakMap,Bc=new WeakMap,Uc=new WeakMap,St(Ua,"_type","signature"),St(Ua,"_editorType",Li.SIGNATURE),St(Ua,"_defaultDrawingOptions",null);let i2=Ua;var ln,_r,jc,sh,Hc,f0,nh,dp,Ql,Qa,p0,fs,Mb,Ob,_S,bS,yS,n2,vS,yF;class s2 extends Ys{constructor(i){super({...i,name:"stampEditor"});j(this,fs);j(this,ln,null);j(this,_r,null);j(this,jc,null);j(this,sh,null);j(this,Hc,null);j(this,f0,"");j(this,nh,null);j(this,dp,!1);j(this,Ql,null);j(this,Qa,!1);j(this,p0,!1);D(this,sh,i.bitmapUrl),D(this,Hc,i.bitmapFile),this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(i,n){Ys.initialize(i,n)}static isHandlingMimeForPasting(i){return zS.includes(i)}static paste(i,n){n.pasteEditor({mode:Li.STAMP},{bitmapFile:i.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var i;return{type:"stamp",hasAltText:!!((i=this.altTextData)!=null&&i.altText)}}static computeTelemetryFinalData(i){const n=i.get("hasAltText");return{hasAltText:n.get(!0)??0,hasNoAltText:n.get(!1)??0}}async mlGuessAltText(i=null,n=!0){if(this.hasAltTextData())return null;const{mlManager:o}=this._uiManager;if(!o)throw new Error("No ML.");if(!await o.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:l,width:c,height:d}=i||this.copyCanvas(null,null,!0).imageData,f=await o.guess({name:"altText",request:{data:l,width:c,height:d,channels:l.length/(c*d)}});if(!f)throw new Error("No response from the AI service.");if(f.error)throw new Error("Error from the AI service.");if(f.cancel)return null;if(!f.output)throw new Error("No valid response from the AI service.");const m=f.output;return await this.setGuessedAltText(m),n&&!this.hasAltTextData()&&(this.altTextData={alt:m,decorative:!1}),m}remove(){var i;u(this,_r)&&(D(this,ln,null),this._uiManager.imageManager.deleteId(u(this,_r)),(i=u(this,nh))==null||i.remove(),D(this,nh,null),u(this,Ql)&&(clearTimeout(u(this,Ql)),D(this,Ql,null))),super.remove()}rebuild(){if(!this.parent){u(this,_r)&&R(this,fs,_S).call(this);return}super.rebuild(),this.div!==null&&(u(this,_r)&&u(this,nh)===null&&R(this,fs,_S).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(i){this._isDraggable=!0,i&&this.div.focus()}isEmpty(){return!(u(this,jc)||u(this,ln)||u(this,sh)||u(this,Hc)||u(this,_r)||u(this,dp))}get isResizable(){return!0}render(){if(this.div)return this.div;let i,n;return this._isCopy&&(i=this.x,n=this.y),super.render(),this.div.hidden=!0,this.addAltTextButton(),u(this,dp)||(u(this,ln)?R(this,fs,bS).call(this):R(this,fs,_S).call(this)),this._isCopy&&this._moveAfterPaste(i,n),this._uiManager.addShouldRescale(this),this.div}setCanvas(i,n){const{id:o,bitmap:l}=this._uiManager.imageManager.getFromCanvas(i,n);n.remove(),o&&this._uiManager.imageManager.isValidId(o)&&(D(this,_r,o),l&&D(this,ln,l),D(this,dp,!1),R(this,fs,bS).call(this))}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;u(this,Ql)!==null&&clearTimeout(u(this,Ql)),D(this,Ql,setTimeout(()=>{D(this,Ql,null),R(this,fs,n2).call(this)},200))}copyCanvas(i,n,o=!1){var P;i||(i=224);const{width:l,height:c}=u(this,ln),d=new Pd;let f=u(this,ln),m=l,b=c,T=null;if(n){if(l>n||c>n){const fe=Math.min(n/l,n/c);m=Math.floor(l*fe),b=Math.floor(c*fe)}T=document.createElement("canvas");const x=T.width=Math.ceil(m*d.sx),L=T.height=Math.ceil(b*d.sy);u(this,Qa)||(f=R(this,fs,yS).call(this,x,L));const F=T.getContext("2d");F.filter=this._uiManager.hcmFilter;let X="white",re="#cfcfd8";this._uiManager.hcmFilter!=="none"?re="black":(P=window.matchMedia)!=null&&P.call(window,"(prefers-color-scheme: dark)").matches&&(X="#8f8f9d",re="#42414d");const K=15,te=K*d.sx,ee=K*d.sy,A=new OffscreenCanvas(te*2,ee*2),me=A.getContext("2d");me.fillStyle=X,me.fillRect(0,0,te*2,ee*2),me.fillStyle=re,me.fillRect(0,0,te,ee),me.fillRect(te,ee,te,ee),F.fillStyle=F.createPattern(A,"repeat"),F.fillRect(0,0,x,L),F.drawImage(f,0,0,f.width,f.height,0,0,x,L)}let C=null;if(o){let x,L;if(d.symmetric&&f.width<i&&f.height<i)x=f.width,L=f.height;else if(f=u(this,ln),l>i||c>i){const re=Math.min(i/l,i/c);x=Math.floor(l*re),L=Math.floor(c*re),u(this,Qa)||(f=R(this,fs,yS).call(this,x,L))}const X=new OffscreenCanvas(x,L).getContext("2d",{willReadFrequently:!0});X.drawImage(f,0,0,f.width,f.height,0,0,x,L),C={width:x,height:L,data:X.getImageData(0,0,x,L).data}}return{canvas:T,width:m,height:b,imageData:C}}static async deserialize(i,n,o){var F;let l=null,c=!1;if(i instanceof NO){const{data:{rect:X,rotation:re,id:K,structParent:te,popupRef:ee},container:A,parent:{page:{pageNumber:me}},canvas:fe}=i;let J,ye;fe?(delete i.canvas,{id:J,bitmap:ye}=o.imageManager.getFromCanvas(A.id,fe),fe.remove()):(c=!0,i._hasNoCanvas=!0);const Oe=((F=await n._structTree.getAriaAttributes(`${qk}${K}`))==null?void 0:F.get("aria-label"))||"";l=i={annotationType:Li.STAMP,bitmapId:J,bitmap:ye,pageIndex:me-1,rect:X.slice(0),rotation:re,id:K,deleted:!1,accessibilityData:{decorative:!1,altText:Oe},isSvg:!1,structParent:te,popupRef:ee}}const d=await super.deserialize(i,n,o),{rect:f,bitmap:m,bitmapUrl:b,bitmapId:T,isSvg:C,accessibilityData:P}=i;c?(o.addMissingCanvas(i.id,d),D(d,dp,!0)):T&&o.imageManager.isValidId(T)?(D(d,_r,T),m&&D(d,ln,m)):D(d,sh,b),D(d,Qa,C);const[x,L]=d.pageDimensions;return d.width=(f[2]-f[0])/x,d.height=(f[3]-f[1])/L,d.annotationElementId=i.id||null,P&&(d.altTextData=P),d._initialData=l,D(d,p0,!!l),d}serialize(i=!1,n=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const o={annotationType:Li.STAMP,bitmapId:u(this,_r),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:u(this,Qa),structTreeParentId:this._structTreeParentId};if(i)return o.bitmapUrl=R(this,fs,vS).call(this,!0),o.accessibilityData=this.serializeAltText(!0),o.isCopy=!0,o;const{decorative:l,altText:c}=this.serializeAltText(!1);if(!l&&c&&(o.accessibilityData={type:"Figure",alt:c}),this.annotationElementId){const f=R(this,fs,yF).call(this,o);if(f.isSame)return null;f.isSameAltText?delete o.accessibilityData:o.accessibilityData.structParent=this._initialData.structParent??-1}if(o.id=this.annotationElementId,n===null)return o;n.stamps||(n.stamps=new Map);const d=u(this,Qa)?(o.rect[2]-o.rect[0])*(o.rect[3]-o.rect[1]):null;if(!n.stamps.has(u(this,_r)))n.stamps.set(u(this,_r),{area:d,serialized:o}),o.bitmap=R(this,fs,vS).call(this,!1);else if(u(this,Qa)){const f=n.stamps.get(u(this,_r));d>f.area&&(f.area=d,f.serialized.bitmap.close(),f.serialized.bitmap=R(this,fs,vS).call(this,!1))}return o}renderAnnotationElement(i){return i.updateEdited({rect:this.getRect(0,0)}),null}}ln=new WeakMap,_r=new WeakMap,jc=new WeakMap,sh=new WeakMap,Hc=new WeakMap,f0=new WeakMap,nh=new WeakMap,dp=new WeakMap,Ql=new WeakMap,Qa=new WeakMap,p0=new WeakMap,fs=new WeakSet,Mb=function(i,n=!1){if(!i){this.remove();return}D(this,ln,i.bitmap),n||(D(this,_r,i.id),D(this,Qa,i.isSvg)),i.file&&D(this,f0,i.file.name),R(this,fs,bS).call(this)},Ob=function(){if(D(this,jc,null),this._uiManager.enableWaiting(!1),!!u(this,nh)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&u(this,ln)){this._editToolbar.hide(),this._uiManager.editAltText(this,!0);return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&u(this,ln)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},_S=function(){if(u(this,_r)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(u(this,_r)).then(o=>R(this,fs,Mb).call(this,o,!0)).finally(()=>R(this,fs,Ob).call(this));return}if(u(this,sh)){const o=u(this,sh);D(this,sh,null),this._uiManager.enableWaiting(!0),D(this,jc,this._uiManager.imageManager.getFromUrl(o).then(l=>R(this,fs,Mb).call(this,l)).finally(()=>R(this,fs,Ob).call(this)));return}if(u(this,Hc)){const o=u(this,Hc);D(this,Hc,null),this._uiManager.enableWaiting(!0),D(this,jc,this._uiManager.imageManager.getFromFile(o).then(l=>R(this,fs,Mb).call(this,l)).finally(()=>R(this,fs,Ob).call(this)));return}const i=document.createElement("input");i.type="file",i.accept=zS.join(",");const n=this._uiManager._signal;D(this,jc,new Promise(o=>{i.addEventListener("change",async()=>{if(!i.files||i.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const l=await this._uiManager.imageManager.getFromFile(i.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),R(this,fs,Mb).call(this,l)}o()},{signal:n}),i.addEventListener("cancel",()=>{this.remove(),o()},{signal:n})}).finally(()=>R(this,fs,Ob).call(this))),i.click()},bS=function(){var T;const{div:i}=this;let{width:n,height:o}=u(this,ln);const[l,c]=this.pageDimensions,d=.75;if(this.width)n=this.width*l,o=this.height*c;else if(n>d*l||o>d*c){const C=Math.min(d*l/n,d*c/o);n*=C,o*=C}const[f,m]=this.parentDimensions;this.setDims(n*f/l,o*m/c),this._uiManager.enableWaiting(!1);const b=D(this,nh,document.createElement("canvas"));b.setAttribute("role","img"),this.addContainer(b),this.width=n/l,this.height=o/c,(T=this._initialOptions)!=null&&T.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(i.hidden=!1),R(this,fs,n2).call(this),u(this,p0)||(this.parent.addUndoableEditor(this),D(this,p0,!0)),this._reportTelemetry({action:"inserted_image"}),u(this,f0)&&this.div.setAttribute("aria-description",u(this,f0))},yS=function(i,n){const{width:o,height:l}=u(this,ln);let c=o,d=l,f=u(this,ln);for(;c>2*i||d>2*n;){const m=c,b=d;c>2*i&&(c=c>=16384?Math.floor(c/2)-1:Math.ceil(c/2)),d>2*n&&(d=d>=16384?Math.floor(d/2)-1:Math.ceil(d/2));const T=new OffscreenCanvas(c,d);T.getContext("2d").drawImage(f,0,0,m,b,0,0,c,d),f=T.transferToImageBitmap()}return f},n2=function(){const[i,n]=this.parentDimensions,{width:o,height:l}=this,c=new Pd,d=Math.ceil(o*i*c.sx),f=Math.ceil(l*n*c.sy),m=u(this,nh);if(!m||m.width===d&&m.height===f)return;m.width=d,m.height=f;const b=u(this,Qa)?u(this,ln):R(this,fs,yS).call(this,d,f),T=m.getContext("2d");T.filter=this._uiManager.hcmFilter,T.drawImage(b,0,0,b.width,b.height,0,0,d,f)},vS=function(i){if(i){if(u(this,Qa)){const l=this._uiManager.imageManager.getSvgUrl(u(this,_r));if(l)return l}const n=document.createElement("canvas");return{width:n.width,height:n.height}=u(this,ln),n.getContext("2d").drawImage(u(this,ln),0,0),n.toDataURL()}if(u(this,Qa)){const[n,o]=this.pageDimensions,l=Math.round(this.width*n*ng.PDF_TO_CSS_UNITS),c=Math.round(this.height*o*ng.PDF_TO_CSS_UNITS),d=new OffscreenCanvas(l,c);return d.getContext("2d").drawImage(u(this,ln),0,0,u(this,ln).width,u(this,ln).height,0,0,l,c),d.transferToImageBitmap()}return structuredClone(u(this,ln))},yF=function(i){var d;const{pageIndex:n,accessibilityData:{altText:o}}=this._initialData,l=i.pageIndex===n,c=(((d=i.accessibilityData)==null?void 0:d.alt)||"")===o;return{isSame:!this._hasBeenMoved&&!this._hasBeenResized&&l&&c,isSameAltText:c}},St(s2,"_type","stamp"),St(s2,"_editorType",Li.STAMP);var fp,g0,Jl,Vc,rh,xo,$c,m0,pp,il,ah,jr,oh,ri,Ia,zc,hn,wF,Ml,r2,a2,wS;let vF=(Ia=class{constructor({uiManager:t,pageIndex:i,div:n,structTreeLayer:o,accessibilityManager:l,annotationLayer:c,drawLayer:d,textLayer:f,viewport:m,l10n:b}){j(this,hn);j(this,fp);j(this,g0,!1);j(this,Jl,null);j(this,Vc,null);j(this,rh,null);j(this,xo,new Map);j(this,$c,!1);j(this,m0,!1);j(this,pp,!1);j(this,il,null);j(this,ah,null);j(this,jr,null);j(this,oh,null);j(this,ri);const T=[...u(Ia,zc).values()];if(!Ia._initialized){Ia._initialized=!0;for(const C of T)C.initialize(b,t)}t.registerEditorTypes(T),D(this,ri,t),this.pageIndex=i,this.div=n,D(this,fp,l),D(this,Jl,c),this.viewport=m,D(this,jr,f),this.drawLayer=d,this._structTree=o,u(this,ri).addLayer(this)}get isEmpty(){return u(this,xo).size===0}get isInvisible(){return this.isEmpty&&u(this,ri).getMode()===Li.NONE}updateToolbar(t){u(this,ri).updateToolbar(t)}updateMode(t=u(this,ri).getMode()){switch(R(this,hn,wS).call(this),t){case Li.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case Li.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case Li.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:i}=this.div;for(const n of u(Ia,zc).values())i.toggle(`${n._type}Editing`,t===n._editorType);this.div.hidden=!1}hasTextLayer(t){var i;return t===((i=u(this,jr))==null?void 0:i.div)}setEditingState(t){u(this,ri).setEditingState(t)}addCommands(t){u(this,ri).addCommands(t)}cleanUndoStack(t){u(this,ri).cleanUndoStack(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){var i;(i=u(this,Jl))==null||i.div.classList.toggle("disabled",!t)}async enable(){D(this,pp,!0),this.div.tabIndex=0,this.togglePointerEvents(!0);const t=new Set;for(const n of u(this,xo).values())n.enableEditing(),n.show(!0),n.annotationElementId&&(u(this,ri).removeChangedExistingAnnotation(n),t.add(n.annotationElementId));if(!u(this,Jl)){D(this,pp,!1);return}const i=u(this,Jl).getEditableAnnotations();for(const n of i){if(n.hide(),u(this,ri).isDeletedAnnotationElement(n.data.id)||t.has(n.data.id))continue;const o=await this.deserialize(n);o&&(this.addOrRebuild(o),o.enableEditing())}D(this,pp,!1)}disable(){var o;D(this,m0,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1);const t=new Map,i=new Map;for(const l of u(this,xo).values())if(l.disableEditing(),!!l.annotationElementId){if(l.serialize()!==null){t.set(l.annotationElementId,l);continue}else i.set(l.annotationElementId,l);(o=this.getEditableAnnotation(l.annotationElementId))==null||o.show(),l.remove()}if(u(this,Jl)){const l=u(this,Jl).getEditableAnnotations();for(const c of l){const{id:d}=c.data;if(u(this,ri).isDeletedAnnotationElement(d))continue;let f=i.get(d);if(f){f.resetAnnotationElement(c),f.show(!1),c.show();continue}f=t.get(d),f&&(u(this,ri).addChangedExistingAnnotation(f),f.renderAnnotationElement(c)&&f.show(!1)),c.show()}}R(this,hn,wS).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:n}=this.div;for(const l of u(Ia,zc).values())n.remove(`${l._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),D(this,m0,!1)}getEditableAnnotation(t){var i;return((i=u(this,Jl))==null?void 0:i.getEditableAnnotation(t))||null}setActiveEditor(t){u(this,ri).getActive()!==t&&u(this,ri).setActiveEditor(t)}enableTextSelection(){var t;if(this.div.tabIndex=-1,(t=u(this,jr))!=null&&t.div&&!u(this,oh)){D(this,oh,new AbortController);const i=u(this,ri).combinedSignal(u(this,oh));u(this,jr).div.addEventListener("pointerdown",R(this,hn,wF).bind(this),{signal:i}),u(this,jr).div.classList.add("highlighting")}}disableTextSelection(){var t;this.div.tabIndex=0,(t=u(this,jr))!=null&&t.div&&u(this,oh)&&(u(this,oh).abort(),D(this,oh,null),u(this,jr).div.classList.remove("highlighting"))}enableClick(){if(u(this,Vc))return;D(this,Vc,new AbortController);const t=u(this,ri).combinedSignal(u(this,Vc));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t});const i=this.pointerup.bind(this);this.div.addEventListener("pointerup",i,{signal:t}),this.div.addEventListener("pointercancel",i,{signal:t})}disableClick(){var t;(t=u(this,Vc))==null||t.abort(),D(this,Vc,null)}attach(t){u(this,xo).set(t.id,t);const{annotationElementId:i}=t;i&&u(this,ri).isDeletedAnnotationElement(i)&&u(this,ri).removeDeletedAnnotationElement(t)}detach(t){var i;u(this,xo).delete(t.id),(i=u(this,fp))==null||i.removePointerInTextLayer(t.contentDiv),!u(this,m0)&&t.annotationElementId&&u(this,ri).addDeletedAnnotationElement(t)}remove(t){this.detach(t),u(this,ri).removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1}changeParent(t){var i;t.parent!==this&&(t.parent&&t.annotationElementId&&(u(this,ri).addDeletedAnnotationElement(t.annotationElementId),Ys.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),(i=t.parent)==null||i.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),u(this,ri).addEditor(t),this.attach(t),!t.isAttachedToDOM){const i=t.render();this.div.append(i),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(!u(this,pp)),u(this,ri).addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){var n;if(!t.isAttachedToDOM)return;const{activeElement:i}=document;t.div.contains(i)&&!u(this,rh)&&(t._focusEventsAllowed=!1,D(this,rh,setTimeout(()=>{D(this,rh,null),t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:u(this,ri)._signal}),i.focus())},0))),t._structTreeParentId=(n=u(this,fp))==null?void 0:n.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||(t.parent=this),t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){const i=()=>t._uiManager.rebuild(t),n=()=>{t.remove()};this.addCommands({cmd:i,undo:n,mustExec:!1})}getNextId(){return u(this,ri).getId()}combinedSignal(t){return u(this,ri).combinedSignal(t)}canCreateNewEmptyEditor(){var t;return(t=u(this,hn,Ml))==null?void 0:t.canCreateNewEmptyEditor()}async pasteEditor(t,i){this.updateToolbar(t),await u(this,ri).updateMode(t.mode);const{offsetX:n,offsetY:o}=R(this,hn,a2).call(this),l=this.getNextId(),c=R(this,hn,r2).call(this,{parent:this,id:l,x:n,y:o,uiManager:u(this,ri),isCentered:!0,...i});c&&this.add(c)}async deserialize(t){var i;return await((i=u(Ia,zc).get(t.annotationType??t.annotationEditorType))==null?void 0:i.deserialize(t,this,u(this,ri)))||null}createAndAddNewEditor(t,i,n={}){const o=this.getNextId(),l=R(this,hn,r2).call(this,{parent:this,id:o,x:t.offsetX,y:t.offsetY,uiManager:u(this,ri),isCentered:i,...n});return l&&this.add(l),l}addNewEditor(t={}){this.createAndAddNewEditor(R(this,hn,a2).call(this),!0,t)}setSelected(t){u(this,ri).setSelected(t)}toggleSelected(t){u(this,ri).toggleSelected(t)}unselect(t){u(this,ri).unselect(t)}pointerup(t){var o;const{isMac:i}=yr.platform;if(t.button!==0||t.ctrlKey&&i||t.target!==this.div||!u(this,$c)||(D(this,$c,!1),(o=u(this,hn,Ml))!=null&&o.isDrawer&&u(this,hn,Ml).supportMultipleDrawings))return;if(!u(this,g0)){D(this,g0,!0);return}const n=u(this,ri).getMode();if(n===Li.STAMP||n===Li.SIGNATURE){u(this,ri).unselectAll();return}this.createAndAddNewEditor(t,!1)}pointerdown(t){var o;if(u(this,ri).getMode()===Li.HIGHLIGHT&&this.enableTextSelection(),u(this,$c)){D(this,$c,!1);return}const{isMac:i}=yr.platform;if(t.button!==0||t.ctrlKey&&i||t.target!==this.div)return;if(D(this,$c,!0),(o=u(this,hn,Ml))!=null&&o.isDrawer){this.startDrawingSession(t);return}const n=u(this,ri).getActive();D(this,g0,!n||n.isEmpty())}startDrawingSession(t){if(this.div.focus({preventScroll:!0}),u(this,il)){u(this,hn,Ml).startDrawing(this,u(this,ri),!1,t);return}u(this,ri).setCurrentDrawingSession(this),D(this,il,new AbortController);const i=u(this,ri).combinedSignal(u(this,il));this.div.addEventListener("blur",({relatedTarget:n})=>{n&&!this.div.contains(n)&&(D(this,ah,null),this.commitOrRemove())},{signal:i}),u(this,hn,Ml).startDrawing(this,u(this,ri),!1,t)}pause(t){if(t){const{activeElement:i}=document;this.div.contains(i)&&D(this,ah,i);return}u(this,ah)&&setTimeout(()=>{var i;(i=u(this,ah))==null||i.focus(),D(this,ah,null)},0)}endDrawingSession(t=!1){return u(this,il)?(u(this,ri).setCurrentDrawingSession(null),u(this,il).abort(),D(this,il,null),D(this,ah,null),u(this,hn,Ml).endDrawing(t)):null}findNewParent(t,i,n){const o=u(this,ri).findParent(i,n);return o===null||o===this?!1:(o.changeParent(t),!0)}commitOrRemove(){return u(this,il)?(this.endDrawingSession(),!0):!1}onScaleChanging(){u(this,il)&&u(this,hn,Ml).onScaleChangingWhenDrawing(this)}destroy(){var t,i;this.commitOrRemove(),((t=u(this,ri).getActive())==null?void 0:t.parent)===this&&(u(this,ri).commitOrRemove(),u(this,ri).setActiveEditor(null)),u(this,rh)&&(clearTimeout(u(this,rh)),D(this,rh,null));for(const n of u(this,xo).values())(i=u(this,fp))==null||i.removePointerInTextLayer(n.contentDiv),n.setParent(null),n.isAttachedToDOM=!1,n.div.remove();this.div=null,u(this,xo).clear(),u(this,ri).removeLayer(this)}render({viewport:t}){this.viewport=t,kd(this.div,t);for(const i of u(this,ri).getEditors(this.pageIndex))this.add(i),i.rebuild();this.updateMode()}update({viewport:t}){u(this,ri).commitOrRemove(),R(this,hn,wS).call(this);const i=this.viewport.rotation,n=t.rotation;if(this.viewport=t,kd(this.div,{rotation:n}),i!==n)for(const o of u(this,xo).values())o.rotate(n)}get pageDimensions(){const{pageWidth:t,pageHeight:i}=this.viewport.rawDims;return[t,i]}get scale(){return u(this,ri).viewParameters.realScale}},fp=new WeakMap,g0=new WeakMap,Jl=new WeakMap,Vc=new WeakMap,rh=new WeakMap,xo=new WeakMap,$c=new WeakMap,m0=new WeakMap,pp=new WeakMap,il=new WeakMap,ah=new WeakMap,jr=new WeakMap,oh=new WeakMap,ri=new WeakMap,zc=new WeakMap,hn=new WeakSet,wF=function(t){u(this,ri).unselectAll();const{target:i}=t;if(i===u(this,jr).div||(i.getAttribute("role")==="img"||i.classList.contains("endOfContent"))&&u(this,jr).div.contains(i)){const{isMac:n}=yr.platform;if(t.button!==0||t.ctrlKey&&n)return;u(this,ri).showAllEditors("highlight",!0,!0),u(this,jr).div.classList.add("free"),this.toggleDrawing(),KS.startHighlighting(this,u(this,ri).direction==="ltr",{target:u(this,jr).div,x:t.x,y:t.y}),u(this,jr).div.addEventListener("pointerup",()=>{u(this,jr).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:u(this,ri)._signal}),t.preventDefault()}},Ml=function(){return u(Ia,zc).get(u(this,ri).getMode())},r2=function(t){const i=u(this,hn,Ml);return i?new i.prototype.constructor(t):null},a2=function(){const{x:t,y:i,width:n,height:o}=this.div.getBoundingClientRect(),l=Math.max(0,t),c=Math.max(0,i),d=Math.min(window.innerWidth,t+n),f=Math.min(window.innerHeight,i+o),m=(l+d)/2-t,b=(c+f)/2-i,[T,C]=this.viewport.rotation%180===0?[m,b]:[b,m];return{offsetX:T,offsetY:C}},wS=function(){for(const t of u(this,xo).values())t.isEmpty()&&t.remove()},St(Ia,"_initialized",!1),j(Ia,zc,new Map([FC,YC,s2,KS,i2].map(t=>[t._editorType,t]))),Ia);var sl,ia,gp,Tn,Uv,mx,EF,pu,o2,SF,l2;let TF=(Tn=class{constructor({pageIndex:t}){j(this,pu);j(this,sl,null);j(this,ia,new Map);j(this,gp,new Map);this.pageIndex=t}setParent(t){if(!u(this,sl)){D(this,sl,t);return}if(u(this,sl)!==t){if(u(this,ia).size>0)for(const i of u(this,ia).values())i.remove(),t.append(i);D(this,sl,t)}}static get _svgFactory(){return is(this,"_svgFactory",new ly)}draw(t,i=!1,n=!1){const o=Yn(Tn,Uv)._++,l=R(this,pu,o2).call(this),c=Tn._svgFactory.createElement("defs");l.append(c);const d=Tn._svgFactory.createElement("path");c.append(d);const f=`path_p${this.pageIndex}_${o}`;d.setAttribute("id",f),d.setAttribute("vector-effect","non-scaling-stroke"),i&&u(this,gp).set(o,d);const m=n?R(this,pu,SF).call(this,c,f):null,b=Tn._svgFactory.createElement("use");return l.append(b),b.setAttribute("href",`#${f}`),this.updateProperties(l,t),u(this,ia).set(o,l),{id:o,clipPathId:`url(#${m})`}}drawOutline(t,i){const n=Yn(Tn,Uv)._++,o=R(this,pu,o2).call(this),l=Tn._svgFactory.createElement("defs");o.append(l);const c=Tn._svgFactory.createElement("path");l.append(c);const d=`path_p${this.pageIndex}_${n}`;c.setAttribute("id",d),c.setAttribute("vector-effect","non-scaling-stroke");let f;if(i){const T=Tn._svgFactory.createElement("mask");l.append(T),f=`mask_p${this.pageIndex}_${n}`,T.setAttribute("id",f),T.setAttribute("maskUnits","objectBoundingBox");const C=Tn._svgFactory.createElement("rect");T.append(C),C.setAttribute("width","1"),C.setAttribute("height","1"),C.setAttribute("fill","white");const P=Tn._svgFactory.createElement("use");T.append(P),P.setAttribute("href",`#${d}`),P.setAttribute("stroke","none"),P.setAttribute("fill","black"),P.setAttribute("fill-rule","nonzero"),P.classList.add("mask")}const m=Tn._svgFactory.createElement("use");o.append(m),m.setAttribute("href",`#${d}`),f&&m.setAttribute("mask",`url(#${f})`);const b=m.cloneNode();return o.append(b),m.classList.add("mainOutline"),b.classList.add("secondaryOutline"),this.updateProperties(o,t),u(this,ia).set(n,o),n}finalizeDraw(t,i){u(this,gp).delete(t),this.updateProperties(t,i)}updateProperties(t,i){var f;if(!i)return;const{root:n,bbox:o,rootClass:l,path:c}=i,d=typeof t=="number"?u(this,ia).get(t):t;if(d){if(n&&R(this,pu,l2).call(this,d,n),o&&R(f=Tn,mx,EF).call(f,d,o),l){const{classList:m}=d;for(const[b,T]of Object.entries(l))m.toggle(b,T)}if(c){const b=d.firstChild.firstChild;R(this,pu,l2).call(this,b,c)}}}updateParent(t,i){if(i===this)return;const n=u(this,ia).get(t);n&&(u(i,sl).append(n),u(this,ia).delete(t),u(i,ia).set(t,n))}remove(t){u(this,gp).delete(t),u(this,sl)!==null&&(u(this,ia).get(t).remove(),u(this,ia).delete(t))}destroy(){D(this,sl,null);for(const t of u(this,ia).values())t.remove();u(this,ia).clear(),u(this,gp).clear()}},sl=new WeakMap,ia=new WeakMap,gp=new WeakMap,Uv=new WeakMap,mx=new WeakSet,EF=function(t,[i,n,o,l]){const{style:c}=t;c.top=`${100*n}%`,c.left=`${100*i}%`,c.width=`${100*o}%`,c.height=`${100*l}%`},pu=new WeakSet,o2=function(){const t=Tn._svgFactory.create(1,1,!0);return u(this,sl).append(t),t.setAttribute("aria-hidden",!0),t},SF=function(t,i){const n=Tn._svgFactory.createElement("clipPath");t.append(n);const o=`clip_${i}`;n.setAttribute("id",o),n.setAttribute("clipPathUnits","objectBoundingBox");const l=Tn._svgFactory.createElement("use");return n.append(l),l.setAttribute("href",`#${i}`),l.classList.add("clip"),o},l2=function(t,i){for(const[n,o]of Object.entries(i))o===null?t.removeAttribute(n):t.setAttribute(n,o)},j(Tn,mx),j(Tn,Uv,0),Tn);globalThis._pdfjsTestingUtils={HighlightOutliner:UC};globalThis.pdfjsLib={AbortException:Mh,AnnotationEditorLayer:vF,AnnotationEditorParamsType:as,AnnotationEditorType:Li,AnnotationEditorUIManager:o_,AnnotationLayer:RO,AnnotationMode:kh,AnnotationType:Pn,build:wO,ColorPicker:iP,createValidAbsoluteUrl:$k,DOMSVGFactory:ly,DrawLayer:TF,FeatureTest:yr,fetchData:d_,getDocument:_O,getFilenameFromUrl:fM,getPdfFilenameFromUrl:pM,getUuid:Wk,getXfaPageViewport:gM,GlobalWorkerOptions:oc,ImageKind:Jb,InvalidPDFException:$S,isDataScheme:oT,isPdfFile:Cx,isValidExplicitDest:YM,MathClamp:Vr,noContextMenu:Mo,normalizeUnicode:cM,OPS:ry,OutputScale:Pd,PasswordResponses:uM,PDFDataRangeTransport:Jk,PDFDateString:Gk,PDFWorker:GS,PermissionFlag:lM,PixelsPerInch:ng,RenderingCancelledException:Ax,ResponseException:ay,setLayerDimensions:kd,shadow:is,SignatureExtractor:af,stopEvent:Nn,SupportedImageMimeTypes:zS,TextLayer:qS,TouchManager:Kk,updateUrlHash:zk,Util:oi,VerbosityLevel:nT,version:vO,XfaLayer:eP};const Az=Object.freeze(Object.defineProperty({__proto__:null,AbortException:Mh,AnnotationEditorLayer:vF,AnnotationEditorParamsType:as,AnnotationEditorType:Li,AnnotationEditorUIManager:o_,AnnotationLayer:RO,AnnotationMode:kh,AnnotationType:Pn,ColorPicker:iP,DOMSVGFactory:ly,DrawLayer:TF,FeatureTest:yr,GlobalWorkerOptions:oc,ImageKind:Jb,InvalidPDFException:$S,MathClamp:Vr,OPS:ry,OutputScale:Pd,PDFDataRangeTransport:Jk,PDFDateString:Gk,PDFWorker:GS,PasswordResponses:uM,PermissionFlag:lM,PixelsPerInch:ng,RenderingCancelledException:Ax,ResponseException:ay,SignatureExtractor:af,SupportedImageMimeTypes:zS,TextLayer:qS,TouchManager:Kk,Util:oi,VerbosityLevel:nT,XfaLayer:eP,build:wO,createValidAbsoluteUrl:$k,fetchData:d_,getDocument:_O,getFilenameFromUrl:fM,getPdfFilenameFromUrl:pM,getUuid:Wk,getXfaPageViewport:gM,isDataScheme:oT,isPdfFile:Cx,isValidExplicitDest:YM,noContextMenu:Mo,normalizeUnicode:cM,setLayerDimensions:kd,shadow:is,stopEvent:Nn,updateUrlHash:zk,version:vO},Symbol.toStringTag,{value:"Module"})),{AbortException:Cz,AnnotationEditorLayer:kz,AnnotationEditorParamsType:zo,AnnotationEditorType:Qi,AnnotationEditorUIManager:Pz,AnnotationLayer:Dz,AnnotationMode:cu,AnnotationType:xF,build:cR,ColorPicker:Iz,createValidAbsoluteUrl:AF,DOMSVGFactory:ey,DrawLayer:Lz,FeatureTest:Nz,fetchData:dR,getDocument:Rz,getFilenameFromUrl:Mz,getPdfFilenameFromUrl:fR,getUuid:Oz,getXfaPageViewport:Fz,GlobalWorkerOptions:OE,ImageKind:Sq,InvalidPDFException:Bz,isDataScheme:Uz,isPdfFile:jz,isValidExplicitDest:Hz,MathClamp:CF,noContextMenu:Dx,normalizeUnicode:Vz,OPS:xq,OutputScale:sg,PasswordResponses:$z,PDFDataRangeTransport:Aq,PDFDateString:zz,PDFWorker:Wz,PermissionFlag:FE,PixelsPerInch:ml,RenderingCancelledException:uy,ResponseException:qz,setLayerDimensions:kF,shadow:Pa,SignatureExtractor:LA,stopEvent:du,SupportedImageMimeTypes:BE,TextLayer:Gz,TouchManager:Xz,updateUrlHash:u2,Util:rP,VerbosityLevel:Cq,version:ZS,XfaLayer:NA}=globalThis.pdfjsLib,ty="auto",aP=1,pR=1.1,PF=.1,DF=10,RA=0,Kz=1.25,gR=40,mR=5,Ii={INITIAL:0,RUNNING:1,PAUSED:2,FINISHED:3},tr={UNKNOWN:0,NORMAL:1,CHANGING:2,FULLSCREEN:3},Ni={UNKNOWN:-1,NONE:0,THUMBS:1,OUTLINE:2,ATTACHMENTS:3,LAYERS:4},_l={DISABLE:0,ENABLE:1,ENABLE_PERMISSIONS:2},Ci={UNKNOWN:-1,VERTICAL:0,HORIZONTAL:1,WRAPPED:2,PAGE:3},Ws={UNKNOWN:-1,NONE:0,ODD:1,EVEN:2},Da={SELECT:0,HAND:1,ZOOM:2},Yz=/\bprint\s*\(/;function oP(g,t,i=!1){let n=g.offsetParent;if(!n){console.error("offsetParent is not set -- cannot scroll");return}let o=g.offsetTop+g.clientTop,l=g.offsetLeft+g.clientLeft;for(;n.clientHeight===n.scrollHeight&&n.clientWidth===n.scrollWidth||i&&(n.classList.contains("markedContent")||getComputedStyle(n).overflow==="hidden");)if(o+=n.offsetTop,l+=n.offsetLeft,n=n.offsetParent,!n)return;t&&(t.top!==void 0&&(o+=t.top),t.left!==void 0&&(l+=t.left,n.scrollLeft=l)),n.scrollTop=o}function IF(g,t,i=void 0){const n=function(c){l||(l=window.requestAnimationFrame(function(){l=null;const f=g.scrollLeft,m=o.lastX;f!==m&&(o.right=f>m),o.lastX=f;const b=g.scrollTop,T=o.lastY;b!==T&&(o.down=b>T),o.lastY=b,t(o)}))},o={right:!0,down:!0,lastX:g.scrollLeft,lastY:g.scrollTop,_eventHandler:n};let l=null;return g.addEventListener("scroll",n,{useCapture:!0,signal:i}),i==null||i.addEventListener("abort",()=>window.cancelAnimationFrame(l),{once:!0}),o}function hy(g){const t=new Map;for(const[i,n]of new URLSearchParams(g))t.set(i.toLowerCase(),n);return t}const _R=/[\x00-\x1F]/g;function am(g,t=!1){return _R.test(g)?t?g.replaceAll(_R,i=>i==="\0"?"":" "):g.replaceAll("\0",""):g}function cy(g,t,i=0){let n=i,o=g.length-1;if(o<0||!t(g[o]))return g.length;if(t(g[n]))return n;for(;n<o;){const l=n+o>>1,c=g[l];t(c)?o=l:n=l+1}return n}function bR(g){if(Math.floor(g)===g)return[g,1];const t=1/g,i=8;if(t>i)return[1,i];if(Math.floor(t)===t)return[1,t];const n=g>1?t:g;let o=0,l=1,c=1,d=1;for(;;){const m=o+c,b=l+d;if(b>i)break;n<=m/b?(c=m,d=b):(o=m,l=b)}let f;return n-o/l<c/d-n?f=n===g?[o,l]:[l,o]:f=n===g?[c,d]:[d,c],f}function UE(g,t){return g-g%t}function Zz({view:g,userUnit:t,rotate:i}){const[n,o,l,c]=g,d=i%180!==0,f=(l-n)/72*t,m=(c-o)/72*t;return{width:d?m:f,height:d?f:m}}function Qz(g,t,i){if(g<2)return g;let n=t[g].div,o=n.offsetTop+n.clientTop;o>=i&&(n=t[g-1].div,o=n.offsetTop+n.clientTop);for(let l=g-2;l>=0&&(n=t[l].div,!(n.offsetTop+n.clientTop+n.clientHeight<=o));--l)g=l;return g}function LF({scrollEl:g,views:t,sortByVisibility:i=!1,horizontal:n=!1,rtl:o=!1}){const l=g.scrollTop,c=l+g.clientHeight,d=g.scrollLeft,f=d+g.clientWidth;function m(re){const K=re.div;return K.offsetTop+K.clientTop+K.clientHeight>l}function b(re){const K=re.div,te=K.offsetLeft+K.clientLeft,ee=te+K.clientWidth;return o?te<f:ee>d}const T=[],C=new Set,P=t.length;let x=cy(t,n?b:m);x>0&&x<P&&!n&&(x=Qz(x,t,l));let L=n?f:-1;for(let re=x;re<P;re++){const K=t[re],te=K.div,ee=te.offsetLeft+te.clientLeft,A=te.offsetTop+te.clientTop,me=te.clientWidth,fe=te.clientHeight,J=ee+me,ye=A+fe;if(L===-1)ye>=c&&(L=ye);else if((n?ee:A)>L)break;if(ye<=l||A>=c||J<=d||ee>=f)continue;const Oe=Math.max(0,l-A),ot=Math.max(0,d-ee),Tt=Oe+Math.max(0,ye-c),dt=ot+Math.max(0,J-f),kt=(fe-Tt)/fe,$e=(me-dt)/me,vt=kt*$e*100|0;T.push({id:K.id,x:ee,y:A,visibleArea:vt===100?null:{minX:ot,minY:Oe,maxX:Math.min(J,f)-ee,maxY:Math.min(ye,c)-A},view:K,percent:vt,widthPercent:$e*100|0}),C.add(K.id)}const F=T[0],X=T.at(-1);return i&&T.sort(function(re,K){const te=re.percent-K.percent;return Math.abs(te)>.001?-te:re.id-K.id}),{first:F,last:X,views:T,ids:C}}function NF(g){let t=Math.hypot(g.deltaX,g.deltaY);const i=Math.atan2(g.deltaY,g.deltaX);return-.25*Math.PI<i&&i<.75*Math.PI&&(t=-t),t}function Jz(g){const t=g.deltaMode;let i=NF(g);const n=30,o=30;return t===WheelEvent.DOM_DELTA_PIXEL?i/=n*o:t===WheelEvent.DOM_DELTA_LINE&&(i/=o),i}function Ix(g){return Number.isInteger(g)&&g%90===0}function RF(g){return Number.isInteger(g)&&Object.values(Ci).includes(g)&&g!==Ci.UNKNOWN}function MF(g){return Number.isInteger(g)&&Object.values(Ws).includes(g)&&g!==Ws.UNKNOWN}function h2(g){return g.width<=g.height}const e7=new Promise(function(g){window.requestAnimationFrame(g)}),lP=document.documentElement.style;var Wc,mp,qc,_0,_p;class t7{constructor(t){j(this,Wc,null);j(this,mp,null);j(this,qc,0);j(this,_0,null);j(this,_p,!0);D(this,Wc,t.classList),D(this,_0,t.style)}get percent(){return u(this,qc)}set percent(t){if(D(this,qc,CF(t,0,100)),isNaN(t)){u(this,Wc).add("indeterminate");return}u(this,Wc).remove("indeterminate"),u(this,_0).setProperty("--progressBar-percent",`${u(this,qc)}%`)}setWidth(t){if(!t)return;const n=t.parentNode.offsetWidth-t.offsetWidth;n>0&&u(this,_0).setProperty("--progressBar-end-offset",`${n}px`)}setDisableAutoFetch(t=5e3){u(this,qc)===100||isNaN(u(this,qc))||(u(this,mp)&&clearTimeout(u(this,mp)),this.show(),D(this,mp,setTimeout(()=>{D(this,mp,null),this.hide()},t)))}hide(){u(this,_p)&&(D(this,_p,!1),u(this,Wc).add("hidden"))}show(){u(this,_p)||(D(this,_p,!0),u(this,Wc).remove("hidden"))}}Wc=new WeakMap,mp=new WeakMap,qc=new WeakMap,_0=new WeakMap,_p=new WeakMap;function yR(){let g=document,t=g.activeElement||g.querySelector(":focus");for(;t!=null&&t.shadowRoot;)g=t.shadowRoot,t=g.activeElement||g.querySelector(":focus");return t}function OF(g){let t=Ci.VERTICAL,i=Ws.NONE;switch(g){case"SinglePage":t=Ci.PAGE;break;case"OneColumn":break;case"TwoPageLeft":t=Ci.PAGE;case"TwoColumnLeft":i=Ws.ODD;break;case"TwoPageRight":t=Ci.PAGE;case"TwoColumnRight":i=Ws.EVEN;break}return{scrollMode:t,spreadMode:i}}function i7(g){switch(g){case"UseNone":return Ni.NONE;case"UseThumbs":return Ni.THUMBS;case"UseOutlines":return Ni.OUTLINE;case"UseAttachments":return Ni.ATTACHMENTS;case"UseOC":return Ni.LAYERS}return Ni.NONE}function no(g,t,i=null){g.classList.toggle("toggled",t),g.setAttribute("aria-checked",t),i==null||i.classList.toggle("hidden",!t)}function bl(g,t,i=null){g.classList.toggle("toggled",t),g.setAttribute("aria-expanded",t),i==null||i.classList.toggle("hidden",!t)}const jE=function(){const g=document.createElement("div");return g.style.width="round(down, calc(1.6666666666666665 * 792px), 1px)",g.style.width==="calc(1320px)"?Math.fround:t=>t}();{var c2=new Map;const{maxTouchPoints:g,platform:t,userAgent:i}=navigator,n=/Android/.test(i),o=/\b(iPad|iPhone|iPod)(?=;)/.test(i)||t==="MacIntel"&&g>1;(function(){(o||n)&&c2.set("maxCanvasPixels",5242880)})(),function(){n&&c2.set("useSystemFonts",!1)}()}const ct={BROWSER:1,VIEWER:2,API:4,WORKER:8,EVENT_DISPATCH:16,PREFERENCE:128},d2={BOOLEAN:1,NUMBER:2,OBJECT:4,STRING:8,UNDEFINED:16},Ph={allowedGlobalEvents:{value:null,kind:ct.BROWSER},canvasMaxAreaInBytes:{value:-1,kind:ct.BROWSER+ct.API},isInAutomation:{value:!1,kind:ct.BROWSER},localeProperties:{value:{lang:navigator.language||"en-US"},kind:ct.BROWSER},maxCanvasDim:{value:32767,kind:ct.BROWSER+ct.VIEWER},nimbusDataStr:{value:"",kind:ct.BROWSER},supportsCaretBrowsingMode:{value:!1,kind:ct.BROWSER},supportsDocumentFonts:{value:!0,kind:ct.BROWSER},supportsIntegratedFind:{value:!1,kind:ct.BROWSER},supportsMouseWheelZoomCtrlKey:{value:!0,kind:ct.BROWSER},supportsMouseWheelZoomMetaKey:{value:!0,kind:ct.BROWSER},supportsPinchToZoom:{value:!0,kind:ct.BROWSER},supportsPrinting:{value:!0,kind:ct.BROWSER},toolbarDensity:{value:0,kind:ct.BROWSER+ct.EVENT_DISPATCH},altTextLearnMoreUrl:{value:"",kind:ct.VIEWER+ct.PREFERENCE},annotationEditorMode:{value:0,kind:ct.VIEWER+ct.PREFERENCE},annotationMode:{value:2,kind:ct.VIEWER+ct.PREFERENCE},capCanvasAreaFactor:{value:200,kind:ct.VIEWER+ct.PREFERENCE},cursorToolOnLoad:{value:0,kind:ct.VIEWER+ct.PREFERENCE},debuggerSrc:{value:"./debugger.mjs",kind:ct.VIEWER},defaultZoomDelay:{value:400,kind:ct.VIEWER+ct.PREFERENCE},defaultZoomValue:{value:"",kind:ct.VIEWER+ct.PREFERENCE},disableHistory:{value:!1,kind:ct.VIEWER},disablePageLabels:{value:!1,kind:ct.VIEWER+ct.PREFERENCE},enableAltText:{value:!1,kind:ct.VIEWER+ct.PREFERENCE},enableAltTextModelDownload:{value:!0,kind:ct.VIEWER+ct.PREFERENCE+ct.EVENT_DISPATCH},enableAutoLinking:{value:!0,kind:ct.VIEWER+ct.PREFERENCE},enableDetailCanvas:{value:!0,kind:ct.VIEWER},enableGuessAltText:{value:!0,kind:ct.VIEWER+ct.PREFERENCE+ct.EVENT_DISPATCH},enableHighlightFloatingButton:{value:!1,kind:ct.VIEWER+ct.PREFERENCE},enableNewAltTextWhenAddingImage:{value:!0,kind:ct.VIEWER+ct.PREFERENCE},enablePermissions:{value:!1,kind:ct.VIEWER+ct.PREFERENCE},enablePrintAutoRotate:{value:!0,kind:ct.VIEWER+ct.PREFERENCE},enableScripting:{value:!0,kind:ct.VIEWER+ct.PREFERENCE},enableSignatureEditor:{value:!1,kind:ct.VIEWER+ct.PREFERENCE},enableUpdatedAddImage:{value:!1,kind:ct.VIEWER+ct.PREFERENCE},externalLinkRel:{value:"noopener noreferrer nofollow",kind:ct.VIEWER},externalLinkTarget:{value:0,kind:ct.VIEWER+ct.PREFERENCE},highlightEditorColors:{value:"yellow=#FFFF98,green=#53FFBC,blue=#80EBFF,orange=#f9d383,red=#FF4F5F",kind:ct.VIEWER+ct.PREFERENCE},historyUpdateUrl:{value:!1,kind:ct.VIEWER+ct.PREFERENCE},ignoreDestinationZoom:{value:!1,kind:ct.VIEWER+ct.PREFERENCE},imageResourcesPath:{value:"./images/",kind:ct.VIEWER},maxCanvasPixels:{value:2**25,kind:ct.VIEWER},minDurationToUpdateCanvas:{value:500,kind:ct.VIEWER},forcePageColors:{value:!1,kind:ct.VIEWER+ct.PREFERENCE},pageColorsBackground:{value:"Canvas",kind:ct.VIEWER+ct.PREFERENCE},pageColorsForeground:{value:"CanvasText",kind:ct.VIEWER+ct.PREFERENCE},pdfBugEnabled:{value:!1,kind:ct.VIEWER+ct.PREFERENCE},printResolution:{value:150,kind:ct.VIEWER},sidebarViewOnLoad:{value:-1,kind:ct.VIEWER+ct.PREFERENCE},scrollModeOnLoad:{value:-1,kind:ct.VIEWER+ct.PREFERENCE},spreadModeOnLoad:{value:-1,kind:ct.VIEWER+ct.PREFERENCE},textLayerMode:{value:1,kind:ct.VIEWER+ct.PREFERENCE},viewerCssTheme:{value:0,kind:ct.VIEWER+ct.PREFERENCE},viewOnLoad:{value:0,kind:ct.VIEWER+ct.PREFERENCE},cMapPacked:{value:!0,kind:ct.API},cMapUrl:{value:"../web/cmaps/",kind:ct.API},disableAutoFetch:{value:!1,kind:ct.API+ct.PREFERENCE},disableFontFace:{value:!1,kind:ct.API+ct.PREFERENCE},disableRange:{value:!1,kind:ct.API+ct.PREFERENCE},disableStream:{value:!1,kind:ct.API+ct.PREFERENCE},docBaseUrl:{value:"",kind:ct.API},enableHWA:{value:!0,kind:ct.API+ct.VIEWER+ct.PREFERENCE},enableXfa:{value:!0,kind:ct.API+ct.PREFERENCE},fontExtraProperties:{value:!1,kind:ct.API},iccUrl:{value:"../web/iccs/",kind:ct.API},isEvalSupported:{value:!0,kind:ct.API},isOffscreenCanvasSupported:{value:!0,kind:ct.API},maxImageSize:{value:-1,kind:ct.API},pdfBug:{value:!1,kind:ct.API},standardFontDataUrl:{value:"../web/standard_fonts/",kind:ct.API},useSystemFonts:{value:void 0,kind:ct.API,type:d2.BOOLEAN+d2.UNDEFINED},verbosity:{value:1,kind:ct.API},wasmUrl:{value:"../web/wasm/",kind:ct.API},workerPort:{value:null,kind:ct.WORKER},workerSrc:{value:"../build/pdf.worker.mjs",kind:ct.WORKER}};Ph.defaultUrl={value:"compressed.tracemonkey-pldi-09.pdf",kind:ct.VIEWER},Ph.sandboxBundleSrc={value:"../build/pdf.sandbox.mjs",kind:ct.VIEWER},Ph.enableFakeMLManager={value:!0,kind:ct.VIEWER};Ph.disablePreferences={value:!1,kind:ct.VIEWER};var Gc;const Fl=class Fl{static get(t){return u(this,Gc).get(t)}static getAll(t=null,i=!1){const n=Object.create(null);for(const o in Ph){const l=Ph[o];t&&!(t&l.kind)||(n[o]=i?l.value:u(this,Gc).get(o))}return n}static set(t,i){this.setAll({[t]:i})}static setAll(t,i=!1){this._hasInvokedSet||(this._hasInvokedSet=!0);let n;for(const o in t){const l=Ph[o],c=t[o];if(!l||!(typeof c==typeof l.value||d2[(typeof c).toUpperCase()]&l.type))continue;const{kind:d}=l;i&&!(d&ct.BROWSER||d&ct.PREFERENCE)||(this.eventBus&&d&ct.EVENT_DISPATCH&&(n||(n=new Map)).set(o,c),u(this,Gc).set(o,c))}if(n)for(const[o,l]of n)this.eventBus.dispatch(o.toLowerCase(),{source:this,value:l})}};Gc=new WeakMap,St(Fl,"eventBus"),j(Fl,Gc,new Map),(()=>{for(const t in Ph)u(Fl,Gc).set(t,Ph[t].value);for(const[t,i]of c2)u(Fl,Gc).set(t,i);Fl._hasInvokedSet=!1,Fl._checkDisablePreferences=()=>Fl.get("disablePreferences")?!0:(Fl._hasInvokedSet&&console.warn('The Preferences may override manually set AppOptions; please use the "disablePreferences"-option to prevent that.'),!1)})();let Nt=Fl;const s7="noopener noreferrer nofollow",Lu={NONE:0,SELF:1,BLANK:2,PARENT:3,TOP:4};class FF{constructor({eventBus:t,externalLinkTarget:i=null,externalLinkRel:n=null,ignoreDestinationZoom:o=!1}={}){St(this,"externalLinkEnabled",!0);this.eventBus=t,this.externalLinkTarget=i,this.externalLinkRel=n,this._ignoreDestinationZoom=o,this.baseUrl=null,this.pdfDocument=null,this.pdfViewer=null,this.pdfHistory=null}setDocument(t,i=null){this.baseUrl=i,this.pdfDocument=t}setViewer(t){this.pdfViewer=t}setHistory(t){this.pdfHistory=t}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return this.pdfDocument?this.pdfViewer.currentPageNumber:1}set page(t){this.pdfDocument&&(this.pdfViewer.currentPageNumber=t)}get rotation(){return this.pdfDocument?this.pdfViewer.pagesRotation:0}set rotation(t){this.pdfDocument&&(this.pdfViewer.pagesRotation=t)}get isInPresentationMode(){return this.pdfDocument?this.pdfViewer.isInPresentationMode:!1}async goToDestination(t){if(!this.pdfDocument)return;let i,n,o;if(typeof t=="string"?(i=t,n=await this.pdfDocument.getDestination(t)):(i=null,n=await t),!Array.isArray(n)){console.error(`goToDestination: "${n}" is not a valid destination array, for dest="${t}".`);return}const[l]=n;if(l&&typeof l=="object"){if(o=this.pdfDocument.cachedPageNumber(l),!o)try{o=await this.pdfDocument.getPageIndex(l)+1}catch{console.error(`goToDestination: "${l}" is not a valid page reference, for dest="${t}".`);return}}else Number.isInteger(l)&&(o=l+1);if(!o||o<1||o>this.pagesCount){console.error(`goToDestination: "${o}" is not a valid page number, for dest="${t}".`);return}this.pdfHistory&&(this.pdfHistory.pushCurrentPosition(),this.pdfHistory.push({namedDest:i,explicitDest:n,pageNumber:o})),this.pdfViewer.scrollPageIntoView({pageNumber:o,destArray:n,ignoreDestinationZoom:this._ignoreDestinationZoom})}goToPage(t){if(!this.pdfDocument)return;const i=typeof t=="string"&&this.pdfViewer.pageLabelToPageNumber(t)||t|0;if(!(Number.isInteger(i)&&i>0&&i<=this.pagesCount)){console.error(`PDFLinkService.goToPage: "${t}" is not a valid page.`);return}this.pdfHistory&&(this.pdfHistory.pushCurrentPosition(),this.pdfHistory.pushPage(i)),this.pdfViewer.scrollPageIntoView({pageNumber:i})}addLinkAttributes(t,i,n=!1){if(!i||typeof i!="string")throw new Error('A valid "url" parameter must provided.');const o=n?Lu.BLANK:this.externalLinkTarget,l=this.externalLinkRel;this.externalLinkEnabled?t.href=t.title=i:(t.href="",t.title=`Disabled: ${i}`,t.onclick=()=>!1);let c="";switch(o){case Lu.NONE:break;case Lu.SELF:c="_self";break;case Lu.BLANK:c="_blank";break;case Lu.PARENT:c="_parent";break;case Lu.TOP:c="_top";break}t.target=c,t.rel=typeof l=="string"?l:s7}getDestinationHash(t){if(typeof t=="string"){if(t.length>0)return this.getAnchorUrl("#"+escape(t))}else if(Array.isArray(t)){const i=JSON.stringify(t);if(i.length>0)return this.getAnchorUrl("#"+escape(i))}return this.getAnchorUrl("")}getAnchorUrl(t){return this.baseUrl?this.baseUrl+t:t}setHash(t){if(!this.pdfDocument)return;let i,n;if(t.includes("=")){const o=hy(t);if(o.has("search")){const l=o.get("search").replaceAll('"',""),c=o.get("phrase")==="true";this.eventBus.dispatch("findfromurlhash",{source:this,query:c?l:l.match(/\S+/g)})}if(o.has("page")&&(i=o.get("page")|0||1),o.has("zoom")){const l=o.get("zoom").split(","),c=l[0],d=parseFloat(c);c.includes("Fit")?c==="Fit"||c==="FitB"?n=[null,{name:c}]:c==="FitH"||c==="FitBH"||c==="FitV"||c==="FitBV"?n=[null,{name:c},l.length>1?l[1]|0:null]:c==="FitR"?l.length!==5?console.error('PDFLinkService.setHash: Not enough parameters for "FitR".'):n=[null,{name:c},l[1]|0,l[2]|0,l[3]|0,l[4]|0]:console.error(`PDFLinkService.setHash: "${c}" is not a valid zoom value.`):n=[null,{name:"XYZ"},l.length>1?l[1]|0:null,l.length>2?l[2]|0:null,d?d/100:c]}n?this.pdfViewer.scrollPageIntoView({pageNumber:i||this.page,destArray:n,allowNegativeOffset:!0}):i&&(this.page=i),o.has("pagemode")&&this.eventBus.dispatch("pagemode",{source:this,mode:o.get("pagemode")}),o.has("nameddest")&&this.goToDestination(o.get("nameddest"));return}n=unescape(t);try{n=JSON.parse(n),Array.isArray(n)||(n=n.toString())}catch{}if(typeof n=="string"||Hz(n)){this.goToDestination(n);return}console.error(`PDFLinkService.setHash: "${unescape(t)}" is not a valid destination.`)}executeNamedAction(t){var i,n;if(this.pdfDocument){switch(t){case"GoBack":(i=this.pdfHistory)==null||i.back();break;case"GoForward":(n=this.pdfHistory)==null||n.forward();break;case"NextPage":this.pdfViewer.nextPage();break;case"PrevPage":this.pdfViewer.previousPage();break;case"LastPage":this.page=this.pagesCount;break;case"FirstPage":this.page=1;break}this.eventBus.dispatch("namedaction",{source:this,action:t})}}async executeSetOCGState(t){if(!this.pdfDocument)return;const i=this.pdfDocument,n=await this.pdfViewer.optionalContentConfigPromise;i===this.pdfDocument&&(n.setOCGState(t),this.pdfViewer.optionalContentConfigPromise=Promise.resolve(n))}}class BF extends FF{setDocument(t,i=null){}}const vR={EVENT:"event",TIMEOUT:"timeout"};async function UF({target:g,name:t,delay:i=0}){if(typeof g!="object"||!(t&&typeof t=="string")||!(Number.isInteger(i)&&i>=0))throw new Error("waitOnEventOrTimeout - invalid parameters.");const{promise:n,resolve:o}=Promise.withResolvers(),l=new AbortController;function c(m){l.abort(),clearTimeout(f),o(m)}const d=g instanceof jF?"_on":"addEventListener";g[d](t,c.bind(null,vR.EVENT),{signal:l.signal});const f=setTimeout(c.bind(null,vR.TIMEOUT),i);return n}var b0;class jF{constructor(){j(this,b0,Object.create(null))}on(t,i,n=null){this._on(t,i,{external:!0,once:n==null?void 0:n.once,signal:n==null?void 0:n.signal})}off(t,i,n=null){this._off(t,i)}dispatch(t,i){const n=u(this,b0)[t];if(!n||n.length===0)return;let o;for(const{listener:l,external:c,once:d}of n.slice(0)){if(d&&this._off(t,l),c){(o||(o=[])).push(l);continue}l(i)}if(o){for(const l of o)l(i);o=null}}_on(t,i,n=null){var c;let o=null;if((n==null?void 0:n.signal)instanceof AbortSignal){const{signal:d}=n;if(d.aborted){console.error("Cannot use an `aborted` signal.");return}const f=()=>this._off(t,i);o=()=>d.removeEventListener("abort",f),d.addEventListener("abort",f)}((c=u(this,b0))[t]||(c[t]=[])).push({listener:i,external:(n==null?void 0:n.external)===!0,once:(n==null?void 0:n.once)===!0,rmAbort:o})}_off(t,i,n=null){var l;const o=u(this,b0)[t];if(o)for(let c=0,d=o.length;c<d;c++){const f=o[c];if(f.listener===i){(l=f.rmAbort)==null||l.call(f),o.splice(c,1);return}}}}b0=new WeakMap;class n7{updateFindControlState(t){}updateFindMatchesCount(t){}initPassiveLoading(){}reportTelemetry(t){}async createL10n(){throw new Error("Not implemented: createL10n")}createScripting(){throw new Error("Not implemented: createScripting")}createSignatureStorage(){throw new Error("Not implemented: createSignatureStorage")}updateEditorStates(t){throw new Error("Not implemented: updateEditorStates")}dispatchGlobalEvent(t){}}var y0,Xc;class r7{constructor(){j(this,y0,Object.freeze({altTextLearnMoreUrl:"",annotationEditorMode:0,annotationMode:2,capCanvasAreaFactor:200,cursorToolOnLoad:0,defaultZoomDelay:400,defaultZoomValue:"",disablePageLabels:!1,enableAltText:!1,enableAltTextModelDownload:!0,enableAutoLinking:!0,enableGuessAltText:!0,enableHighlightFloatingButton:!1,enableNewAltTextWhenAddingImage:!0,enablePermissions:!1,enablePrintAutoRotate:!0,enableScripting:!0,enableSignatureEditor:!1,enableUpdatedAddImage:!1,externalLinkTarget:0,highlightEditorColors:"yellow=#FFFF98,green=#53FFBC,blue=#80EBFF,pink=#FFCBE6,red=#FF4F5F",historyUpdateUrl:!1,ignoreDestinationZoom:!1,forcePageColors:!1,pageColorsBackground:"Canvas",pageColorsForeground:"CanvasText",pdfBugEnabled:!1,sidebarViewOnLoad:-1,scrollModeOnLoad:-1,spreadModeOnLoad:-1,textLayerMode:1,viewerCssTheme:0,viewOnLoad:0,disableAutoFetch:!1,disableFontFace:!1,disableRange:!1,disableStream:!1,enableHWA:!0,enableXfa:!0}));j(this,Xc,null);D(this,Xc,this._readFromStorage(u(this,y0)).then(({browserPrefs:t,prefs:i})=>{Nt._checkDisablePreferences()||Nt.setAll({...t,...i},!0)}))}async _writeToStorage(t){throw new Error("Not implemented: _writeToStorage")}async _readFromStorage(t){throw new Error("Not implemented: _readFromStorage")}async reset(){await u(this,Xc),Nt.setAll(u(this,y0),!0),await this._writeToStorage(u(this,y0))}async set(t,i){await u(this,Xc),Nt.setAll({[t]:i},!0),await this._writeToStorage(Nt.getAll(ct.PREFERENCE))}async get(t){return await u(this,Xc),Nt.get(t)}get initializedPromise(){return u(this,Xc)}}y0=new WeakMap,Xc=new WeakMap;class om{constructor(t){this.value=t}valueOf(){return this.value}}class Wn extends om{constructor(t="???"){super(t)}toString(t){return`{${this.value}}`}}class Ih extends om{constructor(t,i={}){super(t),this.opts=i}toString(t){if(t)try{return t.memoizeIntlObject(Intl.NumberFormat,this.opts).format(this.value)}catch(i){t.reportError(i)}return this.value.toString(10)}}class Dd extends om{static supportsValue(t){if(typeof t=="number"||t instanceof Date)return!0;if(t instanceof om)return Dd.supportsValue(t.valueOf());if("Temporal"in globalThis){const i=globalThis.Temporal;if(t instanceof i.Instant||t instanceof i.PlainDateTime||t instanceof i.PlainDate||t instanceof i.PlainMonthDay||t instanceof i.PlainTime||t instanceof i.PlainYearMonth)return!0}return!1}constructor(t,i={}){t instanceof Dd?(i={...t.opts,...i},t=t.value):t instanceof om&&(t=t.valueOf()),typeof t=="object"&&"calendarId"in t&&i.calendar===void 0&&(i={...i,calendar:t.calendarId}),super(t),this.opts=i}[Symbol.toPrimitive](t){return t==="string"?this.toString():this.toNumber()}toNumber(){const t=this.value;if(typeof t=="number")return t;if(t instanceof Date)return t.getTime();if("epochMilliseconds"in t)return t.epochMilliseconds;if("toZonedDateTime"in t)return t.toZonedDateTime("UTC").epochMilliseconds;throw new TypeError("Unwrapping a non-number value as a number")}toString(t){if(t)try{return t.memoizeIntlObject(Intl.DateTimeFormat,this.opts).format(this.value)}catch(i){t.reportError(i)}return typeof this.value=="number"||this.value instanceof Date?new Date(this.value).toISOString():this.value.toString()}}const wR=100,a7="â¨",o7="â©";function l7(g,t,i){if(i===t||i instanceof Ih&&t instanceof Ih&&i.value===t.value)return!0;if(t instanceof Ih&&typeof i=="string"){let n=g.memoizeIntlObject(Intl.PluralRules,t.opts).select(t.value);if(i===n)return!0}return!1}function TR(g,t,i){return t[i]?l_(g,t[i].value):(g.reportError(new RangeError("No default")),new Wn)}function f2(g,t){const i=[],n=Object.create(null);for(const o of t)o.type==="narg"?n[o.name]=dy(g,o.value):i.push(dy(g,o));return{positional:i,named:n}}function dy(g,t){switch(t.type){case"str":return t.value;case"num":return new Ih(t.value,{minimumFractionDigits:t.precision});case"var":return u7(g,t);case"mesg":return h7(g,t);case"term":return c7(g,t);case"func":return d7(g,t);case"select":return f7(g,t);default:return new Wn}}function u7(g,{name:t}){let i;if(g.params)if(Object.prototype.hasOwnProperty.call(g.params,t))i=g.params[t];else return new Wn(`$${t}`);else if(g.args&&Object.prototype.hasOwnProperty.call(g.args,t))i=g.args[t];else return g.reportError(new ReferenceError(`Unknown variable: $${t}`)),new Wn(`$${t}`);if(i instanceof om)return i;switch(typeof i){case"string":return i;case"number":return new Ih(i);case"object":if(Dd.supportsValue(i))return new Dd(i);default:return g.reportError(new TypeError(`Variable type not supported: $${t}, ${typeof i}`)),new Wn(`$${t}`)}}function h7(g,{name:t,attr:i}){const n=g.bundle._messages.get(t);if(!n)return g.reportError(new ReferenceError(`Unknown message: ${t}`)),new Wn(t);if(i){const o=n.attributes[i];return o?l_(g,o):(g.reportError(new ReferenceError(`Unknown attribute: ${i}`)),new Wn(`${t}.${i}`))}return n.value?l_(g,n.value):(g.reportError(new ReferenceError(`No value: ${t}`)),new Wn(t))}function c7(g,{name:t,attr:i,args:n}){const o=`-${t}`,l=g.bundle._terms.get(o);if(!l)return g.reportError(new ReferenceError(`Unknown term: ${o}`)),new Wn(o);if(i){const d=l.attributes[i];if(d){g.params=f2(g,n).named;const f=l_(g,d);return g.params=null,f}return g.reportError(new ReferenceError(`Unknown attribute: ${i}`)),new Wn(`${o}.${i}`)}g.params=f2(g,n).named;const c=l_(g,l.value);return g.params=null,c}function d7(g,{name:t,args:i}){let n=g.bundle._functions[t];if(!n)return g.reportError(new ReferenceError(`Unknown function: ${t}()`)),new Wn(`${t}()`);if(typeof n!="function")return g.reportError(new TypeError(`Function ${t}() is not callable`)),new Wn(`${t}()`);try{let o=f2(g,i);return n(o.positional,o.named)}catch(o){return g.reportError(o),new Wn(`${t}()`)}}function f7(g,{selector:t,variants:i,star:n}){let o=dy(g,t);if(o instanceof Wn)return TR(g,i,n);for(const l of i){const c=dy(g,l.key);if(l7(g,o,c))return l_(g,l.value)}return TR(g,i,n)}function HF(g,t){if(g.dirty.has(t))return g.reportError(new RangeError("Cyclic reference")),new Wn;g.dirty.add(t);const i=[],n=g.bundle._useIsolating&&t.length>1;for(const o of t){if(typeof o=="string"){i.push(g.bundle._transform(o));continue}if(g.placeables++,g.placeables>wR)throw g.dirty.delete(t),new RangeError(`Too many placeables expanded: ${g.placeables}, max allowed is ${wR}`);n&&i.push(a7),i.push(dy(g,o).toString(g)),n&&i.push(o7)}return g.dirty.delete(t),i.join("")}function l_(g,t){return typeof t=="string"?g.bundle._transform(t):HF(g,t)}class p7{constructor(t,i,n){this.dirty=new WeakSet,this.params=null,this.placeables=0,this.bundle=t,this.errors=i,this.args=n}reportError(t){if(!this.errors||!(t instanceof Error))throw t;this.errors.push(t)}memoizeIntlObject(t,i){let n=this.bundle._intls.get(t);n||(n={},this.bundle._intls.set(t,n));let o=JSON.stringify(i);return n[o]||(n[o]=new t(this.bundle.locales,i)),n[o]}}function p2(g,t){const i=Object.create(null);for(const[n,o]of Object.entries(g))t.includes(n)&&(i[n]=o.valueOf());return i}const ER=["unitDisplay","currencyDisplay","useGrouping","minimumIntegerDigits","minimumFractionDigits","maximumFractionDigits","minimumSignificantDigits","maximumSignificantDigits"];function g7(g,t){let i=g[0];if(i instanceof Wn)return new Wn(`NUMBER(${i.valueOf()})`);if(i instanceof Ih)return new Ih(i.valueOf(),{...i.opts,...p2(t,ER)});if(i instanceof Dd)return new Ih(i.toNumber(),{...p2(t,ER)});throw new TypeError("Invalid argument to NUMBER")}const m7=["dateStyle","timeStyle","fractionalSecondDigits","dayPeriod","hour12","weekday","era","year","month","day","hour","minute","second","timeZoneName"];function _7(g,t){let i=g[0];if(i instanceof Wn)return new Wn(`DATETIME(${i.valueOf()})`);if(i instanceof Dd||i instanceof Ih)return new Dd(i,p2(t,m7));throw new TypeError("Invalid argument to DATETIME")}const SR=new Map;function b7(g){const t=Array.isArray(g)?g.join(" "):g;let i=SR.get(t);return i===void 0&&(i=new Map,SR.set(t,i)),i}class y7{constructor(t,{functions:i,useIsolating:n=!0,transform:o=l=>l}={}){this._terms=new Map,this._messages=new Map,this.locales=Array.isArray(t)?t:[t],this._functions={NUMBER:g7,DATETIME:_7,...i},this._useIsolating=n,this._transform=o,this._intls=b7(t)}hasMessage(t){return this._messages.has(t)}getMessage(t){return this._messages.get(t)}addResource(t,{allowOverrides:i=!1}={}){const n=[];for(let o=0;o<t.body.length;o++){let l=t.body[o];if(l.id.startsWith("-")){if(i===!1&&this._terms.has(l.id)){n.push(new Error(`Attempt to override an existing term: "${l.id}"`));continue}this._terms.set(l.id,l)}else{if(i===!1&&this._messages.has(l.id)){n.push(new Error(`Attempt to override an existing message: "${l.id}"`));continue}this._messages.set(l.id,l)}}return n}formatPattern(t,i=null,n=null){if(typeof t=="string")return this._transform(t);let o=new p7(this,n,i);try{return HF(o,t).toString(o)}catch(l){if(o.errors&&l instanceof Error)return o.errors.push(l),new Wn().toString(o);throw l}}}const MA=/^(-?[a-zA-Z][\w-]*) *= */gm,xR=/\.([a-zA-Z][\w-]*) *= */y,v7=/\*?\[/y,OA=/(-?[0-9]+(?:\.([0-9]+))?)/y,w7=/([a-zA-Z][\w-]*)/y,AR=/([$-])?([a-zA-Z][\w-]*)(?:\.([a-zA-Z][\w-]*))?/y,T7=/^[A-Z][A-Z0-9_-]*$/,HE=/([^{}\n\r]+)/y,E7=/([^\\"\n\r]*)/y,CR=/\\([\\"])/y,kR=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{6})/y,S7=/^\n+/,PR=/ +$/,x7=/ *\r?\n/g,A7=/( *)$/,C7=/{\s*/y,DR=/\s*}/y,k7=/\[\s*/y,P7=/\s*] */y,D7=/\s*\(\s*/y,I7=/\s*->\s*/y,L7=/\s*:\s*/y,N7=/\s*,?\s*/y,R7=/\s+/y;class M7{constructor(t){this.body=[],MA.lastIndex=0;let i=0;for(;;){let J=MA.exec(t);if(J===null)break;i=MA.lastIndex;try{this.body.push(f(J[1]))}catch(ye){if(ye instanceof SyntaxError)continue;throw ye}}function n(J){return J.lastIndex=i,J.test(t)}function o(J,ye){if(t[i]===J)return i++,!0;if(ye)throw new ye(`Expected ${J}`);return!1}function l(J,ye){if(n(J))return i=J.lastIndex,!0;if(ye)throw new ye(`Expected ${J.toString()}`);return!1}function c(J){J.lastIndex=i;let ye=J.exec(t);if(ye===null)throw new SyntaxError(`Expected ${J.toString()}`);return i=J.lastIndex,ye}function d(J){return c(J)[1]}function f(J){let ye=b(),Oe=m();if(ye===null&&Object.keys(Oe).length===0)throw new SyntaxError("Expected message value or attributes");return{id:J,value:ye,attributes:Oe}}function m(){let J=Object.create(null);for(;n(xR);){let ye=d(xR),Oe=b();if(Oe===null)throw new SyntaxError("Expected attribute value");J[ye]=Oe}return J}function b(){let J;if(n(HE)&&(J=d(HE)),t[i]==="{"||t[i]==="}")return T(J?[J]:[],1/0);let ye=A();return ye?J?T([J,ye],ye.length):(ye.value=me(ye.value,S7),T([ye],ye.length)):J?me(J,PR):null}function T(J=[],ye){for(;;){if(n(HE)){J.push(d(HE));continue}if(t[i]==="{"){J.push(C());continue}if(t[i]==="}")throw new SyntaxError("Unbalanced closing brace");let dt=A();if(dt){J.push(dt),ye=Math.min(ye,dt.length);continue}break}let Oe=J.length-1,ot=J[Oe];typeof ot=="string"&&(J[Oe]=me(ot,PR));let Tt=[];for(let dt of J)dt instanceof IR&&(dt=dt.value.slice(0,dt.value.length-ye)),dt&&Tt.push(dt);return Tt}function C(){l(C7,SyntaxError);let J=P();if(l(DR))return J;if(l(I7)){let ye=F();return l(DR,SyntaxError),{type:"select",selector:J,...ye}}throw new SyntaxError("Unclosed placeable")}function P(){if(t[i]==="{")return C();if(n(AR)){let[,J,ye,Oe=null]=c(AR);if(J==="$")return{type:"var",name:ye};if(l(D7)){let ot=x();if(J==="-")return{type:"term",name:ye,attr:Oe,args:ot};if(T7.test(ye))return{type:"func",name:ye,args:ot};throw new SyntaxError("Function names must be all upper-case")}return J==="-"?{type:"term",name:ye,attr:Oe,args:[]}:{type:"mesg",name:ye,attr:Oe}}return re()}function x(){let J=[];for(;;){switch(t[i]){case")":return i++,J;case void 0:throw new SyntaxError("Unclosed argument list")}J.push(L()),l(N7)}}function L(){let J=P();return J.type!=="mesg"?J:l(L7)?{type:"narg",name:J.name,value:re()}:J}function F(){let J=[],ye=0,Oe;for(;n(v7);){o("*")&&(Oe=ye);let ot=X(),Tt=b();if(Tt===null)throw new SyntaxError("Expected variant value");J[ye++]={key:ot,value:Tt}}if(ye===0)return null;if(Oe===void 0)throw new SyntaxError("Expected default variant");return{variants:J,star:Oe}}function X(){l(k7,SyntaxError);let J;return n(OA)?J=K():J={type:"str",value:d(w7)},l(P7,SyntaxError),J}function re(){if(n(OA))return K();if(t[i]==='"')return te();throw new SyntaxError("Invalid expression")}function K(){let[,J,ye=""]=c(OA),Oe=ye.length;return{type:"num",value:parseFloat(J),precision:Oe}}function te(){o('"',SyntaxError);let J="";for(;;){if(J+=d(E7),t[i]==="\\"){J+=ee();continue}if(o('"'))return{type:"str",value:J};throw new SyntaxError("Unclosed string literal")}}function ee(){if(n(CR))return d(CR);if(n(kR)){let[,J,ye]=c(kR),Oe=parseInt(J||ye,16);return Oe<=55295||57344<=Oe?String.fromCodePoint(Oe):"ï¿½"}throw new SyntaxError("Unknown escape sequence")}function A(){let J=i;switch(l(R7),t[i]){case".":case"[":case"*":case"}":case void 0:return!1;case"{":return fe(t.slice(J,i))}return t[i-1]===" "?fe(t.slice(J,i)):!1}function me(J,ye){return J.replace(ye,"")}function fe(J){let ye=J.replace(x7,`
`),Oe=A7.exec(J)[1].length;return new IR(ye,Oe)}}}class IR{constructor(t,i){this.value=t,this.length=i}}const O7=/<|&#?\w+;/,F7={"http://www.w3.org/1999/xhtml":["em","strong","small","s","cite","q","dfn","abbr","data","time","code","var","samp","kbd","sub","sup","i","b","u","mark","bdi","bdo","span","br","wbr"]},B7={"http://www.w3.org/1999/xhtml":{global:["title","aria-description","aria-label","aria-valuetext"],a:["download"],area:["download","alt"],input:["alt","placeholder"],menuitem:["label"],menu:["label"],optgroup:["label"],option:["label"],track:["label"],img:["alt"],textarea:["placeholder"],th:["abbr"]},"http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul":{global:["accesskey","aria-label","aria-valuetext","label","title","tooltiptext"],description:["value"],key:["key","keycode"],label:["value"],textbox:["placeholder","value"]}};function U7(g,t){const{value:i}=t;if(typeof i=="string")if(g.localName==="title"&&g.namespaceURI==="http://www.w3.org/1999/xhtml")g.textContent=i;else if(!O7.test(i))g.textContent=i;else{const n=g.ownerDocument.createElementNS("http://www.w3.org/1999/xhtml","template");n.innerHTML=i,j7(n.content,g)}VF(t,g)}function j7(g,t){for(const i of g.childNodes)if(i.nodeType!==i.TEXT_NODE){if(i.hasAttribute("data-l10n-name")){const n=V7(t,i);g.replaceChild(n,i);continue}if(z7(i)){const n=$7(i);g.replaceChild(n,i);continue}console.warn(`An element of forbidden type "${i.localName}" was found in the translation. Only safe text-level elements and elements with data-l10n-name are allowed.`),g.replaceChild(g2(i),i)}t.textContent="",t.appendChild(g)}function H7(g,t){if(!g)return!1;for(let i of g)if(i.name===t)return!0;return!1}function VF(g,t){const i=t.hasAttribute("data-l10n-attrs")?t.getAttribute("data-l10n-attrs").split(",").map(n=>n.trim()):null;for(const n of Array.from(t.attributes))LR(n.name,t,i)&&!H7(g.attributes,n.name)&&t.removeAttribute(n.name);if(g.attributes)for(const n of Array.from(g.attributes))LR(n.name,t,i)&&t.getAttribute(n.name)!==n.value&&t.setAttribute(n.name,n.value)}function V7(g,t){const i=t.getAttribute("data-l10n-name"),n=g.querySelector(`[data-l10n-name="${i}"]`);if(!n)return console.warn(`An element named "${i}" wasn't found in the source.`),g2(t);if(n.localName!==t.localName)return console.warn(`An element named "${i}" was found in the translation but its type ${t.localName} didn't match the element found in the source (${n.localName}).`),g2(t);g.removeChild(n);const o=n.cloneNode(!1);return $F(t,o)}function $7(g){const t=g.ownerDocument.createElement(g.localName);return $F(g,t)}function g2(g){return g.ownerDocument.createTextNode(g.textContent)}function z7(g){const t=F7[g.namespaceURI];return t&&t.includes(g.localName)}function LR(g,t,i=null){if(i&&i.includes(g))return!0;const n=B7[t.namespaceURI];if(!n)return!1;const o=g.toLowerCase(),l=t.localName;if(n.global.includes(o))return!0;if(!n[l])return!1;if(n[l].includes(o))return!0;if(t.namespaceURI==="http://www.w3.org/1999/xhtml"&&l==="input"&&o==="value"){const c=t.type.toLowerCase();if(c==="submit"||c==="button"||c==="reset")return!0}return!1}function $F(g,t){return t.textContent=g.textContent,VF(g,t),t}class W7 extends Array{static from(t){return t instanceof this?t:new this(t)}}class q7 extends W7{constructor(t){if(super(),Symbol.asyncIterator in Object(t))this.iterator=t[Symbol.asyncIterator]();else if(Symbol.iterator in Object(t))this.iterator=t[Symbol.iterator]();else throw new TypeError("Argument must implement the iteration protocol.")}[Symbol.asyncIterator](){const t=this;let i=0;return{async next(){return t.length<=i&&t.push(t.iterator.next()),t[i++]}}}async touchNext(t=1){let i=0;for(;i++<t;){const n=this[this.length-1];if(n&&(await n).done)break;this.push(this.iterator.next())}return this[this.length-1]}}class G7{constructor(t=[],i){this.resourceIds=t,this.generateBundles=i,this.onChange(!0)}addResourceIds(t,i=!1){return this.resourceIds.push(...t),this.onChange(i),this.resourceIds.length}removeResourceIds(t){return this.resourceIds=this.resourceIds.filter(i=>!t.includes(i)),this.onChange(),this.resourceIds.length}async formatWithFallback(t,i){const n=[];let o=!1;for await(const l of this.bundles){o=!0;const c=Y7(i,l,t,n);if(c.size===0)break;if(typeof console<"u"){const d=l.locales[0],f=Array.from(c).join(", ");console.warn(`[fluent] Missing translations in ${d}: ${f}`)}}return!o&&typeof console<"u"&&console.warn(`[fluent] Request for keys failed because no resource bundles got generated.
  keys: ${JSON.stringify(t)}.
  resourceIds: ${JSON.stringify(this.resourceIds)}.`),n}formatMessages(t){return this.formatWithFallback(t,K7)}formatValues(t){return this.formatWithFallback(t,X7)}async formatValue(t,i){const[n]=await this.formatValues([{id:t,args:i}]);return n}handleEvent(){this.onChange()}onChange(t=!1){this.bundles=q7.from(this.generateBundles(this.resourceIds)),t&&this.bundles.touchNext(2)}}function X7(g,t,i,n){return i.value?g.formatPattern(i.value,n,t):null}function K7(g,t,i,n){const o={value:null,attributes:null};i.value&&(o.value=g.formatPattern(i.value,n,t));let l=Object.keys(i.attributes);if(l.length>0){o.attributes=new Array(l.length);for(let[c,d]of l.entries()){let f=g.formatPattern(i.attributes[d],n,t);o.attributes[c]={name:d,value:f}}}return o}function Y7(g,t,i,n){const o=[],l=new Set;return i.forEach(({id:c,args:d},f)=>{if(n[f]!==void 0)return;let m=t.getMessage(c);if(m){if(o.length=0,n[f]=g(t,o,m,d),o.length>0&&typeof console<"u"){const b=t.locales[0],T=o.join(", ");console.warn(`[fluent][resolver] errors in ${b}/${c}: ${T}.`)}}else l.add(c)}),l}const nf="data-l10n-id",mb="data-l10n-args",Z7=`[${nf}]`;class Q7 extends G7{constructor(t,i){super(t,i),this.roots=new Set,this.pendingrAF=null,this.pendingElements=new Set,this.windowElement=null,this.mutationObserver=null,this.observerConfig={attributes:!0,characterData:!1,childList:!0,subtree:!0,attributeFilter:[nf,mb]}}onChange(t=!1){super.onChange(t),this.roots&&this.translateRoots()}setAttributes(t,i,n){return t.setAttribute(nf,i),n?t.setAttribute(mb,JSON.stringify(n)):t.removeAttribute(mb),t}getAttributes(t){return{id:t.getAttribute(nf),args:JSON.parse(t.getAttribute(mb)||null)}}connectRoot(t){for(const i of this.roots)if(i===t||i.contains(t)||t.contains(i))throw new Error("Cannot add a root that overlaps with existing root.");if(this.windowElement){if(this.windowElement!==t.ownerDocument.defaultView)throw new Error(`Cannot connect a root:
          DOMLocalization already has a root from a different window.`)}else this.windowElement=t.ownerDocument.defaultView,this.mutationObserver=new this.windowElement.MutationObserver(i=>this.translateMutations(i));this.roots.add(t),this.mutationObserver.observe(t,this.observerConfig)}disconnectRoot(t){return this.roots.delete(t),this.pauseObserving(),this.roots.size===0?(this.mutationObserver=null,this.windowElement&&this.pendingrAF&&this.windowElement.cancelAnimationFrame(this.pendingrAF),this.windowElement=null,this.pendingrAF=null,this.pendingElements.clear(),!0):(this.resumeObserving(),!1)}translateRoots(){const t=Array.from(this.roots);return Promise.all(t.map(i=>this.translateFragment(i)))}pauseObserving(){this.mutationObserver&&(this.translateMutations(this.mutationObserver.takeRecords()),this.mutationObserver.disconnect())}resumeObserving(){if(this.mutationObserver)for(const t of this.roots)this.mutationObserver.observe(t,this.observerConfig)}translateMutations(t){for(const i of t)switch(i.type){case"attributes":i.target.hasAttribute("data-l10n-id")&&this.pendingElements.add(i.target);break;case"childList":for(const n of i.addedNodes)if(n.nodeType===n.ELEMENT_NODE)if(n.childElementCount)for(const o of this.getTranslatables(n))this.pendingElements.add(o);else n.hasAttribute(nf)&&this.pendingElements.add(n);break}this.pendingElements.size>0&&this.pendingrAF===null&&(this.pendingrAF=this.windowElement.requestAnimationFrame(()=>{this.translateElements(Array.from(this.pendingElements)),this.pendingElements.clear(),this.pendingrAF=null}))}translateFragment(t){return this.translateElements(this.getTranslatables(t))}async translateElements(t){if(!t.length)return;const i=t.map(this.getKeysForElement),n=await this.formatMessages(i);return this.applyTranslations(t,n)}applyTranslations(t,i){this.pauseObserving();for(let n=0;n<t.length;n++)i[n]!==void 0&&U7(t[n],i[n]);this.resumeObserving()}getTranslatables(t){const i=Array.from(t.querySelectorAll(Z7));return typeof t.hasAttribute=="function"&&t.hasAttribute(nf)&&i.push(t),i}getKeysForElement(t){return{id:t.getAttribute(nf),args:JSON.parse(t.getAttribute(mb)||null)}}}var jv,Kc,v0,Ea,h_,zF,WF;const iy=class iy{constructor({lang:t,isRTL:i},n=null){j(this,jv);j(this,Kc);j(this,v0);j(this,Ea);var o,l;D(this,v0,R(o=iy,h_,zF).call(o,t)),D(this,Ea,n),D(this,jv,i??R(l=iy,h_,WF).call(l,u(this,v0))?"rtl":"ltr")}_setL10n(t){D(this,Ea,t)}getLanguage(){return u(this,v0)}getDirection(){return u(this,jv)}async get(t,i=null,n){var l;return Array.isArray(t)?(t=t.map(d=>({id:d})),(await u(this,Ea).formatMessages(t)).map(d=>d.value)):((l=(await u(this,Ea).formatMessages([{id:t,args:i}]))[0])==null?void 0:l.value)||n}async translate(t){(u(this,Kc)||D(this,Kc,new Set)).add(t);try{u(this,Ea).connectRoot(t),await u(this,Ea).translateRoots()}catch{}}async translateOnce(t){try{await u(this,Ea).translateElements([t])}catch(i){console.error("translateOnce:",i)}}async destroy(){if(u(this,Kc)){for(const t of u(this,Kc))u(this,Ea).disconnectRoot(t);u(this,Kc).clear(),D(this,Kc,null)}u(this,Ea).pauseObserving()}pause(){u(this,Ea).pauseObserving()}resume(){u(this,Ea).resumeObserving()}};jv=new WeakMap,Kc=new WeakMap,v0=new WeakMap,Ea=new WeakMap,h_=new WeakSet,zF=function(t){return t=(t==null?void 0:t.toLowerCase())||"en-us",{en:"en-us",es:"es-es",fy:"fy-nl",ga:"ga-ie",gu:"gu-in",hi:"hi-in",hy:"hy-am",nb:"nb-no",ne:"ne-np",nn:"nn-no",pa:"pa-in",pt:"pt-pt",sv:"sv-se",zh:"zh-cn"}[t]||t},WF=function(t){const i=t.split("-",1)[0];return["ar","he","fa","ps","ur"].includes(i)},j(iy,h_);let m2=iy;function J7(){const{isAndroid:g,isLinux:t,isMac:i,isWindows:n}=Nz.platform;return t?"linux":n?"windows":i?"macos":g?"android":"other"}function NR(g,t){const i=new M7(t),n=new y7(g,{functions:{PLATFORM:J7}}),o=n.addResource(i);return o.length&&console.error("L10n errors",o),n}var uo,qF,GF,XF,KF,_2;const lf=class lf extends m2{constructor(t){super({lang:t});const i=t?R(lf,uo,qF).bind(lf,"en-us",this.getLanguage()):R(lf,uo,KF).bind(lf,this.getLanguage());this._setL10n(new Q7([],i))}};uo=new WeakSet,qF=async function*(t,i){const{baseURL:n,paths:o}=await R(this,uo,XF).call(this),l=[i];if(t!==i){const d=i.split("-",1)[0];d!==i&&l.push(d),l.push(t)}const c=l.map(d=>[d,R(this,uo,GF).call(this,d,n,o)]);for(const[d,f]of c){const m=await f;m?yield m:d==="en-us"&&(yield R(this,uo,_2).call(this,d))}},GF=async function(t,i,n){const o=n[t];if(!o)return null;const l=new URL(o,i),c=await dR(l,"text");return NR(t,c)},XF=async function(){try{const{href:t}=document.querySelector('link[type="application/l10n"]'),i=await dR(t,"json");return{baseURL:t.substring(0,t.lastIndexOf("/")+1)||"./",paths:i}}catch{}return{baseURL:"./",paths:Object.create(null)}},KF=async function*(t){yield R(this,uo,_2).call(this,t)},_2=async function(t){return NR(t,`pdfjs-previous-button =
    .title = Previous Page
pdfjs-previous-button-label = Previous
pdfjs-next-button =
    .title = Next Page
pdfjs-next-button-label = Next
pdfjs-page-input =
    .title = Page
pdfjs-of-pages = of { $pagesCount }
pdfjs-page-of-pages = ({ $pageNumber } of { $pagesCount })
pdfjs-zoom-out-button =
    .title = Zoom Out
pdfjs-zoom-out-button-label = Zoom Out
pdfjs-zoom-in-button =
    .title = Zoom In
pdfjs-zoom-in-button-label = Zoom In
pdfjs-zoom-select =
    .title = Zoom
pdfjs-presentation-mode-button =
    .title = Switch to Presentation Mode
pdfjs-presentation-mode-button-label = Presentation Mode
pdfjs-open-file-button =
    .title = Open File
pdfjs-open-file-button-label = Open
pdfjs-print-button =
    .title = Print
pdfjs-print-button-label = Print
pdfjs-save-button =
    .title = Save
pdfjs-save-button-label = Save
pdfjs-download-button =
    .title = Download
pdfjs-download-button-label = Download
pdfjs-bookmark-button =
    .title = Current Page (View URL from Current Page)
pdfjs-bookmark-button-label = Current Page
pdfjs-tools-button =
    .title = Tools
pdfjs-tools-button-label = Tools
pdfjs-first-page-button =
    .title = Go to First Page
pdfjs-first-page-button-label = Go to First Page
pdfjs-last-page-button =
    .title = Go to Last Page
pdfjs-last-page-button-label = Go to Last Page
pdfjs-page-rotate-cw-button =
    .title = Rotate Clockwise
pdfjs-page-rotate-cw-button-label = Rotate Clockwise
pdfjs-page-rotate-ccw-button =
    .title = Rotate Counterclockwise
pdfjs-page-rotate-ccw-button-label = Rotate Counterclockwise
pdfjs-cursor-text-select-tool-button =
    .title = Enable Text Selection Tool
pdfjs-cursor-text-select-tool-button-label = Text Selection Tool
pdfjs-cursor-hand-tool-button =
    .title = Enable Hand Tool
pdfjs-cursor-hand-tool-button-label = Hand Tool
pdfjs-scroll-page-button =
    .title = Use Page Scrolling
pdfjs-scroll-page-button-label = Page Scrolling
pdfjs-scroll-vertical-button =
    .title = Use Vertical Scrolling
pdfjs-scroll-vertical-button-label = Vertical Scrolling
pdfjs-scroll-horizontal-button =
    .title = Use Horizontal Scrolling
pdfjs-scroll-horizontal-button-label = Horizontal Scrolling
pdfjs-scroll-wrapped-button =
    .title = Use Wrapped Scrolling
pdfjs-scroll-wrapped-button-label = Wrapped Scrolling
pdfjs-spread-none-button =
    .title = Do not join page spreads
pdfjs-spread-none-button-label = No Spreads
pdfjs-spread-odd-button =
    .title = Join page spreads starting with odd-numbered pages
pdfjs-spread-odd-button-label = Odd Spreads
pdfjs-spread-even-button =
    .title = Join page spreads starting with even-numbered pages
pdfjs-spread-even-button-label = Even Spreads
pdfjs-document-properties-button =
    .title = Document Propertiesâ¦
pdfjs-document-properties-button-label = Document Propertiesâ¦
pdfjs-document-properties-file-name = File name:
pdfjs-document-properties-file-size = File size:
pdfjs-document-properties-size-kb = { NUMBER($kb, maximumSignificantDigits: 3) } KB ({ $b } bytes)
pdfjs-document-properties-size-mb = { NUMBER($mb, maximumSignificantDigits: 3) } MB ({ $b } bytes)
pdfjs-document-properties-title = Title:
pdfjs-document-properties-author = Author:
pdfjs-document-properties-subject = Subject:
pdfjs-document-properties-keywords = Keywords:
pdfjs-document-properties-creation-date = Creation Date:
pdfjs-document-properties-modification-date = Modification Date:
pdfjs-document-properties-date-time-string = { DATETIME($dateObj, dateStyle: "short", timeStyle: "medium") }
pdfjs-document-properties-creator = Creator:
pdfjs-document-properties-producer = PDF Producer:
pdfjs-document-properties-version = PDF Version:
pdfjs-document-properties-page-count = Page Count:
pdfjs-document-properties-page-size = Page Size:
pdfjs-document-properties-page-size-unit-inches = in
pdfjs-document-properties-page-size-unit-millimeters = mm
pdfjs-document-properties-page-size-orientation-portrait = portrait
pdfjs-document-properties-page-size-orientation-landscape = landscape
pdfjs-document-properties-page-size-name-a-three = A3
pdfjs-document-properties-page-size-name-a-four = A4
pdfjs-document-properties-page-size-name-letter = Letter
pdfjs-document-properties-page-size-name-legal = Legal
pdfjs-document-properties-page-size-dimension-string = { $width } Ã { $height } { $unit } ({ $orientation })
pdfjs-document-properties-page-size-dimension-name-string = { $width } Ã { $height } { $unit } ({ $name }, { $orientation })
pdfjs-document-properties-linearized = Fast Web View:
pdfjs-document-properties-linearized-yes = Yes
pdfjs-document-properties-linearized-no = No
pdfjs-document-properties-close-button = Close
pdfjs-print-progress-message = Preparing document for printingâ¦
pdfjs-print-progress-percent = { $progress }%
pdfjs-print-progress-close-button = Cancel
pdfjs-printing-not-supported = Warning: Printing is not fully supported by this browser.
pdfjs-printing-not-ready = Warning: The PDF is not fully loaded for printing.
pdfjs-toggle-sidebar-button =
    .title = Toggle Sidebar
pdfjs-toggle-sidebar-notification-button =
    .title = Toggle Sidebar (document contains outline/attachments/layers)
pdfjs-toggle-sidebar-button-label = Toggle Sidebar
pdfjs-document-outline-button =
    .title = Show Document Outline (double-click to expand/collapse all items)
pdfjs-document-outline-button-label = Document Outline
pdfjs-attachments-button =
    .title = Show Attachments
pdfjs-attachments-button-label = Attachments
pdfjs-layers-button =
    .title = Show Layers (double-click to reset all layers to the default state)
pdfjs-layers-button-label = Layers
pdfjs-thumbs-button =
    .title = Show Thumbnails
pdfjs-thumbs-button-label = Thumbnails
pdfjs-current-outline-item-button =
    .title = Find Current Outline Item
pdfjs-current-outline-item-button-label = Current Outline Item
pdfjs-findbar-button =
    .title = Find in Document
pdfjs-findbar-button-label = Find
pdfjs-additional-layers = Additional Layers
pdfjs-thumb-page-title =
    .title = Page { $page }
pdfjs-thumb-page-canvas =
    .aria-label = Thumbnail of Page { $page }
pdfjs-find-input =
    .title = Find
    .placeholder = Find in documentâ¦
pdfjs-find-previous-button =
    .title = Find the previous occurrence of the phrase
pdfjs-find-previous-button-label = Previous
pdfjs-find-next-button =
    .title = Find the next occurrence of the phrase
pdfjs-find-next-button-label = Next
pdfjs-find-highlight-checkbox = Highlight All
pdfjs-find-match-case-checkbox-label = Match Case
pdfjs-find-match-diacritics-checkbox-label = Match Diacritics
pdfjs-find-entire-word-checkbox-label = Whole Words
pdfjs-find-reached-top = Reached top of document, continued from bottom
pdfjs-find-reached-bottom = Reached end of document, continued from top
pdfjs-find-match-count =
    { $total ->
        [one] { $current } of { $total } match
       *[other] { $current } of { $total } matches
    }
pdfjs-find-match-count-limit =
    { $limit ->
        [one] More than { $limit } match
       *[other] More than { $limit } matches
    }
pdfjs-find-not-found = Phrase not found
pdfjs-page-scale-width = Page Width
pdfjs-page-scale-fit = Page Fit
pdfjs-page-scale-auto = Automatic Zoom
pdfjs-page-scale-actual = Actual Size
pdfjs-page-scale-percent = { $scale }%
pdfjs-page-landmark =
    .aria-label = Page { $page }
pdfjs-loading-error = An error occurred while loading the PDF.
pdfjs-invalid-file-error = Invalid or corrupted PDF file.
pdfjs-missing-file-error = Missing PDF file.
pdfjs-unexpected-response-error = Unexpected server response.
pdfjs-rendering-error = An error occurred while rendering the page.
pdfjs-annotation-date-time-string = { DATETIME($dateObj, dateStyle: "short", timeStyle: "medium") }
pdfjs-text-annotation-type =
    .alt = [{ $type } Annotation]
pdfjs-password-label = Enter the password to open this PDF file.
pdfjs-password-invalid = Invalid password. Please try again.
pdfjs-password-ok-button = OK
pdfjs-password-cancel-button = Cancel
pdfjs-web-fonts-disabled = Web fonts are disabled: unable to use embedded PDF fonts.
pdfjs-editor-free-text-button =
    .title = Text
pdfjs-editor-free-text-button-label = Text
pdfjs-editor-ink-button =
    .title = Draw
pdfjs-editor-ink-button-label = Draw
pdfjs-editor-stamp-button =
    .title = Add or edit images
pdfjs-editor-stamp-button-label = Add or edit images
pdfjs-editor-highlight-button =
    .title = Highlight
pdfjs-editor-highlight-button-label = Highlight
pdfjs-highlight-floating-button1 =
    .title = Highlight
    .aria-label = Highlight
pdfjs-highlight-floating-button-label = Highlight
pdfjs-editor-signature-button =
    .title = Add signature
pdfjs-editor-signature-button-label = Add signature
pdfjs-editor-highlight-editor =
    .aria-label = Highlight editor
pdfjs-editor-ink-editor =
    .aria-label = Drawing editor
pdfjs-editor-signature-editor1 =
    .aria-description = Signature editor: { $description }
pdfjs-editor-stamp-editor =
    .aria-label = Image editor
pdfjs-editor-remove-ink-button =
    .title = Remove drawing
pdfjs-editor-remove-freetext-button =
    .title = Remove text
pdfjs-editor-remove-stamp-button =
    .title = Remove image
pdfjs-editor-remove-highlight-button =
    .title = Remove highlight
pdfjs-editor-remove-signature-button =
    .title = Remove signature
pdfjs-editor-free-text-color-input = Color
pdfjs-editor-free-text-size-input = Size
pdfjs-editor-ink-color-input = Color
pdfjs-editor-ink-thickness-input = Thickness
pdfjs-editor-ink-opacity-input = Opacity
pdfjs-editor-stamp-add-image-button =
    .title = Add image
pdfjs-editor-stamp-add-image-button-label = Add image
pdfjs-editor-free-highlight-thickness-input = Thickness
pdfjs-editor-free-highlight-thickness-title =
    .title = Change thickness when highlighting items other than text
pdfjs-editor-add-signature-container =
    .aria-label = Signature controls and saved signatures
pdfjs-editor-signature-add-signature-button =
    .title = Add new signature
pdfjs-editor-signature-add-signature-button-label = Add new signature
pdfjs-editor-add-saved-signature-button =
    .title = Saved signature: { $description }
pdfjs-free-text2 =
    .aria-label = Text Editor
    .default-content = Start typingâ¦
pdfjs-editor-alt-text-button =
    .aria-label = Alt text
pdfjs-editor-alt-text-button-label = Alt text
pdfjs-editor-alt-text-edit-button =
    .aria-label = Edit alt text
pdfjs-editor-alt-text-dialog-label = Choose an option
pdfjs-editor-alt-text-dialog-description = Alt text (alternative text) helps when people canât see the image or when it doesnât load.
pdfjs-editor-alt-text-add-description-label = Add a description
pdfjs-editor-alt-text-add-description-description = Aim for 1-2 sentences that describe the subject, setting, or actions.
pdfjs-editor-alt-text-mark-decorative-label = Mark as decorative
pdfjs-editor-alt-text-mark-decorative-description = This is used for ornamental images, like borders or watermarks.
pdfjs-editor-alt-text-cancel-button = Cancel
pdfjs-editor-alt-text-save-button = Save
pdfjs-editor-alt-text-decorative-tooltip = Marked as decorative
pdfjs-editor-alt-text-textarea =
    .placeholder = For example, âA young man sits down at a table to eat a mealâ
pdfjs-editor-resizer-top-left =
    .aria-label = Top left corner â resize
pdfjs-editor-resizer-top-middle =
    .aria-label = Top middle â resize
pdfjs-editor-resizer-top-right =
    .aria-label = Top right corner â resize
pdfjs-editor-resizer-middle-right =
    .aria-label = Middle right â resize
pdfjs-editor-resizer-bottom-right =
    .aria-label = Bottom right corner â resize
pdfjs-editor-resizer-bottom-middle =
    .aria-label = Bottom middle â resize
pdfjs-editor-resizer-bottom-left =
    .aria-label = Bottom left corner â resize
pdfjs-editor-resizer-middle-left =
    .aria-label = Middle left â resize
pdfjs-editor-highlight-colorpicker-label = Highlight color
pdfjs-editor-colorpicker-button =
    .title = Change color
pdfjs-editor-colorpicker-dropdown =
    .aria-label = Color choices
pdfjs-editor-colorpicker-yellow =
    .title = Yellow
pdfjs-editor-colorpicker-green =
    .title = Green
pdfjs-editor-colorpicker-blue =
    .title = Blue
pdfjs-editor-colorpicker-pink =
    .title = Pink
pdfjs-editor-colorpicker-red =
    .title = Red
pdfjs-editor-highlight-show-all-button-label = Show all
pdfjs-editor-highlight-show-all-button =
    .title = Show all
pdfjs-editor-new-alt-text-dialog-edit-label = Edit alt text (image description)
pdfjs-editor-new-alt-text-dialog-add-label = Add alt text (image description)
pdfjs-editor-new-alt-text-textarea =
    .placeholder = Write your description hereâ¦
pdfjs-editor-new-alt-text-description = Short description for people who canât see the image or when the image doesnât load.
pdfjs-editor-new-alt-text-disclaimer1 = This alt text was created automatically and may be inaccurate.
pdfjs-editor-new-alt-text-disclaimer-learn-more-url = Learn more
pdfjs-editor-new-alt-text-create-automatically-button-label = Create alt text automatically
pdfjs-editor-new-alt-text-not-now-button = Not now
pdfjs-editor-new-alt-text-error-title = Couldnât create alt text automatically
pdfjs-editor-new-alt-text-error-description = Please write your own alt text or try again later.
pdfjs-editor-new-alt-text-error-close-button = Close
pdfjs-editor-new-alt-text-ai-model-downloading-progress = Downloading alt text AI model ({ $downloadedSize } of { $totalSize } MB)
    .aria-valuetext = Downloading alt text AI model ({ $downloadedSize } of { $totalSize } MB)
pdfjs-editor-new-alt-text-added-button =
    .aria-label = Alt text added
pdfjs-editor-new-alt-text-added-button-label = Alt text added
pdfjs-editor-new-alt-text-missing-button =
    .aria-label = Missing alt text
pdfjs-editor-new-alt-text-missing-button-label = Missing alt text
pdfjs-editor-new-alt-text-to-review-button =
    .aria-label = Review alt text
pdfjs-editor-new-alt-text-to-review-button-label = Review alt text
pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer = Created automatically: { $generatedAltText }
pdfjs-image-alt-text-settings-button =
    .title = Image alt text settings
pdfjs-image-alt-text-settings-button-label = Image alt text settings
pdfjs-editor-alt-text-settings-dialog-label = Image alt text settings
pdfjs-editor-alt-text-settings-automatic-title = Automatic alt text
pdfjs-editor-alt-text-settings-create-model-button-label = Create alt text automatically
pdfjs-editor-alt-text-settings-create-model-description = Suggests descriptions to help people who canât see the image or when the image doesnât load.
pdfjs-editor-alt-text-settings-download-model-label = Alt text AI model ({ $totalSize } MB)
pdfjs-editor-alt-text-settings-ai-model-description = Runs locally on your device so your data stays private. Required for automatic alt text.
pdfjs-editor-alt-text-settings-delete-model-button = Delete
pdfjs-editor-alt-text-settings-download-model-button = Download
pdfjs-editor-alt-text-settings-downloading-model-button = Downloadingâ¦
pdfjs-editor-alt-text-settings-editor-title = Alt text editor
pdfjs-editor-alt-text-settings-show-dialog-button-label = Show alt text editor right away when adding an image
pdfjs-editor-alt-text-settings-show-dialog-description = Helps you make sure all your images have alt text.
pdfjs-editor-alt-text-settings-close-button = Close
pdfjs-editor-undo-bar-message-highlight = Highlight removed
pdfjs-editor-undo-bar-message-freetext = Text removed
pdfjs-editor-undo-bar-message-ink = Drawing removed
pdfjs-editor-undo-bar-message-stamp = Image removed
pdfjs-editor-undo-bar-message-signature = Signature removed
pdfjs-editor-undo-bar-message-multiple =
    { $count ->
        [one] { $count } annotation removed
       *[other] { $count } annotations removed
    }
pdfjs-editor-undo-bar-undo-button =
    .title = Undo
pdfjs-editor-undo-bar-undo-button-label = Undo
pdfjs-editor-undo-bar-close-button =
    .title = Close
pdfjs-editor-undo-bar-close-button-label = Close
pdfjs-editor-add-signature-dialog-label = This modal allows the user to create a signature to add to a PDF document. The user can edit the name (which also serves as the alt text), and optionally save the signature for repeated use.
pdfjs-editor-add-signature-dialog-title = Add a signature
pdfjs-editor-add-signature-type-button = Type
    .title = Type
pdfjs-editor-add-signature-draw-button = Draw
    .title = Draw
pdfjs-editor-add-signature-image-button = Image
    .title = Image
pdfjs-editor-add-signature-type-input =
    .aria-label = Type your signature
    .placeholder = Type your signature
pdfjs-editor-add-signature-draw-placeholder = Draw your signature
pdfjs-editor-add-signature-draw-thickness-range-label = Thickness
pdfjs-editor-add-signature-draw-thickness-range =
    .title = Drawing thickness: { $thickness }
pdfjs-editor-add-signature-image-placeholder = Drag a file here to upload
pdfjs-editor-add-signature-image-browse-link =
    { PLATFORM() ->
        [macos] Or choose image files
       *[other] Or browse image files
    }
pdfjs-editor-add-signature-description-label = Description (alt text)
pdfjs-editor-add-signature-description-input =
    .title = Description (alt text)
pdfjs-editor-add-signature-description-default-when-drawing = Signature
pdfjs-editor-add-signature-clear-button-label = Clear signature
pdfjs-editor-add-signature-clear-button =
    .title = Clear signature
pdfjs-editor-add-signature-save-checkbox = Save signature
pdfjs-editor-add-signature-save-warning-message = Youâve reached the limit of 5 saved signatures. Remove one to save more.
pdfjs-editor-add-signature-image-upload-error-title = Couldnât upload image
pdfjs-editor-add-signature-image-upload-error-description = Check your network connection or try another image.
pdfjs-editor-add-signature-error-close-button = Close
pdfjs-editor-add-signature-cancel-button = Cancel
pdfjs-editor-add-signature-add-button = Add
pdfjs-editor-delete-signature-button1 =
    .title = Remove saved signature
pdfjs-editor-delete-signature-button-label1 = Remove saved signature
pdfjs-editor-add-signature-edit-button-label = Edit description
pdfjs-editor-edit-signature-dialog-title = Edit description
pdfjs-editor-edit-signature-update-button = Update`)},j(lf,uo);let u_=lf;class e9{constructor(t){this._ready=new Promise((i,n)=>{import(t).then(l=>{i(l.QuickJSSandbox())}).catch(n)})}async createSandbox(t){(await this._ready).create(t)}async dispatchEventInSandbox(t){const i=await this._ready;setTimeout(()=>i.dispatchEvent(t),0)}async destroySandbox(){(await this._ready).nukeSandbox()}}const FA="pdfjs.signature";var Hv,eu,bp,Vv,b2;class t9{constructor(t,i){j(this,Vv);j(this,Hv);j(this,eu,null);j(this,bp,null);D(this,Hv,t),D(this,bp,i)}async getAll(){if(u(this,bp)&&(window.addEventListener("storage",({key:t})=>{var i;t===FA&&(D(this,eu,null),(i=u(this,Hv))==null||i.dispatch("storedsignatureschanged",{source:this}))},{signal:u(this,bp)}),D(this,bp,null)),!u(this,eu)){D(this,eu,new Map);const t=localStorage.getItem(FA);if(t)for(const[i,n]of Object.entries(JSON.parse(t)))u(this,eu).set(i,n)}return u(this,eu)}async isFull(){return await this.size()===5}async size(){return(await this.getAll()).size}async create(t){if(await this.isFull())return null;const i=Oz();return u(this,eu).set(i,t),R(this,Vv,b2).call(this),i}async delete(t){const i=await this.getAll();return i.has(t)?(i.delete(t),R(this,Vv,b2).call(this),!0):!1}}Hv=new WeakMap,eu=new WeakMap,bp=new WeakMap,Vv=new WeakSet,b2=function(){localStorage.setItem(FA,JSON.stringify(Object.fromEntries(u(this,eu))))};class i9 extends r7{async _writeToStorage(t){localStorage.setItem("pdfjs.preferences",JSON.stringify(t))}async _readFromStorage(t){return{prefs:JSON.parse(localStorage.getItem("pdfjs.preferences"))}}}class s9 extends n7{async createL10n(){var t;return new u_((t=Nt.get("localeProperties"))==null?void 0:t.lang)}createScripting(){return new e9(Nt.get("sandboxBundleSrc"))}createSignatureStorage(t,i){return new t9(t,i)}}var $v,zv,Hn,Wv,qv,lh,Gv,yp,vp,w0,Yc,Ja,Xv,Kv,T0,E0,Ao,S0,x0,Yv,wp,eo,Zv,Ln,Tp,gi,rf,TS,Fb,YF,y2,Ol,ZF,v2,QF,JF,ES,w2,T2,eB;class n9{constructor({descriptionContainer:t,dialog:i,imagePreview:n,cancelButton:o,disclaimer:l,notNowButton:c,saveButton:d,textarea:f,learnMore:m,errorCloseButton:b,createAutomaticallyButton:T,downloadModel:C,downloadModelDescription:P,title:x},L,F){j(this,gi);j(this,$v,R(this,gi,JF).bind(this));j(this,zv);j(this,Hn,null);j(this,Wv);j(this,qv);j(this,lh);j(this,Gv);j(this,yp);j(this,vp);j(this,w0);j(this,Yc,!1);j(this,Ja);j(this,Xv,null);j(this,Kv,null);j(this,T0);j(this,E0);j(this,Ao,!1);j(this,S0,!1);j(this,x0);j(this,Yv);j(this,wp);j(this,eo);j(this,Zv);j(this,Ln);j(this,Tp,null);D(this,Wv,o),D(this,zv,T),D(this,qv,t),D(this,lh,i),D(this,Gv,l),D(this,Yv,c),D(this,T0,n),D(this,eo,f),D(this,x0,m),D(this,Zv,x),D(this,yp,C),D(this,vp,P),D(this,wp,L),D(this,w0,F),i.addEventListener("close",R(this,gi,w2).bind(this)),i.addEventListener("contextmenu",X=>{X.target!==u(this,eo)&&X.preventDefault()}),o.addEventListener("click",u(this,$v)),c.addEventListener("click",u(this,$v)),d.addEventListener("click",R(this,gi,eB).bind(this)),b.addEventListener("click",()=>{R(this,gi,TS).call(this,!1)}),T.addEventListener("click",async()=>{const X=T.getAttribute("aria-pressed")!=="true";u(this,Hn)._reportTelemetry({action:"pdfjs.image.alt_text.ai_generation_check",data:{status:X}}),u(this,Ln)&&(u(this,Ln).setPreference("enableGuessAltText",X),await u(this,Ln).mlManager.toggleService("altText",X)),R(this,gi,Fb).call(this,X,!1)}),f.addEventListener("focus",()=>{D(this,S0,u(this,Ao)),R(this,gi,rf).call(this,!1),R(this,gi,Ol).call(this)}),f.addEventListener("blur",()=>{f.value||R(this,gi,rf).call(this,u(this,S0)),R(this,gi,Ol).call(this)}),f.addEventListener("input",()=>{R(this,gi,Ol).call(this)}),F._on("enableguessalttext",({value:X})=>{R(this,gi,Fb).call(this,X,!1)}),u(this,wp).register(i),u(this,x0).addEventListener("click",()=>{u(this,Hn)._reportTelemetry({action:"pdfjs.image.alt_text.info",data:{topic:"alt_text"}})})}async editAltText(t,i,n){if(u(this,Hn)||!i)return;if(n&&i.hasAltTextData()){i.altTextFinish();return}D(this,Yc,n);let{mlManager:o}=t,l=!!o;R(this,gi,Ol).call(this),o&&!o.isReady("altText")?(l=!1,o.hasProgress?R(this,gi,QF).call(this):o=null):u(this,yp).classList.toggle("hidden",!0);const c=o==null?void 0:o.isEnabledFor("altText");D(this,Hn,i),D(this,Ln,t),u(this,Ln).removeEditListeners(),{altText:Yn(this,Tp)._}=i.altTextData,u(this,eo).value=u(this,Tp)??"";const d=224,f=180;let m,b,T;o?({canvas:m,width:b,height:T,imageData:Yn(this,E0)._}=i.copyCanvas(d,f,!0),l&&R(this,gi,Fb).call(this,await c,!0)):{canvas:m,width:b,height:T}=i.copyCanvas(d,f,!1),m.setAttribute("role","presentation");const{style:C}=m;C.width=`${b}px`,C.height=`${T}px`,u(this,T0).append(m),R(this,gi,YF).call(this),R(this,gi,y2).call(this,l),R(this,gi,TS).call(this,!1);try{await u(this,wp).open(u(this,lh))}catch(P){throw R(this,gi,w2).call(this),P}}destroy(){D(this,Ln,null),R(this,gi,ES).call(this)}}$v=new WeakMap,zv=new WeakMap,Hn=new WeakMap,Wv=new WeakMap,qv=new WeakMap,lh=new WeakMap,Gv=new WeakMap,yp=new WeakMap,vp=new WeakMap,w0=new WeakMap,Yc=new WeakMap,Ja=new WeakMap,Xv=new WeakMap,Kv=new WeakMap,T0=new WeakMap,E0=new WeakMap,Ao=new WeakMap,S0=new WeakMap,x0=new WeakMap,Yv=new WeakMap,wp=new WeakMap,eo=new WeakMap,Zv=new WeakMap,Ln=new WeakMap,Tp=new WeakMap,gi=new WeakSet,rf=function(t){!u(this,Ln)||u(this,Ao)===t||(D(this,Ao,t),u(this,qv).classList.toggle("loading",t))},TS=function(t){u(this,Ln)&&u(this,lh).classList.toggle("error",t)},Fb=async function(t,i=!1){if(u(this,Ln))if(u(this,lh).classList.toggle("aiDisabled",!t),u(this,zv).setAttribute("aria-pressed",t),t){const{altTextLearnMoreUrl:n}=u(this,Ln).mlManager;n&&(u(this,x0).href=n),R(this,gi,ZF).call(this,i)}else R(this,gi,rf).call(this,!1),D(this,Ao,!1),R(this,gi,Ol).call(this)},YF=function(){u(this,Yv).classList.toggle("hidden",!u(this,Yc)),u(this,Wv).classList.toggle("hidden",u(this,Yc))},y2=function(t){!u(this,Ln)||u(this,Xv)===t||(D(this,Xv,t),u(this,lh).classList.toggle("noAi",!t),R(this,gi,Ol).call(this))},Ol=function(){const t=u(this,Ao)||u(this,Ja)&&u(this,Ja)===u(this,eo).value;u(this,Gv).hidden=!t;const i=u(this,Ao)||!!u(this,eo).value;u(this,Kv)!==i&&(D(this,Kv,i),u(this,Zv).setAttribute("data-l10n-id",i?"pdfjs-editor-new-alt-text-dialog-edit-label":"pdfjs-editor-new-alt-text-dialog-add-label"))},ZF=async function(t){if(u(this,Ao)||u(this,eo).value||t&&u(this,Tp)!==null)return;if(D(this,Ja,u(this,Hn).guessedAltText),u(this,Tp)===null&&u(this,Ja)){R(this,gi,v2).call(this,u(this,Ja));return}R(this,gi,rf).call(this,!0),R(this,gi,Ol).call(this);let i=!1;try{const n=await u(this,Hn).mlGuessAltText(u(this,E0),!1);n&&(D(this,Ja,n),D(this,S0,u(this,Ao)),u(this,Ao)&&R(this,gi,v2).call(this,n))}catch(n){console.error(n),i=!0}R(this,gi,rf).call(this,!1),R(this,gi,Ol).call(this),i&&u(this,Ln)&&R(this,gi,TS).call(this,!0)},v2=function(t){!u(this,Ln)||u(this,eo).value||(u(this,eo).value=t,R(this,gi,Ol).call(this))},QF=function(){u(this,yp).classList.toggle("hidden",!1);const t=async({detail:{finished:i,total:n,totalLoaded:o}})=>{o=Math.min(.99*n,o);const c=u(this,vp).ariaValueMax=Math.round(n/1e6),d=u(this,vp).ariaValueNow=Math.round(o/1e6);if(u(this,vp).setAttribute("data-l10n-args",JSON.stringify({totalSize:c,downloadedSize:d})),!i||(u(this,w0)._off("loadaiengineprogress",t),u(this,yp).classList.toggle("hidden",!0),R(this,gi,y2).call(this,!0),!u(this,Ln)))return;const{mlManager:f}=u(this,Ln);f.toggleService("altText",!0),R(this,gi,Fb).call(this,await f.isEnabledFor("altText"),!0)};u(this,w0)._on("loadaiengineprogress",t)},JF=function(){u(this,Hn).altTextData={cancel:!0};const t=u(this,eo).value.trim();u(this,Hn)._reportTelemetry({action:"pdfjs.image.alt_text.dismiss",data:{alt_text_type:t?"present":"empty",flow:u(this,Yc)?"image_add":"alt_text_edit"}}),u(this,Hn)._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!0,alt_text_type:"skipped"}}),R(this,gi,ES).call(this)},ES=function(){u(this,wp).closeIfActive(u(this,lh))},w2=function(){var i,n;const t=u(this,T0).firstChild;t.remove(),t.width=t.height=0,D(this,E0,null),R(this,gi,rf).call(this,!1),(i=u(this,Ln))==null||i.addEditListeners(),u(this,Hn).altTextFinish(),(n=u(this,Ln))==null||n.setSelected(u(this,Hn)),D(this,Hn,null),D(this,Ln,null)},T2=function(t){return new Set(t.toLowerCase().split(/[^\p{L}\p{N}]+/gu).filter(i=>!!i))},eB=function(){const t=u(this,eo).value.trim();if(u(this,Hn).altTextData={altText:t,decorative:!1},u(this,Hn).altTextData.guessedAltText=u(this,Ja),u(this,Ja)&&u(this,Ja)!==t){const i=R(this,gi,T2).call(this,u(this,Ja)),n=R(this,gi,T2).call(this,t);u(this,Hn)._reportTelemetry({action:"pdfjs.image.alt_text.user_edit",data:{total_words:i.size,words_removed:i.difference(n).size,words_added:n.difference(i).size}})}u(this,Hn)._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!0,alt_text_type:t?"present":"empty"}}),u(this,Hn)._reportTelemetry({action:"pdfjs.image.alt_text.save",data:{alt_text_type:t?"present":"empty",flow:u(this,Yc)?"image_add":"alt_text_edit"}}),R(this,gi,ES).call(this)};var Ep,tu,Sp,A0,C0,Zc,xp,Qv,cn,Bb,E2,S2,x2,Qg,tB;class r9{constructor({dialog:t,createModelButton:i,aiModelSettings:n,learnMore:o,closeButton:l,deleteModelButton:c,downloadModelButton:d,showAltTextDialogButton:f},m,b,T){j(this,cn);j(this,Ep);j(this,tu);j(this,Sp);j(this,A0);j(this,C0);j(this,Zc);j(this,xp);j(this,Qv);D(this,A0,t),D(this,Ep,n),D(this,tu,i),D(this,Sp,d),D(this,Qv,f),D(this,xp,m),D(this,C0,b),D(this,Zc,T);const{altTextLearnMoreUrl:C}=T;C&&(o.href=C),t.addEventListener("contextmenu",Dx),i.addEventListener("click",async P=>{const x=R(this,cn,x2).call(this,"enableGuessAltText",P);await T.toggleService("altText",x),R(this,cn,Bb).call(this,{type:"stamp",action:"pdfjs.image.alt_text.settings_ai_generation_check",data:{status:x}})}),f.addEventListener("click",P=>{const x=R(this,cn,x2).call(this,"enableNewAltTextWhenAddingImage",P);R(this,cn,Bb).call(this,{type:"stamp",action:"pdfjs.image.alt_text.settings_edit_alt_text_check",data:{status:x}})}),c.addEventListener("click",R(this,cn,S2).bind(this,!0)),d.addEventListener("click",R(this,cn,E2).bind(this,!0)),l.addEventListener("click",R(this,cn,tB).bind(this)),o.addEventListener("click",()=>{R(this,cn,Bb).call(this,{type:"stamp",action:"pdfjs.image.alt_text.info",data:{topic:"ai_generation"}})}),b._on("enablealttextmodeldownload",({value:P})=>{P?R(this,cn,E2).call(this,!1):R(this,cn,S2).call(this,!1)}),u(this,xp).register(t)}async open({enableGuessAltText:t,enableNewAltTextWhenAddingImage:i}){const{enableAltTextModelDownload:n}=u(this,Zc);u(this,tu).disabled=!n,u(this,tu).setAttribute("aria-pressed",n&&t),u(this,Qv).setAttribute("aria-pressed",i),u(this,Ep).classList.toggle("download",!n),await u(this,xp).open(u(this,A0)),R(this,cn,Bb).call(this,{type:"stamp",action:"pdfjs.image.alt_text.settings_displayed"})}}Ep=new WeakMap,tu=new WeakMap,Sp=new WeakMap,A0=new WeakMap,C0=new WeakMap,Zc=new WeakMap,xp=new WeakMap,Qv=new WeakMap,cn=new WeakSet,Bb=function(t){u(this,C0).dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})},E2=async function(t=!1){if(t){u(this,Sp).disabled=!0;const i=u(this,Sp).firstChild;i.setAttribute("data-l10n-id","pdfjs-editor-alt-text-settings-downloading-model-button"),await u(this,Zc).downloadModel("altText"),i.setAttribute("data-l10n-id","pdfjs-editor-alt-text-settings-download-model-button"),u(this,tu).disabled=!1,R(this,cn,Qg).call(this,"enableGuessAltText",!0),u(this,Zc).toggleService("altText",!0),R(this,cn,Qg).call(this,"enableAltTextModelDownload",!0),u(this,Sp).disabled=!1}u(this,Ep).classList.toggle("download",!1),u(this,tu).setAttribute("aria-pressed",!0)},S2=async function(t=!1){t&&(await u(this,Zc).deleteModel("altText"),R(this,cn,Qg).call(this,"enableGuessAltText",!1),R(this,cn,Qg).call(this,"enableAltTextModelDownload",!1)),u(this,Ep).classList.toggle("download",!0),u(this,tu).disabled=!0,u(this,tu).setAttribute("aria-pressed",!1)},x2=function(t,{target:i}){const n=i.getAttribute("aria-pressed")!=="true";return R(this,cn,Qg).call(this,t,n),i.setAttribute("aria-pressed",n),n},Qg=function(t,i){u(this,C0).dispatch("setpreference",{source:this,name:t,value:i})},tB=function(){u(this,xp).closeIfActive(u(this,A0))};var Ap,nl,Jv,Qc,ew,Cp,kp,uh,Pp,tw,hh,ch,k0,Dp,Ip,dh,iw,P0,fn,iB,A2,SS,C2,k2,sB,nB,P2;class a9{constructor({dialog:t,optionDescription:i,optionDecorative:n,textarea:o,cancelButton:l,saveButton:c},d,f,m){j(this,fn);j(this,Ap,null);j(this,nl,null);j(this,Jv);j(this,Qc);j(this,ew);j(this,Cp,!1);j(this,kp);j(this,uh);j(this,Pp);j(this,tw);j(this,hh);j(this,ch);j(this,k0,null);j(this,Dp,null);j(this,Ip,null);j(this,dh,null);j(this,iw);j(this,P0,null);D(this,Qc,t),D(this,kp,i),D(this,uh,n),D(this,hh,o),D(this,Jv,l),D(this,tw,c),D(this,Pp,f),D(this,ew,m),D(this,iw,d);const b=R(this,fn,k2).bind(this);t.addEventListener("close",R(this,fn,C2).bind(this)),t.addEventListener("contextmenu",T=>{T.target!==u(this,hh)&&T.preventDefault()}),l.addEventListener("click",R(this,fn,SS).bind(this)),c.addEventListener("click",R(this,fn,sB).bind(this)),i.addEventListener("change",b),n.addEventListener("change",b),u(this,Pp).register(t)}async editAltText(t,i){if(u(this,nl)||!i)return;R(this,fn,iB).call(this),D(this,Cp,!1),D(this,Ap,new AbortController);const n={signal:u(this,Ap).signal},o=R(this,fn,nB).bind(this);for(const d of[u(this,kp),u(this,uh),u(this,hh),u(this,tw),u(this,Jv)])d.addEventListener("click",o,n);const{altText:l,decorative:c}=i.altTextData;c===!0?(u(this,uh).checked=!0,u(this,kp).checked=!1):(u(this,uh).checked=!1,u(this,kp).checked=!0),D(this,k0,u(this,hh).value=(l==null?void 0:l.trim())||""),R(this,fn,k2).call(this),D(this,nl,i),D(this,ch,t),u(this,ch).removeEditListeners(),D(this,Dp,new AbortController),u(this,ew)._on("resize",R(this,fn,A2).bind(this),{signal:u(this,Dp).signal});try{await u(this,Pp).open(u(this,Qc)),R(this,fn,A2).call(this)}catch(d){throw R(this,fn,C2).call(this),d}}destroy(){var t;D(this,ch,null),R(this,fn,SS).call(this),(t=u(this,Ip))==null||t.remove(),D(this,Ip,D(this,dh,null))}}Ap=new WeakMap,nl=new WeakMap,Jv=new WeakMap,Qc=new WeakMap,ew=new WeakMap,Cp=new WeakMap,kp=new WeakMap,uh=new WeakMap,Pp=new WeakMap,tw=new WeakMap,hh=new WeakMap,ch=new WeakMap,k0=new WeakMap,Dp=new WeakMap,Ip=new WeakMap,dh=new WeakMap,iw=new WeakMap,P0=new WeakMap,fn=new WeakSet,iB=function(){if(u(this,Ip))return;const t=new ey,i=D(this,Ip,t.createElement("svg"));i.setAttribute("width","0"),i.setAttribute("height","0");const n=t.createElement("defs");i.append(n);const o=t.createElement("mask");n.append(o),o.setAttribute("id","alttext-manager-mask"),o.setAttribute("maskContentUnits","objectBoundingBox");let l=t.createElement("rect");o.append(l),l.setAttribute("fill","white"),l.setAttribute("width","1"),l.setAttribute("height","1"),l.setAttribute("x","0"),l.setAttribute("y","0"),l=D(this,dh,t.createElement("rect")),o.append(l),l.setAttribute("fill","black"),u(this,Qc).append(i)},A2=function(){if(!u(this,nl))return;const t=u(this,Qc),{style:i}=t,{x:n,y:o,width:l,height:c}=u(this,iw).getBoundingClientRect(),{innerWidth:d,innerHeight:f}=window,{width:m,height:b}=t.getBoundingClientRect(),{x:T,y:C,width:P,height:x}=u(this,nl).getClientDimensions(),L=10,F=u(this,ch).direction==="ltr",X=Math.max(T,n),re=Math.min(T+P,n+l),K=Math.max(C,o),te=Math.min(C+x,o+c);u(this,dh).setAttribute("width",`${(re-X)/d}`),u(this,dh).setAttribute("height",`${(te-K)/f}`),u(this,dh).setAttribute("x",`${X/d}`),u(this,dh).setAttribute("y",`${K/f}`);let ee=null,A=Math.max(C,0);A+=Math.min(f-(A+b),0),F?T+P+L+m<d?ee=T+P+L:T>m+L&&(ee=T-m-L):T>m+L?ee=T-m-L:T+P+L+m<d&&(ee=T+P+L),ee===null&&(A=null,ee=Math.max(T,0),ee+=Math.min(d-(ee+m),0),C>b+L?A=C-b-L:C+x+L+b<f&&(A=C+x+L)),A!==null?(t.classList.add("positioned"),F?i.left=`${ee}px`:i.right=`${d-ee-m}px`,i.top=`${A}px`):(t.classList.remove("positioned"),i.left="",i.top="")},SS=function(){u(this,Pp).closeIfActive(u(this,Qc))},C2=function(){var t,i;u(this,nl)._reportTelemetry(u(this,P0)||{action:"alt_text_cancel",alt_text_keyboard:!u(this,Cp)}),D(this,P0,null),R(this,fn,P2).call(this),(t=u(this,ch))==null||t.addEditListeners(),(i=u(this,Dp))==null||i.abort(),D(this,Dp,null),u(this,nl).altTextFinish(),D(this,nl,null),D(this,ch,null)},k2=function(){u(this,hh).disabled=u(this,uh).checked},sB=function(){const t=u(this,hh).value.trim(),i=u(this,uh).checked;u(this,nl).altTextData={altText:t,decorative:i},D(this,P0,{action:"alt_text_save",alt_text_description:!!t,alt_text_edit:!!u(this,k0)&&u(this,k0)!==t,alt_text_decorative:i,alt_text_keyboard:!u(this,Cp)}),R(this,fn,SS).call(this)},nB=function(t){t.detail!==0&&(D(this,Cp,!0),R(this,fn,P2).call(this))},P2=function(){var t;(t=u(this,Ap))==null||t.abort(),D(this,Ap,null)};var _x,rB;class o9{constructor(t,i){j(this,_x);this.eventBus=i,R(this,_x,rB).call(this,t)}}_x=new WeakSet,rB=function({editorFreeTextFontSize:t,editorFreeTextColor:i,editorInkColor:n,editorInkThickness:o,editorInkOpacity:l,editorStampAddImage:c,editorFreeHighlightThickness:d,editorHighlightShowAll:f,editorSignatureAddSignature:m}){const{eventBus:b}=this,T=(C,P)=>{b.dispatch("switchannotationeditorparams",{source:this,type:zo[C],value:P})};t.addEventListener("input",function(){T("FREETEXT_SIZE",this.valueAsNumber)}),i.addEventListener("input",function(){T("FREETEXT_COLOR",this.value)}),n.addEventListener("input",function(){T("INK_COLOR",this.value)}),o.addEventListener("input",function(){T("INK_THICKNESS",this.valueAsNumber)}),l.addEventListener("input",function(){T("INK_OPACITY",this.valueAsNumber)}),c.addEventListener("click",()=>{b.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{action:"pdfjs.image.add_image_click"}}}),T("CREATE")}),d.addEventListener("input",function(){T("HIGHLIGHT_THICKNESS",this.valueAsNumber)}),f.addEventListener("click",function(){const C=this.getAttribute("aria-pressed")==="true";this.setAttribute("aria-pressed",!C),T("HIGHLIGHT_SHOW_ALL",!C)}),m.addEventListener("click",()=>{T("CREATE")}),b._on("annotationeditorparamschanged",C=>{for(const[P,x]of C.details)switch(P){case zo.FREETEXT_SIZE:t.value=x;break;case zo.FREETEXT_COLOR:i.value=x;break;case zo.INK_COLOR:n.value=x;break;case zo.INK_THICKNESS:o.value=x;break;case zo.INK_OPACITY:l.value=x;break;case zo.HIGHLIGHT_DEFAULT_COLOR:b.dispatch("mainhighlightcolorpickerupdatecolor",{source:this,value:x});break;case zo.HIGHLIGHT_THICKNESS:d.value=x;break;case zo.HIGHLIGHT_FREE:d.disabled=!x;break;case zo.HIGHLIGHT_SHOW_ALL:f.setAttribute("aria-pressed",x);break}})};const VE=.1;var sw,D0,nw,bn,I2,L2,aB,N2,rw,R2,M2,Ub,oB;const sy=class sy{constructor(t,i,n,o){j(this,bn);j(this,sw);j(this,D0,0);j(this,nw);if(D(this,sw,i),D(this,nw,n),!o)return;D(this,D0,o.getBoundingClientRect().height);const l=new ResizeObserver(c=>{for(const d of c)if(d.target===o){D(this,D0,Math.floor(d.borderBoxSize[0].blockSize));break}});l.observe(o),t.addEventListener("abort",()=>l.disconnect(),{once:!0})}moveCaret(t,i){const n=document.getSelection();if(n.rangeCount===0)return;const{focusNode:o}=n,l=o.nodeType!==Node.ELEMENT_NODE?o.parentElement:o,c=l.closest(".textLayer");if(!c)return;const d=document.createTreeWalker(c,NodeFilter.SHOW_TEXT);d.currentNode=o;const f=l.getBoundingClientRect();let m=null;const b=(t?d.previousSibling:d.nextSibling).bind(d);for(;b();){const x=d.currentNode.parentElement;if(!R(this,bn,I2).call(this,f,x.getBoundingClientRect())){m=x;break}}if(!m){const x=R(this,bn,oB).call(this,c,t);if(!x)return;if(i){const X=(t?d.firstChild():d.lastChild())||o;n.extend(X,t?0:X.length);const re=document.createRange();re.setStart(x,t?x.length:0),re.setEnd(x,t?x.length:0),n.addRange(re);return}const[L]=R(this,bn,N2).call(this,n,t),{parentElement:F}=x;R(this,bn,Ub).call(this,i,n,F,F.getBoundingClientRect(),L);return}const[T,C]=R(this,bn,N2).call(this,n,t),P=m.getBoundingClientRect();if(R(this,bn,L2).call(this,P,T,C,t)){R(this,bn,Ub).call(this,i,n,m,P,T);return}for(;b();){const x=d.currentNode.parentElement,L=x.getBoundingClientRect();if(!R(this,bn,I2).call(this,P,L))break;if(R(this,bn,L2).call(this,L,T,C,t)){R(this,bn,Ub).call(this,i,n,x,L,T);return}}R(this,bn,Ub).call(this,i,n,m,P,T)}};sw=new WeakMap,D0=new WeakMap,nw=new WeakMap,bn=new WeakSet,I2=function(t,i){const n=t.y,o=t.bottom,l=t.y+t.height/2,c=i.y,d=i.bottom,f=i.y+i.height/2;return n<=f&&f<=o||c<=l&&l<=d},L2=function(t,i,n,o){const l=t.y+t.height/2;return(o?n>=l:n<=l)&&t.x-VE<=i&&i<=t.right+VE},aB=function(t){return t.top>=u(this,D0)&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)},N2=function(t,i){const{focusNode:n,focusOffset:o}=t,l=document.createRange();l.setStart(n,o),l.setEnd(n,o);const c=l.getBoundingClientRect();return[c.x,i?c.top:c.bottom]},rw=new WeakSet,R2=function(t,i){if(!document.caretPositionFromPoint){const{startContainer:n,startOffset:o}=document.caretRangeFromPoint(t,i);return{offsetNode:n,offset:o}}return document.caretPositionFromPoint(t,i)},M2=function(t,i,n,o,l){var m,b,T,C;if(l||(l=o.getBoundingClientRect()),i<=l.x+VE){n?t.extend(o.firstChild,0):t.setPosition(o.firstChild,0);return}if(l.right-VE<=i){const{lastChild:P}=o;n?t.extend(P,P.length):t.setPosition(P,P.length);return}const c=l.y+l.height/2;let d=R(m=sy,rw,R2).call(m,i,c),f=(b=d.offsetNode)==null?void 0:b.parentElement;if(f&&f!==o){const P=document.elementsFromPoint(i,c),x=[];for(const L of P){if(L===o)break;const{style:F}=L;x.push([L,F.visibility]),F.visibility="hidden"}d=R(T=sy,rw,R2).call(T,i,c),f=(C=d.offsetNode)==null?void 0:C.parentElement;for(const[L,F]of x)L.style.visibility=F}if(f!==o){n?t.extend(o.firstChild,0):t.setPosition(o.firstChild,0);return}n?t.extend(d.offsetNode,d.offset):t.setPosition(d.offsetNode,d.offset)},Ub=function(t,i,n,o,l){if(R(this,bn,aB).call(this,o)){R(this,bn,M2).call(this,i,l,t,n,o);return}u(this,sw).addEventListener("scrollend",R(this,bn,M2).bind(this,i,l,t,n,null),{once:!0}),n.scrollIntoView()},oB=function(t,i){for(;;){const n=t.closest(".page"),o=parseInt(n.getAttribute("data-page-number")),l=i?o-1:o+1;if(t=u(this,nw).querySelector(`.page[data-page-number="${l}"] .textLayer`),!t)return null;const c=document.createTreeWalker(t,NodeFilter.SHOW_TEXT),d=i?c.lastChild():c.firstChild();if(d)return d}},j(sy,rw);let D2=sy;function RR(g,t){const i=document.createElement("a");if(!i.click)throw new Error('DownloadManager: "a.click()" is not supported.');i.href=g,i.target="_parent","download"in i&&(i.download=t),(document.body||document.documentElement).append(i),i.click(),i.remove()}var I0;class l9{constructor(){j(this,I0,new WeakMap)}downloadData(t,i,n){const o=URL.createObjectURL(new Blob([t],{type:n}));RR(o,i)}openOrDownloadData(t,i,n=null){const o=jz(i),l=o?"application/pdf":"";if(o){let c=u(this,I0).get(t);c||(c=URL.createObjectURL(new Blob([t],{type:l})),u(this,I0).set(t,c));let d;d="?file="+encodeURIComponent(c+"#"+i),n&&(d+=`#${escape(n)}`);try{return window.open(d),!0}catch(f){console.error("openOrDownloadData:",f),URL.revokeObjectURL(c),u(this,I0).delete(t)}}return this.downloadData(t,i,l),!1}download(t,i,n){let o;if(t)o=URL.createObjectURL(new Blob([t],{type:"application/pdf"}));else{if(!AF(i,"http://example.com")){console.error(`download - not a valid URL: ${i}`);return}o=i+"#pdfjs.action=download"}RR(o,n)}}I0=new WeakMap;var aw,Jc,L0,ed,td,Lp,Np,ow,lw;const ny=class ny{constructor({container:t,message:i,undoButton:n,closeButton:o},l){j(this,aw,null);j(this,Jc);j(this,L0,null);j(this,ed,null);j(this,td,null);St(this,"isOpen",!1);j(this,Lp);j(this,Np,null);j(this,ow);D(this,Jc,t),D(this,Lp,i),D(this,ow,n),D(this,aw,o),D(this,L0,l)}destroy(){var t;(t=u(this,td))==null||t.abort(),D(this,td,null),this.hide()}show(t,i){if(!u(this,td)){D(this,td,new AbortController);const n={signal:u(this,td).signal},o=this.hide.bind(this);u(this,Jc).addEventListener("contextmenu",Dx,n),u(this,aw).addEventListener("click",o,n),u(this,L0)._on("beforeprint",o,n),u(this,L0)._on("download",o,n)}this.hide(),typeof i=="string"?u(this,Lp).setAttribute("data-l10n-id",u(ny,lw)[i]):(u(this,Lp).setAttribute("data-l10n-id",u(ny,lw)._multiple),u(this,Lp).setAttribute("data-l10n-args",JSON.stringify({count:i}))),this.isOpen=!0,u(this,Jc).hidden=!1,D(this,Np,new AbortController),u(this,ow).addEventListener("click",()=>{t(),this.hide()},{signal:u(this,Np).signal}),D(this,ed,setTimeout(()=>{u(this,Jc).focus(),D(this,ed,null)},100))}hide(){var t;this.isOpen&&(this.isOpen=!1,u(this,Jc).hidden=!0,(t=u(this,Np))==null||t.abort(),D(this,Np,null),u(this,ed)&&(clearTimeout(u(this,ed)),D(this,ed,null)))}};aw=new WeakMap,Jc=new WeakMap,L0=new WeakMap,ed=new WeakMap,td=new WeakMap,Lp=new WeakMap,Np=new WeakMap,ow=new WeakMap,lw=new WeakMap,j(ny,lw,Object.freeze({highlight:"pdfjs-editor-undo-bar-message-highlight",freetext:"pdfjs-editor-undo-bar-message-freetext",stamp:"pdfjs-editor-undo-bar-message-stamp",ink:"pdfjs-editor-undo-bar-message-ink",signature:"pdfjs-editor-undo-bar-message-signature",_multiple:"pdfjs-editor-undo-bar-message-multiple"}));let O2=ny;var id,Sa;class u9{constructor(){j(this,id,new WeakMap);j(this,Sa,null)}get active(){return u(this,Sa)}async register(t,i=!1){if(typeof t!="object")throw new Error("Not enough parameters.");if(u(this,id).has(t))throw new Error("The overlay is already registered.");u(this,id).set(t,{canForceClose:i}),t.addEventListener("cancel",({target:n})=>{u(this,Sa)===n&&D(this,Sa,null)})}async open(t){if(u(this,id).has(t)){if(u(this,Sa)){if(u(this,Sa)===t)throw new Error("The overlay is already active.");if(u(this,id).get(t).canForceClose)await this.close();else throw new Error("Another overlay is currently active.")}}else throw new Error("The overlay does not exist.");D(this,Sa,t),t.showModal()}async close(t=u(this,Sa)){if(u(this,id).has(t))if(u(this,Sa)){if(u(this,Sa)!==t)throw new Error("Another overlay is currently active.")}else throw new Error("The overlay is currently not active.");else throw new Error("The overlay does not exist.");t.close(),D(this,Sa,null)}async closeIfActive(t){u(this,Sa)===t&&await this.close(t)}}id=new WeakMap,Sa=new WeakMap;var fh,Rp,uw,gu,F2,lB,B2;class h9{constructor(t,i,n=!1){j(this,gu);j(this,fh,null);j(this,Rp,null);j(this,uw,null);this.dialog=t.dialog,this.label=t.label,this.input=t.input,this.submitButton=t.submitButton,this.cancelButton=t.cancelButton,this.overlayManager=i,this._isViewerEmbedded=n,this.submitButton.addEventListener("click",R(this,gu,F2).bind(this)),this.cancelButton.addEventListener("click",this.close.bind(this)),this.input.addEventListener("keydown",o=>{o.keyCode===13&&R(this,gu,F2).call(this)}),this.overlayManager.register(this.dialog,!0),this.dialog.addEventListener("close",R(this,gu,lB).bind(this))}async open(){var i;await((i=u(this,fh))==null?void 0:i.promise),D(this,fh,Promise.withResolvers());try{await this.overlayManager.open(this.dialog)}catch(n){throw u(this,fh).resolve(),n}const t=u(this,uw)===$z.INCORRECT_PASSWORD;(!this._isViewerEmbedded||t)&&this.input.focus(),this.label.setAttribute("data-l10n-id",t?"pdfjs-password-invalid":"pdfjs-password-label")}async close(){this.overlayManager.closeIfActive(this.dialog)}async setUpdateCallback(t,i){u(this,fh)&&await u(this,fh).promise,D(this,Rp,t),D(this,uw,i)}}fh=new WeakMap,Rp=new WeakMap,uw=new WeakMap,gu=new WeakSet,F2=function(){const t=this.input.value;(t==null?void 0:t.length)>0&&R(this,gu,B2).call(this,t)},lB=function(){R(this,gu,B2).call(this,new Error("PasswordPrompt cancelled.")),u(this,fh).resolve()},B2=function(t){u(this,Rp)&&(this.close(),this.input.value="",u(this,Rp).call(this,t),D(this,Rp,null))};const c9=-100,MR="selected";class uP{constructor(t){this.container=t.container,this.eventBus=t.eventBus,this._l10n=t.l10n,this.reset()}reset(){this._pdfDocument=null,this._lastToggleIsShow=!0,this._currentTreeItem=null,this.container.textContent="",this.container.classList.remove("treeWithDeepNesting")}_dispatchEvent(t){throw new Error("Not implemented: _dispatchEvent")}_bindLink(t,i){throw new Error("Not implemented: _bindLink")}_normalizeTextContent(t){return am(t,!0)||"â"}_addToggleButton(t,i=!1){const n=document.createElement("div");n.className="treeItemToggler",i&&n.classList.add("treeItemsHidden"),n.onclick=o=>{if(o.stopPropagation(),n.classList.toggle("treeItemsHidden"),o.shiftKey){const l=!n.classList.contains("treeItemsHidden");this._toggleTreeItem(t,l)}},t.prepend(n)}_toggleTreeItem(t,i=!1){this._l10n.pause(),this._lastToggleIsShow=i;for(const n of t.querySelectorAll(".treeItemToggler"))n.classList.toggle("treeItemsHidden",!i);this._l10n.resume()}_toggleAllTreeItems(){this._toggleTreeItem(this.container,!this._lastToggleIsShow)}_finishRendering(t,i,n=!1){n&&(this.container.classList.add("treeWithDeepNesting"),this._lastToggleIsShow=!t.querySelector(".treeItemsHidden")),this._l10n.pause(),this.container.append(t),this._l10n.resume(),this._dispatchEvent(i)}render(t){throw new Error("Not implemented: render")}_updateCurrentTreeItem(t=null){this._currentTreeItem&&(this._currentTreeItem.classList.remove(MR),this._currentTreeItem=null),t&&(t.classList.add(MR),this._currentTreeItem=t)}_scrollToCurrentTreeItem(t){if(!t)return;this._l10n.pause();let i=t.parentNode;for(;i&&i!==this.container;){if(i.classList.contains("treeItem")){const n=i.firstElementChild;n==null||n.classList.remove("treeItemsHidden")}i=i.parentNode}this._l10n.resume(),this._updateCurrentTreeItem(t),this.container.scrollTo(t.offsetLeft,t.offsetTop+c9)}}var bx,uB;class d9 extends uP{constructor(i){super(i);j(this,bx);this.downloadManager=i.downloadManager,this.eventBus._on("fileattachmentannotation",R(this,bx,uB).bind(this))}reset(i=!1){super.reset(),this._attachments=null,i||(this._renderedCapability=Promise.withResolvers()),this._pendingDispatchEvent=!1}async _dispatchEvent(i){this._renderedCapability.resolve(),!(i===0&&!this._pendingDispatchEvent&&(this._pendingDispatchEvent=!0,await UF({target:this.eventBus,name:"annotationlayerrendered",delay:1e3}),!this._pendingDispatchEvent))&&(this._pendingDispatchEvent=!1,this.eventBus.dispatch("attachmentsloaded",{source:this,attachmentsCount:i}))}_bindLink(i,{content:n,description:o,filename:l}){o&&(i.title=o),i.onclick=()=>(this.downloadManager.openOrDownloadData(n,l),!1)}render({attachments:i,keepRenderedCapability:n=!1}){if(this._attachments&&this.reset(n),this._attachments=i||null,!i){this._dispatchEvent(0);return}const o=document.createDocumentFragment();let l=0;for(const c in i){const d=i[c],f=document.createElement("div");f.className="treeItem";const m=document.createElement("a");this._bindLink(m,d),m.textContent=this._normalizeTextContent(d.filename),f.append(m),o.append(f),l++}this._finishRendering(o,l)}}bx=new WeakSet,uB=function(i){const n=this._renderedCapability.promise;n.then(()=>{if(n!==this._renderedCapability.promise)return;const o=this._attachments||Object.create(null);for(const l in o)if(i.filename===l)return;o[i.filename]=i,this.render({attachments:o,keepRenderedCapability:!0})})};const OR="grab-to-pan-grab";var iu,Mp,ph,fu,hB,cB,xS;class f9{constructor({element:t}){j(this,fu);j(this,iu,null);j(this,Mp,null);j(this,ph,null);this.element=t,this.document=t.ownerDocument;const i=this.overlay=document.createElement("div");i.className="grab-to-pan-grabbing"}activate(){u(this,iu)||(D(this,iu,new AbortController),this.element.addEventListener("mousedown",R(this,fu,hB).bind(this),{capture:!0,signal:u(this,iu).signal}),this.element.classList.add(OR))}deactivate(){u(this,iu)&&(u(this,iu).abort(),D(this,iu,null),R(this,fu,xS).call(this),this.element.classList.remove(OR))}toggle(){u(this,iu)?this.deactivate():this.activate()}ignoreTarget(t){return t.matches("a[href], a[href] *, input, textarea, button, button *, select, option")}}iu=new WeakMap,Mp=new WeakMap,ph=new WeakMap,fu=new WeakSet,hB=function(t){if(t.button!==0||this.ignoreTarget(t.target))return;if(t.originalTarget)try{t.originalTarget.tagName}catch{return}this.scrollLeftStart=this.element.scrollLeft,this.scrollTopStart=this.element.scrollTop,this.clientXStart=t.clientX,this.clientYStart=t.clientY,D(this,Mp,new AbortController);const i=R(this,fu,xS).bind(this),n={capture:!0,signal:u(this,Mp).signal};this.document.addEventListener("mousemove",R(this,fu,cB).bind(this),n),this.document.addEventListener("mouseup",i,n),D(this,ph,new AbortController),this.element.addEventListener("scroll",i,{capture:!0,signal:u(this,ph).signal}),du(t);const o=document.activeElement;o&&!o.contains(t.target)&&o.blur()},cB=function(t){var o;if((o=u(this,ph))==null||o.abort(),D(this,ph,null),!(t.buttons&1)){R(this,fu,xS).call(this);return}const i=t.clientX-this.clientXStart,n=t.clientY-this.clientYStart;this.element.scrollTo({top:this.scrollTopStart-n,left:this.scrollLeftStart-i,behavior:"instant"}),this.overlay.parentNode||document.body.append(this.overlay)},xS=function(){var t,i;(t=u(this,Mp))==null||t.abort(),D(this,Mp,null),(i=u(this,ph))==null||i.abort(),D(this,ph,null),this.overlay.remove()};var sd,su,Cd,AS,dB;class p9{constructor({container:t,eventBus:i,cursorToolOnLoad:n=Da.SELECT}){j(this,Cd);j(this,sd,Da.SELECT);j(this,su,null);this.container=t,this.eventBus=i,R(this,Cd,dB).call(this),Promise.resolve().then(()=>{this.switchTool(n)})}get activeTool(){return u(this,sd)}switchTool(t){u(this,su)===null&&R(this,Cd,AS).call(this,t)}get _handTool(){return Pa(this,"_handTool",new f9({element:this.container}))}}sd=new WeakMap,su=new WeakMap,Cd=new WeakSet,AS=function(t,i=!1){if(t===u(this,sd)){u(this,su)!==null&&this.eventBus.dispatch("cursortoolchanged",{source:this,tool:t,disabled:i});return}const n=()=>{switch(u(this,sd)){case Da.SELECT:break;case Da.HAND:this._handTool.deactivate();break}};switch(t){case Da.SELECT:n();break;case Da.HAND:n(),this._handTool.activate();break;case Da.ZOOM:default:console.error(`switchTool: "${t}" is an unsupported value.`);return}D(this,sd,t),this.eventBus.dispatch("cursortoolchanged",{source:this,tool:t,disabled:i})},dB=function(){this.eventBus._on("switchcursortool",l=>{l.reset?u(this,su)!==null&&(t=Qi.NONE,i=tr.NORMAL,o()):this.switchTool(l.tool)});let t=Qi.NONE,i=tr.NORMAL;const n=()=>{u(this,su)??D(this,su,u(this,sd)),R(this,Cd,AS).call(this,Da.SELECT,!0)},o=()=>{u(this,su)!==null&&t===Qi.NONE&&i===tr.NORMAL&&(R(this,Cd,AS).call(this,u(this,su)),D(this,su,null))};this.eventBus._on("annotationeditormodechanged",({mode:l})=>{t=l,l===Qi.NONE?o():n()}),this.eventBus._on("presentationmodechanged",({state:l})=>{i=l,l===tr.NORMAL?o():l===tr.FULLSCREEN&&n()})};const g9=["en-us","en-lr","my"],m9={"8.5x11":"pdfjs-document-properties-page-size-name-letter","8.5x14":"pdfjs-document-properties-page-size-name-legal"},FR={"297x420":"pdfjs-document-properties-page-size-name-a-three","210x297":"pdfjs-document-properties-page-size-name-a-four"};function BA(g,t,i){const n=t?g.width:g.height,o=t?g.height:g.width;return i[`${n}x${o}`]}var Co,$n,U2,jb,j2,fB,H2,pB;class _9{constructor({dialog:t,fields:i,closeButton:n},o,l,c,d,f){j(this,$n);j(this,Co,null);this.dialog=t,this.fields=i,this.overlayManager=o,this.l10n=c,this._fileNameLookup=d,this._titleLookup=f,R(this,$n,U2).call(this),n.addEventListener("click",this.close.bind(this)),this.overlayManager.register(this.dialog),l._on("pagechanging",m=>{this._currentPageNumber=m.pageNumber}),l._on("rotationchanging",m=>{this._pagesRotation=m.pagesRotation})}async open(){var F,X;await Promise.all([this.overlayManager.open(this.dialog),this._dataAvailableCapability.promise]);const t=this._currentPageNumber,i=this._pagesRotation;if(u(this,Co)&&t===u(this,Co)._currentPageNumber&&i===u(this,Co)._pagesRotation){R(this,$n,jb).call(this);return}const[{info:n,metadata:o,contentLength:l},c]=await Promise.all([this.pdfDocument.getMetadata(),this.pdfDocument.getPage(t)]),[d,f,m,b,T,C,P]=await Promise.all([this._fileNameLookup(),R(this,$n,j2).call(this,l),this._titleLookup(),R(this,$n,H2).call(this,o==null?void 0:o.get("xmp:createdate"),n.CreationDate),R(this,$n,H2).call(this,o==null?void 0:o.get("xmp:modifydate"),n.ModDate),R(this,$n,fB).call(this,Zz(c),i),R(this,$n,pB).call(this,n.IsLinearized)]);D(this,Co,Object.freeze({fileName:d,fileSize:f,title:m,author:((F=o==null?void 0:o.get("dc:creator"))==null?void 0:F.join(`
`))||n.Author,subject:((X=o==null?void 0:o.get("dc:subject"))==null?void 0:X.join(`
`))||n.Subject,keywords:(o==null?void 0:o.get("pdf:keywords"))||n.Keywords,creationDate:b,modificationDate:T,creator:(o==null?void 0:o.get("xmp:creatortool"))||n.Creator,producer:(o==null?void 0:o.get("pdf:producer"))||n.Producer,version:n.PDFFormatVersion,pageCount:this.pdfDocument.numPages,pageSize:C,linearized:P,_currentPageNumber:t,_pagesRotation:i})),R(this,$n,jb).call(this);const{length:x}=await this.pdfDocument.getDownloadInfo();if(l===x)return;const L=Object.assign(Object.create(null),u(this,Co));L.fileSize=await R(this,$n,j2).call(this,x),D(this,Co,Object.freeze(L)),R(this,$n,jb).call(this)}async close(){this.overlayManager.close(this.dialog)}setDocument(t){this.pdfDocument&&(R(this,$n,U2).call(this),R(this,$n,jb).call(this)),t&&(this.pdfDocument=t,this._dataAvailableCapability.resolve())}}Co=new WeakMap,$n=new WeakSet,U2=function(){this.pdfDocument=null,D(this,Co,null),this._dataAvailableCapability=Promise.withResolvers(),this._currentPageNumber=1,this._pagesRotation=0},jb=function(){var t;if(!(u(this,Co)&&this.overlayManager.active!==this.dialog))for(const i in this.fields){const n=(t=u(this,Co))==null?void 0:t[i];this.fields[i].textContent=n||n===0?n:"-"}},j2=async function(t=0){const i=t/1024,n=i/1024;return i?this.l10n.get(n>=1?"pdfjs-document-properties-size-mb":"pdfjs-document-properties-size-kb",{mb:n,kb:i,b:t}):void 0},fB=async function(t,i){if(!t)return;i%180!==0&&(t={width:t.height,height:t.width});const n=h2(t),o=g9.includes(this.l10n.getLanguage());let l={width:Math.round(t.width*100)/100,height:Math.round(t.height*100)/100},c={width:Math.round(t.width*25.4*10)/10,height:Math.round(t.height*25.4*10)/10},d=BA(l,n,m9)||BA(c,n,FR);if(!d&&!(Number.isInteger(c.width)&&Number.isInteger(c.height))){const P={width:t.width*25.4,height:t.height*25.4},x={width:Math.round(c.width),height:Math.round(c.height)};Math.abs(P.width-x.width)<.1&&Math.abs(P.height-x.height)<.1&&(d=BA(x,n,FR),d&&(l={width:Math.round(x.width/25.4*100)/100,height:Math.round(x.height/25.4*100)/100},c=x))}const[{width:f,height:m},b,T,C]=await Promise.all([o?l:c,this.l10n.get(o?"pdfjs-document-properties-page-size-unit-inches":"pdfjs-document-properties-page-size-unit-millimeters"),d&&this.l10n.get(d),this.l10n.get(n?"pdfjs-document-properties-page-size-orientation-portrait":"pdfjs-document-properties-page-size-orientation-landscape")]);return this.l10n.get(T?"pdfjs-document-properties-page-size-dimension-name-string":"pdfjs-document-properties-page-size-dimension-string",{width:f,height:m,unit:b,name:T,orientation:C})},H2=async function(t,i){const n=Date.parse(t)||zz.toDateObject(i);return n?this.l10n.get("pdfjs-document-properties-date-time-string",{dateObj:n.valueOf()}):void 0},pB=function(t){return this.l10n.get(t?"pdfjs-document-properties-linearized-yes":"pdfjs-document-properties-linearized-no")};const $o={SPACE:0,ALPHA_LETTER:1,PUNCT:2,HAN_LETTER:3,KATAKANA_LETTER:4,HIRAGANA_LETTER:5,HALFWIDTH_KATAKANA_LETTER:6,THAI_LETTER:7};function b9(g){return g<11904}function y9(g){return(g&65408)===0}function v9(g){return g>=97&&g<=122||g>=65&&g<=90}function w9(g){return g>=48&&g<=57}function T9(g){return g===32||g===9||g===13||g===10}function E9(g){return g>=13312&&g<=40959||g>=63744&&g<=64255}function S9(g){return g>=12448&&g<=12543}function x9(g){return g>=12352&&g<=12447}function A9(g){return g>=65376&&g<=65439}function C9(g){return(g&65408)===3584}function $E(g){return b9(g)?y9(g)?T9(g)?$o.SPACE:v9(g)||w9(g)||g===95?$o.ALPHA_LETTER:$o.PUNCT:C9(g)?$o.THAI_LETTER:g===160?$o.SPACE:$o.ALPHA_LETTER:E9(g)?$o.HAN_LETTER:S9(g)?$o.KATAKANA_LETTER:x9(g)?$o.HIRAGANA_LETTER:A9(g)?$o.HALFWIDTH_KATAKANA_LETTER:$o.ALPHA_LETTER}let BR;function k9(){return BR||(BR="Â Â¨ÂªÂ¯Â²-ÂµÂ¸-ÂºÂ¼-Â¾Ä²-Ä³Ä¿-ÅÅÅ¿Ç-ÇÇ±-Ç³Ê°-Ê¸Ë-ËË -Ë¤Í´ÍºÍ¾Î-ÎÎÏ-ÏÏ°-Ï²Ï´-ÏµÏ¹ÖÙµ-Ù¸à¥-à¥à§-à§à§à¨³à¨¶à©-à©à©à­-à­à¸³àº³à»-à»à¼à½à½à½à½à½à½©á¼á´¬-á´®á´°-á´ºá´¼-áµáµ-áµªáµ¸á¶-á¶¿áº-áºá½±á½³á½µá½·á½¹á½»á½½á¾»á¾½-á¿á¿á¿á¿-á¿á¿á¿á¿-á¿á¿£á¿«á¿­-á¿¯á¿¹á¿»á¿½-á¿¾â-ââââ¤-â¦â¯â³-â´â¶-â·â¼â¾â-ââââ°-â±â´-ââ-ââ¨â-ââ-ââ-ââ-ââ-ââ -â¢â¤â¦â¨âª-â­â¯-â±â³-â¹â»-ââ-ââ-â¿ââ¬-â­â¯-â°â©-âªâ -âªâ¨â©´-â©¶â«â±¼-â±½âµ¯âºâ»³â¼-â¿ãã¶ã¸-ãºã-ããã¿ã±-ãã-ãã-ãã -ãã-ã¾ã-ã¿ê-êê°ê²-ê´ê¸-ê¹ê­-ê­ê­©ï¤-ï¨ï¨ï¨ï¨-ï¨ï¨ ï¨¢ï¨¥-ï¨¦ï¨ª-ï©­ï©°-ï«ï¬-ï¬ï¬-ï¬ï¬ï¬-ï¬¶ï¬¸-ï¬¼ï¬¾ï­-ï­ï­-ï­ï­-ï®±ï¯-ï´½ïµ-ï¶ï¶-ï·ï·°-ï·¼ï¸-ï¸ï¸°-ï¹ï¹-ï¹ï¹-ï¹¦ï¹¨-ï¹«ï¹°-ï¹²ï¹´ï¹¶-ï»¼ï¼-ï¾¾ï¿-ï¿ï¿-ï¿ï¿-ï¿ï¿-ï¿ï¿ -ï¿¦"),BR}const Lo={FOUND:0,NOT_FOUND:1,WRAPPED:2,PENDING:3},P9=250,D9=-50,I9=-400,UR={"â":"-","â":"'","â":"'","â":"'","â":"'","â":'"',"â":'"',"â":'"',"â":'"',"Â¼":"1/4","Â½":"1/2","Â¾":"3/4"},jR=new Set([12441,12442,2381,2509,2637,2765,2893,3021,3149,3277,3387,3388,3405,3530,3642,3770,3972,4153,4154,5908,5940,6098,6752,6980,7082,7083,7154,7155,11647,43014,43052,43204,43347,43456,43766,44013,3158,3953,3954,3962,3963,3964,3965,3968,3956]);let HR;const L9=new RegExp("\\p{M}+","gu"),N9=new RegExp("([.*+?^${}()|[\\]\\\\])|(\\p{P})|(\\s+)|(\\p{M})|(\\p{L})","gu"),R9=new RegExp("([^\\p{M}])\\p{M}*$","u"),M9=new RegExp("^\\p{M}*([^\\p{M}])","u"),O9=/[\uAC00-\uD7AF\uFA6C\uFACF-\uFAD1\uFAD5-\uFAD7]+/g,VR=new Map,F9="[\\u1100-\\u1112\\ud7a4-\\ud7af\\ud84a\\ud84c\\ud850\\ud854\\ud857\\ud85f]",$R=new Map;let UA=null,jA=null;function CS(g){const t=[];let i;for(;(i=O9.exec(g))!==null;){let{index:F}=i;for(const X of i[0]){let re=VR.get(X);re||(re=X.normalize("NFD").length,VR.set(X,re)),t.push([re,F++])}}const n=t.length>0;let o;if(!n&&UA)o=UA;else if(n&&jA)o=jA;else{const F=Object.keys(UR).join(""),X=k9(),ee=[`[${F}]`,`[${X}]`,"(?:ã|ã)\\n","\\p{M}+(?:-\\n)?","\\p{Ll}-\\n(?=\\p{Ll})|\\p{Lu}-\\n(?=\\p{L})","\\S-\\n","(?:\\p{Ideographic}|[ã-ã¿])\\n","\\n",n?F9:"\\u0000"];o=new RegExp(ee.map(A=>`(${A})`).join("|"),"gum"),n?jA=o:UA=o}const l=[];for(;(i=L9.exec(g))!==null;)l.push([i[0].length,i.index]);let c=g.normalize("NFD");const d=[0,0];let f=0,m=0,b=0,T=0,C=0,P=!1;c=c.replace(o,(F,X,re,K,te,ee,A,me,fe,J,ye)=>{var Oe,ot,Tt;if(ye-=T,X){const dt=UR[X],kt=dt.length;for(let $e=1;$e<kt;$e++)d.push(ye-b+$e,b-$e);return b-=kt-1,dt}if(re){let dt=$R.get(re);dt||(dt=re.normalize("NFKC"),$R.set(re,dt));const kt=dt.length;for(let $e=1;$e<kt;$e++)d.push(ye-b+$e,b-$e);return b-=kt-1,dt}if(K)return P=!0,ye+C===((Oe=l[f])==null?void 0:Oe[1])?++f:(d.push(ye-1-b+1,b-1),b-=1,T+=1),d.push(ye-b+1,b),T+=1,C+=1,K.charAt(0);if(te){const dt=te.endsWith(`
`),kt=dt?te.length-2:te.length;P=!0;let $e=kt;ye+C===((ot=l[f])==null?void 0:ot[1])&&($e-=l[f][0],++f);for(let vt=1;vt<=$e;vt++)d.push(ye-1-b+vt,b-vt);return b-=$e,T+=$e,dt?(ye+=kt-1,d.push(ye-b+1,1+b),b+=1,T+=1,C+=1,te.slice(0,kt)):te}if(ee){const dt=ee.length-2;return d.push(ye-b+dt,1+b),b+=1,T+=1,C+=1,ee.slice(0,-2)}if(A)return T+=1,C+=1,A.slice(0,-1);if(me){const dt=me.length-1;return d.push(ye-b+dt,b),T+=1,C+=1,me.slice(0,-1)}if(fe)return d.push(ye-b+1,b-1),b-=1,T+=1,C+=1," ";if(ye+C===((Tt=t[m])==null?void 0:Tt[1])){const dt=t[m][0]-1;++m;for(let kt=1;kt<=dt;kt++)d.push(ye-(b-kt),b-kt);b-=dt,T+=dt}return J}),d.push(c.length,b);const x=new Uint32Array(d.length>>1),L=new Int32Array(d.length>>1);for(let F=0,X=d.length;F<X;F+=2)x[F>>1]=d[F],L[F>>1]=d[F+1];return[c,[x,L],P]}function gB(g,t,i){if(!g)return[t,i];const[n,o]=g,l=t,c=t+i-1;let d=cy(n,C=>C>=l);n[d]>l&&--d;let f=cy(n,C=>C>=c,d);n[f]>c&&--f;const m=l+o[d],T=c+o[f]+1-m;return[m,T]}var Jn,N0,Op,ti,mB,V2,$2,_B,bB,z2,yB,vB,kS,Hb,Jg,wB,W2,q2,PS,TB,G2,X2,Vb;class B9{constructor({linkService:t,eventBus:i,updateMatchesCountOnProgress:n=!0}){j(this,ti);j(this,Jn,null);j(this,N0,!0);j(this,Op,0);this._linkService=t,this._eventBus=i,D(this,N0,n),this.onIsPageVisible=null,R(this,ti,V2).call(this),i._on("find",R(this,ti,mB).bind(this)),i._on("findbarclose",R(this,ti,TB).bind(this))}get highlightMatches(){return this._highlightMatches}get pageMatches(){return this._pageMatches}get pageMatchesLength(){return this._pageMatchesLength}get selected(){return this._selected}get state(){return u(this,Jn)}setDocument(t){this._pdfDocument&&R(this,ti,V2).call(this),t&&(this._pdfDocument=t,this._firstPageCapability.resolve())}scrollMatchIntoView({element:t=null,selectedLeft:i=0,pageIndex:n=-1,matchIndex:o=-1}){if(!this._scrollMatches||!t)return;if(o===-1||o!==this._selected.matchIdx)return;if(n===-1||n!==this._selected.pageIdx)return;this._scrollMatches=!1;const l={top:D9,left:i+I9};oP(t,l,!0)}match(t,i,n){const o=this._hasDiacritics[n];let l=!1;if(typeof t=="string"?[l,t]=R(this,ti,z2).call(this,t,o):t=t.sort().reverse().map(T=>{const[C,P]=R(this,ti,z2).call(this,T,o);return l||(l=C),`(${P})`}).join("|"),!t)return;const{caseSensitive:c,entireWord:d}=u(this,Jn),f=`g${l?"u":""}${c?"":"i"}`;t=new RegExp(t,f);const m=[];let b;for(;(b=t.exec(i))!==null;)d&&!R(this,ti,bB).call(this,i,b.index,b[0].length)||m.push({index:b.index,length:b[0].length});return m}}Jn=new WeakMap,N0=new WeakMap,Op=new WeakMap,ti=new WeakSet,mB=function(t){if(!t)return;const i=this._pdfDocument,{type:n}=t;(u(this,Jn)===null||R(this,ti,_B).call(this,t))&&(this._dirtyMatch=!0),D(this,Jn,t),n!=="highlightallchange"&&R(this,ti,Vb).call(this,Lo.PENDING),this._firstPageCapability.promise.then(()=>{if(!this._pdfDocument||i&&this._pdfDocument!==i)return;R(this,ti,vB).call(this);const o=!this._highlightMatches,l=!!this._findTimeout;this._findTimeout&&(clearTimeout(this._findTimeout),this._findTimeout=null),n?this._dirtyMatch?R(this,ti,Jg).call(this):n==="again"?(R(this,ti,Jg).call(this),o&&u(this,Jn).highlightAll&&R(this,ti,Hb).call(this)):n==="highlightallchange"?(l?R(this,ti,Jg).call(this):this._highlightMatches=!0,R(this,ti,Hb).call(this)):R(this,ti,Jg).call(this):this._findTimeout=setTimeout(()=>{R(this,ti,Jg).call(this),this._findTimeout=null},P9)})},V2=function(){this._highlightMatches=!1,this._scrollMatches=!1,this._pdfDocument=null,this._pageMatches=[],this._pageMatchesLength=[],D(this,Op,0),D(this,Jn,null),this._selected={pageIdx:-1,matchIdx:-1},this._offset={pageIdx:null,matchIdx:null,wrapped:!1},this._extractTextPromises=[],this._pageContents=[],this._pageDiffs=[],this._hasDiacritics=[],this._matchesCountTotal=0,this._pagesToSearch=null,this._pendingFindMatches=new Set,this._resumePageIdx=null,this._dirtyMatch=!1,clearTimeout(this._findTimeout),this._findTimeout=null,this._firstPageCapability=Promise.withResolvers()},$2=function(){const{query:t}=u(this,Jn);return typeof t=="string"?(t!==this._rawQuery&&(this._rawQuery=t,[this._normalizedQuery]=CS(t)),this._normalizedQuery):(t||[]).filter(i=>!!i).map(i=>CS(i)[0])},_B=function(t){var c;const i=t.query,n=u(this,Jn).query,o=typeof i;if(o!==typeof n)return!0;if(o==="string"){if(i!==n)return!0}else if(JSON.stringify(i)!==JSON.stringify(n))return!0;switch(t.type){case"again":const d=this._selected.pageIdx+1,f=this._linkService;return d>=1&&d<=f.pagesCount&&d!==f.page&&!(((c=this.onIsPageVisible)==null?void 0:c.call(this,d))??!0);case"highlightallchange":return!1}return!0},bB=function(t,i,n){let o=t.slice(0,i).match(R9);if(o){const l=t.charCodeAt(i),c=o[1].charCodeAt(0);if($E(l)===$E(c))return!1}if(o=t.slice(i+n).match(M9),o){const l=t.charCodeAt(i+n-1),c=o[1].charCodeAt(0);if($E(l)===$E(c))return!1}return!0},z2=function(t,i){const{matchDiacritics:n}=u(this,Jn);let o=!1;t=t.replaceAll(N9,(c,d,f,m,b,T)=>d?`[ ]*\\${d}[ ]*`:f?`[ ]*${f}[ ]*`:m?"[ ]+":n?b||T:b?jR.has(b.charCodeAt(0))?b:"":i?(o=!0,`${T}\\p{M}*`):T);const l="[ ]*";return t.endsWith(l)&&(t=t.slice(0,t.length-l.length)),n&&i&&(HR||(HR=String.fromCharCode(...jR)),o=!0,t=`${t}(?=[${HR}]|[^\\p{M}]|$)`),[o,t]},yB=function(t){if(!u(this,Jn))return;const i=u(this,ti,$2);if(i.length===0)return;const n=this._pageContents[t],o=this.match(i,n,t),l=this._pageMatches[t]=[],c=this._pageMatchesLength[t]=[],d=this._pageDiffs[t];o==null||o.forEach(({index:m,length:b})=>{const[T,C]=gB(d,m,b);C&&(l.push(T),c.push(C))}),u(this,Jn).highlightAll&&R(this,ti,kS).call(this,t),this._resumePageIdx===t&&(this._resumePageIdx=null,R(this,ti,W2).call(this));const f=l.length;this._matchesCountTotal+=f,u(this,N0)?f>0&&R(this,ti,X2).call(this):++Yn(this,Op)._===this._linkService.pagesCount&&R(this,ti,X2).call(this)},vB=function(){if(this._extractTextPromises.length>0)return;let t=Promise.resolve();const i={disableNormalization:!0},n=this._pdfDocument;for(let o=0,l=this._linkService.pagesCount;o<l;o++){const{promise:c,resolve:d}=Promise.withResolvers();this._extractTextPromises[o]=c,t=t.then(async()=>{if(n!==this._pdfDocument){d();return}await n.getPage(o+1).then(f=>f.getTextContent(i)).then(f=>{const m=[];for(const b of f.items)m.push(b.str),b.hasEOL&&m.push(`
`);[this._pageContents[o],this._pageDiffs[o],this._hasDiacritics[o]]=CS(m.join("")),d()},f=>{console.error(`Unable to get text content for page ${o+1}`,f),this._pageContents[o]="",this._pageDiffs[o]=null,this._hasDiacritics[o]=!1,d()})})}},kS=function(t){this._scrollMatches&&this._selected.pageIdx===t&&(this._linkService.page=t+1),this._eventBus.dispatch("updatetextlayermatches",{source:this,pageIndex:t})},Hb=function(){this._eventBus.dispatch("updatetextlayermatches",{source:this,pageIndex:-1})},Jg=function(){const t=u(this,Jn).findPrevious,i=this._linkService.page-1,n=this._linkService.pagesCount;if(this._highlightMatches=!0,this._dirtyMatch){this._dirtyMatch=!1,this._selected.pageIdx=this._selected.matchIdx=-1,this._offset.pageIdx=i,this._offset.matchIdx=null,this._offset.wrapped=!1,this._resumePageIdx=null,this._pageMatches.length=0,this._pageMatchesLength.length=0,D(this,Op,0),this._matchesCountTotal=0,R(this,ti,Hb).call(this);for(let c=0;c<n;c++)this._pendingFindMatches.has(c)||(this._pendingFindMatches.add(c),this._extractTextPromises[c].then(()=>{this._pendingFindMatches.delete(c),R(this,ti,yB).call(this,c)}))}if(u(this,ti,$2).length===0){R(this,ti,Vb).call(this,Lo.FOUND);return}if(this._resumePageIdx)return;const l=this._offset;if(this._pagesToSearch=n,l.matchIdx!==null){const c=this._pageMatches[l.pageIdx].length;if(!t&&l.matchIdx+1<c||t&&l.matchIdx>0){l.matchIdx=t?l.matchIdx-1:l.matchIdx+1,R(this,ti,PS).call(this,!0);return}R(this,ti,q2).call(this,t)}R(this,ti,W2).call(this)},wB=function(t){const i=this._offset,n=t.length,o=u(this,Jn).findPrevious;return n?(i.matchIdx=o?n-1:0,R(this,ti,PS).call(this,!0),!0):(R(this,ti,q2).call(this,o),i.wrapped&&(i.matchIdx=null,this._pagesToSearch<0)?(R(this,ti,PS).call(this,!1),!0):!1)},W2=function(){this._resumePageIdx!==null&&console.error("There can only be one pending page.");let t=null;do{const i=this._offset.pageIdx;if(t=this._pageMatches[i],!t){this._resumePageIdx=i;break}}while(!R(this,ti,wB).call(this,t))},q2=function(t){const i=this._offset,n=this._linkService.pagesCount;i.pageIdx=t?i.pageIdx-1:i.pageIdx+1,i.matchIdx=null,this._pagesToSearch--,(i.pageIdx>=n||i.pageIdx<0)&&(i.pageIdx=t?n-1:0,i.wrapped=!0)},PS=function(t=!1){let i=Lo.NOT_FOUND;const n=this._offset.wrapped;if(this._offset.wrapped=!1,t){const o=this._selected.pageIdx;this._selected.pageIdx=this._offset.pageIdx,this._selected.matchIdx=this._offset.matchIdx,i=n?Lo.WRAPPED:Lo.FOUND,o!==-1&&o!==this._selected.pageIdx&&R(this,ti,kS).call(this,o)}R(this,ti,Vb).call(this,i,u(this,Jn).findPrevious),this._selected.pageIdx!==-1&&(this._scrollMatches=!0,R(this,ti,kS).call(this,this._selected.pageIdx))},TB=function(t){const i=this._pdfDocument;this._firstPageCapability.promise.then(()=>{!this._pdfDocument||i&&this._pdfDocument!==i||(this._findTimeout&&(clearTimeout(this._findTimeout),this._findTimeout=null),this._resumePageIdx&&(this._resumePageIdx=null,this._dirtyMatch=!0),R(this,ti,Vb).call(this,Lo.FOUND),this._highlightMatches=!1,R(this,ti,Hb).call(this))})},G2=function(){var l;const{pageIdx:t,matchIdx:i}=this._selected;let n=0,o=this._matchesCountTotal;if(i!==-1){for(let c=0;c<t;c++)n+=((l=this._pageMatches[c])==null?void 0:l.length)||0;n+=i+1}return(n<1||n>o)&&(n=o=0),{current:n,total:o}},X2=function(){this._eventBus.dispatch("updatefindmatchescount",{source:this,matchesCount:R(this,ti,G2).call(this)})},Vb=function(t,i=!1){var n,o;!u(this,N0)&&(u(this,Op)!==this._linkService.pagesCount||t===Lo.PENDING)||this._eventBus.dispatch("updatefindcontrolstate",{source:this,state:t,previous:i,entireWord:((n=u(this,Jn))==null?void 0:n.entireWord)??null,matchesCount:R(this,ti,G2).call(this),rawQuery:((o=u(this,Jn))==null?void 0:o.query)??null})};const U9=1e3;var hw,R0,yx,EB;class j9{constructor(t,i,n){j(this,yx);j(this,hw);j(this,R0,new ResizeObserver(R(this,yx,EB).bind(this)));this.opened=!1,this.bar=t.bar,this.toggleButton=t.toggleButton,this.findField=t.findField,this.highlightAll=t.highlightAllCheckbox,this.caseSensitive=t.caseSensitiveCheckbox,this.matchDiacritics=t.matchDiacriticsCheckbox,this.entireWord=t.entireWordCheckbox,this.findMsg=t.findMsg,this.findResultsCount=t.findResultsCount,this.findPreviousButton=t.findPreviousButton,this.findNextButton=t.findNextButton,this.eventBus=n,D(this,hw,i);const o=new Map([[this.highlightAll,"highlightallchange"],[this.caseSensitive,"casesensitivitychange"],[this.entireWord,"entirewordchange"],[this.matchDiacritics,"diacriticmatchingchange"]]);this.toggleButton.addEventListener("click",()=>{this.toggle()}),this.findField.addEventListener("input",()=>{this.dispatchEvent("")}),this.bar.addEventListener("keydown",({keyCode:l,shiftKey:c,target:d})=>{switch(l){case 13:d===this.findField?this.dispatchEvent("again",c):o.has(d)&&(d.checked=!d.checked,this.dispatchEvent(o.get(d)));break;case 27:this.close();break}}),this.findPreviousButton.addEventListener("click",()=>{this.dispatchEvent("again",!0)}),this.findNextButton.addEventListener("click",()=>{this.dispatchEvent("again",!1)});for(const[l,c]of o)l.addEventListener("click",()=>{this.dispatchEvent(c)})}reset(){this.updateUIState()}dispatchEvent(t,i=!1){this.eventBus.dispatch("find",{source:this,type:t,query:this.findField.value,caseSensitive:this.caseSensitive.checked,entireWord:this.entireWord.checked,highlightAll:this.highlightAll.checked,findPrevious:i,matchDiacritics:this.matchDiacritics.checked})}updateUIState(t,i,n){const{findField:o,findMsg:l}=this;let c="",d="";switch(t){case Lo.FOUND:break;case Lo.PENDING:d="pending";break;case Lo.NOT_FOUND:c="pdfjs-find-not-found",d="notFound";break;case Lo.WRAPPED:c=i?"pdfjs-find-reached-top":"pdfjs-find-reached-bottom";break}o.setAttribute("data-status",d),o.setAttribute("aria-invalid",t===Lo.NOT_FOUND),l.setAttribute("data-status",d),c?l.setAttribute("data-l10n-id",c):(l.removeAttribute("data-l10n-id"),l.textContent=""),this.updateResultsCount(n)}updateResultsCount({current:t=0,total:i=0}={}){const{findResultsCount:n}=this;if(i>0){const o=U9;n.setAttribute("data-l10n-id",i>o?"pdfjs-find-match-count-limit":"pdfjs-find-match-count"),n.setAttribute("data-l10n-args",JSON.stringify({limit:o,current:t,total:i}))}else n.removeAttribute("data-l10n-id"),n.textContent=""}open(){this.opened||(u(this,R0).observe(u(this,hw)),u(this,R0).observe(this.bar),this.opened=!0,bl(this.toggleButton,!0,this.bar)),this.findField.select(),this.findField.focus()}close(){this.opened&&(u(this,R0).disconnect(),this.opened=!1,bl(this.toggleButton,!1,this.bar),this.eventBus.dispatch("findbarclose",{source:this}))}toggle(){this.opened?this.close():this.open()}}hw=new WeakMap,R0=new WeakMap,yx=new WeakSet,EB=function(){const{bar:t}=this;t.classList.remove("wrapContainers");const i=t.clientHeight,n=t.firstElementChild.clientHeight;i>n&&t.classList.add("wrapContainers")};const H9=1e3,V9=50,$9=1e3;function HA(){return document.location.hash}var nd,Bi,Pu,DS,IS,$b,LS,K2,SB,xB,Y2,AB,CB;class z9{constructor({linkService:t,eventBus:i}){j(this,Bi);j(this,nd,null);this.linkService=t,this.eventBus=i,this._initialized=!1,this._fingerprint="",this.reset(),this.eventBus._on("pagesinit",()=>{this._isPagesLoaded=!1,this.eventBus._on("pagesloaded",n=>{this._isPagesLoaded=!!n.pagesCount},{once:!0})})}initialize({fingerprint:t,resetHistory:i=!1,updateUrl:n=!1}){if(!t||typeof t!="string"){console.error('PDFHistory.initialize: The "fingerprint" must be a non-empty string.');return}this._initialized&&this.reset();const o=this._fingerprint!==""&&this._fingerprint!==t;this._fingerprint=t,this._updateUrl=n===!0,this._initialized=!0,R(this,Bi,AB).call(this);const l=window.history.state;if(this._popStateInProgress=!1,this._blockHashChange=0,this._currentHash=HA(),this._numPositionUpdates=0,this._uid=this._maxUid=0,this._destination=null,this._position=null,!R(this,Bi,$b).call(this,l,!0)||i){const{hash:d,page:f,rotation:m}=R(this,Bi,K2).call(this,!0);if(!d||o||i){R(this,Bi,Pu).call(this,null,!0);return}R(this,Bi,Pu).call(this,{hash:d,page:f,rotation:m},!0);return}const c=l.destination;R(this,Bi,LS).call(this,c,l.uid,!0),c.rotation!==void 0&&(this._initialRotation=c.rotation),c.dest?(this._initialBookmark=JSON.stringify(c.dest),this._destination.page=null):c.hash?this._initialBookmark=c.hash:c.page&&(this._initialBookmark=`page=${c.page}`)}reset(){this._initialized&&(R(this,Bi,Y2).call(this),this._initialized=!1,R(this,Bi,CB).call(this)),this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),this._initialBookmark=null,this._initialRotation=null}push({namedDest:t=null,explicitDest:i,pageNumber:n}){if(!this._initialized)return;if(t&&typeof t!="string"){console.error(`PDFHistory.push: "${t}" is not a valid namedDest parameter.`);return}else if(Array.isArray(i)){if(!R(this,Bi,IS).call(this,n)&&(n!==null||this._destination)){console.error(`PDFHistory.push: "${n}" is not a valid pageNumber parameter.`);return}}else{console.error(`PDFHistory.push: "${i}" is not a valid explicitDest parameter.`);return}const o=t||JSON.stringify(i);if(!o)return;let l=!1;if(this._destination&&(W9(this._destination.hash,o)||q9(this._destination.dest,i))){if(this._destination.page)return;l=!0}this._popStateInProgress&&!l||(R(this,Bi,Pu).call(this,{dest:i,hash:o,page:n,rotation:this.linkService.rotation},l),this._popStateInProgress||(this._popStateInProgress=!0,Promise.resolve().then(()=>{this._popStateInProgress=!1})))}pushPage(t){var i;if(this._initialized){if(!R(this,Bi,IS).call(this,t)){console.error(`PDFHistory.pushPage: "${t}" is not a valid page number.`);return}((i=this._destination)==null?void 0:i.page)!==t&&(this._popStateInProgress||(R(this,Bi,Pu).call(this,{dest:null,hash:`page=${t}`,page:t,rotation:this.linkService.rotation}),this._popStateInProgress||(this._popStateInProgress=!0,Promise.resolve().then(()=>{this._popStateInProgress=!1}))))}}pushCurrentPosition(){!this._initialized||this._popStateInProgress||R(this,Bi,DS).call(this)}back(){if(!this._initialized||this._popStateInProgress)return;const t=window.history.state;R(this,Bi,$b).call(this,t)&&t.uid>0&&window.history.back()}forward(){if(!this._initialized||this._popStateInProgress)return;const t=window.history.state;R(this,Bi,$b).call(this,t)&&t.uid<this._maxUid&&window.history.forward()}get popStateInProgress(){return this._initialized&&(this._popStateInProgress||this._blockHashChange>0)}get initialBookmark(){return this._initialized?this._initialBookmark:null}get initialRotation(){return this._initialized?this._initialRotation:null}}nd=new WeakMap,Bi=new WeakSet,Pu=function(t,i=!1){const n=i||!this._destination,o={fingerprint:this._fingerprint,uid:n?this._uid:this._uid+1,destination:t};R(this,Bi,LS).call(this,t,o.uid);let l;if(this._updateUrl&&(t!=null&&t.hash)){const{href:c,protocol:d}=document.location;d!=="file:"&&(l=u2(c,t.hash))}n?window.history.replaceState(o,"",l):window.history.pushState(o,"",l)},DS=function(t=!1){if(!this._position)return;let i=this._position;if(t&&(i=Object.assign(Object.create(null),this._position),i.temporary=!0),!this._destination){R(this,Bi,Pu).call(this,i);return}if(this._destination.temporary){R(this,Bi,Pu).call(this,i,!0);return}if(this._destination.hash===i.hash||!this._destination.page&&this._numPositionUpdates<=V9)return;let n=!1;if(this._destination.page>=i.first&&this._destination.page<=i.page){if(this._destination.dest!==void 0||!this._destination.first)return;n=!0}R(this,Bi,Pu).call(this,i,n)},IS=function(t){return Number.isInteger(t)&&t>0&&t<=this.linkService.pagesCount},$b=function(t,i=!1){if(!t)return!1;if(t.fingerprint!==this._fingerprint)if(i){if(typeof t.fingerprint!="string"||t.fingerprint.length!==this._fingerprint.length)return!1;const[n]=performance.getEntriesByType("navigation");if((n==null?void 0:n.type)!=="reload")return!1}else return!1;return!(!Number.isInteger(t.uid)||t.uid<0||t.destination===null||typeof t.destination!="object")},LS=function(t,i,n=!1){this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),n&&(t!=null&&t.temporary)&&delete t.temporary,this._destination=t,this._uid=i,this._maxUid=Math.max(this._maxUid,i),this._numPositionUpdates=0},K2=function(t=!1){const i=unescape(HA()).substring(1),n=hy(i),o=n.get("nameddest")||"";let l=n.get("page")|0;return(!R(this,Bi,IS).call(this,l)||t&&o.length>0)&&(l=null),{hash:i,page:l,rotation:this.linkService.rotation}},SB=function({location:t}){this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),this._position={hash:t.pdfOpenParams.substring(1),page:this.linkService.page,first:t.pageNumber,rotation:t.rotation},!this._popStateInProgress&&(this._isPagesLoaded&&this._destination&&!this._destination.page&&this._numPositionUpdates++,this._updateViewareaTimeout=setTimeout(()=>{this._popStateInProgress||R(this,Bi,DS).call(this,!0),this._updateViewareaTimeout=null},$9))},xB=function({state:t}){const i=HA(),n=this._currentHash!==i;if(this._currentHash=i,!t){this._uid++;const{hash:l,page:c,rotation:d}=R(this,Bi,K2).call(this);R(this,Bi,Pu).call(this,{hash:l,page:c,rotation:d},!0);return}if(!R(this,Bi,$b).call(this,t))return;this._popStateInProgress=!0,n&&(this._blockHashChange++,UF({target:window,name:"hashchange",delay:H9}).then(()=>{this._blockHashChange--}));const o=t.destination;R(this,Bi,LS).call(this,o,t.uid,!0),Ix(o.rotation)&&(this.linkService.rotation=o.rotation),o.dest?this.linkService.goToDestination(o.dest):o.hash?this.linkService.setHash(o.hash):o.page&&(this.linkService.page=o.page),Promise.resolve().then(()=>{this._popStateInProgress=!1})},Y2=function(){(!this._destination||this._destination.temporary)&&R(this,Bi,DS).call(this)},AB=function(){if(u(this,nd))return;D(this,nd,new AbortController);const{signal:t}=u(this,nd);this.eventBus._on("updateviewarea",R(this,Bi,SB).bind(this),{signal:t}),window.addEventListener("popstate",R(this,Bi,xB).bind(this),{signal:t}),window.addEventListener("pagehide",R(this,Bi,Y2).bind(this),{signal:t})},CB=function(){var t;(t=u(this,nd))==null||t.abort(),D(this,nd,null)};function W9(g,t){return typeof g!="string"||typeof t!="string"?!1:g===t||hy(g).get("nameddest")===t}function q9(g,t){function i(n,o){if(typeof n!=typeof o||Array.isArray(n)||Array.isArray(o))return!1;if(n!==null&&typeof n=="object"&&o!==null){if(Object.keys(n).length!==Object.keys(o).length)return!1;for(const l in n)if(!i(n[l],o[l]))return!1;return!0}return n===o||Number.isNaN(n)&&Number.isNaN(o)}if(!(Array.isArray(g)&&Array.isArray(t))||g.length!==t.length)return!1;for(let n=0,o=g.length;n<o;n++)if(!i(g[n],t[n]))return!1;return!0}var cw,Z2;class G9 extends uP{constructor(i){super(i);j(this,cw);this.eventBus._on("optionalcontentconfigchanged",n=>{R(this,cw,Z2).call(this,n.promise)}),this.eventBus._on("resetlayers",()=>{R(this,cw,Z2).call(this)}),this.eventBus._on("togglelayerstree",this._toggleAllTreeItems.bind(this))}reset(){var i;super.reset(),this._optionalContentConfig=null,(i=this._optionalContentVisibility)==null||i.clear(),this._optionalContentVisibility=null}_dispatchEvent(i){this.eventBus.dispatch("layersloaded",{source:this,layersCount:i})}_bindLink(i,{groupId:n,input:o}){const l=()=>{const c=o.checked;this._optionalContentConfig.setVisibility(n,c);const d=this._optionalContentVisibility.get(n);d&&(d.visible=c),this.eventBus.dispatch("optionalcontentconfig",{source:this,promise:Promise.resolve(this._optionalContentConfig)})};i.onclick=c=>c.target===o?(l(),!0):c.target!==i?!0:(o.checked=!o.checked,l(),!1)}_setNestedName(i,{name:n=null}){if(typeof n=="string"){i.textContent=this._normalizeTextContent(n);return}i.setAttribute("data-l10n-id","pdfjs-additional-layers"),i.style.fontStyle="italic",this._l10n.translateOnce(i)}_addToggleButton(i,{name:n=null}){super._addToggleButton(i,n===null)}_toggleAllTreeItems(){this._optionalContentConfig&&super._toggleAllTreeItems()}render({optionalContentConfig:i,pdfDocument:n}){this._optionalContentConfig&&this.reset(),this._optionalContentConfig=i||null,this._pdfDocument=n||null;const o=i==null?void 0:i.getOrder();if(!o){this._dispatchEvent(0);return}this._optionalContentVisibility=new Map;const l=document.createDocumentFragment(),c=[{parent:l,groups:o}];let d=0,f=!1;for(;c.length>0;){const m=c.shift();for(const b of m.groups){const T=document.createElement("div");T.className="treeItem";const C=document.createElement("a");if(T.append(C),typeof b=="object"){f=!0,this._addToggleButton(T,b),this._setNestedName(C,b);const P=document.createElement("div");P.className="treeItems",T.append(P),c.push({parent:P,groups:b.order})}else{const P=i.getGroup(b),x=document.createElement("input");this._bindLink(C,{groupId:b,input:x}),x.type="checkbox",x.checked=P.visible,this._optionalContentVisibility.set(b,{input:x,visible:x.checked});const L=document.createElement("label");L.textContent=this._normalizeTextContent(P.name),L.append(x),C.append(L),d++}m.parent.append(T)}}this._finishRendering(l,d,f)}}cw=new WeakSet,Z2=async function(i=null){if(!this._optionalContentConfig)return;const n=this._pdfDocument,o=await(i||n.getOptionalContentConfig({intent:"display"}));if(n===this._pdfDocument){if(i){for(const[l,c]of this._optionalContentVisibility){const d=o.getGroup(l);d&&c.visible!==d.visible&&(c.input.checked=c.visible=!c.visible)}return}this.eventBus.dispatch("optionalcontentconfig",{source:this,promise:Promise.resolve(o)}),this.render({optionalContentConfig:o,pdfDocument:this._pdfDocument})}};class X9 extends uP{constructor(t){super(t),this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.eventBus._on("toggleoutlinetree",this._toggleAllTreeItems.bind(this)),this.eventBus._on("currentoutlineitem",this._currentOutlineItem.bind(this)),this.eventBus._on("pagechanging",i=>{this._currentPageNumber=i.pageNumber}),this.eventBus._on("pagesloaded",i=>{var n;this._isPagesLoaded=!!i.pagesCount,(n=this._currentOutlineItemCapability)==null||n.resolve(this._isPagesLoaded)}),this.eventBus._on("sidebarviewchanged",i=>{this._sidebarView=i.view})}reset(){var t;super.reset(),this._outline=null,this._pageNumberToDestHashCapability=null,this._currentPageNumber=1,this._isPagesLoaded=null,(t=this._currentOutlineItemCapability)==null||t.resolve(!1),this._currentOutlineItemCapability=null}_dispatchEvent(t){var i;this._currentOutlineItemCapability=Promise.withResolvers(),t===0||(i=this._pdfDocument)!=null&&i.loadingParams.disableAutoFetch?this._currentOutlineItemCapability.resolve(!1):this._isPagesLoaded!==null&&this._currentOutlineItemCapability.resolve(this._isPagesLoaded),this.eventBus.dispatch("outlineloaded",{source:this,outlineCount:t,currentOutlineItemPromise:this._currentOutlineItemCapability.promise})}_bindLink(t,{url:i,newWindow:n,action:o,attachment:l,dest:c,setOCGState:d}){const{linkService:f}=this;if(i){f.addLinkAttributes(t,i,n);return}if(o){t.href=f.getAnchorUrl(""),t.onclick=()=>(f.executeNamedAction(o),!1);return}if(l){t.href=f.getAnchorUrl(""),t.onclick=()=>(this.downloadManager.openOrDownloadData(l.content,l.filename),!1);return}if(d){t.href=f.getAnchorUrl(""),t.onclick=()=>(f.executeSetOCGState(d),!1);return}t.href=f.getDestinationHash(c),t.onclick=m=>(this._updateCurrentTreeItem(m.target.parentNode),c&&f.goToDestination(c),!1)}_setStyles(t,{bold:i,italic:n}){i&&(t.style.fontWeight="bold"),n&&(t.style.fontStyle="italic")}_addToggleButton(t,{count:i,items:n}){let o=!1;if(i<0){let l=n.length;if(l>0){const c=[...n];for(;c.length>0;){const{count:d,items:f}=c.shift();d>0&&f.length>0&&(l+=f.length,c.push(...f))}}Math.abs(i)===l&&(o=!0)}super._addToggleButton(t,o)}_toggleAllTreeItems(){this._outline&&super._toggleAllTreeItems()}render({outline:t,pdfDocument:i}){if(this._outline&&this.reset(),this._outline=t||null,this._pdfDocument=i||null,!t){this._dispatchEvent(0);return}const n=document.createDocumentFragment(),o=[{parent:n,items:t}];let l=0,c=!1;for(;o.length>0;){const d=o.shift();for(const f of d.items){const m=document.createElement("div");m.className="treeItem";const b=document.createElement("a");if(this._bindLink(b,f),this._setStyles(b,f),b.textContent=this._normalizeTextContent(f.title),m.append(b),f.items.length>0){c=!0,this._addToggleButton(m,f);const T=document.createElement("div");T.className="treeItems",m.append(T),o.push({parent:T,items:f.items})}d.parent.append(m),l++}}this._finishRendering(n,l,c)}async _currentOutlineItem(){if(!this._isPagesLoaded)throw new Error("_currentOutlineItem: All pages have not been loaded.");if(!this._outline||!this._pdfDocument)return;const t=await this._getPageNumberToDestHash(this._pdfDocument);if(t&&(this._updateCurrentTreeItem(null),this._sidebarView===Ni.OUTLINE))for(let i=this._currentPageNumber;i>0;i--){const n=t.get(i);if(!n)continue;const o=this.container.querySelector(`a[href="${n}"]`);if(o){this._scrollToCurrentTreeItem(o.parentNode);break}}}async _getPageNumberToDestHash(t){if(this._pageNumberToDestHashCapability)return this._pageNumberToDestHashCapability.promise;this._pageNumberToDestHashCapability=Promise.withResolvers();const i=new Map,n=new Map,o=[{nesting:0,items:this._outline}];for(;o.length>0;){const l=o.shift(),c=l.nesting;for(const{dest:d,items:f}of l.items){let m,b;if(typeof d=="string"){if(m=await t.getDestination(d),t!==this._pdfDocument)return null}else m=d;if(Array.isArray(m)){const[T]=m;if(T&&typeof T=="object"?b=t.cachedPageNumber(T):Number.isInteger(T)&&(b=T+1),Number.isInteger(b)&&(!i.has(b)||c>n.get(b))){const C=this.linkService.getDestinationHash(d);i.set(b,C),n.set(b,c)}}f.length>0&&o.push({nesting:c+1,items:f})}}return this._pageNumberToDestHashCapability.resolve(i.size>0?i:null),this._pageNumberToDestHashCapability.promise}}const K9=3e3,zR="pdfPresentationMode",VA="pdfPresentationModeControls",Y9=50,Z9=.1,WR=50,$A=Math.PI/6;var M0,Hr,rd,ad,Ji,kB,zb,PB,DB,IB,LB,Q2,NB,Wb,RB,MB,OB,FB,J2;class Q9{constructor({container:t,pdfViewer:i,eventBus:n}){j(this,Ji);j(this,M0,tr.UNKNOWN);j(this,Hr,null);j(this,rd,null);j(this,ad,null);this.container=t,this.pdfViewer=i,this.eventBus=n,this.contextMenuOpen=!1,this.mouseScrollTimeStamp=0,this.mouseScrollDelta=0,this.touchSwipeState=null}async request(){const{container:t,pdfViewer:i}=this;if(this.active||!i.pagesCount||!t.requestFullscreen)return!1;R(this,Ji,FB).call(this),R(this,Ji,zb).call(this,tr.CHANGING);const n=t.requestFullscreen();D(this,Hr,{pageNumber:i.currentPageNumber,scaleValue:i.currentScaleValue,scrollMode:i.scrollMode,spreadMode:null,annotationEditorMode:null}),i.spreadMode!==Ws.NONE&&!(i.pageViewsReady&&i.hasEqualPageSizes)&&(console.warn("Ignoring Spread modes when entering PresentationMode, since the document may contain varying page sizes."),u(this,Hr).spreadMode=i.spreadMode),i.annotationEditorMode!==Qi.DISABLE&&(u(this,Hr).annotationEditorMode=i.annotationEditorMode);try{return await n,i.focus(),!0}catch{R(this,Ji,J2).call(this),R(this,Ji,zb).call(this,tr.NORMAL)}return!1}get active(){return u(this,M0)===tr.CHANGING||u(this,M0)===tr.FULLSCREEN}}M0=new WeakMap,Hr=new WeakMap,rd=new WeakMap,ad=new WeakMap,Ji=new WeakSet,kB=function(t){if(!this.active)return;t.preventDefault();const i=Jz(t),n=Date.now(),o=this.mouseScrollTimeStamp;if(!(n>o&&n-o<Y9)&&((this.mouseScrollDelta>0&&i<0||this.mouseScrollDelta<0&&i>0)&&R(this,Ji,Wb).call(this),this.mouseScrollDelta+=i,Math.abs(this.mouseScrollDelta)>=Z9)){const l=this.mouseScrollDelta;R(this,Ji,Wb).call(this),(l>0?this.pdfViewer.previousPage():this.pdfViewer.nextPage())&&(this.mouseScrollTimeStamp=n)}},zb=function(t){D(this,M0,t),this.eventBus.dispatch("presentationmodechanged",{source:this,state:t})},PB=function(){R(this,Ji,zb).call(this,tr.FULLSCREEN),this.container.classList.add(zR),setTimeout(()=>{this.pdfViewer.scrollMode=Ci.PAGE,u(this,Hr).spreadMode!==null&&(this.pdfViewer.spreadMode=Ws.NONE),this.pdfViewer.currentPageNumber=u(this,Hr).pageNumber,this.pdfViewer.currentScaleValue="page-fit",u(this,Hr).annotationEditorMode!==null&&(this.pdfViewer.annotationEditorMode={mode:Qi.NONE})},0),R(this,Ji,MB).call(this),R(this,Ji,Q2).call(this),this.contextMenuOpen=!1,document.getSelection().empty()},DB=function(){const t=this.pdfViewer.currentPageNumber;this.container.classList.remove(zR),setTimeout(()=>{R(this,Ji,J2).call(this),R(this,Ji,zb).call(this,tr.NORMAL),this.pdfViewer.scrollMode=u(this,Hr).scrollMode,u(this,Hr).spreadMode!==null&&(this.pdfViewer.spreadMode=u(this,Hr).spreadMode),this.pdfViewer.currentScaleValue=u(this,Hr).scaleValue,this.pdfViewer.currentPageNumber=t,u(this,Hr).annotationEditorMode!==null&&(this.pdfViewer.annotationEditorMode={mode:u(this,Hr).annotationEditorMode}),D(this,Hr,null)},0),R(this,Ji,OB).call(this),R(this,Ji,NB).call(this),R(this,Ji,Wb).call(this),this.contextMenuOpen=!1},IB=function(t){var i;if(this.contextMenuOpen){this.contextMenuOpen=!1,t.preventDefault();return}t.button===0&&(t.target.href&&((i=t.target.parentNode)!=null&&i.hasAttribute("data-internal-link"))||(t.preventDefault(),t.shiftKey?this.pdfViewer.previousPage():this.pdfViewer.nextPage()))},LB=function(){this.contextMenuOpen=!0},Q2=function(){this.controlsTimeout?clearTimeout(this.controlsTimeout):this.container.classList.add(VA),this.controlsTimeout=setTimeout(()=>{this.container.classList.remove(VA),delete this.controlsTimeout},K9)},NB=function(){this.controlsTimeout&&(clearTimeout(this.controlsTimeout),this.container.classList.remove(VA),delete this.controlsTimeout)},Wb=function(){this.mouseScrollTimeStamp=0,this.mouseScrollDelta=0},RB=function(t){if(this.active){if(t.touches.length>1){this.touchSwipeState=null;return}switch(t.type){case"touchstart":this.touchSwipeState={startX:t.touches[0].pageX,startY:t.touches[0].pageY,endX:t.touches[0].pageX,endY:t.touches[0].pageY};break;case"touchmove":if(this.touchSwipeState===null)return;this.touchSwipeState.endX=t.touches[0].pageX,this.touchSwipeState.endY=t.touches[0].pageY,t.preventDefault();break;case"touchend":if(this.touchSwipeState===null)return;let i=0;const n=this.touchSwipeState.endX-this.touchSwipeState.startX,o=this.touchSwipeState.endY-this.touchSwipeState.startY,l=Math.abs(Math.atan2(o,n));Math.abs(n)>WR&&(l<=$A||l>=Math.PI-$A)?i=n:Math.abs(o)>WR&&Math.abs(l-Math.PI/2)<=$A&&(i=o),i>0?this.pdfViewer.previousPage():i<0&&this.pdfViewer.nextPage();break}}},MB=function(){if(u(this,ad))return;D(this,ad,new AbortController);const{signal:t}=u(this,ad),i=R(this,Ji,RB).bind(this);window.addEventListener("mousemove",R(this,Ji,Q2).bind(this),{signal:t}),window.addEventListener("mousedown",R(this,Ji,IB).bind(this),{signal:t}),window.addEventListener("wheel",R(this,Ji,kB).bind(this),{passive:!1,signal:t}),window.addEventListener("keydown",R(this,Ji,Wb).bind(this),{signal:t}),window.addEventListener("contextmenu",R(this,Ji,LB).bind(this),{signal:t}),window.addEventListener("touchstart",i,{signal:t}),window.addEventListener("touchmove",i,{signal:t}),window.addEventListener("touchend",i,{signal:t})},OB=function(){var t;(t=u(this,ad))==null||t.abort(),D(this,ad,null)},FB=function(){u(this,rd)||(D(this,rd,new AbortController),window.addEventListener("fullscreenchange",()=>{document.fullscreenElement?R(this,Ji,PB).call(this):R(this,Ji,DB).call(this)},{signal:u(this,rd).signal}))},J2=function(){var t;(t=u(this,rd))==null||t.abort(),D(this,rd,null)};class BB{constructor({pdfPage:t,annotationStorage:i=null,linkService:n,xfaHtml:o=null}){this.pdfPage=t,this.annotationStorage=i,this.linkService=n,this.xfaHtml=o,this.div=null,this._cancelled=!1}async render({viewport:t,intent:i="display"}){if(i==="print"){const l={viewport:t.clone({dontFlip:!0}),div:this.div,xfaHtml:this.xfaHtml,annotationStorage:this.annotationStorage,linkService:this.linkService,intent:i};return this.div=document.createElement("div"),l.div=this.div,NA.render(l)}const n=await this.pdfPage.getXfa();if(this._cancelled||!n)return{textDivs:[]};const o={viewport:t.clone({dontFlip:!0}),div:this.div,xfaHtml:n,annotationStorage:this.annotationStorage,linkService:this.linkService,intent:i};return this.div?NA.update(o):(this.div=document.createElement("div"),o.div=this.div,NA.render(o))}cancel(){this._cancelled=!0}hide(){this.div&&(this.div.hidden=!0)}}function J9(g,t){const i=t.allXfaHtml,n=new BF,o=Math.round(ml.PDF_TO_CSS_UNITS*100)/100;for(const l of i.children){const c=document.createElement("div");c.className="xfaPrintedPage",g.append(c);const d=new BB({pdfPage:null,annotationStorage:t.annotationStorage,linkService:n,xfaHtml:l}),f=Fz(l,{scale:o});d.render({viewport:f,intent:"print"}),c.append(d.div)}}let oo=null,Lh=null,lm=null,UB={};function eW(g,t,i,n,o,l,c){const d=oo.scratchCanvas,f=o/ml.PDF;d.width=Math.floor(n.width*f),d.height=Math.floor(n.height*f);const m=d.getContext("2d");return m.save(),m.fillStyle="rgb(255, 255, 255)",m.fillRect(0,0,d.width,d.height),m.restore(),Promise.all([t.getPage(i),c]).then(function([b,T]){const C={canvasContext:m,transform:[f,0,0,f,0,0],viewport:b.getViewport({scale:1,rotation:n.rotation}),intent:"print",annotationMode:cu.ENABLE_STORAGE,optionalContentConfigPromise:l,printAnnotationStorage:T};return b.render(C).promise.catch(x=>{throw x instanceof uy||console.error(x),x})})}class tW{constructor({pdfDocument:t,pagesOverview:i,printContainer:n,printResolution:o,printAnnotationStoragePromise:l=null}){this.pdfDocument=t,this.pagesOverview=i,this.printContainer=n,this._printResolution=o||150,this._optionalContentConfigPromise=t.getOptionalContentConfig({intent:"print"}),this._printAnnotationStoragePromise=l||Promise.resolve(),this.currentPage=-1,this.scratchCanvas=document.createElement("canvas")}layout(){this.throwIfInactive();const t=document.querySelector("body");t.setAttribute("data-pdfjsprinting",!0);const{width:i,height:n}=this.pagesOverview[0];this.pagesOverview.every(l=>l.width===i&&l.height===n)||console.warn("Not all pages have the same size. The printed result may be incorrect!"),this.pageStyleSheet=document.createElement("style"),this.pageStyleSheet.textContent=`@page { size: ${i}pt ${n}pt;}`,t.append(this.pageStyleSheet)}destroy(){if(oo!==this)return;this.printContainer.textContent="",document.querySelector("body").removeAttribute("data-pdfjsprinting"),this.pageStyleSheet&&(this.pageStyleSheet.remove(),this.pageStyleSheet=null),this.scratchCanvas.width=this.scratchCanvas.height=0,this.scratchCanvas=null,oo=null,tk().then(function(){lm.closeIfActive(Lh)})}renderPages(){if(this.pdfDocument.isPureXfa)return J9(this.printContainer,this.pdfDocument),Promise.resolve();const t=this.pagesOverview.length,i=(n,o)=>{if(this.throwIfInactive(),++this.currentPage>=t){qR(t,t),n();return}const l=this.currentPage;qR(l,t),eW(this,this.pdfDocument,l+1,this.pagesOverview[l],this._printResolution,this._optionalContentConfigPromise,this._printAnnotationStoragePromise).then(this.useRenderedPage.bind(this)).then(function(){i(n,o)},o)};return new Promise(i)}useRenderedPage(){this.throwIfInactive();const t=document.createElement("img");this.scratchCanvas.toBlob(c=>{t.src=URL.createObjectURL(c)});const i=document.createElement("div");i.className="printedPage",i.append(t),this.printContainer.append(i);const{promise:n,resolve:o,reject:l}=Promise.withResolvers();return t.onload=o,t.onerror=l,n.catch(()=>{}).then(()=>{URL.revokeObjectURL(t.src)}),n}performPrint(){return this.throwIfInactive(),new Promise(t=>{setTimeout(()=>{if(!this.active){t();return}iW.call(window),setTimeout(t,20)},0)})}get active(){return this===oo}throwIfInactive(){if(!this.active)throw new Error("This print request was cancelled or completed.")}}const iW=window.print;window.print=function(){if(oo){console.warn("Ignored window.print() because of a pending print job.");return}tk().then(function(){oo&&lm.open(Lh)});try{jB("beforeprint")}finally{if(!oo)console.error("Expected print service to be initialized."),tk().then(function(){lm.closeIfActive(Lh)});else{const g=oo;oo.renderPages().then(()=>g.performPrint()).catch(()=>{}).then(()=>{g.active&&ek()})}}};function jB(g){const t=new CustomEvent(g,{bubbles:!1,cancelable:!1,detail:"custom"});window.dispatchEvent(t)}function ek(){oo&&(oo.destroy(),jB("afterprint"))}function qR(g,t){Lh||(Lh=document.getElementById("printServiceDialog"));const i=Math.round(100*g/t),n=Lh.querySelector("progress"),o=Lh.querySelector(".relative-progress");n.value=i,o.setAttribute("data-l10n-args",JSON.stringify({progress:i}))}window.addEventListener("keydown",function(g){g.keyCode===80&&(g.ctrlKey||g.metaKey)&&!g.altKey&&(!g.shiftKey||window.chrome||window.opera)&&(window.print(),g.preventDefault(),g.stopImmediatePropagation())},!0);if("onbeforeprint"in window){const g=function(t){t.detail!=="custom"&&t.stopImmediatePropagation()};window.addEventListener("beforeprint",g),window.addEventListener("afterprint",g)}let zA;function tk(){if(!zA){if(lm=UB.overlayManager,!lm)throw new Error("The overlay manager has not yet been initialized.");Lh||(Lh=document.getElementById("printServiceDialog")),zA=lm.register(Lh,!0),document.getElementById("printCancel").onclick=ek,Lh.addEventListener("close",ek)}return zA}class ik{static initGlobals(t){UB=t}static get supportsPrinting(){return Pa(this,"supportsPrinting",!0)}static createPrintService(t){if(oo)throw new Error("The print service is created and active.");return oo=new tW(t)}}const sW=3e4;class HB{constructor(){this.pdfViewer=null,this.pdfThumbnailViewer=null,this.onIdle=null,this.highestPriorityPage=null,this.idleTimeout=null,this.printing=!1,this.isThumbnailViewEnabled=!1,Object.defineProperty(this,"hasViewer",{value:()=>!!this.pdfViewer})}setViewer(t){this.pdfViewer=t}setThumbnailViewer(t){this.pdfThumbnailViewer=t}isHighestPriority(t){return this.highestPriorityPage===t.renderingId}renderHighestPriority(t){var i;this.idleTimeout&&(clearTimeout(this.idleTimeout),this.idleTimeout=null),!this.pdfViewer.forceRendering(t)&&(this.isThumbnailViewEnabled&&((i=this.pdfThumbnailViewer)!=null&&i.forceRendering())||this.printing||this.onIdle&&(this.idleTimeout=setTimeout(this.onIdle.bind(this),sW)))}getHighestPriority(t,i,n,o=!1,l=!1){const c=t.views,d=c.length;if(d===0)return null;for(let C=0;C<d;C++){const P=c[C].view;if(!this.isViewFinished(P))return P}if(!l)for(let C=0;C<d;C++){const{detailView:P}=c[C].view;if(P&&!this.isViewFinished(P))return P}const f=t.first.id,m=t.last.id;if(m-f+1>d){const C=t.ids;for(let P=1,x=m-f;P<x;P++){const L=n?f+P:m-P;if(C.has(L))continue;const F=i[L-1];if(!this.isViewFinished(F))return F}}let b=n?m:f-2,T=i[b];return T&&!this.isViewFinished(T)||o&&(b+=n?1:-1,T=i[b],T&&!this.isViewFinished(T))?T:null}isViewFinished(t){return t.renderingState===Ii.FINISHED}renderView(t){switch(t.renderingState){case Ii.FINISHED:return!1;case Ii.PAUSED:this.highestPriorityPage=t.renderingId,t.resume();break;case Ii.RUNNING:this.highestPriorityPage=t.renderingId;break;case Ii.INITIAL:this.highestPriorityPage=t.renderingId,t.draw().finally(()=>{this.renderHighestPriority()}).catch(i=>{i instanceof uy||console.error("renderView:",i)});break}return!0}}var nu,Fp,dw,Bp,Up,fw,sa,gh,O0,er,ko,br,VB,NS,sk,$B,qb;class nW{constructor({eventBus:t,externalServices:i=null,docProperties:n=null}){j(this,br);j(this,nu,null);j(this,Fp,null);j(this,dw,null);j(this,Bp,null);j(this,Up,null);j(this,fw,null);j(this,sa,null);j(this,gh,null);j(this,O0,!1);j(this,er,null);j(this,ko,null);D(this,Up,t),D(this,fw,i),D(this,dw,n)}setViewer(t){D(this,gh,t)}async setDocument(t){var d;if(u(this,sa)&&await R(this,br,qb).call(this),D(this,sa,t),!t)return;const[i,n,o]=await Promise.all([t.getFieldObjects(),t.getCalculationOrderIds(),t.getJSActions()]);if(!i&&!o){await R(this,br,qb).call(this);return}if(t!==u(this,sa))return;try{D(this,er,R(this,br,$B).call(this))}catch(f){console.error("setDocument:",f),await R(this,br,qb).call(this);return}const l=u(this,Up);D(this,Bp,new AbortController);const{signal:c}=u(this,Bp);l._on("updatefromsandbox",f=>{(f==null?void 0:f.source)===window&&R(this,br,VB).call(this,f.detail)},{signal:c}),l._on("dispatcheventinsandbox",f=>{var m;(m=u(this,er))==null||m.dispatchEventInSandbox(f.detail)},{signal:c}),l._on("pagechanging",({pageNumber:f,previous:m})=>{f!==m&&(R(this,br,sk).call(this,m),R(this,br,NS).call(this,f))},{signal:c}),l._on("pagerendered",({pageNumber:f})=>{this._pageOpenPending.has(f)&&f===u(this,gh).currentPageNumber&&R(this,br,NS).call(this,f)},{signal:c}),l._on("pagesdestroy",async()=>{var f,m;await R(this,br,sk).call(this,u(this,gh).currentPageNumber),await((f=u(this,er))==null?void 0:f.dispatchEventInSandbox({id:"doc",name:"WillClose"})),(m=u(this,nu))==null||m.resolve()},{signal:c});try{const f=await u(this,dw).call(this,t);if(t!==u(this,sa))return;await u(this,er).createSandbox({objects:i,calculationOrder:n,appInfo:{platform:navigator.platform,language:navigator.language},docInfo:{...f,actions:o}}),l.dispatch("sandboxcreated",{source:this})}catch(f){console.error("setDocument:",f),await R(this,br,qb).call(this);return}await((d=u(this,er))==null?void 0:d.dispatchEventInSandbox({id:"doc",name:"Open"})),await R(this,br,NS).call(this,u(this,gh).currentPageNumber,!0),Promise.resolve().then(()=>{t===u(this,sa)&&D(this,O0,!0)})}async dispatchWillSave(){var t;return(t=u(this,er))==null?void 0:t.dispatchEventInSandbox({id:"doc",name:"WillSave"})}async dispatchDidSave(){var t;return(t=u(this,er))==null?void 0:t.dispatchEventInSandbox({id:"doc",name:"DidSave"})}async dispatchWillPrint(){var t;if(u(this,er)){await((t=u(this,ko))==null?void 0:t.promise),D(this,ko,Promise.withResolvers());try{await u(this,er).dispatchEventInSandbox({id:"doc",name:"WillPrint"})}catch(i){throw u(this,ko).resolve(),D(this,ko,null),i}await u(this,ko).promise}}async dispatchDidPrint(){var t;return(t=u(this,er))==null?void 0:t.dispatchEventInSandbox({id:"doc",name:"DidPrint"})}get destroyPromise(){var t;return((t=u(this,Fp))==null?void 0:t.promise)||null}get ready(){return u(this,O0)}get _pageOpenPending(){return Pa(this,"_pageOpenPending",new Set)}get _visitedPages(){return Pa(this,"_visitedPages",new Map)}}nu=new WeakMap,Fp=new WeakMap,dw=new WeakMap,Bp=new WeakMap,Up=new WeakMap,fw=new WeakMap,sa=new WeakMap,gh=new WeakMap,O0=new WeakMap,er=new WeakMap,ko=new WeakMap,br=new WeakSet,VB=async function(t){var m,b;const i=u(this,gh),n=i.isInPresentationMode||i.isChangingPresentationMode,{id:o,siblings:l,command:c,value:d}=t;if(!o){switch(c){case"clear":console.clear();break;case"error":console.error(d);break;case"layout":if(!n){const T=OF(d);i.spreadMode=T.spreadMode}break;case"page-num":i.currentPageNumber=d+1;break;case"print":await i.pagesPromise,u(this,Up).dispatch("print",{source:this});break;case"println":console.log(d);break;case"zoom":n||(i.currentScaleValue=d);break;case"SaveAs":u(this,Up).dispatch("download",{source:this});break;case"FirstPage":i.currentPageNumber=1;break;case"LastPage":i.currentPageNumber=i.pagesCount;break;case"NextPage":i.nextPage();break;case"PrevPage":i.previousPage();break;case"ZoomViewIn":n||i.increaseScale();break;case"ZoomViewOut":n||i.decreaseScale();break;case"WillPrintFinished":(m=u(this,ko))==null||m.resolve(),D(this,ko,null);break}return}if(n&&t.focus)return;delete t.id,delete t.siblings;const f=l?[o,...l]:[o];for(const T of f){const C=document.querySelector(`[data-element-id="${T}"]`);C?C.dispatchEvent(new CustomEvent("updatefromsandbox",{detail:t})):(b=u(this,sa))==null||b.annotationStorage.setValue(T,t)}},NS=async function(t,i=!1){const n=u(this,sa),o=this._visitedPages;if(i&&D(this,nu,Promise.withResolvers()),!u(this,nu))return;const l=u(this,gh).getPageView(t-1);if((l==null?void 0:l.renderingState)!==Ii.FINISHED){this._pageOpenPending.add(t);return}this._pageOpenPending.delete(t);const c=(async()=>{var f,m;const d=await(o.has(t)?null:(f=l.pdfPage)==null?void 0:f.getJSActions());n===u(this,sa)&&await((m=u(this,er))==null?void 0:m.dispatchEventInSandbox({id:"page",name:"PageOpen",pageNumber:t,actions:d}))})();o.set(t,c)},sk=async function(t){var l;const i=u(this,sa),n=this._visitedPages;if(!u(this,nu)||this._pageOpenPending.has(t))return;const o=n.get(t);o&&(n.set(t,null),await o,i===u(this,sa)&&await((l=u(this,er))==null?void 0:l.dispatchEventInSandbox({id:"page",name:"PageClose",pageNumber:t})))},$B=function(){if(D(this,Fp,Promise.withResolvers()),u(this,er))throw new Error("#initScripting: Scripting already exists.");return u(this,fw).createScripting()},qb=async function(){var t,i,n,o;if(!u(this,er)){D(this,sa,null),(t=u(this,Fp))==null||t.resolve();return}u(this,nu)&&(await Promise.race([u(this,nu).promise,new Promise(l=>{setTimeout(l,1e3)})]).catch(()=>{}),D(this,nu,null)),D(this,sa,null);try{await u(this,er).destroySandbox()}catch{}(i=u(this,ko))==null||i.reject(new Error("Scripting destroyed.")),D(this,ko,null),(n=u(this,Bp))==null||n.abort(),D(this,Bp,null),this._pageOpenPending.clear(),this._visitedPages.clear(),D(this,er,null),D(this,O0,!1),(o=u(this,Fp))==null||o.resolve()};const rW="--sidebar-width",GR=200,zE="sidebarResizing",XR="pdfSidebarNotification";var pw,jp,gw,od,dn,em,zB,nk,WB,RS,qB,rk;class aW{constructor({elements:t,eventBus:i,l10n:n}){j(this,dn);j(this,pw,!1);j(this,jp,null);j(this,gw,null);j(this,od,null);this.isOpen=!1,this.active=Ni.THUMBS,this.isInitialViewSet=!1,this.isInitialEventDispatched=!1,this.onToggled=null,this.onUpdateThumbnails=null,this.outerContainer=t.outerContainer,this.sidebarContainer=t.sidebarContainer,this.toggleButton=t.toggleButton,this.resizer=t.resizer,this.thumbnailButton=t.thumbnailButton,this.outlineButton=t.outlineButton,this.attachmentsButton=t.attachmentsButton,this.layersButton=t.layersButton,this.thumbnailView=t.thumbnailView,this.outlineView=t.outlineView,this.attachmentsView=t.attachmentsView,this.layersView=t.layersView,this._currentOutlineItemButton=t.currentOutlineItemButton,this.eventBus=i,D(this,pw,n.getDirection()==="rtl"),R(this,dn,WB).call(this)}reset(){this.isInitialViewSet=!1,this.isInitialEventDispatched=!1,R(this,dn,nk).call(this,!0),this.switchView(Ni.THUMBS),this.outlineButton.disabled=!1,this.attachmentsButton.disabled=!1,this.layersButton.disabled=!1,this._currentOutlineItemButton.disabled=!0}get visibleView(){return this.isOpen?this.active:Ni.NONE}setInitialView(t=Ni.NONE){if(!this.isInitialViewSet){if(this.isInitialViewSet=!0,t===Ni.NONE||t===Ni.UNKNOWN){R(this,dn,em).call(this);return}this.switchView(t,!0),this.isInitialEventDispatched||R(this,dn,em).call(this)}}switchView(t,i=!1){const n=t!==this.active;let o=!1;switch(t){case Ni.NONE:this.isOpen&&this.close();return;case Ni.THUMBS:this.isOpen&&n&&(o=!0);break;case Ni.OUTLINE:if(this.outlineButton.disabled)return;break;case Ni.ATTACHMENTS:if(this.attachmentsButton.disabled)return;break;case Ni.LAYERS:if(this.layersButton.disabled)return;break;default:console.error(`PDFSidebar.switchView: "${t}" is not a valid view.`);return}if(this.active=t,no(this.thumbnailButton,t===Ni.THUMBS,this.thumbnailView),no(this.outlineButton,t===Ni.OUTLINE,this.outlineView),no(this.attachmentsButton,t===Ni.ATTACHMENTS,this.attachmentsView),no(this.layersButton,t===Ni.LAYERS,this.layersView),i&&!this.isOpen){this.open();return}o&&(this.onUpdateThumbnails(),this.onToggled()),n&&R(this,dn,em).call(this)}open(){this.isOpen||(this.isOpen=!0,bl(this.toggleButton,!0),this.outerContainer.classList.add("sidebarMoving","sidebarOpen"),this.active===Ni.THUMBS&&this.onUpdateThumbnails(),this.onToggled(),R(this,dn,em).call(this),R(this,dn,nk).call(this))}close(t=null){this.isOpen&&(this.isOpen=!1,bl(this.toggleButton,!1),this.outerContainer.classList.add("sidebarMoving"),this.outerContainer.classList.remove("sidebarOpen"),this.onToggled(),R(this,dn,em).call(this),(t==null?void 0:t.detail)>0&&this.toggleButton.blur())}toggle(t=null){this.isOpen?this.close(t):this.open()}get outerContainerWidth(){return u(this,gw)||D(this,gw,this.outerContainer.clientWidth)}}pw=new WeakMap,jp=new WeakMap,gw=new WeakMap,od=new WeakMap,dn=new WeakSet,em=function(){this.isInitialViewSet&&(this.isInitialEventDispatched||(this.isInitialEventDispatched=!0)),this.eventBus.dispatch("sidebarviewchanged",{source:this,view:this.visibleView})},zB=function(){this.toggleButton.setAttribute("data-l10n-id","pdfjs-toggle-sidebar-notification-button"),this.isOpen||this.toggleButton.classList.add(XR)},nk=function(t=!1){(this.isOpen||t)&&this.toggleButton.classList.remove(XR),t&&this.toggleButton.setAttribute("data-l10n-id","pdfjs-toggle-sidebar-button")},WB=function(){const{eventBus:t,outerContainer:i}=this;this.sidebarContainer.addEventListener("transitionend",o=>{o.target===this.sidebarContainer&&(i.classList.remove("sidebarMoving"),t.dispatch("resize",{source:this}))}),this.toggleButton.addEventListener("click",o=>{this.toggle(o)}),this.thumbnailButton.addEventListener("click",()=>{this.switchView(Ni.THUMBS)}),this.outlineButton.addEventListener("click",()=>{this.switchView(Ni.OUTLINE)}),this.outlineButton.addEventListener("dblclick",()=>{t.dispatch("toggleoutlinetree",{source:this})}),this.attachmentsButton.addEventListener("click",()=>{this.switchView(Ni.ATTACHMENTS)}),this.layersButton.addEventListener("click",()=>{this.switchView(Ni.LAYERS)}),this.layersButton.addEventListener("dblclick",()=>{t.dispatch("resetlayers",{source:this})}),this._currentOutlineItemButton.addEventListener("click",()=>{t.dispatch("currentoutlineitem",{source:this})});const n=(o,l,c)=>{l.disabled=!o,o?R(this,dn,zB).call(this):this.active===c&&this.switchView(Ni.THUMBS)};t._on("outlineloaded",o=>{n(o.outlineCount,this.outlineButton,Ni.OUTLINE),o.currentOutlineItemPromise.then(l=>{this.isInitialViewSet&&(this._currentOutlineItemButton.disabled=!l)})}),t._on("attachmentsloaded",o=>{n(o.attachmentsCount,this.attachmentsButton,Ni.ATTACHMENTS)}),t._on("layersloaded",o=>{n(o.layersCount,this.layersButton,Ni.LAYERS)}),t._on("presentationmodechanged",o=>{o.state===tr.NORMAL&&this.visibleView===Ni.THUMBS&&this.onUpdateThumbnails()}),this.resizer.addEventListener("mousedown",o=>{if(o.button!==0)return;i.classList.add(zE),D(this,jp,new AbortController);const l={signal:u(this,jp).signal};window.addEventListener("mousemove",R(this,dn,qB).bind(this),l),window.addEventListener("mouseup",R(this,dn,rk).bind(this),l),window.addEventListener("blur",R(this,dn,rk).bind(this),l)}),t._on("resize",o=>{if(o.source!==window||(D(this,gw,null),!u(this,od)))return;if(!this.isOpen){R(this,dn,RS).call(this,u(this,od));return}i.classList.add(zE);const l=R(this,dn,RS).call(this,u(this,od));Promise.resolve().then(()=>{i.classList.remove(zE),l&&t.dispatch("resize",{source:this})})})},RS=function(t=0){const i=Math.floor(this.outerContainerWidth/2);return t>i&&(t=i),t<GR&&(t=GR),t===u(this,od)?!1:(D(this,od,t),lP.setProperty(rW,`${t}px`),!0)},qB=function(t){let i=t.clientX;u(this,pw)&&(i=this.outerContainerWidth-i),R(this,dn,RS).call(this,i)},rk=function(t){var i;this.outerContainer.classList.remove(zE),this.eventBus.dispatch("resize",{source:this}),(i=u(this,jp))==null||i.abort(),D(this,jp,null)};const KR=2,YR=3,oW=98;function MS(g){g.width=0,g.height=0}var Hp;class hP{static getCanvas(t,i){const n=u(this,Hp)||D(this,Hp,document.createElement("canvas"));n.width=t,n.height=i;const o=n.getContext("2d",{alpha:!1});return o.save(),o.fillStyle="rgb(255, 255, 255)",o.fillRect(0,0,t,i),o.restore(),[n,n.getContext("2d")]}static destroyCanvas(){u(this,Hp)&&MS(u(this,Hp)),D(this,Hp,null)}}Hp=new WeakMap,j(hP,Hp,null);var zn,ak,ok,lk,GB,XB,Gb;class lW{constructor({container:t,eventBus:i,id:n,defaultViewport:o,optionalContentConfigPromise:l,linkService:c,renderingQueue:d,maxCanvasPixels:f,maxCanvasDim:m,pageColors:b,enableHWA:T}){j(this,zn);this.id=n,this.renderingId="thumbnail"+n,this.pageLabel=null,this.pdfPage=null,this.rotation=0,this.viewport=o,this.pdfPageRotate=o.rotation,this._optionalContentConfigPromise=l||null,this.maxCanvasPixels=f??Nt.get("maxCanvasPixels"),this.maxCanvasDim=m||Nt.get("maxCanvasDim"),this.pageColors=b||null,this.enableHWA=T||!1,this.eventBus=i,this.linkService=c,this.renderingQueue=d,this.renderTask=null,this.renderingState=Ii.INITIAL,this.resume=null;const C=document.createElement("a");C.href=c.getAnchorUrl("#page="+n),C.setAttribute("data-l10n-id","pdfjs-thumb-page-title"),C.setAttribute("data-l10n-args",u(this,zn,Gb)),C.onclick=function(){return c.goToPage(n),!1},this.anchor=C;const P=document.createElement("div");P.className="thumbnail",P.setAttribute("data-page-number",this.id),this.div=P,R(this,zn,ak).call(this);const x=document.createElement("div");x.className="thumbnailImage",this._placeholderImg=x,P.append(x),C.append(P),t.append(C)}setPdfPage(t){this.pdfPage=t,this.pdfPageRotate=t.rotate;const i=(this.rotation+this.pdfPageRotate)%360;this.viewport=t.getViewport({scale:1,rotation:i}),this.reset()}reset(){var t;this.cancelRendering(),this.renderingState=Ii.INITIAL,this.div.removeAttribute("data-loaded"),(t=this.image)==null||t.replaceWith(this._placeholderImg),R(this,zn,ak).call(this),this.image&&(this.image.removeAttribute("src"),delete this.image)}update({rotation:t=null}){typeof t=="number"&&(this.rotation=t);const i=(this.rotation+this.pdfPageRotate)%360;this.viewport=this.viewport.clone({scale:1,rotation:i}),this.reset()}cancelRendering(){this.renderTask&&(this.renderTask.cancel(),this.renderTask=null),this.resume=null}async draw(){if(this.renderingState!==Ii.INITIAL){console.error("Must be in new state before drawing");return}const{pageColors:t,pdfPage:i}=this;if(!i)throw this.renderingState=Ii.FINISHED,new Error("pdfPage is not loaded");this.renderingState=Ii.RUNNING;const{ctx:n,canvas:o,transform:l}=R(this,zn,ok).call(this,KR),c=this.viewport.clone({scale:KR*this.scale}),d=T=>{if(!this.renderingQueue.isHighestPriority(this)){this.renderingState=Ii.PAUSED,this.resume=()=>{this.renderingState=Ii.RUNNING,T()};return}T()},f={canvasContext:n,transform:l,viewport:c,optionalContentConfigPromise:this._optionalContentConfigPromise,pageColors:t},m=this.renderTask=i.render(f);m.onContinue=d;let b=null;try{await m.promise}catch(T){if(T instanceof uy){MS(o);return}b=T}finally{m===this.renderTask&&(this.renderTask=null)}if(this.renderingState=Ii.FINISHED,R(this,zn,lk).call(this,o),MS(o),this.eventBus.dispatch("thumbnailrendered",{source:this,pageNumber:this.id,pdfPage:i}),b)throw b}setImage(t){if(this.renderingState!==Ii.INITIAL)return;const{thumbnailCanvas:i,pdfPage:n,scale:o}=t;i&&(this.pdfPage||this.setPdfPage(n),!(o<this.scale)&&(this.renderingState=Ii.FINISHED,R(this,zn,lk).call(this,i)))}setPageLabel(t){var i;this.pageLabel=typeof t=="string"?t:null,this.anchor.setAttribute("data-l10n-args",u(this,zn,Gb)),this.renderingState===Ii.FINISHED&&((i=this.image)==null||i.setAttribute("data-l10n-args",u(this,zn,Gb)))}}zn=new WeakSet,ak=function(){const{width:t,height:i}=this.viewport,n=t/i;this.canvasWidth=oW,this.canvasHeight=this.canvasWidth/n|0,this.scale=this.canvasWidth/t;const{style:o}=this.div;o.setProperty("--thumbnail-width",`${this.canvasWidth}px`),o.setProperty("--thumbnail-height",`${this.canvasHeight}px`)},ok=function(t=1,i=this.enableHWA){const n=document.createElement("canvas"),o=n.getContext("2d",{alpha:!1,willReadFrequently:!i}),l=new sg,c=t*this.canvasWidth,d=t*this.canvasHeight;l.limitCanvas(c,d,this.maxCanvasPixels,this.maxCanvasDim),n.width=c*l.sx|0,n.height=d*l.sy|0;const f=l.scaled?[l.sx,0,0,l.sy,0,0]:null;return{ctx:o,canvas:n,transform:f}},lk=function(t){if(this.renderingState!==Ii.FINISHED)throw new Error("#convertCanvasToImage: Rendering has not finished.");const i=R(this,zn,XB).call(this,t),n=document.createElement("img");n.className="thumbnailImage",n.setAttribute("data-l10n-id","pdfjs-thumb-page-canvas"),n.setAttribute("data-l10n-args",u(this,zn,Gb)),n.src=i.toDataURL(),this.image=n,this.div.setAttribute("data-loaded",!0),this._placeholderImg.replaceWith(n),MS(i)},GB=function(t){const i=t.width<<YR,n=t.height<<YR,o=new sg;return o.sx=o.sy=1,o.limitCanvas(i,n,this.maxCanvasPixels,this.maxCanvasDim),[i*o.sx|0,n*o.sy|0]},XB=function(t){const{ctx:i,canvas:n}=R(this,zn,ok).call(this,1,!0);if(t.width<=2*n.width)return i.drawImage(t,0,0,t.width,t.height,0,0,n.width,n.height),n;let[o,l]=R(this,zn,GB).call(this,n);const[c,d]=hP.getCanvas(o,l);for(;o>t.width||l>t.height;)o>>=1,l>>=1;for(d.drawImage(t,0,0,t.width,t.height,0,0,o,l);o>2*n.width;)d.drawImage(c,0,0,o,l,0,0,o>>1,l>>1),o>>=1,l>>=1;return i.drawImage(c,0,0,o,l,0,0,n.width,n.height),n},Gb=function(){return JSON.stringify({page:this.pageLabel??this.id})};const uW=-19,WA="selected";var zr,KB,uk,hk,YB,ZB,QB;class hW{constructor({container:t,eventBus:i,linkService:n,renderingQueue:o,maxCanvasPixels:l,maxCanvasDim:c,pageColors:d,abortSignal:f,enableHWA:m}){j(this,zr);this.container=t,this.eventBus=i,this.linkService=n,this.renderingQueue=o,this.maxCanvasPixels=l,this.maxCanvasDim=c,this.pageColors=d||null,this.enableHWA=m||!1,this.scroll=IF(this.container,R(this,zr,KB).bind(this),f),R(this,zr,hk).call(this)}getThumbnail(t){return this._thumbnails[t]}scrollThumbnailIntoView(t){if(!this.pdfDocument)return;const i=this._thumbnails[t-1];if(!i){console.error('scrollThumbnailIntoView: Invalid "pageNumber" parameter.');return}t!==this._currentPageNumber&&(this._thumbnails[this._currentPageNumber-1].div.classList.remove(WA),i.div.classList.add(WA));const{first:n,last:o,views:l}=R(this,zr,uk).call(this);if(l.length>0){let c=!1;if(t<=n.id||t>=o.id)c=!0;else for(const{id:d,percent:f}of l)if(d===t){c=f<100;break}c&&oP(i.div,{top:uW})}this._currentPageNumber=t}get pagesRotation(){return this._pagesRotation}set pagesRotation(t){if(!Ix(t))throw new Error("Invalid thumbnails rotation angle.");if(!this.pdfDocument||this._pagesRotation===t)return;this._pagesRotation=t;const i={rotation:t};for(const n of this._thumbnails)n.update(i)}cleanup(){for(const t of this._thumbnails)t.renderingState!==Ii.FINISHED&&t.reset();hP.destroyCanvas()}setDocument(t){if(this.pdfDocument&&(R(this,zr,YB).call(this),R(this,zr,hk).call(this)),this.pdfDocument=t,!t)return;const i=t.getPage(1),n=t.getOptionalContentConfig({intent:"display"});i.then(o=>{var f;const l=t.numPages,c=o.getViewport({scale:1});for(let m=1;m<=l;++m){const b=new lW({container:this.container,eventBus:this.eventBus,id:m,defaultViewport:c.clone(),optionalContentConfigPromise:n,linkService:this.linkService,renderingQueue:this.renderingQueue,maxCanvasPixels:this.maxCanvasPixels,maxCanvasDim:this.maxCanvasDim,pageColors:this.pageColors,enableHWA:this.enableHWA});this._thumbnails.push(b)}(f=this._thumbnails[0])==null||f.setPdfPage(o),this._thumbnails[this._currentPageNumber-1].div.classList.add(WA)}).catch(o=>{console.error("Unable to initialize thumbnail viewer",o)})}setPageLabels(t){var i;if(this.pdfDocument){t?Array.isArray(t)&&this.pdfDocument.numPages===t.length?this._pageLabels=t:(this._pageLabels=null,console.error("PDFThumbnailViewer_setPageLabels: Invalid page labels.")):this._pageLabels=null;for(let n=0,o=this._thumbnails.length;n<o;n++)this._thumbnails[n].setPageLabel(((i=this._pageLabels)==null?void 0:i[n])??null)}}forceRendering(){const t=R(this,zr,uk).call(this),i=R(this,zr,QB).call(this,t),n=this.renderingQueue.getHighestPriority(t,this._thumbnails,i,!1,!0);return n?(R(this,zr,ZB).call(this,n).then(()=>{this.renderingQueue.renderView(n)}),!0):!1}}zr=new WeakSet,KB=function(){this.renderingQueue.renderHighestPriority()},uk=function(){return LF({scrollEl:this.container,views:this._thumbnails})},hk=function(){this._thumbnails=[],this._currentPageNumber=1,this._pageLabels=null,this._pagesRotation=0,this.container.textContent=""},YB=function(){for(const t of this._thumbnails)t.cancelRendering()},ZB=async function(t){if(t.pdfPage)return t.pdfPage;try{const i=await this.pdfDocument.getPage(t.id);return t.pdfPage||t.setPdfPage(i),i}catch(i){return console.error("Unable to get page for thumb view",i),null}},QB=function(t){var i,n;return((i=t.first)==null?void 0:i.id)===1?!0:((n=t.last)==null?void 0:n.id)===this._thumbnails.length?!1:this.scroll.down};var mw,_w,bw,yw,vw,F0;class cW{constructor(t){j(this,mw,null);j(this,_w,null);j(this,bw,null);j(this,yw,null);j(this,vw,null);j(this,F0);this.pdfPage=t.pdfPage,this.accessibilityManager=t.accessibilityManager,this.l10n=t.l10n,this.l10n||(this.l10n=new u_),this.annotationEditorLayer=null,this.div=null,this._cancelled=!1,D(this,F0,t.uiManager),D(this,mw,t.annotationLayer||null),D(this,vw,t.textLayer||null),D(this,_w,t.drawLayer||null),D(this,bw,t.onAppend||null),D(this,yw,t.structTreeLayer||null)}async render({viewport:t,intent:i="display"}){var c;if(i!=="display"||this._cancelled)return;const n=t.clone({dontFlip:!0});if(this.div){this.annotationEditorLayer.update({viewport:n}),this.show();return}const o=this.div=document.createElement("div");o.className="annotationEditorLayer",o.hidden=!0,o.dir=u(this,F0).direction,(c=u(this,bw))==null||c.call(this,o),this.annotationEditorLayer=new kz({uiManager:u(this,F0),div:o,structTreeLayer:u(this,yw),accessibilityManager:this.accessibilityManager,pageIndex:this.pdfPage.pageNumber-1,l10n:this.l10n,viewport:n,annotationLayer:u(this,mw),textLayer:u(this,vw),drawLayer:u(this,_w)});const l={viewport:n,div:o,annotations:null,intent:i};this.annotationEditorLayer.render(l),this.show()}cancel(){this._cancelled=!0,this.div&&this.annotationEditorLayer.destroy()}hide(){this.div&&(this.annotationEditorLayer.pause(!0),this.div.hidden=!0)}show(){!this.div||this.annotationEditorLayer.isInvisible||(this.div.hidden=!1,this.annotationEditorLayer.pause(!1))}}mw=new WeakMap,_w=new WeakMap,bw=new WeakMap,yw=new WeakMap,vw=new WeakMap,F0=new WeakMap;var ld,ww,Tw,ud,Ew,mu,ck,dk,JB;class dW{constructor({pdfPage:t,linkService:i,downloadManager:n,annotationStorage:o=null,imageResourcesPath:l="",renderForms:c=!0,enableScripting:d=!1,hasJSActionsPromise:f=null,fieldObjectsPromise:m=null,annotationCanvasMap:b=null,accessibilityManager:T=null,annotationEditorUIManager:C=null,onAppend:P=null}){j(this,mu);j(this,ld,null);j(this,ww,!1);j(this,Tw,null);j(this,ud,null);j(this,Ew,!1);this.pdfPage=t,this.linkService=i,this.downloadManager=n,this.imageResourcesPath=l,this.renderForms=c,this.annotationStorage=o,this.enableScripting=d,this._hasJSActionsPromise=f||Promise.resolve(!1),this._fieldObjectsPromise=m||Promise.resolve(null),this._annotationCanvasMap=b,this._accessibilityManager=T,this._annotationEditorUIManager=C,D(this,Tw,P),this.annotationLayer=null,this.div=null,this._cancelled=!1,this._eventBus=i.eventBus}async render({viewport:t,intent:i="display",structTreeLayer:n=null}){var f,m;if(this.div){if(this._cancelled||!this.annotationLayer)return;this.annotationLayer.update({viewport:t.clone({dontFlip:!0})});return}const[o,l,c]=await Promise.all([this.pdfPage.getAnnotations({intent:i}),this._hasJSActionsPromise,this._fieldObjectsPromise]);if(this._cancelled)return;const d=this.div=document.createElement("div");if(d.className="annotationLayer",(f=u(this,Tw))==null||f.call(this,d),o.length===0){D(this,ld,o),this.hide(!0);return}R(this,mu,ck).call(this,t,n),await this.annotationLayer.render({annotations:o,imageResourcesPath:this.imageResourcesPath,renderForms:this.renderForms,linkService:this.linkService,downloadManager:this.downloadManager,annotationStorage:this.annotationStorage,enableScripting:this.enableScripting,hasJSActions:l,fieldObjects:c}),D(this,ld,o),this.linkService.isInPresentationMode&&R(this,mu,dk).call(this,tr.FULLSCREEN),u(this,ud)||(D(this,ud,new AbortController),(m=this._eventBus)==null||m._on("presentationmodechanged",b=>{R(this,mu,dk).call(this,b.state)},{signal:u(this,ud).signal}))}cancel(){var t;this._cancelled=!0,(t=u(this,ud))==null||t.abort(),D(this,ud,null)}hide(t=!1){D(this,ww,!t),this.div&&(this.div.hidden=!0)}hasEditableAnnotations(){var t;return!!((t=this.annotationLayer)!=null&&t.hasEditableAnnotations())}async injectLinkAnnotations({inferredLinks:t,viewport:i,structTreeLayer:n=null}){if(u(this,ld)===null)throw new Error("`render` method must be called before `injectLinkAnnotations`.");if(this._cancelled||u(this,Ew))return;D(this,Ew,!0);const o=u(this,ld).length?R(this,mu,JB).call(this,t):t;o.length&&(this.annotationLayer||(R(this,mu,ck).call(this,i,n),kF(this.div,i)),await this.annotationLayer.addLinkAnnotations(o,this.linkService),u(this,ww)||(this.div.hidden=!1))}}ld=new WeakMap,ww=new WeakMap,Tw=new WeakMap,ud=new WeakMap,Ew=new WeakMap,mu=new WeakSet,ck=function(t,i){this.annotationLayer=new Dz({div:this.div,accessibilityManager:this._accessibilityManager,annotationCanvasMap:this._annotationCanvasMap,annotationEditorUIManager:this._annotationEditorUIManager,page:this.pdfPage,viewport:t.clone({dontFlip:!0}),structTreeLayer:i})},dk=function(t){if(!this.div)return;let i=!1;switch(t){case tr.FULLSCREEN:i=!0;break;case tr.NORMAL:break;default:return}for(const n of this.div.childNodes)n.hasAttribute("data-internal-link")||(n.inert=i)},JB=function(t){function i(l){if(!l.quadPoints)return[l.rect];const c=[];for(let d=2,f=l.quadPoints.length;d<f;d+=8){const m=l.quadPoints[d],b=l.quadPoints[d+1],T=l.quadPoints[d+2],C=l.quadPoints[d+3];c.push([T,C,m,b])}return c}function n(l,c){const d=[],f=i(l),m=i(c);for(const b of f)for(const T of m){const C=rP.intersect(b,T);C&&d.push(C)}return d}function o(l){let c=0;for(const d of l)c+=Math.abs((d[2]-d[0])*(d[3]-d[1]));return c}return t.filter(l=>{let c;for(const d of u(this,ld)){if(d.annotationType!==xF.LINK||!d.url)continue;const f=n(d,l);if(f.length!==0&&(c??(c=o(i(l))),o(f)/c>.5))return!1}return!0})};function ZR({width:g,height:t,left:i,top:n},o){if(g===0||t===0)return null;const l=o.textLayer.div.getBoundingClientRect(),c=o.getPagePoint(i-l.left,n-l.top),d=o.getPagePoint(i-l.left+g,n-l.top+t);return rP.normalizeRect([c[0],c[1],d[0],d[1]])}function fW(g,t){const i=g.getClientRects();if(i.length===1)return{rect:ZR(i[0],t)};const n=[1/0,1/0,-1/0,-1/0],o=[];let l=0;for(const c of i){const d=ZR(c,t);d!==null&&(o[l]=o[l+4]=d[0],o[l+1]=o[l+3]=d[3],o[l+2]=o[l+6]=d[2],o[l+5]=o[l+7]=d[1],rP.rectBoundingBox(...d,n),l+=8)}return{quadPoints:o,rect:n}}function QR(g,t){let i=g;do{if(i.nodeType===Node.TEXT_NODE){const n=i.textContent.length;if(t<=n)return[i,t];t-=n}else if(i.firstChild){i=i.firstChild;continue}for(;!i.nextSibling&&i!==g;)i=i.parentNode;i!==g&&(i=i.nextSibling)}while(i!==g);throw new Error("Offset is bigger than container's contents length.")}function pW({url:g,index:t,length:i},n,o){const l=n._textHighlighter,[{begin:c,end:d}]=l._convertMatches([t],[i]),f=new Range;return f.setStart(...QR(l.textDivs[c.divIdx],c.offset)),f.setEnd(...QR(l.textDivs[d.divIdx],d.offset)),{id:`inferred_link_${o}`,unsafeUrl:g,url:g,annotationType:xF.LINK,rotation:0,...fW(f,n),borderStyle:null}}var vx,Sw;class fk{static findLinks(t){u(this,Sw)??D(this,Sw,new RegExp("\\b(?:https?:\\/\\/|mailto:|www\\.)(?:[\\S--[\\p{P}<>]]|\\/|[\\S--[\\[\\]]]+[\\S--[\\p{P}<>]])+|\\b[\\S--[@\\p{Ps}\\p{Pe}<>]]+@([\\S--[\\p{P}<>]]+(?:\\.[\\S--[\\p{P}<>]]+)+)","gmv"));const[i,n]=CS(t),o=i.matchAll(u(this,Sw)),l=[];for(const c of o){const[d,f]=c;let m;if(d.startsWith("www.")||d.startsWith("http://")||d.startsWith("https://"))m=d;else if(URL.canParse(`http://${f}`))m=d.startsWith("mailto:")?d:`mailto:${d}`;else continue;const b=AF(m,null,{addDefaultProtocol:!0});if(b){const[T,C]=gB(n,c.index,d.length);l.push({url:b.href,index:T,length:C})}}return l}static processLinks(t){return this.findLinks(t._textHighlighter.textContentItemsStr.join(`
`)).map(i=>pW(i,t,Yn(this,vx)._++))}}vx=new WeakMap,Sw=new WeakMap,j(fk,vx,0),j(fk,Sw);var Vp,hd,B0,U0,j0,mh,cd,_h,wx,xw,pk;class e3{constructor(t){j(this,xw);j(this,Vp,!1);j(this,hd,null);j(this,B0,0);j(this,U0,null);j(this,j0,Ii.INITIAL);j(this,mh,null);j(this,cd,0);j(this,_h,null);St(this,"canvas",null);St(this,"div",null);St(this,"eventBus",null);St(this,"id",null);St(this,"pageColors",null);St(this,"renderingQueue",null);St(this,"renderTask",null);St(this,"resume",null);j(this,wx,t=>{var i;if((i=u(this,mh))==null||i.call(this,!1),this.renderingQueue&&!this.renderingQueue.isHighestPriority(this)){this.renderingState=Ii.PAUSED,this.resume=()=>{this.renderingState=Ii.RUNNING,t()};return}t()});D(this,Vp,$N(Vp,t)?u(t,Vp):t.enableHWA||!1),this.eventBus=t.eventBus,this.id=t.id,this.pageColors=t.pageColors||null,this.renderingQueue=t.renderingQueue,D(this,B0,t.minDurationToUpdateCanvas??500)}get renderingState(){return u(this,j0)}set renderingState(t){var i;if(t!==u(this,j0))switch(D(this,j0,t),u(this,hd)&&(clearTimeout(u(this,hd)),D(this,hd,null)),t){case Ii.PAUSED:this.div.classList.remove("loading"),D(this,cd,0),(i=u(this,mh))==null||i.call(this,!1);break;case Ii.RUNNING:this.div.classList.add("loadingIcon"),D(this,hd,setTimeout(()=>{this.div.classList.add("loading"),D(this,hd,null)},0)),D(this,cd,Date.now());break;case Ii.INITIAL:case Ii.FINISHED:this.div.classList.remove("loadingIcon","loading"),D(this,cd,0);break}}_createCanvas(t,i=!1){const{pageColors:n}=this,o=!!(n!=null&&n.background&&(n!=null&&n.foreground)),l=this.canvas,c=!l&&!o&&!i;let d=this.canvas=document.createElement("canvas");D(this,mh,m=>{if(c){let b=u(this,_h);if(!m&&u(this,B0)>0){if(Date.now()-u(this,cd)<u(this,B0))return;b||(b=D(this,_h,d),d=this.canvas=d.cloneNode(!1),t(d))}if(b){d.getContext("2d",{alpha:!1}).drawImage(b,0,0),m?R(this,xw,pk).call(this):D(this,cd,Date.now());return}t(d),D(this,mh,null);return}m&&(l?(l.replaceWith(d),l.width=l.height=0):t(d))});const f=d.getContext("2d",{alpha:!1,willReadFrequently:!u(this,Vp)});return{canvas:d,prevCanvas:l,ctx:f}}_resetCanvas(){const{canvas:t}=this;t&&(t.remove(),t.width=t.height=0,this.canvas=null,R(this,xw,pk).call(this))}async _drawCanvas(t,i,n){var c,d;const o=this.renderTask=this.pdfPage.render(t);o.onContinue=u(this,wx),o.onError=f=>{f instanceof uy&&(i(),D(this,U0,null))};let l=null;try{await o.promise,(c=u(this,mh))==null||c.call(this,!0)}catch(f){if(f instanceof uy)return;l=f,(d=u(this,mh))==null||d.call(this,!0)}finally{D(this,U0,l),o===this.renderTask&&(this.renderTask=null)}if(this.renderingState=Ii.FINISHED,n(o),l)throw l}cancelRendering({cancelExtraDelay:t=0}={}){this.renderTask&&(this.renderTask.cancel(t),this.renderTask=null),this.resume=null}dispatchPageRender(){this.eventBus.dispatch("pagerender",{source:this,pageNumber:this.id})}dispatchPageRendered(t,i){this.eventBus.dispatch("pagerendered",{source:this,pageNumber:this.id,cssTransform:t,isDetailView:i,timestamp:performance.now(),error:u(this,U0)})}}Vp=new WeakMap,hd=new WeakMap,B0=new WeakMap,U0=new WeakMap,j0=new WeakMap,mh=new WeakMap,cd=new WeakMap,_h=new WeakMap,wx=new WeakMap,xw=new WeakSet,pk=function(){u(this,_h)&&(u(this,_h).width=u(this,_h).height=0,D(this,_h,null))};var ru;class gW{constructor(t){j(this,ru,null);this.pageIndex=t.pageIndex}async render({intent:t="display"}){t!=="display"||u(this,ru)||this._cancelled||D(this,ru,new Lz({pageIndex:this.pageIndex}))}cancel(){this._cancelled=!0,u(this,ru)&&(u(this,ru).destroy(),D(this,ru,null))}setParent(t){var i;(i=u(this,ru))==null||i.setParent(t)}getDrawLayer(){return u(this,ru)}}ru=new WeakMap;var rl,Tx,t3;class mW extends e3{constructor({pageView:i}){super(i);j(this,Tx);j(this,rl,null);St(this,"renderingCancelled",!1);this.pageView=i,this.renderingId="detail"+this.id,this.div=i.div}setPdfPage(i){this.pageView.setPdfPage(i)}get pdfPage(){return this.pageView.pdfPage}get renderingState(){return super.renderingState}set renderingState(i){this.renderingCancelled=!1,super.renderingState=i}reset({keepCanvas:i=!1}={}){const n=this.renderingCancelled||this.renderingState===Ii.RUNNING||this.renderingState===Ii.PAUSED;this.cancelRendering(),this.renderingState=Ii.INITIAL,this.renderingCancelled=n,i||this._resetCanvas()}update({visibleArea:i=null,underlyingViewUpdated:n=!1}={}){if(n){this.cancelRendering(),this.renderingState=Ii.INITIAL;return}if(!R(this,Tx,t3).call(this,i))return;const{viewport:o,maxCanvasPixels:l,capCanvasAreaFactor:c}=this.pageView,d=i.maxX-i.minX,f=i.maxY-i.minY,m=d*f*sg.pixelRatio**2,T=(Math.sqrt(sg.capPixels(l,c)/m)-1)/2;let C=Math.min(1,T);C<0&&(C=0);const P=d*C,x=f*C,L=Math.max(0,i.minX-P),F=Math.min(o.width,i.maxX+P),X=Math.max(0,i.minY-x),re=Math.min(o.height,i.maxY+x),K=F-L,te=re-X;D(this,rl,{minX:L,minY:X,width:K,height:te,scale:o.scale}),this.reset({keepCanvas:!0})}async draw(){if(this.pageView.detailView!==this)return;const i=this.pageView.renderingState===Ii.FINISHED||this.renderingState===Ii.FINISHED;this.renderingState!==Ii.INITIAL&&(console.error("Must be in new state before drawing"),this.reset());const{div:n,pdfPage:o,viewport:l}=this.pageView;if(!o)throw this.renderingState=Ii.FINISHED,new Error("pdfPage is not loaded");this.renderingState=Ii.RUNNING;const c=this.pageView._ensureCanvasWrapper(),{canvas:d,prevCanvas:f,ctx:m}=this._createCanvas(X=>{var re;((re=c.firstElementChild)==null?void 0:re.tagName)==="CANVAS"?c.firstElementChild.after(X):c.prepend(X)},i);d.setAttribute("aria-hidden","true");const{width:b,height:T}=l,C=u(this,rl),{pixelRatio:P}=sg,x=[P,0,0,P,-C.minX*P,-C.minY*P];d.width=C.width*P,d.height=C.height*P;const{style:L}=d;L.width=`${C.width*100/b}%`,L.height=`${C.height*100/T}%`,L.top=`${C.minY*100/T}%`,L.left=`${C.minX*100/b}%`;const F=this._drawCanvas(this.pageView._getRenderingContext(m,x),()=>{var X;(X=this.canvas)==null||X.remove(),this.canvas=f},()=>{this.dispatchPageRendered(!1,!0)});return n.setAttribute("data-loaded",!0),this.dispatchPageRender(),F}}rl=new WeakMap,Tx=new WeakSet,t3=function(i){if(!u(this,rl))return!0;const n=u(this,rl).minX,o=u(this,rl).minY,l=u(this,rl).width+n,c=u(this,rl).height+o;if(i.minX<n||i.minY<o||i.maxX>l||i.maxY>c)return!0;const{width:d,height:f,scale:m}=this.pageView.viewport;if(u(this,rl).scale!==m)return!0;const b=i.minX-n,T=l-i.maxX,C=i.minY-o,P=c-i.maxY,x=.5,L=(1+x)/x;return n>0&&T/b>L||l<d&&b/T>L||o>0&&P/C>L||c<f&&C/P>L};const JR={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},_W=/^H(\d+)$/;var H0,al,V0,$0,z0,dd,_u,gk,i3,mk;class bW{constructor(t,i){j(this,_u);j(this,H0);j(this,al,null);j(this,V0);j(this,$0,new Map);j(this,z0);j(this,dd,null);D(this,H0,t.getStructTree()),D(this,z0,i)}async render(){var o;if(u(this,V0))return u(this,V0);const{promise:t,resolve:i,reject:n}=Promise.withResolvers();D(this,V0,t);try{D(this,al,R(this,_u,mk).call(this,await u(this,H0)))}catch(l){n(l)}return D(this,H0,null),(o=u(this,al))==null||o.classList.add("structTree"),i(u(this,al)),t}async getAriaAttributes(t){try{return await this.render(),u(this,$0).get(t)}catch{}return null}hide(){u(this,al)&&!u(this,al).hidden&&(u(this,al).hidden=!0)}show(){var t;(t=u(this,al))!=null&&t.hidden&&(u(this,al).hidden=!1)}addElementsToTextLayer(){var t;if(u(this,dd)){for(const[i,n]of u(this,dd))(t=document.getElementById(i))==null||t.append(n);u(this,dd).clear(),D(this,dd,null)}}}H0=new WeakMap,al=new WeakMap,V0=new WeakMap,$0=new WeakMap,z0=new WeakMap,dd=new WeakMap,_u=new WeakSet,gk=function(t,i){const{alt:n,id:o,lang:l}=t;if(n!==void 0){let c=!1;const d=am(n);for(const f of t.children)if(f.type==="annotation"){let m=u(this,$0).get(f.id);m||(m=new Map,u(this,$0).set(f.id,m)),m.set("aria-label",d),c=!0}c||i.setAttribute("aria-label",d)}o!==void 0&&i.setAttribute("aria-owns",o),l!==void 0&&i.setAttribute("lang",am(l,!0))},i3=function(t,i){const{alt:n,bbox:o,children:l}=t,c=l==null?void 0:l[0];if(!u(this,z0)||!n||!o||(c==null?void 0:c.type)!=="content")return!1;const{id:d}=c;if(!d)return!1;i.setAttribute("aria-owns",d);const f=document.createElement("span");(u(this,dd)||D(this,dd,new Map)).set(d,f),f.setAttribute("role","img"),f.setAttribute("aria-label",am(n));const{pageHeight:m,pageX:b,pageY:T}=u(this,z0),C="calc(var(--total-scale-factor) *",{style:P}=f;return P.width=`${C}${o[2]-o[0]}px)`,P.height=`${C}${o[3]-o[1]}px)`,P.left=`${C}${o[0]-b}px)`,P.top=`${C}${m-o[3]+T}px)`,!0},mk=function(t){if(!t)return null;const i=document.createElement("span");if("role"in t){const{role:n}=t,o=n.match(_W);if(o?(i.setAttribute("role","heading"),i.setAttribute("aria-level",o[1])):JR[n]&&i.setAttribute("role",JR[n]),n==="Figure"&&R(this,_u,i3).call(this,t,i))return i}if(R(this,_u,gk).call(this,t,i),t.children)if(t.children.length===1&&"id"in t.children[0])R(this,_u,gk).call(this,t.children[0],i);else for(const n of t.children)i.append(R(this,_u,mk).call(this,n));return i};var bh,Po,yh,fd,W0,OS,Aw,bk;const nm=class nm{constructor(){j(this,Aw);j(this,bh,!1);j(this,Po,null);j(this,yh,new Map);j(this,fd,new Map)}setTextMapping(t){D(this,Po,t)}enable(){if(u(this,bh))throw new Error("TextAccessibilityManager is already enabled.");if(!u(this,Po))throw new Error("Text divs and strings have not been set.");if(D(this,bh,!0),D(this,Po,u(this,Po).slice()),u(this,Po).sort(R(nm,W0,OS)),u(this,yh).size>0){const t=u(this,Po);for(const[i,n]of u(this,yh)){if(!document.getElementById(i)){u(this,yh).delete(i);continue}R(this,Aw,bk).call(this,i,t[n])}}for(const[t,i]of u(this,fd))this.addPointerInTextLayer(t,i);u(this,fd).clear()}disable(){u(this,bh)&&(u(this,fd).clear(),D(this,Po,null),D(this,bh,!1))}removePointerInTextLayer(t){if(!u(this,bh)){u(this,fd).delete(t);return}const i=u(this,Po);if(!i||i.length===0)return;const{id:n}=t,o=u(this,yh).get(n);if(o===void 0)return;const l=i[o];u(this,yh).delete(n);let c=l.getAttribute("aria-owns");c!=null&&c.includes(n)&&(c=c.split(" ").filter(d=>d!==n).join(" "),c?l.setAttribute("aria-owns",c):(l.removeAttribute("aria-owns"),l.setAttribute("role","presentation")))}addPointerInTextLayer(t,i){const{id:n}=t;if(!n)return null;if(!u(this,bh))return u(this,fd).set(t,i),null;i&&this.removePointerInTextLayer(t);const o=u(this,Po);if(!o||o.length===0)return null;const l=cy(o,m=>{var b;return R(b=nm,W0,OS).call(b,t,m)<0}),c=Math.max(0,l-1),d=o[c];R(this,Aw,bk).call(this,n,d),u(this,yh).set(n,c);const f=d.parentNode;return f!=null&&f.classList.contains("markedContent")?f.id:null}moveElementInDOM(t,i,n,o){const l=this.addPointerInTextLayer(n,o);if(!t.hasChildNodes())return t.append(i),l;const c=Array.from(t.childNodes).filter(m=>m!==i);if(c.length===0)return l;const d=n||i,f=cy(c,m=>{var b;return R(b=nm,W0,OS).call(b,d,m)<0});return f===0?c[0].before(i):c[f-1].after(i),l}};bh=new WeakMap,Po=new WeakMap,yh=new WeakMap,fd=new WeakMap,W0=new WeakSet,OS=function(t,i){const n=t.getBoundingClientRect(),o=i.getBoundingClientRect();if(n.width===0&&n.height===0)return 1;if(o.width===0&&o.height===0)return-1;const l=n.y,c=n.y+n.height,d=n.y+n.height/2,f=o.y,m=o.y+o.height,b=o.y+o.height/2;if(d<=f&&b>=c)return-1;if(b<=l&&d>=m)return 1;const T=n.x+n.width/2,C=o.x+o.width/2;return T-C},Aw=new WeakSet,bk=function(t,i){const n=i.getAttribute("aria-owns");n!=null&&n.includes(t)||i.setAttribute("aria-owns",n?`${n} ${t}`:t),i.removeAttribute("role")},j(nm,W0);let _k=nm;var pd;class yW{constructor({findController:t,eventBus:i,pageIndex:n}){j(this,pd,null);this.findController=t,this.matches=[],this.eventBus=i,this.pageIdx=n,this.textDivs=null,this.textContentItemsStr=null,this.enabled=!1}setTextMapping(t,i){this.textDivs=t,this.textContentItemsStr=i}enable(){if(!this.textDivs||!this.textContentItemsStr)throw new Error("Text divs and strings have not been set.");if(this.enabled)throw new Error("TextHighlighter is already enabled.");this.enabled=!0,u(this,pd)||(D(this,pd,new AbortController),this.eventBus._on("updatetextlayermatches",t=>{(t.pageIndex===this.pageIdx||t.pageIndex===-1)&&this._updateMatches()},{signal:u(this,pd).signal})),this._updateMatches()}disable(){var t;this.enabled&&(this.enabled=!1,(t=u(this,pd))==null||t.abort(),D(this,pd,null),this._updateMatches(!0))}_convertMatches(t,i){if(!t)return[];const{textContentItemsStr:n}=this;let o=0,l=0;const c=n.length-1,d=[];for(let f=0,m=t.length;f<m;f++){let b=t[f];for(;o!==c&&b>=l+n[o].length;)l+=n[o].length,o++;o===n.length&&console.error("Could not find a matching mapping");const T={begin:{divIdx:o,offset:b-l}};for(b+=i[f];o!==c&&b>l+n[o].length;)l+=n[o].length,o++;T.end={divIdx:o,offset:b-l},d.push(T)}return d}_renderMatches(t){if(t.length===0)return;const{findController:i,pageIdx:n}=this,{textContentItemsStr:o,textDivs:l}=this,c=n===i.selected.pageIdx,d=i.selected.matchIdx,f=i.state.highlightAll;let m=null;const b={offset:void 0};function T(X,re){const K=X.divIdx;return l[K].textContent="",C(K,0,X.offset,re)}function C(X,re,K,te){let ee=l[X];if(ee.nodeType===Node.TEXT_NODE){const fe=document.createElement("span");ee.before(fe),fe.append(ee),l[X]=fe,ee=fe}const A=o[X].substring(re,K),me=document.createTextNode(A);if(te){const fe=document.createElement("span");if(fe.className=`${te} appended`,fe.append(me),ee.append(fe),te.includes("selected")){const{left:J}=fe.getClientRects()[0],ye=ee.getBoundingClientRect().left;return J-ye}return 0}return ee.append(me),0}let P=d,x=P+1;if(f)P=0,x=t.length;else if(!c)return;let L=-1,F=-1;for(let X=P;X<x;X++){const re=t[X],K=re.begin;if(K.divIdx===L&&K.offset===F)continue;L=K.divIdx,F=K.offset;const te=re.end,ee=c&&X===d,A=ee?" selected":"";let me=0;if(!m||K.divIdx!==m.divIdx?(m!==null&&C(m.divIdx,m.offset,b.offset),T(K)):C(m.divIdx,m.offset,K.offset),K.divIdx===te.divIdx)me=C(K.divIdx,K.offset,te.offset,"highlight"+A);else{me=C(K.divIdx,K.offset,b.offset,"highlight begin"+A);for(let fe=K.divIdx+1,J=te.divIdx;fe<J;fe++)l[fe].className="highlight middle"+A;T(te,"highlight end"+A)}m=te,ee&&i.scrollMatchIntoView({element:l[K.divIdx],selectedLeft:me,pageIndex:n,matchIndex:d})}m&&C(m.divIdx,m.offset,b.offset)}_updateMatches(t=!1){if(!this.enabled&&!t)return;const{findController:i,matches:n,pageIdx:o}=this,{textContentItemsStr:l,textDivs:c}=this;let d=-1;for(const b of n){const T=Math.max(d,b.begin.divIdx);for(let C=T,P=b.end.divIdx;C<=P;C++){const x=c[C];x.textContent=l[C],x.className=""}d=b.end.divIdx+1}if(!(i!=null&&i.highlightMatches)||t)return;const f=i.pageMatches[o]||null,m=i.pageMatchesLength[o]||null;this.matches=this._convertMatches(f,m),this._renderMatches(this.matches)}}pd=new WeakMap;var Cw,kw,$p,au,xa,gd,Ex,s3,c_,n3,r3;const ac=class ac{constructor({pdfPage:t,highlighter:i=null,accessibilityManager:n=null,enablePermissions:o=!1,onAppend:l=null}){j(this,Ex);j(this,Cw,!1);j(this,kw,null);j(this,$p,!1);j(this,au,null);this.pdfPage=t,this.highlighter=i,this.accessibilityManager=n,D(this,Cw,o===!0),D(this,kw,l),this.div=document.createElement("div"),this.div.tabIndex=0,this.div.className="textLayer"}async render({viewport:t,textContentParams:i=null}){var c,d,f,m,b;if(u(this,$p)&&u(this,au)){u(this,au).update({viewport:t,onBefore:this.hide.bind(this)}),this.show();return}this.cancel(),D(this,au,new Gz({textContentSource:this.pdfPage.streamTextContent(i||{includeMarkedContent:!0,disableNormalization:!0}),container:this.div,viewport:t}));const{textDivs:n,textContentItemsStr:o}=u(this,au);(c=this.highlighter)==null||c.setTextMapping(n,o),(d=this.accessibilityManager)==null||d.setTextMapping(n),await u(this,au).render(),D(this,$p,!0);const l=document.createElement("div");l.className="endOfContent",this.div.append(l),R(this,Ex,s3).call(this,l),(f=u(this,kw))==null||f.call(this,this.div),(m=this.highlighter)==null||m.enable(),(b=this.accessibilityManager)==null||b.enable()}hide(){var t;!this.div.hidden&&u(this,$p)&&((t=this.highlighter)==null||t.disable(),this.div.hidden=!0)}show(){var t;this.div.hidden&&u(this,$p)&&(this.div.hidden=!1,(t=this.highlighter)==null||t.enable())}cancel(){var t,i,n,o;(t=u(this,au))==null||t.cancel(),D(this,au,null),(i=this.highlighter)==null||i.disable(),(n=this.accessibilityManager)==null||n.disable(),R(o=ac,c_,n3).call(o,this.div)}};Cw=new WeakMap,kw=new WeakMap,$p=new WeakMap,au=new WeakMap,xa=new WeakMap,gd=new WeakMap,Ex=new WeakSet,s3=function(t){var n;const{div:i}=this;i.addEventListener("mousedown",()=>{i.classList.add("selecting")}),i.addEventListener("copy",o=>{if(!u(this,Cw)){const l=document.getSelection();o.clipboardData.setData("text/plain",am(Vz(l.toString())))}du(o)}),u(ac,xa).set(i,t),R(n=ac,c_,r3).call(n)},c_=new WeakSet,n3=function(t){var i;u(this,xa).delete(t),u(this,xa).size===0&&((i=u(this,gd))==null||i.abort(),D(this,gd,null))},r3=function(){if(u(this,gd))return;D(this,gd,new AbortController);const{signal:t}=u(this,gd),i=(c,d)=>{d.append(c),c.style.width="",c.style.height="",d.classList.remove("selecting")};let n=!1;document.addEventListener("pointerdown",()=>{n=!0},{signal:t}),document.addEventListener("pointerup",()=>{n=!1,u(this,xa).forEach(i)},{signal:t}),window.addEventListener("blur",()=>{n=!1,u(this,xa).forEach(i)},{signal:t}),document.addEventListener("keyup",()=>{n||u(this,xa).forEach(i)},{signal:t});var o,l;document.addEventListener("selectionchange",()=>{var P;const c=document.getSelection();if(c.rangeCount===0){u(this,xa).forEach(i);return}const d=new Set;for(let x=0;x<c.rangeCount;x++){const L=c.getRangeAt(x);for(const F of u(this,xa).keys())!d.has(F)&&L.intersectsNode(F)&&d.add(F)}for(const[x,L]of u(this,xa))d.has(x)?x.classList.add("selecting"):i(L,x);if(o??(o=getComputedStyle(u(this,xa).values().next().value).getPropertyValue("-moz-user-select")==="none"),o)return;const f=c.getRangeAt(0),m=l&&(f.compareBoundaryPoints(Range.END_TO_END,l)===0||f.compareBoundaryPoints(Range.START_TO_END,l)===0);let b=m?f.startContainer:f.endContainer;if(b.nodeType===Node.TEXT_NODE&&(b=b.parentNode),!m&&f.endOffset===0)do{for(;!b.previousSibling;)b=b.parentNode;b=b.previousSibling}while(!b.childNodes.length);const T=(P=b.parentElement)==null?void 0:P.closest(".textLayer"),C=u(this,xa).get(T);C&&(C.style.width=T.style.width,C.style.height=T.style.height,b.parentElement.insertBefore(C,m?b:b.nextSibling)),l=f.cloneRange()},{signal:t})},j(ac,c_),j(ac,xa,new Map),j(ac,gd,null);let yk=ac;const vW=null,wW=new Map([["canvasWrapper",0],["textLayer",1],["annotationLayer",2],["annotationEditorLayer",3],["xfaLayer",3]]);var zp,md,Pw,Dw,Iw,_d,bd,q0,Lw,Nw,Rw,G0,Mw,vh,yd,Vi,tm,FS,Xb,vk,wk,Tk,Ek,Sk,a3,o3,l3,xk;class TW extends e3{constructor(i){var c,d;super(i);j(this,Vi);j(this,zp,cu.ENABLE_FORMS);j(this,md,null);j(this,Pw,!0);j(this,Dw,!1);j(this,Iw,!1);j(this,_d,null);j(this,bd,!1);j(this,q0,null);j(this,Lw,null);j(this,Nw,1);j(this,Rw,1);j(this,G0,_l.ENABLE);j(this,Mw,1);j(this,vh,{directDrawing:!0,initialOptionalContent:!0,regularAnnotations:!0});j(this,yd,[null,null,null,null]);const n=i.container,o=i.defaultViewport;this.renderingId="page"+this.id,D(this,_d,i.layerProperties||vW),this.pdfPage=null,this.pageLabel=null,this.rotation=0,this.scale=i.scale||aP,this.viewport=o,this.pdfPageRotate=o.rotation,this._optionalContentConfigPromise=i.optionalContentConfigPromise||null,D(this,G0,i.textLayerMode??_l.ENABLE),D(this,zp,i.annotationMode??cu.ENABLE_FORMS),this.imageResourcesPath=i.imageResourcesPath||"",this.enableDetailCanvas=i.enableDetailCanvas??!0,this.maxCanvasPixels=i.maxCanvasPixels??Nt.get("maxCanvasPixels"),this.maxCanvasDim=i.maxCanvasDim||Nt.get("maxCanvasDim"),this.capCanvasAreaFactor=i.capCanvasAreaFactor??Nt.get("capCanvasAreaFactor"),D(this,Pw,i.enableAutoLinking!==!1),this.l10n=i.l10n,this.l10n||(this.l10n=new u_),this._isStandalone=!((c=this.renderingQueue)!=null&&c.hasViewer()),this._container=n,this._annotationCanvasMap=null,this.annotationLayer=null,this.annotationEditorLayer=null,this.textLayer=null,this.xfaLayer=null,this.structTreeLayer=null,this.drawLayer=null,this.detailView=null;const l=document.createElement("div");if(l.className="page",l.setAttribute("data-page-number",this.id),l.setAttribute("role","region"),l.setAttribute("data-l10n-id","pdfjs-page-landmark"),l.setAttribute("data-l10n-args",JSON.stringify({page:this.id})),this.div=l,R(this,Vi,FS).call(this),n==null||n.append(l),this._isStandalone){n==null||n.style.setProperty("--scale-factor",this.scale*ml.PDF_TO_CSS_UNITS),(d=this.pageColors)!=null&&d.background&&(n==null||n.style.setProperty("--page-bg-color",this.pageColors.background));const{optionalContentConfigPromise:f}=i;f&&f.then(m=>{f===this._optionalContentConfigPromise&&(u(this,vh).initialOptionalContent=m.hasInitialVisibility)}),i.l10n||this.l10n.translate(this.div)}}setPdfPage(i){var o,l,c,d;this._isStandalone&&(((o=this.pageColors)==null?void 0:o.foreground)==="CanvasText"||((l=this.pageColors)==null?void 0:l.background)==="Canvas")&&((c=this._container)==null||c.style.setProperty("--hcm-highlight-filter",i.filterFactory.addHighlightHCMFilter("highlight","CanvasText","Canvas","HighlightText","Highlight")),(d=this._container)==null||d.style.setProperty("--hcm-highlight-selected-filter",i.filterFactory.addHighlightHCMFilter("highlight_selected","CanvasText","Canvas","HighlightText","Highlight"))),this.pdfPage=i,this.pdfPageRotate=i.rotate;const n=(this.rotation+this.pdfPageRotate)%360;this.viewport=i.getViewport({scale:this.scale*ml.PDF_TO_CSS_UNITS,rotation:n}),R(this,Vi,FS).call(this),this.reset()}destroy(){var i;this.reset(),(i=this.pdfPage)==null||i.cleanup()}hasEditableAnnotations(){var i;return!!((i=this.annotationLayer)!=null&&i.hasEditableAnnotations())}get _textHighlighter(){return Pa(this,"_textHighlighter",new yW({pageIndex:this.id-1,eventBus:this.eventBus,findController:u(this,_d).findController}))}_resetCanvas(){super._resetCanvas(),D(this,q0,null)}reset({keepAnnotationLayer:i=!1,keepAnnotationEditorLayer:n=!1,keepXfaLayer:o=!1,keepTextLayer:l=!1,keepCanvasWrapper:c=!1,preserveDetailViewState:d=!1}={}){var L,F,X,re,K,te;this.cancelRendering({keepAnnotationLayer:i,keepAnnotationEditorLayer:n,keepXfaLayer:o,keepTextLayer:l}),this.renderingState=Ii.INITIAL;const f=this.div,m=f.childNodes,b=i&&((L=this.annotationLayer)==null?void 0:L.div)||null,T=n&&((F=this.annotationEditorLayer)==null?void 0:F.div)||null,C=o&&((X=this.xfaLayer)==null?void 0:X.div)||null,P=l&&((re=this.textLayer)==null?void 0:re.div)||null,x=c&&u(this,md)||null;for(let ee=m.length-1;ee>=0;ee--){const A=m[ee];switch(A){case b:case T:case C:case P:case x:continue}A.remove();const me=u(this,yd).indexOf(A);me>=0&&(u(this,yd)[me]=null)}f.removeAttribute("data-loaded"),b&&this.annotationLayer.hide(),T&&this.annotationEditorLayer.hide(),C&&this.xfaLayer.hide(),P&&this.textLayer.hide(),(K=this.structTreeLayer)==null||K.hide(),!c&&u(this,md)&&(D(this,md,null),this._resetCanvas()),d||((te=this.detailView)==null||te.reset({keepCanvas:c}),c||(this.detailView=null))}toggleEditingMode(i){D(this,Iw,i),this.hasEditableAnnotations()&&this.reset({keepAnnotationLayer:!0,keepAnnotationEditorLayer:!0,keepXfaLayer:!0,keepTextLayer:!0,keepCanvasWrapper:!0})}updateVisibleArea(i){this.enableDetailCanvas&&(u(this,bd)&&this.maxCanvasPixels>0&&i?(this.detailView??(this.detailView=new mW({pageView:this})),this.detailView.update({visibleArea:i})):this.detailView&&(this.detailView.reset(),this.detailView=null))}update({scale:i=0,rotation:n=null,optionalContentConfigPromise:o=null,drawingDelay:l=-1}){var d,f,m;this.scale=i||this.scale,typeof n=="number"&&(this.rotation=n),o instanceof Promise&&(this._optionalContentConfigPromise=o,o.then(b=>{o===this._optionalContentConfigPromise&&(u(this,vh).initialOptionalContent=b.hasInitialVisibility)})),u(this,vh).directDrawing=!0;const c=(this.rotation+this.pdfPageRotate)%360;if(this.viewport=this.viewport.clone({scale:this.scale*ml.PDF_TO_CSS_UNITS,rotation:c}),R(this,Vi,FS).call(this),this._isStandalone&&((d=this._container)==null||d.style.setProperty("--scale-factor",this.viewport.scale)),R(this,Vi,xk).call(this),this.canvas){const b=u(this,Dw)&&u(this,bd),T=l>=0&&l<1e3;if(T||b){T&&!b&&this.renderingState!==Ii.FINISHED&&(this.cancelRendering({keepAnnotationLayer:!0,keepAnnotationEditorLayer:!0,keepXfaLayer:!0,keepTextLayer:!0,cancelExtraDelay:l}),this.renderingState=Ii.FINISHED,u(this,vh).directDrawing=!1),this.cssTransform({redrawAnnotationLayer:!0,redrawAnnotationEditorLayer:!0,redrawXfaLayer:!0,redrawTextLayer:!T,hideTextLayer:T}),T||((f=this.detailView)==null||f.update({underlyingViewUpdated:!0}),this.dispatchPageRendered(!0,!1));return}}this.cssTransform({}),this.reset({keepAnnotationLayer:!0,keepAnnotationEditorLayer:!0,keepXfaLayer:!0,keepTextLayer:!0,keepCanvasWrapper:!0,preserveDetailViewState:!0}),(m=this.detailView)==null||m.update({underlyingViewUpdated:!0})}cancelRendering({keepAnnotationLayer:i=!1,keepAnnotationEditorLayer:n=!1,keepXfaLayer:o=!1,keepTextLayer:l=!1,cancelExtraDelay:c=0}={}){var d;super.cancelRendering({cancelExtraDelay:c}),this.textLayer&&(!l||!this.textLayer.div)&&(this.textLayer.cancel(),this.textLayer=null),this.annotationLayer&&(!i||!this.annotationLayer.div)&&(this.annotationLayer.cancel(),this.annotationLayer=null,this._annotationCanvasMap=null),this.structTreeLayer&&!this.textLayer&&(this.structTreeLayer=null),this.annotationEditorLayer&&(!n||!this.annotationEditorLayer.div)&&(this.drawLayer&&(this.drawLayer.cancel(),this.drawLayer=null),this.annotationEditorLayer.cancel(),this.annotationEditorLayer=null),this.xfaLayer&&(!o||!this.xfaLayer.div)&&(this.xfaLayer.cancel(),this.xfaLayer=null,(d=this._textHighlighter)==null||d.disable())}cssTransform({redrawAnnotationLayer:i=!1,redrawAnnotationEditorLayer:n=!1,redrawXfaLayer:o=!1,redrawTextLayer:l=!1,hideTextLayer:c=!1}){var m;const{canvas:d}=this;if(!d)return;const f=u(this,q0);if(this.viewport!==f){const b=(360+this.viewport.rotation-f.rotation)%360;if(b===90||b===270){const{width:T,height:C}=this.viewport,P=C/T,x=T/C;d.style.transform=`rotate(${b}deg) scale(${P},${x})`}else d.style.transform=b===0?"":`rotate(${b}deg)`}i&&this.annotationLayer&&R(this,Vi,vk).call(this),n&&this.annotationEditorLayer&&(this.drawLayer&&R(this,Vi,Tk).call(this),R(this,Vi,wk).call(this)),o&&this.xfaLayer&&R(this,Vi,Ek).call(this),this.textLayer&&(c?(this.textLayer.hide(),(m=this.structTreeLayer)==null||m.hide()):l&&R(this,Vi,Sk).call(this))}get width(){return this.viewport.width}get height(){return this.viewport.height}getPagePoint(i,n){return this.viewport.convertToPdfPoint(i,n)}_ensureCanvasWrapper(){let i=u(this,md);return i||(i=D(this,md,document.createElement("div")),i.classList.add("canvasWrapper"),R(this,Vi,tm).call(this,i,"canvasWrapper")),i}_getRenderingContext(i,n){return{canvasContext:i,transform:n,viewport:this.viewport,annotationMode:u(this,zp),optionalContentConfigPromise:this._optionalContentConfigPromise,annotationCanvasMap:this._annotationCanvasMap,pageColors:this.pageColors,isEditing:u(this,Iw)}}async draw(){this.renderingState!==Ii.INITIAL&&(console.error("Must be in new state before drawing"),this.reset());const{div:i,l10n:n,pdfPage:o,viewport:l}=this;if(!o)throw this.renderingState=Ii.FINISHED,new Error("pdfPage is not loaded");this.renderingState=Ii.RUNNING;const c=this._ensureCanvasWrapper();if(!this.textLayer&&u(this,G0)!==_l.DISABLE&&!o.isPureXfa&&(this._accessibilityManager||(this._accessibilityManager=new _k),this.textLayer=new yk({pdfPage:o,highlighter:this._textHighlighter,accessibilityManager:this._accessibilityManager,enablePermissions:u(this,G0)===_l.ENABLE_PERMISSIONS,onAppend:ee=>{this.l10n.pause(),R(this,Vi,tm).call(this,ee,"textLayer"),this.l10n.resume()}})),!this.annotationLayer&&u(this,zp)!==cu.DISABLE){const{annotationStorage:ee,annotationEditorUIManager:A,downloadManager:me,enableScripting:fe,fieldObjectsPromise:J,hasJSActionsPromise:ye,linkService:Oe}=u(this,_d);this._annotationCanvasMap||(this._annotationCanvasMap=new Map),this.annotationLayer=new dW({pdfPage:o,annotationStorage:ee,imageResourcesPath:this.imageResourcesPath,renderForms:u(this,zp)===cu.ENABLE_FORMS,linkService:Oe,downloadManager:me,enableScripting:fe,hasJSActionsPromise:ye,fieldObjectsPromise:J,annotationCanvasMap:this._annotationCanvasMap,accessibilityManager:this._accessibilityManager,annotationEditorUIManager:A,onAppend:ot=>{R(this,Vi,tm).call(this,ot,"annotationLayer")}})}const{width:d,height:f}=l;D(this,q0,l);const{canvas:m,prevCanvas:b,ctx:T}=this._createCanvas(ee=>{c.prepend(ee)});m.setAttribute("role","presentation"),this.outputScale||R(this,Vi,xk).call(this);const{outputScale:C}=this;D(this,Dw,u(this,bd));const P=bR(C.sx),x=bR(C.sy),L=m.width=UE(jE(d*C.sx),P[0]),F=m.height=UE(jE(f*C.sy),x[0]),X=UE(jE(d),P[1]),re=UE(jE(f),x[1]);C.sx=L/X,C.sy=F/re,u(this,Nw)!==P[1]&&(i.style.setProperty("--scale-round-x",`${P[1]}px`),D(this,Nw,P[1])),u(this,Rw)!==x[1]&&(i.style.setProperty("--scale-round-y",`${x[1]}px`),D(this,Rw,x[1]));const K=C.scaled?[C.sx,0,0,C.sy,0,0]:null,te=this._drawCanvas(this._getRenderingContext(T,K),()=>{b==null||b.remove(),this._resetCanvas()},ee=>{u(this,vh).regularAnnotations=!ee.separateAnnots,this.dispatchPageRendered(!1,!1)}).then(async()=>{var me;this.structTreeLayer||(this.structTreeLayer=new bW(o,l.rawDims));const ee=R(this,Vi,Sk).call(this);this.annotationLayer&&(await R(this,Vi,vk).call(this),u(this,Pw)&&this.annotationLayer&&this.textLayer&&await R(this,Vi,l3).call(this,ee));const{annotationEditorUIManager:A}=u(this,_d);A&&(this.drawLayer||(this.drawLayer=new gW({pageIndex:this.id})),await R(this,Vi,Tk).call(this),this.drawLayer.setParent(c),this.annotationEditorLayer||(this.annotationEditorLayer=new cW({uiManager:A,pdfPage:o,l10n:n,structTreeLayer:this.structTreeLayer,accessibilityManager:this._accessibilityManager,annotationLayer:(me=this.annotationLayer)==null?void 0:me.annotationLayer,textLayer:this.textLayer,drawLayer:this.drawLayer.getDrawLayer(),onAppend:fe=>{R(this,Vi,tm).call(this,fe,"annotationEditorLayer")}})),R(this,Vi,wk).call(this))});if(o.isPureXfa){if(!this.xfaLayer){const{annotationStorage:ee,linkService:A}=u(this,_d);this.xfaLayer=new BB({pdfPage:o,annotationStorage:ee,linkService:A})}R(this,Vi,Ek).call(this)}return i.setAttribute("data-loaded",!0),this.dispatchPageRender(),te}setPageLabel(i){this.pageLabel=typeof i=="string"?i:null,this.div.setAttribute("data-l10n-args",JSON.stringify({page:this.pageLabel??this.id})),this.pageLabel!==null?this.div.setAttribute("data-page-label",this.pageLabel):this.div.removeAttribute("data-page-label")}get thumbnailCanvas(){const{directDrawing:i,initialOptionalContent:n,regularAnnotations:o}=u(this,vh);return i&&n&&o?this.canvas:null}}zp=new WeakMap,md=new WeakMap,Pw=new WeakMap,Dw=new WeakMap,Iw=new WeakMap,_d=new WeakMap,bd=new WeakMap,q0=new WeakMap,Lw=new WeakMap,Nw=new WeakMap,Rw=new WeakMap,G0=new WeakMap,Mw=new WeakMap,vh=new WeakMap,yd=new WeakMap,Vi=new WeakSet,tm=function(i,n){const o=wW.get(n),l=u(this,yd)[o];if(u(this,yd)[o]=i,l){l.replaceWith(i);return}for(let c=o-1;c>=0;c--){const d=u(this,yd)[c];if(d){d.after(i);return}}this.div.prepend(i)},FS=function(){const{div:i,viewport:n}=this;if(n.userUnit!==u(this,Mw)&&(n.userUnit!==1?i.style.setProperty("--user-unit",n.userUnit):i.style.removeProperty("--user-unit"),D(this,Mw,n.userUnit)),this.pdfPage){if(u(this,Lw)===n.rotation)return;D(this,Lw,n.rotation)}kF(i,n,!0,!1)},Xb=function(i,n){this.eventBus.dispatch(i,{source:this,pageNumber:this.id,error:n})},vk=async function(){let i=null;try{await this.annotationLayer.render({viewport:this.viewport,intent:"display",structTreeLayer:this.structTreeLayer})}catch(n){console.error("#renderAnnotationLayer:",n),i=n}finally{R(this,Vi,Xb).call(this,"annotationlayerrendered",i)}},wk=async function(){let i=null;try{await this.annotationEditorLayer.render({viewport:this.viewport,intent:"display"})}catch(n){console.error("#renderAnnotationEditorLayer:",n),i=n}finally{R(this,Vi,Xb).call(this,"annotationeditorlayerrendered",i)}},Tk=async function(){try{await this.drawLayer.render({intent:"display"})}catch(i){console.error("#renderDrawLayer:",i)}},Ek=async function(){var n;let i=null;try{const o=await this.xfaLayer.render({viewport:this.viewport,intent:"display"});o!=null&&o.textDivs&&this._textHighlighter&&R(this,Vi,o3).call(this,o.textDivs)}catch(o){console.error("#renderXfaLayer:",o),i=o}finally{(n=this.xfaLayer)!=null&&n.div&&(this.l10n.pause(),R(this,Vi,tm).call(this,this.xfaLayer.div,"xfaLayer"),this.l10n.resume()),R(this,Vi,Xb).call(this,"xfalayerrendered",i)}},Sk=async function(){if(!this.textLayer)return;let i=null;try{await this.textLayer.render({viewport:this.viewport})}catch(n){if(n instanceof Cz)return;console.error("#renderTextLayer:",n),i=n}R(this,Vi,Xb).call(this,"textlayerrendered",i),R(this,Vi,a3).call(this)},a3=async function(){var n,o,l;if(!this.textLayer)return;const i=await((n=this.structTreeLayer)==null?void 0:n.render());i&&(this.l10n.pause(),(o=this.structTreeLayer)==null||o.addElementsToTextLayer(),this.canvas&&i.parentNode!==this.canvas&&this.canvas.append(i),this.l10n.resume()),(l=this.structTreeLayer)==null||l.show()},o3=async function(i){const n=await this.pdfPage.getTextContent(),o=[];for(const l of n.items)o.push(l.str);this._textHighlighter.setTextMapping(i,o),this._textHighlighter.enable()},l3=async function(i){try{if(await i,!this.annotationLayer)return;await this.annotationLayer.injectLinkAnnotations({inferredLinks:fk.processLinks(this),viewport:this.viewport,structTreeLayer:this.structTreeLayer})}catch(n){console.error("#injectLinkAnnotations:",n)}},xk=function(){const{width:i,height:n}=this.viewport,o=this.outputScale=new sg;if(this.maxCanvasPixels===0){const l=1/this.scale;o.sx*=l,o.sy*=l,D(this,bd,!0)}else D(this,bd,o.limitCanvas(i,n,this.maxCanvasPixels,this.maxCanvasDim,this.capCanvasAreaFactor))};const eM=10,Kb={FORCE_SCROLL_MODE_PAGE:1e4,FORCE_LAZY_PAGE_INIT:5e3,PAUSE_EAGER_PAGE_INIT:250};function tM(g){return Object.values(Qi).includes(g)&&g!==Qi.DISABLE}var wh,Wp,Ow,Ak;class EW{constructor(t){j(this,Ow);j(this,wh,new Set);j(this,Wp,0);D(this,Wp,t)}push(t){const i=u(this,wh);i.has(t)&&i.delete(t),i.add(t),i.size>u(this,Wp)&&R(this,Ow,Ak).call(this)}resize(t,i=null){D(this,Wp,t);const n=u(this,wh);if(i){const o=n.size;let l=1;for(const c of n)if(i.has(c.id)&&(n.delete(c),n.add(c)),++l>o)break}for(;n.size>u(this,Wp);)R(this,Ow,Ak).call(this)}has(t){return u(this,wh).has(t)}[Symbol.iterator](){return u(this,wh).keys()}}wh=new WeakMap,Wp=new WeakMap,Ow=new WeakSet,Ak=function(){const t=u(this,wh).keys().next().value;t==null||t.destroy(),u(this,wh).delete(t)};var Th,Fw,Bw,ol,to,qp,Uw,jw,Hw,Vw,$w,zw,Ww,qw,vd,Gw,X0,ll,Gp,Xp,K0,wd,Y0,Xw,Z0,Kp,Eh,Q0,Kw,J0,li,u3,h3,c3,Yb,BS,d3,Ck,f3,nc,kk,p3,g3,m3,Pk,_3,Dk,US,Ik;class SW{constructor(t){j(this,li);j(this,Th,null);j(this,Fw,null);j(this,Bw,null);j(this,ol,Qi.NONE);j(this,to,null);j(this,qp,cu.ENABLE_FORMS);j(this,Uw,null);j(this,jw,null);j(this,Hw,!1);j(this,Vw,!1);j(this,$w,!1);j(this,zw,!1);j(this,Ww,!1);j(this,qw,!0);j(this,vd,null);j(this,Gw,0);j(this,X0,null);j(this,ll,null);j(this,Gp,null);j(this,Xp,null);j(this,K0,!1);j(this,wd,null);j(this,Y0,!1);j(this,Xw,0);j(this,Z0,new ResizeObserver(R(this,li,_3).bind(this)));j(this,Kp,null);j(this,Eh,null);j(this,Q0,null);j(this,Kw,!0);j(this,J0,_l.ENABLE);var o,l;const i="5.3.33";if(ZS!==i)throw new Error(`The API version "${ZS}" does not match the Viewer version "${i}".`);if(this.container=t.container,this.viewer=t.viewer||t.container.firstElementChild,((o=this.container)==null?void 0:o.tagName)!=="DIV"||((l=this.viewer)==null?void 0:l.tagName)!=="DIV")throw new Error("Invalid `container` and/or `viewer` option.");if(this.container.offsetParent&&getComputedStyle(this.container).position!=="absolute")throw new Error("The `container` must be absolutely positioned.");u(this,Z0).observe(this.container),this.eventBus=t.eventBus,this.linkService=t.linkService||new BF,this.downloadManager=t.downloadManager||null,this.findController=t.findController||null,D(this,Fw,t.altTextManager||null),D(this,Q0,t.signatureManager||null),D(this,jw,t.editorUndoBar||null),this.findController&&(this.findController.onIsPageVisible=c=>this._getVisiblePages().ids.has(c)),this._scriptingManager=t.scriptingManager||null,D(this,J0,t.textLayerMode??_l.ENABLE),D(this,qp,t.annotationMode??cu.ENABLE_FORMS),D(this,ol,t.annotationEditorMode??Qi.NONE),D(this,Bw,t.annotationEditorHighlightColors||null),D(this,Vw,t.enableHighlightFloatingButton===!0),D(this,zw,t.enableUpdatedAddImage===!0),D(this,Ww,t.enableNewAltTextWhenAddingImage===!0),this.imageResourcesPath=t.imageResourcesPath||"",this.enablePrintAutoRotate=t.enablePrintAutoRotate||!1,this.removePageBorders=t.removePageBorders||!1,this.maxCanvasPixels=t.maxCanvasPixels,this.maxCanvasDim=t.maxCanvasDim,this.capCanvasAreaFactor=t.capCanvasAreaFactor,this.enableDetailCanvas=t.enableDetailCanvas??!0,this.l10n=t.l10n,this.l10n||(this.l10n=new u_),D(this,$w,t.enablePermissions||!1),this.pageColors=t.pageColors||null,D(this,X0,t.mlManager||null),D(this,Hw,t.enableHWA||!1),D(this,Kw,t.supportsPinchToZoom!==!1),D(this,qw,t.enableAutoLinking!==!1),D(this,Gw,t.minDurationToUpdateCanvas??500),this.defaultRenderingQueue=!t.renderingQueue,this.defaultRenderingQueue?(this.renderingQueue=new HB,this.renderingQueue.setViewer(this)):this.renderingQueue=t.renderingQueue;const{abortSignal:n}=t;n==null||n.addEventListener("abort",()=>{u(this,Z0).disconnect(),D(this,Z0,null)},{once:!0}),this.scroll=IF(this.container,this._scrollUpdate.bind(this),n),this.presentationModeState=tr.UNKNOWN,this._resetView(),this.removePageBorders&&this.viewer.classList.add("removePageBorders"),R(this,li,Pk).call(this),this.eventBus._on("thumbnailrendered",({pageNumber:c,pdfPage:d})=>{const f=this._pages[c-1];u(this,Th).has(f)||d==null||d.cleanup()}),t.l10n||this.l10n.translate(this.container)}get pagesCount(){return this._pages.length}getPageView(t){return this._pages[t]}getCachedPageViews(){return new Set(u(this,Th))}get pageViewsReady(){return this._pages.every(t=>t==null?void 0:t.pdfPage)}get renderForms(){return u(this,qp)===cu.ENABLE_FORMS}get enableScripting(){return!!this._scriptingManager}get currentPageNumber(){return this._currentPageNumber}set currentPageNumber(t){if(!Number.isInteger(t))throw new Error("Invalid page number.");this.pdfDocument&&(this._setCurrentPageNumber(t,!0)||console.error(`currentPageNumber: "${t}" is not a valid page.`))}_setCurrentPageNumber(t,i=!1){var o;if(this._currentPageNumber===t)return i&&R(this,li,kk).call(this),!0;if(!(0<t&&t<=this.pagesCount))return!1;const n=this._currentPageNumber;return this._currentPageNumber=t,this.eventBus.dispatch("pagechanging",{source:this,pageNumber:t,pageLabel:((o=this._pageLabels)==null?void 0:o[t-1])??null,previous:n}),i&&R(this,li,kk).call(this),!0}get currentPageLabel(){var t;return((t=this._pageLabels)==null?void 0:t[this._currentPageNumber-1])??null}set currentPageLabel(t){if(!this.pdfDocument)return;let i=t|0;if(this._pageLabels){const n=this._pageLabels.indexOf(t);n>=0&&(i=n+1)}this._setCurrentPageNumber(i,!0)||console.error(`currentPageLabel: "${t}" is not a valid page.`)}get currentScale(){return this._currentScale!==RA?this._currentScale:aP}set currentScale(t){if(isNaN(t))throw new Error("Invalid numeric scale.");this.pdfDocument&&R(this,li,nc).call(this,t,{noScroll:!1})}get currentScaleValue(){return this._currentScaleValue}set currentScaleValue(t){this.pdfDocument&&R(this,li,nc).call(this,t,{noScroll:!1})}get pagesRotation(){return this._pagesRotation}set pagesRotation(t){if(!Ix(t))throw new Error("Invalid pages rotation angle.");if(!this.pdfDocument||(t%=360,t<0&&(t+=360),this._pagesRotation===t))return;this._pagesRotation=t;const i=this._currentPageNumber;this.refresh(!0,{rotation:t}),this._currentScaleValue&&R(this,li,nc).call(this,this._currentScaleValue,{noScroll:!0}),this.eventBus.dispatch("rotationchanging",{source:this,pagesRotation:t,pageNumber:i}),this.defaultRenderingQueue&&this.update()}get firstPagePromise(){return this.pdfDocument?this._firstPageCapability.promise:null}get onePageRendered(){return this.pdfDocument?this._onePageRenderedCapability.promise:null}get pagesPromise(){return this.pdfDocument?this._pagesCapability.promise:null}get _layerProperties(){const t=this;return Pa(this,"_layerProperties",{get annotationEditorUIManager(){return u(t,to)},get annotationStorage(){var i;return(i=t.pdfDocument)==null?void 0:i.annotationStorage},get downloadManager(){return t.downloadManager},get enableScripting(){return!!t._scriptingManager},get fieldObjectsPromise(){var i;return(i=t.pdfDocument)==null?void 0:i.getFieldObjects()},get findController(){return t.findController},get hasJSActionsPromise(){var i;return(i=t.pdfDocument)==null?void 0:i.hasJSActions()},get linkService(){return t.linkService}})}async getAllText(){const t=[],i=[];for(let n=1,o=this.pdfDocument.numPages;n<=o;++n){if(u(this,Y0))return null;i.length=0;const l=await this.pdfDocument.getPage(n),{items:c}=await l.getTextContent();for(const d of c)d.str&&i.push(d.str),d.hasEOL&&i.push(`
`);t.push(am(i.join("")))}return t.join(`
`)}setDocument(t){var C,P,x;if(this.pdfDocument&&(this.eventBus.dispatch("pagesdestroy",{source:this}),this._cancelRendering(),this._resetView(),(C=this.findController)==null||C.setDocument(null),(P=this._scriptingManager)==null||P.setDocument(null),(x=u(this,to))==null||x.destroy(),D(this,to,null)),this.pdfDocument=t,!t)return;const i=t.numPages,n=t.getPage(1),o=t.getOptionalContentConfig({intent:"display"}),l=u(this,$w)?t.getPermissions():Promise.resolve(),{eventBus:c,pageColors:d,viewer:f}=this;D(this,vd,new AbortController);const{signal:m}=u(this,vd);if(i>Kb.FORCE_SCROLL_MODE_PAGE){console.warn("Forcing PAGE-scrolling for performance reasons, given the length of the document.");const L=this._scrollMode=Ci.PAGE;c.dispatch("scrollmodechanged",{source:this,mode:L})}this._pagesCapability.promise.then(()=>{c.dispatch("pagesloaded",{source:this,pagesCount:i})},()=>{});const b=L=>{const F=this._pages[L.pageNumber-1];F&&u(this,Th).push(F)};c._on("pagerender",b,{signal:m});const T=L=>{L.cssTransform||L.isDetailView||(this._onePageRenderedCapability.resolve({timestamp:L.timestamp}),c._off("pagerendered",T))};c._on("pagerendered",T,{signal:m}),Promise.all([n,l]).then(([L,F])=>{var me;if(t!==this.pdfDocument)return;this._firstPageCapability.resolve(L),this._optionalContentConfigPromise=o;const{annotationEditorMode:X,annotationMode:re,textLayerMode:K}=R(this,li,u3).call(this,F);if(K!==_l.DISABLE){const fe=D(this,wd,document.createElement("div"));fe.id="hiddenCopyElement",f.before(fe)}if(X!==Qi.DISABLE){const fe=X;t.isPureXfa?console.warn("Warning: XFA-editing is not implemented."):tM(fe)?(D(this,to,new Pz(this.container,f,u(this,Fw),u(this,Q0),c,t,d,u(this,Bw),u(this,Vw),u(this,zw),u(this,Ww),u(this,X0),u(this,jw),u(this,Kw))),c.dispatch("annotationeditoruimanager",{source:this,uiManager:u(this,to)}),fe!==Qi.NONE&&(R(this,li,Ik).call(this,fe),u(this,to).updateMode(fe))):console.error(`Invalid AnnotationEditor mode: ${fe}`)}const te=this._scrollMode===Ci.PAGE?null:f,ee=this.currentScale,A=L.getViewport({scale:ee*ml.PDF_TO_CSS_UNITS});f.style.setProperty("--scale-factor",A.scale),d!=null&&d.background&&f.style.setProperty("--page-bg-color",d.background),((d==null?void 0:d.foreground)==="CanvasText"||(d==null?void 0:d.background)==="Canvas")&&(f.style.setProperty("--hcm-highlight-filter",t.filterFactory.addHighlightHCMFilter("highlight","CanvasText","Canvas","HighlightText","Highlight")),f.style.setProperty("--hcm-highlight-selected-filter",t.filterFactory.addHighlightHCMFilter("highlight_selected","CanvasText","Canvas","HighlightText","ButtonText")));for(let fe=1;fe<=i;++fe){const J=new TW({container:te,eventBus:c,id:fe,scale:ee,defaultViewport:A.clone(),optionalContentConfigPromise:o,renderingQueue:this.renderingQueue,textLayerMode:K,annotationMode:re,imageResourcesPath:this.imageResourcesPath,maxCanvasPixels:this.maxCanvasPixels,maxCanvasDim:this.maxCanvasDim,capCanvasAreaFactor:this.capCanvasAreaFactor,enableDetailCanvas:this.enableDetailCanvas,pageColors:d,l10n:this.l10n,layerProperties:this._layerProperties,enableHWA:u(this,Hw),enableAutoLinking:u(this,qw),minDurationToUpdateCanvas:u(this,Gw)});this._pages.push(J)}(me=this._pages[0])==null||me.setPdfPage(L),this._scrollMode===Ci.PAGE?R(this,li,Yb).call(this):this._spreadMode!==Ws.NONE&&this._updateSpreadMode(),R(this,li,h3).call(this,m).then(async()=>{var J,ye;if(t!==this.pdfDocument)return;if((J=this.findController)==null||J.setDocument(t),(ye=this._scriptingManager)==null||ye.setDocument(t),u(this,wd)&&document.addEventListener("copy",R(this,li,c3).bind(this,K),{signal:m}),u(this,to)&&c.dispatch("annotationeditormodechanged",{source:this,mode:u(this,ol)}),t.loadingParams.disableAutoFetch||i>Kb.FORCE_LAZY_PAGE_INIT){this._pagesCapability.resolve();return}let fe=i-1;if(fe<=0){this._pagesCapability.resolve();return}for(let Oe=2;Oe<=i;++Oe){const ot=t.getPage(Oe).then(Tt=>{const dt=this._pages[Oe-1];dt.pdfPage||dt.setPdfPage(Tt),--fe===0&&this._pagesCapability.resolve()},Tt=>{console.error(`Unable to get page ${Oe} to initialize viewer`,Tt),--fe===0&&this._pagesCapability.resolve()});Oe%Kb.PAUSE_EAGER_PAGE_INIT===0&&await ot}}),c.dispatch("pagesinit",{source:this}),t.getMetadata().then(({info:fe})=>{t===this.pdfDocument&&fe.Language&&(f.lang=fe.Language)}),this.defaultRenderingQueue&&this.update()}).catch(L=>{console.error("Unable to initialize viewer",L),this._pagesCapability.reject(L)})}setPageLabels(t){var i;if(this.pdfDocument){t?Array.isArray(t)&&this.pdfDocument.numPages===t.length?this._pageLabels=t:(this._pageLabels=null,console.error("setPageLabels: Invalid page labels.")):this._pageLabels=null;for(let n=0,o=this._pages.length;n<o;n++)this._pages[n].setPageLabel(((i=this._pageLabels)==null?void 0:i[n])??null)}}_resetView(){var t,i;this._pages=[],this._currentPageNumber=1,this._currentScale=RA,this._currentScaleValue=null,this._pageLabels=null,D(this,Th,new EW(eM)),this._location=null,this._pagesRotation=0,this._optionalContentConfigPromise=null,this._firstPageCapability=Promise.withResolvers(),this._onePageRenderedCapability=Promise.withResolvers(),this._pagesCapability=Promise.withResolvers(),this._scrollMode=Ci.VERTICAL,this._previousScrollMode=Ci.UNKNOWN,this._spreadMode=Ws.NONE,D(this,Kp,{previousPageNumber:1,scrollDown:!0,pages:[]}),(t=u(this,vd))==null||t.abort(),D(this,vd,null),this.viewer.textContent="",this._updateScrollMode(),this.viewer.removeAttribute("lang"),(i=u(this,wd))==null||i.remove(),D(this,wd,null),R(this,li,Dk).call(this),R(this,li,US).call(this)}_scrollUpdate(){this.pagesCount!==0&&(u(this,ll)&&clearTimeout(u(this,ll)),D(this,ll,setTimeout(()=>{D(this,ll,null),this.update()},100)),this.update())}pageLabelToPageNumber(t){if(!this._pageLabels)return null;const i=this._pageLabels.indexOf(t);return i<0?null:i+1}scrollPageIntoView({pageNumber:t,destArray:i=null,allowNegativeOffset:n=!1,ignoreDestinationZoom:o=!1}){if(!this.pdfDocument)return;const l=Number.isInteger(t)&&this._pages[t-1];if(!l){console.error(`scrollPageIntoView: "${t}" is not a valid pageNumber parameter.`);return}if(this.isInPresentationMode||!i){this._setCurrentPageNumber(t,!0);return}let c=0,d=0,f=0,m=0,b,T;const C=l.rotation%180!==0,P=(C?l.height:l.width)/l.scale/ml.PDF_TO_CSS_UNITS,x=(C?l.width:l.height)/l.scale/ml.PDF_TO_CSS_UNITS;let L=0;switch(i[1].name){case"XYZ":c=i[2],d=i[3],L=i[4],c=c!==null?c:0,d=d!==null?d:x;break;case"Fit":case"FitB":L="page-fit";break;case"FitH":case"FitBH":d=i[2],L="page-width",d===null&&this._location?(c=this._location.left,d=this._location.top):(typeof d!="number"||d<0)&&(d=x);break;case"FitV":case"FitBV":c=i[2],f=P,m=x,L="page-height";break;case"FitR":c=i[2],d=i[3],f=i[4]-c,m=i[5]-d;let K=gR,te=mR;this.removePageBorders&&(K=te=0),b=(this.container.clientWidth-K)/f/ml.PDF_TO_CSS_UNITS,T=(this.container.clientHeight-te)/m/ml.PDF_TO_CSS_UNITS,L=Math.min(Math.abs(b),Math.abs(T));break;default:console.error(`scrollPageIntoView: "${i[1].name}" is not a valid destination type.`);return}if(o||(L&&L!==this._currentScale?this.currentScaleValue=L:this._currentScale===RA&&(this.currentScaleValue=ty)),L==="page-fit"&&!i[4]){R(this,li,BS).call(this,l);return}const F=[l.viewport.convertToViewportPoint(c,d),l.viewport.convertToViewportPoint(c+f,d+m)];let X=Math.min(F[0][0],F[1][0]),re=Math.min(F[0][1],F[1][1]);n||(X=Math.max(X,0),re=Math.max(re,0)),R(this,li,BS).call(this,l,{left:X,top:re})}_updateLocation(t){const i=this._currentScale,n=this._currentScaleValue,o=parseFloat(n)===i?Math.round(i*1e4)/100:n,l=t.id,c=this._pages[l-1],d=this.container,f=c.getPagePoint(d.scrollLeft-t.x,d.scrollTop-t.y),m=Math.round(f[0]),b=Math.round(f[1]);let T=`#page=${l}`;this.isInPresentationMode||(T+=`&zoom=${o},${m},${b}`),this._location={pageNumber:l,scale:o,top:b,left:m,rotation:this._pagesRotation,pdfOpenParams:T}}update(){const t=this._getVisiblePages(),i=t.views,n=i.length;if(n===0)return;const o=Math.max(eM,2*n+1);u(this,Th).resize(o,t.ids);for(const{view:f,visibleArea:m}of i)f.updateVisibleArea(m);for(const f of u(this,Th))t.ids.has(f.id)||f.updateVisibleArea(null);this.renderingQueue.renderHighestPriority(t);const l=this._spreadMode===Ws.NONE&&(this._scrollMode===Ci.PAGE||this._scrollMode===Ci.VERTICAL),c=this._currentPageNumber;let d=!1;for(const f of i){if(f.percent<100)break;if(f.id===c&&l){d=!0;break}}this._setCurrentPageNumber(d?c:i[0].id),this._updateLocation(t.first),this.eventBus.dispatch("updateviewarea",{source:this,location:this._location})}containsElement(t){return this.container.contains(t)}focus(){this.container.focus()}get _isContainerRtl(){return getComputedStyle(this.container).direction==="rtl"}get isInPresentationMode(){return this.presentationModeState===tr.FULLSCREEN}get isChangingPresentationMode(){return this.presentationModeState===tr.CHANGING}get isHorizontalScrollbarEnabled(){return this.isInPresentationMode?!1:this.container.scrollWidth>this.container.clientWidth}get isVerticalScrollbarEnabled(){return this.isInPresentationMode?!1:this.container.scrollHeight>this.container.clientHeight}_getVisiblePages(){const t=this._scrollMode===Ci.PAGE?u(this,Kp).pages:this._pages,i=this._scrollMode===Ci.HORIZONTAL,n=i&&this._isContainerRtl;return LF({scrollEl:this.container,views:t,sortByVisibility:!0,horizontal:i,rtl:n})}cleanup(){for(const t of this._pages)t.renderingState!==Ii.FINISHED&&t.reset()}_cancelRendering(){for(const t of this._pages)t.cancelRendering()}forceRendering(t){const i=t||this._getVisiblePages(),n=R(this,li,m3).call(this,i),o=this._spreadMode!==Ws.NONE&&this._scrollMode!==Ci.HORIZONTAL,l=u(this,Eh)!==null||u(this,ll)!==null&&i.views.some(d=>{var f;return(f=d.detailView)==null?void 0:f.renderingCancelled}),c=this.renderingQueue.getHighestPriority(i,this._pages,n,o,l);return c?(R(this,li,g3).call(this,c).then(()=>{this.renderingQueue.renderView(c)}),!0):!1}get hasEqualPageSizes(){const t=this._pages[0];for(let i=1,n=this._pages.length;i<n;++i){const o=this._pages[i];if(o.width!==t.width||o.height!==t.height)return!1}return!0}getPagesOverview(){let t;return this._pages.map(i=>{const n=i.pdfPage.getViewport({scale:1}),o=h2(n);if(t===void 0)t=o;else if(this.enablePrintAutoRotate&&o!==t)return{width:n.height,height:n.width,rotation:(n.rotation-90)%360};return{width:n.width,height:n.height,rotation:n.rotation}})}get optionalContentConfigPromise(){return this.pdfDocument?this._optionalContentConfigPromise?this._optionalContentConfigPromise:(console.error("optionalContentConfigPromise: Not initialized yet."),this.pdfDocument.getOptionalContentConfig({intent:"display"})):Promise.resolve(null)}set optionalContentConfigPromise(t){if(!(t instanceof Promise))throw new Error(`Invalid optionalContentConfigPromise: ${t}`);this.pdfDocument&&this._optionalContentConfigPromise&&(this._optionalContentConfigPromise=t,this.refresh(!1,{optionalContentConfigPromise:t}),this.eventBus.dispatch("optionalcontentconfigchanged",{source:this,promise:t}))}get scrollMode(){return this._scrollMode}set scrollMode(t){if(this._scrollMode!==t){if(!RF(t))throw new Error(`Invalid scroll mode: ${t}`);this.pagesCount>Kb.FORCE_SCROLL_MODE_PAGE||(this._previousScrollMode=this._scrollMode,this._scrollMode=t,this.eventBus.dispatch("scrollmodechanged",{source:this,mode:t}),this._updateScrollMode(this._currentPageNumber))}}_updateScrollMode(t=null){const i=this._scrollMode,n=this.viewer;n.classList.toggle("scrollHorizontal",i===Ci.HORIZONTAL),n.classList.toggle("scrollWrapped",i===Ci.WRAPPED),!(!this.pdfDocument||!t)&&(i===Ci.PAGE?R(this,li,Yb).call(this):this._previousScrollMode===Ci.PAGE&&this._updateSpreadMode(),this._currentScaleValue&&isNaN(this._currentScaleValue)&&R(this,li,nc).call(this,this._currentScaleValue,{noScroll:!0}),this._setCurrentPageNumber(t,!0),this.update())}get spreadMode(){return this._spreadMode}set spreadMode(t){if(this._spreadMode!==t){if(!MF(t))throw new Error(`Invalid spread mode: ${t}`);this._spreadMode=t,this.eventBus.dispatch("spreadmodechanged",{source:this,mode:t}),this._updateSpreadMode(this._currentPageNumber)}}_updateSpreadMode(t=null){if(!this.pdfDocument)return;const i=this.viewer,n=this._pages;if(this._scrollMode===Ci.PAGE)R(this,li,Yb).call(this);else if(i.textContent="",this._spreadMode===Ws.NONE)for(const o of this._pages)i.append(o.div);else{const o=this._spreadMode-1;let l=null;for(let c=0,d=n.length;c<d;++c)l===null?(l=document.createElement("div"),l.className="spread",i.append(l)):c%2===o&&(l=l.cloneNode(!1),i.append(l)),l.append(n[c].div)}t&&(this._currentScaleValue&&isNaN(this._currentScaleValue)&&R(this,li,nc).call(this,this._currentScaleValue,{noScroll:!0}),this._setCurrentPageNumber(t,!0),this.update())}_getPageAdvance(t,i=!1){switch(this._scrollMode){case Ci.WRAPPED:{const{views:n}=this._getVisiblePages(),o=new Map;for(const{id:l,y:c,percent:d,widthPercent:f}of n){if(d===0||f<100)continue;let m=o.get(c);m||o.set(c,m||(m=[])),m.push(l)}for(const l of o.values()){const c=l.indexOf(t);if(c===-1)continue;const d=l.length;if(d===1)break;if(i)for(let f=c-1,m=0;f>=m;f--){const b=l[f],T=l[f+1]-1;if(b<T)return t-T}else for(let f=c+1,m=d;f<m;f++){const b=l[f],T=l[f-1]+1;if(b>T)return T-t}if(i){const f=l[0];if(f<t)return t-f+1}else{const f=l[d-1];if(f>t)return f-t+1}break}break}case Ci.HORIZONTAL:break;case Ci.PAGE:case Ci.VERTICAL:{if(this._spreadMode===Ws.NONE)break;const n=this._spreadMode-1;if(i&&t%2!==n)break;if(!i&&t%2===n)break;const{views:o}=this._getVisiblePages(),l=i?t-1:t+1;for(const{id:c,percent:d,widthPercent:f}of o)if(c===l){if(d>0&&f===100)return 2;break}break}}return 1}nextPage(){const t=this._currentPageNumber,i=this.pagesCount;if(t>=i)return!1;const n=this._getPageAdvance(t,!1)||1;return this.currentPageNumber=Math.min(t+n,i),!0}previousPage(){const t=this._currentPageNumber;if(t<=1)return!1;const i=this._getPageAdvance(t,!0)||1;return this.currentPageNumber=Math.max(t-i,1),!0}updateScale({drawingDelay:t,scaleFactor:i=null,steps:n=null,origin:o}){if(n===null&&i===null)throw new Error("Invalid updateScale options: either `steps` or `scaleFactor` must be provided.");if(!this.pdfDocument)return;let l=this._currentScale;if(i>0&&i!==1)l=Math.round(l*i*100)/100;else if(n){const c=n>0?pR:1/pR,d=n>0?Math.ceil:Math.floor;n=Math.abs(n);do l=d((l*c).toFixed(2)*10)/10;while(--n>0)}l=CF(l,PF,DF),R(this,li,nc).call(this,l,{noScroll:!1,drawingDelay:t,origin:o})}increaseScale(t={}){this.updateScale({...t,steps:t.steps??1})}decreaseScale(t={}){this.updateScale({...t,steps:-(t.steps??1)})}get containerTopLeft(){return u(this,Uw)||D(this,Uw,[this.container.offsetTop,this.container.offsetLeft])}get annotationEditorMode(){return u(this,to)?u(this,ol):Qi.DISABLE}set annotationEditorMode({mode:t,editId:i=null,isFromKeyboard:n=!1}){if(!u(this,to))throw new Error("The AnnotationEditor is not enabled.");if(u(this,ol)===t)return;if(!tM(t))throw new Error(`Invalid AnnotationEditor mode: ${t}`);if(!this.pdfDocument)return;R(this,li,Ik).call(this,t);const{eventBus:o,pdfDocument:l}=this,c=async()=>{R(this,li,US).call(this),D(this,ol,t),await u(this,to).updateMode(t,i,n),!(t!==u(this,ol)||l!==this.pdfDocument)&&o.dispatch("annotationeditormodechanged",{source:this,mode:t})};if(t===Qi.NONE||u(this,ol)===Qi.NONE){const d=t!==Qi.NONE;d||this.pdfDocument.annotationStorage.resetModifiedIds();for(const m of this._pages)m.toggleEditingMode(d);const f=R(this,li,p3).call(this);if(d&&f){R(this,li,US).call(this),D(this,Gp,new AbortController);const m=AbortSignal.any([u(this,vd).signal,u(this,Gp).signal]);o._on("pagerendered",({pageNumber:b})=>{f.delete(b),f.size===0&&D(this,Xp,setTimeout(c,0))},{signal:m});return}}c()}refresh(t=!1,i=Object.create(null)){if(this.pdfDocument){for(const n of this._pages)n.update(i);R(this,li,Dk).call(this),t||this.update()}}}Th=new WeakMap,Fw=new WeakMap,Bw=new WeakMap,ol=new WeakMap,to=new WeakMap,qp=new WeakMap,Uw=new WeakMap,jw=new WeakMap,Hw=new WeakMap,Vw=new WeakMap,$w=new WeakMap,zw=new WeakMap,Ww=new WeakMap,qw=new WeakMap,vd=new WeakMap,Gw=new WeakMap,X0=new WeakMap,ll=new WeakMap,Gp=new WeakMap,Xp=new WeakMap,K0=new WeakMap,wd=new WeakMap,Y0=new WeakMap,Xw=new WeakMap,Z0=new WeakMap,Kp=new WeakMap,Eh=new WeakMap,Q0=new WeakMap,Kw=new WeakMap,J0=new WeakMap,li=new WeakSet,u3=function(t){const i={annotationEditorMode:u(this,ol),annotationMode:u(this,qp),textLayerMode:u(this,J0)};return t&&(!t.includes(FE.COPY)&&u(this,J0)===_l.ENABLE&&(i.textLayerMode=_l.ENABLE_PERMISSIONS),t.includes(FE.MODIFY_CONTENTS)||(i.annotationEditorMode=Qi.DISABLE),!t.includes(FE.MODIFY_ANNOTATIONS)&&!t.includes(FE.FILL_INTERACTIVE_FORMS)&&u(this,qp)===cu.ENABLE_FORMS&&(i.annotationMode=cu.ENABLE)),i},h3=async function(t){if(document.visibilityState==="hidden"||!this.container.offsetParent||this._getVisiblePages().views.length===0)return;const i=Promise.withResolvers(),n=new AbortController;document.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"&&i.resolve()},{signal:AbortSignal.any([t,n.signal])}),await Promise.race([this._onePageRenderedCapability.promise,i.promise]),n.abort()},c3=function(t,i){const n=document.getSelection(),{focusNode:o,anchorNode:l}=n;if(l&&o&&n.containsNode(u(this,wd))){if(u(this,K0)||t===_l.ENABLE_PERMISSIONS){du(i);return}D(this,K0,!0);const{classList:c}=this.viewer;c.add("copyAll");const d=new AbortController;window.addEventListener("keydown",f=>D(this,Y0,f.key==="Escape"),{signal:d.signal}),this.getAllText().then(async f=>{f!==null&&await navigator.clipboard.writeText(f)}).catch(f=>{console.warn(`Something goes wrong when extracting the text: ${f.message}`)}).finally(()=>{D(this,K0,!1),D(this,Y0,!1),d.abort(),c.remove("copyAll")}),du(i)}},Yb=function(){if(this._scrollMode!==Ci.PAGE)throw new Error("#ensurePageViewVisible: Invalid scrollMode value.");const t=this._currentPageNumber,i=u(this,Kp),n=this.viewer;if(n.textContent="",i.pages.length=0,this._spreadMode===Ws.NONE&&!this.isInPresentationMode){const o=this._pages[t-1];n.append(o.div),i.pages.push(o)}else{const o=new Set,l=this._spreadMode-1;l===-1?o.add(t-1):t%2!==l?(o.add(t-1),o.add(t)):(o.add(t-2),o.add(t-1));const c=document.createElement("div");if(c.className="spread",this.isInPresentationMode){const d=document.createElement("div");d.className="dummyPage",c.append(d)}for(const d of o){const f=this._pages[d];f&&(c.append(f.div),i.pages.push(f))}n.append(c)}i.scrollDown=t>=i.previousPageNumber,i.previousPageNumber=t},BS=function(t,i=null){const{div:n,id:o}=t;if(this._currentPageNumber!==o&&this._setCurrentPageNumber(o),this._scrollMode===Ci.PAGE&&(R(this,li,Yb).call(this),this.update()),!i&&!this.isInPresentationMode){const l=n.offsetLeft+n.clientLeft,c=l+n.clientWidth,{scrollLeft:d,clientWidth:f}=this.container;(this._scrollMode===Ci.HORIZONTAL||l<d||c>d+f)&&(i={left:0,top:0})}oP(n,i),!this._currentScaleValue&&this._location&&(this._location=null)},d3=function(t){return t===this._currentScale||Math.abs(t-this._currentScale)<1e-15},Ck=function(t,i,{noScroll:n=!1,preset:o=!1,drawingDelay:l=-1,origin:c=null}){if(this._currentScaleValue=i.toString(),R(this,li,d3).call(this,t)){o&&this.eventBus.dispatch("scalechanging",{source:this,scale:t,presetValue:i});return}this.viewer.style.setProperty("--scale-factor",t*ml.PDF_TO_CSS_UNITS);const d=l>=0&&l<1e3;this.refresh(!0,{scale:t,drawingDelay:d?l:-1}),d&&D(this,Eh,setTimeout(()=>{D(this,Eh,null),this.refresh()},l));const f=this._currentScale;if(this._currentScale=t,!n){let m=this._currentPageNumber,b;if(this._location&&!(this.isInPresentationMode||this.isChangingPresentationMode)&&(m=this._location.pageNumber,b=[null,{name:"XYZ"},this._location.left,this._location.top,null]),this.scrollPageIntoView({pageNumber:m,destArray:b,allowNegativeOffset:!0}),Array.isArray(c)){const T=t/f-1,[C,P]=this.containerTopLeft;this.container.scrollLeft+=(c[0]-P)*T,this.container.scrollTop+=(c[1]-C)*T}}this.eventBus.dispatch("scalechanging",{source:this,scale:t,presetValue:o?i:void 0}),this.defaultRenderingQueue&&this.update()},f3=function(){return this._spreadMode!==Ws.NONE&&this._scrollMode!==Ci.HORIZONTAL?2:1},nc=function(t,i){let n=parseFloat(t);if(n>0)i.preset=!1,R(this,li,Ck).call(this,n,t,i);else{const o=this._pages[this._currentPageNumber-1];if(!o)return;let l=gR,c=mR;this.isInPresentationMode?(l=c=4,this._spreadMode!==Ws.NONE&&(l*=2)):this.removePageBorders?l=c=0:this._scrollMode===Ci.HORIZONTAL&&([l,c]=[c,l]);const d=(this.container.clientWidth-l)/o.width*o.scale/u(this,li,f3),f=(this.container.clientHeight-c)/o.height*o.scale;switch(t){case"page-actual":n=1;break;case"page-width":n=d;break;case"page-height":n=f;break;case"page-fit":n=Math.min(d,f);break;case"auto":const m=h2(o)?d:Math.min(f,d);n=Math.min(Kz,m);break;default:console.error(`#setScale: "${t}" is an unknown zoom value.`);return}i.preset=!0,R(this,li,Ck).call(this,n,t,i)}},kk=function(){const t=this._pages[this._currentPageNumber-1];this.isInPresentationMode&&R(this,li,nc).call(this,this._currentScaleValue,{noScroll:!0}),R(this,li,BS).call(this,t)},p3=function(){const t=this._getVisiblePages(),i=[],{ids:n,views:o}=t;for(const l of o){const{view:c}=l;if(!c.hasEditableAnnotations()){n.delete(c.id);continue}i.push(l)}return i.length===0?null:(this.renderingQueue.renderHighestPriority({first:i[0],last:i.at(-1),views:i,ids:n}),n)},g3=async function(t){if(t.pdfPage)return t.pdfPage;try{const i=await this.pdfDocument.getPage(t.id);return t.pdfPage||t.setPdfPage(i),i}catch(i){return console.error("Unable to get page for page view",i),null}},m3=function(t){var i,n;if(((i=t.first)==null?void 0:i.id)===1)return!0;if(((n=t.last)==null?void 0:n.id)===this.pagesCount)return!1;switch(this._scrollMode){case Ci.PAGE:return u(this,Kp).scrollDown;case Ci.HORIZONTAL:return this.scroll.right}return this.scroll.down},Pk=function(t=this.container.clientHeight){t!==u(this,Xw)&&(D(this,Xw,t),lP.setProperty("--viewer-container-height",`${t}px`))},_3=function(t){for(const i of t)if(i.target===this.container){R(this,li,Pk).call(this,Math.floor(i.borderBoxSize[0].blockSize)),D(this,Uw,null);break}},Dk=function(){u(this,Eh)!==null&&(clearTimeout(u(this,Eh)),D(this,Eh,null)),u(this,ll)!==null&&(clearTimeout(u(this,ll)),D(this,ll,null))},US=function(){var t;(t=u(this,Gp))==null||t.abort(),D(this,Gp,null),u(this,Xp)!==null&&(clearTimeout(u(this,Xp)),D(this,Xp,null))},Ik=function(t){var i,n;switch(t){case Qi.STAMP:(i=u(this,X0))==null||i.loadModel("altText");break;case Qi.SIGNATURE:(n=u(this,Q0))==null||n.loadSignatures();break}};var ul,$r,jS,b3,y3,Lk,Nk;class xW{constructor(t,i){j(this,$r);j(this,ul);D(this,ul,t);const n=[{element:t.presentationModeButton,eventName:"presentationmode",close:!0},{element:t.printButton,eventName:"print",close:!0},{element:t.downloadButton,eventName:"download",close:!0},{element:t.viewBookmarkButton,eventName:null,close:!0},{element:t.firstPageButton,eventName:"firstpage",close:!0},{element:t.lastPageButton,eventName:"lastpage",close:!0},{element:t.pageRotateCwButton,eventName:"rotatecw",close:!1},{element:t.pageRotateCcwButton,eventName:"rotateccw",close:!1},{element:t.cursorSelectToolButton,eventName:"switchcursortool",eventDetails:{tool:Da.SELECT},close:!0},{element:t.cursorHandToolButton,eventName:"switchcursortool",eventDetails:{tool:Da.HAND},close:!0},{element:t.scrollPageButton,eventName:"switchscrollmode",eventDetails:{mode:Ci.PAGE},close:!0},{element:t.scrollVerticalButton,eventName:"switchscrollmode",eventDetails:{mode:Ci.VERTICAL},close:!0},{element:t.scrollHorizontalButton,eventName:"switchscrollmode",eventDetails:{mode:Ci.HORIZONTAL},close:!0},{element:t.scrollWrappedButton,eventName:"switchscrollmode",eventDetails:{mode:Ci.WRAPPED},close:!0},{element:t.spreadNoneButton,eventName:"switchspreadmode",eventDetails:{mode:Ws.NONE},close:!0},{element:t.spreadOddButton,eventName:"switchspreadmode",eventDetails:{mode:Ws.ODD},close:!0},{element:t.spreadEvenButton,eventName:"switchspreadmode",eventDetails:{mode:Ws.EVEN},close:!0},{element:t.imageAltTextSettingsButton,eventName:"imagealttextsettings",close:!0},{element:t.documentPropertiesButton,eventName:"documentproperties",close:!0}];n.push({element:t.openFileButton,eventName:"openfile",close:!0}),this.eventBus=i,this.opened=!1,R(this,$r,b3).call(this,n),this.reset()}get isOpen(){return this.opened}setPageNumber(t){this.pageNumber=t,R(this,$r,jS).call(this)}setPagesCount(t){this.pagesCount=t,R(this,$r,jS).call(this)}reset(){this.pageNumber=0,this.pagesCount=0,R(this,$r,jS).call(this),this.eventBus.dispatch("switchcursortool",{source:this,reset:!0}),R(this,$r,Lk).call(this,{mode:Ci.VERTICAL}),R(this,$r,Nk).call(this,{mode:Ws.NONE})}open(){if(this.opened)return;this.opened=!0;const{toggleButton:t,toolbar:i}=u(this,ul);bl(t,!0,i)}close(){if(!this.opened)return;this.opened=!1;const{toggleButton:t,toolbar:i}=u(this,ul);bl(t,!1,i)}toggle(){this.opened?this.close():this.open()}}ul=new WeakMap,$r=new WeakSet,jS=function(){const{firstPageButton:t,lastPageButton:i,pageRotateCwButton:n,pageRotateCcwButton:o}=u(this,ul);t.disabled=this.pageNumber<=1,i.disabled=this.pageNumber>=this.pagesCount,n.disabled=this.pagesCount===0,o.disabled=this.pagesCount===0},b3=function(t){const{eventBus:i}=this,{toggleButton:n}=u(this,ul);n.addEventListener("click",this.toggle.bind(this));for(const{element:o,eventName:l,close:c,eventDetails:d}of t)o.addEventListener("click",f=>{l!==null&&i.dispatch(l,{source:this,...d}),c&&this.close(),i.dispatch("reporttelemetry",{source:this,details:{type:"buttons",data:{id:o.id}}})});i._on("cursortoolchanged",R(this,$r,y3).bind(this)),i._on("scrollmodechanged",R(this,$r,Lk).bind(this)),i._on("spreadmodechanged",R(this,$r,Nk).bind(this))},y3=function({tool:t,disabled:i}){const{cursorSelectToolButton:n,cursorHandToolButton:o}=u(this,ul);no(n,t===Da.SELECT),no(o,t===Da.HAND),n.disabled=i,o.disabled=i},Lk=function({mode:t}){const{scrollPageButton:i,scrollVerticalButton:n,scrollHorizontalButton:o,scrollWrappedButton:l,spreadNoneButton:c,spreadOddButton:d,spreadEvenButton:f}=u(this,ul);no(i,t===Ci.PAGE),no(n,t===Ci.VERTICAL),no(o,t===Ci.HORIZONTAL),no(l,t===Ci.WRAPPED);const m=this.pagesCount>Kb.FORCE_SCROLL_MODE_PAGE;i.disabled=m,n.disabled=m,o.disabled=m,l.disabled=m;const b=t===Ci.HORIZONTAL;c.disabled=b,d.disabled=b,f.disabled=b},Nk=function({mode:t}){const{spreadNoneButton:i,spreadOddButton:n,spreadEvenButton:o}=u(this,ul);no(i,t===Ws.NONE),no(n,t===Ws.ODD),no(o,t===Ws.EVEN)};const iM=40;var Yw,Do,Zw,hl,cl,un,io,dl,Sh,fl,pl,ou,Aa,lu,Yp,Qw,Zp,xh,Jw,Td,Qp,Jp,eT,eg,Ah,Ed,Io,Ca,uu,e_,t_,tT,i_,iT,gl,Ch,sT,ci,v3,Mk,Zb,Ok,rc,w3,T3,E3,Fk,S3,x3,HS,Bk,A3,C3,VS,k3,P3;const uf=class uf{constructor({dialog:t,panels:i,typeButton:n,typeInput:o,drawButton:l,drawPlaceholder:c,drawSVG:d,drawThickness:f,imageButton:m,imageSVG:b,imagePlaceholder:T,imagePicker:C,imagePickerLink:P,description:x,clearButton:L,cancelButton:F,addButton:X,errorCloseButton:re,errorBar:K,saveCheckbox:te,saveContainer:ee},A,me,fe,J,ye,Oe){j(this,ci);j(this,Yw);j(this,Do,null);j(this,Zw);j(this,hl);j(this,cl);j(this,un);j(this,io);j(this,dl,null);j(this,Sh);j(this,fl,null);j(this,pl,"");j(this,ou,null);j(this,Aa);j(this,lu);j(this,Yp);j(this,Qw,null);j(this,Zp,null);j(this,xh);j(this,Jw);j(this,Td);j(this,Qp);j(this,Jp);j(this,eT);j(this,eg);j(this,Ah);j(this,Ed,null);j(this,Io);j(this,Ca,null);j(this,uu,null);j(this,e_,!1);j(this,t_);j(this,tT);j(this,i_);j(this,iT);j(this,gl);j(this,Ch,null);D(this,Yw,X),D(this,Zw,L),D(this,hl,x.lastElementChild),D(this,un,x.firstElementChild),D(this,io,t),D(this,Aa,d),D(this,Sh,c),D(this,lu,f),D(this,Yp,K),D(this,Qp,b),D(this,Td,T),D(this,xh,C),D(this,Jw,P),D(this,i_,fe),D(this,Jp,te),D(this,eT,ee),D(this,Ah,me),D(this,Io,o),D(this,tT,J),D(this,gl,ye),D(this,t_,Oe),D(this,iT,new AW(A,fe)),u(uf,sT)||D(uf,sT,Object.freeze({signature:"pdfjs-editor-add-signature-description-default-when-drawing"})),t.addEventListener("close",R(this,ci,k3).bind(this)),t.addEventListener("contextmenu",ot=>{const{target:Tt}=ot;Tt!==u(this,Io)&&Tt!==u(this,un)&&ot.preventDefault()}),t.addEventListener("drop",ot=>{du(ot)}),F.addEventListener("click",R(this,ci,C3).bind(this)),X.addEventListener("click",R(this,ci,P3).bind(this)),L.addEventListener("click",()=>{R(this,ci,HS).call(this,{type:"signature",action:"pdfjs.signature.clear",data:{type:u(this,Ca)}}),R(this,ci,Ok).call(this,null)},{passive:!0}),u(this,un).addEventListener("input",()=>{u(this,hl).disabled=u(this,un).value===""},{passive:!0}),u(this,hl).addEventListener("click",()=>{u(this,un).value="",u(this,hl).disabled=!0},{passive:!0}),re.addEventListener("click",()=>{K.hidden=!0},{passive:!0}),R(this,ci,v3).call(this,n,l,m,i),C.accept=BE.join(","),Oe._on("storedsignatureschanged",R(this,ci,A3).bind(this)),fe.register(t)}getSignature(t){return this.open(t)}async loadSignatures(t=!1){if(!u(this,Ah)||!t&&u(this,Ah).previousElementSibling||!u(this,gl)||!u(this,Ed)&&(D(this,Ed,u(this,gl).getAll().then(async l=>[l,await Promise.all(Array.from(l.values(),({signatureData:c})=>LA.decompressSignature(c)))])),!t))return;const[i,n]=await u(this,Ed);D(this,Ed,null);let o=0;for(const[l,{description:c}]of i){const d=n[o++];d&&(d.curves=d.outlines.map(f=>({points:f})),delete d.outlines,R(this,ci,Bk).call(this,d,l,c))}}async renderEditButton(t){const i=document.createElement("button");i.classList.add("altText","editDescription"),i.tabIndex=0,i.title=t.description;const n=document.createElement("span");return i.append(n),n.setAttribute("data-l10n-id","pdfjs-editor-add-signature-edit-button-label"),i.addEventListener("click",()=>{u(this,iT).open(t)},{passive:!0}),i}async open({uiManager:t,editor:i}){u(this,Do)||D(this,Do,new Map(u(this,eg).keys().map(l=>[l,{value:"",default:""}]))),D(this,Ch,t),D(this,cl,i),u(this,Ch).removeEditListeners();const n=await u(this,gl).isFull();u(this,eT).classList.toggle("fullStorage",n),u(this,Jp).checked=!n,await u(this,i_).open(u(this,io));const o=u(this,eg).get("type");o.focus(),o.click()}destroy(){D(this,Ch,null),R(this,ci,VS).call(this)}};Yw=new WeakMap,Do=new WeakMap,Zw=new WeakMap,hl=new WeakMap,cl=new WeakMap,un=new WeakMap,io=new WeakMap,dl=new WeakMap,Sh=new WeakMap,fl=new WeakMap,pl=new WeakMap,ou=new WeakMap,Aa=new WeakMap,lu=new WeakMap,Yp=new WeakMap,Qw=new WeakMap,Zp=new WeakMap,xh=new WeakMap,Jw=new WeakMap,Td=new WeakMap,Qp=new WeakMap,Jp=new WeakMap,eT=new WeakMap,eg=new WeakMap,Ah=new WeakMap,Ed=new WeakMap,Io=new WeakMap,Ca=new WeakMap,uu=new WeakMap,e_=new WeakMap,t_=new WeakMap,tT=new WeakMap,i_=new WeakMap,iT=new WeakMap,gl=new WeakMap,Ch=new WeakMap,sT=new WeakMap,ci=new WeakSet,v3=function(t,i,n,o){const l=D(this,eg,new Map([["type",t],["draw",i],["image",n]])),c=f=>{for(const[m,b]of l)b===f.target?(b.setAttribute("aria-selected",!0),b.setAttribute("tabindex",0),o.setAttribute("data-selected",m),R(this,ci,Ok).call(this,m)):(b.setAttribute("aria-selected",!1),b.setAttribute("tabindex",-1))},d=Array.from(l.values());for(let f=0,m=d.length;f<m;f++){const b=d[f];b.addEventListener("click",c,{passive:!0}),b.addEventListener("keydown",({key:T})=>{var C;T!=="ArrowLeft"&&T!=="ArrowRight"||(C=d[f+(T==="ArrowLeft"?-1:1)])==null||C.focus()},{passive:!0})}},Mk=function(){D(this,e_,!1),u(this,un).value="",u(this,Ca)&&(u(this,Do).get(u(this,Ca)).value="")},Zb=function(t){var i,n;switch(t){case"type":u(this,Io).value="";break;case"draw":D(this,dl,null),D(this,ou,null),D(this,pl,""),(i=u(this,fl))==null||i.remove(),D(this,fl,null),u(this,Sh).hidden=!1,u(this,lu).value=1;break;case"image":u(this,Td).hidden=!1,(n=u(this,Zp))==null||n.remove(),D(this,Zp,null);break}},Ok=function(t){var n;if(t&&u(this,Ca)===t)return;u(this,Ca)&&(u(this,Do).get(u(this,Ca)).value=u(this,un).value),t&&D(this,Ca,t),u(this,Yp).hidden=!0;const i=!t;switch(i?R(this,ci,Mk).call(this):u(this,un).value=u(this,Do).get(u(this,Ca)).value,u(this,hl).disabled=u(this,un).value==="",(n=u(this,uu))==null||n.abort(),D(this,uu,new AbortController),u(this,Ca)){case"type":R(this,ci,w3).call(this,i);break;case"draw":R(this,ci,T3).call(this,i);break;case"image":R(this,ci,E3).call(this,i);break}},rc=function(t){u(this,Jp).disabled=u(this,Zw).disabled=u(this,Yw).disabled=u(this,un).disabled=!t},w3=function(t){t&&R(this,ci,Zb).call(this,"type"),R(this,ci,rc).call(this,u(this,Io).value);const{signal:i}=u(this,uu),n={passive:!0,signal:i};u(this,Io).addEventListener("input",()=>{const{value:o}=u(this,Io);u(this,e_)||(u(this,Do).get("type").default=u(this,un).value=o,u(this,hl).disabled=o===""),R(this,ci,rc).call(this,o)},n),u(this,un).addEventListener("input",()=>{D(this,e_,u(this,Io).value!==u(this,un).value)},n)},T3=function(t){t&&R(this,ci,Zb).call(this,"draw"),R(this,ci,rc).call(this,u(this,fl));const{signal:i}=u(this,uu),n={signal:i};let o=NaN;const l=c=>{const{pointerId:d}=c;if(!isNaN(o)&&o!==d)return;o=d,c.preventDefault(),u(this,Aa).setPointerCapture(d);const{width:f,height:m}=u(this,Aa).getBoundingClientRect();let{offsetX:b,offsetY:T}=c;if(b=Math.round(b),T=Math.round(T),c.target===u(this,Sh)&&(u(this,Sh).hidden=!0),!u(this,dl)){D(this,dl,{width:f,height:m,thickness:parseInt(u(this,lu).value),curves:[]}),R(this,ci,rc).call(this,!0);const x=new ey,L=D(this,fl,x.createElement("path"));L.setAttribute("stroke-width",u(this,lu).value),u(this,Aa).append(L),u(this,Aa).addEventListener("pointerdown",l,n),u(this,Sh).removeEventListener("pointerdown",l),u(this,un).value===""&&u(this,tT).get(u(uf,sT).signature).then(F=>{var X;u(this,Do).get("draw").default=F,(X=u(this,un)).value||(X.value=F),u(this,hl).disabled=u(this,un).value===""})}D(this,ou,[b,T]),u(this,dl).curves.push({points:u(this,ou)}),D(this,pl,u(this,pl)+`M ${b} ${T}`),u(this,fl).setAttribute("d",u(this,pl));const C=new AbortController,P={signal:AbortSignal.any([i,C.signal])};u(this,Aa).addEventListener("contextmenu",Dx,P),u(this,Aa).addEventListener("pointermove",x=>{x.preventDefault();let{offsetX:L,offsetY:F}=x;L=Math.round(L),F=Math.round(F);const X=u(this,ou);if(!(L<0||F<0||L>f||F>m||L===X.at(-2)&&F===X.at(-1))){if(X.length>=4){const[re,K,te,ee]=X.slice(-4);D(this,pl,u(this,pl)+`C${(re+5*te)/6} ${(K+5*ee)/6} ${(5*te+L)/6} ${(5*ee+F)/6} ${(te+L)/2} ${(ee+F)/2}`)}else D(this,pl,u(this,pl)+`L${L} ${F}`);X.push(L,F),u(this,fl).setAttribute("d",u(this,pl))}},P),u(this,Aa).addEventListener("pointerup",x=>{const{pointerId:L}=x;!isNaN(o)&&o!==L||(o=NaN,x.preventDefault(),u(this,Aa).releasePointerCapture(L),C.abort(),u(this,ou).length===2&&(D(this,pl,u(this,pl)+`L${u(this,ou)[0]} ${u(this,ou)[1]}`),u(this,fl).setAttribute("d",u(this,pl))))},P)};u(this,dl)?u(this,Aa).addEventListener("pointerdown",l,n):u(this,Sh).addEventListener("pointerdown",l,n),u(this,lu).addEventListener("input",()=>{const{value:c}=u(this,lu);u(this,lu).setAttribute("data-l10n-args",JSON.stringify({thickness:c})),u(this,dl)&&(u(this,fl).setAttribute("stroke-width",c),u(this,dl).thickness=c)},n)},E3=function(t){t&&R(this,ci,Zb).call(this,"image"),R(this,ci,rc).call(this,u(this,Zp));const{signal:i}=u(this,uu),n={signal:i},o={passive:!0,signal:i};u(this,Jw).addEventListener("keydown",l=>{const{key:c}=l;(c==="Enter"||c===" ")&&(du(l),u(this,xh).click())},n),u(this,xh).addEventListener("click",()=>{u(this,io).classList.toggle("waiting",!0)},o),u(this,xh).addEventListener("change",async()=>{var c;const l=(c=u(this,xh).files)==null?void 0:c[0];if(!l||!BE.includes(l.type)){u(this,Yp).hidden=!1,u(this,io).classList.toggle("waiting",!1);return}await R(this,ci,Fk).call(this,l)},o),u(this,xh).addEventListener("cancel",()=>{u(this,io).classList.toggle("waiting",!1)},o),u(this,Td).addEventListener("dragover",l=>{const{dataTransfer:c}=l;for(const{type:d}of c.items)if(BE.includes(d)){c.dropEffect=c.effectAllowed==="copy"?"copy":"move",du(l);return}c.dropEffect="none"},n),u(this,Td).addEventListener("drop",l=>{const{dataTransfer:{files:c}}=l;if(c!=null&&c.length){for(const d of c)if(BE.includes(d.type)){R(this,ci,Fk).call(this,d);break}du(l),u(this,io).classList.toggle("waiting",!0)}},n)},Fk=async function(t){let i;try{i=await u(this,Ch).imageManager.getFromFile(t)}catch(c){console.error("SignatureManager.#extractSignature.",c)}if(!i){u(this,Yp).hidden=!1,u(this,io).classList.toggle("waiting",!1);return}const{outline:n}=D(this,Qw,u(this,cl).getFromImage(i.bitmap));if(!n){u(this,io).classList.toggle("waiting",!1);return}u(this,Td).hidden=!0,R(this,ci,rc).call(this,!0);const o=new ey,l=D(this,Zp,o.createElement("path"));u(this,Qp).setAttribute("viewBox",n.viewBox),u(this,Qp).setAttribute("preserveAspectRatio","xMidYMid meet"),u(this,Qp).append(l),l.setAttribute("d",n.toSVGPath()),u(this,Do).get("image").default=t.name,u(this,un).value===""&&(u(this,un).value=t.name||"",u(this,hl).disabled=u(this,un).value===""),u(this,io).classList.toggle("waiting",!1)},S3=function(){return u(this,cl).getFromText(u(this,Io).value,window.getComputedStyle(u(this,Io)))},x3=function(){const{width:t,height:i}=u(this,Aa).getBoundingClientRect();return u(this,cl).getDrawnSignature(u(this,dl),t,i)},HS=function(t){u(this,t_).dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})},Bk=function(t,i,n){const{curves:o,areContours:l,thickness:c,width:d,height:f}=t,m=Math.max(d,f),b=LA.processDrawnLines({lines:{curves:o,thickness:c,width:d,height:f},pageWidth:m,pageHeight:m,rotation:0,innerMargin:0,mustSmooth:!1,areContours:l});if(!b)return;const{outline:T}=b,C=new ey,P=document.createElement("div"),x=document.createElement("button");x.addEventListener("click",()=>{u(this,t_).dispatch("switchannotationeditorparams",{source:this,type:zo.CREATE,value:{signatureData:{lines:{curves:o,thickness:c,width:d,height:f},mustSmooth:!1,areContours:l,description:n,uuid:i,heightInPage:iM}}})}),P.append(x),P.classList.add("toolbarAddSignatureButtonContainer");const L=C.create(1,1,!0);x.append(L);const F=document.createElement("span");F.ariaHidden=!0,x.append(F),x.classList.add("toolbarAddSignatureButton"),x.type="button",F.textContent=n,x.setAttribute("data-l10n-id","pdfjs-editor-add-saved-signature-button"),x.setAttribute("data-l10n-args",JSON.stringify({description:n})),x.tabIndex=0;const X=C.createElement("path");L.append(X),L.setAttribute("viewBox",T.viewBox),L.setAttribute("preserveAspectRatio","xMidYMid meet"),l&&X.classList.add("contours"),X.setAttribute("d",T.toSVGPath());const re=document.createElement("button");P.append(re),re.classList.add("toolbarButton","deleteButton"),re.setAttribute("data-l10n-id","pdfjs-editor-delete-signature-button1"),re.type="button",re.tabIndex=0,re.addEventListener("click",async()=>{await u(this,gl).delete(i)&&(P.remove(),R(this,ci,HS).call(this,{type:"signature",action:"pdfjs.signature.delete_saved",data:{savedCount:await u(this,gl).size()}}))});const K=document.createElement("span");re.append(K),K.setAttribute("data-l10n-id","pdfjs-editor-delete-signature-button-label1"),u(this,Ah).before(P)},A3=async function(){const t=u(this,Ah).parentElement;for(;t.firstElementChild!==u(this,Ah);)t.firstElementChild.remove();D(this,Ed,null),await this.loadSignatures(!0)},C3=function(){R(this,ci,VS).call(this)},VS=function(){u(this,i_).closeIfActive(u(this,io))},k3=function(){var t,i;u(this,cl)._drawId===null&&u(this,cl).remove(),(t=u(this,Ch))==null||t.addEditListeners(),(i=u(this,uu))==null||i.abort(),D(this,uu,null),D(this,Ch,null),D(this,cl,null),R(this,ci,Mk).call(this);for(const[n]of u(this,eg))R(this,ci,Zb).call(this,n);R(this,ci,rc).call(this,!1),D(this,Ca,null),D(this,Do,null)},P3=async function(){let t;const i=u(this,Ca);switch(i){case"type":t=R(this,ci,S3).call(this);break;case"draw":t=R(this,ci,x3).call(this);break;case"image":t=u(this,Qw);break}let n=null;const o=u(this,un).value;if(u(this,Jp).checked){const{newCurves:c,areContours:d,thickness:f,width:m,height:b}=t,T=await LA.compressSignature({outlines:c,areContours:d,thickness:f,width:m,height:b});n=await u(this,gl).create({description:o,signatureData:T}),n?R(this,ci,Bk).call(this,{curves:c.map(C=>({points:C})),areContours:d,thickness:f,width:m,height:b},n,o):console.warn("SignatureManager.add: cannot save the signature.")}const l=u(this,Do).get(i);R(this,ci,HS).call(this,{type:"signature",action:"pdfjs.signature.created",data:{type:i,saved:!!n,savedCount:await u(this,gl).size(),descriptionChanged:o!==l.default}}),u(this,cl).addSignature(t,iM,u(this,un).value,n),R(this,ci,VS).call(this)},j(uf,sT,null);let Rk=uf;var Sd,s_,xd,n_,r_,tg,ig,wl,D3,I3,Uk,L3;class AW{constructor({dialog:t,description:i,cancelButton:n,updateButton:o,editSignatureView:l},c){j(this,wl);j(this,Sd);j(this,s_);j(this,xd);j(this,n_);j(this,r_);j(this,tg);j(this,ig);const d=D(this,xd,i.firstElementChild);D(this,tg,l),D(this,n_,t),D(this,r_,c),t.addEventListener("close",R(this,wl,L3).bind(this)),t.addEventListener("contextmenu",m=>{m.target!==u(this,xd)&&m.preventDefault()}),n.addEventListener("click",R(this,wl,I3).bind(this)),o.addEventListener("click",R(this,wl,D3).bind(this));const f=i.lastElementChild;f.addEventListener("click",()=>{d.value="",f.disabled=!0,o.disabled=u(this,s_)===""}),d.addEventListener("input",()=>{const{value:m}=d;f.disabled=m==="",o.disabled=m===u(this,s_),l.setAttribute("aria-label",m)},{passive:!0}),c.register(t)}async open(t){D(this,ig,t._uiManager),D(this,Sd,t),D(this,s_,u(this,xd).value=t.description),u(this,xd).dispatchEvent(new Event("input")),u(this,ig).removeEditListeners();const{areContours:i,outline:n}=t.getSignaturePreview(),l=new ey().createElement("path");u(this,tg).append(l),u(this,tg).setAttribute("viewBox",n.viewBox),l.setAttribute("d",n.toSVGPath()),i&&l.classList.add("contours"),await u(this,r_).open(u(this,n_))}}Sd=new WeakMap,s_=new WeakMap,xd=new WeakMap,n_=new WeakMap,r_=new WeakMap,tg=new WeakMap,ig=new WeakMap,wl=new WeakSet,D3=async function(){u(this,Sd)._reportTelemetry({action:"pdfjs.signature.edit_description",data:{hasBeenChanged:!0}}),u(this,Sd).description=u(this,xd).value,R(this,wl,Uk).call(this)},I3=function(){u(this,Sd)._reportTelemetry({action:"pdfjs.signature.edit_description",data:{hasBeenChanged:!1}}),R(this,wl,Uk).call(this)},Uk=function(){u(this,r_).closeIfActive(u(this,n_))},L3=function(){var t;(t=u(this,ig))==null||t.addEditListeners(),D(this,ig,null),D(this,Sd,null),u(this,tg).firstElementChild.remove()};var a_,Ad,aa,jk,N3,Hk,Qb;class CW{constructor(t,i,n=0){j(this,aa);j(this,a_,null);j(this,Ad);D(this,Ad,t),this.eventBus=i;const o=[{element:t.previous,eventName:"previouspage"},{element:t.next,eventName:"nextpage"},{element:t.zoomIn,eventName:"zoomin"},{element:t.zoomOut,eventName:"zoomout"},{element:t.print,eventName:"print"},{element:t.download,eventName:"download"},{element:t.editorFreeTextButton,eventName:"switchannotationeditormode",eventDetails:{get mode(){const{classList:l}=t.editorFreeTextButton;return l.contains("toggled")?Qi.NONE:Qi.FREETEXT}}},{element:t.editorHighlightButton,eventName:"switchannotationeditormode",eventDetails:{get mode(){const{classList:l}=t.editorHighlightButton;return l.contains("toggled")?Qi.NONE:Qi.HIGHLIGHT}}},{element:t.editorInkButton,eventName:"switchannotationeditormode",eventDetails:{get mode(){const{classList:l}=t.editorInkButton;return l.contains("toggled")?Qi.NONE:Qi.INK}}},{element:t.editorStampButton,eventName:"switchannotationeditormode",eventDetails:{get mode(){const{classList:l}=t.editorStampButton;return l.contains("toggled")?Qi.NONE:Qi.STAMP}},telemetry:{type:"editing",data:{action:"pdfjs.image.icon_click"}}},{element:t.editorSignatureButton,eventName:"switchannotationeditormode",eventDetails:{get mode(){const{classList:l}=t.editorSignatureButton;return l.contains("toggled")?Qi.NONE:Qi.SIGNATURE}}}];R(this,aa,N3).call(this,o),R(this,aa,jk).call(this,{value:n}),this.reset()}setPageNumber(t,i){this.pageNumber=t,this.pageLabel=i,R(this,aa,Qb).call(this,!1)}setPagesCount(t,i){this.pagesCount=t,this.hasPageLabels=i,R(this,aa,Qb).call(this,!0)}setPageScale(t,i){this.pageScaleValue=(t||i).toString(),this.pageScale=i,R(this,aa,Qb).call(this,!1)}reset(){D(this,a_,null),this.pageNumber=0,this.pageLabel=null,this.hasPageLabels=!1,this.pagesCount=0,this.pageScaleValue=ty,this.pageScale=aP,R(this,aa,Qb).call(this,!0),this.updateLoadingIndicatorState(),R(this,aa,Hk).call(this,{mode:Qi.DISABLE})}updateLoadingIndicatorState(t=!1){const{pageNumber:i}=u(this,Ad);i.classList.toggle("loading",t)}}a_=new WeakMap,Ad=new WeakMap,aa=new WeakSet,jk=function({value:t}){let i="normal";switch(t){case 1:i="compact";break;case 2:i="touch";break}document.documentElement.setAttribute("data-toolbar-density",i)},N3=function(t){const{eventBus:i}=this,{editorHighlightColorPicker:n,editorHighlightButton:o,pageNumber:l,scaleSelect:c}=u(this,Ad),d=this;for(const{element:f,eventName:m,eventDetails:b,telemetry:T}of t)f.addEventListener("click",C=>{m!==null&&i.dispatch(m,{source:this,...b,isFromKeyboard:C.detail===0}),T&&i.dispatch("reporttelemetry",{source:this,details:T})});l.addEventListener("click",function(){this.select()}),l.addEventListener("change",function(){i.dispatch("pagenumberchanged",{source:d,value:this.value})}),c.addEventListener("change",function(){this.value!=="custom"&&i.dispatch("scalechanged",{source:d,value:this.value})}),c.addEventListener("click",function({target:f}){this.value===d.pageScaleValue&&f.tagName.toUpperCase()==="OPTION"&&this.blur()}),c.oncontextmenu=Dx,i._on("annotationeditormodechanged",R(this,aa,Hk).bind(this)),i._on("showannotationeditorui",({mode:f})=>{switch(f){case Qi.HIGHLIGHT:o.click();break}}),i._on("toolbardensity",R(this,aa,jk).bind(this)),n&&(i._on("annotationeditoruimanager",({uiManager:f})=>{const m=D(this,a_,new Iz({uiManager:f}));f.setMainHighlightColorPicker(m),n.append(m.renderMainDropdown())}),i._on("mainhighlightcolorpickerupdatecolor",({value:f})=>{var m;(m=u(this,a_))==null||m.updateColor(f)}))},Hk=function({mode:t}){const{editorFreeTextButton:i,editorFreeTextParamsToolbar:n,editorHighlightButton:o,editorHighlightParamsToolbar:l,editorInkButton:c,editorInkParamsToolbar:d,editorStampButton:f,editorStampParamsToolbar:m,editorSignatureButton:b,editorSignatureParamsToolbar:T}=u(this,Ad);bl(i,t===Qi.FREETEXT,n),bl(o,t===Qi.HIGHLIGHT,l),bl(c,t===Qi.INK,d),bl(f,t===Qi.STAMP,m),bl(b,t===Qi.SIGNATURE,T);const C=t===Qi.DISABLE;i.disabled=C,o.disabled=C,c.disabled=C,f.disabled=C,b.disabled=C},Qb=function(t=!1){const{pageNumber:i,pagesCount:n,pageScaleValue:o,pageScale:l}=this,c=u(this,Ad);t&&(this.hasPageLabels?(c.pageNumber.type="text",c.numPages.setAttribute("data-l10n-id","pdfjs-page-of-pages")):(c.pageNumber.type="number",c.numPages.setAttribute("data-l10n-id","pdfjs-of-pages"),c.numPages.setAttribute("data-l10n-args",JSON.stringify({pagesCount:n}))),c.pageNumber.max=n),this.hasPageLabels?(c.pageNumber.value=this.pageLabel,c.numPages.setAttribute("data-l10n-args",JSON.stringify({pageNumber:i,pagesCount:n}))):c.pageNumber.value=i,c.previous.disabled=i<=1,c.next.disabled=i>=n,c.zoomOut.disabled=l<=PF,c.zoomIn.disabled=l>=DF;let d=!1;for(const f of c.scaleSelect.options){if(f.value!==o){f.selected=!1;continue}f.selected=!0,d=!0}d||(c.customScaleOption.selected=!0,c.customScaleOption.setAttribute("data-l10n-args",JSON.stringify({scale:Math.round(l*1e4)/100})))};const kW=20;class PW{constructor(t,i=kW){this.fingerprint=t,this.cacheSize=i,this._initializedPromise=this._readFromStorage().then(n=>{const o=JSON.parse(n||"{}");let l=-1;if(!Array.isArray(o.files))o.files=[];else{for(;o.files.length>=this.cacheSize;)o.files.shift();for(let c=0,d=o.files.length;c<d;c++)if(o.files[c].fingerprint===this.fingerprint){l=c;break}}l===-1&&(l=o.files.push({fingerprint:this.fingerprint})-1),this.file=o.files[l],this.database=o})}async _writeToStorage(){const t=JSON.stringify(this.database);localStorage.setItem("pdfjs.history",t)}async _readFromStorage(){return localStorage.getItem("pdfjs.history")}async set(t,i){return await this._initializedPromise,this.file[t]=i,this._writeToStorage()}async setMultiple(t){await this._initializedPromise;for(const i in t)this.file[i]=t[i];return this._writeToStorage()}async get(t,i){await this._initializedPromise;const n=this.file[t];return n!==void 0?n:i}async getMultiple(t){await this._initializedPromise;const i=Object.create(null);for(const n in t){const o=this.file[n];i[n]=o!==void 0?o:t[n]}return i}}const DW=1e4,qA={UNKNOWN:-1,INITIAL:1},dT={initialBookmark:document.location.hash.substring(1),_initializedCapability:{...Promise.withResolvers(),settled:!1},appConfig:null,pdfDocument:null,pdfLoadingTask:null,printService:null,pdfViewer:null,pdfThumbnailViewer:null,pdfRenderingQueue:null,pdfPresentationMode:null,pdfDocumentProperties:null,pdfLinkService:null,pdfHistory:null,pdfSidebar:null,pdfOutlineViewer:null,pdfAttachmentViewer:null,pdfLayerViewer:null,pdfCursorTools:null,pdfScriptingManager:null,store:null,downloadManager:null,overlayManager:null,preferences:new i9,toolbar:null,secondaryToolbar:null,eventBus:null,l10n:null,annotationEditorParams:null,imageAltTextSettings:null,isInitialViewSet:!1,isViewerEmbedded:window.parent!==window,url:"",baseUrl:"",mlManager:null,_downloadUrl:"",_eventBusAbortController:null,_windowAbortController:null,_globalAbortController:new AbortController,documentInfo:null,metadata:null,_contentDispositionFilename:null,_contentLength:null,_saveInProgress:!1,_wheelUnusedTicks:0,_wheelUnusedFactor:1,_touchManager:null,_touchUnusedTicks:0,_touchUnusedFactor:1,_PDFBug:null,_hasAnnotationEditors:!1,_title:document.title,_printAnnotationStoragePromise:null,_isCtrlKeyDown:!1,_caretBrowsing:null,_isScrolling:!1,editorUndoBar:null,async initialize(g){this.appConfig=g;try{await this.preferences.initializedPromise}catch(i){console.error("initialize:",i)}Nt.get("pdfBugEnabled")&&await this._parseHashParams();let t;switch(Nt.get("viewerCssTheme")){case 1:t="light";break;case 2:t="dark";break}t&&lP.setProperty("color-scheme",t),this.l10n=await this.externalServices.createL10n(),document.getElementsByTagName("html")[0].dir=this.l10n.getDirection(),this.l10n.translate(g.appContainer||document.documentElement),this.isViewerEmbedded&&Nt.get("externalLinkTarget")===Lu.NONE&&Nt.set("externalLinkTarget",Lu.TOP),await this._initializeViewerComponents(),this.bindEvents(),this.bindWindowEvents(),this._initializedCapability.settled=!0,this._initializedCapability.resolve()},async _parseHashParams(){var c;const g=document.location.hash.substring(1);if(!g)return;const{mainContainer:t,viewerContainer:i}=this.appConfig,n=hy(g),o=async()=>{if(this._PDFBug)return;const{PDFBug:d}=await import(Nt.get("debuggerSrc"));this._PDFBug=d};if(n.get("disableworker")==="true")try{OE.workerSrc||(OE.workerSrc=Nt.get("workerSrc")),await import(Wz.workerSrc),Nt.set("workerPort",null)}catch(d){console.error("_parseHashParams:",d)}if(n.has("textlayer"))switch(n.get("textlayer")){case"off":Nt.set("textLayerMode",_l.DISABLE);break;case"visible":case"shadow":case"hover":i.classList.add(`textLayer-${n.get("textlayer")}`);try{await o(),this._PDFBug.loadCSS()}catch(d){console.error("_parseHashParams:",d)}break}if(n.has("pdfbug")){const d=n.get("pdfbug").split(",");try{await o(),this._PDFBug.init(t,d)}catch(m){console.error("_parseHashParams:",m)}const f={pdfBug:!0,fontExtraProperties:!0};(c=globalThis.StepperManager)!=null&&c.enabled&&(f.minDurationToUpdateCanvas=0),Nt.setAll(f)}n.has("locale")&&Nt.set("localeProperties",{lang:n.get("locale")});const l={disableAutoFetch:d=>d==="true",disableFontFace:d=>d==="true",disableHistory:d=>d==="true",disableRange:d=>d==="true",disableStream:d=>d==="true",verbosity:d=>d|0};for(const d in l){const f=l[d],m=d.toLowerCase();n.has(m)&&Nt.set(d,f(n.get(m)))}},async _initializeViewerComponents(){var me,fe,J,ye,Oe,ot,Tt,dt,kt,$e,vt,Jt;const{appConfig:g,externalServices:t,l10n:i,mlManager:n}=this,o=this._globalAbortController.signal,l=new jF;this.eventBus=Nt.eventBus=l,n==null||n.setEventBus(l,o);const c=this.overlayManager=new u9,d=this.pdfRenderingQueue=new HB;d.onIdle=this._cleanup.bind(this);const f=this.pdfLinkService=new FF({eventBus:l,externalLinkTarget:Nt.get("externalLinkTarget"),externalLinkRel:Nt.get("externalLinkRel"),ignoreDestinationZoom:Nt.get("ignoreDestinationZoom")}),m=this.downloadManager=new l9,b=this.findController=new B9({linkService:f,eventBus:l,updateMatchesCountOnProgress:!0}),T=this.pdfScriptingManager=new nW({eventBus:l,externalServices:t,docProperties:this._scriptingDocProperties.bind(this)}),C=g.mainContainer,P=g.viewerContainer,x=Nt.get("annotationEditorMode"),L=Nt.get("forcePageColors")||window.matchMedia("(forced-colors: active)").matches?{background:Nt.get("pageColorsBackground"),foreground:Nt.get("pageColorsForeground")}:null;let F;Nt.get("enableUpdatedAddImage")?F=g.newAltTextDialog?new n9(g.newAltTextDialog,c,l):null:F=g.altTextDialog?new a9(g.altTextDialog,C,c,l):null,g.editorUndoBar&&(this.editorUndoBar=new O2(g.editorUndoBar,l));const X=Nt.get("enableSignatureEditor")&&g.addSignatureDialog?new Rk(g.addSignatureDialog,g.editSignatureDialog,((me=g.annotationEditorParams)==null?void 0:me.editorSignatureAddSignature)||null,c,i,t.createSignatureStorage(l,o),l):null,re=Nt.get("enableHWA"),K=Nt.get("maxCanvasPixels"),te=Nt.get("maxCanvasDim"),ee=Nt.get("capCanvasAreaFactor"),A=this.pdfViewer=new SW({container:C,viewer:P,eventBus:l,renderingQueue:d,linkService:f,downloadManager:m,altTextManager:F,signatureManager:X,editorUndoBar:this.editorUndoBar,findController:b,scriptingManager:Nt.get("enableScripting")&&T,l10n:i,textLayerMode:Nt.get("textLayerMode"),annotationMode:Nt.get("annotationMode"),annotationEditorMode:x,annotationEditorHighlightColors:Nt.get("highlightEditorColors"),enableHighlightFloatingButton:Nt.get("enableHighlightFloatingButton"),enableUpdatedAddImage:Nt.get("enableUpdatedAddImage"),enableNewAltTextWhenAddingImage:Nt.get("enableNewAltTextWhenAddingImage"),imageResourcesPath:Nt.get("imageResourcesPath"),enablePrintAutoRotate:Nt.get("enablePrintAutoRotate"),maxCanvasPixels:K,maxCanvasDim:te,capCanvasAreaFactor:ee,enableDetailCanvas:Nt.get("enableDetailCanvas"),enablePermissions:Nt.get("enablePermissions"),pageColors:L,mlManager:n,abortSignal:o,enableHWA:re,supportsPinchToZoom:this.supportsPinchToZoom,enableAutoLinking:Nt.get("enableAutoLinking"),minDurationToUpdateCanvas:Nt.get("minDurationToUpdateCanvas")});if(d.setViewer(A),f.setViewer(A),T.setViewer(A),(fe=g.sidebar)!=null&&fe.thumbnailView&&(this.pdfThumbnailViewer=new hW({container:g.sidebar.thumbnailView,eventBus:l,renderingQueue:d,linkService:f,maxCanvasPixels:K,maxCanvasDim:te,pageColors:L,abortSignal:o,enableHWA:re}),d.setThumbnailViewer(this.pdfThumbnailViewer)),!this.isViewerEmbedded&&!Nt.get("disableHistory")&&(this.pdfHistory=new z9({linkService:f,eventBus:l}),f.setHistory(this.pdfHistory)),!this.supportsIntegratedFind&&g.findBar&&(this.findBar=new j9(g.findBar,g.principalContainer,l)),g.annotationEditorParams)if(x!==Qi.DISABLE){const di=(J=g.toolbar)==null?void 0:J.editorSignatureButton;di&&Nt.get("enableSignatureEditor")&&(di.parentElement.hidden=!1),this.annotationEditorParams=new o9(g.annotationEditorParams,l)}else for(const di of["editorModeButtons","editorModeSeparator"])(ye=document.getElementById(di))==null||ye.classList.add("hidden");n&&((Oe=g.secondaryToolbar)!=null&&Oe.imageAltTextSettingsButton)&&(this.imageAltTextSettings=new r9(g.altTextSettingsDialog,c,l,n)),g.documentProperties&&(this.pdfDocumentProperties=new _9(g.documentProperties,c,l,i,()=>this._docFilename,()=>this._docTitle)),(ot=g.secondaryToolbar)!=null&&ot.cursorHandToolButton&&(this.pdfCursorTools=new p9({container:C,eventBus:l,cursorToolOnLoad:Nt.get("cursorToolOnLoad")})),g.toolbar&&(this.toolbar=new CW(g.toolbar,l,Nt.get("toolbarDensity"))),g.secondaryToolbar&&(Nt.get("enableAltText")&&((Tt=g.secondaryToolbar.imageAltTextSettingsButton)==null||Tt.classList.remove("hidden"),(dt=g.secondaryToolbar.imageAltTextSettingsSeparator)==null||dt.classList.remove("hidden")),this.secondaryToolbar=new xW(g.secondaryToolbar,l)),this.supportsFullscreen&&((kt=g.secondaryToolbar)!=null&&kt.presentationModeButton)&&(this.pdfPresentationMode=new Q9({container:C,pdfViewer:A,eventBus:l})),g.passwordOverlay&&(this.passwordPrompt=new h9(g.passwordOverlay,c,this.isViewerEmbedded)),($e=g.sidebar)!=null&&$e.outlineView&&(this.pdfOutlineViewer=new X9({container:g.sidebar.outlineView,eventBus:l,l10n:i,linkService:f,downloadManager:m})),(vt=g.sidebar)!=null&&vt.attachmentsView&&(this.pdfAttachmentViewer=new d9({container:g.sidebar.attachmentsView,eventBus:l,l10n:i,downloadManager:m})),(Jt=g.sidebar)!=null&&Jt.layersView&&(this.pdfLayerViewer=new G9({container:g.sidebar.layersView,eventBus:l,l10n:i})),g.sidebar&&(this.pdfSidebar=new aW({elements:g.sidebar,eventBus:l,l10n:i}),this.pdfSidebar.onToggled=this.forceRendering.bind(this),this.pdfSidebar.onUpdateThumbnails=()=>{var di;for(const Ut of A.getCachedPageViews())Ut.renderingState===Ii.FINISHED&&((di=this.pdfThumbnailViewer.getThumbnail(Ut.id-1))==null||di.setImage(Ut));this.pdfThumbnailViewer.scrollThumbnailIntoView(A.currentPageNumber)})},async run(g){var d,f,m,b,T,C;await this.initialize(g);const{appConfig:t,eventBus:i}=this;let n;const o=document.location.search.substring(1);n=hy(o).get("file")??Nt.get("defaultUrl"),IW(n);const c=this._openFileInput=document.createElement("input");c.id="fileInput",c.hidden=!0,c.type="file",c.value=null,document.body.append(c),c.addEventListener("change",function(P){const{files:x}=P.target;!x||x.length===0||i.dispatch("fileinputchange",{source:this,fileInput:P.target})}),t.mainContainer.addEventListener("dragover",function(P){for(const x of P.dataTransfer.items)if(x.type==="application/pdf"){P.dataTransfer.dropEffect=P.dataTransfer.effectAllowed==="copy"?"copy":"move",du(P);return}}),t.mainContainer.addEventListener("drop",function(P){var x;((x=P.dataTransfer.files)==null?void 0:x[0].type)==="application/pdf"&&(du(P),i.dispatch("fileinputchange",{source:this,fileInput:P.dataTransfer}))}),Nt.get("supportsDocumentFonts")||(Nt.set("disableFontFace",!0),this.l10n.get("pdfjs-web-fonts-disabled").then(P=>{console.warn(P)})),this.supportsPrinting||((f=(d=t.toolbar)==null?void 0:d.print)==null||f.classList.add("hidden"),(m=t.secondaryToolbar)==null||m.printButton.classList.add("hidden")),this.supportsFullscreen||(b=t.secondaryToolbar)==null||b.presentationModeButton.classList.add("hidden"),this.supportsIntegratedFind&&((C=(T=t.findBar)==null?void 0:T.toggleButton)==null||C.classList.add("hidden")),n?this.open({url:n}):this._hideViewBookmark()},get externalServices(){return Pa(this,"externalServices",new s9)},get initialized(){return this._initializedCapability.settled},get initializedPromise(){return this._initializedCapability.promise},updateZoom(g,t,i){this.pdfViewer.isInPresentationMode||this.pdfViewer.updateScale({drawingDelay:Nt.get("defaultZoomDelay"),steps:g,scaleFactor:t,origin:i})},zoomIn(){this.updateZoom(1)},zoomOut(){this.updateZoom(-1)},zoomReset(){this.pdfViewer.isInPresentationMode||(this.pdfViewer.currentScaleValue=ty)},touchPinchCallback(g,t,i){if(this.supportsPinchToZoom){const n=this._accumulateFactor(this.pdfViewer.currentScale,i/t,"_touchUnusedFactor");this.updateZoom(null,n,g)}else{const o=this._accumulateTicks((i-t)/30,"_touchUnusedTicks");this.updateZoom(o,null,g)}},touchPinchEndCallback(){this._touchUnusedTicks=0,this._touchUnusedFactor=1},get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0},get page(){return this.pdfViewer.currentPageNumber},set page(g){this.pdfViewer.currentPageNumber=g},get supportsPrinting(){return Pa(this,"supportsPrinting",Nt.get("supportsPrinting")&&ik.supportsPrinting)},get supportsFullscreen(){return Pa(this,"supportsFullscreen",document.fullscreenEnabled)},get supportsPinchToZoom(){return Pa(this,"supportsPinchToZoom",Nt.get("supportsPinchToZoom"))},get supportsIntegratedFind(){return Pa(this,"supportsIntegratedFind",Nt.get("supportsIntegratedFind"))},get loadingBar(){const g=document.getElementById("loadingBar"),t=g?new t7(g):null;return Pa(this,"loadingBar",t)},get supportsMouseWheelZoomCtrlKey(){return Pa(this,"supportsMouseWheelZoomCtrlKey",Nt.get("supportsMouseWheelZoomCtrlKey"))},get supportsMouseWheelZoomMetaKey(){return Pa(this,"supportsMouseWheelZoomMetaKey",Nt.get("supportsMouseWheelZoomMetaKey"))},get supportsCaretBrowsingMode(){return Nt.get("supportsCaretBrowsingMode")},moveCaret(g,t){var i;this._caretBrowsing||(this._caretBrowsing=new D2(this._globalAbortController.signal,this.appConfig.mainContainer,this.appConfig.viewerContainer,(i=this.appConfig.toolbar)==null?void 0:i.container)),this._caretBrowsing.moveCaret(g,t)},setTitleUsingUrl(g="",t=null){this.url=g,this.baseUrl=u2(g,"",!0),t&&(this._downloadUrl=t===g?this.baseUrl:u2(t,"",!0)),Uz(g)&&this._hideViewBookmark();let i=fR(g,"");if(!i)try{i=decodeURIComponent(Mz(g))}catch{}this.setTitle(i||g)},setTitle(g=this._title){if(this._title=g,this.isViewerEmbedded)return;const t=this._hasAnnotationEditors&&!this.pdfRenderingQueue.printing;document.title=`${t?"* ":""}${g}`},get _docFilename(){return this._contentDispositionFilename||fR(this.url)},get _docTitle(){const{documentInfo:g,metadata:t}=this,i=t==null?void 0:t.get("dc:title");return i&&i!=="Untitled"&&!/[\uFFF0-\uFFFF]/g.test(i)?i:g.Title},_hideViewBookmark(){var t;const{secondaryToolbar:g}=this.appConfig;g==null||g.viewBookmarkButton.classList.add("hidden"),g!=null&&g.presentationModeButton.classList.contains("hidden")&&((t=document.getElementById("viewBookmarkSeparator"))==null||t.classList.add("hidden"))},async close(){var t,i,n,o,l,c,d,f,m,b,T,C;if(this._unblockDocumentLoadEvent(),this._hideViewBookmark(),!this.pdfLoadingTask)return;if(((t=this.pdfDocument)==null?void 0:t.annotationStorage.size)>0&&this._annotationStorageModified)try{await this.save()}catch{}const g=[];g.push(this.pdfLoadingTask.destroy()),this.pdfLoadingTask=null,this.pdfDocument&&(this.pdfDocument=null,(i=this.pdfThumbnailViewer)==null||i.setDocument(null),this.pdfViewer.setDocument(null),this.pdfLinkService.setDocument(null),(n=this.pdfDocumentProperties)==null||n.setDocument(null)),this.pdfLinkService.externalLinkEnabled=!0,this.store=null,this.isInitialViewSet=!1,this.url="",this.baseUrl="",this._downloadUrl="",this.documentInfo=null,this.metadata=null,this._contentDispositionFilename=null,this._contentLength=null,this._saveInProgress=!1,this._hasAnnotationEditors=!1,g.push(this.pdfScriptingManager.destroyPromise,this.passwordPrompt.close()),this.setTitle(),(o=this.pdfSidebar)==null||o.reset(),(l=this.pdfOutlineViewer)==null||l.reset(),(c=this.pdfAttachmentViewer)==null||c.reset(),(d=this.pdfLayerViewer)==null||d.reset(),(f=this.pdfHistory)==null||f.reset(),(m=this.findBar)==null||m.reset(),(b=this.toolbar)==null||b.reset(),(T=this.secondaryToolbar)==null||T.reset(),(C=this._PDFBug)==null||C.cleanup(),await Promise.all(g)},async open(g){this.pdfLoadingTask&&await this.close();const t=Nt.getAll(ct.WORKER);Object.assign(OE,t),g.url&&this.setTitleUsingUrl(g.originalUrl||g.url,g.url);const i=Nt.getAll(ct.API),n=Rz({...i,...g});return this.pdfLoadingTask=n,n.onPassword=(o,l)=>{this.isViewerEmbedded&&this._unblockDocumentLoadEvent(),this.pdfLinkService.externalLinkEnabled=!1,this.passwordPrompt.setUpdateCallback(o,l),this.passwordPrompt.open()},n.onProgress=({loaded:o,total:l})=>{this.progress(o/l)},n.promise.then(o=>{this.load(o)},o=>{if(n!==this.pdfLoadingTask)return;let l="pdfjs-loading-error";return o instanceof Bz?l="pdfjs-invalid-file-error":o instanceof qz&&(l=o.missing?"pdfjs-missing-file-error":"pdfjs-unexpected-response-error"),this._documentError(l,{message:o.message}).then(()=>{throw o})})},async download(){let g;try{g=await(this.pdfDocument?this.pdfDocument.getData():this.pdfLoadingTask.getData())}catch{}this.downloadManager.download(g,this._downloadUrl,this._docFilename)},async save(){var g;if(!this._saveInProgress){this._saveInProgress=!0,await this.pdfScriptingManager.dispatchWillSave();try{const t=await this.pdfDocument.saveDocument();this.downloadManager.download(t,this._downloadUrl,this._docFilename)}catch(t){console.error("Error when saving the document:",t),await this.download()}finally{await this.pdfScriptingManager.dispatchDidSave(),this._saveInProgress=!1}this._hasAnnotationEditors&&this.externalServices.reportTelemetry({type:"editing",data:{type:"save",stats:(g=this.pdfDocument)==null?void 0:g.annotationStorage.editorStats}})}},async downloadOrSave(){var t;const{classList:g}=this.appConfig.appContainer;g.add("wait"),await(((t=this.pdfDocument)==null?void 0:t.annotationStorage.size)>0?this.save():this.download()),g.remove("wait")},async _documentError(g,t=null){this._unblockDocumentLoadEvent();const i=await this._otherError(g||"pdfjs-loading-error",t);this.eventBus.dispatch("documenterror",{source:this,message:i,reason:(t==null?void 0:t.message)??null})},async _otherError(g,t=null){const i=await this.l10n.get(g),n=[`PDF.js v${ZS||"?"} (build: ${cR||"?"})`];return t&&(n.push(`Message: ${t.message}`),t.stack?n.push(`Stack: ${t.stack}`):(t.filename&&n.push(`File: ${t.filename}`),t.lineNumber&&n.push(`Line: ${t.lineNumber}`))),console.error(`${i}

${n.join(`
`)}`),i},progress(g){var i;const t=Math.round(g*100);!this.loadingBar||t<=this.loadingBar.percent||(this.loadingBar.percent=t,(((i=this.pdfDocument)==null?void 0:i.loadingParams.disableAutoFetch)??Nt.get("disableAutoFetch"))&&this.loadingBar.setDisableAutoFetch())},load(g){var m,b,T,C;this.pdfDocument=g,g.getDownloadInfo().then(({length:P})=>{var x;this._contentLength=P,(x=this.loadingBar)==null||x.hide(),l.then(()=>{this.eventBus.dispatch("documentloaded",{source:this})})});const t=g.getPageLayout().catch(()=>{}),i=g.getPageMode().catch(()=>{}),n=g.getOpenAction().catch(()=>{});(m=this.toolbar)==null||m.setPagesCount(g.numPages,!1),(b=this.secondaryToolbar)==null||b.setPagesCount(g.numPages),this.pdfLinkService.setDocument(g),(T=this.pdfDocumentProperties)==null||T.setDocument(g);const o=this.pdfViewer;o.setDocument(g);const{firstPagePromise:l,onePageRendered:c,pagesPromise:d}=o;(C=this.pdfThumbnailViewer)==null||C.setDocument(g);const f=(this.store=new PW(g.fingerprints[0])).getMultiple({page:null,zoom:ty,scrollLeft:"0",scrollTop:"0",rotation:null,sidebarView:Ni.UNKNOWN,scrollMode:Ci.UNKNOWN,spreadMode:Ws.UNKNOWN}).catch(()=>{});l.then(P=>{var x;(x=this.loadingBar)==null||x.setWidth(this.appConfig.viewerContainer),this._initializeAnnotationStorageCallbacks(g),Promise.all([e7,f,t,i,n]).then(async([L,F,X,re,K])=>{const te=Nt.get("viewOnLoad");this._initializePdfHistory({fingerprint:g.fingerprints[0],viewOnLoad:te,initialDest:K==null?void 0:K.dest});const ee=this.initialBookmark,A=Nt.get("defaultZoomValue");let me=A?`zoom=${A}`:null,fe=null,J=Nt.get("sidebarViewOnLoad"),ye=Nt.get("scrollModeOnLoad"),Oe=Nt.get("spreadModeOnLoad");F!=null&&F.page&&te!==qA.INITIAL&&(me=`page=${F.page}&zoom=${A||F.zoom},${F.scrollLeft},${F.scrollTop}`,fe=parseInt(F.rotation,10),J===Ni.UNKNOWN&&(J=F.sidebarView|0),ye===Ci.UNKNOWN&&(ye=F.scrollMode|0),Oe===Ws.UNKNOWN&&(Oe=F.spreadMode|0)),re&&J===Ni.UNKNOWN&&(J=i7(re)),X&&ye===Ci.UNKNOWN&&Oe===Ws.UNKNOWN&&(Oe=OF(X).spreadMode),this.setInitialView(me,{rotation:fe,sidebarView:J,scrollMode:ye,spreadMode:Oe}),this.eventBus.dispatch("documentinit",{source:this}),this.isViewerEmbedded||o.focus(),await Promise.race([d,new Promise(ot=>{setTimeout(ot,DW)})]),!(!ee&&!me)&&(o.hasEqualPageSizes||(this.initialBookmark=ee,o.currentScaleValue=o.currentScaleValue,this.setInitialView(me)))}).catch(()=>{this.setInitialView()}).then(function(){o.update()})}),d.then(()=>{this._unblockDocumentLoadEvent(),this._initializeAutoPrint(g,n)},P=>{this._documentError("pdfjs-loading-error",{message:P.message})}),c.then(P=>{this.externalServices.reportTelemetry({type:"pageInfo",timestamp:P.timestamp}),this.pdfOutlineViewer&&g.getOutline().then(x=>{g===this.pdfDocument&&this.pdfOutlineViewer.render({outline:x,pdfDocument:g})}),this.pdfAttachmentViewer&&g.getAttachments().then(x=>{g===this.pdfDocument&&this.pdfAttachmentViewer.render({attachments:x})}),this.pdfLayerViewer&&o.optionalContentConfigPromise.then(x=>{g===this.pdfDocument&&this.pdfLayerViewer.render({optionalContentConfig:x,pdfDocument:g})})}),this._initializePageLabels(g),this._initializeMetadata(g)},async _scriptingDocProperties(g){var t,i;return!this.documentInfo&&(await new Promise(n=>{this.eventBus._on("metadataloaded",n,{once:!0})}),g!==this.pdfDocument)||!this._contentLength&&(await new Promise(n=>{this.eventBus._on("documentloaded",n,{once:!0})}),g!==this.pdfDocument)?null:{...this.documentInfo,baseURL:this.baseUrl,filesize:this._contentLength,filename:this._docFilename,metadata:(t=this.metadata)==null?void 0:t.getRaw(),authors:(i=this.metadata)==null?void 0:i.get("dc:creator"),numPages:this.pagesCount,URL:this.url}},async _initializeAutoPrint(g,t){const[i,n]=await Promise.all([t,this.pdfViewer.enableScripting?null:g.getJSActions()]);if(g!==this.pdfDocument)return;let o=(i==null?void 0:i.action)==="Print";if(n){console.warn("Warning: JavaScript support is not enabled");for(const l in n){if(o)break;switch(l){case"WillClose":case"WillSave":case"DidSave":case"WillPrint":case"DidPrint":continue}o=n[l].some(c=>Yz.test(c))}}o&&this.triggerPrinting()},async _initializeMetadata(g){const{info:t,metadata:i,contentDispositionFilename:n,contentLength:o}=await g.getMetadata();if(g!==this.pdfDocument)return;this.documentInfo=t,this.metadata=i,this._contentDispositionFilename??(this._contentDispositionFilename=n),this._contentLength??(this._contentLength=o),console.log(`PDF ${g.fingerprints[0]} [${t.PDFFormatVersion} ${((i==null?void 0:i.get("pdf:producer"))||t.Producer||"-").trim()} / ${((i==null?void 0:i.get("xmp:creatortool"))||t.Creator||"-").trim()}] (PDF.js: ${ZS||"?"} [${cR||"?"}])`);const l=this._docTitle;l?this.setTitle(`${l} - ${this._contentDispositionFilename||this._title}`):this._contentDispositionFilename&&this.setTitle(this._contentDispositionFilename),t.IsXFAPresent&&!t.IsAcroFormPresent&&!g.isPureXfa?g.loadingParams.enableXfa?console.warn("Warning: XFA Foreground documents are not supported"):console.warn("Warning: XFA support is not enabled"):(t.IsAcroFormPresent||t.IsXFAPresent)&&!this.pdfViewer.renderForms&&console.warn("Warning: Interactive form support is not enabled"),t.IsSignaturesPresent&&console.warn("Warning: Digital signatures validation is not supported"),this.eventBus.dispatch("metadataloaded",{source:this})},async _initializePageLabels(g){const t=await g.getPageLabels();if(g!==this.pdfDocument||!t||Nt.get("disablePageLabels"))return;const i=t.length;let n=0,o=0;for(let f=0;f<i;f++){const m=t[f];if(m===(f+1).toString())n++;else if(m==="")o++;else break}if(n>=i||o>=i)return;const{pdfViewer:l,pdfThumbnailViewer:c,toolbar:d}=this;l.setPageLabels(t),c==null||c.setPageLabels(t),d==null||d.setPagesCount(i,!0),d==null||d.setPageNumber(l.currentPageNumber,l.currentPageLabel)},_initializePdfHistory({fingerprint:g,viewOnLoad:t,initialDest:i=null}){this.pdfHistory&&(this.pdfHistory.initialize({fingerprint:g,resetHistory:t===qA.INITIAL,updateUrl:Nt.get("historyUpdateUrl")}),this.pdfHistory.initialBookmark&&(this.initialBookmark=this.pdfHistory.initialBookmark,this.initialRotation=this.pdfHistory.initialRotation),i&&!this.initialBookmark&&t===qA.UNKNOWN&&(this.initialBookmark=JSON.stringify(i),this.pdfHistory.push({explicitDest:i,pageNumber:null})))},_initializeAnnotationStorageCallbacks(g){if(g!==this.pdfDocument)return;const{annotationStorage:t}=g;t.onSetModified=()=>{window.addEventListener("beforeunload",nM),this._annotationStorageModified=!0},t.onResetModified=()=>{window.removeEventListener("beforeunload",nM),delete this._annotationStorageModified},t.onAnnotationEditor=i=>{this._hasAnnotationEditors=!!i,this.setTitle()}},setInitialView(g,{rotation:t,sidebarView:i,scrollMode:n,spreadMode:o}={}){var d,f,m;const l=b=>{Ix(b)&&(this.pdfViewer.pagesRotation=b)},c=(b,T)=>{RF(b)&&(this.pdfViewer.scrollMode=b),MF(T)&&(this.pdfViewer.spreadMode=T)};this.isInitialViewSet=!0,(d=this.pdfSidebar)==null||d.setInitialView(i),c(n,o),this.initialBookmark?(l(this.initialRotation),delete this.initialRotation,this.pdfLinkService.setHash(this.initialBookmark),this.initialBookmark=null):g&&(l(t),this.pdfLinkService.setHash(g)),(f=this.toolbar)==null||f.setPageNumber(this.pdfViewer.currentPageNumber,this.pdfViewer.currentPageLabel),(m=this.secondaryToolbar)==null||m.setPageNumber(this.pdfViewer.currentPageNumber),this.pdfViewer.currentScaleValue||(this.pdfViewer.currentScaleValue=ty)},_cleanup(){var g;this.pdfDocument&&(this.pdfViewer.cleanup(),(g=this.pdfThumbnailViewer)==null||g.cleanup(),this.pdfDocument.cleanup(Nt.get("fontExtraProperties")))},forceRendering(){var g;this.pdfRenderingQueue.printing=!!this.printService,this.pdfRenderingQueue.isThumbnailViewEnabled=((g=this.pdfSidebar)==null?void 0:g.visibleView)===Ni.THUMBS,this.pdfRenderingQueue.renderHighestPriority()},beforePrint(){var g;if(this._printAnnotationStoragePromise=this.pdfScriptingManager.dispatchWillPrint().catch(()=>{}).then(()=>{var t;return(t=this.pdfDocument)==null?void 0:t.annotationStorage.print}),!this.printService){if(!this.supportsPrinting){this._otherError("pdfjs-printing-not-supported");return}if(!this.pdfViewer.pageViewsReady){this.l10n.get("pdfjs-printing-not-ready").then(t=>{window.alert(t)});return}this.printService=ik.createPrintService({pdfDocument:this.pdfDocument,pagesOverview:this.pdfViewer.getPagesOverview(),printContainer:this.appConfig.printContainer,printResolution:Nt.get("printResolution"),printAnnotationStoragePromise:this._printAnnotationStoragePromise}),this.forceRendering(),this.setTitle(),this.printService.layout(),this._hasAnnotationEditors&&this.externalServices.reportTelemetry({type:"editing",data:{type:"print",stats:(g=this.pdfDocument)==null?void 0:g.annotationStorage.editorStats}})}},afterPrint(){var g;this._printAnnotationStoragePromise&&(this._printAnnotationStoragePromise.then(()=>{this.pdfScriptingManager.dispatchDidPrint()}),this._printAnnotationStoragePromise=null),this.printService&&(this.printService.destroy(),this.printService=null,(g=this.pdfDocument)==null||g.annotationStorage.resetModified()),this.forceRendering(),this.setTitle()},rotatePages(g){this.pdfViewer.pagesRotation+=g},requestPresentationMode(){var g;(g=this.pdfPresentationMode)==null||g.request()},triggerPrinting(){this.supportsPrinting&&window.print()},bindEvents(){if(this._eventBusAbortController)return;const t={signal:(this._eventBusAbortController=new AbortController).signal},{eventBus:i,externalServices:n,pdfDocumentProperties:o,pdfViewer:l,preferences:c}=this;i._on("resize",jW.bind(this),t),i._on("hashchange",HW.bind(this),t),i._on("beforeprint",this.beforePrint.bind(this),t),i._on("afterprint",this.afterPrint.bind(this),t),i._on("pagerender",RW.bind(this),t),i._on("pagerendered",MW.bind(this),t),i._on("updateviewarea",UW.bind(this),t),i._on("pagechanging",KW.bind(this),t),i._on("scalechanging",GW.bind(this),t),i._on("rotationchanging",XW.bind(this),t),i._on("sidebarviewchanged",BW.bind(this),t),i._on("pagemode",OW.bind(this),t),i._on("namedaction",FW.bind(this),t),i._on("presentationmodechanged",d=>l.presentationModeState=d.state,t),i._on("presentationmode",this.requestPresentationMode.bind(this),t),i._on("switchannotationeditormode",d=>l.annotationEditorMode=d,t),i._on("print",this.triggerPrinting.bind(this),t),i._on("download",this.downloadOrSave.bind(this),t),i._on("firstpage",()=>this.page=1,t),i._on("lastpage",()=>this.page=this.pagesCount,t),i._on("nextpage",()=>l.nextPage(),t),i._on("previouspage",()=>l.previousPage(),t),i._on("zoomin",this.zoomIn.bind(this),t),i._on("zoomout",this.zoomOut.bind(this),t),i._on("zoomreset",this.zoomReset.bind(this),t),i._on("pagenumberchanged",VW.bind(this),t),i._on("scalechanged",d=>l.currentScaleValue=d.value,t),i._on("rotatecw",this.rotatePages.bind(this,90),t),i._on("rotateccw",this.rotatePages.bind(this,-90),t),i._on("optionalcontentconfig",d=>l.optionalContentConfigPromise=d.promise,t),i._on("switchscrollmode",d=>l.scrollMode=d.mode,t),i._on("scrollmodechanged",sM.bind(this,"scrollMode"),t),i._on("switchspreadmode",d=>l.spreadMode=d.mode,t),i._on("spreadmodechanged",sM.bind(this,"spreadMode"),t),i._on("imagealttextsettings",$W.bind(this),t),i._on("documentproperties",()=>o==null?void 0:o.open(),t),i._on("findfromurlhash",zW.bind(this),t),i._on("updatefindmatchescount",WW.bind(this),t),i._on("updatefindcontrolstate",qW.bind(this),t),i._on("fileinputchange",LW.bind(this),t),i._on("openfile",NW.bind(this),t)},bindWindowEvents(){if(this._windowAbortController)return;this._windowAbortController=new AbortController;const{eventBus:g,appConfig:{mainContainer:t},pdfViewer:i,_windowAbortController:{signal:n}}=this;this._touchManager=new Xz({container:window,isPinchingDisabled:()=>i.isInPresentationMode,isPinchingStopped:()=>{var d;return(d=this.overlayManager)==null?void 0:d.active},onPinching:this.touchPinchCallback.bind(this),onPinchEnd:this.touchPinchEndCallback.bind(this),signal:n});function o(d=null){d&&i.refresh(),window.matchMedia(`(resolution: ${sg.pixelRatio}dppx)`).addEventListener("change",o,{once:!0,signal:n})}if(o(),window.addEventListener("wheel",YW.bind(this),{passive:!1,signal:n}),window.addEventListener("click",JW.bind(this),{signal:n}),window.addEventListener("keydown",tq.bind(this),{signal:n}),window.addEventListener("keyup",eq.bind(this),{signal:n}),window.addEventListener("resize",()=>g.dispatch("resize",{source:window}),{signal:n}),window.addEventListener("hashchange",()=>{g.dispatch("hashchange",{source:window,hash:document.location.hash.substring(1)})},{signal:n}),window.addEventListener("beforeprint",()=>g.dispatch("beforeprint",{source:window}),{signal:n}),window.addEventListener("afterprint",()=>g.dispatch("afterprint",{source:window}),{signal:n}),window.addEventListener("updatefromsandbox",d=>{g.dispatch("updatefromsandbox",{source:window,detail:d.detail})},{signal:n}),!("onscrollend"in document.documentElement))return;({scrollTop:this._lastScrollTop,scrollLeft:this._lastScrollLeft}=t);const l=()=>{({scrollTop:this._lastScrollTop,scrollLeft:this._lastScrollLeft}=t),this._isScrolling=!1,t.addEventListener("scroll",c,{passive:!0,signal:n}),t.removeEventListener("scrollend",l),t.removeEventListener("blur",l)},c=()=>{this._isCtrlKeyDown||this._lastScrollTop===t.scrollTop&&this._lastScrollLeft===t.scrollLeft||(t.removeEventListener("scroll",c),this._isScrolling=!0,t.addEventListener("scrollend",l,{signal:n}),t.addEventListener("blur",l,{signal:n}))};t.addEventListener("scroll",c,{passive:!0,signal:n})},unbindEvents(){var g;(g=this._eventBusAbortController)==null||g.abort(),this._eventBusAbortController=null},unbindWindowEvents(){var g;(g=this._windowAbortController)==null||g.abort(),this._windowAbortController=null,this._touchManager=null},async testingClose(){var g,t,i;this.unbindEvents(),this.unbindWindowEvents(),(g=this._globalAbortController)==null||g.abort(),this._globalAbortController=null,(t=this.findBar)==null||t.close(),await Promise.all([(i=this.l10n)==null?void 0:i.destroy(),this.close()])},_accumulateTicks(g,t){(this[t]>0&&g<0||this[t]<0&&g>0)&&(this[t]=0),this[t]+=g;const i=Math.trunc(this[t]);return this[t]-=i,i},_accumulateFactor(g,t,i){if(t===1)return 1;(this[i]>1&&t<1||this[i]<1&&t>1)&&(this[i]=1);const n=Math.floor(g*t*this[i]*100)/(100*g);return this[i]=t/n,n},_unblockDocumentLoadEvent(){var g;(g=document.blockUnblockOnload)==null||g.call(document,!1),this._unblockDocumentLoadEvent=()=>{}},get scriptingReady(){return this.pdfScriptingManager.ready}};ik.initGlobals(dT);{const g=new Set(["null","http://mozilla.github.io","https://mozilla.github.io"]);var IW=function(t){var l,c;if(!t)return;const i=((l=URL.parse(window.location))==null?void 0:l.origin)||"null";if(g.has(i)||((c=URL.parse(t,window.location))==null?void 0:c.origin)===i)return;const o=new Error("file origin does not match viewer's");throw dT._documentError("pdfjs-loading-error",{message:o.message}),o},LW=function(t){var n;if((n=this.pdfViewer)!=null&&n.isInPresentationMode)return;const i=t.fileInput.files[0];this.open({url:URL.createObjectURL(i),originalUrl:i.name})},NW=function(t){var i;(i=this._openFileInput)==null||i.click()}}function RW({pageNumber:g}){var t;g===this.page&&((t=this.toolbar)==null||t.updateLoadingIndicatorState(!0))}function MW({pageNumber:g,isDetailView:t,error:i}){var n,o,l;if(g===this.page&&((n=this.toolbar)==null||n.updateLoadingIndicatorState(!1)),!t&&((o=this.pdfSidebar)==null?void 0:o.visibleView)===Ni.THUMBS){const c=this.pdfViewer.getPageView(g-1),d=(l=this.pdfThumbnailViewer)==null?void 0:l.getThumbnail(g-1);c&&(d==null||d.setImage(c))}i&&this._otherError("pdfjs-rendering-error",i)}function OW({mode:g}){var i;let t;switch(g){case"thumbs":t=Ni.THUMBS;break;case"bookmarks":case"outline":t=Ni.OUTLINE;break;case"attachments":t=Ni.ATTACHMENTS;break;case"layers":t=Ni.LAYERS;break;case"none":t=Ni.NONE;break;default:console.error('Invalid "pagemode" hash parameter: '+g);return}(i=this.pdfSidebar)==null||i.switchView(t,!0)}function FW(g){var t,i;switch(g.action){case"GoToPage":(t=this.appConfig.toolbar)==null||t.pageNumber.select();break;case"Find":this.supportsIntegratedFind||(i=this.findBar)==null||i.toggle();break;case"Print":this.triggerPrinting();break;case"SaveAs":this.downloadOrSave();break}}function BW({view:g}){var t;this.pdfRenderingQueue.isThumbnailViewEnabled=g===Ni.THUMBS,this.isInitialViewSet&&((t=this.store)==null||t.set("sidebarView",g).catch(()=>{}))}function UW({location:g}){var t;this.isInitialViewSet&&((t=this.store)==null||t.setMultiple({page:g.pageNumber,zoom:g.scale,scrollLeft:g.left,scrollTop:g.top,rotation:g.rotation}).catch(()=>{})),this.appConfig.secondaryToolbar&&(this.appConfig.secondaryToolbar.viewBookmarkButton.href=this.pdfLinkService.getAnchorUrl(g.pdfOpenParams))}function sM(g,t){var i;this.isInitialViewSet&&!this.pdfViewer.isInPresentationMode&&((i=this.store)==null||i.set(g,t.mode).catch(()=>{}))}function jW(){const{pdfDocument:g,pdfViewer:t,pdfRenderingQueue:i}=this;if(i.printing&&window.matchMedia("print").matches||!g)return;const n=t.currentScaleValue;(n==="auto"||n==="page-fit"||n==="page-width")&&(t.currentScaleValue=n),t.update()}function HW(g){var i;const t=g.hash;t&&(this.isInitialViewSet?(i=this.pdfHistory)!=null&&i.popStateInProgress||this.pdfLinkService.setHash(t):this.initialBookmark=t)}function VW(g){var i;const{pdfViewer:t}=this;g.value!==""&&this.pdfLinkService.goToPage(g.value),g.value!==t.currentPageNumber.toString()&&g.value!==t.currentPageLabel&&((i=this.toolbar)==null||i.setPageNumber(t.currentPageNumber,t.currentPageLabel))}function $W(){var g;(g=this.imageAltTextSettings)==null||g.open({enableGuessAltText:Nt.get("enableGuessAltText"),enableNewAltTextWhenAddingImage:Nt.get("enableNewAltTextWhenAddingImage")})}function zW(g){this.eventBus.dispatch("find",{source:g.source,type:"",query:g.query,caseSensitive:!1,entireWord:!1,highlightAll:!0,findPrevious:!1,matchDiacritics:!0})}function WW({matchesCount:g}){var t;this.supportsIntegratedFind?this.externalServices.updateFindMatchesCount(g):(t=this.findBar)==null||t.updateResultsCount(g)}function qW({state:g,previous:t,entireWord:i,matchesCount:n,rawQuery:o}){var l;this.supportsIntegratedFind?this.externalServices.updateFindControlState({result:g,findPrevious:t,entireWord:i,matchesCount:n,rawQuery:o}):(l=this.findBar)==null||l.updateUIState(g,t,n)}function GW(g){var t;(t=this.toolbar)==null||t.setPageScale(g.presetValue,g.scale),this.pdfViewer.update()}function XW(g){this.pdfThumbnailViewer&&(this.pdfThumbnailViewer.pagesRotation=g.pagesRotation),this.forceRendering(),this.pdfViewer.currentPageNumber=g.pageNumber}function KW({pageNumber:g,pageLabel:t}){var n,o,l,c,d;(n=this.toolbar)==null||n.setPageNumber(g,t),(o=this.secondaryToolbar)==null||o.setPageNumber(g),((l=this.pdfSidebar)==null?void 0:l.visibleView)===Ni.THUMBS&&((c=this.pdfThumbnailViewer)==null||c.scrollThumbnailIntoView(g));const i=this.pdfViewer.getPageView(g-1);(d=this.toolbar)==null||d.updateLoadingIndicatorState((i==null?void 0:i.renderingState)===Ii.RUNNING)}function YW(g){const{pdfViewer:t,supportsMouseWheelZoomCtrlKey:i,supportsMouseWheelZoomMetaKey:n,supportsPinchToZoom:o}=this;if(t.isInPresentationMode)return;const l=g.deltaMode;let c=Math.exp(-g.deltaY/100);const f=g.ctrlKey&&!this._isCtrlKeyDown&&l===WheelEvent.DOM_DELTA_PIXEL&&g.deltaX===0&&(Math.abs(c-1)<.05||!1)&&g.deltaZ===0,m=[g.clientX,g.clientY];if(f||g.ctrlKey&&i||g.metaKey&&n){if(g.preventDefault(),this._isScrolling||document.visibilityState==="hidden"||this.overlayManager.active)return;if(f&&o)c=this._accumulateFactor(t.currentScale,c,"_wheelUnusedFactor"),this.updateZoom(null,c,m);else{const b=NF(g);let T=0;l===WheelEvent.DOM_DELTA_LINE||l===WheelEvent.DOM_DELTA_PAGE?T=Math.abs(b)>=1?Math.sign(b):this._accumulateTicks(b,"_wheelUnusedTicks"):T=this._accumulateTicks(b/30,"_wheelUnusedTicks"),this.updateZoom(T,null,m)}}}function ZW({target:g}){var n;if(!((n=this.secondaryToolbar)!=null&&n.isOpen))return;const{toolbar:t,secondaryToolbar:i}=this.appConfig;(this.pdfViewer.containsElement(g)||t!=null&&t.container.contains(g)&&!(i!=null&&i.toolbar.contains(g))&&!(i!=null&&i.toggleButton.contains(g)))&&this.secondaryToolbar.close()}function QW(g){var t,i;(t=this.editorUndoBar)!=null&&t.isOpen&&(i=this.appConfig.secondaryToolbar)!=null&&i.toolbar.contains(g.target)&&this.editorUndoBar.hide()}function JW(g){ZW.call(this,g),QW.call(this,g)}function eq(g){g.key==="Control"&&(this._isCtrlKeyDown=!1)}function tq(g){var m,b,T,C,P,x,L;if(this._isCtrlKeyDown=g.key==="Control",(m=this.editorUndoBar)!=null&&m.isOpen&&g.keyCode!==9&&g.keyCode!==16&&!((g.keyCode===13||g.keyCode===32)&&yR()===this.appConfig.editorUndoBar.undoButton)&&this.editorUndoBar.hide(),this.overlayManager.active)return;const{eventBus:t,pdfViewer:i}=this,n=i.isInPresentationMode;let o=!1,l=!1;const c=(g.ctrlKey?1:0)|(g.altKey?2:0)|(g.shiftKey?4:0)|(g.metaKey?8:0);if(c===1||c===8||c===5||c===12)switch(g.keyCode){case 70:!this.supportsIntegratedFind&&!g.shiftKey&&((b=this.findBar)==null||b.open(),o=!0);break;case 71:if(!this.supportsIntegratedFind){const{state:F}=this.findController;if(F){const X={source:window,type:"again",findPrevious:c===5||c===12};t.dispatch("find",{...F,...X})}o=!0}break;case 61:case 107:case 187:case 171:this.zoomIn(),o=!0;break;case 173:case 109:case 189:this.zoomOut(),o=!0;break;case 48:case 96:n||(setTimeout(()=>{this.zoomReset()}),o=!1);break;case 38:(n||this.page>1)&&(this.page=1,o=!0,l=!0);break;case 40:(n||this.page<this.pagesCount)&&(this.page=this.pagesCount,o=!0,l=!0);break}if(c===1||c===8)switch(g.keyCode){case 83:t.dispatch("download",{source:window}),o=!0;break;case 79:t.dispatch("openfile",{source:window}),o=!0;break}if(c===3||c===10)switch(g.keyCode){case 80:this.requestPresentationMode(),o=!0,this.externalServices.reportTelemetry({type:"buttons",data:{id:"presentationModeKeyboard"}});break;case 71:this.appConfig.toolbar&&(this.appConfig.toolbar.pageNumber.select(),o=!0);break}if(o){l&&!n&&i.focus(),g.preventDefault();return}const d=yR(),f=d==null?void 0:d.tagName.toUpperCase();if(!((f==="INPUT"||f==="TEXTAREA"||f==="SELECT"||f==="BUTTON"&&(g.keyCode===13||g.keyCode===32)||d!=null&&d.isContentEditable)&&g.keyCode!==27)){if(c===0){let F=0,X=!1;switch(g.keyCode){case 38:if(this.supportsCaretBrowsingMode){this.moveCaret(!0,!1),o=!0;break}case 33:i.isVerticalScrollbarEnabled&&(X=!0),F=-1;break;case 8:n||(X=!0),F=-1;break;case 37:if(this.supportsCaretBrowsingMode)return;i.isHorizontalScrollbarEnabled&&(X=!0);case 75:case 80:F=-1;break;case 27:(T=this.secondaryToolbar)!=null&&T.isOpen&&(this.secondaryToolbar.close(),o=!0),!this.supportsIntegratedFind&&((C=this.findBar)!=null&&C.opened)&&(this.findBar.close(),o=!0);break;case 40:if(this.supportsCaretBrowsingMode){this.moveCaret(!1,!1),o=!0;break}case 34:i.isVerticalScrollbarEnabled&&(X=!0),F=1;break;case 13:case 32:n||(X=!0),F=1;break;case 39:if(this.supportsCaretBrowsingMode)return;i.isHorizontalScrollbarEnabled&&(X=!0);case 74:case 78:F=1;break;case 36:(n||this.page>1)&&(this.page=1,o=!0,l=!0);break;case 35:(n||this.page<this.pagesCount)&&(this.page=this.pagesCount,o=!0,l=!0);break;case 83:(P=this.pdfCursorTools)==null||P.switchTool(Da.SELECT);break;case 72:(x=this.pdfCursorTools)==null||x.switchTool(Da.HAND);break;case 82:this.rotatePages(90);break;case 115:(L=this.pdfSidebar)==null||L.toggle();break}F!==0&&(!X||i.currentScaleValue==="page-fit")&&(F>0?i.nextPage():i.previousPage(),o=!0)}if(c===4)switch(g.keyCode){case 13:case 32:if(!n&&i.currentScaleValue!=="page-fit")break;i.previousPage(),o=!0;break;case 38:this.moveCaret(!0,!0),o=!0;break;case 40:this.moveCaret(!1,!0),o=!0;break;case 82:this.rotatePages(-90);break}!o&&!n&&(g.keyCode>=33&&g.keyCode<=40||g.keyCode===32&&f!=="BUTTON")&&(l=!0),l&&!i.containsElement(d)&&i.focus(),o&&g.preventDefault()}}function nM(g){return g.preventDefault(),g.returnValue="",!1}const R3={LinkTarget:Lu,RenderingStates:Ii,ScrollMode:Ci,SpreadMode:Ws};window.PDFViewerApplication=dT;window.PDFViewerApplicationConstants=R3;window.PDFViewerApplicationOptions=Nt;function iq(){return{appContainer:document.body,principalContainer:document.getElementById("mainContainer"),mainContainer:document.getElementById("viewerContainer"),viewerContainer:document.getElementById("viewer"),toolbar:{container:document.getElementById("toolbarContainer"),numPages:document.getElementById("numPages"),pageNumber:document.getElementById("pageNumber"),scaleSelect:document.getElementById("scaleSelect"),customScaleOption:document.getElementById("customScaleOption"),previous:document.getElementById("previous"),next:document.getElementById("next"),zoomIn:document.getElementById("zoomInButton"),zoomOut:document.getElementById("zoomOutButton"),print:document.getElementById("printButton"),editorFreeTextButton:document.getElementById("editorFreeTextButton"),editorFreeTextParamsToolbar:document.getElementById("editorFreeTextParamsToolbar"),editorHighlightButton:document.getElementById("editorHighlightButton"),editorHighlightParamsToolbar:document.getElementById("editorHighlightParamsToolbar"),editorHighlightColorPicker:document.getElementById("editorHighlightColorPicker"),editorInkButton:document.getElementById("editorInkButton"),editorInkParamsToolbar:document.getElementById("editorInkParamsToolbar"),editorStampButton:document.getElementById("editorStampButton"),editorStampParamsToolbar:document.getElementById("editorStampParamsToolbar"),editorSignatureButton:document.getElementById("editorSignatureButton"),editorSignatureParamsToolbar:document.getElementById("editorSignatureParamsToolbar"),download:document.getElementById("downloadButton")},secondaryToolbar:{toolbar:document.getElementById("secondaryToolbar"),toggleButton:document.getElementById("secondaryToolbarToggleButton"),presentationModeButton:document.getElementById("presentationMode"),openFileButton:document.getElementById("secondaryOpenFile"),printButton:document.getElementById("secondaryPrint"),downloadButton:document.getElementById("secondaryDownload"),viewBookmarkButton:document.getElementById("viewBookmark"),firstPageButton:document.getElementById("firstPage"),lastPageButton:document.getElementById("lastPage"),pageRotateCwButton:document.getElementById("pageRotateCw"),pageRotateCcwButton:document.getElementById("pageRotateCcw"),cursorSelectToolButton:document.getElementById("cursorSelectTool"),cursorHandToolButton:document.getElementById("cursorHandTool"),scrollPageButton:document.getElementById("scrollPage"),scrollVerticalButton:document.getElementById("scrollVertical"),scrollHorizontalButton:document.getElementById("scrollHorizontal"),scrollWrappedButton:document.getElementById("scrollWrapped"),spreadNoneButton:document.getElementById("spreadNone"),spreadOddButton:document.getElementById("spreadOdd"),spreadEvenButton:document.getElementById("spreadEven"),imageAltTextSettingsButton:document.getElementById("imageAltTextSettings"),imageAltTextSettingsSeparator:document.getElementById("imageAltTextSettingsSeparator"),documentPropertiesButton:document.getElementById("documentProperties")},sidebar:{outerContainer:document.getElementById("outerContainer"),sidebarContainer:document.getElementById("sidebarContainer"),toggleButton:document.getElementById("sidebarToggleButton"),resizer:document.getElementById("sidebarResizer"),thumbnailButton:document.getElementById("viewThumbnail"),outlineButton:document.getElementById("viewOutline"),attachmentsButton:document.getElementById("viewAttachments"),layersButton:document.getElementById("viewLayers"),thumbnailView:document.getElementById("thumbnailView"),outlineView:document.getElementById("outlineView"),attachmentsView:document.getElementById("attachmentsView"),layersView:document.getElementById("layersView"),currentOutlineItemButton:document.getElementById("currentOutlineItem")},findBar:{bar:document.getElementById("findbar"),toggleButton:document.getElementById("viewFindButton"),findField:document.getElementById("findInput"),highlightAllCheckbox:document.getElementById("findHighlightAll"),caseSensitiveCheckbox:document.getElementById("findMatchCase"),matchDiacriticsCheckbox:document.getElementById("findMatchDiacritics"),entireWordCheckbox:document.getElementById("findEntireWord"),findMsg:document.getElementById("findMsg"),findResultsCount:document.getElementById("findResultsCount"),findPreviousButton:document.getElementById("findPreviousButton"),findNextButton:document.getElementById("findNextButton")},passwordOverlay:{dialog:document.getElementById("passwordDialog"),label:document.getElementById("passwordText"),input:document.getElementById("password"),submitButton:document.getElementById("passwordSubmit"),cancelButton:document.getElementById("passwordCancel")},documentProperties:{dialog:document.getElementById("documentPropertiesDialog"),closeButton:document.getElementById("documentPropertiesClose"),fields:{fileName:document.getElementById("fileNameField"),fileSize:document.getElementById("fileSizeField"),title:document.getElementById("titleField"),author:document.getElementById("authorField"),subject:document.getElementById("subjectField"),keywords:document.getElementById("keywordsField"),creationDate:document.getElementById("creationDateField"),modificationDate:document.getElementById("modificationDateField"),creator:document.getElementById("creatorField"),producer:document.getElementById("producerField"),version:document.getElementById("versionField"),pageCount:document.getElementById("pageCountField"),pageSize:document.getElementById("pageSizeField"),linearized:document.getElementById("linearizedField")}},altTextDialog:{dialog:document.getElementById("altTextDialog"),optionDescription:document.getElementById("descriptionButton"),optionDecorative:document.getElementById("decorativeButton"),textarea:document.getElementById("descriptionTextarea"),cancelButton:document.getElementById("altTextCancel"),saveButton:document.getElementById("altTextSave")},newAltTextDialog:{dialog:document.getElementById("newAltTextDialog"),title:document.getElementById("newAltTextTitle"),descriptionContainer:document.getElementById("newAltTextDescriptionContainer"),textarea:document.getElementById("newAltTextDescriptionTextarea"),disclaimer:document.getElementById("newAltTextDisclaimer"),learnMore:document.getElementById("newAltTextLearnMore"),imagePreview:document.getElementById("newAltTextImagePreview"),createAutomatically:document.getElementById("newAltTextCreateAutomatically"),createAutomaticallyButton:document.getElementById("newAltTextCreateAutomaticallyButton"),downloadModel:document.getElementById("newAltTextDownloadModel"),downloadModelDescription:document.getElementById("newAltTextDownloadModelDescription"),error:document.getElementById("newAltTextError"),errorCloseButton:document.getElementById("newAltTextCloseButton"),cancelButton:document.getElementById("newAltTextCancel"),notNowButton:document.getElementById("newAltTextNotNow"),saveButton:document.getElementById("newAltTextSave")},altTextSettingsDialog:{dialog:document.getElementById("altTextSettingsDialog"),createModelButton:document.getElementById("createModelButton"),aiModelSettings:document.getElementById("aiModelSettings"),learnMore:document.getElementById("altTextSettingsLearnMore"),deleteModelButton:document.getElementById("deleteModelButton"),downloadModelButton:document.getElementById("downloadModelButton"),showAltTextDialogButton:document.getElementById("showAltTextDialogButton"),altTextSettingsCloseButton:document.getElementById("altTextSettingsCloseButton"),closeButton:document.getElementById("altTextSettingsCloseButton")},addSignatureDialog:{dialog:document.getElementById("addSignatureDialog"),panels:document.getElementById("addSignatureActionContainer"),typeButton:document.getElementById("addSignatureTypeButton"),typeInput:document.getElementById("addSignatureTypeInput"),drawButton:document.getElementById("addSignatureDrawButton"),drawSVG:document.getElementById("addSignatureDraw"),drawPlaceholder:document.getElementById("addSignatureDrawPlaceholder"),drawThickness:document.getElementById("addSignatureDrawThickness"),imageButton:document.getElementById("addSignatureImageButton"),imageSVG:document.getElementById("addSignatureImage"),imagePlaceholder:document.getElementById("addSignatureImagePlaceholder"),imagePicker:document.getElementById("addSignatureFilePicker"),imagePickerLink:document.getElementById("addSignatureImageBrowse"),description:document.getElementById("addSignatureDescription"),clearButton:document.getElementById("clearSignatureButton"),saveContainer:document.getElementById("addSignatureSaveContainer"),saveCheckbox:document.getElementById("addSignatureSaveCheckbox"),errorBar:document.getElementById("addSignatureError"),errorCloseButton:document.getElementById("addSignatureErrorCloseButton"),cancelButton:document.getElementById("addSignatureCancelButton"),addButton:document.getElementById("addSignatureAddButton")},editSignatureDialog:{dialog:document.getElementById("editSignatureDescriptionDialog"),description:document.getElementById("editSignatureDescription"),editSignatureView:document.getElementById("editSignatureView"),cancelButton:document.getElementById("editSignatureCancelButton"),updateButton:document.getElementById("editSignatureUpdateButton")},annotationEditorParams:{editorFreeTextFontSize:document.getElementById("editorFreeTextFontSize"),editorFreeTextColor:document.getElementById("editorFreeTextColor"),editorInkColor:document.getElementById("editorInkColor"),editorInkThickness:document.getElementById("editorInkThickness"),editorInkOpacity:document.getElementById("editorInkOpacity"),editorStampAddImage:document.getElementById("editorStampAddImage"),editorSignatureAddSignature:document.getElementById("editorSignatureAddSignature"),editorFreeHighlightThickness:document.getElementById("editorFreeHighlightThickness"),editorHighlightShowAll:document.getElementById("editorHighlightShowAll")},printContainer:document.getElementById("printContainer"),editorUndoBar:{container:document.getElementById("editorUndoBar"),message:document.getElementById("editorUndoBarMessage"),undoButton:document.getElementById("editorUndoBarUndoButton"),closeButton:document.getElementById("editorUndoBarCloseButton")}}}const Vk=function(){const t=iq(),i=new CustomEvent("webviewerloaded",{bubbles:!0,cancelable:!0,detail:{source:window}});try{parent.document.dispatchEvent(i)}catch(n){console.error("webviewerloaded:",n),document.dispatchEvent(i)}dT.run(t)};var oM;(oM=document.blockUnblockOnload)==null||oM.call(document,!0);const sq=document.querySelector("#CommentsPanelButton");sq.addEventListener("click",()=>{document.querySelector(".commentpanelview ").classList.toggle("closed")});const nq=Object.freeze(Object.defineProperty({__proto__:null,PDFViewerApplication:dT,PDFViewerApplicationConstants:R3,PDFViewerApplicationOptions:Nt,webViewerLoad:Vk},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Video.js 8.23.3 <http://videojs.com/>
 * Copyright Brightcove, Inc. <https://www.brightcove.com/>
 * Available under Apache License Version 2.0
 * <https://github.com/videojs/video.js/blob/main/LICENSE>
 *
 * Includes vtt.js <https://github.com/mozilla/vtt.js>
 * Available under Apache License Version 2.0
 * <https://github.com/mozilla/vtt.js/blob/main/LICENSE>
 */(function(g,t){typeof exports=="object"&&typeof module<"u"?module.exports=t():typeof define=="function"&&define.amd?define(t):(g=typeof globalThis<"u"?globalThis:g||self,g.videojs=t())})(void 0,function(){var g="8.23.3";const t={},i=function(r,e){return t[r]=t[r]||[],e&&(t[r]=t[r].concat(e)),t[r]},n=function(r,e){i(r,e)},o=function(r,e){const s=i(r).indexOf(e);return s<=-1?!1:(t[r]=t[r].slice(),t[r].splice(s,1),!0)},l=function(r,e){i(r,[].concat(e).map(s=>{const a=(...h)=>(o(r,a),s(...h));return a}))},c={prefixed:!0},d=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror","fullscreen"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror","-webkit-full-screen"]],f=d[0];let m;for(let r=0;r<d.length;r++)if(d[r][1]in document){m=d[r];break}if(m){for(let r=0;r<m.length;r++)c[f[r]]=m[r];c.prefixed=m[0]!==f[0]}let b=[];const T=(r,e,s)=>(a,h,p)=>{const _=e.levels[h],w=new RegExp(`^(${_})$`);let I=r;if(a!=="log"&&p.unshift(a.toUpperCase()+":"),s&&(I=`%c${r}`,p.unshift(s)),p.unshift(I+":"),b){b.push([].concat(p));const G=b.length-1e3;b.splice(0,G>0?G:0)}if(!window.console)return;let B=window.console[a];!B&&a==="debug"&&(B=window.console.info||window.console.log),!(!B||!_||!w.test(a))&&B[Array.isArray(p)?"apply":"call"](window.console,p)};function C(r,e=":",s=""){let a="info",h;function p(..._){h("log",a,_)}return h=T(r,p,s),p.createLogger=(_,w,I)=>{const B=w!==void 0?w:e,G=I!==void 0?I:s,se=`${r} ${B} ${_}`;return C(se,B,G)},p.createNewLogger=(_,w,I)=>C(_,w,I),p.levels={all:"debug|log|warn|error",off:"",debug:"debug|log|warn|error",info:"log|warn|error",warn:"warn|error",error:"error",DEFAULT:a},p.level=_=>{if(typeof _=="string"){if(!p.levels.hasOwnProperty(_))throw new Error(`"${_}" in not a valid log level`);a=_}return a},p.history=()=>b?[].concat(b):[],p.history.filter=_=>(b||[]).filter(w=>new RegExp(`.*${_}.*`).test(w[0])),p.history.clear=()=>{b&&(b.length=0)},p.history.disable=()=>{b!==null&&(b.length=0,b=null)},p.history.enable=()=>{b===null&&(b=[])},p.error=(..._)=>h("error",a,_),p.warn=(..._)=>h("warn",a,_),p.debug=(..._)=>h("debug",a,_),p}const P=C("VIDEOJS"),x=P.createLogger,L=Object.prototype.toString,F=function(r){return K(r)?Object.keys(r):[]};function X(r,e){F(r).forEach(s=>e(r[s],s))}function re(r,e,s=0){return F(r).reduce((a,h)=>e(a,r[h],h),s)}function K(r){return!!r&&typeof r=="object"}function te(r){return K(r)&&L.call(r)==="[object Object]"&&r.constructor===Object}function ee(...r){const e={};return r.forEach(s=>{s&&X(s,(a,h)=>{if(!te(a)){e[h]=a;return}te(e[h])||(e[h]={}),e[h]=ee(e[h],a)})}),e}function A(r={}){const e=[];for(const s in r)if(r.hasOwnProperty(s)){const a=r[s];e.push(a)}return e}function me(r,e,s,a=!0){const h=_=>Object.defineProperty(r,e,{value:_,enumerable:!0,writable:!0}),p={configurable:!0,enumerable:!0,get(){const _=s();return h(_),_}};return a&&(p.set=h),Object.defineProperty(r,e,p)}var fe=Object.freeze({__proto__:null,each:X,reduce:re,isObject:K,isPlain:te,merge:ee,values:A,defineLazyProperty:me});let J=!1,ye=null,Oe=!1,ot,Tt=!1,dt=!1,kt=!1,$e=!1,vt=null,Jt=null;const di=!!(window.cast&&window.cast.framework&&window.cast.framework.CastReceiverContext);let Ut=null,ui=!1,qt=!1,Ze=!1,ki=!1,wi=!1,jt=!1,Yt=!1;const Ei=!!(mi()&&("ontouchstart"in window||window.navigator.maxTouchPoints||window.DocumentTouch&&window.document instanceof window.DocumentTouch)),ii=window.navigator&&window.navigator.userAgentData;if(ii&&ii.platform&&ii.brands&&(Oe=ii.platform==="Android",dt=!!ii.brands.find(r=>r.brand==="Microsoft Edge"),kt=!!ii.brands.find(r=>r.brand==="Chromium"),$e=!dt&&kt,vt=Jt=(ii.brands.find(r=>r.brand==="Chromium")||{}).version||null,qt=ii.platform==="Windows"),!kt){const r=window.navigator&&window.navigator.userAgent||"";J=/iPod/i.test(r),ye=function(){const e=r.match(/OS (\d+)_/i);return e&&e[1]?e[1]:null}(),Oe=/Android/i.test(r),ot=function(){const e=r.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(!e)return null;const s=e[1]&&parseFloat(e[1]),a=e[2]&&parseFloat(e[2]);return s&&a?parseFloat(e[1]+"."+e[2]):s||null}(),Tt=/Firefox/i.test(r),dt=/Edg/i.test(r),kt=/Chrome/i.test(r)||/CriOS/i.test(r),$e=!dt&&kt,vt=Jt=function(){const e=r.match(/(Chrome|CriOS)\/(\d+)/);return e&&e[2]?parseFloat(e[2]):null}(),Ut=function(){const e=/MSIE\s(\d+)\.\d/.exec(r);let s=e&&parseFloat(e[1]);return!s&&/Trident\/7.0/i.test(r)&&/rv:11.0/.test(r)&&(s=11),s}(),wi=/Tizen/i.test(r),jt=/Web0S/i.test(r),Yt=wi||jt,ui=/Safari/i.test(r)&&!$e&&!Oe&&!dt&&!Yt,qt=/Windows/i.test(r),Ze=/iPad/i.test(r)||ui&&Ei&&!/iPhone/i.test(r),ki=/iPhone/i.test(r)&&!Ze}const hi=ki||Ze||J,Gt=(ui||hi)&&!$e;var es=Object.freeze({__proto__:null,get IS_IPOD(){return J},get IOS_VERSION(){return ye},get IS_ANDROID(){return Oe},get ANDROID_VERSION(){return ot},get IS_FIREFOX(){return Tt},get IS_EDGE(){return dt},get IS_CHROMIUM(){return kt},get IS_CHROME(){return $e},get CHROMIUM_VERSION(){return vt},get CHROME_VERSION(){return Jt},IS_CHROMECAST_RECEIVER:di,get IE_VERSION(){return Ut},get IS_SAFARI(){return ui},get IS_WINDOWS(){return qt},get IS_IPAD(){return Ze},get IS_IPHONE(){return ki},get IS_TIZEN(){return wi},get IS_WEBOS(){return jt},get IS_SMART_TV(){return Yt},TOUCH_ENABLED:Ei,IS_IOS:hi,IS_ANY_SAFARI:Gt});function js(r){return typeof r=="string"&&!!r.trim()}function ps(r){if(r.indexOf(" ")>=0)throw new Error("class has illegal whitespace characters")}function mi(){return document===window.document}function $i(r){return K(r)&&r.nodeType===1}function ws(){try{return window.parent!==window.self}catch{return!0}}function pn(r){return function(e,s){if(!js(e))return document[r](null);js(s)&&(s=document.querySelector(s));const a=$i(s)?s:document;return a[r]&&a[r](e)}}function Mt(r="div",e={},s={},a){const h=document.createElement(r);return Object.getOwnPropertyNames(e).forEach(function(p){const _=e[p];p==="textContent"?Mi(h,_):(h[p]!==_||p==="tabIndex")&&(h[p]=_)}),Object.getOwnPropertyNames(s).forEach(function(p){h.setAttribute(p,s[p])}),a&&He(h,a),h}function Mi(r,e){return typeof r.textContent>"u"?r.innerText=e:r.textContent=e,r}function Fe(r,e){e.firstChild?e.insertBefore(r,e.firstChild):e.appendChild(r)}function Pi(r,e){return ps(e),r.classList.contains(e)}function qs(r,...e){return r.classList.add(...e.reduce((s,a)=>s.concat(a.split(/\s+/)),[])),r}function Bt(r,...e){return r?(r.classList.remove(...e.reduce((s,a)=>s.concat(a.split(/\s+/)),[])),r):(P.warn("removeClass was called with an element that doesn't exist"),null)}function ts(r,e,s){return typeof s=="function"&&(s=s(r,e)),typeof s!="boolean"&&(s=void 0),e.split(/\s+/).forEach(a=>r.classList.toggle(a,s)),r}function de(r,e){Object.getOwnPropertyNames(e).forEach(function(s){const a=e[s];a===null||typeof a>"u"||a===!1?r.removeAttribute(s):r.setAttribute(s,a===!0?"":a)})}function Te(r){const e={},s=["autoplay","controls","playsinline","loop","muted","default","defaultMuted"];if(r&&r.attributes&&r.attributes.length>0){const a=r.attributes;for(let h=a.length-1;h>=0;h--){const p=a[h].name;let _=a[h].value;s.includes(p)&&(_=_!==null),e[p]=_}}return e}function Me(r,e){return r.getAttribute(e)}function Xe(r,e,s){r.setAttribute(e,s)}function mt(r,e){r.removeAttribute(e)}function ft(){document.body.focus(),document.onselectstart=function(){return!1}}function wt(){document.onselectstart=function(){return!0}}function $t(r){if(r&&r.getBoundingClientRect&&r.parentNode){const e=r.getBoundingClientRect(),s={};return["bottom","height","left","right","top","width"].forEach(a=>{e[a]!==void 0&&(s[a]=e[a])}),s.height||(s.height=parseFloat(We(r,"height"))),s.width||(s.width=parseFloat(We(r,"width"))),s}}function oe(r){if(!r||r&&!r.offsetParent)return{left:0,top:0,width:0,height:0};const e=r.offsetWidth,s=r.offsetHeight;let a=0,h=0;for(;r.offsetParent&&r!==document[c.fullscreenElement];)a+=r.offsetLeft,h+=r.offsetTop,r=r.offsetParent;return{left:a,top:h,width:e,height:s}}function et(r,e){const s={x:0,y:0};if(hi){let G=r;for(;G&&G.nodeName.toLowerCase()!=="html";){const se=We(G,"transform");if(/^matrix/.test(se)){const pe=se.slice(7,-1).split(/,\s/).map(Number);s.x+=pe[4],s.y+=pe[5]}else if(/^matrix3d/.test(se)){const pe=se.slice(9,-1).split(/,\s/).map(Number);s.x+=pe[12],s.y+=pe[13]}if(G.assignedSlot&&G.assignedSlot.parentElement&&window.WebKitCSSMatrix){const pe=window.getComputedStyle(G.assignedSlot.parentElement).transform,Ee=new window.WebKitCSSMatrix(pe);s.x+=Ee.m41,s.y+=Ee.m42}G=G.parentNode||G.host}}const a={},h=oe(e.target),p=oe(r),_=p.width,w=p.height;let I=e.offsetY-(p.top-h.top),B=e.offsetX-(p.left-h.left);return e.changedTouches&&(B=e.changedTouches[0].pageX-p.left,I=e.changedTouches[0].pageY+p.top,hi&&(B-=s.x,I-=s.y)),a.y=1-Math.max(0,Math.min(1,I/w)),a.x=Math.max(0,Math.min(1,B/_)),a}function ht(r){return K(r)&&r.nodeType===3}function pt(r){for(;r.firstChild;)r.removeChild(r.firstChild);return r}function ke(r){return typeof r=="function"&&(r=r()),(Array.isArray(r)?r:[r]).map(e=>{if(typeof e=="function"&&(e=e()),$i(e)||ht(e))return e;if(typeof e=="string"&&/\S/.test(e))return document.createTextNode(e)}).filter(e=>e)}function He(r,e){return ke(e).forEach(s=>r.appendChild(s)),r}function ne(r,e){return He(pt(r),e)}function tt(r){return r.button===void 0&&r.buttons===void 0||r.button===0&&r.buttons===void 0||r.type==="mouseup"&&r.button===0&&r.buttons===0||r.type==="mousedown"&&r.button===0&&r.buttons===0?!0:!(r.button!==0||r.buttons!==1)}const xt=pn("querySelector"),z=pn("querySelectorAll");function We(r,e){if(!r||!e)return"";if(typeof window.getComputedStyle=="function"){let s;try{s=window.getComputedStyle(r)}catch{return""}return s?s.getPropertyValue(e)||s[e]:""}return""}function qe(r){[...document.styleSheets].forEach(e=>{try{const s=[...e.cssRules].map(h=>h.cssText).join(""),a=document.createElement("style");a.textContent=s,r.document.head.appendChild(a)}catch{const a=document.createElement("link");a.rel="stylesheet",a.type=e.type,a.media=e.media.mediaText,a.href=e.href,r.document.head.appendChild(a)}})}var le=Object.freeze({__proto__:null,isReal:mi,isEl:$i,isInFrame:ws,createEl:Mt,textContent:Mi,prependTo:Fe,hasClass:Pi,addClass:qs,removeClass:Bt,toggleClass:ts,setAttributes:de,getAttributes:Te,getAttribute:Me,setAttribute:Xe,removeAttribute:mt,blockTextSelection:ft,unblockTextSelection:wt,getBoundingClientRect:$t,findPosition:oe,getPointerPosition:et,isTextNode:ht,emptyEl:pt,normalizeContent:ke,appendContent:He,insertContent:ne,isSingleLeftClick:tt,$:xt,$$:z,computedStyle:We,copyStyleSheetsToWindow:qe});let De=!1,Ge;const Ot=function(){if(Ge.options.autoSetup===!1)return;const r=Array.prototype.slice.call(document.getElementsByTagName("video")),e=Array.prototype.slice.call(document.getElementsByTagName("audio")),s=Array.prototype.slice.call(document.getElementsByTagName("video-js")),a=r.concat(e,s);if(a&&a.length>0)for(let h=0,p=a.length;h<p;h++){const _=a[h];if(_&&_.getAttribute)_.player===void 0&&_.getAttribute("data-setup")!==null&&Ge(_);else{Ct(1);break}}else De||Ct(1)};function Ct(r,e){mi()&&(e&&(Ge=e),window.setTimeout(Ot,r))}function It(){De=!0,window.removeEventListener("load",It)}mi()&&(document.readyState==="complete"?It():window.addEventListener("load",It));const ni=function(r){const e=document.createElement("style");return e.className=r,e},Zs=function(r,e){r.styleSheet?r.styleSheet.cssText=e:r.textContent=e};var bi=new WeakMap;let gs=3;function qi(){return gs++}function Gs(r,e){if(!bi.has(r))return;const s=bi.get(r);s.handlers[e].length===0&&(delete s.handlers[e],r.removeEventListener?r.removeEventListener(e,s.dispatcher,!1):r.detachEvent&&r.detachEvent("on"+e,s.dispatcher)),Object.getOwnPropertyNames(s.handlers).length<=0&&(delete s.handlers,delete s.dispatcher,delete s.disabled),Object.getOwnPropertyNames(s).length===0&&bi.delete(r)}function Mn(r,e,s,a){s.forEach(function(h){r(e,h,a)})}function Sn(r){if(r.fixed_)return r;function e(){return!0}function s(){return!1}if(!r||!r.isPropagationStopped||!r.isImmediatePropagationStopped){const a=r||window.event;r={};const h=["layerX","layerY","keyLocation","path","webkitMovementX","webkitMovementY","mozPressure","mozInputSource"];for(const p in a)h.includes(p)||p==="returnValue"&&a.preventDefault||(r[p]=a[p]);if(r.target||(r.target=r.srcElement||document),r.relatedTarget||(r.relatedTarget=r.fromElement===r.target?r.toElement:r.fromElement),r.preventDefault=function(){a.preventDefault&&a.preventDefault(),r.returnValue=!1,a.returnValue=!1,r.defaultPrevented=!0},r.defaultPrevented=!1,r.stopPropagation=function(){a.stopPropagation&&a.stopPropagation(),r.cancelBubble=!0,a.cancelBubble=!0,r.isPropagationStopped=e},r.isPropagationStopped=s,r.stopImmediatePropagation=function(){a.stopImmediatePropagation&&a.stopImmediatePropagation(),r.isImmediatePropagationStopped=e,r.stopPropagation()},r.isImmediatePropagationStopped=s,r.clientX!==null&&r.clientX!==void 0){const p=document.documentElement,_=document.body;r.pageX=r.clientX+(p&&p.scrollLeft||_&&_.scrollLeft||0)-(p&&p.clientLeft||_&&_.clientLeft||0),r.pageY=r.clientY+(p&&p.scrollTop||_&&_.scrollTop||0)-(p&&p.clientTop||_&&_.clientTop||0)}r.which=r.charCode||r.keyCode,r.button!==null&&r.button!==void 0&&(r.button=r.button&1?0:r.button&4?1:r.button&2?2:0)}return r.fixed_=!0,r}let ji;const os=function(){if(typeof ji!="boolean"){ji=!1;try{const r=Object.defineProperty({},"passive",{get(){ji=!0}});window.addEventListener("test",null,r),window.removeEventListener("test",null,r)}catch{}}return ji},Ts=["touchstart","touchmove"];function _s(r,e,s){if(Array.isArray(e))return Mn(_s,r,e,s);bi.has(r)||bi.set(r,{});const a=bi.get(r);if(a.handlers||(a.handlers={}),a.handlers[e]||(a.handlers[e]=[]),s.guid||(s.guid=qi()),a.handlers[e].push(s),a.dispatcher||(a.disabled=!1,a.dispatcher=function(h,p){if(a.disabled)return;h=Sn(h);const _=a.handlers[h.type];if(_){const w=_.slice(0);for(let I=0,B=w.length;I<B&&!h.isImmediatePropagationStopped();I++)try{w[I].call(r,h,p)}catch(G){P.error(G)}}}),a.handlers[e].length===1)if(r.addEventListener){let h=!1;os()&&Ts.indexOf(e)>-1&&(h={passive:!0}),r.addEventListener(e,a.dispatcher,h)}else r.attachEvent&&r.attachEvent("on"+e,a.dispatcher)}function ss(r,e,s){if(!bi.has(r))return;const a=bi.get(r);if(!a.handlers)return;if(Array.isArray(e))return Mn(ss,r,e,s);const h=function(_,w){a.handlers[w]=[],Gs(_,w)};if(e===void 0){for(const _ in a.handlers)Object.prototype.hasOwnProperty.call(a.handlers||{},_)&&h(r,_);return}const p=a.handlers[e];if(p){if(!s){h(r,e);return}if(s.guid)for(let _=0;_<p.length;_++)p[_].guid===s.guid&&p.splice(_--,1);Gs(r,e)}}function sn(r,e,s){const a=bi.has(r)?bi.get(r):{},h=r.parentNode||r.ownerDocument;if(typeof e=="string"?e={type:e,target:r}:e.target||(e.target=r),e=Sn(e),a.dispatcher&&a.dispatcher.call(r,e,s),h&&!e.isPropagationStopped()&&e.bubbles===!0)sn.call(null,h,e,s);else if(!h&&!e.defaultPrevented&&e.target&&e.target[e.type]){bi.has(e.target)||bi.set(e.target,{});const p=bi.get(e.target);e.target[e.type]&&(p.disabled=!0,typeof e.target[e.type]=="function"&&e.target[e.type](),p.disabled=!1)}return!e.defaultPrevented}function Ne(r,e,s){if(Array.isArray(e))return Mn(Ne,r,e,s);const a=function(){ss(r,e,a),s.apply(this,arguments)};a.guid=s.guid=s.guid||qi(),_s(r,e,a)}function H(r,e,s){const a=function(){ss(r,e,a),s.apply(this,arguments)};a.guid=s.guid=s.guid||qi(),_s(r,e,a)}var ie=Object.freeze({__proto__:null,fixEvent:Sn,on:_s,off:ss,trigger:sn,one:Ne,any:H});const Ce=30,Ae=function(r,e,s){e.guid||(e.guid=qi());const a=e.bind(r);return a.guid=s?s+"_"+e.guid:e.guid,a},nt=function(r,e){let s=window.performance.now();return function(...h){const p=window.performance.now();p-s>=e&&(r(...h),s=p)}},Dt=function(r,e,s,a=window){let h;const p=()=>{a.clearTimeout(h),h=null},_=function(){const w=this,I=arguments;let B=function(){h=null,B=null,s||r.apply(w,I)};!h&&s&&r.apply(w,I),a.clearTimeout(h),h=a.setTimeout(B,e)};return _.cancel=p,_};var Ai=Object.freeze({__proto__:null,UPDATE_REFRESH_INTERVAL:Ce,bind_:Ae,throttle:nt,debounce:Dt});let Di;class Ki{on(e,s){const a=this.addEventListener;this.addEventListener=()=>{},_s(this,e,s),this.addEventListener=a}off(e,s){ss(this,e,s)}one(e,s){const a=this.addEventListener;this.addEventListener=()=>{},Ne(this,e,s),this.addEventListener=a}any(e,s){const a=this.addEventListener;this.addEventListener=()=>{},H(this,e,s),this.addEventListener=a}trigger(e){const s=e.type||e;typeof e=="string"&&(e={type:s}),e=Sn(e),this.allowedEvents_[s]&&this["on"+s]&&this["on"+s](e),sn(this,e)}queueTrigger(e){Di||(Di=new Map);const s=e.type||e;let a=Di.get(this);a||(a=new Map,Di.set(this,a));const h=a.get(s);a.delete(s),window.clearTimeout(h);const p=window.setTimeout(()=>{a.delete(s),a.size===0&&(a=null,Di.delete(this)),this.trigger(e)},0);a.set(s,p)}}Ki.prototype.allowedEvents_={},Ki.prototype.addEventListener=Ki.prototype.on,Ki.prototype.removeEventListener=Ki.prototype.off,Ki.prototype.dispatchEvent=Ki.prototype.trigger;const Es=r=>typeof r.name=="function"?r.name():typeof r.name=="string"?r.name:r.name_?r.name_:r.constructor&&r.constructor.name?r.constructor.name:typeof r,Ht=r=>r instanceof Ki||!!r.eventBusEl_&&["on","one","off","trigger"].every(e=>typeof r[e]=="function"),Xs=(r,e)=>{Ht(r)?e():(r.eventedCallbacks||(r.eventedCallbacks=[]),r.eventedCallbacks.push(e))},ks=r=>typeof r=="string"&&/\S/.test(r)||Array.isArray(r)&&!!r.length,nn=(r,e,s)=>{if(!r||!r.nodeName&&!Ht(r))throw new Error(`Invalid target for ${Es(e)}#${s}; must be a DOM node or evented object.`)},hs=(r,e,s)=>{if(!ks(r))throw new Error(`Invalid event type for ${Es(e)}#${s}; must be a non-empty string or array.`)},yn=(r,e,s)=>{if(typeof r!="function")throw new Error(`Invalid listener for ${Es(e)}#${s}; must be a function.`)},Gn=(r,e,s)=>{const a=e.length<3||e[0]===r||e[0]===r.eventBusEl_;let h,p,_;return a?(h=r.eventBusEl_,e.length>=3&&e.shift(),[p,_]=e):(h=e[0],p=e[1],_=e[2]),nn(h,r,s),hs(p,r,s),yn(_,r,s),_=Ae(r,_),{isTargetingSelf:a,target:h,type:p,listener:_}},sr=(r,e,s,a)=>{nn(r,r,e),r.nodeName?ie[e](r,s,a):r[e](s,a)},La={on(...r){const{isTargetingSelf:e,target:s,type:a,listener:h}=Gn(this,r,"on");if(sr(s,"on",a,h),!e){const p=()=>this.off(s,a,h);p.guid=h.guid;const _=()=>this.off("dispose",p);_.guid=h.guid,sr(this,"on","dispose",p),sr(s,"on","dispose",_)}},one(...r){const{isTargetingSelf:e,target:s,type:a,listener:h}=Gn(this,r,"one");if(e)sr(s,"one",a,h);else{const p=(..._)=>{this.off(s,a,p),h.apply(null,_)};p.guid=h.guid,sr(s,"one",a,p)}},any(...r){const{isTargetingSelf:e,target:s,type:a,listener:h}=Gn(this,r,"any");if(e)sr(s,"any",a,h);else{const p=(..._)=>{this.off(s,a,p),h.apply(null,_)};p.guid=h.guid,sr(s,"any",a,p)}},off(r,e,s){if(!r||ks(r))ss(this.eventBusEl_,r,e);else{const a=r,h=e;nn(a,this,"off"),hs(h,this,"off"),yn(s,this,"off"),s=Ae(this,s),this.off("dispose",s),a.nodeName?(ss(a,h,s),ss(a,"dispose",s)):Ht(a)&&(a.off(h,s),a.off("dispose",s))}},trigger(r,e){nn(this.eventBusEl_,this,"trigger");const s=r&&typeof r!="string"?r.type:r;if(!ks(s))throw new Error(`Invalid event type for ${Es(this)}#trigger; must be a non-empty string or object with a type key that has a non-empty value.`);return sn(this.eventBusEl_,r,e)}};function ue(r,e={}){const{eventBusKey:s}=e;if(s){if(!r[s].nodeName)throw new Error(`The eventBusKey "${s}" does not refer to an element.`);r.eventBusEl_=r[s]}else r.eventBusEl_=Mt("span",{className:"vjs-event-bus"});return Object.assign(r,La),r.eventedCallbacks&&r.eventedCallbacks.forEach(a=>{a()}),r.on("dispose",()=>{r.off(),[r,r.el_,r.eventBusEl_].forEach(function(a){a&&bi.has(a)&&bi.delete(a)}),window.setTimeout(()=>{r.eventBusEl_=null},0)}),r}const S={state:{},setState(r){typeof r=="function"&&(r=r());let e;return X(r,(s,a)=>{this.state[a]!==s&&(e=e||{},e[a]={from:this.state[a],to:s}),this.state[a]=s}),e&&Ht(this)&&this.trigger({changes:e,type:"statechanged"}),e}};function k(r,e){return Object.assign(r,S),r.state=Object.assign({},r.state,e),typeof r.handleStateChanged=="function"&&Ht(r)&&r.on("statechanged",r.handleStateChanged),r}const V=function(r){return typeof r!="string"?r:r.replace(/./,e=>e.toLowerCase())},he=function(r){return typeof r!="string"?r:r.replace(/./,e=>e.toUpperCase())},we=function(r,e){return he(r)===he(e)};var rt=Object.freeze({__proto__:null,toLowerCase:V,toTitleCase:he,titleCaseEquals:we});class Le{constructor(e,s,a){if(!e&&this.play?this.player_=e=this:this.player_=e,this.isDisposed_=!1,this.parentComponent_=null,this.options_=ee({},this.options_),s=this.options_=ee(this.options_,s),this.id_=s.id||s.el&&s.el.id,!this.id_){const h=e&&e.id&&e.id()||"no_player";this.id_=`${h}_component_${qi()}`}this.name_=s.name||null,s.el?this.el_=s.el:s.createEl!==!1&&(this.el_=this.createEl()),s.className&&this.el_&&s.className.split(" ").forEach(h=>this.addClass(h)),["on","off","one","any","trigger"].forEach(h=>{this[h]=void 0}),s.evented!==!1&&(ue(this,{eventBusKey:this.el_?"el_":null}),this.handleLanguagechange=this.handleLanguagechange.bind(this),this.on(this.player_,"languagechange",this.handleLanguagechange)),k(this,this.constructor.defaultState),this.children_=[],this.childIndex_={},this.childNameIndex_={},this.setTimeoutIds_=new Set,this.setIntervalIds_=new Set,this.rafIds_=new Set,this.namedRafs_=new Map,this.clearingTimersOnDispose_=!1,s.initChildren!==!1&&this.initChildren(),this.ready(a),s.reportTouchActivity!==!1&&this.enableTouchActivity()}dispose(e={}){if(!this.isDisposed_){if(this.readyQueue_&&(this.readyQueue_.length=0),this.trigger({type:"dispose",bubbles:!1}),this.isDisposed_=!0,this.children_)for(let s=this.children_.length-1;s>=0;s--)this.children_[s].dispose&&this.children_[s].dispose();this.children_=null,this.childIndex_=null,this.childNameIndex_=null,this.parentComponent_=null,this.el_&&(this.el_.parentNode&&(e.restoreEl?this.el_.parentNode.replaceChild(e.restoreEl,this.el_):this.el_.parentNode.removeChild(this.el_)),this.el_=null),this.player_=null}}isDisposed(){return!!this.isDisposed_}player(){return this.player_}options(e){return e?(this.options_=ee(this.options_,e),this.options_):this.options_}el(){return this.el_}createEl(e,s,a){return Mt(e,s,a)}localize(e,s,a=e){const h=this.player_.language&&this.player_.language(),p=this.player_.languages&&this.player_.languages(),_=p&&p[h],w=h&&h.split("-")[0],I=p&&p[w];let B=a;return _&&_[e]?B=_[e]:I&&I[e]&&(B=I[e]),s&&(B=B.replace(/\{(\d+)\}/g,function(G,se){const pe=s[se-1];let Ee=pe;return typeof pe>"u"&&(Ee=G),Ee})),B}handleLanguagechange(){}contentEl(){return this.contentEl_||this.el_}id(){return this.id_}name(){return this.name_}children(){return this.children_}getChildById(e){return this.childIndex_[e]}getChild(e){if(e)return this.childNameIndex_[e]}getDescendant(...e){e=e.reduce((a,h)=>a.concat(h),[]);let s=this;for(let a=0;a<e.length;a++)if(s=s.getChild(e[a]),!s||!s.getChild)return;return s}setIcon(e,s=this.el()){if(!this.player_.options_.experimentalSvgIcons)return;const a="http://www.w3.org/2000/svg",h=Mt("span",{className:"vjs-icon-placeholder vjs-svg-icon"},{"aria-hidden":"true"}),p=document.createElementNS(a,"svg");p.setAttributeNS(null,"viewBox","0 0 512 512");const _=document.createElementNS(a,"use");return p.appendChild(_),_.setAttributeNS(null,"href",`#vjs-icon-${e}`),h.appendChild(p),this.iconIsSet_?s.replaceChild(h,s.querySelector(".vjs-icon-placeholder")):s.appendChild(h),this.iconIsSet_=!0,h}addChild(e,s={},a=this.children_.length){let h,p;if(typeof e=="string"){p=he(e);const _=s.componentClass||p;s.name=p;const w=Le.getComponent(_);if(!w)throw new Error(`Component ${_} does not exist`);if(typeof w!="function")return null;h=new w(this.player_||this,s)}else h=e;if(h.parentComponent_&&h.parentComponent_.removeChild(h),this.children_.splice(a,0,h),h.parentComponent_=this,typeof h.id=="function"&&(this.childIndex_[h.id()]=h),p=p||h.name&&he(h.name()),p&&(this.childNameIndex_[p]=h,this.childNameIndex_[V(p)]=h),typeof h.el=="function"&&h.el()){let _=null;this.children_[a+1]&&(this.children_[a+1].el_?_=this.children_[a+1].el_:$i(this.children_[a+1])&&(_=this.children_[a+1])),this.contentEl().insertBefore(h.el(),_)}return h}removeChild(e){if(typeof e=="string"&&(e=this.getChild(e)),!e||!this.children_)return;let s=!1;for(let h=this.children_.length-1;h>=0;h--)if(this.children_[h]===e){s=!0,this.children_.splice(h,1);break}if(!s)return;e.parentComponent_=null,this.childIndex_[e.id()]=null,this.childNameIndex_[he(e.name())]=null,this.childNameIndex_[V(e.name())]=null;const a=e.el();a&&a.parentNode===this.contentEl()&&this.contentEl().removeChild(e.el())}initChildren(){const e=this.options_.children;if(e){const s=this.options_,a=_=>{const w=_.name;let I=_.opts;if(s[w]!==void 0&&(I=s[w]),I===!1)return;I===!0&&(I={}),I.playerOptions=this.options_.playerOptions;const B=this.addChild(w,I);B&&(this[w]=B)};let h;const p=Le.getComponent("Tech");Array.isArray(e)?h=e:h=Object.keys(e),h.concat(Object.keys(this.options_).filter(function(_){return!h.some(function(w){return typeof w=="string"?_===w:_===w.name})})).map(_=>{let w,I;return typeof _=="string"?(w=_,I=e[w]||this.options_[w]||{}):(w=_.name,I=_),{name:w,opts:I}}).filter(_=>{const w=Le.getComponent(_.opts.componentClass||he(_.name));return w&&!p.isTech(w)}).forEach(a)}}buildCSSClass(){return""}ready(e,s=!1){if(e){if(!this.isReady_){this.readyQueue_=this.readyQueue_||[],this.readyQueue_.push(e);return}s?e.call(this):this.setTimeout(e,1)}}triggerReady(){this.isReady_=!0,this.setTimeout(function(){const e=this.readyQueue_;this.readyQueue_=[],e&&e.length>0&&e.forEach(function(s){s.call(this)},this),this.trigger("ready")},1)}$(e,s){return xt(e,s||this.contentEl())}$$(e,s){return z(e,s||this.contentEl())}hasClass(e){return Pi(this.el_,e)}addClass(...e){qs(this.el_,...e)}removeClass(...e){Bt(this.el_,...e)}toggleClass(e,s){ts(this.el_,e,s)}show(){this.removeClass("vjs-hidden")}hide(){this.addClass("vjs-hidden")}lockShowing(){this.addClass("vjs-lock-showing")}unlockShowing(){this.removeClass("vjs-lock-showing")}getAttribute(e){return Me(this.el_,e)}setAttribute(e,s){Xe(this.el_,e,s)}removeAttribute(e){mt(this.el_,e)}width(e,s){return this.dimension("width",e,s)}height(e,s){return this.dimension("height",e,s)}dimensions(e,s){this.width(e,!0),this.height(s)}dimension(e,s,a){if(s!==void 0){(s===null||s!==s)&&(s=0),(""+s).indexOf("%")!==-1||(""+s).indexOf("px")!==-1?this.el_.style[e]=s:s==="auto"?this.el_.style[e]="":this.el_.style[e]=s+"px",a||this.trigger("componentresize");return}if(!this.el_)return 0;const h=this.el_.style[e],p=h.indexOf("px");return parseInt(p!==-1?h.slice(0,p):this.el_["offset"+he(e)],10)}currentDimension(e){let s=0;if(e!=="width"&&e!=="height")throw new Error("currentDimension only accepts width or height value");if(s=We(this.el_,e),s=parseFloat(s),s===0||isNaN(s)){const a=`offset${he(e)}`;s=this.el_[a]}return s}currentDimensions(){return{width:this.currentDimension("width"),height:this.currentDimension("height")}}currentWidth(){return this.currentDimension("width")}currentHeight(){return this.currentDimension("height")}getPositions(){const e=this.el_.getBoundingClientRect(),s={x:e.x,y:e.y,width:e.width,height:e.height,top:e.top,right:e.right,bottom:e.bottom,left:e.left},a={x:e.left+e.width/2,y:e.top+e.height/2,width:0,height:0,top:e.top+e.height/2,right:e.left+e.width/2,bottom:e.top+e.height/2,left:e.left+e.width/2};return{boundingClientRect:s,center:a}}focus(){this.el_.focus()}blur(){this.el_.blur()}handleKeyDown(e){this.player_&&(e.key!=="Tab"&&!(this.player_.options_.playerOptions.spatialNavigation&&this.player_.options_.playerOptions.spatialNavigation.enabled)&&e.stopPropagation(),this.player_.handleKeyDown(e))}handleKeyPress(e){this.handleKeyDown(e)}emitTapEvents(){let e=0,s=null;const a=10,h=200;let p;this.on("touchstart",function(w){w.touches.length===1&&(s={pageX:w.touches[0].pageX,pageY:w.touches[0].pageY},e=window.performance.now(),p=!0)}),this.on("touchmove",function(w){if(w.touches.length>1)p=!1;else if(s){const I=w.touches[0].pageX-s.pageX,B=w.touches[0].pageY-s.pageY;Math.sqrt(I*I+B*B)>a&&(p=!1)}});const _=function(){p=!1};this.on("touchleave",_),this.on("touchcancel",_),this.on("touchend",function(w){s=null,p===!0&&window.performance.now()-e<h&&(w.preventDefault(),this.trigger("tap"))})}enableTouchActivity(){if(!this.player()||!this.player().reportUserActivity)return;const e=Ae(this.player(),this.player().reportUserActivity);let s;this.on("touchstart",function(){e(),this.clearInterval(s),s=this.setInterval(e,250)});const a=function(h){e(),this.clearInterval(s)};this.on("touchmove",e),this.on("touchend",a),this.on("touchcancel",a)}setTimeout(e,s){var a;return e=Ae(this,e),this.clearTimersOnDispose_(),a=window.setTimeout(()=>{this.setTimeoutIds_.has(a)&&this.setTimeoutIds_.delete(a),e()},s),this.setTimeoutIds_.add(a),a}clearTimeout(e){return this.setTimeoutIds_.has(e)&&(this.setTimeoutIds_.delete(e),window.clearTimeout(e)),e}setInterval(e,s){e=Ae(this,e),this.clearTimersOnDispose_();const a=window.setInterval(e,s);return this.setIntervalIds_.add(a),a}clearInterval(e){return this.setIntervalIds_.has(e)&&(this.setIntervalIds_.delete(e),window.clearInterval(e)),e}requestAnimationFrame(e){this.clearTimersOnDispose_();var s;return e=Ae(this,e),s=window.requestAnimationFrame(()=>{this.rafIds_.has(s)&&this.rafIds_.delete(s),e()}),this.rafIds_.add(s),s}requestNamedAnimationFrame(e,s){this.namedRafs_.has(e)&&this.cancelNamedAnimationFrame(e),this.clearTimersOnDispose_(),s=Ae(this,s);const a=this.requestAnimationFrame(()=>{s(),this.namedRafs_.has(e)&&this.namedRafs_.delete(e)});return this.namedRafs_.set(e,a),e}cancelNamedAnimationFrame(e){this.namedRafs_.has(e)&&(this.cancelAnimationFrame(this.namedRafs_.get(e)),this.namedRafs_.delete(e))}cancelAnimationFrame(e){return this.rafIds_.has(e)&&(this.rafIds_.delete(e),window.cancelAnimationFrame(e)),e}clearTimersOnDispose_(){this.clearingTimersOnDispose_||(this.clearingTimersOnDispose_=!0,this.one("dispose",()=>{[["namedRafs_","cancelNamedAnimationFrame"],["rafIds_","cancelAnimationFrame"],["setTimeoutIds_","clearTimeout"],["setIntervalIds_","clearInterval"]].forEach(([e,s])=>{this[e].forEach((a,h)=>this[s](h))}),this.clearingTimersOnDispose_=!1}))}getIsDisabled(){return!!this.el_.disabled}getIsExpresslyInert(){return this.el_.inert&&!this.el_.ownerDocument.documentElement.inert}getIsFocusable(e){return(e||this.el_).tabIndex>=0&&!(this.getIsDisabled()||this.getIsExpresslyInert())}getIsAvailableToBeFocused(e){function s(p){const _=window.getComputedStyle(p,null),w=_.getPropertyValue("visibility");return _.getPropertyValue("display")!=="none"&&!["hidden","collapse"].includes(w)}function a(p){return!(!s(p.parentElement)||!s(p)||p.style.opacity==="0"||window.getComputedStyle(p).height==="0px"||window.getComputedStyle(p).width==="0px")}function h(p){if(p.offsetWidth+p.offsetHeight+p.getBoundingClientRect().height+p.getBoundingClientRect().width===0)return!1;const _={x:p.getBoundingClientRect().left+p.offsetWidth/2,y:p.getBoundingClientRect().top+p.offsetHeight/2};if(_.x<0||_.x>(document.documentElement.clientWidth||window.innerWidth)||_.y<0||_.y>(document.documentElement.clientHeight||window.innerHeight))return!1;let w=document.elementFromPoint(_.x,_.y);for(;w;){if(w===p)return!0;if(w.parentNode)w=w.parentNode;else return!1}}return e||(e=this.el()),!!(h(e)&&a(e)&&(!e.parentElement||e.tabIndex>=0))}static registerComponent(e,s){if(typeof e!="string"||!e)throw new Error(`Illegal component name, "${e}"; must be a non-empty string.`);const a=Le.getComponent("Tech"),h=a&&a.isTech(s),p=Le===s||Le.prototype.isPrototypeOf(s.prototype);if(h||!p){let w;throw h?w="techs must be registered using Tech.registerTech()":w="must be a Component subclass",new Error(`Illegal component, "${e}"; ${w}.`)}e=he(e),Le.components_||(Le.components_={});const _=Le.getComponent("Player");if(e==="Player"&&_&&_.players){const w=_.players,I=Object.keys(w);if(w&&I.length>0){for(let B=0;B<I.length;B++)if(w[I[B]]!==null)throw new Error("Can not register Player component after player has been created.")}}return Le.components_[e]=s,Le.components_[V(e)]=s,s}static getComponent(e){if(!(!e||!Le.components_))return Le.components_[e]}}Le.registerComponent("Component",Le);function Rt(r,e,s){if(typeof e!="number"||e<0||e>s)throw new Error(`Failed to execute '${r}' on 'TimeRanges': The index provided (${e}) is non-numeric or out of bounds (0-${s}).`)}function Ls(r,e,s,a){return Rt(r,a,s.length-1),s[a][e]}function Ss(r){let e;return r===void 0||r.length===0?e={length:0,start(){throw new Error("This TimeRanges object is empty")},end(){throw new Error("This TimeRanges object is empty")}}:e={length:r.length,start:Ls.bind(null,"start",0,r),end:Ls.bind(null,"end",1,r)},window.Symbol&&window.Symbol.iterator&&(e[window.Symbol.iterator]=()=>(r||[]).values()),e}function ns(r,e){return Array.isArray(r)?Ss(r):r===void 0||e===void 0?Ss():Ss([[r,e]])}const zi=function(r,e){r=r<0?0:r;let s=Math.floor(r%60),a=Math.floor(r/60%60),h=Math.floor(r/3600);const p=Math.floor(e/60%60),_=Math.floor(e/3600);return(isNaN(r)||r===1/0)&&(h=a=s="-"),h=h>0||_>0?h+":":"",a=((h||p>=10)&&a<10?"0"+a:a)+":",s=s<10?"0"+s:s,h+a+s};let On=zi;function Na(r){On=r}function vr(){On=zi}function xn(r,e=r){return On(r,e)}var Oo=Object.freeze({__proto__:null,createTimeRanges:ns,createTimeRange:ns,setFormatTime:Na,resetFormatTime:vr,formatTime:xn});function nr(r,e){let s=0,a,h;if(!e)return 0;(!r||!r.length)&&(r=ns(0,0));for(let p=0;p<r.length;p++)a=r.start(p),h=r.end(p),h>e&&(h=e),s+=h-a;return s/e}function bs(r){if(r instanceof bs)return r;typeof r=="number"?this.code=r:typeof r=="string"?this.message=r:K(r)&&(typeof r.code=="number"&&(this.code=r.code),Object.assign(this,r)),this.message||(this.message=bs.defaultMessages[this.code]||"")}bs.prototype.code=0,bs.prototype.message="",bs.prototype.status=null,bs.prototype.metadata=null,bs.errorTypes=["MEDIA_ERR_CUSTOM","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_ENCRYPTED"],bs.defaultMessages={1:"You aborted the media playback",2:"A network error caused the media download to fail part-way.",3:"The media playback was aborted due to a corruption problem or because the media used features your browser did not support.",4:"The media could not be loaded, either because the server or network failed or because the format is not supported.",5:"The media is encrypted and we do not have the keys to decrypt it."},bs.MEDIA_ERR_CUSTOM=0,bs.prototype.MEDIA_ERR_CUSTOM=0,bs.MEDIA_ERR_ABORTED=1,bs.prototype.MEDIA_ERR_ABORTED=1,bs.MEDIA_ERR_NETWORK=2,bs.prototype.MEDIA_ERR_NETWORK=2,bs.MEDIA_ERR_DECODE=3,bs.prototype.MEDIA_ERR_DECODE=3,bs.MEDIA_ERR_SRC_NOT_SUPPORTED=4,bs.prototype.MEDIA_ERR_SRC_NOT_SUPPORTED=4,bs.MEDIA_ERR_ENCRYPTED=5,bs.prototype.MEDIA_ERR_ENCRYPTED=5;function ho(r){return r!=null&&typeof r.then=="function"}function Wr(r){ho(r)&&r.then(null,e=>{})}const Fh=function(r){return["kind","label","language","id","inBandMetadataTrackDispatchType","mode","src"].reduce((s,a,h)=>(r[a]&&(s[a]=r[a]),s),{cues:r.cues&&Array.prototype.map.call(r.cues,function(s){return{startTime:s.startTime,endTime:s.endTime,text:s.text,id:s.id}})})};var f_={textTracksToJson:function(r){const e=r.$$("track"),s=Array.prototype.map.call(e,h=>h.track);return Array.prototype.map.call(e,function(h){const p=Fh(h.track);return h.src&&(p.src=h.src),p}).concat(Array.prototype.filter.call(r.textTracks(),function(h){return s.indexOf(h)===-1}).map(Fh))},jsonToTextTracks:function(r,e){return r.forEach(function(s){const a=e.addRemoteTextTrack(s).track;!s.src&&s.cues&&s.cues.forEach(h=>a.addCue(h))}),e.textTracks()},trackToJson:Fh};const p_="vjs-modal-dialog";class Bh extends Le{constructor(e,s){super(e,s),this.handleKeyDown_=a=>this.handleKeyDown(a),this.close_=a=>this.close(a),this.opened_=this.hasBeenOpened_=this.hasBeenFilled_=!1,this.closeable(!this.options_.uncloseable),this.content(this.options_.content),this.contentEl_=Mt("div",{className:`${p_}-content`},{role:"document"}),this.descEl_=Mt("p",{className:`${p_}-description vjs-control-text`,id:this.el().getAttribute("aria-describedby")}),Mi(this.descEl_,this.description()),this.el_.appendChild(this.descEl_),this.el_.appendChild(this.contentEl_)}createEl(){return super.createEl("div",{className:this.buildCSSClass(),tabIndex:-1},{"aria-describedby":`${this.id()}_description`,"aria-hidden":"true","aria-label":this.label(),role:"dialog","aria-live":"polite"})}dispose(){this.contentEl_=null,this.descEl_=null,this.previouslyActiveEl_=null,super.dispose()}buildCSSClass(){return`${p_} vjs-hidden ${super.buildCSSClass()}`}label(){return this.localize(this.options_.label||"Modal Window")}description(){let e=this.options_.description||this.localize("This is a modal window.");return this.closeable()&&(e+=" "+this.localize("This modal can be closed by pressing the Escape key or activating the close button.")),e}open(){if(this.opened_){this.options_.fillAlways&&this.fill();return}const e=this.player();this.trigger("beforemodalopen"),this.opened_=!0,(this.options_.fillAlways||!this.hasBeenOpened_&&!this.hasBeenFilled_)&&this.fill(),this.wasPlaying_=!e.paused(),this.options_.pauseOnOpen&&this.wasPlaying_&&e.pause(),this.on("keydown",this.handleKeyDown_),this.hadControls_=e.controls(),e.controls(!1),this.show(),this.conditionalFocus_(),this.el().setAttribute("aria-hidden","false"),this.trigger("modalopen"),this.hasBeenOpened_=!0}opened(e){return typeof e=="boolean"&&this[e?"open":"close"](),this.opened_}close(){if(!this.opened_)return;const e=this.player();this.trigger("beforemodalclose"),this.opened_=!1,this.wasPlaying_&&this.options_.pauseOnOpen&&e.play(),this.off("keydown",this.handleKeyDown_),this.hadControls_&&e.controls(!0),this.hide(),this.el().setAttribute("aria-hidden","true"),this.trigger({type:"modalclose",bubbles:!0}),this.conditionalBlur_(),this.options_.temporary&&this.dispose()}closeable(e){if(typeof e=="boolean"){const s=this.closeable_=!!e;let a=this.getChild("closeButton");if(s&&!a){const h=this.contentEl_;this.contentEl_=this.el_,a=this.addChild("closeButton",{controlText:"Close Modal Dialog"}),this.contentEl_=h,this.on(a,"close",this.close_)}!s&&a&&(this.off(a,"close",this.close_),this.removeChild(a),a.dispose())}return this.closeable_}fill(){this.fillWith(this.content())}fillWith(e){const s=this.contentEl(),a=s.parentNode,h=s.nextSibling;this.trigger("beforemodalfill"),this.hasBeenFilled_=!0,a.removeChild(s),this.empty(),ne(s,e),this.trigger("modalfill"),h?a.insertBefore(s,h):a.appendChild(s);const p=this.getChild("closeButton");p&&a.appendChild(p.el_),this.trigger("aftermodalfill")}empty(){this.trigger("beforemodalempty"),pt(this.contentEl()),this.trigger("modalempty")}content(e){return typeof e<"u"&&(this.content_=e),this.content_}conditionalFocus_(){const e=document.activeElement,s=this.player_.el_;this.previouslyActiveEl_=null,(s.contains(e)||s===e)&&(this.previouslyActiveEl_=e,this.focus())}conditionalBlur_(){this.previouslyActiveEl_&&(this.previouslyActiveEl_.focus(),this.previouslyActiveEl_=null)}handleKeyDown(e){if(this.trigger({type:"modalKeydown",originalEvent:e,target:this,bubbles:!0}),e.stopPropagation(),e.key==="Escape"&&this.closeable()){e.preventDefault(),this.close();return}if(e.key!=="Tab")return;const s=this.focusableEls_(),a=this.el_.querySelector(":focus");let h;for(let p=0;p<s.length;p++)if(a===s[p]){h=p;break}document.activeElement===this.el_&&(h=0),e.shiftKey&&h===0?(s[s.length-1].focus(),e.preventDefault()):!e.shiftKey&&h===s.length-1&&(s[0].focus(),e.preventDefault())}focusableEls_(){const e=this.el_.querySelectorAll("*");return Array.prototype.filter.call(e,s=>(s instanceof window.HTMLAnchorElement||s instanceof window.HTMLAreaElement)&&s.hasAttribute("href")||(s instanceof window.HTMLInputElement||s instanceof window.HTMLSelectElement||s instanceof window.HTMLTextAreaElement||s instanceof window.HTMLButtonElement)&&!s.hasAttribute("disabled")||s instanceof window.HTMLIFrameElement||s instanceof window.HTMLObjectElement||s instanceof window.HTMLEmbedElement||s.hasAttribute("tabindex")&&s.getAttribute("tabindex")!==-1||s.hasAttribute("contenteditable"))}}Bh.prototype.options_={pauseOnOpen:!0,temporary:!0},Le.registerComponent("ModalDialog",Bh);class bu extends Ki{constructor(e=[]){super(),this.tracks_=[],Object.defineProperty(this,"length",{get(){return this.tracks_.length}});for(let s=0;s<e.length;s++)this.addTrack(e[s])}addTrack(e){const s=this.tracks_.length;""+s in this||Object.defineProperty(this,s,{get(){return this.tracks_[s]}}),this.tracks_.indexOf(e)===-1&&(this.tracks_.push(e),this.trigger({track:e,type:"addtrack",target:this})),e.labelchange_=()=>{this.trigger({track:e,type:"labelchange",target:this})},Ht(e)&&e.addEventListener("labelchange",e.labelchange_)}removeTrack(e){let s;for(let a=0,h=this.length;a<h;a++)if(this[a]===e){s=this[a],s.off&&s.off(),this.tracks_.splice(a,1);break}s&&this.trigger({track:s,type:"removetrack",target:this})}getTrackById(e){let s=null;for(let a=0,h=this.length;a<h;a++){const p=this[a];if(p.id===e){s=p;break}}return s}}bu.prototype.allowedEvents_={change:"change",addtrack:"addtrack",removetrack:"removetrack",labelchange:"labelchange"};for(const r in bu.prototype.allowedEvents_)bu.prototype["on"+r]=null;const g_=function(r,e){for(let s=0;s<r.length;s++)!Object.keys(r[s]).length||e.id===r[s].id||(r[s].enabled=!1)};class gT extends bu{constructor(e=[]){for(let s=e.length-1;s>=0;s--)if(e[s].enabled){g_(e,e[s]);break}super(e),this.changing_=!1}addTrack(e){e.enabled&&g_(this,e),super.addTrack(e),e.addEventListener&&(e.enabledChange_=()=>{this.changing_||(this.changing_=!0,g_(this,e),this.changing_=!1,this.trigger("change"))},e.addEventListener("enabledchange",e.enabledChange_))}removeTrack(e){super.removeTrack(e),e.removeEventListener&&e.enabledChange_&&(e.removeEventListener("enabledchange",e.enabledChange_),e.enabledChange_=null)}}const m_=function(r,e){for(let s=0;s<r.length;s++)!Object.keys(r[s]).length||e.id===r[s].id||(r[s].selected=!1)};class __ extends bu{constructor(e=[]){for(let s=e.length-1;s>=0;s--)if(e[s].selected){m_(e,e[s]);break}super(e),this.changing_=!1,Object.defineProperty(this,"selectedIndex",{get(){for(let s=0;s<this.length;s++)if(this[s].selected)return s;return-1},set(){}})}addTrack(e){e.selected&&m_(this,e),super.addTrack(e),e.addEventListener&&(e.selectedChange_=()=>{this.changing_||(this.changing_=!0,m_(this,e),this.changing_=!1,this.trigger("change"))},e.addEventListener("selectedchange",e.selectedChange_))}removeTrack(e){super.removeTrack(e),e.removeEventListener&&e.selectedChange_&&(e.removeEventListener("selectedchange",e.selectedChange_),e.selectedChange_=null)}}class Rd extends bu{addTrack(e){super.addTrack(e),this.queueChange_||(this.queueChange_=()=>this.queueTrigger("change")),this.triggerSelectedlanguagechange||(this.triggerSelectedlanguagechange_=()=>this.trigger("selectedlanguagechange")),e.addEventListener("modechange",this.queueChange_),["metadata","chapters"].indexOf(e.kind)===-1&&e.addEventListener("modechange",this.triggerSelectedlanguagechange_)}removeTrack(e){super.removeTrack(e),e.removeEventListener&&(this.queueChange_&&e.removeEventListener("modechange",this.queueChange_),this.selectedlanguagechange_&&e.removeEventListener("modechange",this.triggerSelectedlanguagechange_))}toJSON(){return this.tracks_.map(e=>e.toJSON())}}class mT{constructor(e=[]){this.trackElements_=[],Object.defineProperty(this,"length",{get(){return this.trackElements_.length}});for(let s=0,a=e.length;s<a;s++)this.addTrackElement_(e[s])}addTrackElement_(e){const s=this.trackElements_.length;""+s in this||Object.defineProperty(this,s,{get(){return this.trackElements_[s]}}),this.trackElements_.indexOf(e)===-1&&this.trackElements_.push(e)}getTrackElementByTrack_(e){let s;for(let a=0,h=this.trackElements_.length;a<h;a++)if(e===this.trackElements_[a].track){s=this.trackElements_[a];break}return s}removeTrackElement_(e){for(let s=0,a=this.trackElements_.length;s<a;s++)if(e===this.trackElements_[s]){this.trackElements_[s].track&&typeof this.trackElements_[s].track.off=="function"&&this.trackElements_[s].track.off(),typeof this.trackElements_[s].off=="function"&&this.trackElements_[s].off(),this.trackElements_.splice(s,1);break}}}class Uh{constructor(e){Uh.prototype.setCues_.call(this,e),Object.defineProperty(this,"length",{get(){return this.length_}})}setCues_(e){const s=this.length||0;let a=0;const h=e.length;this.cues_=e,this.length_=e.length;const p=function(_){""+_ in this||Object.defineProperty(this,""+_,{get(){return this.cues_[_]}})};if(s<h)for(a=s;a<h;a++)p.call(this,a)}getCueById(e){let s=null;for(let a=0,h=this.length;a<h;a++){const p=this[a];if(p.id===e){s=p;break}}return s}}const _T={alternative:"alternative",captions:"captions",main:"main",sign:"sign",subtitles:"subtitles",commentary:"commentary"},bT={alternative:"alternative",descriptions:"descriptions",main:"main","main-desc":"main-desc",translation:"translation",commentary:"commentary"},b_={subtitles:"subtitles",captions:"captions",descriptions:"descriptions",chapters:"chapters",metadata:"metadata"},yT={disabled:"disabled",hidden:"hidden",showing:"showing"};class y_ extends Ki{constructor(e={}){super();const s={id:e.id||"vjs_track_"+qi(),kind:e.kind||"",language:e.language||""};let a=e.label||"";for(const h in s)Object.defineProperty(this,h,{get(){return s[h]},set(){}});Object.defineProperty(this,"label",{get(){return a},set(h){h!==a&&(a=h,this.trigger("labelchange"))}})}}const v_=function(r){return new URL(r,document.baseURI)},jh=function(r){return new URL(r,document.baseURI).href},lg=function(r){if(typeof r=="string"){const s=r.split("?")[0].replace(/\/+$/,"").match(/\.([^.\/]+)$/);return s?s[1].toLowerCase():""}return""},Hh=function(r,e=window.location){return v_(r).origin!==e.origin};var Lx=Object.freeze({__proto__:null,parseUrl:v_,getAbsoluteURL:jh,getFileExtension:lg,isCrossOrigin:Hh}),Md=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Nx(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function y(r,e){return e={exports:{}},r(e,e.exports),e.exports}var E;typeof window<"u"?E=window:typeof Md<"u"?E=Md:typeof self<"u"?E=self:E={};var U=E,q=y(function(r){function e(){return r.exports=e=Object.assign?Object.assign.bind():function(s){for(var a=1;a<arguments.length;a++){var h=arguments[a];for(var p in h)({}).hasOwnProperty.call(h,p)&&(s[p]=h[p])}return s},r.exports.__esModule=!0,r.exports.default=r.exports,e.apply(null,arguments)}r.exports=e,r.exports.__esModule=!0,r.exports.default=r.exports}),Z=Nx(q),Q=Pe,ae=Object.prototype.toString;function Pe(r){if(!r)return!1;var e=ae.call(r);return e==="[object Function]"||typeof r=="function"&&e!=="[object RegExp]"||typeof window<"u"&&(r===window.setTimeout||r===window.alert||r===window.confirm||r===window.prompt)}function Se(r,e){var s=typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(s)return(s=s.call(r)).next.bind(s);if(Array.isArray(r)||(s=je(r))||e){s&&(r=s);var a=0;return function(){return a>=r.length?{done:!0}:{done:!1,value:r[a++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function je(r,e){if(r){if(typeof r=="string")return at(r,e);var s=Object.prototype.toString.call(r).slice(8,-1);if(s==="Object"&&r.constructor&&(s=r.constructor.name),s==="Map"||s==="Set")return Array.from(r);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return at(r,e)}}function at(r,e){(e==null||e>r.length)&&(e=r.length);for(var s=0,a=new Array(e);s<e;s++)a[s]=r[s];return a}var _t=function(){function r(){this.typeToInterceptorsMap_=new Map,this.enabled_=!1}var e=r.prototype;return e.getIsEnabled=function(){return this.enabled_},e.enable=function(){this.enabled_=!0},e.disable=function(){this.enabled_=!1},e.reset=function(){this.typeToInterceptorsMap_=new Map,this.enabled_=!1},e.addInterceptor=function(a,h){this.typeToInterceptorsMap_.has(a)||this.typeToInterceptorsMap_.set(a,new Set);var p=this.typeToInterceptorsMap_.get(a);return p.has(h)?!1:(p.add(h),!0)},e.removeInterceptor=function(a,h){var p=this.typeToInterceptorsMap_.get(a);return p&&p.has(h)?(p.delete(h),!0):!1},e.clearInterceptorsByType=function(a){var h=this.typeToInterceptorsMap_.get(a);return h?(this.typeToInterceptorsMap_.delete(a),this.typeToInterceptorsMap_.set(a,new Set),!0):!1},e.clear=function(){return this.typeToInterceptorsMap_.size?(this.typeToInterceptorsMap_=new Map,!0):!1},e.getForType=function(a){return this.typeToInterceptorsMap_.get(a)||new Set},e.execute=function(a,h){for(var p=this.getForType(a),_=Se(p),w;!(w=_()).done;){var I=w.value;try{h=I(h)}catch{}}return h},r}(),Je=_t,At=function(){function r(){this.maxAttempts_=1,this.delayFactor_=.1,this.fuzzFactor_=.1,this.initialDelay_=1e3,this.enabled_=!1}var e=r.prototype;return e.getIsEnabled=function(){return this.enabled_},e.enable=function(){this.enabled_=!0},e.disable=function(){this.enabled_=!1},e.reset=function(){this.maxAttempts_=1,this.delayFactor_=.1,this.fuzzFactor_=.1,this.initialDelay_=1e3,this.enabled_=!1},e.getMaxAttempts=function(){return this.maxAttempts_},e.setMaxAttempts=function(a){this.maxAttempts_=a},e.getDelayFactor=function(){return this.delayFactor_},e.setDelayFactor=function(a){this.delayFactor_=a},e.getFuzzFactor=function(){return this.fuzzFactor_},e.setFuzzFactor=function(a){this.fuzzFactor_=a},e.getInitialDelay=function(){return this.initialDelay_},e.setInitialDelay=function(a){this.initialDelay_=a},e.createRetry=function(a){var h=a===void 0?{}:a,p=h.maxAttempts,_=h.delayFactor,w=h.fuzzFactor,I=h.initialDelay;return new Si({maxAttempts:p||this.maxAttempts_,delayFactor:_||this.delayFactor_,fuzzFactor:w||this.fuzzFactor_,initialDelay:I||this.initialDelay_})},r}(),Si=function(){function r(s){this.maxAttempts_=s.maxAttempts,this.delayFactor_=s.delayFactor,this.fuzzFactor_=s.fuzzFactor,this.currentDelay_=s.initialDelay,this.currentAttempt_=1}var e=r.prototype;return e.moveToNextAttempt=function(){this.currentAttempt_++;var a=this.currentDelay_*this.delayFactor_;this.currentDelay_=this.currentDelay_+a},e.shouldRetry=function(){return this.currentAttempt_<this.maxAttempts_},e.getCurrentDelay=function(){return this.currentDelay_},e.getCurrentMinPossibleDelay=function(){return(1-this.fuzzFactor_)*this.currentDelay_},e.getCurrentMaxPossibleDelay=function(){return(1+this.fuzzFactor_)*this.currentDelay_},e.getCurrentFuzzedDelay=function(){var a=this.getCurrentMinPossibleDelay(),h=this.getCurrentMaxPossibleDelay();return a+Math.random()*(h-a)},r}(),rs=At,Fi=function(e,s){return s===void 0&&(s=!1),function(a,h,p){if(a){e(a);return}if(h.statusCode>=400&&h.statusCode<=599){var _=p;if(s)if(U.TextDecoder){var w=Xn(h.headers&&h.headers["content-type"]);try{_=new TextDecoder(w).decode(p)}catch{}}else _=String.fromCharCode.apply(null,new Uint8Array(p));e({cause:_});return}e(null,p)}};function Xn(r){return r===void 0&&(r=""),r.toLowerCase().split(";").reduce(function(e,s){var a=s.split("="),h=a[0],p=a[1];return h.trim()==="charset"?p.trim():e},"utf-8")}var An=Fi;Hs.httpHandler=An,Hs.requestInterceptorsStorage=new Je,Hs.responseInterceptorsStorage=new Je,Hs.retryManager=new rs;/**
 * @license
 * slighly modified parse-headers 2.0.2 <https://github.com/kesla/parse-headers/>
 * Copyright (c) 2014 David BjÃ¶rklund
 * Available under the MIT license
 * <https://github.com/kesla/parse-headers/blob/master/LICENCE>
 */var co=function(e){var s={};return e&&e.trim().split(`
`).forEach(function(a){var h=a.indexOf(":"),p=a.slice(0,h).trim().toLowerCase(),_=a.slice(h+1).trim();typeof s[p]>"u"?s[p]=_:Array.isArray(s[p])?s[p].push(_):s[p]=[s[p],_]}),s},la=Hs,Yi=Hs;Hs.XMLHttpRequest=U.XMLHttpRequest||Fd,Hs.XDomainRequest="withCredentials"in new Hs.XMLHttpRequest?Hs.XMLHttpRequest:U.XDomainRequest,yu(["get","put","post","patch","head","delete"],function(r){Hs[r==="delete"?"del":r]=function(e,s,a){return s=Qs(e,s,a),s.method=r.toUpperCase(),Od(s)}});function yu(r,e){for(var s=0;s<r.length;s++)e(r[s])}function ls(r){for(var e in r)if(r.hasOwnProperty(e))return!1;return!0}function Qs(r,e,s){var a=r;return Q(e)?(s=e,typeof r=="string"&&(a={uri:r})):a=q({},e,{uri:r}),a.callback=s,a}function Hs(r,e,s){return e=Qs(r,e,s),Od(e)}function Od(r){if(typeof r.callback>"u")throw new Error("callback argument missing");if(r.requestType&&Hs.requestInterceptorsStorage.getIsEnabled()){var e={uri:r.uri||r.url,headers:r.headers||{},body:r.body,metadata:r.metadata||{},retry:r.retry,timeout:r.timeout},s=Hs.requestInterceptorsStorage.execute(r.requestType,e);r.uri=s.uri,r.headers=s.headers,r.body=s.body,r.metadata=s.metadata,r.retry=s.retry,r.timeout=s.timeout}var a=!1,h=function(lt,Et,yt){a||(a=!0,r.callback(lt,Et,yt))};function p(){B.readyState===4&&!Hs.responseInterceptorsStorage.getIsEnabled()&&setTimeout(I,0)}function _(){var it=void 0;if(B.response?it=B.response:it=B.responseText||fo(B),Be)try{it=JSON.parse(it)}catch{}return it}function w(it){if(clearTimeout(Ke),clearTimeout(r.retryTimeout),it instanceof Error||(it=new Error(""+(it||"Unknown XMLHttpRequest Error"))),it.statusCode=0,!se&&Hs.retryManager.getIsEnabled()&&r.retry&&r.retry.shouldRetry()){r.retryTimeout=setTimeout(function(){r.retry.moveToNextAttempt(),r.xhr=B,Od(r)},r.retry.getCurrentFuzzedDelay());return}if(r.requestType&&Hs.responseInterceptorsStorage.getIsEnabled()){var lt={headers:ze.headers||{},body:ze.body,responseUrl:B.responseURL,responseType:B.responseType},Et=Hs.responseInterceptorsStorage.execute(r.requestType,lt);ze.body=Et.body,ze.headers=Et.headers}return h(it,ze)}function I(){if(!se){var it;clearTimeout(Ke),clearTimeout(r.retryTimeout),r.useXDR&&B.status===void 0?it=200:it=B.status===1223?204:B.status;var lt=ze,Et=null;if(it!==0?(lt={body:_(),statusCode:it,method:Ee,headers:{},url:pe,rawRequest:B},B.getAllResponseHeaders&&(lt.headers=co(B.getAllResponseHeaders()))):Et=new Error("Internal XMLHttpRequest Error"),r.requestType&&Hs.responseInterceptorsStorage.getIsEnabled()){var yt={headers:lt.headers||{},body:lt.body,responseUrl:B.responseURL,responseType:B.responseType},Pt=Hs.responseInterceptorsStorage.execute(r.requestType,yt);lt.body=Pt.body,lt.headers=Pt.headers}return h(Et,lt,lt.body)}}var B=r.xhr||null;B||(r.cors||r.useXDR?B=new Hs.XDomainRequest:B=new Hs.XMLHttpRequest);var G,se,pe=B.url=r.uri||r.url,Ee=B.method=r.method||"GET",Ie=r.body||r.data,ce=B.headers=r.headers||{},Ve=!!r.sync,Be=!1,Ke,ze={body:void 0,headers:{},statusCode:0,method:Ee,url:pe,rawRequest:B};if("json"in r&&r.json!==!1&&(Be=!0,ce.accept||ce.Accept||(ce.Accept="application/json"),Ee!=="GET"&&Ee!=="HEAD"&&(ce["content-type"]||ce["Content-Type"]||(ce["Content-Type"]="application/json"),Ie=JSON.stringify(r.json===!0?Ie:r.json))),B.onreadystatechange=p,B.onload=I,B.onerror=w,B.onprogress=function(){},B.onabort=function(){se=!0,clearTimeout(r.retryTimeout)},B.ontimeout=w,B.open(Ee,pe,!Ve,r.username,r.password),Ve||(B.withCredentials=!!r.withCredentials),!Ve&&r.timeout>0&&(Ke=setTimeout(function(){if(!se){se=!0,B.abort("timeout");var it=new Error("XMLHttpRequest timeout");it.code="ETIMEDOUT",w(it)}},r.timeout)),B.setRequestHeader)for(G in ce)ce.hasOwnProperty(G)&&B.setRequestHeader(G,ce[G]);else if(r.headers&&!ls(r.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in r&&(B.responseType=r.responseType),"beforeSend"in r&&typeof r.beforeSend=="function"&&r.beforeSend(B),B.send(Ie||null),B}function fo(r){try{if(r.responseType==="document")return r.responseXML;var e=r.responseXML&&r.responseXML.documentElement.nodeName==="parsererror";if(r.responseType===""&&!e)return r.responseXML}catch{}return null}function Fd(){}la.default=Yi;const Ra=function(r,e){const s=new window.WebVTT.Parser(window,window.vttjs,window.WebVTT.StringDecoder()),a=[];s.oncue=function(h){e.addCue(h)},s.onparsingerror=function(h){a.push(h)},s.onflush=function(){e.trigger({type:"loadeddata",target:e})},s.parse(r),a.length>0&&(window.console&&window.console.groupCollapsed&&window.console.groupCollapsed(`Text Track parsing errors for ${e.src}`),a.forEach(h=>P.error(h)),window.console&&window.console.groupEnd&&window.console.groupEnd()),s.flush()},Fo=function(r,e){const s={uri:r},a=Hh(r);a&&(s.cors=a);const h=e.tech_.crossOrigin()==="use-credentials";h&&(s.withCredentials=h),la(s,Ae(this,function(p,_,w){if(p)return P.error(p,_);e.loaded_=!0,typeof window.WebVTT!="function"?e.tech_&&e.tech_.any(["vttjsloaded","vttjserror"],I=>{if(I.type==="vttjserror"){P.error(`vttjs failed to load, stopping trying to process ${e.src}`);return}return Ra(w,e)}):Ra(w,e)}))};class ua extends y_{constructor(e={}){if(!e.tech)throw new Error("A tech was not provided.");const s=ee(e,{kind:b_[e.kind]||"subtitles",language:e.language||e.srclang||""});let a=yT[s.mode]||"disabled";const h=s.default;(s.kind==="metadata"||s.kind==="chapters")&&(a="hidden"),super(s),this.tech_=s.tech,this.cues_=[],this.activeCues_=[],this.preload_=this.tech_.preloadTextTracks!==!1;const p=new Uh(this.cues_),_=new Uh(this.activeCues_);let w=!1;this.timeupdateHandler=Ae(this,function(B={}){if(!this.tech_.isDisposed()){if(!this.tech_.isReady_){B.type!=="timeupdate"&&(this.rvf_=this.tech_.requestVideoFrameCallback(this.timeupdateHandler));return}this.activeCues=this.activeCues,w&&(this.trigger("cuechange"),w=!1),B.type!=="timeupdate"&&(this.rvf_=this.tech_.requestVideoFrameCallback(this.timeupdateHandler))}});const I=()=>{this.stopTracking()};this.tech_.one("dispose",I),a!=="disabled"&&this.startTracking(),Object.defineProperties(this,{default:{get(){return h},set(){}},mode:{get(){return a},set(B){yT[B]&&a!==B&&(a=B,!this.preload_&&a!=="disabled"&&this.cues.length===0&&Fo(this.src,this),this.stopTracking(),a!=="disabled"&&this.startTracking(),this.trigger("modechange"))}},cues:{get(){return this.loaded_?p:null},set(){}},activeCues:{get(){if(!this.loaded_)return null;if(this.cues.length===0)return _;const B=this.tech_.currentTime(),G=[];for(let se=0,pe=this.cues.length;se<pe;se++){const Ee=this.cues[se];Ee.startTime<=B&&Ee.endTime>=B&&G.push(Ee)}if(w=!1,G.length!==this.activeCues_.length)w=!0;else for(let se=0;se<G.length;se++)this.activeCues_.indexOf(G[se])===-1&&(w=!0);return this.activeCues_=G,_.setCues_(this.activeCues_),_},set(){}}}),s.src?(this.src=s.src,this.preload_||(this.loaded_=!0),(this.preload_||s.kind!=="subtitles"&&s.kind!=="captions")&&Fo(this.src,this)):this.loaded_=!0}startTracking(){this.rvf_=this.tech_.requestVideoFrameCallback(this.timeupdateHandler),this.tech_.on("timeupdate",this.timeupdateHandler)}stopTracking(){this.rvf_&&(this.tech_.cancelVideoFrameCallback(this.rvf_),this.rvf_=void 0),this.tech_.off("timeupdate",this.timeupdateHandler)}addCue(e){let s=e;if(!("getCueAsHTML"in s)){s=new window.vttjs.VTTCue(e.startTime,e.endTime,e.text);for(const h in e)h in s||(s[h]=e[h]);s.id=e.id,s.originalCue_=e}const a=this.tech_.textTracks();for(let h=0;h<a.length;h++)a[h]!==this&&a[h].removeCue(s);this.cues_.push(s),this.cues.setCues_(this.cues_)}toJSON(){return f_.trackToJson(this)}removeCue(e){let s=this.cues_.length;for(;s--;){const a=this.cues_[s];if(a===e||a.originalCue_&&a.originalCue_===e){this.cues_.splice(s,1),this.cues.setCues_(this.cues_);break}}}}ua.prototype.allowedEvents_={cuechange:"cuechange"};class qr extends y_{constructor(e={}){const s=ee(e,{kind:bT[e.kind]||""});super(s);let a=!1;Object.defineProperty(this,"enabled",{get(){return a},set(h){typeof h!="boolean"||h===a||(a=h,this.trigger("enabledchange"))}}),s.enabled&&(this.enabled=s.enabled),this.loaded_=!0}}class ug extends y_{constructor(e={}){const s=ee(e,{kind:_T[e.kind]||""});super(s);let a=!1;Object.defineProperty(this,"selected",{get(){return a},set(h){typeof h!="boolean"||h===a||(a=h,this.trigger("selectedchange"))}}),s.selected&&(this.selected=s.selected)}}class Kn extends Ki{constructor(e={}){super();let s;const a=new ua(e);this.kind=a.kind,this.src=a.src,this.srclang=a.language,this.label=a.label,this.default=a.default,Object.defineProperties(this,{readyState:{get(){return s}},track:{get(){return a}}}),s=Kn.NONE,a.addEventListener("loadeddata",()=>{s=Kn.LOADED,this.trigger({type:"load",target:this})})}}Kn.prototype.allowedEvents_={load:"load"},Kn.NONE=0,Kn.LOADING=1,Kn.LOADED=2,Kn.ERROR=3;const vn={audio:{ListClass:gT,TrackClass:qr,capitalName:"Audio"},video:{ListClass:__,TrackClass:ug,capitalName:"Video"},text:{ListClass:Rd,TrackClass:ua,capitalName:"Text"}};Object.keys(vn).forEach(function(r){vn[r].getterName=`${r}Tracks`,vn[r].privateName=`${r}Tracks_`});const Vh={remoteText:{ListClass:Rd,TrackClass:ua,capitalName:"RemoteText",getterName:"remoteTextTracks",privateName:"remoteTextTracks_"},remoteTextEl:{ListClass:mT,TrackClass:Kn,capitalName:"RemoteTextTrackEls",getterName:"remoteTextTrackEls",privateName:"remoteTextTrackEls_"}},wr=Object.assign({},vn,Vh);Vh.names=Object.keys(Vh),vn.names=Object.keys(vn),wr.names=[].concat(Vh.names).concat(vn.names);var Rx={},ms=typeof Md<"u"?Md:typeof window<"u"?window:{},Tl;typeof document<"u"?Tl=document:(Tl=ms["__GLOBAL_DOCUMENT_CACHE@4"],Tl||(Tl=ms["__GLOBAL_DOCUMENT_CACHE@4"]=Rx));var ha=Tl,El=Object.create||function(){function r(){}return function(e){if(arguments.length!==1)throw new Error("Object.create shim only accepts one parameter.");return r.prototype=e,new r}}();function Gr(r,e){this.name="ParsingError",this.code=r.code,this.message=e||r.message}Gr.prototype=El(Error.prototype),Gr.prototype.constructor=Gr,Gr.Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}};function w_(r){function e(a,h,p,_){return(a|0)*3600+(h|0)*60+(p|0)+(_|0)/1e3}var s=r.match(/^(\d+):(\d{1,2})(:\d{1,2})?\.(\d{3})/);return s?s[3]?e(s[1],s[2],s[3].replace(":",""),s[4]):s[1]>59?e(s[1],s[2],0,s[4]):e(0,s[1],s[2],s[4]):null}function $h(){this.values=El(null)}$h.prototype={set:function(r,e){!this.get(r)&&e!==""&&(this.values[r]=e)},get:function(r,e,s){return s?this.has(r)?this.values[r]:e[s]:this.has(r)?this.values[r]:e},has:function(r){return r in this.values},alt:function(r,e,s){for(var a=0;a<s.length;++a)if(e===s[a]){this.set(r,e);break}},integer:function(r,e){/^-?\d+$/.test(e)&&this.set(r,parseInt(e,10))},percent:function(r,e){return e.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&(e=parseFloat(e),e>=0&&e<=100)?(this.set(r,e),!0):!1}};function Ma(r,e,s,a){var h=a?r.split(a):[r];for(var p in h)if(typeof h[p]=="string"){var _=h[p].split(s);if(_.length===2){var w=_[0].trim(),I=_[1].trim();e(w,I)}}}function T_(r,e,s){var a=r;function h(){var w=w_(r);if(w===null)throw new Gr(Gr.Errors.BadTimeStamp,"Malformed timestamp: "+a);return r=r.replace(/^[^\sa-zA-Z-]+/,""),w}function p(w,I){var B=new $h;Ma(w,function(G,se){switch(G){case"region":for(var pe=s.length-1;pe>=0;pe--)if(s[pe].id===se){B.set(G,s[pe].region);break}break;case"vertical":B.alt(G,se,["rl","lr"]);break;case"line":var Ee=se.split(","),Ie=Ee[0];B.integer(G,Ie),B.percent(G,Ie)&&B.set("snapToLines",!1),B.alt(G,Ie,["auto"]),Ee.length===2&&B.alt("lineAlign",Ee[1],["start","center","end"]);break;case"position":Ee=se.split(","),B.percent(G,Ee[0]),Ee.length===2&&B.alt("positionAlign",Ee[1],["start","center","end"]);break;case"size":B.percent(G,se);break;case"align":B.alt(G,se,["start","center","end","left","right"]);break}},/:/,/\s/),I.region=B.get("region",null),I.vertical=B.get("vertical","");try{I.line=B.get("line","auto")}catch{}I.lineAlign=B.get("lineAlign","start"),I.snapToLines=B.get("snapToLines",!0),I.size=B.get("size",100);try{I.align=B.get("align","center")}catch{I.align=B.get("align","middle")}try{I.position=B.get("position","auto")}catch{I.position=B.get("position",{start:0,left:0,center:50,middle:50,end:100,right:100},I.align)}I.positionAlign=B.get("positionAlign",{start:"start",left:"start",center:"center",middle:"center",end:"end",right:"end"},I.align)}function _(){r=r.replace(/^\s+/,"")}if(_(),e.startTime=h(),_(),r.substr(0,3)!=="-->")throw new Gr(Gr.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '-->'): "+a);r=r.substr(3),_(),e.endTime=h(),_(),p(r,e)}var po=ha.createElement&&ha.createElement("textarea"),vT={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"},zh={white:"rgba(255,255,255,1)",lime:"rgba(0,255,0,1)",cyan:"rgba(0,255,255,1)",red:"rgba(255,0,0,1)",yellow:"rgba(255,255,0,1)",magenta:"rgba(255,0,255,1)",blue:"rgba(0,0,255,1)",black:"rgba(0,0,0,1)"},hg={v:"title",lang:"lang"},Bd={rt:"ruby"};function cg(r,e){function s(){if(!e)return null;function Ie(Ve){return e=e.substr(Ve.length),Ve}var ce=e.match(/^([^<]*)(<[^>]*>?)?/);return Ie(ce[1]?ce[1]:ce[2])}function a(Ie){return po.innerHTML=Ie,Ie=po.textContent,po.textContent="",Ie}function h(Ie,ce){return!Bd[ce.localName]||Bd[ce.localName]===Ie.localName}function p(Ie,ce){var Ve=vT[Ie];if(!Ve)return null;var Be=r.document.createElement(Ve),Ke=hg[Ie];return Ke&&ce&&(Be[Ke]=ce.trim()),Be}for(var _=r.document.createElement("div"),w=_,I,B=[];(I=s())!==null;){if(I[0]==="<"){if(I[1]==="/"){B.length&&B[B.length-1]===I.substr(2).replace(">","")&&(B.pop(),w=w.parentNode);continue}var G=w_(I.substr(1,I.length-2)),se;if(G){se=r.document.createProcessingInstruction("timestamp",G),w.appendChild(se);continue}var pe=I.match(/^<([^.\s/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/);if(!pe||(se=p(pe[1],pe[3]),!se)||!h(w,se))continue;if(pe[2]){var Ee=pe[2].split(".");Ee.forEach(function(Ie){var ce=/^bg_/.test(Ie),Ve=ce?Ie.slice(3):Ie;if(zh.hasOwnProperty(Ve)){var Be=ce?"background-color":"color",Ke=zh[Ve];se.style[Be]=Ke}}),se.className=Ee.join(" ")}B.push(pe[1]),w.appendChild(se),w=se;continue}w.appendChild(r.document.createTextNode(a(I)))}return _}var wT=[[1470,1470],[1472,1472],[1475,1475],[1478,1478],[1488,1514],[1520,1524],[1544,1544],[1547,1547],[1549,1549],[1563,1563],[1566,1610],[1645,1647],[1649,1749],[1765,1766],[1774,1775],[1786,1805],[1807,1808],[1810,1839],[1869,1957],[1969,1969],[1984,2026],[2036,2037],[2042,2042],[2048,2069],[2074,2074],[2084,2084],[2088,2088],[2096,2110],[2112,2136],[2142,2142],[2208,2208],[2210,2220],[8207,8207],[64285,64285],[64287,64296],[64298,64310],[64312,64316],[64318,64318],[64320,64321],[64323,64324],[64326,64449],[64467,64829],[64848,64911],[64914,64967],[65008,65020],[65136,65140],[65142,65276],[67584,67589],[67592,67592],[67594,67637],[67639,67640],[67644,67644],[67647,67669],[67671,67679],[67840,67867],[67872,67897],[67903,67903],[67968,68023],[68030,68031],[68096,68096],[68112,68115],[68117,68119],[68121,68147],[68160,68167],[68176,68184],[68192,68223],[68352,68405],[68416,68437],[68440,68466],[68472,68479],[68608,68680],[126464,126467],[126469,126495],[126497,126498],[126500,126500],[126503,126503],[126505,126514],[126516,126519],[126521,126521],[126523,126523],[126530,126530],[126535,126535],[126537,126537],[126539,126539],[126541,126543],[126545,126546],[126548,126548],[126551,126551],[126553,126553],[126555,126555],[126557,126557],[126559,126559],[126561,126562],[126564,126564],[126567,126570],[126572,126578],[126580,126583],[126585,126588],[126590,126590],[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[1114109,1114109]];function dg(r){for(var e=0;e<wT.length;e++){var s=wT[e];if(r>=s[0]&&r<=s[1])return!0}return!1}function E_(r){var e=[],s="",a;if(!r||!r.childNodes)return"ltr";function h(w,I){for(var B=I.childNodes.length-1;B>=0;B--)w.push(I.childNodes[B])}function p(w){if(!w||!w.length)return null;var I=w.pop(),B=I.textContent||I.innerText;if(B){var G=B.match(/^.*(\n|\r)/);return G?(w.length=0,G[0]):B}if(I.tagName==="ruby")return p(w);if(I.childNodes)return h(w,I),p(w)}for(h(e,r);s=p(e);)for(var _=0;_<s.length;_++)if(a=s.charCodeAt(_),dg(a))return"rtl";return"ltr"}function S_(r){if(typeof r.line=="number"&&(r.snapToLines||r.line>=0&&r.line<=100))return r.line;if(!r.track||!r.track.textTrackList||!r.track.textTrackList.mediaElement)return-1;for(var e=r.track,s=e.textTrackList,a=0,h=0;h<s.length&&s[h]!==e;h++)s[h].mode==="showing"&&a++;return++a*-1}function fg(){}fg.prototype.applyStyles=function(r,e){e=e||this.div;for(var s in r)r.hasOwnProperty(s)&&(e.style[s]=r[s])},fg.prototype.formatStyle=function(r,e){return r===0?0:r+e};function Wh(r,e,s){fg.call(this),this.cue=e,this.cueDiv=cg(r,e.text);var a={color:"rgba(255, 255, 255, 1)",backgroundColor:"rgba(0, 0, 0, 0.8)",position:"relative",left:0,right:0,top:0,bottom:0,display:"inline",writingMode:e.vertical===""?"horizontal-tb":e.vertical==="lr"?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext"};this.applyStyles(a,this.cueDiv),this.div=r.document.createElement("div"),a={direction:E_(this.cueDiv),writingMode:e.vertical===""?"horizontal-tb":e.vertical==="lr"?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext",textAlign:e.align==="middle"?"center":e.align,font:s.font,whiteSpace:"pre-line",position:"absolute"},this.applyStyles(a),this.div.appendChild(this.cueDiv);var h=0;switch(e.positionAlign){case"start":case"line-left":h=e.position;break;case"center":h=e.position-e.size/2;break;case"end":case"line-right":h=e.position-e.size;break}e.vertical===""?this.applyStyles({left:this.formatStyle(h,"%"),width:this.formatStyle(e.size,"%")}):this.applyStyles({top:this.formatStyle(h,"%"),height:this.formatStyle(e.size,"%")}),this.move=function(p){this.applyStyles({top:this.formatStyle(p.top,"px"),bottom:this.formatStyle(p.bottom,"px"),left:this.formatStyle(p.left,"px"),right:this.formatStyle(p.right,"px"),height:this.formatStyle(p.height,"px"),width:this.formatStyle(p.width,"px")})}}Wh.prototype=El(fg.prototype),Wh.prototype.constructor=Wh;function rr(r){var e,s,a,h;if(r.div){s=r.div.offsetHeight,a=r.div.offsetWidth,h=r.div.offsetTop;var p=(p=r.div.childNodes)&&(p=p[0])&&p.getClientRects&&p.getClientRects();r=r.div.getBoundingClientRect(),e=p?Math.max(p[0]&&p[0].height||0,r.height/p.length):0}this.left=r.left,this.right=r.right,this.top=r.top||h,this.height=r.height||s,this.bottom=r.bottom||h+(r.height||s),this.width=r.width||a,this.lineHeight=e!==void 0?e:r.lineHeight}rr.prototype.move=function(r,e){switch(e=e!==void 0?e:this.lineHeight,r){case"+x":this.left+=e,this.right+=e;break;case"-x":this.left-=e,this.right-=e;break;case"+y":this.top+=e,this.bottom+=e;break;case"-y":this.top-=e,this.bottom-=e;break}},rr.prototype.overlaps=function(r){return this.left<r.right&&this.right>r.left&&this.top<r.bottom&&this.bottom>r.top},rr.prototype.overlapsAny=function(r){for(var e=0;e<r.length;e++)if(this.overlaps(r[e]))return!0;return!1},rr.prototype.within=function(r){return this.top>=r.top&&this.bottom<=r.bottom&&this.left>=r.left&&this.right<=r.right},rr.prototype.overlapsOppositeAxis=function(r,e){switch(e){case"+x":return this.left<r.left;case"-x":return this.right>r.right;case"+y":return this.top<r.top;case"-y":return this.bottom>r.bottom}},rr.prototype.intersectPercentage=function(r){var e=Math.max(0,Math.min(this.right,r.right)-Math.max(this.left,r.left)),s=Math.max(0,Math.min(this.bottom,r.bottom)-Math.max(this.top,r.top)),a=e*s;return a/(this.height*this.width)},rr.prototype.toCSSCompatValues=function(r){return{top:this.top-r.top,bottom:r.bottom-this.bottom,left:this.left-r.left,right:r.right-this.right,height:this.height,width:this.width}},rr.getSimpleBoxPosition=function(r){var e=r.div?r.div.offsetHeight:r.tagName?r.offsetHeight:0,s=r.div?r.div.offsetWidth:r.tagName?r.offsetWidth:0,a=r.div?r.div.offsetTop:r.tagName?r.offsetTop:0;r=r.div?r.div.getBoundingClientRect():r.tagName?r.getBoundingClientRect():r;var h={left:r.left,right:r.right,top:r.top||a,height:r.height||e,bottom:r.bottom||a+(r.height||e),width:r.width||s};return h};function be(r,e,s,a){function h(Ve,Be){for(var Ke,ze=new rr(Ve),it=1,lt=0;lt<Be.length;lt++){for(;Ve.overlapsOppositeAxis(s,Be[lt])||Ve.within(s)&&Ve.overlapsAny(a);)Ve.move(Be[lt]);if(Ve.within(s))return Ve;var Et=Ve.intersectPercentage(s);it>Et&&(Ke=new rr(Ve),it=Et),Ve=new rr(ze)}return Ke||ze}var p=new rr(e),_=e.cue,w=S_(_),I=[];if(_.snapToLines){var B;switch(_.vertical){case"":I=["+y","-y"],B="height";break;case"rl":I=["+x","-x"],B="width";break;case"lr":I=["-x","+x"],B="width";break}var G=p.lineHeight,se=G*Math.round(w),pe=s[B]+G,Ee=I[0];Math.abs(se)>pe&&(se=se<0?-1:1,se*=Math.ceil(pe/G)*G),w<0&&(se+=_.vertical===""?s.height:s.width,I=I.reverse()),p.move(Ee,se)}else{var Ie=p.lineHeight/s.height*100;switch(_.lineAlign){case"center":w-=Ie/2;break;case"end":w-=Ie;break}switch(_.vertical){case"":e.applyStyles({top:e.formatStyle(w,"%")});break;case"rl":e.applyStyles({left:e.formatStyle(w,"%")});break;case"lr":e.applyStyles({right:e.formatStyle(w,"%")});break}I=["+y","-x","+x","-y"],p=new rr(e)}var ce=h(p,I);e.move(ce.toCSSCompatValues(s))}function Re(){}Re.StringDecoder=function(){return{decode:function(r){if(!r)return"";if(typeof r!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(r))}}},Re.convertCueToDOMTree=function(r,e){return!r||!e?null:cg(r,e)};var Qe=.05,st="sans-serif",gt="1.5%";Re.processCues=function(r,e,s){if(!r||!e||!s)return null;for(;s.firstChild;)s.removeChild(s.firstChild);var a=r.document.createElement("div");a.style.position="absolute",a.style.left="0",a.style.right="0",a.style.top="0",a.style.bottom="0",a.style.margin=gt,s.appendChild(a);function h(G){for(var se=0;se<G.length;se++)if(G[se].hasBeenReset||!G[se].displayState)return!0;return!1}if(!h(e)){for(var p=0;p<e.length;p++)a.appendChild(e[p].displayState);return}var _=[],w=rr.getSimpleBoxPosition(a),I=Math.round(w.height*Qe*100)/100,B={font:I+"px "+st};(function(){for(var G,se,pe=0;pe<e.length;pe++)se=e[pe],G=new Wh(r,se,B),a.appendChild(G.div),be(r,G,w,_),se.displayState=G.div,_.push(rr.getSimpleBoxPosition(G))})()},Re.Parser=function(r,e,s){s||(s=e,e={}),e||(e={}),this.window=r,this.vttjs=e,this.state="INITIAL",this.buffer="",this.decoder=s||new TextDecoder("utf8"),this.regionList=[]},Re.Parser.prototype={reportOrThrowError:function(r){if(r instanceof Gr)this.onparsingerror&&this.onparsingerror(r);else throw r},parse:function(r){var e=this;r&&(e.buffer+=e.decoder.decode(r,{stream:!0}));function s(){for(var G=e.buffer,se=0;se<G.length&&G[se]!=="\r"&&G[se]!==`
`;)++se;var pe=G.substr(0,se);return G[se]==="\r"&&++se,G[se]===`
`&&++se,e.buffer=G.substr(se),pe}function a(G){var se=new $h;if(Ma(G,function(Ee,Ie){switch(Ee){case"id":se.set(Ee,Ie);break;case"width":se.percent(Ee,Ie);break;case"lines":se.integer(Ee,Ie);break;case"regionanchor":case"viewportanchor":var ce=Ie.split(",");if(ce.length!==2)break;var Ve=new $h;if(Ve.percent("x",ce[0]),Ve.percent("y",ce[1]),!Ve.has("x")||!Ve.has("y"))break;se.set(Ee+"X",Ve.get("x")),se.set(Ee+"Y",Ve.get("y"));break;case"scroll":se.alt(Ee,Ie,["up"]);break}},/=/,/\s/),se.has("id")){var pe=new(e.vttjs.VTTRegion||e.window.VTTRegion);pe.width=se.get("width",100),pe.lines=se.get("lines",3),pe.regionAnchorX=se.get("regionanchorX",0),pe.regionAnchorY=se.get("regionanchorY",100),pe.viewportAnchorX=se.get("viewportanchorX",0),pe.viewportAnchorY=se.get("viewportanchorY",100),pe.scroll=se.get("scroll",""),e.onregion&&e.onregion(pe),e.regionList.push({id:se.get("id"),region:pe})}}function h(G){var se=new $h;Ma(G,function(pe,Ee){switch(pe){case"MPEGT":se.integer(pe+"S",Ee);break;case"LOCA":se.set(pe+"L",w_(Ee));break}},/[^\d]:/,/,/),e.ontimestampmap&&e.ontimestampmap({MPEGTS:se.get("MPEGTS"),LOCAL:se.get("LOCAL")})}function p(G){G.match(/X-TIMESTAMP-MAP/)?Ma(G,function(se,pe){switch(se){case"X-TIMESTAMP-MAP":h(pe);break}},/=/):Ma(G,function(se,pe){switch(se){case"Region":a(pe);break}},/:/)}try{var _;if(e.state==="INITIAL"){if(!/\r\n|\n/.test(e.buffer))return this;_=s();var w=_.match(/^WEBVTT([ \t].*)?$/);if(!w||!w[0])throw new Gr(Gr.Errors.BadSignature);e.state="HEADER"}for(var I=!1;e.buffer;){if(!/\r\n|\n/.test(e.buffer))return this;switch(I?I=!1:_=s(),e.state){case"HEADER":/:/.test(_)?p(_):_||(e.state="ID");continue;case"NOTE":_||(e.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(_)){e.state="NOTE";break}if(!_)continue;e.cue=new(e.vttjs.VTTCue||e.window.VTTCue)(0,0,"");try{e.cue.align="center"}catch{e.cue.align="middle"}if(e.state="CUE",_.indexOf("-->")===-1){e.cue.id=_;continue}case"CUE":try{T_(_,e.cue,e.regionList)}catch(G){e.reportOrThrowError(G),e.cue=null,e.state="BADCUE";continue}e.state="CUETEXT";continue;case"CUETEXT":var B=_.indexOf("-->")!==-1;if(!_||B&&(I=!0)){e.oncue&&e.oncue(e.cue),e.cue=null,e.state="ID";continue}e.cue.text&&(e.cue.text+=`
`),e.cue.text+=_.replace(/\u2028/g,`
`).replace(/u2029/g,`
`);continue;case"BADCUE":_||(e.state="ID");continue}}}catch(G){e.reportOrThrowError(G),e.state==="CUETEXT"&&e.cue&&e.oncue&&e.oncue(e.cue),e.cue=null,e.state=e.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this},flush:function(){var r=this;try{if(r.buffer+=r.decoder.decode(),(r.cue||r.state==="HEADER")&&(r.buffer+=`

`,r.parse()),r.state==="INITIAL")throw new Gr(Gr.Errors.BadSignature)}catch(e){r.reportOrThrowError(e)}return r.onflush&&r.onflush(),this}};var Lt=Re,zt="auto",ei={"":1,lr:1,rl:1},Wt={start:1,center:1,end:1,left:1,right:1,auto:1,"line-left":1,"line-right":1};function Gi(r){if(typeof r!="string")return!1;var e=ei[r.toLowerCase()];return e?r.toLowerCase():!1}function yi(r){if(typeof r!="string")return!1;var e=Wt[r.toLowerCase()];return e?r.toLowerCase():!1}function xi(r,e,s){this.hasBeenReset=!1;var a="",h=!1,p=r,_=e,w=s,I=null,B="",G=!0,se="auto",pe="start",Ee="auto",Ie="auto",ce=100,Ve="center";Object.defineProperties(this,{id:{enumerable:!0,get:function(){return a},set:function(Be){a=""+Be}},pauseOnExit:{enumerable:!0,get:function(){return h},set:function(Be){h=!!Be}},startTime:{enumerable:!0,get:function(){return p},set:function(Be){if(typeof Be!="number")throw new TypeError("Start time must be set to a number.");p=Be,this.hasBeenReset=!0}},endTime:{enumerable:!0,get:function(){return _},set:function(Be){if(typeof Be!="number")throw new TypeError("End time must be set to a number.");_=Be,this.hasBeenReset=!0}},text:{enumerable:!0,get:function(){return w},set:function(Be){w=""+Be,this.hasBeenReset=!0}},region:{enumerable:!0,get:function(){return I},set:function(Be){I=Be,this.hasBeenReset=!0}},vertical:{enumerable:!0,get:function(){return B},set:function(Be){var Ke=Gi(Be);if(Ke===!1)throw new SyntaxError("Vertical: an invalid or illegal direction string was specified.");B=Ke,this.hasBeenReset=!0}},snapToLines:{enumerable:!0,get:function(){return G},set:function(Be){G=!!Be,this.hasBeenReset=!0}},line:{enumerable:!0,get:function(){return se},set:function(Be){if(typeof Be!="number"&&Be!==zt)throw new SyntaxError("Line: an invalid number or illegal string was specified.");se=Be,this.hasBeenReset=!0}},lineAlign:{enumerable:!0,get:function(){return pe},set:function(Be){var Ke=yi(Be);Ke?(pe=Ke,this.hasBeenReset=!0):console.warn("lineAlign: an invalid or illegal string was specified.")}},position:{enumerable:!0,get:function(){return Ee},set:function(Be){if(Be<0||Be>100)throw new Error("Position must be between 0 and 100.");Ee=Be,this.hasBeenReset=!0}},positionAlign:{enumerable:!0,get:function(){return Ie},set:function(Be){var Ke=yi(Be);Ke?(Ie=Ke,this.hasBeenReset=!0):console.warn("positionAlign: an invalid or illegal string was specified.")}},size:{enumerable:!0,get:function(){return ce},set:function(Be){if(Be<0||Be>100)throw new Error("Size must be between 0 and 100.");ce=Be,this.hasBeenReset=!0}},align:{enumerable:!0,get:function(){return Ve},set:function(Be){var Ke=yi(Be);if(!Ke)throw new SyntaxError("align: an invalid or illegal alignment string was specified.");Ve=Ke,this.hasBeenReset=!0}}}),this.displayState=void 0}xi.prototype.getCueAsHTML=function(){return WebVTT.convertCueToDOMTree(window,this.text)};var Xi=xi,fi={"":!0,up:!0};function Ns(r){if(typeof r!="string")return!1;var e=fi[r.toLowerCase()];return e?r.toLowerCase():!1}function Fn(r){return typeof r=="number"&&r>=0&&r<=100}function ar(){var r=100,e=3,s=0,a=100,h=0,p=100,_="";Object.defineProperties(this,{width:{enumerable:!0,get:function(){return r},set:function(w){if(!Fn(w))throw new Error("Width must be between 0 and 100.");r=w}},lines:{enumerable:!0,get:function(){return e},set:function(w){if(typeof w!="number")throw new TypeError("Lines must be set to a number.");e=w}},regionAnchorY:{enumerable:!0,get:function(){return a},set:function(w){if(!Fn(w))throw new Error("RegionAnchorX must be between 0 and 100.");a=w}},regionAnchorX:{enumerable:!0,get:function(){return s},set:function(w){if(!Fn(w))throw new Error("RegionAnchorY must be between 0 and 100.");s=w}},viewportAnchorY:{enumerable:!0,get:function(){return p},set:function(w){if(!Fn(w))throw new Error("ViewportAnchorY must be between 0 and 100.");p=w}},viewportAnchorX:{enumerable:!0,get:function(){return h},set:function(w){if(!Fn(w))throw new Error("ViewportAnchorX must be between 0 and 100.");h=w}},scroll:{enumerable:!0,get:function(){return _},set:function(w){var I=Ns(w);I===!1?console.warn("Scroll: an invalid or illegal string was specified."):_=I}}})}var ca=ar,Lr=y(function(r){var e=r.exports={WebVTT:Lt,VTTCue:Xi,VTTRegion:ca};U.vttjs=e,U.WebVTT=e.WebVTT;var s=e.VTTCue,a=e.VTTRegion,h=U.VTTCue,p=U.VTTRegion;e.shim=function(){U.VTTCue=s,U.VTTRegion=a},e.restore=function(){U.VTTCue=h,U.VTTRegion=p},U.VTTCue||e.shim()});Lr.WebVTT,Lr.VTTCue,Lr.VTTRegion;function qh(r,e,s,a,h={}){const p=r.textTracks();h.kind=e,s&&(h.label=s),a&&(h.language=a),h.tech=r;const _=new wr.text.TrackClass(h);return p.addTrack(_),_}class si extends Le{constructor(e={},s=function(){}){e.reportTouchActivity=!1,super(null,e,s),this.onDurationChange_=a=>this.onDurationChange(a),this.trackProgress_=a=>this.trackProgress(a),this.trackCurrentTime_=a=>this.trackCurrentTime(a),this.stopTrackingCurrentTime_=a=>this.stopTrackingCurrentTime(a),this.disposeSourceHandler_=a=>this.disposeSourceHandler(a),this.queuedHanders_=new Set,this.hasStarted_=!1,this.on("playing",function(){this.hasStarted_=!0}),this.on("loadstart",function(){this.hasStarted_=!1}),wr.names.forEach(a=>{const h=wr[a];e&&e[h.getterName]&&(this[h.privateName]=e[h.getterName])}),this.featuresProgressEvents||this.manualProgressOn(),this.featuresTimeupdateEvents||this.manualTimeUpdatesOn(),["Text","Audio","Video"].forEach(a=>{e[`native${a}Tracks`]===!1&&(this[`featuresNative${a}Tracks`]=!1)}),e.nativeCaptions===!1||e.nativeTextTracks===!1?this.featuresNativeTextTracks=!1:(e.nativeCaptions===!0||e.nativeTextTracks===!0)&&(this.featuresNativeTextTracks=!0),this.featuresNativeTextTracks||this.emulateTextTracks(),this.preloadTextTracks=e.preloadTextTracks!==!1,this.autoRemoteTextTracks_=new wr.text.ListClass,this.initTrackListeners(),e.nativeControlsForTouch||this.emitTapEvents(),this.constructor&&(this.name_=this.constructor.name||"Unknown Tech")}triggerSourceset(e){this.isReady_||this.one("ready",()=>this.setTimeout(()=>this.triggerSourceset(e),1)),this.trigger({src:e,type:"sourceset"})}manualProgressOn(){this.on("durationchange",this.onDurationChange_),this.manualProgress=!0,this.one("ready",this.trackProgress_)}manualProgressOff(){this.manualProgress=!1,this.stopTrackingProgress(),this.off("durationchange",this.onDurationChange_)}trackProgress(e){this.stopTrackingProgress(),this.progressInterval=this.setInterval(Ae(this,function(){const s=this.bufferedPercent();this.bufferedPercent_!==s&&this.trigger("progress"),this.bufferedPercent_=s,s===1&&this.stopTrackingProgress()}),500)}onDurationChange(e){this.duration_=this.duration()}buffered(){return ns(0,0)}bufferedPercent(){return nr(this.buffered(),this.duration_)}stopTrackingProgress(){this.clearInterval(this.progressInterval)}manualTimeUpdatesOn(){this.manualTimeUpdates=!0,this.on("play",this.trackCurrentTime_),this.on("pause",this.stopTrackingCurrentTime_)}manualTimeUpdatesOff(){this.manualTimeUpdates=!1,this.stopTrackingCurrentTime(),this.off("play",this.trackCurrentTime_),this.off("pause",this.stopTrackingCurrentTime_)}trackCurrentTime(){this.currentTimeInterval&&this.stopTrackingCurrentTime(),this.currentTimeInterval=this.setInterval(function(){this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},250)}stopTrackingCurrentTime(){this.clearInterval(this.currentTimeInterval),this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})}dispose(){this.clearTracks(vn.names),this.manualProgress&&this.manualProgressOff(),this.manualTimeUpdates&&this.manualTimeUpdatesOff(),super.dispose()}clearTracks(e){e=[].concat(e),e.forEach(s=>{const a=this[`${s}Tracks`]()||[];let h=a.length;for(;h--;){const p=a[h];s==="text"&&this.removeRemoteTextTrack(p),a.removeTrack(p)}})}cleanupAutoTextTracks(){const e=this.autoRemoteTextTracks_||[];let s=e.length;for(;s--;){const a=e[s];this.removeRemoteTextTrack(a)}}reset(){}crossOrigin(){}setCrossOrigin(){}error(e){return e!==void 0&&(this.error_=new bs(e),this.trigger("error")),this.error_}played(){return this.hasStarted_?ns(0,0):ns()}play(){}setScrubbing(e){}scrubbing(){}setCurrentTime(e){this.manualTimeUpdates&&this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})}initTrackListeners(){vn.names.forEach(e=>{const s=vn[e],a=()=>{this.trigger(`${e}trackchange`)},h=this[s.getterName]();h.addEventListener("removetrack",a),h.addEventListener("addtrack",a),this.on("dispose",()=>{h.removeEventListener("removetrack",a),h.removeEventListener("addtrack",a)})})}addWebVttScript_(){if(!window.WebVTT)if(document.body.contains(this.el())){if(!this.options_["vtt.js"]&&te(Lr)&&Object.keys(Lr).length>0){this.trigger("vttjsloaded");return}const e=document.createElement("script");e.src=this.options_["vtt.js"]||"https://vjs.zencdn.net/vttjs/0.14.1/vtt.min.js",e.onload=()=>{this.trigger("vttjsloaded")},e.onerror=()=>{this.trigger("vttjserror")},this.on("dispose",()=>{e.onload=null,e.onerror=null}),window.WebVTT=!0,this.el().parentNode.appendChild(e)}else this.ready(this.addWebVttScript_)}emulateTextTracks(){const e=this.textTracks(),s=this.remoteTextTracks(),a=w=>e.addTrack(w.track),h=w=>e.removeTrack(w.track);s.on("addtrack",a),s.on("removetrack",h),this.addWebVttScript_();const p=()=>this.trigger("texttrackchange"),_=()=>{p();for(let w=0;w<e.length;w++){const I=e[w];I.removeEventListener("cuechange",p),I.mode==="showing"&&I.addEventListener("cuechange",p)}};_(),e.addEventListener("change",_),e.addEventListener("addtrack",_),e.addEventListener("removetrack",_),this.on("dispose",function(){s.off("addtrack",a),s.off("removetrack",h),e.removeEventListener("change",_),e.removeEventListener("addtrack",_),e.removeEventListener("removetrack",_);for(let w=0;w<e.length;w++)e[w].removeEventListener("cuechange",p)})}addTextTrack(e,s,a){if(!e)throw new Error("TextTrack kind is required but was not provided");return qh(this,e,s,a)}createRemoteTextTrack(e){const s=ee(e,{tech:this});return new Vh.remoteTextEl.TrackClass(s)}addRemoteTextTrack(e={},s){const a=this.createRemoteTextTrack(e);return typeof s!="boolean"&&(s=!1),this.remoteTextTrackEls().addTrackElement_(a),this.remoteTextTracks().addTrack(a.track),s===!1&&this.ready(()=>this.autoRemoteTextTracks_.addTrack(a.track)),a}removeRemoteTextTrack(e){const s=this.remoteTextTrackEls().getTrackElementByTrack_(e);this.remoteTextTrackEls().removeTrackElement_(s),this.remoteTextTracks().removeTrack(e),this.autoRemoteTextTracks_.removeTrack(e)}getVideoPlaybackQuality(){return{}}requestPictureInPicture(){return Promise.reject()}disablePictureInPicture(){return!0}setDisablePictureInPicture(){}requestVideoFrameCallback(e){const s=qi();return!this.isReady_||this.paused()?(this.queuedHanders_.add(s),this.one("playing",()=>{this.queuedHanders_.has(s)&&(this.queuedHanders_.delete(s),e())})):this.requestNamedAnimationFrame(s,e),s}cancelVideoFrameCallback(e){this.queuedHanders_.has(e)?this.queuedHanders_.delete(e):this.cancelNamedAnimationFrame(e)}setPoster(){}playsinline(){}setPlaysinline(){}overrideNativeAudioTracks(e){}overrideNativeVideoTracks(e){}canPlayType(e){return""}static canPlayType(e){return""}static canPlaySource(e,s){return si.canPlayType(e.type)}static isTech(e){return e.prototype instanceof si||e instanceof si||e===si}static registerTech(e,s){if(si.techs_||(si.techs_={}),!si.isTech(s))throw new Error(`Tech ${e} must be a Tech`);if(!si.canPlayType)throw new Error("Techs must have a static canPlayType method on them");if(!si.canPlaySource)throw new Error("Techs must have a static canPlaySource method on them");return e=he(e),si.techs_[e]=s,si.techs_[V(e)]=s,e!=="Tech"&&si.defaultTechOrder_.push(e),s}static getTech(e){if(e){if(si.techs_&&si.techs_[e])return si.techs_[e];if(e=he(e),window&&window.videojs&&window.videojs[e])return P.warn(`The ${e} tech was added to the videojs object when it should be registered using videojs.registerTech(name, tech)`),window.videojs[e]}}}wr.names.forEach(function(r){const e=wr[r];si.prototype[e.getterName]=function(){return this[e.privateName]=this[e.privateName]||new e.ListClass,this[e.privateName]}}),si.prototype.featuresVolumeControl=!0,si.prototype.featuresMuteControl=!0,si.prototype.featuresFullscreenResize=!1,si.prototype.featuresPlaybackRate=!1,si.prototype.featuresProgressEvents=!1,si.prototype.featuresSourceset=!1,si.prototype.featuresTimeupdateEvents=!1,si.prototype.featuresNativeTextTracks=!1,si.prototype.featuresVideoFrameCallback=!1,si.withSourceHandlers=function(r){r.registerSourceHandler=function(s,a){let h=r.sourceHandlers;h||(h=r.sourceHandlers=[]),a===void 0&&(a=h.length),h.splice(a,0,s)},r.canPlayType=function(s){const a=r.sourceHandlers||[];let h;for(let p=0;p<a.length;p++)if(h=a[p].canPlayType(s),h)return h;return""},r.selectSourceHandler=function(s,a){const h=r.sourceHandlers||[];let p;for(let _=0;_<h.length;_++)if(p=h[_].canHandleSource(s,a),p)return h[_];return null},r.canPlaySource=function(s,a){const h=r.selectSourceHandler(s,a);return h?h.canHandleSource(s,a):""},["seekable","seeking","duration"].forEach(function(s){const a=this[s];typeof a=="function"&&(this[s]=function(){return this.sourceHandler_&&this.sourceHandler_[s]?this.sourceHandler_[s].apply(this.sourceHandler_,arguments):a.apply(this,arguments)})},r.prototype),r.prototype.setSource=function(s){let a=r.selectSourceHandler(s,this.options_);a||(r.nativeSourceHandler?a=r.nativeSourceHandler:P.error("No source handler found for the current source.")),this.disposeSourceHandler(),this.off("dispose",this.disposeSourceHandler_),a!==r.nativeSourceHandler&&(this.currentSource_=s),this.sourceHandler_=a.handleSource(s,this,this.options_),this.one("dispose",this.disposeSourceHandler_)},r.prototype.disposeSourceHandler=function(){this.currentSource_&&(this.clearTracks(["audio","video"]),this.currentSource_=null),this.cleanupAutoTextTracks(),this.sourceHandler_&&(this.sourceHandler_.dispose&&this.sourceHandler_.dispose(),this.sourceHandler_=null)}},Le.registerComponent("Tech",si),si.registerTech("Tech",si),si.defaultTechOrder_=[];const Ud={},TT={},ET={};function M3(r,e){Ud[r]=Ud[r]||[],Ud[r].push(e)}function O3(r,e,s){r.setTimeout(()=>jd(e,Ud[e.type],s,r),1)}function F3(r,e){r.forEach(s=>s.setTech&&s.setTech(e))}function B3(r,e,s){return r.reduceRight(Mx(s),e[s]())}function U3(r,e,s,a){return e[s](r.reduce(Mx(s),a))}function pP(r,e,s,a=null){const h="call"+he(s),p=r.reduce(Mx(h),a),_=p===ET,w=_?null:e[s](p);return V3(r,s,w,_),w}const j3={buffered:1,currentTime:1,duration:1,muted:1,played:1,paused:1,seekable:1,volume:1,ended:1},H3={setCurrentTime:1,setMuted:1,setVolume:1},gP={play:1,pause:1};function Mx(r){return(e,s)=>e===ET?ET:s[r]?s[r](e):e}function V3(r,e,s,a){for(let h=r.length-1;h>=0;h--){const p=r[h];p[e]&&p[e](a,s)}}function $3(r){TT.hasOwnProperty(r.id())&&delete TT[r.id()]}function z3(r,e){const s=TT[r.id()];let a=null;if(s==null)return a=e(r),TT[r.id()]=[[e,a]],a;for(let h=0;h<s.length;h++){const[p,_]=s[h];p===e&&(a=_)}return a===null&&(a=e(r),s.push([e,a])),a}function jd(r={},e=[],s,a,h=[],p=!1){const[_,...w]=e;if(typeof _=="string")jd(r,Ud[_],s,a,h,p);else if(_){const I=z3(a,_);if(!I.setSource)return h.push(I),jd(r,w,s,a,h,p);I.setSource(Object.assign({},r),function(B,G){if(B)return jd(r,w,s,a,h,p);h.push(I),jd(G,r.type===G.type?w:Ud[G.type],s,a,h,p)})}else w.length?jd(r,w,s,a,h,p):p?s(r,h):jd(r,Ud["*"],s,a,h,!0)}const W3={opus:"video/ogg",ogv:"video/ogg",mp4:"video/mp4",mov:"video/mp4",m4v:"video/mp4",mkv:"video/x-matroska",m4a:"audio/mp4",mp3:"audio/mpeg",aac:"audio/aac",caf:"audio/x-caf",flac:"audio/flac",oga:"audio/ogg",wav:"audio/wav",m3u8:"application/x-mpegURL",mpd:"application/dash+xml",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",png:"image/png",svg:"image/svg+xml",webp:"image/webp"},ST=function(r=""){const e=lg(r);return W3[e.toLowerCase()]||""},q3=(r,e)=>{if(!e)return"";if(r.cache_.source.src===e&&r.cache_.source.type)return r.cache_.source.type;const s=r.cache_.sources.filter(h=>h.src===e);if(s.length)return s[0].type;const a=r.$$("source");for(let h=0;h<a.length;h++){const p=a[h];if(p.type&&p.src&&p.src===e)return p.type}return ST(e)},mP=function(r){if(Array.isArray(r)){let e=[];r.forEach(function(s){s=mP(s),Array.isArray(s)?e=e.concat(s):K(s)&&e.push(s)}),r=e}else typeof r=="string"&&r.trim()?r=[_P({src:r})]:K(r)&&typeof r.src=="string"&&r.src&&r.src.trim()?r=[_P(r)]:r=[];return r};function _P(r){if(!r.type){const e=ST(r.src);e&&(r.type=e)}return r}var G3=`<svg xmlns="http://www.w3.org/2000/svg">
  <defs>
    <symbol viewBox="0 0 48 48" id="vjs-icon-play">
      <path d="M16 10v28l22-14z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-pause">
      <path d="M12 38h8V10h-8v28zm16-28v28h8V10h-8z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-audio">
      <path d="M24 2C14.06 2 6 10.06 6 20v14c0 3.31 2.69 6 6 6h6V24h-8v-4c0-7.73 6.27-14 14-14s14 6.27 14 14v4h-8v16h6c3.31 0 6-2.69 6-6V20c0-9.94-8.06-18-18-18z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-captions">
      <path d="M38 8H10c-2.21 0-4 1.79-4 4v24c0 2.21 1.79 4 4 4h28c2.21 0 4-1.79 4-4V12c0-2.21-1.79-4-4-4zM22 22h-3v-1h-4v6h4v-1h3v2a2 2 0 0 1-2 2h-6a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v2zm14 0h-3v-1h-4v6h4v-1h3v2a2 2 0 0 1-2 2h-6a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v2z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-subtitles">
      <path d="M40 8H8c-2.21 0-4 1.79-4 4v24c0 2.21 1.79 4 4 4h32c2.21 0 4-1.79 4-4V12c0-2.21-1.79-4-4-4zM8 24h8v4H8v-4zm20 12H8v-4h20v4zm12 0h-8v-4h8v4zm0-8H20v-4h20v4z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-fullscreen-enter">
      <path d="M14 28h-4v10h10v-4h-6v-6zm-4-8h4v-6h6v-4H10v10zm24 14h-6v4h10V28h-4v6zm-6-24v4h6v6h4V10H28z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-fullscreen-exit">
      <path d="M10 32h6v6h4V28H10v4zm6-16h-6v4h10V10h-4v6zm12 22h4v-6h6v-4H28v10zm4-22v-6h-4v10h10v-4h-6z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-play-circle">
      <path d="M20 33l12-9-12-9v18zm4-29C12.95 4 4 12.95 4 24s8.95 20 20 20 20-8.95 20-20S35.05 4 24 4zm0 36c-8.82 0-16-7.18-16-16S15.18 8 24 8s16 7.18 16 16-7.18 16-16 16z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-volume-mute">
      <path d="M33 24c0-3.53-2.04-6.58-5-8.05v4.42l4.91 4.91c.06-.42.09-.85.09-1.28zm5 0c0 1.88-.41 3.65-1.08 5.28l3.03 3.03C41.25 29.82 42 27 42 24c0-8.56-5.99-15.72-14-17.54v4.13c5.78 1.72 10 7.07 10 13.41zM8.55 6L6 8.55 15.45 18H6v12h8l10 10V26.55l8.51 8.51c-1.34 1.03-2.85 1.86-4.51 2.36v4.13a17.94 17.94 0 0 0 7.37-3.62L39.45 42 42 39.45l-18-18L8.55 6zM24 8l-4.18 4.18L24 16.36V8z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-volume-low">
      <path d="M14 18v12h8l10 10V8L22 18h-8z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-volume-medium">
      <path d="M37 24c0-3.53-2.04-6.58-5-8.05v16.11c2.96-1.48 5-4.53 5-8.06zm-27-6v12h8l10 10V8L18 18h-8z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-volume-high">
      <path d="M6 18v12h8l10 10V8L14 18H6zm27 6c0-3.53-2.04-6.58-5-8.05v16.11c2.96-1.48 5-4.53 5-8.06zM28 6.46v4.13c5.78 1.72 10 7.07 10 13.41s-4.22 11.69-10 13.41v4.13c8.01-1.82 14-8.97 14-17.54S36.01 8.28 28 6.46z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-spinner">
      <path d="M18.8 21l9.53-16.51C26.94 4.18 25.49 4 24 4c-4.8 0-9.19 1.69-12.64 4.51l7.33 12.69.11-.2zm24.28-3c-1.84-5.85-6.3-10.52-11.99-12.68L23.77 18h19.31zm.52 2H28.62l.58 1 9.53 16.5C41.99 33.94 44 29.21 44 24c0-1.37-.14-2.71-.4-4zm-26.53 4l-7.8-13.5C6.01 14.06 4 18.79 4 24c0 1.37.14 2.71.4 4h14.98l-2.31-4zM4.92 30c1.84 5.85 6.3 10.52 11.99 12.68L24.23 30H4.92zm22.54 0l-7.8 13.51c1.4.31 2.85.49 4.34.49 4.8 0 9.19-1.69 12.64-4.51L29.31 26.8 27.46 30z"></path>
    </symbol>
    <symbol viewBox="0 0 24 24" id="vjs-icon-hd">
      <path d="M19 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-8 12H9.5v-2h-2v2H6V9h1.5v2.5h2V9H11v6zm2-6h4c.55 0 1 .45 1 1v4c0 .55-.45 1-1 1h-4V9zm1.5 4.5h2v-3h-2v3z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-chapters">
      <path d="M6 26h4v-4H6v4zm0 8h4v-4H6v4zm0-16h4v-4H6v4zm8 8h28v-4H14v4zm0 8h28v-4H14v4zm0-20v4h28v-4H14z"></path>
    </symbol>
    <symbol viewBox="0 0 40 40" id="vjs-icon-downloading">
      <path d="M18.208 36.875q-3.208-.292-5.979-1.729-2.771-1.438-4.812-3.729-2.042-2.292-3.188-5.229-1.146-2.938-1.146-6.23 0-6.583 4.334-11.416 4.333-4.834 10.833-5.5v3.166q-5.167.75-8.583 4.646Q6.25 14.75 6.25 19.958q0 5.209 3.396 9.104 3.396 3.896 8.562 4.646zM20 28.417L11.542 20l2.083-2.083 4.917 4.916v-11.25h2.916v11.25l4.875-4.916L28.417 20zm1.792 8.458v-3.167q1.833-.25 3.541-.958 1.709-.708 3.167-1.875l2.333 2.292q-1.958 1.583-4.25 2.541-2.291.959-4.791 1.167zm6.791-27.792q-1.541-1.125-3.25-1.854-1.708-.729-3.541-1.021V3.042q2.5.25 4.77 1.208 2.271.958 4.271 2.5zm4.584 21.584l-2.25-2.25q1.166-1.5 1.854-3.209.687-1.708.937-3.541h3.209q-.292 2.5-1.229 4.791-.938 2.292-2.521 4.209zm.541-12.417q-.291-1.833-.958-3.562-.667-1.73-1.833-3.188l2.375-2.208q1.541 1.916 2.458 4.208.917 2.292 1.167 4.75z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-file-download">
      <path d="M10.8 40.55q-1.35 0-2.375-1T7.4 37.15v-7.7h3.4v7.7h26.35v-7.7h3.4v7.7q0 1.4-1 2.4t-2.4 1zM24 32.1L13.9 22.05l2.45-2.45 5.95 5.95V7.15h3.4v18.4l5.95-5.95 2.45 2.45z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-file-download-done">
      <path d="M9.8 40.5v-3.45h28.4v3.45zm9.2-9.05L7.4 19.85l2.45-2.35L19 26.65l19.2-19.2 2.4 2.4z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-file-download-off">
      <path d="M4.9 4.75L43.25 43.1 41 45.3l-4.75-4.75q-.05.05-.075.025-.025-.025-.075-.025H10.8q-1.35 0-2.375-1T7.4 37.15v-7.7h3.4v7.7h22.05l-7-7-1.85 1.8L13.9 21.9l1.85-1.85L2.7 7zm26.75 14.7l2.45 2.45-3.75 3.8-2.45-2.5zM25.7 7.15V21.1l-3.4-3.45V7.15z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-share">
      <path d="M36 32.17c-1.52 0-2.89.59-3.93 1.54L17.82 25.4c.11-.45.18-.92.18-1.4s-.07-.95-.18-1.4l14.1-8.23c1.07 1 2.5 1.62 4.08 1.62 3.31 0 6-2.69 6-6s-2.69-6-6-6-6 2.69-6 6c0 .48.07.95.18 1.4l-14.1 8.23c-1.07-1-2.5-1.62-4.08-1.62-3.31 0-6 2.69-6 6s2.69 6 6 6c1.58 0 3.01-.62 4.08-1.62l14.25 8.31c-.1.42-.16.86-.16 1.31A5.83 5.83 0 1 0 36 32.17z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-cog">
      <path d="M38.86 25.95c.08-.64.14-1.29.14-1.95s-.06-1.31-.14-1.95l4.23-3.31c.38-.3.49-.84.24-1.28l-4-6.93c-.25-.43-.77-.61-1.22-.43l-4.98 2.01c-1.03-.79-2.16-1.46-3.38-1.97L29 4.84c-.09-.47-.5-.84-1-.84h-8c-.5 0-.91.37-.99.84l-.75 5.3a14.8 14.8 0 0 0-3.38 1.97L9.9 10.1a1 1 0 0 0-1.22.43l-4 6.93c-.25.43-.14.97.24 1.28l4.22 3.31C9.06 22.69 9 23.34 9 24s.06 1.31.14 1.95l-4.22 3.31c-.38.3-.49.84-.24 1.28l4 6.93c.25.43.77.61 1.22.43l4.98-2.01c1.03.79 2.16 1.46 3.38 1.97l.75 5.3c.08.47.49.84.99.84h8c.5 0 .91-.37.99-.84l.75-5.3a14.8 14.8 0 0 0 3.38-1.97l4.98 2.01a1 1 0 0 0 1.22-.43l4-6.93c.25-.43.14-.97-.24-1.28l-4.22-3.31zM24 31c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-square">
      <path d="M36 8H12c-2.21 0-4 1.79-4 4v24c0 2.21 1.79 4 4 4h24c2.21 0 4-1.79 4-4V12c0-2.21-1.79-4-4-4zm0 28H12V12h24v24z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-circle">
      <circle cx="24" cy="24" r="20"></circle>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-circle-outline">
      <path d="M24 4C12.95 4 4 12.95 4 24s8.95 20 20 20 20-8.95 20-20S35.05 4 24 4zm0 36c-8.82 0-16-7.18-16-16S15.18 8 24 8s16 7.18 16 16-7.18 16-16 16z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-circle-inner-circle">
      <path d="M24 4C12.97 4 4 12.97 4 24s8.97 20 20 20 20-8.97 20-20S35.03 4 24 4zm0 36c-8.82 0-16-7.18-16-16S15.18 8 24 8s16 7.18 16 16-7.18 16-16 16zm6-16c0 3.31-2.69 6-6 6s-6-2.69-6-6 2.69-6 6-6 6 2.69 6 6z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-cancel">
      <path d="M24 4C12.95 4 4 12.95 4 24s8.95 20 20 20 20-8.95 20-20S35.05 4 24 4zm10 27.17L31.17 34 24 26.83 16.83 34 14 31.17 21.17 24 14 16.83 16.83 14 24 21.17 31.17 14 34 16.83 26.83 24 34 31.17z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-replay">
      <path d="M24 10V2L14 12l10 10v-8c6.63 0 12 5.37 12 12s-5.37 12-12 12-12-5.37-12-12H8c0 8.84 7.16 16 16 16s16-7.16 16-16-7.16-16-16-16z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-repeat">
      <path d="M14 14h20v6l8-8-8-8v6H10v12h4v-8zm20 20H14v-6l-8 8 8 8v-6h24V26h-4v8z"></path>
    </symbol>
    <symbol viewBox="0 96 48 48" id="vjs-icon-replay-5">
      <path d="M17.689 98l-8.697 8.696 8.697 8.697 2.486-2.485-4.32-4.319h1.302c4.93 0 9.071 1.722 12.424 5.165 3.352 3.443 5.029 7.638 5.029 12.584h3.55c0-2.958-.553-5.73-1.658-8.313-1.104-2.583-2.622-4.841-4.555-6.774-1.932-1.932-4.19-3.45-6.773-4.555-2.584-1.104-5.355-1.657-8.313-1.657H15.5l4.615-4.615zm-8.08 21.659v13.861h11.357v5.008H9.609V143h12.7c.834 0 1.55-.298 2.146-.894.596-.597.895-1.31.895-2.145v-7.781c0-.835-.299-1.55-.895-2.147a2.929 2.929 0 0 0-2.147-.894h-8.227v-5.096H25.35v-4.384z"></path>
    </symbol>
    <symbol viewBox="0 96 48 48" id="vjs-icon-replay-10">
      <path d="M42.315 125.63c0-4.997-1.694-9.235-5.08-12.713-3.388-3.479-7.571-5.218-12.552-5.218h-1.315l4.363 4.363-2.51 2.51-8.787-8.786L25.221 97l2.45 2.45-4.662 4.663h1.375c2.988 0 5.788.557 8.397 1.673 2.61 1.116 4.892 2.65 6.844 4.602 1.953 1.953 3.487 4.234 4.602 6.844 1.116 2.61 1.674 5.41 1.674 8.398zM8.183 142v-19.657H3.176V117.8h9.643V142zm13.63 0c-1.156 0-2.127-.393-2.912-1.178-.778-.778-1.168-1.746-1.168-2.902v-16.04c0-1.156.393-2.127 1.178-2.912.779-.779 1.746-1.168 2.902-1.168h7.696c1.156 0 2.126.392 2.911 1.177.779.78 1.168 1.747 1.168 2.903v16.04c0 1.156-.392 2.127-1.177 2.912-.779.779-1.746 1.168-2.902 1.168zm.556-4.636h6.583v-15.02H22.37z"></path>
    </symbol>
    <symbol viewBox="0 96 48 48" id="vjs-icon-replay-30">
      <path d="M26.047 97l-8.733 8.732 8.733 8.733 2.496-2.494-4.336-4.338h1.307c4.95 0 9.108 1.73 12.474 5.187 3.367 3.458 5.051 7.668 5.051 12.635h3.565c0-2.97-.556-5.751-1.665-8.346-1.109-2.594-2.633-4.862-4.574-6.802-1.94-1.941-4.208-3.466-6.803-4.575-2.594-1.109-5.375-1.664-8.345-1.664H23.85l4.634-4.634zM2.555 117.531v4.688h10.297v5.25H5.873v4.687h6.979v5.156H2.555V142H13.36c1.061 0 1.95-.395 2.668-1.186.718-.79 1.076-1.772 1.076-2.94v-16.218c0-1.168-.358-2.149-1.076-2.94-.717-.79-1.607-1.185-2.668-1.185zm22.482.14c-1.149 0-2.11.39-2.885 1.165-.78.78-1.172 1.744-1.172 2.893v15.943c0 1.149.388 2.11 1.163 2.885.78.78 1.745 1.172 2.894 1.172h7.649c1.148 0 2.11-.388 2.884-1.163.78-.78 1.17-1.745 1.17-2.894v-15.943c0-1.15-.386-2.111-1.16-2.885-.78-.78-1.746-1.172-2.894-1.172zm.553 4.518h6.545v14.93H25.59z"></path>
    </symbol>
    <symbol viewBox="0 96 48 48" id="vjs-icon-forward-5">
      <path d="M29.508 97l-2.431 2.43 4.625 4.625h-1.364c-2.965 0-5.742.554-8.332 1.66-2.589 1.107-4.851 2.629-6.788 4.566-1.937 1.937-3.458 4.2-4.565 6.788-1.107 2.59-1.66 5.367-1.66 8.331h3.557c0-4.957 1.68-9.16 5.04-12.611 3.36-3.45 7.51-5.177 12.451-5.177h1.304l-4.326 4.33 2.49 2.49 8.715-8.716zm-9.783 21.61v13.89h11.382v5.018H19.725V142h12.727a2.93 2.93 0 0 0 2.15-.896 2.93 2.93 0 0 0 .896-2.15v-7.798c0-.837-.299-1.554-.896-2.152a2.93 2.93 0 0 0-2.15-.896h-8.245V123h11.29v-4.392z"></path>
    </symbol>
    <symbol viewBox="0 96 48 48" id="vjs-icon-forward-10">
      <path d="M23.119 97l-2.386 2.383 4.538 4.538h-1.339c-2.908 0-5.633.543-8.173 1.63-2.54 1.085-4.76 2.577-6.66 4.478-1.9 1.9-3.392 4.12-4.478 6.66-1.085 2.54-1.629 5.264-1.629 8.172h3.49c0-4.863 1.648-8.986 4.944-12.372 3.297-3.385 7.368-5.078 12.216-5.078h1.279l-4.245 4.247 2.443 2.442 8.55-8.55zm-9.52 21.45v4.42h4.871V142h4.513v-23.55zm18.136 0c-1.125 0-2.066.377-2.824 1.135-.764.764-1.148 1.709-1.148 2.834v15.612c0 1.124.38 2.066 1.139 2.824.764.764 1.708 1.145 2.833 1.145h7.489c1.125 0 2.066-.378 2.824-1.136.764-.764 1.145-1.709 1.145-2.833v-15.612c0-1.125-.378-2.067-1.136-2.825-.764-.764-1.708-1.145-2.833-1.145zm.54 4.42h6.408v14.617h-6.407z"></path>
    </symbol>
    <symbol viewBox="0 96 48 48" id="vjs-icon-forward-30">
      <path d="M25.549 97l-2.437 2.434 4.634 4.635H26.38c-2.97 0-5.753.555-8.347 1.664-2.594 1.109-4.861 2.633-6.802 4.574-1.94 1.94-3.465 4.207-4.574 6.802-1.109 2.594-1.664 5.377-1.664 8.347h3.565c0-4.967 1.683-9.178 5.05-12.636 3.366-3.458 7.525-5.187 12.475-5.187h1.307l-4.335 4.338 2.495 2.494 8.732-8.732zm-11.553 20.53v4.689h10.297v5.249h-6.978v4.688h6.978v5.156H13.996V142h10.808c1.06 0 1.948-.395 2.666-1.186.718-.79 1.077-1.771 1.077-2.94v-16.217c0-1.169-.36-2.15-1.077-2.94-.718-.79-1.605-1.186-2.666-1.186zm21.174.168c-1.149 0-2.11.389-2.884 1.163-.78.78-1.172 1.745-1.172 2.894v15.942c0 1.15.388 2.11 1.162 2.885.78.78 1.745 1.17 2.894 1.17h7.649c1.149 0 2.11-.386 2.885-1.16.78-.78 1.17-1.746 1.17-2.895v-15.942c0-1.15-.387-2.11-1.161-2.885-.78-.78-1.745-1.172-2.894-1.172zm.552 4.516h6.542v14.931h-6.542z"></path>
    </symbol>
    <symbol viewBox="0 0 512 512" id="vjs-icon-audio-description">
      <g fill-rule="evenodd"><path d="M227.29 381.351V162.993c50.38-1.017 89.108-3.028 117.631 17.126 27.374 19.342 48.734 56.965 44.89 105.325-4.067 51.155-41.335 94.139-89.776 98.475-24.085 2.155-71.972 0-71.972 0s-.84-1.352-.773-2.568m48.755-54.804c31.43 1.26 53.208-16.633 56.495-45.386 4.403-38.51-21.188-63.552-58.041-60.796v103.612c-.036 1.466.575 2.22 1.546 2.57"></path><path d="M383.78 381.328c13.336 3.71 17.387-11.06 23.215-21.408 12.722-22.571 22.294-51.594 22.445-84.774.221-47.594-18.343-82.517-35.6-106.182h-8.51c-.587 3.874 2.226 7.315 3.865 10.276 13.166 23.762 25.367 56.553 25.54 94.194.2 43.176-14.162 79.278-30.955 107.894"></path><path d="M425.154 381.328c13.336 3.71 17.384-11.061 23.215-21.408 12.721-22.571 22.291-51.594 22.445-84.774.221-47.594-18.343-82.517-35.6-106.182h-8.511c-.586 3.874 2.226 7.315 3.866 10.276 13.166 23.762 25.367 56.553 25.54 94.194.2 43.176-14.162 79.278-30.955 107.894"></path><path d="M466.26 381.328c13.337 3.71 17.385-11.061 23.216-21.408 12.722-22.571 22.292-51.594 22.445-84.774.221-47.594-18.343-82.517-35.6-106.182h-8.51c-.587 3.874 2.225 7.315 3.865 10.276 13.166 23.762 25.367 56.553 25.54 94.194.2 43.176-14.162 79.278-30.955 107.894M4.477 383.005H72.58l18.573-28.484 64.169-.135s.065 19.413.065 28.62h48.756V160.307h-58.816c-5.653 9.537-140.85 222.697-140.85 222.697zm152.667-145.282v71.158l-40.453-.27 40.453-70.888z"></path></g>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-next-item">
      <path d="M12 36l17-12-17-12v24zm20-24v24h4V12h-4z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-previous-item">
      <path d="M12 12h4v24h-4zm7 12l17 12V12z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-shuffle">
      <path d="M21.17 18.34L10.83 8 8 10.83l10.34 10.34 2.83-2.83zM29 8l4.09 4.09L8 37.17 10.83 40l25.09-25.09L40 19V8H29zm.66 18.83l-2.83 2.83 6.26 6.26L29 40h11V29l-4.09 4.09-6.25-6.26z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-cast">
      <path d="M42 6H6c-2.21 0-4 1.79-4 4v6h4v-6h36v28H28v4h14c2.21 0 4-1.79 4-4V10c0-2.21-1.79-4-4-4zM2 36v6h6c0-3.31-2.69-6-6-6zm0-8v4c5.52 0 10 4.48 10 10h4c0-7.73-6.27-14-14-14zm0-8v4c9.94 0 18 8.06 18 18h4c0-12.15-9.85-22-22-22z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-picture-in-picture-enter">
      <path d="M38 22H22v11.99h16V22zm8 16V9.96C46 7.76 44.2 6 42 6H6C3.8 6 2 7.76 2 9.96V38c0 2.2 1.8 4 4 4h36c2.2 0 4-1.8 4-4zm-4 .04H6V9.94h36v28.1z"></path>
    </symbol>
    <symbol viewBox="0 0 22 18" id="vjs-icon-picture-in-picture-exit">
      <path d="M18 4H4v10h14V4zm4 12V1.98C22 .88 21.1 0 20 0H2C.9 0 0 .88 0 1.98V16c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2zm-2 .02H2V1.97h18v14.05z"></path>
      <path fill="none" d="M-1-3h24v24H-1z"></path>
    </symbol>
    <symbol viewBox="0 0 1792 1792" id="vjs-icon-facebook">
      <path d="M1343 12v264h-157q-86 0-116 36t-30 108v189h293l-39 296h-254v759H734V905H479V609h255V391q0-186 104-288.5T1115 0q147 0 228 12z"></path>
    </symbol>
    <symbol viewBox="0 0 1792 1792" id="vjs-icon-linkedin">
      <path d="M477 625v991H147V625h330zm21-306q1 73-50.5 122T312 490h-2q-82 0-132-49t-50-122q0-74 51.5-122.5T314 148t133 48.5T498 319zm1166 729v568h-329v-530q0-105-40.5-164.5T1168 862q-63 0-105.5 34.5T999 982q-11 30-11 81v553H659q2-399 2-647t-1-296l-1-48h329v144h-2q20-32 41-56t56.5-52 87-43.5T1285 602q171 0 275 113.5t104 332.5z"></path>
    </symbol>
    <symbol viewBox="0 0 1200 1227" id="vjs-icon-twitter">
      <path d="M714.163 519.284L1160.89 0H1055.03L667.137 450.887L357.328 0H0L468.492 681.821L0 1226.37H105.866L515.491 750.218L842.672 1226.37H1200L714.137 519.284H714.163ZM569.165 687.828L521.697 619.934L144.011 79.6944H306.615L611.412 515.685L658.88 583.579L1055.08 1150.3H892.476L569.165 687.854V687.828Z"/>
    </symbol>
    <symbol viewBox="0 0 1792 1792" id="vjs-icon-tumblr">
      <path d="M1328 1329l80 237q-23 35-111 66t-177 32q-104 2-190.5-26T787 1564t-95-106-55.5-120-16.5-118V676H452V461q72-26 129-69.5t91-90 58-102 34-99T779 12q1-5 4.5-8.5T791 0h244v424h333v252h-334v518q0 30 6.5 56t22.5 52.5 49.5 41.5 81.5 14q78-2 134-29z"></path>
    </symbol>
    <symbol viewBox="0 0 1792 1792" id="vjs-icon-pinterest">
      <path d="M1664 896q0 209-103 385.5T1281.5 1561 896 1664q-111 0-218-32 59-93 78-164 9-34 54-211 20 39 73 67.5t114 28.5q121 0 216-68.5t147-188.5 52-270q0-114-59.5-214T1180 449t-255-63q-105 0-196 29t-154.5 77-109 110.5-67 129.5T377 866q0 104 40 183t117 111q30 12 38-20 2-7 8-31t8-30q6-23-11-43-51-61-51-151 0-151 104.5-259.5T904 517q151 0 235.5 82t84.5 213q0 170-68.5 289T980 1220q-61 0-98-43.5T859 1072q8-35 26.5-93.5t30-103T927 800q0-50-27-83t-77-33q-62 0-105 57t-43 142q0 73 25 122l-99 418q-17 70-13 177-206-91-333-281T128 896q0-209 103-385.5T510.5 231 896 128t385.5 103T1561 510.5 1664 896z"></path>
    </symbol>
  </defs>
</svg>`;const bP=wi?10009:jt?461:8,pg={codes:{play:415,pause:19,ff:417,rw:412,back:bP},names:{415:"play",19:"pause",417:"ff",412:"rw",[bP]:"back"},isEventKey(r,e){return e=e.toLowerCase(),!!(this.names[r.keyCode]&&this.names[r.keyCode]===e)},getEventName(r){if(this.names[r.keyCode])return this.names[r.keyCode];if(this.codes[r.code]){const e=this.codes[r.code];return this.names[e]}return null}},yP=5;class X3 extends Ki{constructor(e){super(),this.player_=e,this.focusableComponents=[],this.isListening_=!1,this.isPaused_=!1,this.onKeyDown_=this.onKeyDown_.bind(this),this.lastFocusedComponent_=null}start(){this.isListening_||(this.player_.on("keydown",this.onKeyDown_),this.player_.on("modalKeydown",this.onKeyDown_),this.player_.on("loadedmetadata",()=>{this.focus(this.updateFocusableComponents()[0])}),this.player_.on("modalclose",()=>{this.refocusComponent()}),this.player_.on("focusin",this.handlePlayerFocus_.bind(this)),this.player_.on("focusout",this.handlePlayerBlur_.bind(this)),this.isListening_=!0,this.player_.errorDisplay&&this.player_.errorDisplay.on("aftermodalfill",()=>{this.updateFocusableComponents(),this.focusableComponents.length&&(this.focusableComponents.length>1?this.focusableComponents[1].focus():this.focusableComponents[0].focus())}))}stop(){this.player_.off("keydown",this.onKeyDown_),this.isListening_=!1}onKeyDown_(e){const s=e.originalEvent?e.originalEvent:e;if(["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"].includes(s.key)){if(this.isPaused_)return;s.preventDefault();const a=s.key.substring(5).toLowerCase();this.move(a)}else if(pg.isEventKey(s,"play")||pg.isEventKey(s,"pause")||pg.isEventKey(s,"ff")||pg.isEventKey(s,"rw")){s.preventDefault();const a=pg.getEventName(s);this.performMediaAction_(a)}else pg.isEventKey(s,"Back")&&e.target&&typeof e.target.closeable=="function"&&e.target.closeable()&&(s.preventDefault(),e.target.close())}performMediaAction_(e){if(this.player_)switch(e){case"play":this.player_.paused()&&this.player_.play();break;case"pause":this.player_.paused()||this.player_.pause();break;case"ff":this.userSeek_(this.player_.currentTime()+yP);break;case"rw":this.userSeek_(this.player_.currentTime()-yP);break}}userSeek_(e){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&this.player_.liveTracker.nextSeekedFromUser(),this.player_.currentTime(e)}pause(){this.isPaused_=!0}resume(){this.isPaused_=!1}handlePlayerBlur_(e){const s=e.relatedTarget;let a=null;const h=this.getCurrentComponent(e.target);s&&(a=!!s.closest(".video-js"),s.classList.contains("vjs-text-track-settings")&&!this.isPaused_&&this.searchForTrackSelect_()),(!e.currentTarget.contains(e.relatedTarget)&&!a||!s)&&(h&&h.name()==="CloseButton"?this.refocusComponent():(this.pause(),h&&h.el()&&(this.lastFocusedComponent_=h)))}handlePlayerFocus_(){this.getCurrentComponent()&&this.getCurrentComponent().getIsFocusable()&&this.resume()}updateFocusableComponents(){const e=this.player_,s=[];function a(h){for(const p of h)p.hasOwnProperty("el_")&&p.getIsFocusable()&&p.getIsAvailableToBeFocused(p.el())&&s.push(p),p.hasOwnProperty("children_")&&p.children_.length>0&&a(p.children_)}return e.children_.forEach(h=>{if(h.hasOwnProperty("el_"))if(h.getIsFocusable&&h.getIsAvailableToBeFocused&&h.getIsFocusable()&&h.getIsAvailableToBeFocused(h.el())){s.push(h);return}else h.hasOwnProperty("children_")&&h.children_.length>0?a(h.children_):h.hasOwnProperty("items")&&h.items.length>0?a(h.items):this.findSuitableDOMChild(h)&&s.push(h);if(h.name_==="ErrorDisplay"&&h.opened_){const p=h.el_.querySelector(".vjs-errors-ok-button-container");p&&p.querySelectorAll("button").forEach((w,I)=>{s.push({name:()=>"ModalButton"+(I+1),el:()=>w,getPositions:()=>{const B=w.getBoundingClientRect(),G={x:B.x,y:B.y,width:B.width,height:B.height,top:B.top,right:B.right,bottom:B.bottom,left:B.left},se={x:B.left+B.width/2,y:B.top+B.height/2,width:0,height:0,top:B.top+B.height/2,right:B.left+B.width/2,bottom:B.top+B.height/2,left:B.left+B.width/2};return{boundingClientRect:G,center:se}},getIsAvailableToBeFocused:()=>!0,getIsFocusable:B=>!0,focus:()=>w.focus()})})}}),this.focusableComponents=s,this.focusableComponents}findSuitableDOMChild(e){function s(a){if(e.getIsFocusable(a)&&e.getIsAvailableToBeFocused(a))return a;for(let h=0;h<a.children.length;h++){const p=a.children[h],_=s(p);if(_)return _}return null}return e.el()?s(e.el()):null}getCurrentComponent(e){this.updateFocusableComponents();const s=e||document.activeElement;if(this.focusableComponents.length){for(const a of this.focusableComponents)if(a.el()===s)return a}}add(e){const s=[...this.focusableComponents];e.hasOwnProperty("el_")&&e.getIsFocusable()&&e.getIsAvailableToBeFocused(e.el())&&s.push(e),this.focusableComponents=s,this.trigger({type:"focusableComponentsChanged",focusableComponents:this.focusableComponents})}remove(e){for(let s=0;s<this.focusableComponents.length;s++)if(this.focusableComponents[s].name()===e.name()){this.focusableComponents.splice(s,1),this.trigger({type:"focusableComponentsChanged",focusableComponents:this.focusableComponents});return}}clear(){this.focusableComponents.length>0&&(this.focusableComponents=[],this.trigger({type:"focusableComponentsChanged",focusableComponents:this.focusableComponents}))}move(e){const s=this.getCurrentComponent();if(!s)return;const a=s.getPositions(),h=this.focusableComponents.filter(_=>_!==s&&this.isInDirection_(a.boundingClientRect,_.getPositions().boundingClientRect,e)),p=this.findBestCandidate_(a.center,h,e);p?this.focus(p):this.trigger({type:"endOfFocusableComponents",direction:e,focusedComponent:s})}findBestCandidate_(e,s,a){let h=1/0,p=null;for(const _ of s){const w=_.getPositions().center,I=this.calculateDistance_(e,w,a);I<h&&(h=I,p=_)}return p}isInDirection_(e,s,a){switch(a){case"right":return s.left>=e.right;case"left":return s.right<=e.left;case"down":return s.top>=e.bottom;case"up":return s.bottom<=e.top;default:return!1}}refocusComponent(){if(this.lastFocusedComponent_){this.player_.userActive()||this.player_.userActive(!0),this.updateFocusableComponents();for(let e=0;e<this.focusableComponents.length;e++)if(this.focusableComponents[e].name()===this.lastFocusedComponent_.name()){this.focus(this.focusableComponents[e]);return}}else this.focus(this.updateFocusableComponents()[0])}focus(e){typeof e=="object"&&(e.getIsAvailableToBeFocused(e.el())?e.focus():this.findSuitableDOMChild(e)&&this.findSuitableDOMChild(e).focus())}calculateDistance_(e,s,a){const h=Math.abs(e.x-s.x),p=Math.abs(e.y-s.y);let _;switch(a){case"right":case"left":_=h+p*100;break;case"up":_=p*2+h*.5;break;case"down":_=p*5+h;break;default:_=h+p}return _}searchForTrackSelect_(){const e=this;for(const s of e.updateFocusableComponents())if(s.constructor.name==="TextTrackSelect"){e.focus(s);break}}}class K3 extends Le{constructor(e,s,a){const h=ee({createEl:!1},s);if(super(e,h,a),!s.playerOptions.sources||s.playerOptions.sources.length===0)for(let p=0,_=s.playerOptions.techOrder;p<_.length;p++){const w=he(_[p]);let I=si.getTech(w);if(w||(I=Le.getComponent(w)),I&&I.isSupported()){e.loadTech_(w);break}}else e.src(s.playerOptions.sources)}}Le.registerComponent("MediaLoader",K3);class xT extends Le{constructor(e,s){super(e,s),this.options_.controlText&&this.controlText(this.options_.controlText),this.handleMouseOver_=a=>this.handleMouseOver(a),this.handleMouseOut_=a=>this.handleMouseOut(a),this.handleClick_=a=>this.handleClick(a),this.handleKeyDown_=a=>this.handleKeyDown(a),this.emitTapEvents(),this.enable()}createEl(e="div",s={},a={}){s=Object.assign({className:this.buildCSSClass(),tabIndex:0},s),e==="button"&&P.error(`Creating a ClickableComponent with an HTML element of ${e} is not supported; use a Button instead.`),a=Object.assign({role:"button"},a),this.tabIndex_=s.tabIndex;const h=Mt(e,s,a);return this.player_.options_.experimentalSvgIcons||h.appendChild(Mt("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),this.createControlTextEl(h),h}dispose(){this.controlTextEl_=null,super.dispose()}createControlTextEl(e){return this.controlTextEl_=Mt("span",{className:"vjs-control-text"},{"aria-live":"polite"}),e&&e.appendChild(this.controlTextEl_),this.controlText(this.controlText_,e),this.controlTextEl_}controlText(e,s=this.el()){if(e===void 0)return this.controlText_||"Need Text";const a=this.localize(e);this.controlText_=e,Mi(this.controlTextEl_,a),!this.nonIconControl&&!this.player_.options_.noUITitleAttributes&&s.setAttribute("title",a)}buildCSSClass(){return`vjs-control vjs-button ${super.buildCSSClass()}`}enable(){this.enabled_||(this.enabled_=!0,this.removeClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","false"),typeof this.tabIndex_<"u"&&this.el_.setAttribute("tabIndex",this.tabIndex_),this.on(["tap","click"],this.handleClick_),this.on("keydown",this.handleKeyDown_))}disable(){this.enabled_=!1,this.addClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","true"),typeof this.tabIndex_<"u"&&this.el_.removeAttribute("tabIndex"),this.off("mouseover",this.handleMouseOver_),this.off("mouseout",this.handleMouseOut_),this.off(["tap","click"],this.handleClick_),this.off("keydown",this.handleKeyDown_)}handleLanguagechange(){this.controlText(this.controlText_)}handleClick(e){this.options_.clickHandler&&this.options_.clickHandler.call(this,arguments)}handleKeyDown(e){e.key===" "||e.key==="Enter"?(e.preventDefault(),e.stopPropagation(),this.trigger("click")):super.handleKeyDown(e)}}Le.registerComponent("ClickableComponent",xT);class Ox extends xT{constructor(e,s){super(e,s),this.update(),this.update_=a=>this.update(a),e.on("posterchange",this.update_)}dispose(){this.player().off("posterchange",this.update_),super.dispose()}createEl(){return Mt("div",{className:"vjs-poster"})}crossOrigin(e){if(typeof e>"u")return this.$("img")?this.$("img").crossOrigin:this.player_.tech_&&this.player_.tech_.isReady_?this.player_.crossOrigin():this.player_.options_.crossOrigin||this.player_.options_.crossorigin||null;if(e!==null&&e!=="anonymous"&&e!=="use-credentials"){this.player_.log.warn(`crossOrigin must be null,  "anonymous" or "use-credentials", given "${e}"`);return}this.$("img")&&(this.$("img").crossOrigin=e)}update(e){const s=this.player().poster();this.setSrc(s),s?this.show():this.hide()}setSrc(e){if(!e){this.el_.textContent="";return}this.$("img")||this.el_.appendChild(Mt("picture",{className:"vjs-poster",tabIndex:-1},{},Mt("img",{loading:"lazy",crossOrigin:this.crossOrigin()},{alt:""}))),this.$("img").src=e}handleClick(e){this.player_.controls()&&(this.player_.tech(!0)&&this.player_.tech(!0).focus(),this.player_.paused()?Wr(this.player_.play()):this.player_.pause())}}Ox.prototype.crossorigin=Ox.prototype.crossOrigin,Le.registerComponent("PosterImage",Ox);const go="#222",vP="#ccc",Y3={monospace:"monospace",sansSerif:"sans-serif",serif:"serif",monospaceSansSerif:'"Andale Mono", "Lucida Console", monospace',monospaceSerif:'"Courier New", monospace',proportionalSansSerif:"sans-serif",proportionalSerif:"serif",casual:'"Comic Sans MS", Impact, fantasy',script:'"Monotype Corsiva", cursive',smallcaps:'"Andale Mono", "Lucida Console", monospace, sans-serif'};function Fx(r,e){let s;if(r.length===4)s=r[1]+r[1]+r[2]+r[2]+r[3]+r[3];else if(r.length===7)s=r.slice(1);else throw new Error("Invalid color code provided, "+r+"; must be formatted as e.g. #f0e or #f604e2.");return"rgba("+parseInt(s.slice(0,2),16)+","+parseInt(s.slice(2,4),16)+","+parseInt(s.slice(4,6),16)+","+e+")"}function Sl(r,e,s){try{r.style[e]=s}catch{return}}function wP(r){return r?`${r}px`:""}class Z3 extends Le{constructor(e,s,a){super(e,s,a);const h=_=>this.updateDisplay(_),p=_=>{this.updateDisplayOverlay(),this.updateDisplay(_)};e.on("loadstart",_=>this.toggleDisplay(_)),e.on("useractive",h),e.on("userinactive",h),e.on("texttrackchange",h),e.on("loadedmetadata",_=>{this.updateDisplayOverlay(),this.preselectTrack(_)}),e.ready(Ae(this,function(){if(e.tech_&&e.tech_.featuresNativeTextTracks){this.hide();return}e.on("fullscreenchange",p),e.on("playerresize",p);const _=window.screen.orientation||window,w=window.screen.orientation?"change":"orientationchange";_.addEventListener(w,p),e.on("dispose",()=>_.removeEventListener(w,p));const I=this.options_.playerOptions.tracks||[];for(let B=0;B<I.length;B++)this.player_.addRemoteTextTrack(I[B],!0);this.preselectTrack()}))}preselectTrack(){const e={captions:1,subtitles:1},s=this.player_.textTracks(),a=this.player_.cache_.selectedLanguage;let h,p,_;for(let w=0;w<s.length;w++){const I=s[w];a&&a.enabled&&a.language&&a.language===I.language&&I.kind in e?I.kind===a.kind?_=I:_||(_=I):a&&!a.enabled?(_=null,h=null,p=null):I.default&&(I.kind==="descriptions"&&!h?h=I:I.kind in e&&!p&&(p=I))}_?_.mode="showing":p?p.mode="showing":h&&(h.mode="showing")}toggleDisplay(){this.player_.tech_&&this.player_.tech_.featuresNativeTextTracks?this.hide():this.show()}createEl(){return super.createEl("div",{className:"vjs-text-track-display"},{translate:"yes","aria-live":"off","aria-atomic":"true"})}clearDisplay(){typeof window.WebVTT=="function"&&window.WebVTT.processCues(window,[],this.el_)}updateDisplay(){const e=this.player_.textTracks(),s=this.options_.allowMultipleShowingTracks;if(this.clearDisplay(),s){const _=[];for(let w=0;w<e.length;++w){const I=e[w];I.mode==="showing"&&_.push(I)}this.updateForTrack(_);return}let a=null,h=null,p=e.length;for(;p--;){const _=e[p];_.mode==="showing"&&(_.kind==="descriptions"?a=_:h=_)}if(h?(this.getAttribute("aria-live")!=="off"&&this.setAttribute("aria-live","off"),this.updateForTrack(h)):a&&(this.getAttribute("aria-live")!=="assertive"&&this.setAttribute("aria-live","assertive"),this.updateForTrack(a)),!window.CSS.supports("inset","10px")){const _=this.el_,w=_.querySelectorAll(".vjs-text-track-cue"),I=this.player_.controlBar.el_.getBoundingClientRect().height,B=this.player_.el_.getBoundingClientRect().height;_.style="",Sl(_,"position","relative"),Sl(_,"height",B-I+"px"),Sl(_,"top","unset"),Yt?Sl(_,"bottom",B+"px"):Sl(_,"bottom","0px"),w.length>0&&w.forEach(G=>{if(G.style.inset){const se=G.style.inset.split(" ");se.length===3&&Object.assign(G.style,{top:se[0],right:se[1],bottom:se[2],left:"unset"})}})}}updateDisplayOverlay(){if(!this.player_.videoHeight()||!window.CSS.supports("inset-inline: 10px"))return;const e=this.player_.currentWidth(),s=this.player_.currentHeight(),a=e/s,h=this.player_.videoWidth()/this.player_.videoHeight();let p=0,_=0;Math.abs(a-h)>.1&&(a>h?p=Math.round((e-s*h)/2):_=Math.round((s-e/h)/2)),Sl(this.el_,"insetInline",wP(p)),Sl(this.el_,"insetBlock",wP(_))}updateDisplayState(e){const s=this.player_.textTrackSettings.getValues(),a=e.activeCues;let h=a.length;for(;h--;){const p=a[h];if(!p)continue;const _=p.displayState;if(s.color&&(_.firstChild.style.color=s.color),s.textOpacity&&Sl(_.firstChild,"color",Fx(s.color||"#fff",s.textOpacity)),s.backgroundColor&&(_.firstChild.style.backgroundColor=s.backgroundColor),s.backgroundOpacity&&Sl(_.firstChild,"backgroundColor",Fx(s.backgroundColor||"#000",s.backgroundOpacity)),s.windowColor&&(s.windowOpacity?Sl(_,"backgroundColor",Fx(s.windowColor,s.windowOpacity)):_.style.backgroundColor=s.windowColor),s.edgeStyle&&(s.edgeStyle==="dropshadow"?_.firstChild.style.textShadow=`2px 2px 3px ${go}, 2px 2px 4px ${go}, 2px 2px 5px ${go}`:s.edgeStyle==="raised"?_.firstChild.style.textShadow=`1px 1px ${go}, 2px 2px ${go}, 3px 3px ${go}`:s.edgeStyle==="depressed"?_.firstChild.style.textShadow=`1px 1px ${vP}, 0 1px ${vP}, -1px -1px ${go}, 0 -1px ${go}`:s.edgeStyle==="uniform"&&(_.firstChild.style.textShadow=`0 0 4px ${go}, 0 0 4px ${go}, 0 0 4px ${go}, 0 0 4px ${go}`)),s.fontPercent&&s.fontPercent!==1){const w=window.parseFloat(_.style.fontSize);_.style.fontSize=w*s.fontPercent+"px",_.style.height="auto",_.style.top="auto"}s.fontFamily&&s.fontFamily!=="default"&&(s.fontFamily==="small-caps"?_.firstChild.style.fontVariant="small-caps":_.firstChild.style.fontFamily=Y3[s.fontFamily])}}updateForTrack(e){if(Array.isArray(e)||(e=[e]),typeof window.WebVTT!="function"||e.every(a=>!a.activeCues))return;const s=[];for(let a=0;a<e.length;++a){const h=e[a];for(let p=0;p<h.activeCues.length;++p)s.push(h.activeCues[p])}window.WebVTT.processCues(window,s,this.el_);for(let a=0;a<e.length;++a){const h=e[a];for(let p=0;p<h.activeCues.length;++p){const _=h.activeCues[p].displayState;qs(_,"vjs-text-track-cue","vjs-text-track-cue-"+(h.language?h.language:a)),h.language&&Xe(_,"lang",h.language)}this.player_.textTrackSettings&&this.updateDisplayState(h)}}}Le.registerComponent("TextTrackDisplay",Z3);class Q3 extends Le{createEl(){const e=this.player_.isAudio(),s=this.localize(e?"Audio Player":"Video Player"),a=Mt("span",{className:"vjs-control-text",textContent:this.localize("{1} is loading.",[s])}),h=super.createEl("div",{className:"vjs-loading-spinner",dir:"ltr"});return h.appendChild(a),h}handleLanguagechange(){this.$(".vjs-control-text").textContent=this.localize("{1} is loading.",[this.player_.isAudio()?"Audio Player":"Video Player"])}}Le.registerComponent("LoadingSpinner",Q3);class Nr extends xT{createEl(e,s={},a={}){e="button",s=Object.assign({className:this.buildCSSClass()},s),a=Object.assign({type:"button"},a);const h=Mt(e,s,a);return this.player_.options_.experimentalSvgIcons||h.appendChild(Mt("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),this.createControlTextEl(h),h}addChild(e,s={}){const a=this.constructor.name;return P.warn(`Adding an actionable (user controllable) child to a Button (${a}) is not supported; use a ClickableComponent instead.`),Le.prototype.addChild.call(this,e,s)}enable(){super.enable(),this.el_.removeAttribute("disabled")}disable(){super.disable(),this.el_.setAttribute("disabled","disabled")}handleKeyDown(e){if(e.key===" "||e.key==="Enter"){e.stopPropagation();return}super.handleKeyDown(e)}}Le.registerComponent("Button",Nr);class TP extends Nr{constructor(e,s){super(e,s),this.mouseused_=!1,this.setIcon("play"),this.on("mousedown",a=>this.handleMouseDown(a))}buildCSSClass(){return"vjs-big-play-button"}handleClick(e){const s=this.player_.play();if(e.type==="tap"||this.mouseused_&&"clientX"in e&&"clientY"in e){Wr(s),this.player_.tech(!0)&&this.player_.tech(!0).focus();return}const a=this.player_.getChild("controlBar"),h=a&&a.getChild("playToggle");if(!h){this.player_.tech(!0).focus();return}const p=()=>h.focus();ho(s)?s.then(p,()=>{}):this.setTimeout(p,1)}handleKeyDown(e){this.mouseused_=!1,super.handleKeyDown(e)}handleMouseDown(e){this.mouseused_=!0}}TP.prototype.controlText_="Play Video",Le.registerComponent("BigPlayButton",TP);class J3 extends Nr{constructor(e,s){super(e,s),this.setIcon("cancel"),this.controlText(s&&s.controlText||this.localize("Close"))}buildCSSClass(){return`vjs-close-button ${super.buildCSSClass()}`}handleClick(e){this.trigger({type:"close",bubbles:!1})}handleKeyDown(e){e.key==="Escape"?(e.preventDefault(),e.stopPropagation(),this.trigger("click")):super.handleKeyDown(e)}}Le.registerComponent("CloseButton",J3);class EP extends Nr{constructor(e,s={}){super(e,s),s.replay=s.replay===void 0||s.replay,this.setIcon("play"),this.on(e,"play",a=>this.handlePlay(a)),this.on(e,"pause",a=>this.handlePause(a)),s.replay&&this.on(e,"ended",a=>this.handleEnded(a))}buildCSSClass(){return`vjs-play-control ${super.buildCSSClass()}`}handleClick(e){this.player_.paused()?Wr(this.player_.play()):this.player_.pause()}handleSeeked(e){this.removeClass("vjs-ended"),this.player_.paused()?this.handlePause(e):this.handlePlay(e)}handlePlay(e){this.removeClass("vjs-ended","vjs-paused"),this.addClass("vjs-playing"),this.setIcon("pause"),this.controlText("Pause")}handlePause(e){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.setIcon("play"),this.controlText("Play")}handleEnded(e){this.removeClass("vjs-playing"),this.addClass("vjs-ended"),this.setIcon("replay"),this.controlText("Replay"),this.one(this.player_,"seeked",s=>this.handleSeeked(s))}}EP.prototype.controlText_="Play",Le.registerComponent("PlayToggle",EP);class gg extends Le{constructor(e,s){super(e,s),this.on(e,["timeupdate","ended","seeking"],a=>this.update(a)),this.updateTextNode_()}createEl(){const e=this.buildCSSClass(),s=super.createEl("div",{className:`${e} vjs-time-control vjs-control`}),a=Mt("span",{className:"vjs-control-text",textContent:`${this.localize(this.labelText_)}Â `},{role:"presentation"});return s.appendChild(a),this.contentEl_=Mt("span",{className:`${e}-display`},{role:"presentation"}),s.appendChild(this.contentEl_),s}dispose(){this.contentEl_=null,this.textNode_=null,super.dispose()}update(e){!this.player_.options_.enableSmoothSeeking&&e.type==="seeking"||this.updateContent(e)}updateTextNode_(e=0){e=xn(e),this.formattedTime_!==e&&(this.formattedTime_=e,this.requestNamedAnimationFrame("TimeDisplay#updateTextNode_",()=>{if(!this.contentEl_)return;let s=this.textNode_;s&&this.contentEl_.firstChild!==s&&(s=null,P.warn("TimeDisplay#updateTextnode_: Prevented replacement of text node element since it was no longer a child of this node. Appending a new node instead.")),this.textNode_=document.createTextNode(this.formattedTime_),this.textNode_&&(s?this.contentEl_.replaceChild(this.textNode_,s):this.contentEl_.appendChild(this.textNode_))}))}updateContent(e){}}gg.prototype.labelText_="Time",gg.prototype.controlText_="Time",Le.registerComponent("TimeDisplay",gg);class Bx extends gg{buildCSSClass(){return"vjs-current-time"}updateContent(e){let s;this.player_.ended()?s=this.player_.duration():e&&e.target&&typeof e.target.pendingSeekTime=="function"?s=e.target.pendingSeekTime():s=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime(),this.updateTextNode_(s)}}Bx.prototype.labelText_="Current Time",Bx.prototype.controlText_="Current Time",Le.registerComponent("CurrentTimeDisplay",Bx);class Ux extends gg{constructor(e,s){super(e,s);const a=h=>this.updateContent(h);this.on(e,"durationchange",a),this.on(e,"loadstart",a),this.on(e,"loadedmetadata",a)}buildCSSClass(){return"vjs-duration"}updateContent(e){const s=this.player_.duration();this.updateTextNode_(s)}}Ux.prototype.labelText_="Duration",Ux.prototype.controlText_="Duration",Le.registerComponent("DurationDisplay",Ux);class e4 extends Le{createEl(){const e=super.createEl("div",{className:"vjs-time-control vjs-time-divider"},{"aria-hidden":!0}),s=super.createEl("div"),a=super.createEl("span",{textContent:"/"});return s.appendChild(a),e.appendChild(s),e}}Le.registerComponent("TimeDivider",e4);class jx extends gg{constructor(e,s){super(e,s),this.on(e,"durationchange",a=>this.updateContent(a))}buildCSSClass(){return"vjs-remaining-time"}createEl(){const e=super.createEl();return this.options_.displayNegative!==!1&&e.insertBefore(Mt("span",{},{"aria-hidden":!0},"-"),this.contentEl_),e}updateContent(e){if(typeof this.player_.duration()!="number")return;let s;this.player_.ended()?s=0:this.player_.remainingTimeDisplay?s=this.player_.remainingTimeDisplay():s=this.player_.remainingTime(),this.updateTextNode_(s)}}jx.prototype.labelText_="Remaining Time",jx.prototype.controlText_="Remaining Time",Le.registerComponent("RemainingTimeDisplay",jx);class t4 extends Le{constructor(e,s){super(e,s),this.updateShowing(),this.on(this.player(),"durationchange",a=>this.updateShowing(a))}createEl(){const e=super.createEl("div",{className:"vjs-live-control vjs-control"});return this.contentEl_=Mt("div",{className:"vjs-live-display"},{"aria-live":"off"}),this.contentEl_.appendChild(Mt("span",{className:"vjs-control-text",textContent:`${this.localize("Stream Type")}Â `})),this.contentEl_.appendChild(document.createTextNode(this.localize("LIVE"))),e.appendChild(this.contentEl_),e}dispose(){this.contentEl_=null,super.dispose()}updateShowing(e){this.player().duration()===1/0?this.show():this.hide()}}Le.registerComponent("LiveDisplay",t4);class SP extends Nr{constructor(e,s){super(e,s),this.updateLiveEdgeStatus(),this.player_.liveTracker&&(this.updateLiveEdgeStatusHandler_=a=>this.updateLiveEdgeStatus(a),this.on(this.player_.liveTracker,"liveedgechange",this.updateLiveEdgeStatusHandler_))}createEl(){const e=super.createEl("button",{className:"vjs-seek-to-live-control vjs-control"});return this.setIcon("circle",e),this.textEl_=Mt("span",{className:"vjs-seek-to-live-text",textContent:this.localize("LIVE")},{"aria-hidden":"true"}),e.appendChild(this.textEl_),e}updateLiveEdgeStatus(){!this.player_.liveTracker||this.player_.liveTracker.atLiveEdge()?(this.setAttribute("aria-disabled",!0),this.addClass("vjs-at-live-edge"),this.controlText("Seek to live, currently playing live")):(this.setAttribute("aria-disabled",!1),this.removeClass("vjs-at-live-edge"),this.controlText("Seek to live, currently behind live"))}handleClick(){this.player_.liveTracker.seekToLiveEdge()}dispose(){this.player_.liveTracker&&this.off(this.player_.liveTracker,"liveedgechange",this.updateLiveEdgeStatusHandler_),this.textEl_=null,super.dispose()}}SP.prototype.controlText_="Seek to live, currently playing live",Le.registerComponent("SeekToLive",SP);function x_(r,e,s){return r=Number(r),Math.min(s,Math.max(e,isNaN(r)?e:r))}var i4=Object.freeze({__proto__:null,clamp:x_});class Hx extends Le{constructor(e,s){super(e,s),this.handleMouseDown_=a=>this.handleMouseDown(a),this.handleMouseUp_=a=>this.handleMouseUp(a),this.handleKeyDown_=a=>this.handleKeyDown(a),this.handleClick_=a=>this.handleClick(a),this.handleMouseMove_=a=>this.handleMouseMove(a),this.update_=a=>this.update(a),this.bar=this.getChild(this.options_.barName),this.vertical(!!this.options_.vertical),this.enable()}enabled(){return this.enabled_}enable(){this.enabled()||(this.on("mousedown",this.handleMouseDown_),this.on("touchstart",this.handleMouseDown_),this.on("keydown",this.handleKeyDown_),this.on("click",this.handleClick_),this.on(this.player_,"controlsvisible",this.update),this.playerEvent&&this.on(this.player_,this.playerEvent,this.update),this.removeClass("disabled"),this.setAttribute("tabindex",0),this.enabled_=!0)}disable(){if(!this.enabled())return;const e=this.bar.el_.ownerDocument;this.off("mousedown",this.handleMouseDown_),this.off("touchstart",this.handleMouseDown_),this.off("keydown",this.handleKeyDown_),this.off("click",this.handleClick_),this.off(this.player_,"controlsvisible",this.update_),this.off(e,"mousemove",this.handleMouseMove_),this.off(e,"mouseup",this.handleMouseUp_),this.off(e,"touchmove",this.handleMouseMove_),this.off(e,"touchend",this.handleMouseUp_),this.removeAttribute("tabindex"),this.addClass("disabled"),this.playerEvent&&this.off(this.player_,this.playerEvent,this.update),this.enabled_=!1}createEl(e,s={},a={}){return s.className=s.className+" vjs-slider",s=Object.assign({tabIndex:0},s),a=Object.assign({role:"slider","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100},a),super.createEl(e,s,a)}handleMouseDown(e){const s=this.bar.el_.ownerDocument;e.type==="mousedown"&&e.preventDefault(),e.type==="touchstart"&&!$e&&e.preventDefault(),ft(),this.addClass("vjs-sliding"),this.trigger("slideractive"),this.on(s,"mousemove",this.handleMouseMove_),this.on(s,"mouseup",this.handleMouseUp_),this.on(s,"touchmove",this.handleMouseMove_),this.on(s,"touchend",this.handleMouseUp_),this.handleMouseMove(e,!0)}handleMouseMove(e){}handleMouseUp(e){const s=this.bar.el_.ownerDocument;wt(),this.removeClass("vjs-sliding"),this.trigger("sliderinactive"),this.off(s,"mousemove",this.handleMouseMove_),this.off(s,"mouseup",this.handleMouseUp_),this.off(s,"touchmove",this.handleMouseMove_),this.off(s,"touchend",this.handleMouseUp_),this.update()}update(){if(!this.el_||!this.bar)return;const e=this.getProgress();return e===this.progress_||(this.progress_=e,this.requestNamedAnimationFrame("Slider#update",()=>{const s=this.vertical()?"height":"width";this.bar.el().style[s]=(e*100).toFixed(2)+"%"})),e}getProgress(){return Number(x_(this.getPercent(),0,1).toFixed(4))}calculateDistance(e){const s=et(this.el_,e);return this.vertical()?s.y:s.x}handleKeyDown(e){const s=this.options_.playerOptions.spatialNavigation,a=s&&s.enabled,h=s&&s.horizontalSeek;a?h&&e.key==="ArrowLeft"||!h&&e.key==="ArrowDown"?(e.preventDefault(),e.stopPropagation(),this.stepBack()):h&&e.key==="ArrowRight"||!h&&e.key==="ArrowUp"?(e.preventDefault(),e.stopPropagation(),this.stepForward()):(this.pendingSeekTime()&&(this.pendingSeekTime(null),this.userSeek_(this.player_.currentTime())),super.handleKeyDown(e)):e.key==="ArrowLeft"||e.key==="ArrowDown"?(e.preventDefault(),e.stopPropagation(),this.stepBack()):e.key==="ArrowUp"||e.key==="ArrowRight"?(e.preventDefault(),e.stopPropagation(),this.stepForward()):super.handleKeyDown(e)}handleClick(e){e.stopPropagation(),e.preventDefault()}vertical(e){if(e===void 0)return this.vertical_||!1;this.vertical_=!!e,this.vertical_?this.addClass("vjs-slider-vertical"):this.addClass("vjs-slider-horizontal")}}Le.registerComponent("Slider",Hx);const Vx=(r,e)=>x_(r/e*100,0,100).toFixed(2)+"%";class s4 extends Le{constructor(e,s){super(e,s),this.partEls_=[],this.on(e,"progress",a=>this.update(a))}createEl(){const e=super.createEl("div",{className:"vjs-load-progress"}),s=Mt("span",{className:"vjs-control-text"}),a=Mt("span",{textContent:this.localize("Loaded")}),h=document.createTextNode(": ");return this.percentageEl_=Mt("span",{className:"vjs-control-text-loaded-percentage",textContent:"0%"}),e.appendChild(s),s.appendChild(a),s.appendChild(h),s.appendChild(this.percentageEl_),e}dispose(){this.partEls_=null,this.percentageEl_=null,super.dispose()}update(e){this.requestNamedAnimationFrame("LoadProgressBar#update",()=>{const s=this.player_.liveTracker,a=this.player_.buffered(),h=s&&s.isLive()?s.seekableEnd():this.player_.duration(),p=this.player_.bufferedEnd(),_=this.partEls_,w=Vx(p,h);this.percent_!==w&&(this.el_.style.width=w,Mi(this.percentageEl_,w),this.percent_=w);for(let I=0;I<a.length;I++){const B=a.start(I),G=a.end(I);let se=_[I];se||(se=this.el_.appendChild(Mt()),_[I]=se),!(se.dataset.start===B&&se.dataset.end===G)&&(se.dataset.start=B,se.dataset.end=G,se.style.left=Vx(B,p),se.style.width=Vx(G-B,p))}for(let I=_.length;I>a.length;I--)this.el_.removeChild(_[I-1]);_.length=a.length})}}Le.registerComponent("LoadProgressBar",s4);class n4 extends Le{constructor(e,s){super(e,s),this.update=nt(Ae(this,this.update),Ce)}createEl(){return super.createEl("div",{className:"vjs-time-tooltip"},{"aria-hidden":"true"})}update(e,s,a){const h=oe(this.el_),p=$t(this.player_.el()),_=e.width*s;if(!p||!h)return;let w=e.left-p.left+_,I=e.width-_+(p.right-e.right);I||(I=e.width-_,w=_);let B=h.width/2;w<B?B+=B-w:I<B&&(B=I),B<0?B=0:B>h.width&&(B=h.width),B=Math.round(B),this.el_.style.right=`-${B}px`,this.write(a)}write(e){Mi(this.el_,e)}updateTime(e,s,a,h){this.requestNamedAnimationFrame("TimeTooltip#updateTime",()=>{let p;const _=this.player_.duration();if(this.player_.liveTracker&&this.player_.liveTracker.isLive()){const w=this.player_.liveTracker.liveWindow(),I=w-s*w;p=(I<1?"":"-")+xn(I,w)}else p=xn(a,_);this.update(e,s,p),h&&h()})}}Le.registerComponent("TimeTooltip",n4);class $x extends Le{constructor(e,s){super(e,s),this.setIcon("circle"),this.update=nt(Ae(this,this.update),Ce)}createEl(){return super.createEl("div",{className:"vjs-play-progress vjs-slider-bar"},{"aria-hidden":"true"})}update(e,s,a){const h=this.getChild("timeTooltip");if(!h)return;const p=a&&a.target&&typeof a.target.pendingSeekTime=="function"?a.target.pendingSeekTime():this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();h.updateTime(e,s,p)}}$x.prototype.options_={children:[]},!hi&&!Oe&&$x.prototype.options_.children.push("timeTooltip"),Le.registerComponent("PlayProgressBar",$x);class xP extends Le{constructor(e,s){super(e,s),this.update=nt(Ae(this,this.update),Ce)}createEl(){return super.createEl("div",{className:"vjs-mouse-display"})}update(e,s){const a=s*this.player_.duration();this.getChild("timeTooltip").updateTime(e,s,a,()=>{this.el_.style.left=`${e.width*s}px`})}}xP.prototype.options_={children:["timeTooltip"]},Le.registerComponent("MouseTimeDisplay",xP);class AT extends Hx{constructor(e,s){s=ee(AT.prototype.options_,s),s.children=[...s.children];const a=e.options_.disableSeekWhileScrubbingOnMobile&&(hi||Oe)||e.options_.disableSeekWhileScrubbingOnSTV;(!hi&&!Oe||a)&&s.children.splice(1,0,"mouseTimeDisplay"),super(e,s),this.shouldDisableSeekWhileScrubbing_=a,this.pendingSeekTime_=null,this.setEventHandlers_()}setEventHandlers_(){this.update_=Ae(this,this.update),this.update=nt(this.update_,Ce),this.on(this.player_,["durationchange","timeupdate"],this.update),this.on(this.player_,["ended"],this.update_),this.player_.liveTracker&&this.on(this.player_.liveTracker,"liveedgechange",this.update),this.updateInterval=null,this.enableIntervalHandler_=e=>this.enableInterval_(e),this.disableIntervalHandler_=e=>this.disableInterval_(e),this.on(this.player_,["playing"],this.enableIntervalHandler_),this.on(this.player_,["ended","pause","waiting"],this.disableIntervalHandler_),"hidden"in document&&"visibilityState"in document&&this.on(document,"visibilitychange",this.toggleVisibility_)}toggleVisibility_(e){document.visibilityState==="hidden"?(this.cancelNamedAnimationFrame("SeekBar#update"),this.cancelNamedAnimationFrame("Slider#update"),this.disableInterval_(e)):(!this.player_.ended()&&!this.player_.paused()&&this.enableInterval_(),this.update())}enableInterval_(){this.updateInterval||(this.updateInterval=this.setInterval(this.update,Ce))}disableInterval_(e){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&e&&e.type!=="ended"||this.updateInterval&&(this.clearInterval(this.updateInterval),this.updateInterval=null)}createEl(){return super.createEl("div",{className:"vjs-progress-holder"},{"aria-label":this.localize("Progress Bar")})}update(e){if(document.visibilityState==="hidden")return;const s=super.update();return this.requestNamedAnimationFrame("SeekBar#update",()=>{const a=this.player_.ended()?this.player_.duration():this.getCurrentTime_(),h=this.player_.liveTracker;let p=this.player_.duration();h&&h.isLive()&&(p=this.player_.liveTracker.liveCurrentTime()),this.percent_!==s&&(this.el_.setAttribute("aria-valuenow",(s*100).toFixed(2)),this.percent_=s),(this.currentTime_!==a||this.duration_!==p)&&(this.el_.setAttribute("aria-valuetext",this.localize("progress bar timing: currentTime={1} duration={2}",[xn(a,p),xn(p,p)],"{1} of {2}")),this.currentTime_=a,this.duration_=p),this.bar&&this.bar.update($t(this.el()),this.getProgress(),e)}),s}userSeek_(e){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&this.player_.liveTracker.nextSeekedFromUser(),this.player_.currentTime(e)}getCurrentTime_(){return this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime()}pendingSeekTime(e){if(e!==void 0)if(e!==null){const s=this.player_.duration();this.pendingSeekTime_=Math.max(0,Math.min(e,s))}else this.pendingSeekTime_=null;return this.pendingSeekTime_}getPercent(){if(this.pendingSeekTime()!==null)return this.pendingSeekTime()/this.player_.duration();const e=this.getCurrentTime_();let s;const a=this.player_.liveTracker;return a&&a.isLive()?(s=(e-a.seekableStart())/a.liveWindow(),a.atLiveEdge()&&(s=1)):s=e/this.player_.duration(),s}handleMouseDown(e){tt(e)&&(e.stopPropagation(),this.videoWasPlaying=!this.player_.paused(),this.shouldDisableSeekWhileScrubbing_||this.player_.pause(),super.handleMouseDown(e))}handleMouseMove(e,s=!1){if(!tt(e)||isNaN(this.player_.duration()))return;!s&&!this.player_.scrubbing()&&this.player_.scrubbing(!0);let a;const h=this.calculateDistance(e),p=this.player_.liveTracker;if(!p||!p.isLive())a=h*this.player_.duration(),a===this.player_.duration()&&(a=a-.1);else{if(h>=.99){p.seekToLiveEdge();return}const _=p.seekableStart(),w=p.liveCurrentTime();if(a=_+h*p.liveWindow(),a>=w&&(a=w),a<=_&&(a=_+.1),a===1/0)return}this.shouldDisableSeekWhileScrubbing_?this.pendingSeekTime(a):this.userSeek_(a),this.player_.options_.enableSmoothSeeking&&this.update()}enable(){super.enable();const e=this.getChild("mouseTimeDisplay");e&&e.show()}disable(){super.disable();const e=this.getChild("mouseTimeDisplay");e&&e.hide()}handleMouseUp(e){super.handleMouseUp(e),e&&e.stopPropagation(),this.player_.scrubbing(!1),this.pendingSeekTime()!==null&&(this.userSeek_(this.pendingSeekTime()),this.pendingSeekTime(null)),this.player_.trigger({type:"timeupdate",target:this,manuallyTriggered:!0}),this.videoWasPlaying?Wr(this.player_.play()):this.update_()}handlePendingSeek_(e){this.player_.paused()||this.player_.pause();const s=this.pendingSeekTime()!==null?this.pendingSeekTime():this.player_.currentTime();this.pendingSeekTime(s+e),this.player_.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})}stepForward(){this.shouldDisableSeekWhileScrubbing_?this.handlePendingSeek_(this.options().stepSeconds):this.userSeek_(this.player_.currentTime()+this.options().stepSeconds)}stepBack(){this.shouldDisableSeekWhileScrubbing_?this.handlePendingSeek_(-this.options().stepSeconds):this.userSeek_(this.player_.currentTime()-this.options().stepSeconds)}handleAction(e){this.pendingSeekTime()!==null&&(this.userSeek_(this.pendingSeekTime()),this.pendingSeekTime(null)),this.player_.paused()?this.player_.play():this.player_.pause()}handleKeyDown(e){const s=this.player_.liveTracker;if(e.key===" "||e.key==="Enter")e.preventDefault(),e.stopPropagation(),this.handleAction(e);else if(e.key==="Home")e.preventDefault(),e.stopPropagation(),this.userSeek_(0);else if(e.key==="End")e.preventDefault(),e.stopPropagation(),s&&s.isLive()?this.userSeek_(s.liveCurrentTime()):this.userSeek_(this.player_.duration());else if(/^[0-9]$/.test(e.key)){e.preventDefault(),e.stopPropagation();const a=parseInt(e.key,10)*.1;s&&s.isLive()?this.userSeek_(s.seekableStart()+s.liveWindow()*a):this.userSeek_(this.player_.duration()*a)}else e.key==="PageDown"?(e.preventDefault(),e.stopPropagation(),this.userSeek_(this.player_.currentTime()-this.options().stepSeconds*this.options().pageMultiplier)):e.key==="PageUp"?(e.preventDefault(),e.stopPropagation(),this.userSeek_(this.player_.currentTime()+this.options().stepSeconds*this.options().pageMultiplier)):super.handleKeyDown(e)}dispose(){this.disableInterval_(),this.off(this.player_,["durationchange","timeupdate"],this.update),this.off(this.player_,["ended"],this.update_),this.player_.liveTracker&&this.off(this.player_.liveTracker,"liveedgechange",this.update),this.off(this.player_,["playing"],this.enableIntervalHandler_),this.off(this.player_,["ended","pause","waiting"],this.disableIntervalHandler_),"hidden"in document&&"visibilityState"in document&&this.off(document,"visibilitychange",this.toggleVisibility_),super.dispose()}}AT.prototype.options_={children:["loadProgressBar","playProgressBar"],barName:"playProgressBar",stepSeconds:5,pageMultiplier:12},Le.registerComponent("SeekBar",AT);class AP extends Le{constructor(e,s){super(e,s),this.handleMouseMove=nt(Ae(this,this.handleMouseMove),Ce),this.throttledHandleMouseSeek=nt(Ae(this,this.handleMouseSeek),Ce),this.handleMouseUpHandler_=a=>this.handleMouseUp(a),this.handleMouseDownHandler_=a=>this.handleMouseDown(a),this.enable()}createEl(){return super.createEl("div",{className:"vjs-progress-control vjs-control"})}handleMouseMove(e){const s=this.getChild("seekBar");if(!s)return;const a=s.getChild("playProgressBar"),h=s.getChild("mouseTimeDisplay");if(!a&&!h)return;const p=s.el(),_=oe(p);let w=et(p,e).x;w=x_(w,0,1),h&&h.update(_,w),a&&a.update(_,s.getProgress())}handleMouseSeek(e){const s=this.getChild("seekBar");s&&s.handleMouseMove(e)}enabled(){return this.enabled_}disable(){if(this.children().forEach(e=>e.disable&&e.disable()),!!this.enabled()&&(this.off(["mousedown","touchstart"],this.handleMouseDownHandler_),this.off(this.el_,["mousemove","touchmove"],this.handleMouseMove),this.removeListenersAddedOnMousedownAndTouchstart(),this.addClass("disabled"),this.enabled_=!1,this.player_.scrubbing())){const e=this.getChild("seekBar");this.player_.scrubbing(!1),e.videoWasPlaying&&Wr(this.player_.play())}}enable(){this.children().forEach(e=>e.enable&&e.enable()),!this.enabled()&&(this.on(["mousedown","touchstart"],this.handleMouseDownHandler_),this.on(this.el_,["mousemove","touchmove"],this.handleMouseMove),this.removeClass("disabled"),this.enabled_=!0)}removeListenersAddedOnMousedownAndTouchstart(){const e=this.el_.ownerDocument;this.off(e,"mousemove",this.throttledHandleMouseSeek),this.off(e,"touchmove",this.throttledHandleMouseSeek),this.off(e,"mouseup",this.handleMouseUpHandler_),this.off(e,"touchend",this.handleMouseUpHandler_)}handleMouseDown(e){const s=this.el_.ownerDocument,a=this.getChild("seekBar");a&&a.handleMouseDown(e),this.on(s,"mousemove",this.throttledHandleMouseSeek),this.on(s,"touchmove",this.throttledHandleMouseSeek),this.on(s,"mouseup",this.handleMouseUpHandler_),this.on(s,"touchend",this.handleMouseUpHandler_)}handleMouseUp(e){const s=this.getChild("seekBar");s&&s.handleMouseUp(e),this.removeListenersAddedOnMousedownAndTouchstart()}}AP.prototype.options_={children:["seekBar"]},Le.registerComponent("ProgressControl",AP);class CP extends Nr{constructor(e,s){super(e,s),this.setIcon("picture-in-picture-enter"),this.on(e,["enterpictureinpicture","leavepictureinpicture"],a=>this.handlePictureInPictureChange(a)),this.on(e,["disablepictureinpicturechanged","loadedmetadata"],a=>this.handlePictureInPictureEnabledChange(a)),this.on(e,["loadedmetadata","audioonlymodechange","audiopostermodechange"],()=>this.handlePictureInPictureAudioModeChange()),this.disable()}buildCSSClass(){return`vjs-picture-in-picture-control vjs-hidden ${super.buildCSSClass()}`}handlePictureInPictureAudioModeChange(){if(!(this.player_.currentType().substring(0,5)==="audio"||this.player_.audioPosterMode()||this.player_.audioOnlyMode())){this.show();return}this.player_.isInPictureInPicture()&&this.player_.exitPictureInPicture(),this.hide()}handlePictureInPictureEnabledChange(){document.pictureInPictureEnabled&&this.player_.disablePictureInPicture()===!1||this.player_.options_.enableDocumentPictureInPicture&&"documentPictureInPicture"in window?this.enable():this.disable()}handlePictureInPictureChange(e){this.player_.isInPictureInPicture()?(this.setIcon("picture-in-picture-exit"),this.controlText("Exit Picture-in-Picture")):(this.setIcon("picture-in-picture-enter"),this.controlText("Picture-in-Picture")),this.handlePictureInPictureEnabledChange()}handleClick(e){this.player_.isInPictureInPicture()?this.player_.exitPictureInPicture():this.player_.requestPictureInPicture()}show(){typeof document.exitPictureInPicture=="function"&&super.show()}}CP.prototype.controlText_="Picture-in-Picture",Le.registerComponent("PictureInPictureToggle",CP);class kP extends Nr{constructor(e,s){super(e,s),this.setIcon("fullscreen-enter"),this.on(e,"fullscreenchange",a=>this.handleFullscreenChange(a)),document[e.fsApi_.fullscreenEnabled]===!1&&this.disable()}buildCSSClass(){return`vjs-fullscreen-control ${super.buildCSSClass()}`}handleFullscreenChange(e){this.player_.isFullscreen()?(this.controlText("Exit Fullscreen"),this.setIcon("fullscreen-exit")):(this.controlText("Fullscreen"),this.setIcon("fullscreen-enter"))}handleClick(e){this.player_.isFullscreen()?this.player_.exitFullscreen():this.player_.requestFullscreen()}}kP.prototype.controlText_="Fullscreen",Le.registerComponent("FullscreenToggle",kP);const r4=function(r,e){e.tech_&&!e.tech_.featuresVolumeControl&&r.addClass("vjs-hidden"),r.on(e,"loadstart",function(){e.tech_.featuresVolumeControl?r.removeClass("vjs-hidden"):r.addClass("vjs-hidden")})};class a4 extends Le{createEl(){const e=super.createEl("div",{className:"vjs-volume-level"});return this.setIcon("circle",e),e.appendChild(super.createEl("span",{className:"vjs-control-text"})),e}}Le.registerComponent("VolumeLevel",a4);class o4 extends Le{constructor(e,s){super(e,s),this.update=nt(Ae(this,this.update),Ce)}createEl(){return super.createEl("div",{className:"vjs-volume-tooltip"},{"aria-hidden":"true"})}update(e,s,a,h){if(!a){const p=$t(this.el_),_=$t(this.player_.el()),w=e.width*s;if(!_||!p)return;const I=e.left-_.left+w,B=e.width-w+(_.right-e.right);let G=p.width/2;I<G?G+=G-I:B<G&&(G=B),G<0?G=0:G>p.width&&(G=p.width),this.el_.style.right=`-${G}px`}this.write(`${h}%`)}write(e){Mi(this.el_,e)}updateVolume(e,s,a,h,p){this.requestNamedAnimationFrame("VolumeLevelTooltip#updateVolume",()=>{this.update(e,s,a,h.toFixed(0)),p&&p()})}}Le.registerComponent("VolumeLevelTooltip",o4);class PP extends Le{constructor(e,s){super(e,s),this.update=nt(Ae(this,this.update),Ce)}createEl(){return super.createEl("div",{className:"vjs-mouse-display"})}update(e,s,a){const h=100*s;this.getChild("volumeLevelTooltip").updateVolume(e,s,a,h,()=>{a?this.el_.style.bottom=`${e.height*s}px`:this.el_.style.left=`${e.width*s}px`})}}PP.prototype.options_={children:["volumeLevelTooltip"]},Le.registerComponent("MouseVolumeLevelDisplay",PP);class CT extends Hx{constructor(e,s){super(e,s),this.on("slideractive",a=>this.updateLastVolume_(a)),this.on(e,"volumechange",a=>this.updateARIAAttributes(a)),e.ready(()=>this.updateARIAAttributes())}createEl(){return super.createEl("div",{className:"vjs-volume-bar vjs-slider-bar"},{"aria-label":this.localize("Volume Level"),"aria-live":"polite"})}handleMouseDown(e){tt(e)&&super.handleMouseDown(e)}handleMouseMove(e){const s=this.getChild("mouseVolumeLevelDisplay");if(s){const a=this.el(),h=$t(a),p=this.vertical();let _=et(a,e);_=p?_.y:_.x,_=x_(_,0,1),s.update(h,_,p)}tt(e)&&(this.checkMuted(),this.player_.volume(this.calculateDistance(e)))}checkMuted(){this.player_.muted()&&this.player_.muted(!1)}getPercent(){return this.player_.muted()?0:this.player_.volume()}stepForward(){this.checkMuted(),this.player_.volume(this.player_.volume()+.1)}stepBack(){this.checkMuted(),this.player_.volume(this.player_.volume()-.1)}updateARIAAttributes(e){const s=this.player_.muted()?0:this.volumeAsPercentage_();this.el_.setAttribute("aria-valuenow",s),this.el_.setAttribute("aria-valuetext",s+"%")}volumeAsPercentage_(){return Math.round(this.player_.volume()*100)}updateLastVolume_(){const e=this.player_.volume();this.one("sliderinactive",()=>{this.player_.volume()===0&&this.player_.lastVolume_(e)})}}CT.prototype.options_={children:["volumeLevel"],barName:"volumeLevel"},!hi&&!Oe&&CT.prototype.options_.children.splice(0,0,"mouseVolumeLevelDisplay"),CT.prototype.playerEvent="volumechange",Le.registerComponent("VolumeBar",CT);class DP extends Le{constructor(e,s={}){s.vertical=s.vertical||!1,(typeof s.volumeBar>"u"||te(s.volumeBar))&&(s.volumeBar=s.volumeBar||{},s.volumeBar.vertical=s.vertical),super(e,s),r4(this,e),this.throttledHandleMouseMove=nt(Ae(this,this.handleMouseMove),Ce),this.handleMouseUpHandler_=a=>this.handleMouseUp(a),this.on("mousedown",a=>this.handleMouseDown(a)),this.on("touchstart",a=>this.handleMouseDown(a)),this.on("mousemove",a=>this.handleMouseMove(a)),this.on(this.volumeBar,["focus","slideractive"],()=>{this.volumeBar.addClass("vjs-slider-active"),this.addClass("vjs-slider-active"),this.trigger("slideractive")}),this.on(this.volumeBar,["blur","sliderinactive"],()=>{this.volumeBar.removeClass("vjs-slider-active"),this.removeClass("vjs-slider-active"),this.trigger("sliderinactive")})}createEl(){let e="vjs-volume-horizontal";return this.options_.vertical&&(e="vjs-volume-vertical"),super.createEl("div",{className:`vjs-volume-control vjs-control ${e}`})}handleMouseDown(e){const s=this.el_.ownerDocument;this.on(s,"mousemove",this.throttledHandleMouseMove),this.on(s,"touchmove",this.throttledHandleMouseMove),this.on(s,"mouseup",this.handleMouseUpHandler_),this.on(s,"touchend",this.handleMouseUpHandler_)}handleMouseUp(e){const s=this.el_.ownerDocument;this.off(s,"mousemove",this.throttledHandleMouseMove),this.off(s,"touchmove",this.throttledHandleMouseMove),this.off(s,"mouseup",this.handleMouseUpHandler_),this.off(s,"touchend",this.handleMouseUpHandler_)}handleMouseMove(e){this.volumeBar.handleMouseMove(e)}}DP.prototype.options_={children:["volumeBar"]},Le.registerComponent("VolumeControl",DP);const l4=function(r,e){e.tech_&&!e.tech_.featuresMuteControl&&r.addClass("vjs-hidden"),r.on(e,"loadstart",function(){e.tech_.featuresMuteControl?r.removeClass("vjs-hidden"):r.addClass("vjs-hidden")})};class IP extends Nr{constructor(e,s){super(e,s),l4(this,e),this.on(e,["loadstart","volumechange"],a=>this.update(a))}buildCSSClass(){return`vjs-mute-control ${super.buildCSSClass()}`}handleClick(e){const s=this.player_.volume(),a=this.player_.lastVolume_();if(s===0){const h=a<.1?.1:a;this.player_.volume(h),this.player_.muted(!1)}else this.player_.muted(!this.player_.muted())}update(e){this.updateIcon_(),this.updateControlText_()}updateIcon_(){const e=this.player_.volume();let s=3;this.setIcon("volume-high"),hi&&this.player_.tech_&&this.player_.tech_.el_&&this.player_.muted(this.player_.tech_.el_.muted),e===0||this.player_.muted()?(this.setIcon("volume-mute"),s=0):e<.33?(this.setIcon("volume-low"),s=1):e<.67&&(this.setIcon("volume-medium"),s=2),Bt(this.el_,[0,1,2,3].reduce((a,h)=>a+`${h?" ":""}vjs-vol-${h}`,"")),qs(this.el_,`vjs-vol-${s}`)}updateControlText_(){const s=this.player_.muted()||this.player_.volume()===0?"Unmute":"Mute";this.controlText()!==s&&this.controlText(s)}}IP.prototype.controlText_="Mute",Le.registerComponent("MuteToggle",IP);class LP extends Le{constructor(e,s={}){typeof s.inline<"u"?s.inline=s.inline:s.inline=!0,(typeof s.volumeControl>"u"||te(s.volumeControl))&&(s.volumeControl=s.volumeControl||{},s.volumeControl.vertical=!s.inline),super(e,s),this.handleKeyPressHandler_=a=>this.handleKeyPress(a),this.on(e,["loadstart"],a=>this.volumePanelState_(a)),this.on(this.muteToggle,"keyup",a=>this.handleKeyPress(a)),this.on(this.volumeControl,"keyup",a=>this.handleVolumeControlKeyUp(a)),this.on("keydown",a=>this.handleKeyPress(a)),this.on("mouseover",a=>this.handleMouseOver(a)),this.on("mouseout",a=>this.handleMouseOut(a)),this.on(this.volumeControl,["slideractive"],this.sliderActive_),this.on(this.volumeControl,["sliderinactive"],this.sliderInactive_)}sliderActive_(){this.addClass("vjs-slider-active")}sliderInactive_(){this.removeClass("vjs-slider-active")}volumePanelState_(){this.volumeControl.hasClass("vjs-hidden")&&this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-hidden"),this.volumeControl.hasClass("vjs-hidden")&&!this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-mute-toggle-only")}createEl(){let e="vjs-volume-panel-horizontal";return this.options_.inline||(e="vjs-volume-panel-vertical"),super.createEl("div",{className:`vjs-volume-panel vjs-control ${e}`})}dispose(){this.handleMouseOut(),super.dispose()}handleVolumeControlKeyUp(e){e.key==="Escape"&&this.muteToggle.focus()}handleMouseOver(e){this.addClass("vjs-hover"),_s(document,"keyup",this.handleKeyPressHandler_)}handleMouseOut(e){this.removeClass("vjs-hover"),ss(document,"keyup",this.handleKeyPressHandler_)}handleKeyPress(e){e.key==="Escape"&&this.handleMouseOut()}}LP.prototype.options_={children:["muteToggle","volumeControl"]},Le.registerComponent("VolumePanel",LP);class NP extends Nr{constructor(e,s){super(e,s),this.validOptions=[5,10,30],this.skipTime=this.getSkipForwardTime(),this.skipTime&&this.validOptions.includes(this.skipTime)?(this.setIcon(`forward-${this.skipTime}`),this.controlText(this.localize("Skip forward {1} seconds",[this.skipTime.toLocaleString(e.language())])),this.show()):this.hide()}getSkipForwardTime(){const e=this.options_.playerOptions;return e.controlBar&&e.controlBar.skipButtons&&e.controlBar.skipButtons.forward}buildCSSClass(){return`vjs-skip-forward-${this.getSkipForwardTime()} ${super.buildCSSClass()}`}handleClick(e){if(isNaN(this.player_.duration()))return;const s=this.player_.currentTime(),a=this.player_.liveTracker,h=a&&a.isLive()?a.seekableEnd():this.player_.duration();let p;s+this.skipTime<=h?p=s+this.skipTime:p=h,this.player_.currentTime(p)}handleLanguagechange(){this.controlText(this.localize("Skip forward {1} seconds",[this.skipTime]))}}NP.prototype.controlText_="Skip Forward",Le.registerComponent("SkipForward",NP);class RP extends Nr{constructor(e,s){super(e,s),this.validOptions=[5,10,30],this.skipTime=this.getSkipBackwardTime(),this.skipTime&&this.validOptions.includes(this.skipTime)?(this.setIcon(`replay-${this.skipTime}`),this.controlText(this.localize("Skip backward {1} seconds",[this.skipTime.toLocaleString(e.language())])),this.show()):this.hide()}getSkipBackwardTime(){const e=this.options_.playerOptions;return e.controlBar&&e.controlBar.skipButtons&&e.controlBar.skipButtons.backward}buildCSSClass(){return`vjs-skip-backward-${this.getSkipBackwardTime()} ${super.buildCSSClass()}`}handleClick(e){const s=this.player_.currentTime(),a=this.player_.liveTracker,h=a&&a.isLive()&&a.seekableStart();let p;h&&s-this.skipTime<=h?p=h:s>=this.skipTime?p=s-this.skipTime:p=0,this.player_.currentTime(p)}handleLanguagechange(){this.controlText(this.localize("Skip backward {1} seconds",[this.skipTime]))}}RP.prototype.controlText_="Skip Backward",Le.registerComponent("SkipBackward",RP);class MP extends Le{constructor(e,s){super(e,s),s&&(this.menuButton_=s.menuButton),this.focusedChild_=-1,this.on("keydown",a=>this.handleKeyDown(a)),this.boundHandleBlur_=a=>this.handleBlur(a),this.boundHandleTapClick_=a=>this.handleTapClick(a)}addEventListenerForItem(e){e instanceof Le&&(this.on(e,"blur",this.boundHandleBlur_),this.on(e,["tap","click"],this.boundHandleTapClick_))}removeEventListenerForItem(e){e instanceof Le&&(this.off(e,"blur",this.boundHandleBlur_),this.off(e,["tap","click"],this.boundHandleTapClick_))}removeChild(e){typeof e=="string"&&(e=this.getChild(e)),this.removeEventListenerForItem(e),super.removeChild(e)}addItem(e){const s=this.addChild(e);s&&this.addEventListenerForItem(s)}createEl(){const e=this.options_.contentElType||"ul";this.contentEl_=Mt(e,{className:"vjs-menu-content"}),this.contentEl_.setAttribute("role","menu");const s=super.createEl("div",{append:this.contentEl_,className:"vjs-menu"});return s.appendChild(this.contentEl_),_s(s,"click",function(a){a.preventDefault(),a.stopImmediatePropagation()}),s}dispose(){this.contentEl_=null,this.boundHandleBlur_=null,this.boundHandleTapClick_=null,super.dispose()}handleBlur(e){const s=e.relatedTarget||document.activeElement;if(!this.children().some(a=>a.el()===s)){const a=this.menuButton_;a&&a.buttonPressed_&&s!==a.el().firstChild&&a.unpressButton()}}handleTapClick(e){if(this.menuButton_){this.menuButton_.unpressButton();const s=this.children();if(!Array.isArray(s))return;const a=s.filter(h=>h.el()===e.target)[0];if(!a)return;a.name()!=="CaptionSettingsMenuItem"&&this.menuButton_.focus()}}handleKeyDown(e){e.key==="ArrowLeft"||e.key==="ArrowDown"?(e.preventDefault(),e.stopPropagation(),this.stepForward()):(e.key==="ArrowRight"||e.key==="ArrowUp")&&(e.preventDefault(),e.stopPropagation(),this.stepBack())}stepForward(){let e=0;this.focusedChild_!==void 0&&(e=this.focusedChild_+1),this.focus(e)}stepBack(){let e=0;this.focusedChild_!==void 0&&(e=this.focusedChild_-1),this.focus(e)}focus(e=0){const s=this.children().slice();s.length&&s[0].hasClass("vjs-menu-title")&&s.shift(),s.length>0&&(e<0?e=0:e>=s.length&&(e=s.length-1),this.focusedChild_=e,s[e].el_.focus())}}Le.registerComponent("Menu",MP);class zx extends Le{constructor(e,s={}){super(e,s),this.menuButton_=new Nr(e,s),this.menuButton_.controlText(this.controlText_),this.menuButton_.el_.setAttribute("aria-haspopup","true");const a=Nr.prototype.buildCSSClass();this.menuButton_.el_.className=this.buildCSSClass()+" "+a,this.menuButton_.removeClass("vjs-control"),this.addChild(this.menuButton_),this.update(),this.enabled_=!0;const h=p=>this.handleClick(p);this.handleMenuKeyUp_=p=>this.handleMenuKeyUp(p),this.on(this.menuButton_,"tap",h),this.on(this.menuButton_,"click",h),this.on(this.menuButton_,"keydown",p=>this.handleKeyDown(p)),this.on(this.menuButton_,"mouseenter",()=>{this.addClass("vjs-hover"),this.menu.show(),_s(document,"keyup",this.handleMenuKeyUp_)}),this.on("mouseleave",p=>this.handleMouseLeave(p)),this.on("keydown",p=>this.handleSubmenuKeyDown(p))}update(){const e=this.createMenu();this.menu&&(this.menu.dispose(),this.removeChild(this.menu)),this.menu=e,this.addChild(e),this.buttonPressed_=!1,this.menuButton_.el_.setAttribute("aria-expanded","false"),this.items&&this.items.length<=this.hideThreshold_?(this.hide(),this.menu.contentEl_.removeAttribute("role")):(this.show(),this.menu.contentEl_.setAttribute("role","menu"))}createMenu(){const e=new MP(this.player_,{menuButton:this});if(this.hideThreshold_=0,this.options_.title){const s=Mt("li",{className:"vjs-menu-title",textContent:he(this.options_.title),tabIndex:-1}),a=new Le(this.player_,{el:s});e.addItem(a)}if(this.items=this.createItems(),this.items)for(let s=0;s<this.items.length;s++)e.addItem(this.items[s]);return e}createItems(){}createEl(){return super.createEl("div",{className:this.buildWrapperCSSClass()},{})}setIcon(e){super.setIcon(e,this.menuButton_.el_)}buildWrapperCSSClass(){let e="vjs-menu-button";this.options_.inline===!0?e+="-inline":e+="-popup";const s=Nr.prototype.buildCSSClass();return`vjs-menu-button ${e} ${s} ${super.buildCSSClass()}`}buildCSSClass(){let e="vjs-menu-button";return this.options_.inline===!0?e+="-inline":e+="-popup",`vjs-menu-button ${e} ${super.buildCSSClass()}`}controlText(e,s=this.menuButton_.el()){return this.menuButton_.controlText(e,s)}dispose(){this.handleMouseLeave(),super.dispose()}handleClick(e){this.buttonPressed_?this.unpressButton():this.pressButton()}handleMouseLeave(e){this.removeClass("vjs-hover"),ss(document,"keyup",this.handleMenuKeyUp_)}focus(){this.menuButton_.focus()}blur(){this.menuButton_.blur()}handleKeyDown(e){e.key==="Escape"||e.key==="Tab"?(this.buttonPressed_&&this.unpressButton(),!e.key==="Tab"&&(e.preventDefault(),this.menuButton_.focus())):(e.key==="Up"||e.key==="Down"&&!(this.player_.options_.playerOptions.spatialNavigation&&this.player_.options_.playerOptions.spatialNavigation.enabled))&&(this.buttonPressed_||(e.preventDefault(),this.pressButton()))}handleMenuKeyUp(e){(e.key==="Escape"||e.key==="Tab")&&this.removeClass("vjs-hover")}handleSubmenuKeyPress(e){this.handleSubmenuKeyDown(e)}handleSubmenuKeyDown(e){(e.key==="Escape"||e.key==="Tab")&&(this.buttonPressed_&&this.unpressButton(),!e.key==="Tab"&&(e.preventDefault(),this.menuButton_.focus()))}pressButton(){if(this.enabled_){if(this.buttonPressed_=!0,this.menu.show(),this.menu.lockShowing(),this.menuButton_.el_.setAttribute("aria-expanded","true"),hi&&ws())return;this.menu.focus()}}unpressButton(){this.enabled_&&(this.buttonPressed_=!1,this.menu.unlockShowing(),this.menu.hide(),this.menuButton_.el_.setAttribute("aria-expanded","false"))}disable(){this.unpressButton(),this.enabled_=!1,this.addClass("vjs-disabled"),this.menuButton_.disable()}enable(){this.enabled_=!0,this.removeClass("vjs-disabled"),this.menuButton_.enable()}}Le.registerComponent("MenuButton",zx);class Wx extends zx{constructor(e,s){const a=s.tracks;if(super(e,s),this.items.length<=1&&this.hide(),!a)return;const h=Ae(this,this.update);a.addEventListener("removetrack",h),a.addEventListener("addtrack",h),a.addEventListener("labelchange",h),this.player_.on("ready",h),this.player_.on("dispose",function(){a.removeEventListener("removetrack",h),a.removeEventListener("addtrack",h),a.removeEventListener("labelchange",h)})}}Le.registerComponent("TrackButton",Wx);class A_ extends xT{constructor(e,s){super(e,s),this.selectable=s.selectable,this.isSelected_=s.selected||!1,this.multiSelectable=s.multiSelectable,this.selected(this.isSelected_),this.selectable?this.multiSelectable?this.el_.setAttribute("role","menuitemcheckbox"):this.el_.setAttribute("role","menuitemradio"):this.el_.setAttribute("role","menuitem")}createEl(e,s,a){this.nonIconControl=!0;const h=super.createEl("li",Object.assign({className:"vjs-menu-item",tabIndex:-1},s),a),p=Mt("span",{className:"vjs-menu-item-text",textContent:this.localize(this.options_.label)});return this.player_.options_.experimentalSvgIcons?h.appendChild(p):h.replaceChild(p,h.querySelector(".vjs-icon-placeholder")),h}handleKeyDown(e){["Tab","Escape","ArrowUp","ArrowLeft","ArrowRight","ArrowDown"].includes(e.key)||super.handleKeyDown(e)}handleClick(e){this.selected(!0)}selected(e){this.selectable&&(e?(this.addClass("vjs-selected"),this.el_.setAttribute("aria-checked","true"),this.controlText(", selected"),this.isSelected_=!0):(this.removeClass("vjs-selected"),this.el_.setAttribute("aria-checked","false"),this.controlText(""),this.isSelected_=!1))}}Le.registerComponent("MenuItem",A_);class C_ extends A_{constructor(e,s){const a=s.track,h=e.textTracks();s.label=a.label||a.language||"Unknown",s.selected=a.mode==="showing",super(e,s),this.track=a,this.kinds=(s.kinds||[s.kind||this.track.kind]).filter(Boolean);const p=(...w)=>{this.handleTracksChange.apply(this,w)},_=(...w)=>{this.handleSelectedLanguageChange.apply(this,w)};if(e.on(["loadstart","texttrackchange"],p),h.addEventListener("change",p),h.addEventListener("selectedlanguagechange",_),this.on("dispose",function(){e.off(["loadstart","texttrackchange"],p),h.removeEventListener("change",p),h.removeEventListener("selectedlanguagechange",_)}),h.onchange===void 0){let w;this.on(["tap","click"],function(){if(typeof window.Event!="object")try{w=new window.Event("change")}catch{}w||(w=document.createEvent("Event"),w.initEvent("change",!0,!0)),h.dispatchEvent(w)})}this.handleTracksChange()}handleClick(e){const s=this.track,a=this.player_.textTracks();if(super.handleClick(e),!!a)for(let h=0;h<a.length;h++){const p=a[h];this.kinds.indexOf(p.kind)!==-1&&(p===s?p.mode!=="showing"&&(p.mode="showing"):p.mode!=="disabled"&&(p.mode="disabled"))}}handleTracksChange(e){const s=this.track.mode==="showing";s!==this.isSelected_&&this.selected(s)}handleSelectedLanguageChange(e){if(this.track.mode==="showing"){const s=this.player_.cache_.selectedLanguage;if(s&&s.enabled&&s.language===this.track.language&&s.kind!==this.track.kind)return;this.player_.cache_.selectedLanguage={enabled:!0,language:this.track.language,kind:this.track.kind}}}dispose(){this.track=null,super.dispose()}}Le.registerComponent("TextTrackMenuItem",C_);class OP extends C_{constructor(e,s){s.track={player:e,kind:s.kind,kinds:s.kinds,default:!1,mode:"disabled"},s.kinds||(s.kinds=[s.kind]),s.label?s.track.label=s.label:s.track.label=s.kinds.join(" and ")+" off",s.selectable=!0,s.multiSelectable=!1,super(e,s)}handleTracksChange(e){const s=this.player().textTracks();let a=!0;for(let h=0,p=s.length;h<p;h++){const _=s[h];if(this.options_.kinds.indexOf(_.kind)>-1&&_.mode==="showing"){a=!1;break}}a!==this.isSelected_&&this.selected(a)}handleSelectedLanguageChange(e){const s=this.player().textTracks();let a=!0;for(let h=0,p=s.length;h<p;h++){const _=s[h];if(["captions","descriptions","subtitles"].indexOf(_.kind)>-1&&_.mode==="showing"){a=!1;break}}a&&(this.player_.cache_.selectedLanguage={enabled:!1})}handleLanguagechange(){this.$(".vjs-menu-item-text").textContent=this.player_.localize(this.options_.label),super.handleLanguagechange()}}Le.registerComponent("OffTextTrackMenuItem",OP);class mg extends Wx{constructor(e,s={}){s.tracks=e.textTracks(),super(e,s)}createItems(e=[],s=C_){let a;this.label_&&(a=`${this.label_} off`),e.push(new OP(this.player_,{kinds:this.kinds_,kind:this.kind_,label:a})),this.hideThreshold_+=1;const h=this.player_.textTracks();Array.isArray(this.kinds_)||(this.kinds_=[this.kind_]);for(let p=0;p<h.length;p++){const _=h[p];if(this.kinds_.indexOf(_.kind)>-1){const w=new s(this.player_,{track:_,kinds:this.kinds_,kind:this.kind_,selectable:!0,multiSelectable:!1});w.addClass(`vjs-${_.kind}-menu-item`),e.push(w)}}return e}}Le.registerComponent("TextTrackButton",mg);class FP extends A_{constructor(e,s){const a=s.track,h=s.cue,p=e.currentTime();s.selectable=!0,s.multiSelectable=!1,s.label=h.text,s.selected=h.startTime<=p&&p<h.endTime,super(e,s),this.track=a,this.cue=h}handleClick(e){super.handleClick(),this.player_.currentTime(this.cue.startTime)}}Le.registerComponent("ChaptersTrackMenuItem",FP);class qx extends mg{constructor(e,s,a){super(e,s,a),this.setIcon("chapters"),this.selectCurrentItem_=()=>{this.items.forEach(h=>{h.selected(this.track_.activeCues[0]===h.cue)})}}buildCSSClass(){return`vjs-chapters-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-chapters-button ${super.buildWrapperCSSClass()}`}update(e){if(e&&e.track&&e.track.kind!=="chapters")return;const s=this.findChaptersTrack();s!==this.track_?(this.setTrack(s),super.update()):(!this.items||s&&s.cues&&s.cues.length!==this.items.length)&&super.update()}setTrack(e){if(this.track_!==e){if(this.updateHandler_||(this.updateHandler_=this.update.bind(this)),this.track_){const s=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);s&&s.removeEventListener("load",this.updateHandler_),this.track_.removeEventListener("cuechange",this.selectCurrentItem_),this.track_=null}if(this.track_=e,this.track_){this.track_.mode="hidden";const s=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);s&&s.addEventListener("load",this.updateHandler_),this.track_.addEventListener("cuechange",this.selectCurrentItem_)}}}findChaptersTrack(){const e=this.player_.textTracks()||[];for(let s=e.length-1;s>=0;s--){const a=e[s];if(a.kind===this.kind_)return a}}getMenuCaption(){return this.track_&&this.track_.label?this.track_.label:this.localize(he(this.kind_))}createMenu(){return this.options_.title=this.getMenuCaption(),super.createMenu()}createItems(){const e=[];if(!this.track_)return e;const s=this.track_.cues;if(!s)return e;for(let a=0,h=s.length;a<h;a++){const p=s[a],_=new FP(this.player_,{track:this.track_,cue:p});e.push(_)}return e}}qx.prototype.kind_="chapters",qx.prototype.controlText_="Chapters",Le.registerComponent("ChaptersButton",qx);class Gx extends mg{constructor(e,s,a){super(e,s,a),this.setIcon("audio-description");const h=e.textTracks(),p=Ae(this,this.handleTracksChange);h.addEventListener("change",p),this.on("dispose",function(){h.removeEventListener("change",p)})}handleTracksChange(e){const s=this.player().textTracks();let a=!1;for(let h=0,p=s.length;h<p;h++){const _=s[h];if(_.kind!==this.kind_&&_.mode==="showing"){a=!0;break}}a?this.disable():this.enable()}buildCSSClass(){return`vjs-descriptions-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-descriptions-button ${super.buildWrapperCSSClass()}`}}Gx.prototype.kind_="descriptions",Gx.prototype.controlText_="Descriptions",Le.registerComponent("DescriptionsButton",Gx);class Xx extends mg{constructor(e,s,a){super(e,s,a),this.setIcon("subtitles")}buildCSSClass(){return`vjs-subtitles-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-subtitles-button ${super.buildWrapperCSSClass()}`}}Xx.prototype.kind_="subtitles",Xx.prototype.controlText_="Subtitles",Le.registerComponent("SubtitlesButton",Xx);class Kx extends C_{constructor(e,s){s.track={player:e,kind:s.kind,label:s.kind+" settings",selectable:!1,default:!1,mode:"disabled"},s.selectable=!1,s.name="CaptionSettingsMenuItem",super(e,s),this.addClass("vjs-texttrack-settings"),this.controlText(", opens "+s.kind+" settings dialog")}handleClick(e){this.player().getChild("textTrackSettings").open()}handleLanguagechange(){this.$(".vjs-menu-item-text").textContent=this.player_.localize(this.options_.kind+" settings"),super.handleLanguagechange()}}Le.registerComponent("CaptionSettingsMenuItem",Kx);class Yx extends mg{constructor(e,s,a){super(e,s,a),this.setIcon("captions")}buildCSSClass(){return`vjs-captions-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-captions-button ${super.buildWrapperCSSClass()}`}createItems(){const e=[];return!(this.player().tech_&&this.player().tech_.featuresNativeTextTracks)&&this.player().getChild("textTrackSettings")&&(e.push(new Kx(this.player_,{kind:this.kind_})),this.hideThreshold_+=1),super.createItems(e)}}Yx.prototype.kind_="captions",Yx.prototype.controlText_="Captions",Le.registerComponent("CaptionsButton",Yx);class BP extends C_{createEl(e,s,a){const h=super.createEl(e,s,a),p=h.querySelector(".vjs-menu-item-text");return this.options_.track.kind==="captions"&&(this.player_.options_.experimentalSvgIcons?this.setIcon("captions",h):p.appendChild(Mt("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),p.appendChild(Mt("span",{className:"vjs-control-text",textContent:` ${this.localize("Captions")}`}))),h}}Le.registerComponent("SubsCapsMenuItem",BP);class Zx extends mg{constructor(e,s={}){super(e,s),this.label_="subtitles",this.setIcon("subtitles"),["en","en-us","en-ca","fr-ca"].indexOf(this.player_.language_)>-1&&(this.label_="captions",this.setIcon("captions")),this.menuButton_.controlText(he(this.label_))}buildCSSClass(){return`vjs-subs-caps-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-subs-caps-button ${super.buildWrapperCSSClass()}`}createItems(){let e=[];return!(this.player().tech_&&this.player().tech_.featuresNativeTextTracks)&&this.player().getChild("textTrackSettings")&&(e.push(new Kx(this.player_,{kind:this.label_})),this.hideThreshold_+=1),e=super.createItems(e,BP),e}}Zx.prototype.kinds_=["captions","subtitles"],Zx.prototype.controlText_="Subtitles",Le.registerComponent("SubsCapsButton",Zx);class UP extends A_{constructor(e,s){const a=s.track,h=e.audioTracks();s.label=a.label||a.language||"Unknown",s.selected=a.enabled,super(e,s),this.track=a,this.addClass(`vjs-${a.kind}-menu-item`);const p=(..._)=>{this.handleTracksChange.apply(this,_)};h.addEventListener("change",p),this.on("dispose",()=>{h.removeEventListener("change",p)})}createEl(e,s,a){const h=super.createEl(e,s,a),p=h.querySelector(".vjs-menu-item-text");return["main-desc","descriptions"].indexOf(this.options_.track.kind)>=0&&(p.appendChild(Mt("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),p.appendChild(Mt("span",{className:"vjs-control-text",textContent:" "+this.localize("Descriptions")}))),h}handleClick(e){if(super.handleClick(e),this.track.enabled=!0,this.player_.tech_.featuresNativeAudioTracks){const s=this.player_.audioTracks();for(let a=0;a<s.length;a++){const h=s[a];h!==this.track&&(h.enabled=h===this.track)}}}handleTracksChange(e){this.selected(this.track.enabled)}}Le.registerComponent("AudioTrackMenuItem",UP);class jP extends Wx{constructor(e,s={}){s.tracks=e.audioTracks(),super(e,s),this.setIcon("audio")}buildCSSClass(){return`vjs-audio-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-audio-button ${super.buildWrapperCSSClass()}`}createItems(e=[]){this.hideThreshold_=1;const s=this.player_.audioTracks();for(let a=0;a<s.length;a++){const h=s[a];e.push(new UP(this.player_,{track:h,selectable:!0,multiSelectable:!1}))}return e}}jP.prototype.controlText_="Audio Track",Le.registerComponent("AudioTrackButton",jP);class Qx extends A_{constructor(e,s){const a=s.rate,h=parseFloat(a,10);s.label=a,s.selected=h===e.playbackRate(),s.selectable=!0,s.multiSelectable=!1,super(e,s),this.label=a,this.rate=h,this.on(e,"ratechange",p=>this.update(p))}handleClick(e){super.handleClick(),this.player().playbackRate(this.rate)}update(e){this.selected(this.player().playbackRate()===this.rate)}}Qx.prototype.contentElType="button",Le.registerComponent("PlaybackRateMenuItem",Qx);class HP extends zx{constructor(e,s){super(e,s),this.menuButton_.el_.setAttribute("aria-describedby",this.labelElId_),this.updateVisibility(),this.updateLabel(),this.on(e,"loadstart",a=>this.updateVisibility(a)),this.on(e,"ratechange",a=>this.updateLabel(a)),this.on(e,"playbackrateschange",a=>this.handlePlaybackRateschange(a))}createEl(){const e=super.createEl();return this.labelElId_="vjs-playback-rate-value-label-"+this.id_,this.labelEl_=Mt("div",{className:"vjs-playback-rate-value",id:this.labelElId_,textContent:"1x"}),e.appendChild(this.labelEl_),e}dispose(){this.labelEl_=null,super.dispose()}buildCSSClass(){return`vjs-playback-rate ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-playback-rate ${super.buildWrapperCSSClass()}`}createItems(){const e=this.playbackRates(),s=[];for(let a=e.length-1;a>=0;a--)s.push(new Qx(this.player(),{rate:e[a]+"x"}));return s}handlePlaybackRateschange(e){this.update()}playbackRates(){const e=this.player();return e.playbackRates&&e.playbackRates()||[]}playbackRateSupported(){return this.player().tech_&&this.player().tech_.featuresPlaybackRate&&this.playbackRates()&&this.playbackRates().length>0}updateVisibility(e){this.playbackRateSupported()?this.removeClass("vjs-hidden"):this.addClass("vjs-hidden")}updateLabel(e){this.playbackRateSupported()&&(this.labelEl_.textContent=this.player().playbackRate()+"x")}}HP.prototype.controlText_="Playback Rate",Le.registerComponent("PlaybackRateMenuButton",HP);class VP extends Le{buildCSSClass(){return`vjs-spacer ${super.buildCSSClass()}`}createEl(e="div",s={},a={}){return s.className||(s.className=this.buildCSSClass()),super.createEl(e,s,a)}}Le.registerComponent("Spacer",VP);class u4 extends VP{buildCSSClass(){return`vjs-custom-control-spacer ${super.buildCSSClass()}`}createEl(){return super.createEl("div",{className:this.buildCSSClass(),textContent:"Â "})}}Le.registerComponent("CustomControlSpacer",u4);class $P extends Le{createEl(){return super.createEl("div",{className:"vjs-control-bar",dir:"ltr"})}}$P.prototype.options_={children:["playToggle","skipBackward","skipForward","volumePanel","currentTimeDisplay","timeDivider","durationDisplay","progressControl","liveDisplay","seekToLive","remainingTimeDisplay","customControlSpacer","playbackRateMenuButton","chaptersButton","descriptionsButton","subsCapsButton","audioTrackButton","pictureInPictureToggle","fullscreenToggle"]},Le.registerComponent("ControlBar",$P);class zP extends Bh{constructor(e,s){super(e,s),this.on(e,"error",a=>{this.open(a)})}buildCSSClass(){return`vjs-error-display ${super.buildCSSClass()}`}content(){const e=this.player().error();return e?this.localize(e.message):""}}zP.prototype.options_=Object.assign({},Bh.prototype.options_,{pauseOnOpen:!1,fillAlways:!0,temporary:!1,uncloseable:!0}),Le.registerComponent("ErrorDisplay",zP);class WP extends Le{constructor(e,s={}){super(e,s),this.el_.setAttribute("aria-labelledby",this.selectLabelledbyIds)}createEl(){return this.selectLabelledbyIds=[this.options_.legendId,this.options_.labelId].join(" ").trim(),Mt("select",{id:this.options_.id},{},this.options_.SelectOptions.map(s=>{const a=(this.options_.labelId?this.options_.labelId:`vjs-track-option-${qi()}`)+"-"+s[1].replace(/\W+/g,""),h=Mt("option",{id:a,value:this.localize(s[0]),textContent:this.localize(s[1])});return h.setAttribute("aria-labelledby",`${this.selectLabelledbyIds} ${a}`),h}))}}Le.registerComponent("TextTrackSelect",WP);class Hd extends Le{constructor(e,s={}){super(e,s);const a=Mt("legend",{textContent:this.localize(this.options_.legendText),id:this.options_.legendId});this.el().appendChild(a);const h=this.options_.selects;for(const p of h){const _=this.options_.selectConfigs[p],w=_.className,I=_.id.replace("%s",this.options_.id_);let B=null;const G=`vjs_select_${qi()}`;if(this.options_.type==="colors"){B=Mt("span",{className:w});const pe=Mt("label",{id:I,className:"vjs-label",textContent:this.localize(_.label)});pe.setAttribute("for",G),B.appendChild(pe)}const se=new WP(e,{SelectOptions:_.options,legendId:this.options_.legendId,id:G,labelId:I});this.addChild(se),this.options_.type==="colors"&&(B.appendChild(se.el()),this.el().appendChild(B))}}createEl(){return Mt("fieldset",{className:this.options_.className})}}Le.registerComponent("TextTrackFieldset",Hd);class qP extends Le{constructor(e,s={}){super(e,s);const a=this.options_.textTrackComponentid,h=new Hd(e,{id_:a,legendId:`captions-text-legend-${a}`,legendText:this.localize("Text"),className:"vjs-fg vjs-track-setting",selects:this.options_.fieldSets[0],selectConfigs:this.options_.selectConfigs,type:"colors"});this.addChild(h);const p=new Hd(e,{id_:a,legendId:`captions-background-${a}`,legendText:this.localize("Text Background"),className:"vjs-bg vjs-track-setting",selects:this.options_.fieldSets[1],selectConfigs:this.options_.selectConfigs,type:"colors"});this.addChild(p);const _=new Hd(e,{id_:a,legendId:`captions-window-${a}`,legendText:this.localize("Caption Area Background"),className:"vjs-window vjs-track-setting",selects:this.options_.fieldSets[2],selectConfigs:this.options_.selectConfigs,type:"colors"});this.addChild(_)}createEl(){return Mt("div",{className:"vjs-track-settings-colors"})}}Le.registerComponent("TextTrackSettingsColors",qP);class GP extends Le{constructor(e,s={}){super(e,s);const a=this.options_.textTrackComponentid,h=new Hd(e,{id_:a,legendId:`captions-font-size-${a}`,legendText:"Font Size",className:"vjs-font-percent vjs-track-setting",selects:this.options_.fieldSets[0],selectConfigs:this.options_.selectConfigs,type:"font"});this.addChild(h);const p=new Hd(e,{id_:a,legendId:`captions-edge-style-${a}`,legendText:this.localize("Text Edge Style"),className:"vjs-edge-style vjs-track-setting",selects:this.options_.fieldSets[1],selectConfigs:this.options_.selectConfigs,type:"font"});this.addChild(p);const _=new Hd(e,{id_:a,legendId:`captions-font-family-${a}`,legendText:this.localize("Font Family"),className:"vjs-font-family vjs-track-setting",selects:this.options_.fieldSets[2],selectConfigs:this.options_.selectConfigs,type:"font"});this.addChild(_)}createEl(){return Mt("div",{className:"vjs-track-settings-font"})}}Le.registerComponent("TextTrackSettingsFont",GP);class XP extends Le{constructor(e,s={}){super(e,s);const a=new Nr(e,{controlText:this.localize("restore all settings to the default values"),className:"vjs-default-button"});a.el().classList.remove("vjs-control","vjs-button"),a.el().textContent=this.localize("Reset"),this.addChild(a);const h=this.localize("Done"),p=new Nr(e,{controlText:h,className:"vjs-done-button"});p.el().classList.remove("vjs-control","vjs-button"),p.el().textContent=h,this.addChild(p)}createEl(){return Mt("div",{className:"vjs-track-settings-controls"})}}Le.registerComponent("TrackSettingsControls",XP);const Jx="vjs-text-track-settings",KP=["#000","Black"],YP=["#00F","Blue"],ZP=["#0FF","Cyan"],QP=["#0F0","Green"],JP=["#F0F","Magenta"],eD=["#F00","Red"],tD=["#FFF","White"],iD=["#FF0","Yellow"],e1=["1","Opaque"],t1=["0.5","Semi-Transparent"],sD=["0","Transparent"],Gh={backgroundColor:{selector:".vjs-bg-color > select",id:"captions-background-color-%s",label:"Color",options:[KP,tD,eD,QP,YP,iD,JP,ZP],className:"vjs-bg-color"},backgroundOpacity:{selector:".vjs-bg-opacity > select",id:"captions-background-opacity-%s",label:"Opacity",options:[e1,t1,sD],className:"vjs-bg-opacity vjs-opacity"},color:{selector:".vjs-text-color > select",id:"captions-foreground-color-%s",label:"Color",options:[tD,KP,eD,QP,YP,iD,JP,ZP],className:"vjs-text-color"},edgeStyle:{selector:".vjs-edge-style > select",id:"",label:"Text Edge Style",options:[["none","None"],["raised","Raised"],["depressed","Depressed"],["uniform","Uniform"],["dropshadow","Drop shadow"]]},fontFamily:{selector:".vjs-font-family > select",id:"",label:"Font Family",options:[["proportionalSansSerif","Proportional Sans-Serif"],["monospaceSansSerif","Monospace Sans-Serif"],["proportionalSerif","Proportional Serif"],["monospaceSerif","Monospace Serif"],["casual","Casual"],["script","Script"],["small-caps","Small Caps"]]},fontPercent:{selector:".vjs-font-percent > select",id:"",label:"Font Size",options:[["0.50","50%"],["0.75","75%"],["1.00","100%"],["1.25","125%"],["1.50","150%"],["1.75","175%"],["2.00","200%"],["3.00","300%"],["4.00","400%"]],default:2,parser:r=>r==="1.00"?null:Number(r)},textOpacity:{selector:".vjs-text-opacity > select",id:"captions-foreground-opacity-%s",label:"Opacity",options:[e1,t1],className:"vjs-text-opacity vjs-opacity"},windowColor:{selector:".vjs-window-color > select",id:"captions-window-color-%s",label:"Color",className:"vjs-window-color"},windowOpacity:{selector:".vjs-window-opacity > select",id:"captions-window-opacity-%s",label:"Opacity",options:[sD,t1,e1],className:"vjs-window-opacity vjs-opacity"}};Gh.windowColor.options=Gh.backgroundColor.options;function nD(r,e){if(e&&(r=e(r)),r&&r!=="none")return r}function h4(r,e){const s=r.options[r.options.selectedIndex].value;return nD(s,e)}function c4(r,e,s){if(e){for(let a=0;a<r.options.length;a++)if(nD(r.options[a].value,s)===e){r.selectedIndex=a;break}}}class d4 extends Bh{constructor(e,s){s.temporary=!1,super(e,s),this.updateDisplay=this.updateDisplay.bind(this),this.fill(),this.hasBeenOpened_=this.hasBeenFilled_=!0,this.renderModalComponents(e),this.endDialog=Mt("p",{className:"vjs-control-text",textContent:this.localize("End of dialog window.")}),this.el().appendChild(this.endDialog),this.setDefaults(),s.persistTextTrackSettings===void 0&&(this.options_.persistTextTrackSettings=this.options_.playerOptions.persistTextTrackSettings),this.bindFunctionsToSelectsAndButtons(),this.options_.persistTextTrackSettings&&this.restoreSettings()}renderModalComponents(e){const s=new qP(e,{textTrackComponentid:this.id_,selectConfigs:Gh,fieldSets:[["color","textOpacity"],["backgroundColor","backgroundOpacity"],["windowColor","windowOpacity"]]});this.addChild(s);const a=new GP(e,{textTrackComponentid:this.id_,selectConfigs:Gh,fieldSets:[["fontPercent"],["edgeStyle"],["fontFamily"]]});this.addChild(a);const h=new XP(e);this.addChild(h)}bindFunctionsToSelectsAndButtons(){this.on(this.$(".vjs-done-button"),["click","tap"],()=>{this.saveSettings(),this.close()}),this.on(this.$(".vjs-default-button"),["click","tap"],()=>{this.setDefaults(),this.updateDisplay()}),X(Gh,e=>{this.on(this.$(e.selector),"change",this.updateDisplay)})}dispose(){this.endDialog=null,super.dispose()}label(){return this.localize("Caption Settings Dialog")}description(){return this.localize("Beginning of dialog window. Escape will cancel and close the window.")}buildCSSClass(){return super.buildCSSClass()+" vjs-text-track-settings"}getValues(){return re(Gh,(e,s,a)=>{const h=h4(this.$(s.selector),s.parser);return h!==void 0&&(e[a]=h),e},{})}setValues(e){X(Gh,(s,a)=>{c4(this.$(s.selector),e[a],s.parser)})}setDefaults(){X(Gh,e=>{const s=e.hasOwnProperty("default")?e.default:0;this.$(e.selector).selectedIndex=s})}restoreSettings(){let e;try{e=JSON.parse(window.localStorage.getItem(Jx))}catch(s){P.warn(s)}e&&this.setValues(e)}saveSettings(){if(!this.options_.persistTextTrackSettings)return;const e=this.getValues();try{Object.keys(e).length?window.localStorage.setItem(Jx,JSON.stringify(e)):window.localStorage.removeItem(Jx)}catch(s){P.warn(s)}}updateDisplay(){const e=this.player_.getChild("textTrackDisplay");e&&e.updateDisplay()}handleLanguagechange(){this.fill(),this.renderModalComponents(this.player_),this.bindFunctionsToSelectsAndButtons()}}Le.registerComponent("TextTrackSettings",d4);class f4 extends Le{constructor(e,s){let a=s.ResizeObserver||window.ResizeObserver;s.ResizeObserver===null&&(a=!1);const h=ee({createEl:!a,reportTouchActivity:!1},s);super(e,h),this.ResizeObserver=s.ResizeObserver||window.ResizeObserver,this.loadListener_=null,this.resizeObserver_=null,this.debouncedHandler_=Dt(()=>{this.resizeHandler()},100,!1,this),a?(this.resizeObserver_=new this.ResizeObserver(this.debouncedHandler_),this.resizeObserver_.observe(e.el())):(this.loadListener_=()=>{if(!this.el_||!this.el_.contentWindow)return;const p=this.debouncedHandler_;let _=this.unloadListener_=function(){ss(this,"resize",p),ss(this,"unload",_),_=null};_s(this.el_.contentWindow,"unload",_),_s(this.el_.contentWindow,"resize",p)},this.one("load",this.loadListener_))}createEl(){return super.createEl("iframe",{className:"vjs-resize-manager",tabIndex:-1,title:this.localize("No content")},{"aria-hidden":"true"})}resizeHandler(){!this.player_||!this.player_.trigger||this.player_.trigger("playerresize")}dispose(){this.debouncedHandler_&&this.debouncedHandler_.cancel(),this.resizeObserver_&&(this.player_.el()&&this.resizeObserver_.unobserve(this.player_.el()),this.resizeObserver_.disconnect()),this.loadListener_&&this.off("load",this.loadListener_),this.el_&&this.el_.contentWindow&&this.unloadListener_&&this.unloadListener_.call(this.el_.contentWindow),this.ResizeObserver=null,this.resizeObserver=null,this.debouncedHandler_=null,this.loadListener_=null,super.dispose()}}Le.registerComponent("ResizeManager",f4);const p4={trackingThreshold:20,liveTolerance:15};class g4 extends Le{constructor(e,s){const a=ee(p4,s,{createEl:!1});super(e,a),this.trackLiveHandler_=()=>this.trackLive_(),this.handlePlay_=h=>this.handlePlay(h),this.handleFirstTimeupdate_=h=>this.handleFirstTimeupdate(h),this.handleSeeked_=h=>this.handleSeeked(h),this.seekToLiveEdge_=h=>this.seekToLiveEdge(h),this.reset_(),this.on(this.player_,"durationchange",h=>this.handleDurationchange(h)),this.on(this.player_,"canplay",()=>this.toggleTracking())}trackLive_(){const e=this.player_.seekable();if(!e||!e.length)return;const s=Number(window.performance.now().toFixed(4)),a=this.lastTime_===-1?0:(s-this.lastTime_)/1e3;this.lastTime_=s,this.pastSeekEnd_=this.pastSeekEnd()+a;const h=this.liveCurrentTime(),p=this.player_.currentTime();let _=this.player_.paused()||this.seekedBehindLive_||Math.abs(h-p)>this.options_.liveTolerance;(!this.timeupdateSeen_||h===1/0)&&(_=!1),_!==this.behindLiveEdge_&&(this.behindLiveEdge_=_,this.trigger("liveedgechange"))}handleDurationchange(){this.toggleTracking()}toggleTracking(){this.player_.duration()===1/0&&this.liveWindow()>=this.options_.trackingThreshold?(this.player_.options_.liveui&&this.player_.addClass("vjs-liveui"),this.startTracking()):(this.player_.removeClass("vjs-liveui"),this.stopTracking())}startTracking(){this.isTracking()||(this.timeupdateSeen_||(this.timeupdateSeen_=this.player_.hasStarted()),this.trackingInterval_=this.setInterval(this.trackLiveHandler_,Ce),this.trackLive_(),this.on(this.player_,["play","pause"],this.trackLiveHandler_),this.timeupdateSeen_?this.on(this.player_,"seeked",this.handleSeeked_):(this.one(this.player_,"play",this.handlePlay_),this.one(this.player_,"timeupdate",this.handleFirstTimeupdate_)))}handleFirstTimeupdate(){this.timeupdateSeen_=!0,this.on(this.player_,"seeked",this.handleSeeked_)}handleSeeked(){const e=Math.abs(this.liveCurrentTime()-this.player_.currentTime());this.seekedBehindLive_=this.nextSeekedFromUser_&&e>2,this.nextSeekedFromUser_=!1,this.trackLive_()}handlePlay(){this.one(this.player_,"timeupdate",this.seekToLiveEdge_)}reset_(){this.lastTime_=-1,this.pastSeekEnd_=0,this.lastSeekEnd_=-1,this.behindLiveEdge_=!0,this.timeupdateSeen_=!1,this.seekedBehindLive_=!1,this.nextSeekedFromUser_=!1,this.clearInterval(this.trackingInterval_),this.trackingInterval_=null,this.off(this.player_,["play","pause"],this.trackLiveHandler_),this.off(this.player_,"seeked",this.handleSeeked_),this.off(this.player_,"play",this.handlePlay_),this.off(this.player_,"timeupdate",this.handleFirstTimeupdate_),this.off(this.player_,"timeupdate",this.seekToLiveEdge_)}nextSeekedFromUser(){this.nextSeekedFromUser_=!0}stopTracking(){this.isTracking()&&(this.reset_(),this.trigger("liveedgechange"))}seekableEnd(){const e=this.player_.seekable(),s=[];let a=e?e.length:0;for(;a--;)s.push(e.end(a));return s.length?s.sort()[s.length-1]:1/0}seekableStart(){const e=this.player_.seekable(),s=[];let a=e?e.length:0;for(;a--;)s.push(e.start(a));return s.length?s.sort()[0]:0}liveWindow(){const e=this.liveCurrentTime();return e===1/0?0:e-this.seekableStart()}isLive(){return this.isTracking()}atLiveEdge(){return!this.behindLiveEdge()}liveCurrentTime(){return this.pastSeekEnd()+this.seekableEnd()}pastSeekEnd(){const e=this.seekableEnd();return this.lastSeekEnd_!==-1&&e!==this.lastSeekEnd_&&(this.pastSeekEnd_=0),this.lastSeekEnd_=e,this.pastSeekEnd_}behindLiveEdge(){return this.behindLiveEdge_}isTracking(){return typeof this.trackingInterval_=="number"}seekToLiveEdge(){this.seekedBehindLive_=!1,!this.atLiveEdge()&&(this.nextSeekedFromUser_=!1,this.player_.currentTime(this.liveCurrentTime()))}dispose(){this.stopTracking(),super.dispose()}}Le.registerComponent("LiveTracker",g4);class m4 extends Le{constructor(e,s){super(e,s),this.on("statechanged",a=>this.updateDom_()),this.updateDom_()}createEl(){return this.els={title:Mt("div",{className:"vjs-title-bar-title",id:`vjs-title-bar-title-${qi()}`}),description:Mt("div",{className:"vjs-title-bar-description",id:`vjs-title-bar-description-${qi()}`})},Mt("div",{className:"vjs-title-bar"},{},A(this.els))}updateDom_(){const e=this.player_.tech_,s=e&&e.el_,a={title:"aria-labelledby",description:"aria-describedby"};["title","description"].forEach(h=>{const p=this.state[h],_=this.els[h],w=a[h];pt(_),p&&Mi(_,p),s&&(s.removeAttribute(w),p&&s.setAttribute(w,_.id))}),this.state.title||this.state.description?this.show():this.hide()}update(e){this.setState(e)}dispose(){const e=this.player_.tech_,s=e&&e.el_;s&&(s.removeAttribute("aria-labelledby"),s.removeAttribute("aria-describedby")),super.dispose(),this.els=null}}Le.registerComponent("TitleBar",m4);const _4={initialDisplay:4e3,position:[],takeFocus:!1};class b4 extends Nr{constructor(e,s){s=ee(_4,s),super(e,s),this.controlText(s.controlText),this.hide(),this.on(this.player_,["useractive","userinactive"],a=>{this.removeClass("force-display")})}buildCSSClass(){return`vjs-transient-button focus-visible ${this.options_.position.map(e=>`vjs-${e}`).join(" ")}`}createEl(){const e=Mt("button",{},{type:"button",class:this.buildCSSClass()},Mt("span"));return this.controlTextEl_=e.querySelector("span"),e}show(){super.show(),this.addClass("force-display"),this.options_.takeFocus&&this.el().focus({preventScroll:!0}),this.forceDisplayTimeout=this.player_.setTimeout(()=>{this.removeClass("force-display")},this.options_.initialDisplay)}hide(){this.removeClass("force-display"),super.hide()}dispose(){this.player_.clearTimeout(this.forceDisplayTimeout),super.dispose()}}Le.registerComponent("TransientButton",b4);const i1=r=>{const e=r.el();if(e.hasAttribute("src"))return r.triggerSourceset(e.src),!0;const s=r.$$("source"),a=[];let h="";if(!s.length)return!1;for(let p=0;p<s.length;p++){const _=s[p].src;_&&a.indexOf(_)===-1&&a.push(_)}return a.length?(a.length===1&&(h=a[0]),r.triggerSourceset(h),!0):!1},y4=Object.defineProperty({},"innerHTML",{get(){return this.cloneNode(!0).innerHTML},set(r){const e=document.createElement(this.nodeName.toLowerCase());e.innerHTML=r;const s=document.createDocumentFragment();for(;e.childNodes.length;)s.appendChild(e.childNodes[0]);return this.innerText="",window.Element.prototype.appendChild.call(this,s),this.innerHTML}}),rD=(r,e)=>{let s={};for(let a=0;a<r.length&&(s=Object.getOwnPropertyDescriptor(r[a],e),!(s&&s.set&&s.get));a++);return s.enumerable=!0,s.configurable=!0,s},v4=r=>rD([r.el(),window.HTMLMediaElement.prototype,window.Element.prototype,y4],"innerHTML"),aD=function(r){const e=r.el();if(e.resetSourceWatch_)return;const s={},a=v4(r),h=p=>(..._)=>{const w=p.apply(e,_);return i1(r),w};["append","appendChild","insertAdjacentHTML"].forEach(p=>{e[p]&&(s[p]=e[p],e[p]=h(s[p]))}),Object.defineProperty(e,"innerHTML",ee(a,{set:h(a.set)})),e.resetSourceWatch_=()=>{e.resetSourceWatch_=null,Object.keys(s).forEach(p=>{e[p]=s[p]}),Object.defineProperty(e,"innerHTML",a)},r.one("sourceset",e.resetSourceWatch_)},w4=Object.defineProperty({},"src",{get(){return this.hasAttribute("src")?jh(window.Element.prototype.getAttribute.call(this,"src")):""},set(r){return window.Element.prototype.setAttribute.call(this,"src",r),r}}),T4=r=>rD([r.el(),window.HTMLMediaElement.prototype,w4],"src"),E4=function(r){if(!r.featuresSourceset)return;const e=r.el();if(e.resetSourceset_)return;const s=T4(r),a=e.setAttribute,h=e.load;Object.defineProperty(e,"src",ee(s,{set:p=>{const _=s.set.call(e,p);return r.triggerSourceset(e.src),_}})),e.setAttribute=(p,_)=>{const w=a.call(e,p,_);return/src/i.test(p)&&r.triggerSourceset(e.src),w},e.load=()=>{const p=h.call(e);return i1(r)||(r.triggerSourceset(""),aD(r)),p},e.currentSrc?r.triggerSourceset(e.currentSrc):i1(r)||aD(r),e.resetSourceset_=()=>{e.resetSourceset_=null,e.load=h,e.setAttribute=a,Object.defineProperty(e,"src",s),e.resetSourceWatch_&&e.resetSourceWatch_()}};class Xt extends si{constructor(e,s){super(e,s);const a=e.source;let h=!1;if(this.featuresVideoFrameCallback=this.featuresVideoFrameCallback&&this.el_.tagName==="VIDEO",a&&(this.el_.currentSrc!==a.src||e.tag&&e.tag.initNetworkState_===3)?this.setSource(a):this.handleLateInit_(this.el_),e.enableSourceset&&this.setupSourcesetHandling_(),this.isScrubbing_=!1,this.el_.hasChildNodes()){const p=this.el_.childNodes;let _=p.length;const w=[];for(;_--;){const I=p[_];I.nodeName.toLowerCase()==="track"&&(this.featuresNativeTextTracks?(this.remoteTextTrackEls().addTrackElement_(I),this.remoteTextTracks().addTrack(I.track),this.textTracks().addTrack(I.track),!h&&!this.el_.hasAttribute("crossorigin")&&Hh(I.src)&&(h=!0)):w.push(I))}for(let I=0;I<w.length;I++)this.el_.removeChild(w[I])}this.proxyNativeTracks_(),this.featuresNativeTextTracks&&h&&P.warn(`Text Tracks are being loaded from another origin but the crossorigin attribute isn't used.
This may prevent text tracks from loading.`),this.restoreMetadataTracksInIOSNativePlayer_(),(Ei||ki)&&e.nativeControlsForTouch===!0&&this.setControls(!0),this.proxyWebkitFullscreen_(),this.triggerReady()}dispose(){this.el_&&this.el_.resetSourceset_&&this.el_.resetSourceset_(),Xt.disposeMediaElement(this.el_),this.options_=null,super.dispose()}setupSourcesetHandling_(){E4(this)}restoreMetadataTracksInIOSNativePlayer_(){const e=this.textTracks();let s;const a=()=>{s=[];for(let p=0;p<e.length;p++){const _=e[p];_.kind==="metadata"&&s.push({track:_,storedMode:_.mode})}};a(),e.addEventListener("change",a),this.on("dispose",()=>e.removeEventListener("change",a));const h=()=>{for(let p=0;p<s.length;p++){const _=s[p];_.track.mode==="disabled"&&_.track.mode!==_.storedMode&&(_.track.mode=_.storedMode)}e.removeEventListener("change",h)};this.on("webkitbeginfullscreen",()=>{e.removeEventListener("change",a),e.removeEventListener("change",h),e.addEventListener("change",h)}),this.on("webkitendfullscreen",()=>{e.removeEventListener("change",a),e.addEventListener("change",a),e.removeEventListener("change",h)})}overrideNative_(e,s){if(s!==this[`featuresNative${e}Tracks`])return;const a=e.toLowerCase();this[`${a}TracksListeners_`]&&Object.keys(this[`${a}TracksListeners_`]).forEach(h=>{this.el()[`${a}Tracks`].removeEventListener(h,this[`${a}TracksListeners_`][h])}),this[`featuresNative${e}Tracks`]=!s,this[`${a}TracksListeners_`]=null,this.proxyNativeTracksForType_(a)}overrideNativeAudioTracks(e){this.overrideNative_("Audio",e)}overrideNativeVideoTracks(e){this.overrideNative_("Video",e)}proxyNativeTracksForType_(e){const s=vn[e],a=this.el()[s.getterName],h=this[s.getterName]();if(!this[`featuresNative${s.capitalName}Tracks`]||!a||!a.addEventListener)return;const p={change:w=>{const I={type:"change",target:h,currentTarget:h,srcElement:h};h.trigger(I),e==="text"&&this[Vh.remoteText.getterName]().trigger(I)},addtrack(w){h.addTrack(w.track)},removetrack(w){h.removeTrack(w.track)}},_=function(){const w=[];for(let I=0;I<h.length;I++){let B=!1;for(let G=0;G<a.length;G++)if(a[G]===h[I]){B=!0;break}B||w.push(h[I])}for(;w.length;)h.removeTrack(w.shift())};this[s.getterName+"Listeners_"]=p,Object.keys(p).forEach(w=>{const I=p[w];a.addEventListener(w,I),this.on("dispose",B=>a.removeEventListener(w,I))}),this.on("loadstart",_),this.on("dispose",w=>this.off("loadstart",_))}proxyNativeTracks_(){vn.names.forEach(e=>{this.proxyNativeTracksForType_(e)})}createEl(){let e=this.options_.tag;if(!e||!(this.options_.playerElIngest||this.movingMediaElementInDOM)){if(e){const a=e.cloneNode(!0);e.parentNode&&e.parentNode.insertBefore(a,e),Xt.disposeMediaElement(e),e=a}else{e=document.createElement("video");const a=this.options_.tag&&Te(this.options_.tag),h=ee({},a);(!Ei||this.options_.nativeControlsForTouch!==!0)&&delete h.controls,de(e,Object.assign(h,{id:this.options_.techId,class:"vjs-tech"}))}e.playerId=this.options_.playerId}typeof this.options_.preload<"u"&&Xe(e,"preload",this.options_.preload),this.options_.disablePictureInPicture!==void 0&&(e.disablePictureInPicture=this.options_.disablePictureInPicture);const s=["loop","muted","playsinline","autoplay"];for(let a=0;a<s.length;a++){const h=s[a],p=this.options_[h];typeof p<"u"&&(p?Xe(e,h,h):mt(e,h),e[h]=p)}return e}handleLateInit_(e){if(e.networkState===0||e.networkState===3)return;if(e.readyState===0){let a=!1;const h=function(){a=!0};this.on("loadstart",h);const p=function(){a||this.trigger("loadstart")};this.on("loadedmetadata",p),this.ready(function(){this.off("loadstart",h),this.off("loadedmetadata",p),a||this.trigger("loadstart")});return}const s=["loadstart"];s.push("loadedmetadata"),e.readyState>=2&&s.push("loadeddata"),e.readyState>=3&&s.push("canplay"),e.readyState>=4&&s.push("canplaythrough"),this.ready(function(){s.forEach(function(a){this.trigger(a)},this)})}setScrubbing(e){this.isScrubbing_=e}scrubbing(){return this.isScrubbing_}setCurrentTime(e){try{this.isScrubbing_&&this.el_.fastSeek&&Gt?this.el_.fastSeek(e):this.el_.currentTime=e}catch(s){P(s,"Video is not ready. (Video.js)")}}duration(){if(this.el_.duration===1/0&&Oe&&$e&&this.el_.currentTime===0){const e=()=>{this.el_.currentTime>0&&(this.el_.duration===1/0&&this.trigger("durationchange"),this.off("timeupdate",e))};return this.on("timeupdate",e),NaN}return this.el_.duration||NaN}width(){return this.el_.offsetWidth}height(){return this.el_.offsetHeight}proxyWebkitFullscreen_(){if(!("webkitDisplayingFullscreen"in this.el_))return;const e=function(){this.trigger("fullscreenchange",{isFullscreen:!1}),this.el_.controls&&!this.options_.nativeControlsForTouch&&this.controls()&&(this.el_.controls=!1)},s=function(){"webkitPresentationMode"in this.el_&&this.el_.webkitPresentationMode!=="picture-in-picture"&&(this.one("webkitendfullscreen",e),this.trigger("fullscreenchange",{isFullscreen:!0,nativeIOSFullscreen:!0}))};this.on("webkitbeginfullscreen",s),this.on("dispose",()=>{this.off("webkitbeginfullscreen",s),this.off("webkitendfullscreen",e)})}supportsFullScreen(){return typeof this.el_.webkitEnterFullScreen=="function"}enterFullScreen(){const e=this.el_;if(e.paused&&e.networkState<=e.HAVE_METADATA)Wr(this.el_.play()),this.setTimeout(function(){e.pause();try{e.webkitEnterFullScreen()}catch(s){this.trigger("fullscreenerror",s)}},0);else try{e.webkitEnterFullScreen()}catch(s){this.trigger("fullscreenerror",s)}}exitFullScreen(){if(!this.el_.webkitDisplayingFullscreen){this.trigger("fullscreenerror",new Error("The video is not fullscreen"));return}this.el_.webkitExitFullScreen()}requestPictureInPicture(){return this.el_.requestPictureInPicture()}requestVideoFrameCallback(e){return this.featuresVideoFrameCallback&&!this.el_.webkitKeys?this.el_.requestVideoFrameCallback(e):super.requestVideoFrameCallback(e)}cancelVideoFrameCallback(e){this.featuresVideoFrameCallback&&!this.el_.webkitKeys?this.el_.cancelVideoFrameCallback(e):super.cancelVideoFrameCallback(e)}src(e){if(e===void 0)return this.el_.src;this.setSrc(e)}addSourceElement(e,s){if(!e)return P.error("Invalid source URL."),!1;const a={src:e};s&&(a.type=s);const h=Mt("source",{},a);return this.el_.appendChild(h),!0}removeSourceElement(e){if(!e)return P.error("Source URL is required to remove the source element."),!1;const s=this.el_.querySelectorAll("source");for(const a of s)if(a.src===e)return this.el_.removeChild(a),!0;return P.warn(`No matching source element found with src: ${e}`),!1}reset(){Xt.resetMediaElement(this.el_)}currentSrc(){return this.currentSource_?this.currentSource_.src:this.el_.currentSrc}setControls(e){this.el_.controls=!!e}addTextTrack(e,s,a){return this.featuresNativeTextTracks?this.el_.addTextTrack(e,s,a):super.addTextTrack(e,s,a)}createRemoteTextTrack(e){if(!this.featuresNativeTextTracks)return super.createRemoteTextTrack(e);const s=document.createElement("track");return e.kind&&(s.kind=e.kind),e.label&&(s.label=e.label),(e.language||e.srclang)&&(s.srclang=e.language||e.srclang),e.default&&(s.default=e.default),e.id&&(s.id=e.id),e.src&&(s.src=e.src),s}addRemoteTextTrack(e,s){const a=super.addRemoteTextTrack(e,s);return this.featuresNativeTextTracks&&this.el().appendChild(a),a}removeRemoteTextTrack(e){if(super.removeRemoteTextTrack(e),this.featuresNativeTextTracks){const s=this.$$("track");let a=s.length;for(;a--;)(e===s[a]||e===s[a].track)&&this.el().removeChild(s[a])}}getVideoPlaybackQuality(){if(typeof this.el().getVideoPlaybackQuality=="function")return this.el().getVideoPlaybackQuality();const e={};return typeof this.el().webkitDroppedFrameCount<"u"&&typeof this.el().webkitDecodedFrameCount<"u"&&(e.droppedVideoFrames=this.el().webkitDroppedFrameCount,e.totalVideoFrames=this.el().webkitDecodedFrameCount),window.performance&&(e.creationTime=window.performance.now()),e}}me(Xt,"TEST_VID",function(){if(!mi())return;const r=document.createElement("video"),e=document.createElement("track");return e.kind="captions",e.srclang="en",e.label="English",r.appendChild(e),r}),Xt.isSupported=function(){try{Xt.TEST_VID.volume=.5}catch{return!1}return!!(Xt.TEST_VID&&Xt.TEST_VID.canPlayType)},Xt.canPlayType=function(r){return Xt.TEST_VID.canPlayType(r)},Xt.canPlaySource=function(r,e){return Xt.canPlayType(r.type)},Xt.canControlVolume=function(){try{const r=Xt.TEST_VID.volume;Xt.TEST_VID.volume=r/2+.1;const e=r!==Xt.TEST_VID.volume;return e&&hi?(window.setTimeout(()=>{Xt&&Xt.prototype&&(Xt.prototype.featuresVolumeControl=r!==Xt.TEST_VID.volume)}),!1):e}catch{return!1}},Xt.canMuteVolume=function(){try{const r=Xt.TEST_VID.muted;return Xt.TEST_VID.muted=!r,Xt.TEST_VID.muted?Xe(Xt.TEST_VID,"muted","muted"):mt(Xt.TEST_VID,"muted","muted"),r!==Xt.TEST_VID.muted}catch{return!1}},Xt.canControlPlaybackRate=function(){if(Oe&&$e&&Jt<58)return!1;try{const r=Xt.TEST_VID.playbackRate;return Xt.TEST_VID.playbackRate=r/2+.1,r!==Xt.TEST_VID.playbackRate}catch{return!1}},Xt.canOverrideAttributes=function(){try{const r=()=>{};Object.defineProperty(document.createElement("video"),"src",{get:r,set:r}),Object.defineProperty(document.createElement("audio"),"src",{get:r,set:r}),Object.defineProperty(document.createElement("video"),"innerHTML",{get:r,set:r}),Object.defineProperty(document.createElement("audio"),"innerHTML",{get:r,set:r})}catch{return!1}return!0},Xt.supportsNativeTextTracks=function(){return Gt||hi&&$e},Xt.supportsNativeVideoTracks=function(){return!!(Xt.TEST_VID&&Xt.TEST_VID.videoTracks)},Xt.supportsNativeAudioTracks=function(){return!!(Xt.TEST_VID&&Xt.TEST_VID.audioTracks)},Xt.Events=["loadstart","suspend","abort","error","emptied","stalled","loadedmetadata","loadeddata","canplay","canplaythrough","playing","waiting","seeking","seeked","ended","durationchange","timeupdate","progress","play","pause","ratechange","resize","volumechange"],[["featuresMuteControl","canMuteVolume"],["featuresPlaybackRate","canControlPlaybackRate"],["featuresSourceset","canOverrideAttributes"],["featuresNativeTextTracks","supportsNativeTextTracks"],["featuresNativeVideoTracks","supportsNativeVideoTracks"],["featuresNativeAudioTracks","supportsNativeAudioTracks"]].forEach(function([r,e]){me(Xt.prototype,r,()=>Xt[e](),!0)}),Xt.prototype.featuresVolumeControl=Xt.canControlVolume(),Xt.prototype.movingMediaElementInDOM=!hi,Xt.prototype.featuresFullscreenResize=!0,Xt.prototype.featuresProgressEvents=!0,Xt.prototype.featuresTimeupdateEvents=!0,Xt.prototype.featuresVideoFrameCallback=!!(Xt.TEST_VID&&Xt.TEST_VID.requestVideoFrameCallback),Xt.disposeMediaElement=function(r){if(r){for(r.parentNode&&r.parentNode.removeChild(r);r.hasChildNodes();)r.removeChild(r.firstChild);r.removeAttribute("src"),typeof r.load=="function"&&function(){try{r.load()}catch{}}()}},Xt.resetMediaElement=function(r){if(!r)return;const e=r.querySelectorAll("source");let s=e.length;for(;s--;)r.removeChild(e[s]);r.removeAttribute("src"),typeof r.load=="function"&&function(){try{r.load()}catch{}}()},["muted","defaultMuted","autoplay","controls","loop","playsinline"].forEach(function(r){Xt.prototype[r]=function(){return this.el_[r]||this.el_.hasAttribute(r)}}),["muted","defaultMuted","autoplay","loop","playsinline"].forEach(function(r){Xt.prototype["set"+he(r)]=function(e){this.el_[r]=e,e?this.el_.setAttribute(r,r):this.el_.removeAttribute(r)}}),["paused","currentTime","buffered","volume","poster","preload","error","seeking","seekable","ended","playbackRate","defaultPlaybackRate","disablePictureInPicture","played","networkState","readyState","videoWidth","videoHeight","crossOrigin"].forEach(function(r){Xt.prototype[r]=function(){return this.el_[r]}}),["volume","src","poster","preload","playbackRate","defaultPlaybackRate","disablePictureInPicture","crossOrigin"].forEach(function(r){Xt.prototype["set"+he(r)]=function(e){this.el_[r]=e}}),["pause","load","play"].forEach(function(r){Xt.prototype[r]=function(){return this.el_[r]()}}),si.withSourceHandlers(Xt),Xt.nativeSourceHandler={},Xt.nativeSourceHandler.canPlayType=function(r){try{return Xt.TEST_VID.canPlayType(r)}catch{return""}},Xt.nativeSourceHandler.canHandleSource=function(r,e){if(r.type)return Xt.nativeSourceHandler.canPlayType(r.type);if(r.src){const s=lg(r.src);return Xt.nativeSourceHandler.canPlayType(`video/${s}`)}return""},Xt.nativeSourceHandler.handleSource=function(r,e,s){e.setSrc(r.src)},Xt.nativeSourceHandler.dispose=function(){},Xt.registerSourceHandler(Xt.nativeSourceHandler),si.registerTech("Html5",Xt);const oD=["progress","abort","suspend","emptied","stalled","loadedmetadata","loadeddata","timeupdate","resize","volumechange","texttrackchange"],s1={canplay:"CanPlay",canplaythrough:"CanPlayThrough",playing:"Playing",seeked:"Seeked"},n1=["tiny","xsmall","small","medium","large","xlarge","huge"],kT={};n1.forEach(r=>{const e=r.charAt(0)==="x"?`x-${r.substring(1)}`:r;kT[r]=`vjs-layout-${e}`});const S4={tiny:210,xsmall:320,small:425,medium:768,large:1440,xlarge:2560,huge:1/0};class xs extends Le{constructor(e,s,a){if(e.id=e.id||s.id||`vjs_video_${qi()}`,s=Object.assign(xs.getTagSettings(e),s),s.initChildren=!1,s.createEl=!1,s.evented=!1,s.reportTouchActivity=!1,!s.language){const _=e.closest("[lang]");_&&(s.language=_.getAttribute("lang"))}if(super(null,s,a),this.boundDocumentFullscreenChange_=_=>this.documentFullscreenChange_(_),this.boundFullWindowOnEscKey_=_=>this.fullWindowOnEscKey(_),this.boundUpdateStyleEl_=_=>this.updateStyleEl_(_),this.boundApplyInitTime_=_=>this.applyInitTime_(_),this.boundUpdateCurrentBreakpoint_=_=>this.updateCurrentBreakpoint_(_),this.boundHandleTechClick_=_=>this.handleTechClick_(_),this.boundHandleTechDoubleClick_=_=>this.handleTechDoubleClick_(_),this.boundHandleTechTouchStart_=_=>this.handleTechTouchStart_(_),this.boundHandleTechTouchMove_=_=>this.handleTechTouchMove_(_),this.boundHandleTechTouchEnd_=_=>this.handleTechTouchEnd_(_),this.boundHandleTechTap_=_=>this.handleTechTap_(_),this.boundUpdatePlayerHeightOnAudioOnlyMode_=_=>this.updatePlayerHeightOnAudioOnlyMode_(_),this.isFullscreen_=!1,this.log=x(this.id_),this.fsApi_=c,this.isPosterFromTech_=!1,this.queuedCallbacks_=[],this.isReady_=!1,this.hasStarted_=!1,this.userActive_=!1,this.debugEnabled_=!1,this.audioOnlyMode_=!1,this.audioPosterMode_=!1,this.audioOnlyCache_={controlBarHeight:null,playerHeight:null,hiddenChildren:[]},!this.options_||!this.options_.techOrder||!this.options_.techOrder.length)throw new Error("No techOrder specified. Did you overwrite videojs.options instead of just changing the properties you want to override?");if(this.tag=e,this.tagAttributes=e&&Te(e),this.language(this.options_.language),s.languages){const _={};Object.getOwnPropertyNames(s.languages).forEach(function(w){_[w.toLowerCase()]=s.languages[w]}),this.languages_=_}else this.languages_=xs.prototype.options_.languages;this.resetCache_(),this.poster_=s.poster||"",this.controls_=!!s.controls,e.controls=!1,e.removeAttribute("controls"),this.changingSrc_=!1,this.playCallbacks_=[],this.playTerminatedQueue_=[],e.hasAttribute("autoplay")?this.autoplay(!0):this.autoplay(this.options_.autoplay),s.plugins&&Object.keys(s.plugins).forEach(_=>{if(typeof this[_]!="function")throw new Error(`plugin "${_}" does not exist`)}),this.scrubbing_=!1,this.el_=this.createEl(),ue(this,{eventBusKey:"el_"}),this.fsApi_.requestFullscreen&&(_s(document,this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_),this.on(this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_)),this.fluid_&&this.on(["playerreset","resize"],this.boundUpdateStyleEl_);const h=ee(this.options_);if(s.plugins&&Object.keys(s.plugins).forEach(_=>{this[_](s.plugins[_])}),s.debug&&this.debug(!0),this.options_.playerOptions=h,this.middleware_=[],this.playbackRates(s.playbackRates),s.experimentalSvgIcons){const w=new window.DOMParser().parseFromString(G3,"image/svg+xml");if(w.querySelector("parsererror"))P.warn("Failed to load SVG Icons. Falling back to Font Icons."),this.options_.experimentalSvgIcons=null;else{const B=w.documentElement;B.style.display="none",this.el_.appendChild(B),this.addClass("vjs-svg-icons-enabled")}}this.initChildren(),this.isAudio(e.nodeName.toLowerCase()==="audio"),this.controls()?this.addClass("vjs-controls-enabled"):this.addClass("vjs-controls-disabled"),this.el_.setAttribute("role","region"),this.isAudio()?this.el_.setAttribute("aria-label",this.localize("Audio Player")):this.el_.setAttribute("aria-label",this.localize("Video Player")),this.isAudio()&&this.addClass("vjs-audio"),s.spatialNavigation&&s.spatialNavigation.enabled&&(this.spatialNavigation=new X3(this),this.addClass("vjs-spatial-navigation-enabled")),Ei&&this.addClass("vjs-touch-enabled"),hi||this.addClass("vjs-workinghover"),xs.players[this.id_]=this;const p=g.split(".")[0];this.addClass(`vjs-v${p}`),this.userActive(!0),this.reportUserActivity(),this.one("play",_=>this.listenForUserActivity_(_)),this.on("keydown",_=>this.handleKeyDown(_)),this.on("languagechange",_=>this.handleLanguagechange(_)),this.breakpoints(this.options_.breakpoints),this.responsive(this.options_.responsive),this.on("ready",()=>{this.audioPosterMode(this.options_.audioPosterMode),this.audioOnlyMode(this.options_.audioOnlyMode)})}dispose(){this.trigger("dispose"),this.off("dispose"),ss(document,this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_),ss(document,"keydown",this.boundFullWindowOnEscKey_),this.styleEl_&&this.styleEl_.parentNode&&(this.styleEl_.parentNode.removeChild(this.styleEl_),this.styleEl_=null),xs.players[this.id_]=null,this.tag&&this.tag.player&&(this.tag.player=null),this.el_&&this.el_.player&&(this.el_.player=null),this.tech_&&(this.tech_.dispose(),this.isPosterFromTech_=!1,this.poster_=""),this.playerElIngest_&&(this.playerElIngest_=null),this.tag&&(this.tag=null),$3(this),wr.names.forEach(e=>{const s=wr[e],a=this[s.getterName]();a&&a.off&&a.off()}),super.dispose({restoreEl:this.options_.restoreEl})}createEl(){let e=this.tag,s,a=this.playerElIngest_=e.parentNode&&e.parentNode.hasAttribute&&e.parentNode.hasAttribute("data-vjs-player");const h=this.tag.tagName.toLowerCase()==="video-js";a?s=this.el_=e.parentNode:h||(s=this.el_=super.createEl("div"));const p=Te(e);if(h){for(s=this.el_=e,e=this.tag=document.createElement("video");s.children.length;)e.appendChild(s.firstChild);Pi(s,"video-js")||qs(s,"video-js"),s.appendChild(e),a=this.playerElIngest_=s,Object.keys(s).forEach(I=>{try{e[I]=s[I]}catch{}})}e.setAttribute("tabindex","-1"),p.tabindex="-1",$e&&qt&&(e.setAttribute("role","application"),p.role="application"),e.removeAttribute("width"),e.removeAttribute("height"),"width"in p&&delete p.width,"height"in p&&delete p.height,Object.getOwnPropertyNames(p).forEach(function(I){h&&I==="class"||s.setAttribute(I,p[I]),h&&e.setAttribute(I,p[I])}),e.playerId=e.id,e.id+="_html5_api",e.className="vjs-tech",e.player=s.player=this,this.addClass("vjs-paused");const _=["IS_SMART_TV","IS_TIZEN","IS_WEBOS","IS_ANDROID","IS_IPAD","IS_IPHONE","IS_CHROMECAST_RECEIVER"].filter(I=>es[I]).map(I=>"vjs-device-"+I.substring(3).toLowerCase().replace(/\_/g,"-"));if(this.addClass(..._),window.VIDEOJS_NO_DYNAMIC_STYLE!==!0){this.styleEl_=ni("vjs-styles-dimensions");const I=xt(".vjs-styles-defaults"),B=xt("head");B.insertBefore(this.styleEl_,I?I.nextSibling:B.firstChild)}this.fill_=!1,this.fluid_=!1,this.width(this.options_.width),this.height(this.options_.height),this.fill(this.options_.fill),this.fluid(this.options_.fluid),this.aspectRatio(this.options_.aspectRatio),this.crossOrigin(this.options_.crossOrigin||this.options_.crossorigin);const w=e.getElementsByTagName("a");for(let I=0;I<w.length;I++){const B=w.item(I);qs(B,"vjs-hidden"),B.setAttribute("hidden","hidden")}return e.initNetworkState_=e.networkState,e.parentNode&&!a&&e.parentNode.insertBefore(s,e),Fe(e,s),this.children_.unshift(e),this.el_.setAttribute("lang",this.language_),this.el_.setAttribute("translate","no"),this.el_=s,s}crossOrigin(e){if(typeof e>"u")return this.techGet_("crossOrigin");if(e!==null&&e!=="anonymous"&&e!=="use-credentials"){P.warn(`crossOrigin must be null,  "anonymous" or "use-credentials", given "${e}"`);return}this.techCall_("setCrossOrigin",e),this.posterImage&&this.posterImage.crossOrigin(e)}width(e){return this.dimension("width",e)}height(e){return this.dimension("height",e)}dimension(e,s){const a=e+"_";if(s===void 0)return this[a]||0;if(s===""||s==="auto"){this[a]=void 0,this.updateStyleEl_();return}const h=parseFloat(s);if(isNaN(h)){P.error(`Improper value "${s}" supplied for for ${e}`);return}this[a]=h,this.updateStyleEl_()}fluid(e){if(e===void 0)return!!this.fluid_;this.fluid_=!!e,Ht(this)&&this.off(["playerreset","resize"],this.boundUpdateStyleEl_),e?(this.addClass("vjs-fluid"),this.fill(!1),Xs(this,()=>{this.on(["playerreset","resize"],this.boundUpdateStyleEl_)})):this.removeClass("vjs-fluid"),this.updateStyleEl_()}fill(e){if(e===void 0)return!!this.fill_;this.fill_=!!e,e?(this.addClass("vjs-fill"),this.fluid(!1)):this.removeClass("vjs-fill")}aspectRatio(e){if(e===void 0)return this.aspectRatio_;if(!/^\d+\:\d+$/.test(e))throw new Error("Improper value supplied for aspect ratio. The format should be width:height, for example 16:9.");this.aspectRatio_=e,this.fluid(!0),this.updateStyleEl_()}updateStyleEl_(){if(window.VIDEOJS_NO_DYNAMIC_STYLE===!0){const w=typeof this.width_=="number"?this.width_:this.options_.width,I=typeof this.height_=="number"?this.height_:this.options_.height,B=this.tech_&&this.tech_.el();B&&(w>=0&&(B.width=w),I>=0&&(B.height=I));return}let e,s,a,h;this.aspectRatio_!==void 0&&this.aspectRatio_!=="auto"?a=this.aspectRatio_:this.videoWidth()>0?a=this.videoWidth()+":"+this.videoHeight():a="16:9";const p=a.split(":"),_=p[1]/p[0];this.width_!==void 0?e=this.width_:this.height_!==void 0?e=this.height_/_:e=this.videoWidth()||300,this.height_!==void 0?s=this.height_:s=e*_,/^[^a-zA-Z]/.test(this.id())?h="dimensions-"+this.id():h=this.id()+"-dimensions",this.addClass(h),Zs(this.styleEl_,`
      .${h} {
        width: ${e}px;
        height: ${s}px;
      }

      .${h}.vjs-fluid:not(.vjs-audio-only-mode) {
        padding-top: ${_*100}%;
      }
    `)}loadTech_(e,s){this.tech_&&this.unloadTech_();const a=he(e),h=e.charAt(0).toLowerCase()+e.slice(1);a!=="Html5"&&this.tag&&(si.getTech("Html5").disposeMediaElement(this.tag),this.tag.player=null,this.tag=null),this.techName_=a,this.isReady_=!1;let p=this.autoplay();(typeof this.autoplay()=="string"||this.autoplay()===!0&&this.options_.normalizeAutoplay)&&(p=!1);const _={source:s,autoplay:p,nativeControlsForTouch:this.options_.nativeControlsForTouch,playerId:this.id(),techId:`${this.id()}_${h}_api`,playsinline:this.options_.playsinline,preload:this.options_.preload,loop:this.options_.loop,disablePictureInPicture:this.options_.disablePictureInPicture,muted:this.options_.muted,poster:this.poster(),language:this.language(),playerElIngest:this.playerElIngest_||!1,"vtt.js":this.options_["vtt.js"],canOverridePoster:!!this.options_.techCanOverridePoster,enableSourceset:this.options_.enableSourceset};wr.names.forEach(I=>{const B=wr[I];_[B.getterName]=this[B.privateName]}),Object.assign(_,this.options_[a]),Object.assign(_,this.options_[h]),Object.assign(_,this.options_[e.toLowerCase()]),this.tag&&(_.tag=this.tag),s&&s.src===this.cache_.src&&this.cache_.currentTime>0&&(_.startTime=this.cache_.currentTime);const w=si.getTech(e);if(!w)throw new Error(`No Tech named '${a}' exists! '${a}' should be registered using videojs.registerTech()'`);this.tech_=new w(_),this.tech_.ready(Ae(this,this.handleTechReady_),!0),f_.jsonToTextTracks(this.textTracksJson_||[],this.tech_),oD.forEach(I=>{this.on(this.tech_,I,B=>this[`handleTech${he(I)}_`](B))}),Object.keys(s1).forEach(I=>{this.on(this.tech_,I,B=>{if(this.tech_.playbackRate()===0&&this.tech_.seeking()){this.queuedCallbacks_.push({callback:this[`handleTech${s1[I]}_`].bind(this),event:B});return}this[`handleTech${s1[I]}_`](B)})}),this.on(this.tech_,"loadstart",I=>this.handleTechLoadStart_(I)),this.on(this.tech_,"sourceset",I=>this.handleTechSourceset_(I)),this.on(this.tech_,"waiting",I=>this.handleTechWaiting_(I)),this.on(this.tech_,"ended",I=>this.handleTechEnded_(I)),this.on(this.tech_,"seeking",I=>this.handleTechSeeking_(I)),this.on(this.tech_,"play",I=>this.handleTechPlay_(I)),this.on(this.tech_,"pause",I=>this.handleTechPause_(I)),this.on(this.tech_,"durationchange",I=>this.handleTechDurationChange_(I)),this.on(this.tech_,"fullscreenchange",(I,B)=>this.handleTechFullscreenChange_(I,B)),this.on(this.tech_,"fullscreenerror",(I,B)=>this.handleTechFullscreenError_(I,B)),this.on(this.tech_,"enterpictureinpicture",I=>this.handleTechEnterPictureInPicture_(I)),this.on(this.tech_,"leavepictureinpicture",I=>this.handleTechLeavePictureInPicture_(I)),this.on(this.tech_,"error",I=>this.handleTechError_(I)),this.on(this.tech_,"posterchange",I=>this.handleTechPosterChange_(I)),this.on(this.tech_,"textdata",I=>this.handleTechTextData_(I)),this.on(this.tech_,"ratechange",I=>this.handleTechRateChange_(I)),this.on(this.tech_,"loadedmetadata",this.boundUpdateStyleEl_),this.usingNativeControls(this.techGet_("controls")),this.controls()&&!this.usingNativeControls()&&this.addTechControlsListeners_(),this.tech_.el().parentNode!==this.el()&&(a!=="Html5"||!this.tag)&&Fe(this.tech_.el(),this.el()),this.tag&&(this.tag.player=null,this.tag=null)}unloadTech_(){wr.names.forEach(e=>{const s=wr[e];this[s.privateName]=this[s.getterName]()}),this.textTracksJson_=f_.textTracksToJson(this.tech_),this.isReady_=!1,this.tech_.dispose(),this.tech_=!1,this.isPosterFromTech_&&(this.poster_="",this.trigger("posterchange")),this.isPosterFromTech_=!1}tech(e){return e===void 0&&P.warn(`Using the tech directly can be dangerous. I hope you know what you're doing.
See https://github.com/videojs/video.js/issues/2617 for more info.
`),this.tech_}version(){return{"video.js":g}}addTechControlsListeners_(){this.removeTechControlsListeners_(),this.on(this.tech_,"click",this.boundHandleTechClick_),this.on(this.tech_,"dblclick",this.boundHandleTechDoubleClick_),this.on(this.tech_,"touchstart",this.boundHandleTechTouchStart_),this.on(this.tech_,"touchmove",this.boundHandleTechTouchMove_),this.on(this.tech_,"touchend",this.boundHandleTechTouchEnd_),this.on(this.tech_,"tap",this.boundHandleTechTap_)}removeTechControlsListeners_(){this.off(this.tech_,"tap",this.boundHandleTechTap_),this.off(this.tech_,"touchstart",this.boundHandleTechTouchStart_),this.off(this.tech_,"touchmove",this.boundHandleTechTouchMove_),this.off(this.tech_,"touchend",this.boundHandleTechTouchEnd_),this.off(this.tech_,"click",this.boundHandleTechClick_),this.off(this.tech_,"dblclick",this.boundHandleTechDoubleClick_)}handleTechReady_(){this.triggerReady(),this.cache_.volume&&this.techCall_("setVolume",this.cache_.volume),this.handleTechPosterChange_(),this.handleTechDurationChange_()}handleTechLoadStart_(){this.removeClass("vjs-ended","vjs-seeking"),this.error(null),this.handleTechDurationChange_(),this.paused()?(this.hasStarted(!1),this.trigger("loadstart")):this.trigger("loadstart"),this.manualAutoplay_(this.autoplay()===!0&&this.options_.normalizeAutoplay?"play":this.autoplay())}manualAutoplay_(e){if(!this.tech_||typeof e!="string")return;const s=()=>{const h=this.muted();this.muted(!0);const p=()=>{this.muted(h)};this.playTerminatedQueue_.push(p);const _=this.play();if(ho(_))return _.catch(w=>{throw p(),new Error(`Rejection at manualAutoplay. Restoring muted value. ${w||""}`)})};let a;if(e==="any"&&!this.muted()?(a=this.play(),ho(a)&&(a=a.catch(s))):e==="muted"&&!this.muted()?a=s():a=this.play(),!!ho(a))return a.then(()=>{this.trigger({type:"autoplay-success",autoplay:e})}).catch(()=>{this.trigger({type:"autoplay-failure",autoplay:e})})}updateSourceCaches_(e=""){let s=e,a="";typeof s!="string"&&(s=e.src,a=e.type),this.cache_.source=this.cache_.source||{},this.cache_.sources=this.cache_.sources||[],s&&!a&&(a=q3(this,s)),this.cache_.source=ee({},e,{src:s,type:a});const h=this.cache_.sources.filter(I=>I.src&&I.src===s),p=[],_=this.$$("source"),w=[];for(let I=0;I<_.length;I++){const B=Te(_[I]);p.push(B),B.src&&B.src===s&&w.push(B.src)}w.length&&!h.length?this.cache_.sources=p:h.length||(this.cache_.sources=[this.cache_.source]),this.cache_.src=s}handleTechSourceset_(e){if(!this.changingSrc_){let s=p=>this.updateSourceCaches_(p);const a=this.currentSource().src,h=e.src;a&&!/^blob:/.test(a)&&/^blob:/.test(h)&&(!this.lastSource_||this.lastSource_.tech!==h&&this.lastSource_.player!==a)&&(s=()=>{}),s(h),e.src||this.tech_.any(["sourceset","loadstart"],p=>{if(p.type==="sourceset")return;const _=this.techGet_("currentSrc");this.lastSource_.tech=_,this.updateSourceCaches_(_)})}this.lastSource_={player:this.currentSource().src,tech:e.src},this.trigger({src:e.src,type:"sourceset"})}hasStarted(e){if(e===void 0)return this.hasStarted_;e!==this.hasStarted_&&(this.hasStarted_=e,this.hasStarted_?this.addClass("vjs-has-started"):this.removeClass("vjs-has-started"))}handleTechPlay_(){this.removeClass("vjs-ended","vjs-paused"),this.addClass("vjs-playing"),this.hasStarted(!0),this.trigger("play")}handleTechRateChange_(){this.tech_.playbackRate()>0&&this.cache_.lastPlaybackRate===0&&(this.queuedCallbacks_.forEach(e=>e.callback(e.event)),this.queuedCallbacks_=[]),this.cache_.lastPlaybackRate=this.tech_.playbackRate(),this.trigger("ratechange")}handleTechWaiting_(){this.addClass("vjs-waiting"),this.trigger("waiting");const e=this.currentTime(),s=()=>{e!==this.currentTime()&&(this.removeClass("vjs-waiting"),this.off("timeupdate",s))};this.on("timeupdate",s)}handleTechCanPlay_(){this.removeClass("vjs-waiting"),this.trigger("canplay")}handleTechCanPlayThrough_(){this.removeClass("vjs-waiting"),this.trigger("canplaythrough")}handleTechPlaying_(){this.removeClass("vjs-waiting"),this.trigger("playing")}handleTechSeeking_(){this.addClass("vjs-seeking"),this.trigger("seeking")}handleTechSeeked_(){this.removeClass("vjs-seeking","vjs-ended"),this.trigger("seeked")}handleTechPause_(){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.trigger("pause")}handleTechEnded_(){this.addClass("vjs-ended"),this.removeClass("vjs-waiting"),this.options_.loop?(this.currentTime(0),this.play()):this.paused()||this.pause(),this.trigger("ended")}handleTechDurationChange_(){this.duration(this.techGet_("duration"))}handleTechClick_(e){this.controls_&&(this.options_===void 0||this.options_.userActions===void 0||this.options_.userActions.click===void 0||this.options_.userActions.click!==!1)&&(this.options_!==void 0&&this.options_.userActions!==void 0&&typeof this.options_.userActions.click=="function"?this.options_.userActions.click.call(this,e):this.paused()?Wr(this.play()):this.pause())}handleTechDoubleClick_(e){if(!this.controls_)return;Array.prototype.some.call(this.$$(".vjs-control-bar, .vjs-modal-dialog"),a=>a.contains(e.target))||(this.options_===void 0||this.options_.userActions===void 0||this.options_.userActions.doubleClick===void 0||this.options_.userActions.doubleClick!==!1)&&(this.options_!==void 0&&this.options_.userActions!==void 0&&typeof this.options_.userActions.doubleClick=="function"?this.options_.userActions.doubleClick.call(this,e):this.isInPictureInPicture()&&!document.pictureInPictureElement?this.exitPictureInPicture():this.isFullscreen()?this.exitFullscreen():this.requestFullscreen())}handleTechTap_(){this.userActive(!this.userActive())}handleTechTouchStart_(){this.userWasActive=this.userActive()}handleTechTouchMove_(){this.userWasActive&&this.reportUserActivity()}handleTechTouchEnd_(e){e.cancelable&&e.preventDefault()}toggleFullscreenClass_(){this.isFullscreen()?this.addClass("vjs-fullscreen"):this.removeClass("vjs-fullscreen")}documentFullscreenChange_(e){const s=e.target.player;if(s&&s!==this)return;const a=this.el();let h=document[this.fsApi_.fullscreenElement]===a;!h&&a.matches&&(h=a.matches(":"+this.fsApi_.fullscreen)),this.isFullscreen(h)}handleTechFullscreenChange_(e,s){s&&(s.nativeIOSFullscreen&&(this.addClass("vjs-ios-native-fs"),this.tech_.one("webkitendfullscreen",()=>{this.removeClass("vjs-ios-native-fs")})),this.isFullscreen(s.isFullscreen))}handleTechFullscreenError_(e,s){this.trigger("fullscreenerror",s)}togglePictureInPictureClass_(){this.isInPictureInPicture()?this.addClass("vjs-picture-in-picture"):this.removeClass("vjs-picture-in-picture")}handleTechEnterPictureInPicture_(e){this.isInPictureInPicture(!0)}handleTechLeavePictureInPicture_(e){this.isInPictureInPicture(!1)}handleTechError_(){const e=this.tech_.error();e&&this.error(e)}handleTechTextData_(){let e=null;arguments.length>1&&(e=arguments[1]),this.trigger("textdata",e)}getCache(){return this.cache_}resetCache_(){this.cache_={currentTime:0,initTime:0,inactivityTimeout:this.options_.inactivityTimeout,duration:NaN,lastVolume:1,lastPlaybackRate:this.defaultPlaybackRate(),media:null,src:"",source:{},sources:[],playbackRates:[],volume:1}}techCall_(e,s){this.ready(function(){if(e in H3)return U3(this.middleware_,this.tech_,e,s);if(e in gP)return pP(this.middleware_,this.tech_,e,s);try{this.tech_&&this.tech_[e](s)}catch(a){throw P(a),a}},!0)}techGet_(e){if(!(!this.tech_||!this.tech_.isReady_)){if(e in j3)return B3(this.middleware_,this.tech_,e);if(e in gP)return pP(this.middleware_,this.tech_,e);try{return this.tech_[e]()}catch(s){throw this.tech_[e]===void 0?(P(`Video.js: ${e} method not defined for ${this.techName_} playback technology.`,s),s):s.name==="TypeError"?(P(`Video.js: ${e} unavailable on ${this.techName_} playback technology element.`,s),this.tech_.isReady_=!1,s):(P(s),s)}}}play(){return new Promise(e=>{this.play_(e)})}play_(e=Wr){this.playCallbacks_.push(e);const s=!!(!this.changingSrc_&&(this.src()||this.currentSrc())),a=!!(Gt||hi);if(this.waitToPlay_&&(this.off(["ready","loadstart"],this.waitToPlay_),this.waitToPlay_=null),!this.isReady_||!s){this.waitToPlay_=_=>{this.play_()},this.one(["ready","loadstart"],this.waitToPlay_),!s&&a&&this.load();return}const h=this.techGet_("play");a&&this.hasClass("vjs-ended")&&this.resetProgressBar_(),h===null?this.runPlayTerminatedQueue_():this.runPlayCallbacks_(h)}runPlayTerminatedQueue_(){const e=this.playTerminatedQueue_.slice(0);this.playTerminatedQueue_=[],e.forEach(function(s){s()})}runPlayCallbacks_(e){const s=this.playCallbacks_.slice(0);this.playCallbacks_=[],this.playTerminatedQueue_=[],s.forEach(function(a){a(e)})}pause(){this.techCall_("pause")}paused(){return this.techGet_("paused")!==!1}played(){return this.techGet_("played")||ns(0,0)}scrubbing(e){if(typeof e>"u")return this.scrubbing_;this.scrubbing_=!!e,this.techCall_("setScrubbing",this.scrubbing_),e?this.addClass("vjs-scrubbing"):this.removeClass("vjs-scrubbing")}currentTime(e){if(e===void 0)return this.cache_.currentTime=this.techGet_("currentTime")||0,this.cache_.currentTime;if(e<0&&(e=0),!this.isReady_||this.changingSrc_||!this.tech_||!this.tech_.isReady_){this.cache_.initTime=e,this.off("canplay",this.boundApplyInitTime_),this.one("canplay",this.boundApplyInitTime_);return}this.techCall_("setCurrentTime",e),this.cache_.initTime=0,isFinite(e)&&(this.cache_.currentTime=Number(e))}applyInitTime_(){this.currentTime(this.cache_.initTime)}duration(e){if(e===void 0)return this.cache_.duration!==void 0?this.cache_.duration:NaN;e=parseFloat(e),e<0&&(e=1/0),e!==this.cache_.duration&&(this.cache_.duration=e,e===1/0?this.addClass("vjs-live"):this.removeClass("vjs-live"),isNaN(e)||this.trigger("durationchange"))}remainingTime(){return this.duration()-this.currentTime()}remainingTimeDisplay(){return Math.floor(this.duration())-Math.floor(this.currentTime())}buffered(){let e=this.techGet_("buffered");return(!e||!e.length)&&(e=ns(0,0)),e}seekable(){let e=this.techGet_("seekable");return(!e||!e.length)&&(e=ns(0,0)),e}seeking(){return this.techGet_("seeking")}ended(){return this.techGet_("ended")}networkState(){return this.techGet_("networkState")}readyState(){return this.techGet_("readyState")}bufferedPercent(){return nr(this.buffered(),this.duration())}bufferedEnd(){const e=this.buffered(),s=this.duration();let a=e.end(e.length-1);return a>s&&(a=s),a}volume(e){let s;if(e!==void 0){s=Math.max(0,Math.min(1,e)),this.cache_.volume=s,this.techCall_("setVolume",s),s>0&&this.lastVolume_(s);return}return s=parseFloat(this.techGet_("volume")),isNaN(s)?1:s}muted(e){if(e!==void 0){this.techCall_("setMuted",e);return}return this.techGet_("muted")||!1}defaultMuted(e){return e!==void 0&&this.techCall_("setDefaultMuted",e),this.techGet_("defaultMuted")||!1}lastVolume_(e){if(e!==void 0&&e!==0){this.cache_.lastVolume=e;return}return this.cache_.lastVolume}supportsFullScreen(){return this.techGet_("supportsFullScreen")||!1}isFullscreen(e){if(e!==void 0){const s=this.isFullscreen_;this.isFullscreen_=!!e,this.isFullscreen_!==s&&this.fsApi_.prefixed&&this.trigger("fullscreenchange"),this.toggleFullscreenClass_();return}return this.isFullscreen_}requestFullscreen(e){this.isInPictureInPicture()&&this.exitPictureInPicture();const s=this;return new Promise((a,h)=>{function p(){s.off("fullscreenerror",w),s.off("fullscreenchange",_)}function _(){p(),a()}function w(B,G){p(),h(G)}s.one("fullscreenchange",_),s.one("fullscreenerror",w);const I=s.requestFullscreenHelper_(e);I&&(I.then(p,p),I.then(a,h))})}requestFullscreenHelper_(e){let s;if(this.fsApi_.prefixed||(s=this.options_.fullscreen&&this.options_.fullscreen.options||{},e!==void 0&&(s=e)),this.fsApi_.requestFullscreen){const a=this.el_[this.fsApi_.requestFullscreen](s);return a&&a.then(()=>this.isFullscreen(!0),()=>this.isFullscreen(!1)),a}else this.tech_.supportsFullScreen()&&!this.options_.preferFullWindow?this.techCall_("enterFullScreen"):this.enterFullWindow()}exitFullscreen(){const e=this;return new Promise((s,a)=>{function h(){e.off("fullscreenerror",_),e.off("fullscreenchange",p)}function p(){h(),s()}function _(I,B){h(),a(B)}e.one("fullscreenchange",p),e.one("fullscreenerror",_);const w=e.exitFullscreenHelper_();w&&(w.then(h,h),w.then(s,a))})}exitFullscreenHelper_(){if(this.fsApi_.requestFullscreen){const e=document[this.fsApi_.exitFullscreen]();return e&&Wr(e.then(()=>this.isFullscreen(!1))),e}else this.tech_.supportsFullScreen()&&!this.options_.preferFullWindow?this.techCall_("exitFullScreen"):this.exitFullWindow()}enterFullWindow(){this.isFullscreen(!0),this.isFullWindow=!0,this.docOrigOverflow=document.documentElement.style.overflow,_s(document,"keydown",this.boundFullWindowOnEscKey_),document.documentElement.style.overflow="hidden",qs(document.body,"vjs-full-window"),this.trigger("enterFullWindow")}fullWindowOnEscKey(e){e.key==="Escape"&&this.isFullscreen()===!0&&(this.isFullWindow?this.exitFullWindow():this.exitFullscreen())}exitFullWindow(){this.isFullscreen(!1),this.isFullWindow=!1,ss(document,"keydown",this.boundFullWindowOnEscKey_),document.documentElement.style.overflow=this.docOrigOverflow,Bt(document.body,"vjs-full-window"),this.trigger("exitFullWindow")}disablePictureInPicture(e){if(e===void 0)return this.techGet_("disablePictureInPicture");this.techCall_("setDisablePictureInPicture",e),this.options_.disablePictureInPicture=e,this.trigger("disablepictureinpicturechanged")}isInPictureInPicture(e){if(e!==void 0){this.isInPictureInPicture_=!!e,this.togglePictureInPictureClass_();return}return!!this.isInPictureInPicture_}requestPictureInPicture(){if(this.options_.enableDocumentPictureInPicture&&window.documentPictureInPicture){const e=document.createElement(this.el().tagName);return e.classList=this.el().classList,e.classList.add("vjs-pip-container"),this.posterImage&&e.appendChild(this.posterImage.el().cloneNode(!0)),this.titleBar&&e.appendChild(this.titleBar.el().cloneNode(!0)),e.appendChild(Mt("p",{className:"vjs-pip-text"},{},this.localize("Playing in picture-in-picture"))),window.documentPictureInPicture.requestWindow({width:this.videoWidth(),height:this.videoHeight()}).then(s=>(qe(s),this.el_.parentNode.insertBefore(e,this.el_),s.document.body.appendChild(this.el_),s.document.body.classList.add("vjs-pip-window"),this.player_.isInPictureInPicture(!0),this.player_.trigger({type:"enterpictureinpicture",pipWindow:s}),s.addEventListener("pagehide",a=>{const h=a.target.querySelector(".video-js");e.parentNode.replaceChild(h,e),this.player_.isInPictureInPicture(!1),this.player_.trigger("leavepictureinpicture")}),s))}return"pictureInPictureEnabled"in document&&this.disablePictureInPicture()===!1?this.techGet_("requestPictureInPicture"):Promise.reject("No PiP mode is available")}exitPictureInPicture(){if(window.documentPictureInPicture&&window.documentPictureInPicture.window)return window.documentPictureInPicture.window.close(),Promise.resolve();if("pictureInPictureEnabled"in document)return document.exitPictureInPicture()}handleKeyDown(e){const{userActions:s}=this.options_;!s||!s.hotkeys||(h=>{const p=h.tagName.toLowerCase();if(h.isContentEditable)return!0;const _=["button","checkbox","hidden","radio","reset","submit"];return p==="input"?_.indexOf(h.type)===-1:["textarea"].indexOf(p)!==-1})(this.el_.ownerDocument.activeElement)||(typeof s.hotkeys=="function"?s.hotkeys.call(this,e):this.handleHotkeys(e))}handleHotkeys(e){const s=this.options_.userActions?this.options_.userActions.hotkeys:{},{fullscreenKey:a=_=>e.key.toLowerCase()==="f",muteKey:h=_=>e.key.toLowerCase()==="m",playPauseKey:p=_=>e.key.toLowerCase()==="k"||e.key.toLowerCase()===" "}=s;if(a.call(this,e)){e.preventDefault(),e.stopPropagation();const _=Le.getComponent("FullscreenToggle");document[this.fsApi_.fullscreenEnabled]!==!1&&_.prototype.handleClick.call(this,e)}else h.call(this,e)?(e.preventDefault(),e.stopPropagation(),Le.getComponent("MuteToggle").prototype.handleClick.call(this,e)):p.call(this,e)&&(e.preventDefault(),e.stopPropagation(),Le.getComponent("PlayToggle").prototype.handleClick.call(this,e))}canPlayType(e){let s;for(let a=0,h=this.options_.techOrder;a<h.length;a++){const p=h[a];let _=si.getTech(p);if(_||(_=Le.getComponent(p)),!_){P.error(`The "${p}" tech is undefined. Skipped browser support check for that tech.`);continue}if(_.isSupported()&&(s=_.canPlayType(e),s))return s}return""}selectSource(e){const s=this.options_.techOrder.map(w=>[w,si.getTech(w)]).filter(([w,I])=>I?I.isSupported():(P.error(`The "${w}" tech is undefined. Skipped browser support check for that tech.`),!1)),a=function(w,I,B){let G;return w.some(se=>I.some(pe=>{if(G=B(se,pe),G)return!0})),G};let h;const p=w=>(I,B)=>w(B,I),_=([w,I],B)=>{if(I.canPlaySource(B,this.options_[w.toLowerCase()]))return{source:B,tech:w}};return this.options_.sourceOrder?h=a(e,s,p(_)):h=a(s,e,_),h||!1}handleSrc_(e,s){if(typeof e>"u")return this.cache_.src||"";this.resetRetryOnError_&&this.resetRetryOnError_();const a=mP(e);if(!a.length){this.setTimeout(function(){this.error({code:4,message:this.options_.notSupportedMessage})},0);return}if(this.changingSrc_=!0,s||(this.cache_.sources=a),this.updateSourceCaches_(a[0]),O3(this,a[0],(h,p)=>{if(this.middleware_=p,s||(this.cache_.sources=a),this.updateSourceCaches_(h),this.src_(h)){if(a.length>1)return this.handleSrc_(a.slice(1));this.changingSrc_=!1,this.setTimeout(function(){this.error({code:4,message:this.options_.notSupportedMessage})},0),this.triggerReady();return}F3(p,this.tech_)}),a.length>1){const h=()=>{this.error(null),this.handleSrc_(a.slice(1),!0)},p=()=>{this.off("error",h)};this.one("error",h),this.one("playing",p),this.resetRetryOnError_=()=>{this.off("error",h),this.off("playing",p)}}}src(e){return this.handleSrc_(e,!1)}src_(e){const s=this.selectSource([e]);return s?we(s.tech,this.techName_)?(this.ready(function(){this.tech_.constructor.prototype.hasOwnProperty("setSource")?this.techCall_("setSource",e):this.techCall_("src",e.src),this.changingSrc_=!1},!0),!1):(this.changingSrc_=!0,this.loadTech_(s.tech,s.source),this.tech_.ready(()=>{this.changingSrc_=!1}),!1):!0}addSourceElement(e,s){return this.tech_?this.tech_.addSourceElement(e,s):!1}removeSourceElement(e){return this.tech_?this.tech_.removeSourceElement(e):!1}load(){if(this.tech_&&this.tech_.vhs){this.src(this.currentSource());return}this.techCall_("load")}reset(){if(this.paused())this.doReset_();else{const e=this.play();Wr(e.then(()=>this.doReset_()))}}doReset_(){this.tech_&&this.tech_.clearTracks("text"),this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.resetCache_(),this.poster(""),this.loadTech_(this.options_.techOrder[0],null),this.techCall_("reset"),this.resetControlBarUI_(),this.error(null),this.titleBar&&this.titleBar.update({title:void 0,description:void 0}),Ht(this)&&this.trigger("playerreset")}resetControlBarUI_(){this.resetProgressBar_(),this.resetPlaybackRate_(),this.resetVolumeBar_()}resetProgressBar_(){this.currentTime(0);const{currentTimeDisplay:e,durationDisplay:s,progressControl:a,remainingTimeDisplay:h}=this.controlBar||{},{seekBar:p}=a||{};e&&e.updateContent(),s&&s.updateContent(),h&&h.updateContent(),p&&(p.update(),p.loadProgressBar&&p.loadProgressBar.update())}resetPlaybackRate_(){this.playbackRate(this.defaultPlaybackRate()),this.handleTechRateChange_()}resetVolumeBar_(){this.volume(1),this.trigger("volumechange")}currentSources(){const e=this.currentSource(),s=[];return Object.keys(e).length!==0&&s.push(e),this.cache_.sources||s}currentSource(){return this.cache_.source||{}}currentSrc(){return this.currentSource()&&this.currentSource().src||""}currentType(){return this.currentSource()&&this.currentSource().type||""}preload(e){if(e!==void 0){this.techCall_("setPreload",e),this.options_.preload=e;return}return this.techGet_("preload")}autoplay(e){if(e===void 0)return this.options_.autoplay||!1;let s;typeof e=="string"&&/(any|play|muted)/.test(e)||e===!0&&this.options_.normalizeAutoplay?(this.options_.autoplay=e,this.manualAutoplay_(typeof e=="string"?e:"play"),s=!1):e?this.options_.autoplay=!0:this.options_.autoplay=!1,s=typeof s>"u"?this.options_.autoplay:s,this.tech_&&this.techCall_("setAutoplay",s)}playsinline(e){return e!==void 0&&(this.techCall_("setPlaysinline",e),this.options_.playsinline=e),this.techGet_("playsinline")}loop(e){if(e!==void 0){this.techCall_("setLoop",e),this.options_.loop=e;return}return this.techGet_("loop")}poster(e){if(e===void 0)return this.poster_;e||(e=""),e!==this.poster_&&(this.poster_=e,this.techCall_("setPoster",e),this.isPosterFromTech_=!1,this.trigger("posterchange"))}handleTechPosterChange_(){if((!this.poster_||this.options_.techCanOverridePoster)&&this.tech_&&this.tech_.poster){const e=this.tech_.poster()||"";e!==this.poster_&&(this.poster_=e,this.isPosterFromTech_=!0,this.trigger("posterchange"))}}controls(e){if(e===void 0)return!!this.controls_;e=!!e,this.controls_!==e&&(this.controls_=e,this.usingNativeControls()&&this.techCall_("setControls",e),this.controls_?(this.removeClass("vjs-controls-disabled"),this.addClass("vjs-controls-enabled"),this.trigger("controlsenabled"),this.usingNativeControls()||this.addTechControlsListeners_()):(this.removeClass("vjs-controls-enabled"),this.addClass("vjs-controls-disabled"),this.trigger("controlsdisabled"),this.usingNativeControls()||this.removeTechControlsListeners_()))}usingNativeControls(e){if(e===void 0)return!!this.usingNativeControls_;e=!!e,this.usingNativeControls_!==e&&(this.usingNativeControls_=e,this.usingNativeControls_?(this.addClass("vjs-using-native-controls"),this.trigger("usingnativecontrols")):(this.removeClass("vjs-using-native-controls"),this.trigger("usingcustomcontrols")))}error(e){if(e===void 0)return this.error_||null;if(i("beforeerror").forEach(s=>{const a=s(this,e);if(!(K(a)&&!Array.isArray(a)||typeof a=="string"||typeof a=="number"||a===null)){this.log.error("please return a value that MediaError expects in beforeerror hooks");return}e=a}),this.options_.suppressNotSupportedError&&e&&e.code===4){const s=function(){this.error(e)};this.options_.suppressNotSupportedError=!1,this.any(["click","touchstart"],s),this.one("loadstart",function(){this.off(["click","touchstart"],s)});return}if(e===null){this.error_=null,this.removeClass("vjs-error"),this.errorDisplay&&this.errorDisplay.close();return}this.error_=new bs(e),this.addClass("vjs-error"),P.error(`(CODE:${this.error_.code} ${bs.errorTypes[this.error_.code]})`,this.error_.message,this.error_),this.trigger("error"),i("error").forEach(s=>s(this,this.error_))}reportUserActivity(e){this.userActivity_=!0}userActive(e){if(e===void 0)return this.userActive_;if(e=!!e,e!==this.userActive_){if(this.userActive_=e,this.userActive_){this.userActivity_=!0,this.removeClass("vjs-user-inactive"),this.addClass("vjs-user-active"),this.trigger("useractive");return}this.tech_&&this.tech_.one("mousemove",function(s){s.stopPropagation(),s.preventDefault()}),this.userActivity_=!1,this.removeClass("vjs-user-active"),this.addClass("vjs-user-inactive"),this.trigger("userinactive")}}listenForUserActivity_(){let e,s,a;const h=Ae(this,this.reportUserActivity),p=function(se){(se.screenX!==s||se.screenY!==a)&&(s=se.screenX,a=se.screenY,h())},_=function(){h(),this.clearInterval(e),e=this.setInterval(h,250)},w=function(se){h(),this.clearInterval(e)};this.on("mousedown",_),this.on("mousemove",p),this.on("mouseup",w),this.on("mouseleave",w);const I=this.getChild("controlBar");I&&!hi&&!Oe&&(I.on("mouseenter",function(se){this.player().options_.inactivityTimeout!==0&&(this.player().cache_.inactivityTimeout=this.player().options_.inactivityTimeout),this.player().options_.inactivityTimeout=0}),I.on("mouseleave",function(se){this.player().options_.inactivityTimeout=this.player().cache_.inactivityTimeout})),this.on("keydown",h),this.on("keyup",h);let B;const G=function(){if(!this.userActivity_)return;this.userActivity_=!1,this.userActive(!0),this.clearTimeout(B);const se=this.options_.inactivityTimeout;se<=0||(B=this.setTimeout(function(){this.userActivity_||this.userActive(!1)},se))};this.setInterval(G,250)}playbackRate(e){if(e!==void 0){this.techCall_("setPlaybackRate",e);return}return this.tech_&&this.tech_.featuresPlaybackRate?this.cache_.lastPlaybackRate||this.techGet_("playbackRate"):1}defaultPlaybackRate(e){return e!==void 0?this.techCall_("setDefaultPlaybackRate",e):this.tech_&&this.tech_.featuresPlaybackRate?this.techGet_("defaultPlaybackRate"):1}isAudio(e){if(e!==void 0){this.isAudio_=!!e;return}return!!this.isAudio_}updatePlayerHeightOnAudioOnlyMode_(){const e=this.getChild("ControlBar");!e||this.audioOnlyCache_.controlBarHeight===e.currentHeight()||(this.audioOnlyCache_.controlBarHeight=e.currentHeight(),this.height(this.audioOnlyCache_.controlBarHeight))}enableAudioOnlyUI_(){this.addClass("vjs-audio-only-mode");const e=this.children(),s=this.getChild("ControlBar"),a=s&&s.currentHeight();e.forEach(h=>{h!==s&&h.el_&&!h.hasClass("vjs-hidden")&&(h.hide(),this.audioOnlyCache_.hiddenChildren.push(h))}),this.audioOnlyCache_.playerHeight=this.currentHeight(),this.audioOnlyCache_.controlBarHeight=a,this.on("playerresize",this.boundUpdatePlayerHeightOnAudioOnlyMode_),this.height(a),this.trigger("audioonlymodechange")}disableAudioOnlyUI_(){this.removeClass("vjs-audio-only-mode"),this.off("playerresize",this.boundUpdatePlayerHeightOnAudioOnlyMode_),this.audioOnlyCache_.hiddenChildren.forEach(e=>e.show()),this.height(this.audioOnlyCache_.playerHeight),this.trigger("audioonlymodechange")}audioOnlyMode(e){if(typeof e!="boolean"||e===this.audioOnlyMode_)return this.audioOnlyMode_;if(this.audioOnlyMode_=e,e){const s=[];return this.isInPictureInPicture()&&s.push(this.exitPictureInPicture()),this.isFullscreen()&&s.push(this.exitFullscreen()),this.audioPosterMode()&&s.push(this.audioPosterMode(!1)),Promise.all(s).then(()=>this.enableAudioOnlyUI_())}return Promise.resolve().then(()=>this.disableAudioOnlyUI_())}enablePosterModeUI_(){(this.tech_&&this.tech_).hide(),this.addClass("vjs-audio-poster-mode"),this.trigger("audiopostermodechange")}disablePosterModeUI_(){(this.tech_&&this.tech_).show(),this.removeClass("vjs-audio-poster-mode"),this.trigger("audiopostermodechange")}audioPosterMode(e){return typeof e!="boolean"||e===this.audioPosterMode_?this.audioPosterMode_:(this.audioPosterMode_=e,e?this.audioOnlyMode()?this.audioOnlyMode(!1).then(()=>{this.enablePosterModeUI_()}):Promise.resolve().then(()=>{this.enablePosterModeUI_()}):Promise.resolve().then(()=>{this.disablePosterModeUI_()}))}addTextTrack(e,s,a){if(this.tech_)return this.tech_.addTextTrack(e,s,a)}addRemoteTextTrack(e,s){if(this.tech_)return this.tech_.addRemoteTextTrack(e,s)}removeRemoteTextTrack(e={}){let{track:s}=e;if(s||(s=e),this.tech_)return this.tech_.removeRemoteTextTrack(s)}getVideoPlaybackQuality(){return this.techGet_("getVideoPlaybackQuality")}videoWidth(){return this.tech_&&this.tech_.videoWidth&&this.tech_.videoWidth()||0}videoHeight(){return this.tech_&&this.tech_.videoHeight&&this.tech_.videoHeight()||0}language(e){if(e===void 0)return this.language_;this.language_!==String(e).toLowerCase()&&(this.language_=String(e).toLowerCase(),Ht(this)&&this.trigger("languagechange"))}languages(){return ee(xs.prototype.options_.languages,this.languages_)}toJSON(){const e=ee(this.options_),s=e.tracks;e.tracks=[];for(let a=0;a<s.length;a++){let h=s[a];h=ee(h),h.player=void 0,e.tracks[a]=h}return e}createModal(e,s){s=s||{},s.content=e||"";const a=new Bh(this,s);return this.addChild(a),a.on("dispose",()=>{this.removeChild(a)}),a.open(),a}updateCurrentBreakpoint_(){if(!this.responsive())return;const e=this.currentBreakpoint(),s=this.currentWidth();for(let a=0;a<n1.length;a++){const h=n1[a],p=this.breakpoints_[h];if(s<=p){if(e===h)return;e&&this.removeClass(kT[e]),this.addClass(kT[h]),this.breakpoint_=h;break}}}removeCurrentBreakpoint_(){const e=this.currentBreakpointClass();this.breakpoint_="",e&&this.removeClass(e)}breakpoints(e){return e===void 0?Object.assign(this.breakpoints_):(this.breakpoint_="",this.breakpoints_=Object.assign({},S4,e),this.updateCurrentBreakpoint_(),Object.assign(this.breakpoints_))}responsive(e){if(e===void 0)return this.responsive_;e=!!e;const s=this.responsive_;if(e!==s)return this.responsive_=e,e?(this.on("playerresize",this.boundUpdateCurrentBreakpoint_),this.updateCurrentBreakpoint_()):(this.off("playerresize",this.boundUpdateCurrentBreakpoint_),this.removeCurrentBreakpoint_()),e}currentBreakpoint(){return this.breakpoint_}currentBreakpointClass(){return kT[this.breakpoint_]||""}loadMedia(e,s){if(!e||typeof e!="object")return;const a=this.crossOrigin();this.reset(),this.cache_.media=ee(e);const{artist:h,artwork:p,description:_,poster:w,src:I,textTracks:B,title:G}=this.cache_.media;!p&&w&&(this.cache_.media.artwork=[{src:w,type:ST(w)}]),a&&this.crossOrigin(a),I&&this.src(I),w&&this.poster(w),Array.isArray(B)&&B.forEach(se=>this.addRemoteTextTrack(se,!1)),this.titleBar&&this.titleBar.update({title:G,description:_||h||""}),this.ready(s)}getMedia(){if(!this.cache_.media){const e=this.poster(),s=this.currentSources(),a=Array.prototype.map.call(this.remoteTextTracks(),p=>({kind:p.kind,label:p.label,language:p.language,src:p.src})),h={src:s,textTracks:a};return e&&(h.poster=e,h.artwork=[{src:h.poster,type:ST(h.poster)}]),h}return ee(this.cache_.media)}static getTagSettings(e){const s={sources:[],tracks:[]},a=Te(e),h=a["data-setup"];if(Pi(e,"vjs-fill")&&(a.fill=!0),Pi(e,"vjs-fluid")&&(a.fluid=!0),h!==null)try{Object.assign(a,JSON.parse(h||"{}"))}catch(p){P.error("data-setup",p)}if(Object.assign(s,a),e.hasChildNodes()){const p=e.childNodes;for(let _=0,w=p.length;_<w;_++){const I=p[_],B=I.nodeName.toLowerCase();B==="source"?s.sources.push(Te(I)):B==="track"&&s.tracks.push(Te(I))}}return s}debug(e){if(e===void 0)return this.debugEnabled_;e?(this.trigger("debugon"),this.previousLogLevel_=this.log.level,this.log.level("debug"),this.debugEnabled_=!0):(this.trigger("debugoff"),this.log.level(this.previousLogLevel_),this.previousLogLevel_=void 0,this.debugEnabled_=!1)}playbackRates(e){if(e===void 0)return this.cache_.playbackRates;Array.isArray(e)&&e.every(s=>typeof s=="number")&&(this.cache_.playbackRates=e,this.trigger("playbackrateschange"))}}xs.prototype.videoTracks=()=>{},xs.prototype.audioTracks=()=>{},xs.prototype.textTracks=()=>{},xs.prototype.remoteTextTracks=()=>{},xs.prototype.remoteTextTrackEls=()=>{},wr.names.forEach(function(r){const e=wr[r];xs.prototype[e.getterName]=function(){return this.tech_?this.tech_[e.getterName]():(this[e.privateName]=this[e.privateName]||new e.ListClass,this[e.privateName])}}),xs.prototype.crossorigin=xs.prototype.crossOrigin,xs.players={};const k_=window.navigator;xs.prototype.options_={techOrder:si.defaultTechOrder_,html5:{},enableSourceset:!0,inactivityTimeout:2e3,playbackRates:[],liveui:!1,children:["mediaLoader","posterImage","titleBar","textTrackDisplay","loadingSpinner","bigPlayButton","liveTracker","controlBar","errorDisplay","textTrackSettings","resizeManager"],language:k_&&(k_.languages&&k_.languages[0]||k_.userLanguage||k_.language)||"en",languages:{},notSupportedMessage:"No compatible source was found for this media.",normalizeAutoplay:!1,fullscreen:{options:{navigationUI:"hide"}},breakpoints:{},responsive:!1,audioOnlyMode:!1,audioPosterMode:!1,spatialNavigation:{enabled:!1,horizontalSeek:!1},enableSmoothSeeking:!1,disableSeekWhileScrubbingOnMobile:!1,disableSeekWhileScrubbingOnSTV:!1},oD.forEach(function(r){xs.prototype[`handleTech${he(r)}_`]=function(){return this.trigger(r)}}),Le.registerComponent("Player",xs);const PT="plugin",_g="activePlugins_",bg={},DT=r=>bg.hasOwnProperty(r),IT=r=>DT(r)?bg[r]:void 0,lD=(r,e)=>{r[_g]=r[_g]||{},r[_g][e]=!0},LT=(r,e,s)=>{const a=(s?"before":"")+"pluginsetup";r.trigger(a,e),r.trigger(a+":"+e.name,e)},x4=function(r,e){const s=function(){LT(this,{name:r,plugin:e,instance:null},!0);const a=e.apply(this,arguments);return lD(this,r),LT(this,{name:r,plugin:e,instance:a}),a};return Object.keys(e).forEach(function(a){s[a]=e[a]}),s},uD=(r,e)=>(e.prototype.name=r,function(...s){LT(this,{name:r,plugin:e,instance:null},!0);const a=new e(this,...s);return this[r]=()=>a,LT(this,a.getEventHash()),a});class da{constructor(e){if(this.constructor===da)throw new Error("Plugin must be sub-classed; not directly instantiated.");this.player=e,this.log||(this.log=this.player.log.createLogger(this.name)),ue(this),delete this.trigger,k(this,this.constructor.defaultState),lD(e,this.name),this.dispose=this.dispose.bind(this),e.on("dispose",this.dispose)}version(){return this.constructor.VERSION}getEventHash(e={}){return e.name=this.name,e.plugin=this.constructor,e.instance=this,e}trigger(e,s={}){return sn(this.eventBusEl_,e,this.getEventHash(s))}handleStateChanged(e){}dispose(){const{name:e,player:s}=this;this.trigger("dispose"),this.off(),s.off("dispose",this.dispose),s[_g][e]=!1,this.player=this.state=null,s[e]=uD(e,bg[e])}static isBasic(e){const s=typeof e=="string"?IT(e):e;return typeof s=="function"&&!da.prototype.isPrototypeOf(s.prototype)}static registerPlugin(e,s){if(typeof e!="string")throw new Error(`Illegal plugin name, "${e}", must be a string, was ${typeof e}.`);if(DT(e))P.warn(`A plugin named "${e}" already exists. You may want to avoid re-registering plugins!`);else if(xs.prototype.hasOwnProperty(e))throw new Error(`Illegal plugin name, "${e}", cannot share a name with an existing player method!`);if(typeof s!="function")throw new Error(`Illegal plugin for "${e}", must be a function, was ${typeof s}.`);return bg[e]=s,e!==PT&&(da.isBasic(s)?xs.prototype[e]=x4(e,s):xs.prototype[e]=uD(e,s)),s}static deregisterPlugin(e){if(e===PT)throw new Error("Cannot de-register base plugin.");DT(e)&&(delete bg[e],delete xs.prototype[e])}static getPlugins(e=Object.keys(bg)){let s;return e.forEach(a=>{const h=IT(a);h&&(s=s||{},s[a]=h)}),s}static getPluginVersion(e){const s=IT(e);return s&&s.VERSION||""}}da.getPlugin=IT,da.BASE_PLUGIN_NAME=PT,da.registerPlugin(PT,da),xs.prototype.usingPlugin=function(r){return!!this[_g]&&this[_g][r]===!0},xs.prototype.hasPlugin=function(r){return!!DT(r)};function A4(r,e){let s=!1;return function(...a){return s||P.warn(r),s=!0,e.apply(this,a)}}function Bo(r,e,s,a){return A4(`${e} is deprecated and will be removed in ${r}.0; please use ${s} instead.`,a)}var C4={NetworkBadStatus:"networkbadstatus",NetworkRequestFailed:"networkrequestfailed",NetworkRequestAborted:"networkrequestaborted",NetworkRequestTimeout:"networkrequesttimeout",NetworkBodyParserFailed:"networkbodyparserfailed",StreamingHlsPlaylistParserError:"streaminghlsplaylistparsererror",StreamingDashManifestParserError:"streamingdashmanifestparsererror",StreamingContentSteeringParserError:"streamingcontentsteeringparsererror",StreamingVttParserError:"streamingvttparsererror",StreamingFailedToSelectNextSegment:"streamingfailedtoselectnextsegment",StreamingFailedToDecryptSegment:"streamingfailedtodecryptsegment",StreamingFailedToTransmuxSegment:"streamingfailedtotransmuxsegment",StreamingFailedToAppendSegment:"streamingfailedtoappendsegment",StreamingCodecsChangeError:"streamingcodecschangeerror"};const hD=r=>r.indexOf("#")===0?r.slice(1):r;function Ye(r,e,s){let a=Ye.getPlayer(r);if(a)return e&&P.warn(`Player "${r}" is already initialised. Options will not be applied.`),s&&a.ready(s),a;const h=typeof r=="string"?xt("#"+hD(r)):r;if(!$i(h))throw new TypeError("The element or ID supplied is not valid. (videojs)");const _=("getRootNode"in h?h.getRootNode()instanceof window.ShadowRoot:!1)?h.getRootNode():h.ownerDocument.body;(!h.ownerDocument.defaultView||!_.contains(h))&&P.warn("The element supplied is not included in the DOM"),e=e||{},e.restoreEl===!0&&(e.restoreEl=(h.parentNode&&h.parentNode.hasAttribute&&h.parentNode.hasAttribute("data-vjs-player")?h.parentNode:h).cloneNode(!0)),i("beforesetup").forEach(I=>{const B=I(h,ee(e));if(!K(B)||Array.isArray(B)){P.error("please return an object in beforesetup hooks");return}e=ee(e,B)});const w=Le.getComponent("Player");return a=new w(h,e,s),i("setup").forEach(I=>I(a)),a}if(Ye.hooks_=t,Ye.hooks=i,Ye.hook=n,Ye.hookOnce=l,Ye.removeHook=o,window.VIDEOJS_NO_DYNAMIC_STYLE!==!0&&mi()){let r=xt(".vjs-styles-defaults");if(!r){r=ni("vjs-styles-defaults");const e=xt("head");e&&e.insertBefore(r,e.firstChild),Zs(r,`
      .video-js {
        width: 300px;
        height: 150px;
      }

      .vjs-fluid:not(.vjs-audio-only-mode) {
        padding-top: 56.25%
      }
    `)}}Ct(1,Ye),Ye.VERSION=g,Ye.options=xs.prototype.options_,Ye.getPlayers=()=>xs.players,Ye.getPlayer=r=>{const e=xs.players;let s;if(typeof r=="string"){const a=hD(r),h=e[a];if(h)return h;s=xt("#"+a)}else s=r;if($i(s)){const{player:a,playerId:h}=s;if(a||e[h])return a||e[h]}},Ye.getAllPlayers=()=>Object.keys(xs.players).map(r=>xs.players[r]).filter(Boolean),Ye.players=xs.players,Ye.getComponent=Le.getComponent,Ye.registerComponent=(r,e)=>(si.isTech(e)&&P.warn(`The ${r} tech was registered as a component. It should instead be registered using videojs.registerTech(name, tech)`),Le.registerComponent.call(Le,r,e)),Ye.getTech=si.getTech,Ye.registerTech=si.registerTech,Ye.use=M3,Object.defineProperty(Ye,"middleware",{value:{},writeable:!1,enumerable:!0}),Object.defineProperty(Ye.middleware,"TERMINATOR",{value:ET,writeable:!1,enumerable:!0}),Ye.browser=es,Ye.obj=fe,Ye.mergeOptions=Bo(9,"videojs.mergeOptions","videojs.obj.merge",ee),Ye.defineLazyProperty=Bo(9,"videojs.defineLazyProperty","videojs.obj.defineLazyProperty",me),Ye.bind=Bo(9,"videojs.bind","native Function.prototype.bind",Ae),Ye.registerPlugin=da.registerPlugin,Ye.deregisterPlugin=da.deregisterPlugin,Ye.plugin=(r,e)=>(P.warn("videojs.plugin() is deprecated; use videojs.registerPlugin() instead"),da.registerPlugin(r,e)),Ye.getPlugins=da.getPlugins,Ye.getPlugin=da.getPlugin,Ye.getPluginVersion=da.getPluginVersion,Ye.addLanguage=function(r,e){return r=(""+r).toLowerCase(),Ye.options.languages=ee(Ye.options.languages,{[r]:e}),Ye.options.languages[r]},Ye.log=P,Ye.createLogger=x,Ye.time=Oo,Ye.createTimeRange=Bo(9,"videojs.createTimeRange","videojs.time.createTimeRanges",ns),Ye.createTimeRanges=Bo(9,"videojs.createTimeRanges","videojs.time.createTimeRanges",ns),Ye.formatTime=Bo(9,"videojs.formatTime","videojs.time.formatTime",xn),Ye.setFormatTime=Bo(9,"videojs.setFormatTime","videojs.time.setFormatTime",Na),Ye.resetFormatTime=Bo(9,"videojs.resetFormatTime","videojs.time.resetFormatTime",vr),Ye.parseUrl=Bo(9,"videojs.parseUrl","videojs.url.parseUrl",v_),Ye.isCrossOrigin=Bo(9,"videojs.isCrossOrigin","videojs.url.isCrossOrigin",Hh),Ye.EventTarget=Ki,Ye.any=H,Ye.on=_s,Ye.one=Ne,Ye.off=ss,Ye.trigger=sn,Ye.xhr=la,Ye.TrackList=bu,Ye.TextTrack=ua,Ye.TextTrackList=Rd,Ye.AudioTrack=qr,Ye.AudioTrackList=gT,Ye.VideoTrack=ug,Ye.VideoTrackList=__,["isEl","isTextNode","createEl","hasClass","addClass","removeClass","toggleClass","setAttributes","getAttributes","emptyEl","appendContent","insertContent"].forEach(r=>{Ye[r]=function(){return P.warn(`videojs.${r}() is deprecated; use videojs.dom.${r}() instead`),le[r].apply(null,arguments)}}),Ye.computedStyle=Bo(9,"videojs.computedStyle","videojs.dom.computedStyle",We),Ye.dom=le,Ye.fn=Ai,Ye.num=i4,Ye.str=rt,Ye.url=Lx,Ye.Error=C4,y(function(r,e){/*! @name videojs-contrib-quality-levels @version 4.1.0 @license Apache-2.0 */(function(s,a){r.exports=a(Ye)})(Md,function(s){function a(G){return G&&typeof G=="object"&&"default"in G?G:{default:G}}var h=a(s);class p{constructor(se){let pe=this;return pe.id=se.id,pe.label=pe.id,pe.width=se.width,pe.height=se.height,pe.bitrate=se.bandwidth,pe.frameRate=se.frameRate,pe.enabled_=se.enabled,Object.defineProperty(pe,"enabled",{get(){return pe.enabled_()},set(Ee){pe.enabled_(Ee)}}),pe}}class _ extends h.default.EventTarget{constructor(){super();let se=this;return se.levels_=[],se.selectedIndex_=-1,Object.defineProperty(se,"selectedIndex",{get(){return se.selectedIndex_}}),Object.defineProperty(se,"length",{get(){return se.levels_.length}}),se[Symbol.iterator]=()=>se.levels_.values(),se}addQualityLevel(se){let pe=this.getQualityLevelById(se.id);if(pe)return pe;const Ee=this.levels_.length;return pe=new p(se),""+Ee in this||Object.defineProperty(this,Ee,{get(){return this.levels_[Ee]}}),this.levels_.push(pe),this.trigger({qualityLevel:pe,type:"addqualitylevel"}),pe}removeQualityLevel(se){let pe=null;for(let Ee=0,Ie=this.length;Ee<Ie;Ee++)if(this[Ee]===se){pe=this.levels_.splice(Ee,1)[0],this.selectedIndex_===Ee?this.selectedIndex_=-1:this.selectedIndex_>Ee&&this.selectedIndex_--;break}return pe&&this.trigger({qualityLevel:se,type:"removequalitylevel"}),pe}getQualityLevelById(se){for(let pe=0,Ee=this.length;pe<Ee;pe++){const Ie=this[pe];if(Ie.id===se)return Ie}return null}dispose(){this.selectedIndex_=-1,this.levels_.length=0}}_.prototype.allowedEvents_={change:"change",addqualitylevel:"addqualitylevel",removequalitylevel:"removequalitylevel"};for(const G in _.prototype.allowedEvents_)_.prototype["on"+G]=null;var w="4.1.0";const I=function(G,se){const pe=G.qualityLevels,Ee=new _,Ie=function(){Ee.dispose(),G.qualityLevels=pe,G.off("dispose",Ie)};return G.on("dispose",Ie),G.qualityLevels=()=>Ee,G.qualityLevels.VERSION=w,Ee},B=function(G){return I(this,h.default.obj.merge({},G))};return h.default.registerPlugin("qualityLevels",B),B.VERSION=w,B})});var cD="https://example.com",NT=function(e,s){if(/^[a-z]+:/i.test(s))return s;/^data:/.test(e)&&(e=window.location&&window.location.href||"");var a=/^\/\//.test(e),h=!window.location&&!/\/\//i.test(e);e=new window.URL(e,window.location||cD);var p=new URL(s,e);return h?p.href.slice(cD.length):a?p.href.slice(p.protocol.length):p.href},r1=function(){function r(){this.listeners={}}var e=r.prototype;return e.on=function(a,h){this.listeners[a]||(this.listeners[a]=[]),this.listeners[a].push(h)},e.off=function(a,h){if(!this.listeners[a])return!1;var p=this.listeners[a].indexOf(h);return this.listeners[a]=this.listeners[a].slice(0),this.listeners[a].splice(p,1),p>-1},e.trigger=function(a){var h=this.listeners[a];if(h)if(arguments.length===2)for(var p=h.length,_=0;_<p;++_)h[_].call(this,arguments[1]);else for(var w=Array.prototype.slice.call(arguments,1),I=h.length,B=0;B<I;++B)h[B].apply(this,w)},e.dispose=function(){this.listeners={}},e.pipe=function(a){this.on("data",function(h){a.push(h)})},r}(),k4=function(e){return window.atob?window.atob(e):Buffer.from(e,"base64").toString("binary")};function dD(r){for(var e=k4(r),s=new Uint8Array(e.length),a=0;a<e.length;a++)s[a]=e.charCodeAt(a);return s}/*! @name m3u8-parser @version 7.2.0 @license Apache-2.0 */class P4 extends r1{constructor(){super(),this.buffer=""}push(e){let s;for(this.buffer+=e,s=this.buffer.indexOf(`
`);s>-1;s=this.buffer.indexOf(`
`))this.trigger("data",this.buffer.substring(0,s)),this.buffer=this.buffer.substring(s+1)}}const D4="	",a1=function(r){const e=/([0-9.]*)?@?([0-9.]*)?/.exec(r||""),s={};return e[1]&&(s.length=parseInt(e[1],10)),e[2]&&(s.offset=parseInt(e[2],10)),s},I4=function(){const s="(?:"+"[^=]*"+")=(?:"+'"[^"]*"|[^,]*'+")";return new RegExp("(?:^|,)("+s+")")},Xr=function(r){const e={};if(!r)return e;const s=r.split(I4());let a=s.length,h;for(;a--;)s[a]!==""&&(h=/([^=]*)=(.*)/.exec(s[a]).slice(1),h[0]=h[0].replace(/^\s+|\s+$/g,""),h[1]=h[1].replace(/^\s+|\s+$/g,""),h[1]=h[1].replace(/^['"](.*)['"]$/g,"$1"),e[h[0]]=h[1]);return e},fD=r=>{const e=r.split("x"),s={};return e[0]&&(s.width=parseInt(e[0],10)),e[1]&&(s.height=parseInt(e[1],10)),s};class L4 extends r1{constructor(){super(),this.customParsers=[],this.tagMappers=[]}push(e){let s,a;if(e=e.trim(),e.length===0)return;if(e[0]!=="#"){this.trigger("data",{type:"uri",uri:e});return}this.tagMappers.reduce((p,_)=>{const w=_(e);return w===e?p:p.concat([w])},[e]).forEach(p=>{for(let _=0;_<this.customParsers.length;_++)if(this.customParsers[_].call(this,p))return;if(p.indexOf("#EXT")!==0){this.trigger("data",{type:"comment",text:p.slice(1)});return}if(p=p.replace("\r",""),s=/^#EXTM3U/.exec(p),s){this.trigger("data",{type:"tag",tagType:"m3u"});return}if(s=/^#EXTINF:([0-9\.]*)?,?(.*)?$/.exec(p),s){a={type:"tag",tagType:"inf"},s[1]&&(a.duration=parseFloat(s[1])),s[2]&&(a.title=s[2]),this.trigger("data",a);return}if(s=/^#EXT-X-TARGETDURATION:([0-9.]*)?/.exec(p),s){a={type:"tag",tagType:"targetduration"},s[1]&&(a.duration=parseInt(s[1],10)),this.trigger("data",a);return}if(s=/^#EXT-X-VERSION:([0-9.]*)?/.exec(p),s){a={type:"tag",tagType:"version"},s[1]&&(a.version=parseInt(s[1],10)),this.trigger("data",a);return}if(s=/^#EXT-X-MEDIA-SEQUENCE:(\-?[0-9.]*)?/.exec(p),s){a={type:"tag",tagType:"media-sequence"},s[1]&&(a.number=parseInt(s[1],10)),this.trigger("data",a);return}if(s=/^#EXT-X-DISCONTINUITY-SEQUENCE:(\-?[0-9.]*)?/.exec(p),s){a={type:"tag",tagType:"discontinuity-sequence"},s[1]&&(a.number=parseInt(s[1],10)),this.trigger("data",a);return}if(s=/^#EXT-X-PLAYLIST-TYPE:(.*)?$/.exec(p),s){a={type:"tag",tagType:"playlist-type"},s[1]&&(a.playlistType=s[1]),this.trigger("data",a);return}if(s=/^#EXT-X-BYTERANGE:(.*)?$/.exec(p),s){a=Z(a1(s[1]),{type:"tag",tagType:"byterange"}),this.trigger("data",a);return}if(s=/^#EXT-X-ALLOW-CACHE:(YES|NO)?/.exec(p),s){a={type:"tag",tagType:"allow-cache"},s[1]&&(a.allowed=!/NO/.test(s[1])),this.trigger("data",a);return}if(s=/^#EXT-X-MAP:(.*)$/.exec(p),s){if(a={type:"tag",tagType:"map"},s[1]){const _=Xr(s[1]);_.URI&&(a.uri=_.URI),_.BYTERANGE&&(a.byterange=a1(_.BYTERANGE))}this.trigger("data",a);return}if(s=/^#EXT-X-STREAM-INF:(.*)$/.exec(p),s){a={type:"tag",tagType:"stream-inf"},s[1]&&(a.attributes=Xr(s[1]),a.attributes.RESOLUTION&&(a.attributes.RESOLUTION=fD(a.attributes.RESOLUTION)),a.attributes.BANDWIDTH&&(a.attributes.BANDWIDTH=parseInt(a.attributes.BANDWIDTH,10)),a.attributes["FRAME-RATE"]&&(a.attributes["FRAME-RATE"]=parseFloat(a.attributes["FRAME-RATE"])),a.attributes["PROGRAM-ID"]&&(a.attributes["PROGRAM-ID"]=parseInt(a.attributes["PROGRAM-ID"],10))),this.trigger("data",a);return}if(s=/^#EXT-X-MEDIA:(.*)$/.exec(p),s){a={type:"tag",tagType:"media"},s[1]&&(a.attributes=Xr(s[1])),this.trigger("data",a);return}if(s=/^#EXT-X-ENDLIST/.exec(p),s){this.trigger("data",{type:"tag",tagType:"endlist"});return}if(s=/^#EXT-X-DISCONTINUITY/.exec(p),s){this.trigger("data",{type:"tag",tagType:"discontinuity"});return}if(s=/^#EXT-X-PROGRAM-DATE-TIME:(.*)$/.exec(p),s){a={type:"tag",tagType:"program-date-time"},s[1]&&(a.dateTimeString=s[1],a.dateTimeObject=new Date(s[1])),this.trigger("data",a);return}if(s=/^#EXT-X-KEY:(.*)$/.exec(p),s){a={type:"tag",tagType:"key"},s[1]&&(a.attributes=Xr(s[1]),a.attributes.IV&&(a.attributes.IV.substring(0,2).toLowerCase()==="0x"&&(a.attributes.IV=a.attributes.IV.substring(2)),a.attributes.IV=a.attributes.IV.match(/.{8}/g),a.attributes.IV[0]=parseInt(a.attributes.IV[0],16),a.attributes.IV[1]=parseInt(a.attributes.IV[1],16),a.attributes.IV[2]=parseInt(a.attributes.IV[2],16),a.attributes.IV[3]=parseInt(a.attributes.IV[3],16),a.attributes.IV=new Uint32Array(a.attributes.IV))),this.trigger("data",a);return}if(s=/^#EXT-X-START:(.*)$/.exec(p),s){a={type:"tag",tagType:"start"},s[1]&&(a.attributes=Xr(s[1]),a.attributes["TIME-OFFSET"]=parseFloat(a.attributes["TIME-OFFSET"]),a.attributes.PRECISE=/YES/.test(a.attributes.PRECISE)),this.trigger("data",a);return}if(s=/^#EXT-X-CUE-OUT-CONT:(.*)?$/.exec(p),s){a={type:"tag",tagType:"cue-out-cont"},s[1]?a.data=s[1]:a.data="",this.trigger("data",a);return}if(s=/^#EXT-X-CUE-OUT:(.*)?$/.exec(p),s){a={type:"tag",tagType:"cue-out"},s[1]?a.data=s[1]:a.data="",this.trigger("data",a);return}if(s=/^#EXT-X-CUE-IN:?(.*)?$/.exec(p),s){a={type:"tag",tagType:"cue-in"},s[1]?a.data=s[1]:a.data="",this.trigger("data",a);return}if(s=/^#EXT-X-SKIP:(.*)$/.exec(p),s&&s[1]){a={type:"tag",tagType:"skip"},a.attributes=Xr(s[1]),a.attributes.hasOwnProperty("SKIPPED-SEGMENTS")&&(a.attributes["SKIPPED-SEGMENTS"]=parseInt(a.attributes["SKIPPED-SEGMENTS"],10)),a.attributes.hasOwnProperty("RECENTLY-REMOVED-DATERANGES")&&(a.attributes["RECENTLY-REMOVED-DATERANGES"]=a.attributes["RECENTLY-REMOVED-DATERANGES"].split(D4)),this.trigger("data",a);return}if(s=/^#EXT-X-PART:(.*)$/.exec(p),s&&s[1]){a={type:"tag",tagType:"part"},a.attributes=Xr(s[1]),["DURATION"].forEach(function(_){a.attributes.hasOwnProperty(_)&&(a.attributes[_]=parseFloat(a.attributes[_]))}),["INDEPENDENT","GAP"].forEach(function(_){a.attributes.hasOwnProperty(_)&&(a.attributes[_]=/YES/.test(a.attributes[_]))}),a.attributes.hasOwnProperty("BYTERANGE")&&(a.attributes.byterange=a1(a.attributes.BYTERANGE)),this.trigger("data",a);return}if(s=/^#EXT-X-SERVER-CONTROL:(.*)$/.exec(p),s&&s[1]){a={type:"tag",tagType:"server-control"},a.attributes=Xr(s[1]),["CAN-SKIP-UNTIL","PART-HOLD-BACK","HOLD-BACK"].forEach(function(_){a.attributes.hasOwnProperty(_)&&(a.attributes[_]=parseFloat(a.attributes[_]))}),["CAN-SKIP-DATERANGES","CAN-BLOCK-RELOAD"].forEach(function(_){a.attributes.hasOwnProperty(_)&&(a.attributes[_]=/YES/.test(a.attributes[_]))}),this.trigger("data",a);return}if(s=/^#EXT-X-PART-INF:(.*)$/.exec(p),s&&s[1]){a={type:"tag",tagType:"part-inf"},a.attributes=Xr(s[1]),["PART-TARGET"].forEach(function(_){a.attributes.hasOwnProperty(_)&&(a.attributes[_]=parseFloat(a.attributes[_]))}),this.trigger("data",a);return}if(s=/^#EXT-X-PRELOAD-HINT:(.*)$/.exec(p),s&&s[1]){a={type:"tag",tagType:"preload-hint"},a.attributes=Xr(s[1]),["BYTERANGE-START","BYTERANGE-LENGTH"].forEach(function(_){if(a.attributes.hasOwnProperty(_)){a.attributes[_]=parseInt(a.attributes[_],10);const w=_==="BYTERANGE-LENGTH"?"length":"offset";a.attributes.byterange=a.attributes.byterange||{},a.attributes.byterange[w]=a.attributes[_],delete a.attributes[_]}}),this.trigger("data",a);return}if(s=/^#EXT-X-RENDITION-REPORT:(.*)$/.exec(p),s&&s[1]){a={type:"tag",tagType:"rendition-report"},a.attributes=Xr(s[1]),["LAST-MSN","LAST-PART"].forEach(function(_){a.attributes.hasOwnProperty(_)&&(a.attributes[_]=parseInt(a.attributes[_],10))}),this.trigger("data",a);return}if(s=/^#EXT-X-DATERANGE:(.*)$/.exec(p),s&&s[1]){a={type:"tag",tagType:"daterange"},a.attributes=Xr(s[1]),["ID","CLASS"].forEach(function(w){a.attributes.hasOwnProperty(w)&&(a.attributes[w]=String(a.attributes[w]))}),["START-DATE","END-DATE"].forEach(function(w){a.attributes.hasOwnProperty(w)&&(a.attributes[w]=new Date(a.attributes[w]))}),["DURATION","PLANNED-DURATION"].forEach(function(w){a.attributes.hasOwnProperty(w)&&(a.attributes[w]=parseFloat(a.attributes[w]))}),["END-ON-NEXT"].forEach(function(w){a.attributes.hasOwnProperty(w)&&(a.attributes[w]=/YES/i.test(a.attributes[w]))}),["SCTE35-CMD"," SCTE35-OUT","SCTE35-IN"].forEach(function(w){a.attributes.hasOwnProperty(w)&&(a.attributes[w]=a.attributes[w].toString(16))});const _=/^X-([A-Z]+-)+[A-Z]+$/;for(const w in a.attributes){if(!_.test(w))continue;const I=/[0-9A-Fa-f]{6}/g.test(a.attributes[w]),B=/^\d+(\.\d+)?$/.test(a.attributes[w]);a.attributes[w]=I?a.attributes[w].toString(16):B?parseFloat(a.attributes[w]):String(a.attributes[w])}this.trigger("data",a);return}if(s=/^#EXT-X-INDEPENDENT-SEGMENTS/.exec(p),s){this.trigger("data",{type:"tag",tagType:"independent-segments"});return}if(s=/^#EXT-X-I-FRAMES-ONLY/.exec(p),s){this.trigger("data",{type:"tag",tagType:"i-frames-only"});return}if(s=/^#EXT-X-CONTENT-STEERING:(.*)$/.exec(p),s){a={type:"tag",tagType:"content-steering"},a.attributes=Xr(s[1]),this.trigger("data",a);return}if(s=/^#EXT-X-I-FRAME-STREAM-INF:(.*)$/.exec(p),s){a={type:"tag",tagType:"i-frame-playlist"},a.attributes=Xr(s[1]),a.attributes.URI&&(a.uri=a.attributes.URI),a.attributes.BANDWIDTH&&(a.attributes.BANDWIDTH=parseInt(a.attributes.BANDWIDTH,10)),a.attributes.RESOLUTION&&(a.attributes.RESOLUTION=fD(a.attributes.RESOLUTION)),a.attributes["AVERAGE-BANDWIDTH"]&&(a.attributes["AVERAGE-BANDWIDTH"]=parseInt(a.attributes["AVERAGE-BANDWIDTH"],10)),a.attributes["FRAME-RATE"]&&(a.attributes["FRAME-RATE"]=parseFloat(a.attributes["FRAME-RATE"])),this.trigger("data",a);return}if(s=/^#EXT-X-DEFINE:(.*)$/.exec(p),s){a={type:"tag",tagType:"define"},a.attributes=Xr(s[1]),this.trigger("data",a);return}this.trigger("data",{type:"tag",data:p.slice(4)})})}addParser({expression:e,customType:s,dataParser:a,segment:h}){typeof a!="function"&&(a=p=>p),this.customParsers.push(p=>{if(e.exec(p))return this.trigger("data",{type:"custom",data:a(p),customType:s,segment:h}),!0})}addTagMapper({expression:e,map:s}){const a=h=>e.test(h)?s(h):h;this.tagMappers.push(a)}}const N4=r=>r.toLowerCase().replace(/-(\w)/g,e=>e[1].toUpperCase()),Xh=function(r){const e={};return Object.keys(r).forEach(function(s){e[N4(s)]=r[s]}),e},o1=function(r){const{serverControl:e,targetDuration:s,partTargetDuration:a}=r;if(!e)return;const h="#EXT-X-SERVER-CONTROL",p="holdBack",_="partHoldBack",w=s&&s*3,I=a&&a*2;s&&!e.hasOwnProperty(p)&&(e[p]=w,this.trigger("info",{message:`${h} defaulting HOLD-BACK to targetDuration * 3 (${w}).`})),w&&e[p]<w&&(this.trigger("warn",{message:`${h} clamping HOLD-BACK (${e[p]}) to targetDuration * 3 (${w})`}),e[p]=w),a&&!e.hasOwnProperty(_)&&(e[_]=a*3,this.trigger("info",{message:`${h} defaulting PART-HOLD-BACK to partTargetDuration * 3 (${e[_]}).`})),a&&e[_]<I&&(this.trigger("warn",{message:`${h} clamping PART-HOLD-BACK (${e[_]}) to partTargetDuration * 2 (${I}).`}),e[_]=I)};class R4 extends r1{constructor(e={}){super(),this.lineStream=new P4,this.parseStream=new L4,this.lineStream.pipe(this.parseStream),this.mainDefinitions=e.mainDefinitions||{},this.params=new URL(e.uri,"https://a.com").searchParams,this.lastProgramDateTime=null;const s=this,a=[];let h={},p,_,w=!1;const I=function(){},B={AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},G="urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed";let se=0;this.manifest={allowCache:!0,discontinuityStarts:[],dateRanges:[],iFramePlaylists:[],segments:[]};let pe=0,Ee=0;const Ie={};this.on("end",()=>{h.uri||!h.parts&&!h.preloadHints||(!h.map&&p&&(h.map=p),!h.key&&_&&(h.key=_),!h.timeline&&typeof se=="number"&&(h.timeline=se),this.manifest.preloadSegment=h)}),this.parseStream.on("data",function(ce){let Ve,Be;if(s.manifest.definitions){for(const Ke in s.manifest.definitions)if(ce.uri&&(ce.uri=ce.uri.replace(`{$${Ke}}`,s.manifest.definitions[Ke])),ce.attributes)for(const ze in ce.attributes)typeof ce.attributes[ze]=="string"&&(ce.attributes[ze]=ce.attributes[ze].replace(`{$${Ke}}`,s.manifest.definitions[Ke]))}({tag(){({version(){ce.version&&(this.manifest.version=ce.version)},"allow-cache"(){this.manifest.allowCache=ce.allowed,"allowed"in ce||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0)},byterange(){const Ke={};"length"in ce&&(h.byterange=Ke,Ke.length=ce.length,"offset"in ce||(ce.offset=pe)),"offset"in ce&&(h.byterange=Ke,Ke.offset=ce.offset),pe=Ke.offset+Ke.length},endlist(){this.manifest.endList=!0},inf(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"})),"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"})),ce.title&&(h.title=ce.title),ce.duration>0&&(h.duration=ce.duration),ce.duration===0&&(h.duration=.01,this.trigger("info",{message:"updating zero segment duration to a small value"})),this.manifest.segments=a},key(){if(!ce.attributes){this.trigger("warn",{message:"ignoring key declaration without attribute list"});return}if(ce.attributes.METHOD==="NONE"){_=null;return}if(!ce.attributes.URI){this.trigger("warn",{message:"ignoring key declaration without URI"});return}if(ce.attributes.KEYFORMAT==="com.apple.streamingkeydelivery"){this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.apple.fps.1_0"]={attributes:ce.attributes};return}if(ce.attributes.KEYFORMAT==="com.microsoft.playready"){this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.microsoft.playready"]={uri:ce.attributes.URI};return}if(ce.attributes.KEYFORMAT===G){if(["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"].indexOf(ce.attributes.METHOD)===-1){this.trigger("warn",{message:"invalid key method provided for Widevine"});return}if(ce.attributes.METHOD==="SAMPLE-AES-CENC"&&this.trigger("warn",{message:"SAMPLE-AES-CENC is deprecated, please use SAMPLE-AES-CTR instead"}),ce.attributes.URI.substring(0,23)!=="data:text/plain;base64,"){this.trigger("warn",{message:"invalid key URI provided for Widevine"});return}if(!(ce.attributes.KEYID&&ce.attributes.KEYID.substring(0,2)==="0x")){this.trigger("warn",{message:"invalid key ID provided for Widevine"});return}this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.widevine.alpha"]={attributes:{schemeIdUri:ce.attributes.KEYFORMAT,keyId:ce.attributes.KEYID.substring(2)},pssh:dD(ce.attributes.URI.split(",")[1])};return}ce.attributes.METHOD||this.trigger("warn",{message:"defaulting key method to AES-128"}),_={method:ce.attributes.METHOD||"AES-128",uri:ce.attributes.URI},typeof ce.attributes.IV<"u"&&(_.iv=ce.attributes.IV)},"media-sequence"(){if(!isFinite(ce.number)){this.trigger("warn",{message:"ignoring invalid media sequence: "+ce.number});return}this.manifest.mediaSequence=ce.number},"discontinuity-sequence"(){if(!isFinite(ce.number)){this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+ce.number});return}this.manifest.discontinuitySequence=ce.number,se=ce.number},"playlist-type"(){if(!/VOD|EVENT/.test(ce.playlistType)){this.trigger("warn",{message:"ignoring unknown playlist type: "+ce.playlist});return}this.manifest.playlistType=ce.playlistType},map(){p={},ce.uri&&(p.uri=ce.uri),ce.byterange&&(p.byterange=ce.byterange),_&&(p.key=_)},"stream-inf"(){if(this.manifest.playlists=a,this.manifest.mediaGroups=this.manifest.mediaGroups||B,!ce.attributes){this.trigger("warn",{message:"ignoring empty stream-inf attributes"});return}h.attributes||(h.attributes={}),Z(h.attributes,ce.attributes)},media(){if(this.manifest.mediaGroups=this.manifest.mediaGroups||B,!(ce.attributes&&ce.attributes.TYPE&&ce.attributes["GROUP-ID"]&&ce.attributes.NAME)){this.trigger("warn",{message:"ignoring incomplete or missing media group"});return}const Ke=this.manifest.mediaGroups[ce.attributes.TYPE];Ke[ce.attributes["GROUP-ID"]]=Ke[ce.attributes["GROUP-ID"]]||{},Ve=Ke[ce.attributes["GROUP-ID"]],Be={default:/yes/i.test(ce.attributes.DEFAULT)},Be.default?Be.autoselect=!0:Be.autoselect=/yes/i.test(ce.attributes.AUTOSELECT),ce.attributes.LANGUAGE&&(Be.language=ce.attributes.LANGUAGE),ce.attributes.URI&&(Be.uri=ce.attributes.URI),ce.attributes["INSTREAM-ID"]&&(Be.instreamId=ce.attributes["INSTREAM-ID"]),ce.attributes.CHARACTERISTICS&&(Be.characteristics=ce.attributes.CHARACTERISTICS),ce.attributes.FORCED&&(Be.forced=/yes/i.test(ce.attributes.FORCED)),Ve[ce.attributes.NAME]=Be},discontinuity(){se+=1,h.discontinuity=!0,this.manifest.discontinuityStarts.push(a.length)},"program-date-time"(){typeof this.manifest.dateTimeString>"u"&&(this.manifest.dateTimeString=ce.dateTimeString,this.manifest.dateTimeObject=ce.dateTimeObject),h.dateTimeString=ce.dateTimeString,h.dateTimeObject=ce.dateTimeObject;const{lastProgramDateTime:Ke}=this;this.lastProgramDateTime=new Date(ce.dateTimeString).getTime(),Ke===null&&this.manifest.segments.reduceRight((ze,it)=>(it.programDateTime=ze-it.duration*1e3,it.programDateTime),this.lastProgramDateTime)},targetduration(){if(!isFinite(ce.duration)||ce.duration<0){this.trigger("warn",{message:"ignoring invalid target duration: "+ce.duration});return}this.manifest.targetDuration=ce.duration,o1.call(this,this.manifest)},start(){if(!ce.attributes||isNaN(ce.attributes["TIME-OFFSET"])){this.trigger("warn",{message:"ignoring start declaration without appropriate attribute list"});return}this.manifest.start={timeOffset:ce.attributes["TIME-OFFSET"],precise:ce.attributes.PRECISE}},"cue-out"(){h.cueOut=ce.data},"cue-out-cont"(){h.cueOutCont=ce.data},"cue-in"(){h.cueIn=ce.data},skip(){this.manifest.skip=Xh(ce.attributes),this.warnOnMissingAttributes_("#EXT-X-SKIP",ce.attributes,["SKIPPED-SEGMENTS"])},part(){w=!0;const Ke=this.manifest.segments.length,ze=Xh(ce.attributes);h.parts=h.parts||[],h.parts.push(ze),ze.byterange&&(ze.byterange.hasOwnProperty("offset")||(ze.byterange.offset=Ee),Ee=ze.byterange.offset+ze.byterange.length);const it=h.parts.length-1;this.warnOnMissingAttributes_(`#EXT-X-PART #${it} for segment #${Ke}`,ce.attributes,["URI","DURATION"]),this.manifest.renditionReports&&this.manifest.renditionReports.forEach((lt,Et)=>{lt.hasOwnProperty("lastPart")||this.trigger("warn",{message:`#EXT-X-RENDITION-REPORT #${Et} lacks required attribute(s): LAST-PART`})})},"server-control"(){const Ke=this.manifest.serverControl=Xh(ce.attributes);Ke.hasOwnProperty("canBlockReload")||(Ke.canBlockReload=!1,this.trigger("info",{message:"#EXT-X-SERVER-CONTROL defaulting CAN-BLOCK-RELOAD to false"})),o1.call(this,this.manifest),Ke.canSkipDateranges&&!Ke.hasOwnProperty("canSkipUntil")&&this.trigger("warn",{message:"#EXT-X-SERVER-CONTROL lacks required attribute CAN-SKIP-UNTIL which is required when CAN-SKIP-DATERANGES is set"})},"preload-hint"(){const Ke=this.manifest.segments.length,ze=Xh(ce.attributes),it=ze.type&&ze.type==="PART";h.preloadHints=h.preloadHints||[],h.preloadHints.push(ze),ze.byterange&&(ze.byterange.hasOwnProperty("offset")||(ze.byterange.offset=it?Ee:0,it&&(Ee=ze.byterange.offset+ze.byterange.length)));const lt=h.preloadHints.length-1;if(this.warnOnMissingAttributes_(`#EXT-X-PRELOAD-HINT #${lt} for segment #${Ke}`,ce.attributes,["TYPE","URI"]),!!ze.type)for(let Et=0;Et<h.preloadHints.length-1;Et++){const yt=h.preloadHints[Et];yt.type&&yt.type===ze.type&&this.trigger("warn",{message:`#EXT-X-PRELOAD-HINT #${lt} for segment #${Ke} has the same TYPE ${ze.type} as preload hint #${Et}`})}},"rendition-report"(){const Ke=Xh(ce.attributes);this.manifest.renditionReports=this.manifest.renditionReports||[],this.manifest.renditionReports.push(Ke);const ze=this.manifest.renditionReports.length-1,it=["LAST-MSN","URI"];w&&it.push("LAST-PART"),this.warnOnMissingAttributes_(`#EXT-X-RENDITION-REPORT #${ze}`,ce.attributes,it)},"part-inf"(){this.manifest.partInf=Xh(ce.attributes),this.warnOnMissingAttributes_("#EXT-X-PART-INF",ce.attributes,["PART-TARGET"]),this.manifest.partInf.partTarget&&(this.manifest.partTargetDuration=this.manifest.partInf.partTarget),o1.call(this,this.manifest)},daterange(){this.manifest.dateRanges.push(Xh(ce.attributes));const Ke=this.manifest.dateRanges.length-1;this.warnOnMissingAttributes_(`#EXT-X-DATERANGE #${Ke}`,ce.attributes,["ID","START-DATE"]);const ze=this.manifest.dateRanges[Ke];ze.endDate&&ze.startDate&&new Date(ze.endDate)<new Date(ze.startDate)&&this.trigger("warn",{message:"EXT-X-DATERANGE END-DATE must be equal to or later than the value of the START-DATE"}),ze.duration&&ze.duration<0&&this.trigger("warn",{message:"EXT-X-DATERANGE DURATION must not be negative"}),ze.plannedDuration&&ze.plannedDuration<0&&this.trigger("warn",{message:"EXT-X-DATERANGE PLANNED-DURATION must not be negative"});const it=!!ze.endOnNext;if(it&&!ze.class&&this.trigger("warn",{message:"EXT-X-DATERANGE with an END-ON-NEXT=YES attribute must have a CLASS attribute"}),it&&(ze.duration||ze.endDate)&&this.trigger("warn",{message:"EXT-X-DATERANGE with an END-ON-NEXT=YES attribute must not contain DURATION or END-DATE attributes"}),ze.duration&&ze.endDate){const Et=ze.startDate.getTime()+ze.duration*1e3;this.manifest.dateRanges[Ke].endDate=new Date(Et)}if(!Ie[ze.id])Ie[ze.id]=ze;else{for(const Et in Ie[ze.id])if(ze[Et]&&JSON.stringify(Ie[ze.id][Et])!==JSON.stringify(ze[Et])){this.trigger("warn",{message:"EXT-X-DATERANGE tags with the same ID in a playlist must have the same attributes values"});break}const lt=this.manifest.dateRanges.findIndex(Et=>Et.id===ze.id);this.manifest.dateRanges[lt]=Z(this.manifest.dateRanges[lt],ze),Ie[ze.id]=Z(Ie[ze.id],ze),this.manifest.dateRanges.pop()}},"independent-segments"(){this.manifest.independentSegments=!0},"i-frames-only"(){this.manifest.iFramesOnly=!0,this.requiredCompatibilityversion(this.manifest.version,4)},"content-steering"(){this.manifest.contentSteering=Xh(ce.attributes),this.warnOnMissingAttributes_("#EXT-X-CONTENT-STEERING",ce.attributes,["SERVER-URI"])},define(){this.manifest.definitions=this.manifest.definitions||{};const Ke=(ze,it)=>{if(ze in this.manifest.definitions){this.trigger("error",{message:`EXT-X-DEFINE: Duplicate name ${ze}`});return}this.manifest.definitions[ze]=it};if("QUERYPARAM"in ce.attributes){if("NAME"in ce.attributes||"IMPORT"in ce.attributes){this.trigger("error",{message:"EXT-X-DEFINE: Invalid attributes"});return}const ze=this.params.get(ce.attributes.QUERYPARAM);if(!ze){this.trigger("error",{message:`EXT-X-DEFINE: No query param ${ce.attributes.QUERYPARAM}`});return}Ke(ce.attributes.QUERYPARAM,decodeURIComponent(ze));return}if("NAME"in ce.attributes){if("IMPORT"in ce.attributes){this.trigger("error",{message:"EXT-X-DEFINE: Invalid attributes"});return}if(!("VALUE"in ce.attributes)||typeof ce.attributes.VALUE!="string"){this.trigger("error",{message:`EXT-X-DEFINE: No value for ${ce.attributes.NAME}`});return}Ke(ce.attributes.NAME,ce.attributes.VALUE);return}if("IMPORT"in ce.attributes){if(!this.mainDefinitions[ce.attributes.IMPORT]){this.trigger("error",{message:`EXT-X-DEFINE: No value ${ce.attributes.IMPORT} to import, or IMPORT used on main playlist`});return}Ke(ce.attributes.IMPORT,this.mainDefinitions[ce.attributes.IMPORT]);return}this.trigger("error",{message:"EXT-X-DEFINE: No attribute"})},"i-frame-playlist"(){this.manifest.iFramePlaylists.push({attributes:ce.attributes,uri:ce.uri,timeline:se}),this.warnOnMissingAttributes_("#EXT-X-I-FRAME-STREAM-INF",ce.attributes,["BANDWIDTH","URI"])}}[ce.tagType]||I).call(s)},uri(){h.uri=ce.uri,a.push(h),this.manifest.targetDuration&&!("duration"in h)&&(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),h.duration=this.manifest.targetDuration),_&&(h.key=_),h.timeline=se,p&&(h.map=p),Ee=0,this.lastProgramDateTime!==null&&(h.programDateTime=this.lastProgramDateTime,this.lastProgramDateTime+=h.duration*1e3),h={}},comment(){},custom(){ce.segment?(h.custom=h.custom||{},h.custom[ce.customType]=ce.data):(this.manifest.custom=this.manifest.custom||{},this.manifest.custom[ce.customType]=ce.data)}})[ce.type].call(s)})}requiredCompatibilityversion(e,s){(e<s||!e)&&this.trigger("warn",{message:`manifest must be at least version ${s}`})}warnOnMissingAttributes_(e,s,a){const h=[];a.forEach(function(p){s.hasOwnProperty(p)||h.push(p)}),h.length&&this.trigger("warn",{message:`${e} lacks required attribute(s): ${h.join(", ")}`})}push(e){this.lineStream.push(e)}end(){this.lineStream.push(`
`),this.manifest.dateRanges.length&&this.lastProgramDateTime===null&&this.trigger("warn",{message:"A playlist with EXT-X-DATERANGE tag must contain atleast one EXT-X-PROGRAM-DATE-TIME tag"}),this.lastProgramDateTime=null,this.trigger("end")}addParser(e){this.parseStream.addParser(e)}addTagMapper(e){this.parseStream.addTagMapper(e)}}var Vd={mp4:/^(av0?1|avc0?[1234]|vp0?9|flac|opus|mp3|mp4a|mp4v|stpp.ttml.im1t)/,webm:/^(vp0?[89]|av0?1|opus|vorbis)/,ogg:/^(vp0?[89]|theora|flac|opus|vorbis)/,video:/^(av0?1|avc0?[1234]|vp0?[89]|hvc1|hev1|theora|mp4v)/,audio:/^(mp4a|flac|vorbis|opus|ac-[34]|ec-3|alac|mp3|speex|aac)/,text:/^(stpp.ttml.im1t)/,muxerVideo:/^(avc0?1)/,muxerAudio:/^(mp4a)/,muxerText:/a^/},M4=["video","audio","text"],pD=["Video","Audio","Text"],gD=function(e){return e&&e.replace(/avc1\.(\d+)\.(\d+)/i,function(s,a,h){var p=("00"+Number(a).toString(16)).slice(-2),_=("00"+Number(h).toString(16)).slice(-2);return"avc1."+p+"00"+_})},xl=function(e){e===void 0&&(e="");var s=e.split(","),a=[];return s.forEach(function(h){h=h.trim();var p;M4.forEach(function(_){var w=Vd[_].exec(h.toLowerCase());if(!(!w||w.length<=1)){p=_;var I=h.substring(0,w[1].length),B=h.replace(I,"");a.push({type:I,details:B,mediaType:_})}}),p||a.push({type:h,details:"",mediaType:"unknown"})}),a},O4=function(e,s){if(!e.mediaGroups.AUDIO||!s)return null;var a=e.mediaGroups.AUDIO[s];if(!a)return null;for(var h in a){var p=a[h];if(p.default&&p.playlists)return xl(p.playlists[0].attributes.CODECS)}return null},mD=function(e){return e===void 0&&(e=""),Vd.audio.test(e.trim().toLowerCase())},F4=function(e){return e===void 0&&(e=""),Vd.text.test(e.trim().toLowerCase())},yg=function(e){if(!(!e||typeof e!="string")){var s=e.toLowerCase().split(",").map(function(p){return gD(p.trim())}),a="video";s.length===1&&mD(s[0])?a="audio":s.length===1&&F4(s[0])&&(a="application");var h="mp4";return s.every(function(p){return Vd.mp4.test(p)})?h="mp4":s.every(function(p){return Vd.webm.test(p)})?h="webm":s.every(function(p){return Vd.ogg.test(p)})&&(h="ogg"),a+"/"+h+';codecs="'+e+'"'}},P_=function(e,s){return e===void 0&&(e=""),s===void 0&&(s=!1),window.MediaSource&&window.MediaSource.isTypeSupported&&window.MediaSource.isTypeSupported(yg(e))||s&&window.ManagedMediaSource&&window.ManagedMediaSource.isTypeSupported&&window.ManagedMediaSource.isTypeSupported(yg(e))||!1},l1=function(e){return e===void 0&&(e=""),e.toLowerCase().split(",").every(function(s){s=s.trim();for(var a=0;a<pD.length;a++){var h=pD[a];if(Vd["muxer"+h].test(s))return!0}return!1})},_D="mp4a.40.2",B4="avc1.4d400d",U4=/^(audio|video|application)\/(x-|vnd\.apple\.)?mpegurl/i,j4=/^application\/dash\+xml/i,bD=function(e){return U4.test(e)?"hls":j4.test(e)?"dash":e==="application/vnd.videojs.vhs+json"?"vhs-json":null},H4=function(e){return e.toString(2).length},V4=function(e){return Math.ceil(H4(e)/8)},yD=function(e){return ArrayBuffer.isView==="function"?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer},$4=function(e){return yD(e)},_i=function(e){return e instanceof Uint8Array?e:(!Array.isArray(e)&&!$4(e)&&!(e instanceof ArrayBuffer)&&(typeof e!="number"||typeof e=="number"&&e!==e?e=0:e=[e]),new Uint8Array(e&&e.buffer||e,e&&e.byteOffset||0,e&&e.byteLength||0))},Tr=window.BigInt||Number,u1=[Tr("0x1"),Tr("0x100"),Tr("0x10000"),Tr("0x1000000"),Tr("0x100000000"),Tr("0x10000000000"),Tr("0x1000000000000"),Tr("0x100000000000000"),Tr("0x10000000000000000")];(function(){var r=new Uint16Array([65484]),e=new Uint8Array(r.buffer,r.byteOffset,r.byteLength);return e[0]===255?"big":e[0]===204?"little":"unknown"})();var z4=function(e,s){var a=s===void 0?{}:s,h=a.signed,p=h===void 0?!1:h,_=a.le,w=_===void 0?!1:_;e=_i(e);var I=w?"reduce":"reduceRight",B=e[I]?e[I]:Array.prototype[I],G=B.call(e,function(pe,Ee,Ie){var ce=w?Ie:Math.abs(Ie+1-e.length);return pe+Tr(Ee)*u1[ce]},Tr(0));if(p){var se=u1[e.length]/Tr(2)-Tr(1);G=Tr(G),G>se&&(G-=se,G-=se,G-=Tr(2))}return Number(G)},W4=function(e,s){var a={},h=a.le,p=h===void 0?!1:h;(typeof e!="bigint"&&typeof e!="number"||typeof e=="number"&&e!==e)&&(e=0),e=Tr(e);for(var _=V4(e),w=new Uint8Array(new ArrayBuffer(_)),I=0;I<_;I++){var B=p?I:Math.abs(I+1-w.length);w[B]=Number(e/u1[I]&Tr(255)),e<0&&(w[B]=Math.abs(~w[B]),w[B]-=I===0?1:2)}return w},vD=function(e,s){if(typeof e!="string"&&e&&typeof e.toString=="function"&&(e=e.toString()),typeof e!="string")return new Uint8Array;s||(e=unescape(encodeURIComponent(e)));for(var a=new Uint8Array(e.length),h=0;h<e.length;h++)a[h]=e.charCodeAt(h);return a},q4=function(){for(var e=arguments.length,s=new Array(e),a=0;a<e;a++)s[a]=arguments[a];if(s=s.filter(function(w){return w&&(w.byteLength||w.length)&&typeof w!="string"}),s.length<=1)return _i(s[0]);var h=s.reduce(function(w,I,B){return w+(I.byteLength||I.length)},0),p=new Uint8Array(h),_=0;return s.forEach(function(w){w=_i(w),p.set(w,_),_+=w.byteLength}),p},rn=function(e,s,a){var h=a===void 0?{}:a,p=h.offset,_=p===void 0?0:p,w=h.mask,I=w===void 0?[]:w;e=_i(e),s=_i(s);var B=s.every?s.every:Array.prototype.every;return s.length&&e.length-_>=s.length&&B.call(s,function(G,se){var pe=I[se]?I[se]&e[_+se]:e[_+se];return G===pe})},G4=function(e,s,a){s.forEach(function(h){for(var p in e.mediaGroups[h])for(var _ in e.mediaGroups[h][p]){var w=e.mediaGroups[h][p][_];a(w,h,p,_)}})};function X4(r,e,s){if(s===void 0&&(s=Array.prototype),r&&typeof s.find=="function")return s.find.call(r,e);for(var a=0;a<r.length;a++)if(Object.prototype.hasOwnProperty.call(r,a)){var h=r[a];if(e.call(void 0,h,a,r))return h}}function h1(r,e){return e===void 0&&(e=Object),e&&typeof e.freeze=="function"?e.freeze(r):r}var K4=h1({HTML:"text/html",isHTML:function(r){return r===K4.HTML},XML_APPLICATION:"application/xml",XML_TEXT:"text/xml",XML_XHTML_APPLICATION:"application/xhtml+xml",XML_SVG_IMAGE:"image/svg+xml"}),wD=h1({HTML:"http://www.w3.org/1999/xhtml",isHTML:function(r){return r===wD.HTML},SVG:"http://www.w3.org/2000/svg",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"}),Y4=X4,Z4=h1,Q4=wD,D_={find:Y4,freeze:Z4,NAMESPACE:Q4},Al=D_.find,I_=D_.NAMESPACE;function J4(r){return r!==""}function e8(r){return r?r.split(/[\t\n\f\r ]+/).filter(J4):[]}function t8(r,e){return r.hasOwnProperty(e)||(r[e]=!0),r}function TD(r){if(!r)return[];var e=e8(r);return Object.keys(e.reduce(t8,{}))}function i8(r){return function(e){return r&&r.indexOf(e)!==-1}}function L_(r,e){for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}function fa(r,e){var s=r.prototype;if(!(s instanceof e)){let a=function(){};a.prototype=e.prototype,a=new a,L_(s,a),r.prototype=s=a}s.constructor!=r&&(typeof r!="function"&&console.error("unknown Class:"+r),s.constructor=r)}var pa={},Uo=pa.ELEMENT_NODE=1,vg=pa.ATTRIBUTE_NODE=2,RT=pa.TEXT_NODE=3,ED=pa.CDATA_SECTION_NODE=4,SD=pa.ENTITY_REFERENCE_NODE=5,s8=pa.ENTITY_NODE=6,xD=pa.PROCESSING_INSTRUCTION_NODE=7,AD=pa.COMMENT_NODE=8,CD=pa.DOCUMENT_NODE=9,kD=pa.DOCUMENT_TYPE_NODE=10,vu=pa.DOCUMENT_FRAGMENT_NODE=11,n8=pa.NOTATION_NODE=12,Rr={},or={};Rr.INDEX_SIZE_ERR=(or[1]="Index size error",1),Rr.DOMSTRING_SIZE_ERR=(or[2]="DOMString size error",2);var ga=Rr.HIERARCHY_REQUEST_ERR=(or[3]="Hierarchy request error",3);Rr.WRONG_DOCUMENT_ERR=(or[4]="Wrong document",4),Rr.INVALID_CHARACTER_ERR=(or[5]="Invalid character",5),Rr.NO_DATA_ALLOWED_ERR=(or[6]="No data allowed",6),Rr.NO_MODIFICATION_ALLOWED_ERR=(or[7]="No modification allowed",7);var PD=Rr.NOT_FOUND_ERR=(or[8]="Not found",8);Rr.NOT_SUPPORTED_ERR=(or[9]="Not supported",9);var DD=Rr.INUSE_ATTRIBUTE_ERR=(or[10]="Attribute in use",10);Rr.INVALID_STATE_ERR=(or[11]="Invalid state",11),Rr.SYNTAX_ERR=(or[12]="Syntax error",12),Rr.INVALID_MODIFICATION_ERR=(or[13]="Invalid modification",13),Rr.NAMESPACE_ERR=(or[14]="Invalid namespace",14),Rr.INVALID_ACCESS_ERR=(or[15]="Invalid access",15);function Bn(r,e){if(e instanceof Error)var s=e;else s=this,Error.call(this,or[r]),this.message=or[r],Error.captureStackTrace&&Error.captureStackTrace(this,Bn);return s.code=r,e&&(this.message=this.message+": "+e),s}Bn.prototype=Error.prototype,L_(Rr,Bn);function Kh(){}Kh.prototype={length:0,item:function(r){return r>=0&&r<this.length?this[r]:null},toString:function(r,e){for(var s=[],a=0;a<this.length;a++)Eg(this[a],s,r,e);return s.join("")},filter:function(r){return Array.prototype.filter.call(this,r)},indexOf:function(r){return Array.prototype.indexOf.call(this,r)}};function wg(r,e){this._node=r,this._refresh=e,c1(this)}function c1(r){var e=r._node._inc||r._node.ownerDocument._inc;if(r._inc!==e){var s=r._refresh(r._node);if(WD(r,"length",s.length),!r.$$length||s.length<r.$$length)for(var a=s.length;a in r;a++)Object.prototype.hasOwnProperty.call(r,a)&&delete r[a];L_(s,r),r._inc=e}}wg.prototype.item=function(r){return c1(this),this[r]||null},fa(wg,Kh);function MT(){}function ID(r,e){for(var s=r.length;s--;)if(r[s]===e)return s}function LD(r,e,s,a){if(a?e[ID(e,a)]=s:e[e.length++]=s,r){s.ownerElement=r;var h=r.ownerDocument;h&&(a&&OD(h,r,a),r8(h,r,s))}}function ND(r,e,s){var a=ID(e,s);if(a>=0){for(var h=e.length-1;a<h;)e[a]=e[++a];if(e.length=h,r){var p=r.ownerDocument;p&&(OD(p,r,s),s.ownerElement=null)}}else throw new Bn(PD,new Error(r.tagName+"@"+s))}MT.prototype={length:0,item:Kh.prototype.item,getNamedItem:function(r){for(var e=this.length;e--;){var s=this[e];if(s.nodeName==r)return s}},setNamedItem:function(r){var e=r.ownerElement;if(e&&e!=this._ownerElement)throw new Bn(DD);var s=this.getNamedItem(r.nodeName);return LD(this._ownerElement,this,r,s),s},setNamedItemNS:function(r){var e=r.ownerElement,s;if(e&&e!=this._ownerElement)throw new Bn(DD);return s=this.getNamedItemNS(r.namespaceURI,r.localName),LD(this._ownerElement,this,r,s),s},removeNamedItem:function(r){var e=this.getNamedItem(r);return ND(this._ownerElement,this,e),e},removeNamedItemNS:function(r,e){var s=this.getNamedItemNS(r,e);return ND(this._ownerElement,this,s),s},getNamedItemNS:function(r,e){for(var s=this.length;s--;){var a=this[s];if(a.localName==e&&a.namespaceURI==r)return a}return null}};function RD(){}RD.prototype={hasFeature:function(r,e){return!0},createDocument:function(r,e,s){var a=new R_;if(a.implementation=this,a.childNodes=new Kh,a.doctype=s||null,s&&a.appendChild(s),e){var h=a.createElementNS(r,e);a.appendChild(h)}return a},createDocumentType:function(r,e,s){var a=new _1;return a.name=r,a.nodeName=r,a.publicId=e||"",a.systemId=s||"",a}};function Rs(){}Rs.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(r,e){return OT(this,r,e)},replaceChild:function(r,e){OT(this,r,e,jD),e&&this.removeChild(e)},removeChild:function(r){return FD(this,r)},appendChild:function(r){return this.insertBefore(r,null)},hasChildNodes:function(){return this.firstChild!=null},cloneNode:function(r){return w1(this.ownerDocument||this,this,r)},normalize:function(){for(var r=this.firstChild;r;){var e=r.nextSibling;e&&e.nodeType==RT&&r.nodeType==RT?(this.removeChild(e),r.appendData(e.data)):(r.normalize(),r=e)}},isSupported:function(r,e){return this.ownerDocument.implementation.hasFeature(r,e)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(r){for(var e=this;e;){var s=e._nsMap;if(s){for(var a in s)if(Object.prototype.hasOwnProperty.call(s,a)&&s[a]===r)return a}e=e.nodeType==vg?e.ownerDocument:e.parentNode}return null},lookupNamespaceURI:function(r){for(var e=this;e;){var s=e._nsMap;if(s&&Object.prototype.hasOwnProperty.call(s,r))return s[r];e=e.nodeType==vg?e.ownerDocument:e.parentNode}return null},isDefaultNamespace:function(r){var e=this.lookupPrefix(r);return e==null}};function MD(r){return r=="<"&&"&lt;"||r==">"&&"&gt;"||r=="&"&&"&amp;"||r=='"'&&"&quot;"||"&#"+r.charCodeAt()+";"}L_(pa,Rs),L_(pa,Rs.prototype);function N_(r,e){if(e(r))return!0;if(r=r.firstChild)do if(N_(r,e))return!0;while(r=r.nextSibling)}function R_(){this.ownerDocument=this}function r8(r,e,s){r&&r._inc++;var a=s.namespaceURI;a===I_.XMLNS&&(e._nsMap[s.prefix?s.localName:""]=s.value)}function OD(r,e,s,a){r&&r._inc++;var h=s.namespaceURI;h===I_.XMLNS&&delete e._nsMap[s.prefix?s.localName:""]}function d1(r,e,s){if(r&&r._inc){r._inc++;var a=e.childNodes;if(s)a[a.length++]=s;else{for(var h=e.firstChild,p=0;h;)a[p++]=h,h=h.nextSibling;a.length=p,delete a[a.length]}}}function FD(r,e){var s=e.previousSibling,a=e.nextSibling;return s?s.nextSibling=a:r.firstChild=a,a?a.previousSibling=s:r.lastChild=s,e.parentNode=null,e.previousSibling=null,e.nextSibling=null,d1(r.ownerDocument,r),e}function a8(r){return r&&(r.nodeType===Rs.DOCUMENT_NODE||r.nodeType===Rs.DOCUMENT_FRAGMENT_NODE||r.nodeType===Rs.ELEMENT_NODE)}function o8(r){return r&&(Cl(r)||f1(r)||wu(r)||r.nodeType===Rs.DOCUMENT_FRAGMENT_NODE||r.nodeType===Rs.COMMENT_NODE||r.nodeType===Rs.PROCESSING_INSTRUCTION_NODE)}function wu(r){return r&&r.nodeType===Rs.DOCUMENT_TYPE_NODE}function Cl(r){return r&&r.nodeType===Rs.ELEMENT_NODE}function f1(r){return r&&r.nodeType===Rs.TEXT_NODE}function BD(r,e){var s=r.childNodes||[];if(Al(s,Cl)||wu(e))return!1;var a=Al(s,wu);return!(e&&a&&s.indexOf(a)>s.indexOf(e))}function UD(r,e){var s=r.childNodes||[];function a(p){return Cl(p)&&p!==e}if(Al(s,a))return!1;var h=Al(s,wu);return!(e&&h&&s.indexOf(h)>s.indexOf(e))}function l8(r,e,s){if(!a8(r))throw new Bn(ga,"Unexpected parent node type "+r.nodeType);if(s&&s.parentNode!==r)throw new Bn(PD,"child not in parent");if(!o8(e)||wu(e)&&r.nodeType!==Rs.DOCUMENT_NODE)throw new Bn(ga,"Unexpected node type "+e.nodeType+" for parent node type "+r.nodeType)}function u8(r,e,s){var a=r.childNodes||[],h=e.childNodes||[];if(e.nodeType===Rs.DOCUMENT_FRAGMENT_NODE){var p=h.filter(Cl);if(p.length>1||Al(h,f1))throw new Bn(ga,"More than one element or text in fragment");if(p.length===1&&!BD(r,s))throw new Bn(ga,"Element in fragment can not be inserted before doctype")}if(Cl(e)&&!BD(r,s))throw new Bn(ga,"Only one element can be added and only after doctype");if(wu(e)){if(Al(a,wu))throw new Bn(ga,"Only one doctype is allowed");var _=Al(a,Cl);if(s&&a.indexOf(_)<a.indexOf(s))throw new Bn(ga,"Doctype can only be inserted before an element");if(!s&&_)throw new Bn(ga,"Doctype can not be appended since element is present")}}function jD(r,e,s){var a=r.childNodes||[],h=e.childNodes||[];if(e.nodeType===Rs.DOCUMENT_FRAGMENT_NODE){var p=h.filter(Cl);if(p.length>1||Al(h,f1))throw new Bn(ga,"More than one element or text in fragment");if(p.length===1&&!UD(r,s))throw new Bn(ga,"Element in fragment can not be inserted before doctype")}if(Cl(e)&&!UD(r,s))throw new Bn(ga,"Only one element can be added and only after doctype");if(wu(e)){if(Al(a,function(I){return wu(I)&&I!==s}))throw new Bn(ga,"Only one doctype is allowed");var _=Al(a,Cl);if(s&&a.indexOf(_)<a.indexOf(s))throw new Bn(ga,"Doctype can only be inserted before an element")}}function OT(r,e,s,a){l8(r,e,s),r.nodeType===Rs.DOCUMENT_NODE&&(a||u8)(r,e,s);var h=e.parentNode;if(h&&h.removeChild(e),e.nodeType===vu){var p=e.firstChild;if(p==null)return e;var _=e.lastChild}else p=_=e;var w=s?s.previousSibling:r.lastChild;p.previousSibling=w,_.nextSibling=s,w?w.nextSibling=p:r.firstChild=p,s==null?r.lastChild=_:s.previousSibling=_;do p.parentNode=r;while(p!==_&&(p=p.nextSibling));return d1(r.ownerDocument||r,r),e.nodeType==vu&&(e.firstChild=e.lastChild=null),e}function h8(r,e){return e.parentNode&&e.parentNode.removeChild(e),e.parentNode=r,e.previousSibling=r.lastChild,e.nextSibling=null,e.previousSibling?e.previousSibling.nextSibling=e:r.firstChild=e,r.lastChild=e,d1(r.ownerDocument,r,e),e}R_.prototype={nodeName:"#document",nodeType:CD,doctype:null,documentElement:null,_inc:1,insertBefore:function(r,e){if(r.nodeType==vu){for(var s=r.firstChild;s;){var a=s.nextSibling;this.insertBefore(s,e),s=a}return r}return OT(this,r,e),r.ownerDocument=this,this.documentElement===null&&r.nodeType===Uo&&(this.documentElement=r),r},removeChild:function(r){return this.documentElement==r&&(this.documentElement=null),FD(this,r)},replaceChild:function(r,e){OT(this,r,e,jD),r.ownerDocument=this,e&&this.removeChild(e),Cl(r)&&(this.documentElement=r)},importNode:function(r,e){return zD(this,r,e)},getElementById:function(r){var e=null;return N_(this.documentElement,function(s){if(s.nodeType==Uo&&s.getAttribute("id")==r)return e=s,!0}),e},getElementsByClassName:function(r){var e=TD(r);return new wg(this,function(s){var a=[];return e.length>0&&N_(s.documentElement,function(h){if(h!==s&&h.nodeType===Uo){var p=h.getAttribute("class");if(p){var _=r===p;if(!_){var w=TD(p);_=e.every(i8(w))}_&&a.push(h)}}}),a})},createElement:function(r){var e=new Tg;e.ownerDocument=this,e.nodeName=r,e.tagName=r,e.localName=r,e.childNodes=new Kh;var s=e.attributes=new MT;return s._ownerElement=e,e},createDocumentFragment:function(){var r=new BT;return r.ownerDocument=this,r.childNodes=new Kh,r},createTextNode:function(r){var e=new p1;return e.ownerDocument=this,e.appendData(r),e},createComment:function(r){var e=new g1;return e.ownerDocument=this,e.appendData(r),e},createCDATASection:function(r){var e=new m1;return e.ownerDocument=this,e.appendData(r),e},createProcessingInstruction:function(r,e){var s=new y1;return s.ownerDocument=this,s.tagName=s.nodeName=s.target=r,s.nodeValue=s.data=e,s},createAttribute:function(r){var e=new FT;return e.ownerDocument=this,e.name=r,e.nodeName=r,e.localName=r,e.specified=!0,e},createEntityReference:function(r){var e=new b1;return e.ownerDocument=this,e.nodeName=r,e},createElementNS:function(r,e){var s=new Tg,a=e.split(":"),h=s.attributes=new MT;return s.childNodes=new Kh,s.ownerDocument=this,s.nodeName=e,s.tagName=e,s.namespaceURI=r,a.length==2?(s.prefix=a[0],s.localName=a[1]):s.localName=e,h._ownerElement=s,s},createAttributeNS:function(r,e){var s=new FT,a=e.split(":");return s.ownerDocument=this,s.nodeName=e,s.name=e,s.namespaceURI=r,s.specified=!0,a.length==2?(s.prefix=a[0],s.localName=a[1]):s.localName=e,s}},fa(R_,Rs);function Tg(){this._nsMap={}}Tg.prototype={nodeType:Uo,hasAttribute:function(r){return this.getAttributeNode(r)!=null},getAttribute:function(r){var e=this.getAttributeNode(r);return e&&e.value||""},getAttributeNode:function(r){return this.attributes.getNamedItem(r)},setAttribute:function(r,e){var s=this.ownerDocument.createAttribute(r);s.value=s.nodeValue=""+e,this.setAttributeNode(s)},removeAttribute:function(r){var e=this.getAttributeNode(r);e&&this.removeAttributeNode(e)},appendChild:function(r){return r.nodeType===vu?this.insertBefore(r,null):h8(this,r)},setAttributeNode:function(r){return this.attributes.setNamedItem(r)},setAttributeNodeNS:function(r){return this.attributes.setNamedItemNS(r)},removeAttributeNode:function(r){return this.attributes.removeNamedItem(r.nodeName)},removeAttributeNS:function(r,e){var s=this.getAttributeNodeNS(r,e);s&&this.removeAttributeNode(s)},hasAttributeNS:function(r,e){return this.getAttributeNodeNS(r,e)!=null},getAttributeNS:function(r,e){var s=this.getAttributeNodeNS(r,e);return s&&s.value||""},setAttributeNS:function(r,e,s){var a=this.ownerDocument.createAttributeNS(r,e);a.value=a.nodeValue=""+s,this.setAttributeNode(a)},getAttributeNodeNS:function(r,e){return this.attributes.getNamedItemNS(r,e)},getElementsByTagName:function(r){return new wg(this,function(e){var s=[];return N_(e,function(a){a!==e&&a.nodeType==Uo&&(r==="*"||a.tagName==r)&&s.push(a)}),s})},getElementsByTagNameNS:function(r,e){return new wg(this,function(s){var a=[];return N_(s,function(h){h!==s&&h.nodeType===Uo&&(r==="*"||h.namespaceURI===r)&&(e==="*"||h.localName==e)&&a.push(h)}),a})}},R_.prototype.getElementsByTagName=Tg.prototype.getElementsByTagName,R_.prototype.getElementsByTagNameNS=Tg.prototype.getElementsByTagNameNS,fa(Tg,Rs);function FT(){}FT.prototype.nodeType=vg,fa(FT,Rs);function M_(){}M_.prototype={data:"",substringData:function(r,e){return this.data.substring(r,r+e)},appendData:function(r){r=this.data+r,this.nodeValue=this.data=r,this.length=r.length},insertData:function(r,e){this.replaceData(r,0,e)},appendChild:function(r){throw new Error(or[ga])},deleteData:function(r,e){this.replaceData(r,e,"")},replaceData:function(r,e,s){var a=this.data.substring(0,r),h=this.data.substring(r+e);s=a+s+h,this.nodeValue=this.data=s,this.length=s.length}},fa(M_,Rs);function p1(){}p1.prototype={nodeName:"#text",nodeType:RT,splitText:function(r){var e=this.data,s=e.substring(r);e=e.substring(0,r),this.data=this.nodeValue=e,this.length=e.length;var a=this.ownerDocument.createTextNode(s);return this.parentNode&&this.parentNode.insertBefore(a,this.nextSibling),a}},fa(p1,M_);function g1(){}g1.prototype={nodeName:"#comment",nodeType:AD},fa(g1,M_);function m1(){}m1.prototype={nodeName:"#cdata-section",nodeType:ED},fa(m1,M_);function _1(){}_1.prototype.nodeType=kD,fa(_1,Rs);function HD(){}HD.prototype.nodeType=n8,fa(HD,Rs);function VD(){}VD.prototype.nodeType=s8,fa(VD,Rs);function b1(){}b1.prototype.nodeType=SD,fa(b1,Rs);function BT(){}BT.prototype.nodeName="#document-fragment",BT.prototype.nodeType=vu,fa(BT,Rs);function y1(){}y1.prototype.nodeType=xD,fa(y1,Rs),Rs.prototype.toString=c8;function c8(r,e){var s=[],a=this.nodeType==9&&this.documentElement||this,h=a.prefix,p=a.namespaceURI;if(p&&h==null){var h=a.lookupPrefix(p);if(h==null)var _=[{namespace:p,prefix:null}]}return Eg(this,s,r,e,_),s.join("")}function $D(r,e,s){var a=r.prefix||"",h=r.namespaceURI;if(!h||a==="xml"&&h===I_.XML||h===I_.XMLNS)return!1;for(var p=s.length;p--;){var _=s[p];if(_.prefix===a)return _.namespace!==h}return!0}function v1(r,e,s){r.push(" ",e,'="',s.replace(/[<>&"\t\n\r]/g,MD),'"')}function Eg(r,e,s,a,h){if(h||(h=[]),a)if(r=a(r),r){if(typeof r=="string"){e.push(r);return}}else return;switch(r.nodeType){case Uo:var p=r.attributes,_=p.length,Be=r.firstChild,w=r.tagName;s=I_.isHTML(r.namespaceURI)||s;var I=w;if(!s&&!r.prefix&&r.namespaceURI){for(var B,G=0;G<p.length;G++)if(p.item(G).name==="xmlns"){B=p.item(G).value;break}if(!B)for(var se=h.length-1;se>=0;se--){var pe=h[se];if(pe.prefix===""&&pe.namespace===r.namespaceURI){B=pe.namespace;break}}if(B!==r.namespaceURI)for(var se=h.length-1;se>=0;se--){var pe=h[se];if(pe.namespace===r.namespaceURI){pe.prefix&&(I=pe.prefix+":"+w);break}}}e.push("<",I);for(var Ee=0;Ee<_;Ee++){var Ie=p.item(Ee);Ie.prefix=="xmlns"?h.push({prefix:Ie.localName,namespace:Ie.value}):Ie.nodeName=="xmlns"&&h.push({prefix:"",namespace:Ie.value})}for(var Ee=0;Ee<_;Ee++){var Ie=p.item(Ee);if($D(Ie,s,h)){var ce=Ie.prefix||"",Ve=Ie.namespaceURI;v1(e,ce?"xmlns:"+ce:"xmlns",Ve),h.push({prefix:ce,namespace:Ve})}Eg(Ie,e,s,a,h)}if(w===I&&$D(r,s,h)){var ce=r.prefix||"",Ve=r.namespaceURI;v1(e,ce?"xmlns:"+ce:"xmlns",Ve),h.push({prefix:ce,namespace:Ve})}if(Be||s&&!/^(?:meta|link|img|br|hr|input)$/i.test(w)){if(e.push(">"),s&&/^script$/i.test(w))for(;Be;)Be.data?e.push(Be.data):Eg(Be,e,s,a,h.slice()),Be=Be.nextSibling;else for(;Be;)Eg(Be,e,s,a,h.slice()),Be=Be.nextSibling;e.push("</",I,">")}else e.push("/>");return;case CD:case vu:for(var Be=r.firstChild;Be;)Eg(Be,e,s,a,h.slice()),Be=Be.nextSibling;return;case vg:return v1(e,r.name,r.value);case RT:return e.push(r.data.replace(/[<&>]/g,MD));case ED:return e.push("<![CDATA[",r.data,"]]>");case AD:return e.push("<!--",r.data,"-->");case kD:var Ke=r.publicId,ze=r.systemId;if(e.push("<!DOCTYPE ",r.name),Ke)e.push(" PUBLIC ",Ke),ze&&ze!="."&&e.push(" ",ze),e.push(">");else if(ze&&ze!=".")e.push(" SYSTEM ",ze,">");else{var it=r.internalSubset;it&&e.push(" [",it,"]"),e.push(">")}return;case xD:return e.push("<?",r.target," ",r.data,"?>");case SD:return e.push("&",r.nodeName,";");default:e.push("??",r.nodeName)}}function zD(r,e,s){var a;switch(e.nodeType){case Uo:a=e.cloneNode(!1),a.ownerDocument=r;case vu:break;case vg:s=!0;break}if(a||(a=e.cloneNode(!1)),a.ownerDocument=r,a.parentNode=null,s)for(var h=e.firstChild;h;)a.appendChild(zD(r,h,s)),h=h.nextSibling;return a}function w1(r,e,s){var a=new e.constructor;for(var h in e)if(Object.prototype.hasOwnProperty.call(e,h)){var p=e[h];typeof p!="object"&&p!=a[h]&&(a[h]=p)}switch(e.childNodes&&(a.childNodes=new Kh),a.ownerDocument=r,a.nodeType){case Uo:var _=e.attributes,w=a.attributes=new MT,I=_.length;w._ownerElement=a;for(var B=0;B<I;B++)a.setAttributeNode(w1(r,_.item(B),!0));break;case vg:s=!0}if(s)for(var G=e.firstChild;G;)a.appendChild(w1(r,G,s)),G=G.nextSibling;return a}function WD(r,e,s){r[e]=s}try{if(Object.defineProperty){let r=function(e){switch(e.nodeType){case Uo:case vu:var s=[];for(e=e.firstChild;e;)e.nodeType!==7&&e.nodeType!==8&&s.push(r(e)),e=e.nextSibling;return s.join("");default:return e.nodeValue}};Object.defineProperty(wg.prototype,"length",{get:function(){return c1(this),this.$$length}}),Object.defineProperty(Rs.prototype,"textContent",{get:function(){return r(this)},set:function(e){switch(this.nodeType){case Uo:case vu:for(;this.firstChild;)this.removeChild(this.firstChild);(e||String(e))&&this.appendChild(this.ownerDocument.createTextNode(e));break;default:this.data=e,this.value=e,this.nodeValue=e}}}),WD=function(e,s,a){e["$$"+s]=a}}}catch{}var d8=RD,f8={DOMImplementation:d8},O_=y(function(r,e){var s=D_.freeze;e.XML_ENTITIES=s({amp:"&",apos:"'",gt:">",lt:"<",quot:'"'}),e.HTML_ENTITIES=s({Aacute:"Ã",aacute:"Ã¡",Abreve:"Ä",abreve:"Ä",ac:"â¾",acd:"â¿",acE:"â¾Ì³",Acirc:"Ã",acirc:"Ã¢",acute:"Â´",Acy:"Ð",acy:"Ð°",AElig:"Ã",aelig:"Ã¦",af:"â¡",Afr:"ð",afr:"ð",Agrave:"Ã",agrave:"Ã ",alefsym:"âµ",aleph:"âµ",Alpha:"Î",alpha:"Î±",Amacr:"Ä",amacr:"Ä",amalg:"â¨¿",AMP:"&",amp:"&",And:"â©",and:"â§",andand:"â©",andd:"â©",andslope:"â©",andv:"â©",ang:"â ",ange:"â¦¤",angle:"â ",angmsd:"â¡",angmsdaa:"â¦¨",angmsdab:"â¦©",angmsdac:"â¦ª",angmsdad:"â¦«",angmsdae:"â¦¬",angmsdaf:"â¦­",angmsdag:"â¦®",angmsdah:"â¦¯",angrt:"â",angrtvb:"â¾",angrtvbd:"â¦",angsph:"â¢",angst:"Ã",angzarr:"â¼",Aogon:"Ä",aogon:"Ä",Aopf:"ð¸",aopf:"ð",ap:"â",apacir:"â©¯",apE:"â©°",ape:"â",apid:"â",apos:"'",ApplyFunction:"â¡",approx:"â",approxeq:"â",Aring:"Ã",aring:"Ã¥",Ascr:"ð",ascr:"ð¶",Assign:"â",ast:"*",asymp:"â",asympeq:"â",Atilde:"Ã",atilde:"Ã£",Auml:"Ã",auml:"Ã¤",awconint:"â³",awint:"â¨",backcong:"â",backepsilon:"Ï¶",backprime:"âµ",backsim:"â½",backsimeq:"â",Backslash:"â",Barv:"â«§",barvee:"â½",Barwed:"â",barwed:"â",barwedge:"â",bbrk:"âµ",bbrktbrk:"â¶",bcong:"â",Bcy:"Ð",bcy:"Ð±",bdquo:"â",becaus:"âµ",Because:"âµ",because:"âµ",bemptyv:"â¦°",bepsi:"Ï¶",bernou:"â¬",Bernoullis:"â¬",Beta:"Î",beta:"Î²",beth:"â¶",between:"â¬",Bfr:"ð",bfr:"ð",bigcap:"â",bigcirc:"â¯",bigcup:"â",bigodot:"â¨",bigoplus:"â¨",bigotimes:"â¨",bigsqcup:"â¨",bigstar:"â",bigtriangledown:"â½",bigtriangleup:"â³",biguplus:"â¨",bigvee:"â",bigwedge:"â",bkarow:"â¤",blacklozenge:"â§«",blacksquare:"âª",blacktriangle:"â´",blacktriangledown:"â¾",blacktriangleleft:"â",blacktriangleright:"â¸",blank:"â£",blk12:"â",blk14:"â",blk34:"â",block:"â",bne:"=â¥",bnequiv:"â¡â¥",bNot:"â«­",bnot:"â",Bopf:"ð¹",bopf:"ð",bot:"â¥",bottom:"â¥",bowtie:"â",boxbox:"â§",boxDL:"â",boxDl:"â",boxdL:"â",boxdl:"â",boxDR:"â",boxDr:"â",boxdR:"â",boxdr:"â",boxH:"â",boxh:"â",boxHD:"â¦",boxHd:"â¤",boxhD:"â¥",boxhd:"â¬",boxHU:"â©",boxHu:"â§",boxhU:"â¨",boxhu:"â´",boxminus:"â",boxplus:"â",boxtimes:"â ",boxUL:"â",boxUl:"â",boxuL:"â",boxul:"â",boxUR:"â",boxUr:"â",boxuR:"â",boxur:"â",boxV:"â",boxv:"â",boxVH:"â¬",boxVh:"â«",boxvH:"âª",boxvh:"â¼",boxVL:"â£",boxVl:"â¢",boxvL:"â¡",boxvl:"â¤",boxVR:"â ",boxVr:"â",boxvR:"â",boxvr:"â",bprime:"âµ",Breve:"Ë",breve:"Ë",brvbar:"Â¦",Bscr:"â¬",bscr:"ð·",bsemi:"â",bsim:"â½",bsime:"â",bsol:"\\",bsolb:"â§",bsolhsub:"â",bull:"â¢",bullet:"â¢",bump:"â",bumpE:"âª®",bumpe:"â",Bumpeq:"â",bumpeq:"â",Cacute:"Ä",cacute:"Ä",Cap:"â",cap:"â©",capand:"â©",capbrcup:"â©",capcap:"â©",capcup:"â©",capdot:"â©",CapitalDifferentialD:"â",caps:"â©ï¸",caret:"â",caron:"Ë",Cayleys:"â­",ccaps:"â©",Ccaron:"Ä",ccaron:"Ä",Ccedil:"Ã",ccedil:"Ã§",Ccirc:"Ä",ccirc:"Ä",Cconint:"â°",ccups:"â©",ccupssm:"â©",Cdot:"Ä",cdot:"Ä",cedil:"Â¸",Cedilla:"Â¸",cemptyv:"â¦²",cent:"Â¢",CenterDot:"Â·",centerdot:"Â·",Cfr:"â­",cfr:"ð ",CHcy:"Ð§",chcy:"Ñ",check:"â",checkmark:"â",Chi:"Î§",chi:"Ï",cir:"â",circ:"Ë",circeq:"â",circlearrowleft:"âº",circlearrowright:"â»",circledast:"â",circledcirc:"â",circleddash:"â",CircleDot:"â",circledR:"Â®",circledS:"â",CircleMinus:"â",CirclePlus:"â",CircleTimes:"â",cirE:"â§",cire:"â",cirfnint:"â¨",cirmid:"â«¯",cirscir:"â§",ClockwiseContourIntegral:"â²",CloseCurlyDoubleQuote:"â",CloseCurlyQuote:"â",clubs:"â£",clubsuit:"â£",Colon:"â·",colon:":",Colone:"â©´",colone:"â",coloneq:"â",comma:",",commat:"@",comp:"â",compfn:"â",complement:"â",complexes:"â",cong:"â",congdot:"â©­",Congruent:"â¡",Conint:"â¯",conint:"â®",ContourIntegral:"â®",Copf:"â",copf:"ð",coprod:"â",Coproduct:"â",COPY:"Â©",copy:"Â©",copysr:"â",CounterClockwiseContourIntegral:"â³",crarr:"âµ",Cross:"â¨¯",cross:"â",Cscr:"ð",cscr:"ð¸",csub:"â«",csube:"â«",csup:"â«",csupe:"â«",ctdot:"â¯",cudarrl:"â¤¸",cudarrr:"â¤µ",cuepr:"â",cuesc:"â",cularr:"â¶",cularrp:"â¤½",Cup:"â",cup:"âª",cupbrcap:"â©",CupCap:"â",cupcap:"â©",cupcup:"â©",cupdot:"â",cupor:"â©",cups:"âªï¸",curarr:"â·",curarrm:"â¤¼",curlyeqprec:"â",curlyeqsucc:"â",curlyvee:"â",curlywedge:"â",curren:"Â¤",curvearrowleft:"â¶",curvearrowright:"â·",cuvee:"â",cuwed:"â",cwconint:"â²",cwint:"â±",cylcty:"â­",Dagger:"â¡",dagger:"â ",daleth:"â¸",Darr:"â¡",dArr:"â",darr:"â",dash:"â",Dashv:"â«¤",dashv:"â£",dbkarow:"â¤",dblac:"Ë",Dcaron:"Ä",dcaron:"Ä",Dcy:"Ð",dcy:"Ð´",DD:"â",dd:"â",ddagger:"â¡",ddarr:"â",DDotrahd:"â¤",ddotseq:"â©·",deg:"Â°",Del:"â",Delta:"Î",delta:"Î´",demptyv:"â¦±",dfisht:"â¥¿",Dfr:"ð",dfr:"ð¡",dHar:"â¥¥",dharl:"â",dharr:"â",DiacriticalAcute:"Â´",DiacriticalDot:"Ë",DiacriticalDoubleAcute:"Ë",DiacriticalGrave:"`",DiacriticalTilde:"Ë",diam:"â",Diamond:"â",diamond:"â",diamondsuit:"â¦",diams:"â¦",die:"Â¨",DifferentialD:"â",digamma:"Ï",disin:"â²",div:"Ã·",divide:"Ã·",divideontimes:"â",divonx:"â",DJcy:"Ð",djcy:"Ñ",dlcorn:"â",dlcrop:"â",dollar:"$",Dopf:"ð»",dopf:"ð",Dot:"Â¨",dot:"Ë",DotDot:"â",doteq:"â",doteqdot:"â",DotEqual:"â",dotminus:"â¸",dotplus:"â",dotsquare:"â¡",doublebarwedge:"â",DoubleContourIntegral:"â¯",DoubleDot:"Â¨",DoubleDownArrow:"â",DoubleLeftArrow:"â",DoubleLeftRightArrow:"â",DoubleLeftTee:"â«¤",DoubleLongLeftArrow:"â¸",DoubleLongLeftRightArrow:"âº",DoubleLongRightArrow:"â¹",DoubleRightArrow:"â",DoubleRightTee:"â¨",DoubleUpArrow:"â",DoubleUpDownArrow:"â",DoubleVerticalBar:"â¥",DownArrow:"â",Downarrow:"â",downarrow:"â",DownArrowBar:"â¤",DownArrowUpArrow:"âµ",DownBreve:"Ì",downdownarrows:"â",downharpoonleft:"â",downharpoonright:"â",DownLeftRightVector:"â¥",DownLeftTeeVector:"â¥",DownLeftVector:"â½",DownLeftVectorBar:"â¥",DownRightTeeVector:"â¥",DownRightVector:"â",DownRightVectorBar:"â¥",DownTee:"â¤",DownTeeArrow:"â§",drbkarow:"â¤",drcorn:"â",drcrop:"â",Dscr:"ð",dscr:"ð¹",DScy:"Ð",dscy:"Ñ",dsol:"â§¶",Dstrok:"Ä",dstrok:"Ä",dtdot:"â±",dtri:"â¿",dtrif:"â¾",duarr:"âµ",duhar:"â¥¯",dwangle:"â¦¦",DZcy:"Ð",dzcy:"Ñ",dzigrarr:"â¿",Eacute:"Ã",eacute:"Ã©",easter:"â©®",Ecaron:"Ä",ecaron:"Ä",ecir:"â",Ecirc:"Ã",ecirc:"Ãª",ecolon:"â",Ecy:"Ð­",ecy:"Ñ",eDDot:"â©·",Edot:"Ä",eDot:"â",edot:"Ä",ee:"â",efDot:"â",Efr:"ð",efr:"ð¢",eg:"âª",Egrave:"Ã",egrave:"Ã¨",egs:"âª",egsdot:"âª",el:"âª",Element:"â",elinters:"â§",ell:"â",els:"âª",elsdot:"âª",Emacr:"Ä",emacr:"Ä",empty:"â",emptyset:"â",EmptySmallSquare:"â»",emptyv:"â",EmptyVerySmallSquare:"â«",emsp:"â",emsp13:"â",emsp14:"â",ENG:"Å",eng:"Å",ensp:"â",Eogon:"Ä",eogon:"Ä",Eopf:"ð¼",eopf:"ð",epar:"â",eparsl:"â§£",eplus:"â©±",epsi:"Îµ",Epsilon:"Î",epsilon:"Îµ",epsiv:"Ïµ",eqcirc:"â",eqcolon:"â",eqsim:"â",eqslantgtr:"âª",eqslantless:"âª",Equal:"â©µ",equals:"=",EqualTilde:"â",equest:"â",Equilibrium:"â",equiv:"â¡",equivDD:"â©¸",eqvparsl:"â§¥",erarr:"â¥±",erDot:"â",Escr:"â°",escr:"â¯",esdot:"â",Esim:"â©³",esim:"â",Eta:"Î",eta:"Î·",ETH:"Ã",eth:"Ã°",Euml:"Ã",euml:"Ã«",euro:"â¬",excl:"!",exist:"â",Exists:"â",expectation:"â°",ExponentialE:"â",exponentiale:"â",fallingdotseq:"â",Fcy:"Ð¤",fcy:"Ñ",female:"â",ffilig:"ï¬",fflig:"ï¬",ffllig:"ï¬",Ffr:"ð",ffr:"ð£",filig:"ï¬",FilledSmallSquare:"â¼",FilledVerySmallSquare:"âª",fjlig:"fj",flat:"â­",fllig:"ï¬",fltns:"â±",fnof:"Æ",Fopf:"ð½",fopf:"ð",ForAll:"â",forall:"â",fork:"â",forkv:"â«",Fouriertrf:"â±",fpartint:"â¨",frac12:"Â½",frac13:"â",frac14:"Â¼",frac15:"â",frac16:"â",frac18:"â",frac23:"â",frac25:"â",frac34:"Â¾",frac35:"â",frac38:"â",frac45:"â",frac56:"â",frac58:"â",frac78:"â",frasl:"â",frown:"â¢",Fscr:"â±",fscr:"ð»",gacute:"Çµ",Gamma:"Î",gamma:"Î³",Gammad:"Ï",gammad:"Ï",gap:"âª",Gbreve:"Ä",gbreve:"Ä",Gcedil:"Ä¢",Gcirc:"Ä",gcirc:"Ä",Gcy:"Ð",gcy:"Ð³",Gdot:"Ä ",gdot:"Ä¡",gE:"â§",ge:"â¥",gEl:"âª",gel:"â",geq:"â¥",geqq:"â§",geqslant:"â©¾",ges:"â©¾",gescc:"âª©",gesdot:"âª",gesdoto:"âª",gesdotol:"âª",gesl:"âï¸",gesles:"âª",Gfr:"ð",gfr:"ð¤",Gg:"â",gg:"â«",ggg:"â",gimel:"â·",GJcy:"Ð",gjcy:"Ñ",gl:"â·",gla:"âª¥",glE:"âª",glj:"âª¤",gnap:"âª",gnapprox:"âª",gnE:"â©",gne:"âª",gneq:"âª",gneqq:"â©",gnsim:"â§",Gopf:"ð¾",gopf:"ð",grave:"`",GreaterEqual:"â¥",GreaterEqualLess:"â",GreaterFullEqual:"â§",GreaterGreater:"âª¢",GreaterLess:"â·",GreaterSlantEqual:"â©¾",GreaterTilde:"â³",Gscr:"ð¢",gscr:"â",gsim:"â³",gsime:"âª",gsiml:"âª",Gt:"â«",GT:">",gt:">",gtcc:"âª§",gtcir:"â©º",gtdot:"â",gtlPar:"â¦",gtquest:"â©¼",gtrapprox:"âª",gtrarr:"â¥¸",gtrdot:"â",gtreqless:"â",gtreqqless:"âª",gtrless:"â·",gtrsim:"â³",gvertneqq:"â©ï¸",gvnE:"â©ï¸",Hacek:"Ë",hairsp:"â",half:"Â½",hamilt:"â",HARDcy:"Ðª",hardcy:"Ñ",hArr:"â",harr:"â",harrcir:"â¥",harrw:"â­",Hat:"^",hbar:"â",Hcirc:"Ä¤",hcirc:"Ä¥",hearts:"â¥",heartsuit:"â¥",hellip:"â¦",hercon:"â¹",Hfr:"â",hfr:"ð¥",HilbertSpace:"â",hksearow:"â¤¥",hkswarow:"â¤¦",hoarr:"â¿",homtht:"â»",hookleftarrow:"â©",hookrightarrow:"âª",Hopf:"â",hopf:"ð",horbar:"â",HorizontalLine:"â",Hscr:"â",hscr:"ð½",hslash:"â",Hstrok:"Ä¦",hstrok:"Ä§",HumpDownHump:"â",HumpEqual:"â",hybull:"â",hyphen:"â",Iacute:"Ã",iacute:"Ã­",ic:"â£",Icirc:"Ã",icirc:"Ã®",Icy:"Ð",icy:"Ð¸",Idot:"Ä°",IEcy:"Ð",iecy:"Ðµ",iexcl:"Â¡",iff:"â",Ifr:"â",ifr:"ð¦",Igrave:"Ã",igrave:"Ã¬",ii:"â",iiiint:"â¨",iiint:"â­",iinfin:"â§",iiota:"â©",IJlig:"Ä²",ijlig:"Ä³",Im:"â",Imacr:"Äª",imacr:"Ä«",image:"â",ImaginaryI:"â",imagline:"â",imagpart:"â",imath:"Ä±",imof:"â·",imped:"Æµ",Implies:"â",in:"â",incare:"â",infin:"â",infintie:"â§",inodot:"Ä±",Int:"â¬",int:"â«",intcal:"âº",integers:"â¤",Integral:"â«",intercal:"âº",Intersection:"â",intlarhk:"â¨",intprod:"â¨¼",InvisibleComma:"â£",InvisibleTimes:"â¢",IOcy:"Ð",iocy:"Ñ",Iogon:"Ä®",iogon:"Ä¯",Iopf:"ð",iopf:"ð",Iota:"Î",iota:"Î¹",iprod:"â¨¼",iquest:"Â¿",Iscr:"â",iscr:"ð¾",isin:"â",isindot:"âµ",isinE:"â¹",isins:"â´",isinsv:"â³",isinv:"â",it:"â¢",Itilde:"Ä¨",itilde:"Ä©",Iukcy:"Ð",iukcy:"Ñ",Iuml:"Ã",iuml:"Ã¯",Jcirc:"Ä´",jcirc:"Äµ",Jcy:"Ð",jcy:"Ð¹",Jfr:"ð",jfr:"ð§",jmath:"È·",Jopf:"ð",jopf:"ð",Jscr:"ð¥",jscr:"ð¿",Jsercy:"Ð",jsercy:"Ñ",Jukcy:"Ð",jukcy:"Ñ",Kappa:"Î",kappa:"Îº",kappav:"Ï°",Kcedil:"Ä¶",kcedil:"Ä·",Kcy:"Ð",kcy:"Ðº",Kfr:"ð",kfr:"ð¨",kgreen:"Ä¸",KHcy:"Ð¥",khcy:"Ñ",KJcy:"Ð",kjcy:"Ñ",Kopf:"ð",kopf:"ð",Kscr:"ð¦",kscr:"ð",lAarr:"â",Lacute:"Ä¹",lacute:"Äº",laemptyv:"â¦´",lagran:"â",Lambda:"Î",lambda:"Î»",Lang:"âª",lang:"â¨",langd:"â¦",langle:"â¨",lap:"âª",Laplacetrf:"â",laquo:"Â«",Larr:"â",lArr:"â",larr:"â",larrb:"â¤",larrbfs:"â¤",larrfs:"â¤",larrhk:"â©",larrlp:"â«",larrpl:"â¤¹",larrsim:"â¥³",larrtl:"â¢",lat:"âª«",lAtail:"â¤",latail:"â¤",late:"âª­",lates:"âª­ï¸",lBarr:"â¤",lbarr:"â¤",lbbrk:"â²",lbrace:"{",lbrack:"[",lbrke:"â¦",lbrksld:"â¦",lbrkslu:"â¦",Lcaron:"Ä½",lcaron:"Ä¾",Lcedil:"Ä»",lcedil:"Ä¼",lceil:"â",lcub:"{",Lcy:"Ð",lcy:"Ð»",ldca:"â¤¶",ldquo:"â",ldquor:"â",ldrdhar:"â¥§",ldrushar:"â¥",ldsh:"â²",lE:"â¦",le:"â¤",LeftAngleBracket:"â¨",LeftArrow:"â",Leftarrow:"â",leftarrow:"â",LeftArrowBar:"â¤",LeftArrowRightArrow:"â",leftarrowtail:"â¢",LeftCeiling:"â",LeftDoubleBracket:"â¦",LeftDownTeeVector:"â¥¡",LeftDownVector:"â",LeftDownVectorBar:"â¥",LeftFloor:"â",leftharpoondown:"â½",leftharpoonup:"â¼",leftleftarrows:"â",LeftRightArrow:"â",Leftrightarrow:"â",leftrightarrow:"â",leftrightarrows:"â",leftrightharpoons:"â",leftrightsquigarrow:"â­",LeftRightVector:"â¥",LeftTee:"â£",LeftTeeArrow:"â¤",LeftTeeVector:"â¥",leftthreetimes:"â",LeftTriangle:"â²",LeftTriangleBar:"â§",LeftTriangleEqual:"â´",LeftUpDownVector:"â¥",LeftUpTeeVector:"â¥ ",LeftUpVector:"â¿",LeftUpVectorBar:"â¥",LeftVector:"â¼",LeftVectorBar:"â¥",lEg:"âª",leg:"â",leq:"â¤",leqq:"â¦",leqslant:"â©½",les:"â©½",lescc:"âª¨",lesdot:"â©¿",lesdoto:"âª",lesdotor:"âª",lesg:"âï¸",lesges:"âª",lessapprox:"âª",lessdot:"â",lesseqgtr:"â",lesseqqgtr:"âª",LessEqualGreater:"â",LessFullEqual:"â¦",LessGreater:"â¶",lessgtr:"â¶",LessLess:"âª¡",lesssim:"â²",LessSlantEqual:"â©½",LessTilde:"â²",lfisht:"â¥¼",lfloor:"â",Lfr:"ð",lfr:"ð©",lg:"â¶",lgE:"âª",lHar:"â¥¢",lhard:"â½",lharu:"â¼",lharul:"â¥ª",lhblk:"â",LJcy:"Ð",ljcy:"Ñ",Ll:"â",ll:"âª",llarr:"â",llcorner:"â",Lleftarrow:"â",llhard:"â¥«",lltri:"âº",Lmidot:"Ä¿",lmidot:"Å",lmoust:"â°",lmoustache:"â°",lnap:"âª",lnapprox:"âª",lnE:"â¨",lne:"âª",lneq:"âª",lneqq:"â¨",lnsim:"â¦",loang:"â¬",loarr:"â½",lobrk:"â¦",LongLeftArrow:"âµ",Longleftarrow:"â¸",longleftarrow:"âµ",LongLeftRightArrow:"â·",Longleftrightarrow:"âº",longleftrightarrow:"â·",longmapsto:"â¼",LongRightArrow:"â¶",Longrightarrow:"â¹",longrightarrow:"â¶",looparrowleft:"â«",looparrowright:"â¬",lopar:"â¦",Lopf:"ð",lopf:"ð",loplus:"â¨­",lotimes:"â¨´",lowast:"â",lowbar:"_",LowerLeftArrow:"â",LowerRightArrow:"â",loz:"â",lozenge:"â",lozf:"â§«",lpar:"(",lparlt:"â¦",lrarr:"â",lrcorner:"â",lrhar:"â",lrhard:"â¥­",lrm:"â",lrtri:"â¿",lsaquo:"â¹",Lscr:"â",lscr:"ð",Lsh:"â°",lsh:"â°",lsim:"â²",lsime:"âª",lsimg:"âª",lsqb:"[",lsquo:"â",lsquor:"â",Lstrok:"Å",lstrok:"Å",Lt:"âª",LT:"<",lt:"<",ltcc:"âª¦",ltcir:"â©¹",ltdot:"â",lthree:"â",ltimes:"â",ltlarr:"â¥¶",ltquest:"â©»",ltri:"â",ltrie:"â´",ltrif:"â",ltrPar:"â¦",lurdshar:"â¥",luruhar:"â¥¦",lvertneqq:"â¨ï¸",lvnE:"â¨ï¸",macr:"Â¯",male:"â",malt:"â ",maltese:"â ",Map:"â¤",map:"â¦",mapsto:"â¦",mapstodown:"â§",mapstoleft:"â¤",mapstoup:"â¥",marker:"â®",mcomma:"â¨©",Mcy:"Ð",mcy:"Ð¼",mdash:"â",mDDot:"âº",measuredangle:"â¡",MediumSpace:"â",Mellintrf:"â³",Mfr:"ð",mfr:"ðª",mho:"â§",micro:"Âµ",mid:"â£",midast:"*",midcir:"â«°",middot:"Â·",minus:"â",minusb:"â",minusd:"â¸",minusdu:"â¨ª",MinusPlus:"â",mlcp:"â«",mldr:"â¦",mnplus:"â",models:"â§",Mopf:"ð",mopf:"ð",mp:"â",Mscr:"â³",mscr:"ð",mstpos:"â¾",Mu:"Î",mu:"Î¼",multimap:"â¸",mumap:"â¸",nabla:"â",Nacute:"Å",nacute:"Å",nang:"â â",nap:"â",napE:"â©°Ì¸",napid:"âÌ¸",napos:"Å",napprox:"â",natur:"â®",natural:"â®",naturals:"â",nbsp:"Â ",nbump:"âÌ¸",nbumpe:"âÌ¸",ncap:"â©",Ncaron:"Å",ncaron:"Å",Ncedil:"Å",ncedil:"Å",ncong:"â",ncongdot:"â©­Ì¸",ncup:"â©",Ncy:"Ð",ncy:"Ð½",ndash:"â",ne:"â ",nearhk:"â¤¤",neArr:"â",nearr:"â",nearrow:"â",nedot:"âÌ¸",NegativeMediumSpace:"â",NegativeThickSpace:"â",NegativeThinSpace:"â",NegativeVeryThinSpace:"â",nequiv:"â¢",nesear:"â¤¨",nesim:"âÌ¸",NestedGreaterGreater:"â«",NestedLessLess:"âª",NewLine:`
`,nexist:"â",nexists:"â",Nfr:"ð",nfr:"ð«",ngE:"â§Ì¸",nge:"â±",ngeq:"â±",ngeqq:"â§Ì¸",ngeqslant:"â©¾Ì¸",nges:"â©¾Ì¸",nGg:"âÌ¸",ngsim:"âµ",nGt:"â«â",ngt:"â¯",ngtr:"â¯",nGtv:"â«Ì¸",nhArr:"â",nharr:"â®",nhpar:"â«²",ni:"â",nis:"â¼",nisd:"âº",niv:"â",NJcy:"Ð",njcy:"Ñ",nlArr:"â",nlarr:"â",nldr:"â¥",nlE:"â¦Ì¸",nle:"â°",nLeftarrow:"â",nleftarrow:"â",nLeftrightarrow:"â",nleftrightarrow:"â®",nleq:"â°",nleqq:"â¦Ì¸",nleqslant:"â©½Ì¸",nles:"â©½Ì¸",nless:"â®",nLl:"âÌ¸",nlsim:"â´",nLt:"âªâ",nlt:"â®",nltri:"âª",nltrie:"â¬",nLtv:"âªÌ¸",nmid:"â¤",NoBreak:"â ",NonBreakingSpace:"Â ",Nopf:"â",nopf:"ð",Not:"â«¬",not:"Â¬",NotCongruent:"â¢",NotCupCap:"â­",NotDoubleVerticalBar:"â¦",NotElement:"â",NotEqual:"â ",NotEqualTilde:"âÌ¸",NotExists:"â",NotGreater:"â¯",NotGreaterEqual:"â±",NotGreaterFullEqual:"â§Ì¸",NotGreaterGreater:"â«Ì¸",NotGreaterLess:"â¹",NotGreaterSlantEqual:"â©¾Ì¸",NotGreaterTilde:"âµ",NotHumpDownHump:"âÌ¸",NotHumpEqual:"âÌ¸",notin:"â",notindot:"âµÌ¸",notinE:"â¹Ì¸",notinva:"â",notinvb:"â·",notinvc:"â¶",NotLeftTriangle:"âª",NotLeftTriangleBar:"â§Ì¸",NotLeftTriangleEqual:"â¬",NotLess:"â®",NotLessEqual:"â°",NotLessGreater:"â¸",NotLessLess:"âªÌ¸",NotLessSlantEqual:"â©½Ì¸",NotLessTilde:"â´",NotNestedGreaterGreater:"âª¢Ì¸",NotNestedLessLess:"âª¡Ì¸",notni:"â",notniva:"â",notnivb:"â¾",notnivc:"â½",NotPrecedes:"â",NotPrecedesEqual:"âª¯Ì¸",NotPrecedesSlantEqual:"â ",NotReverseElement:"â",NotRightTriangle:"â«",NotRightTriangleBar:"â§Ì¸",NotRightTriangleEqual:"â­",NotSquareSubset:"âÌ¸",NotSquareSubsetEqual:"â¢",NotSquareSuperset:"âÌ¸",NotSquareSupersetEqual:"â£",NotSubset:"ââ",NotSubsetEqual:"â",NotSucceeds:"â",NotSucceedsEqual:"âª°Ì¸",NotSucceedsSlantEqual:"â¡",NotSucceedsTilde:"â¿Ì¸",NotSuperset:"ââ",NotSupersetEqual:"â",NotTilde:"â",NotTildeEqual:"â",NotTildeFullEqual:"â",NotTildeTilde:"â",NotVerticalBar:"â¤",npar:"â¦",nparallel:"â¦",nparsl:"â«½â¥",npart:"âÌ¸",npolint:"â¨",npr:"â",nprcue:"â ",npre:"âª¯Ì¸",nprec:"â",npreceq:"âª¯Ì¸",nrArr:"â",nrarr:"â",nrarrc:"â¤³Ì¸",nrarrw:"âÌ¸",nRightarrow:"â",nrightarrow:"â",nrtri:"â«",nrtrie:"â­",nsc:"â",nsccue:"â¡",nsce:"âª°Ì¸",Nscr:"ð©",nscr:"ð",nshortmid:"â¤",nshortparallel:"â¦",nsim:"â",nsime:"â",nsimeq:"â",nsmid:"â¤",nspar:"â¦",nsqsube:"â¢",nsqsupe:"â£",nsub:"â",nsubE:"â«Ì¸",nsube:"â",nsubset:"ââ",nsubseteq:"â",nsubseteqq:"â«Ì¸",nsucc:"â",nsucceq:"âª°Ì¸",nsup:"â",nsupE:"â«Ì¸",nsupe:"â",nsupset:"ââ",nsupseteq:"â",nsupseteqq:"â«Ì¸",ntgl:"â¹",Ntilde:"Ã",ntilde:"Ã±",ntlg:"â¸",ntriangleleft:"âª",ntrianglelefteq:"â¬",ntriangleright:"â«",ntrianglerighteq:"â­",Nu:"Î",nu:"Î½",num:"#",numero:"â",numsp:"â",nvap:"ââ",nVDash:"â¯",nVdash:"â®",nvDash:"â­",nvdash:"â¬",nvge:"â¥â",nvgt:">â",nvHarr:"â¤",nvinfin:"â§",nvlArr:"â¤",nvle:"â¤â",nvlt:"<â",nvltrie:"â´â",nvrArr:"â¤",nvrtrie:"âµâ",nvsim:"â¼â",nwarhk:"â¤£",nwArr:"â",nwarr:"â",nwarrow:"â",nwnear:"â¤§",Oacute:"Ã",oacute:"Ã³",oast:"â",ocir:"â",Ocirc:"Ã",ocirc:"Ã´",Ocy:"Ð",ocy:"Ð¾",odash:"â",Odblac:"Å",odblac:"Å",odiv:"â¨¸",odot:"â",odsold:"â¦¼",OElig:"Å",oelig:"Å",ofcir:"â¦¿",Ofr:"ð",ofr:"ð¬",ogon:"Ë",Ograve:"Ã",ograve:"Ã²",ogt:"â§",ohbar:"â¦µ",ohm:"Î©",oint:"â®",olarr:"âº",olcir:"â¦¾",olcross:"â¦»",oline:"â¾",olt:"â§",Omacr:"Å",omacr:"Å",Omega:"Î©",omega:"Ï",Omicron:"Î",omicron:"Î¿",omid:"â¦¶",ominus:"â",Oopf:"ð",oopf:"ð ",opar:"â¦·",OpenCurlyDoubleQuote:"â",OpenCurlyQuote:"â",operp:"â¦¹",oplus:"â",Or:"â©",or:"â¨",orarr:"â»",ord:"â©",order:"â´",orderof:"â´",ordf:"Âª",ordm:"Âº",origof:"â¶",oror:"â©",orslope:"â©",orv:"â©",oS:"â",Oscr:"ðª",oscr:"â´",Oslash:"Ã",oslash:"Ã¸",osol:"â",Otilde:"Ã",otilde:"Ãµ",Otimes:"â¨·",otimes:"â",otimesas:"â¨¶",Ouml:"Ã",ouml:"Ã¶",ovbar:"â½",OverBar:"â¾",OverBrace:"â",OverBracket:"â´",OverParenthesis:"â",par:"â¥",para:"Â¶",parallel:"â¥",parsim:"â«³",parsl:"â«½",part:"â",PartialD:"â",Pcy:"Ð",pcy:"Ð¿",percnt:"%",period:".",permil:"â°",perp:"â¥",pertenk:"â±",Pfr:"ð",pfr:"ð­",Phi:"Î¦",phi:"Ï",phiv:"Ï",phmmat:"â³",phone:"â",Pi:"Î ",pi:"Ï",pitchfork:"â",piv:"Ï",planck:"â",planckh:"â",plankv:"â",plus:"+",plusacir:"â¨£",plusb:"â",pluscir:"â¨¢",plusdo:"â",plusdu:"â¨¥",pluse:"â©²",PlusMinus:"Â±",plusmn:"Â±",plussim:"â¨¦",plustwo:"â¨§",pm:"Â±",Poincareplane:"â",pointint:"â¨",Popf:"â",popf:"ð¡",pound:"Â£",Pr:"âª»",pr:"âº",prap:"âª·",prcue:"â¼",prE:"âª³",pre:"âª¯",prec:"âº",precapprox:"âª·",preccurlyeq:"â¼",Precedes:"âº",PrecedesEqual:"âª¯",PrecedesSlantEqual:"â¼",PrecedesTilde:"â¾",preceq:"âª¯",precnapprox:"âª¹",precneqq:"âªµ",precnsim:"â¨",precsim:"â¾",Prime:"â³",prime:"â²",primes:"â",prnap:"âª¹",prnE:"âªµ",prnsim:"â¨",prod:"â",Product:"â",profalar:"â®",profline:"â",profsurf:"â",prop:"â",Proportion:"â·",Proportional:"â",propto:"â",prsim:"â¾",prurel:"â°",Pscr:"ð«",pscr:"ð",Psi:"Î¨",psi:"Ï",puncsp:"â",Qfr:"ð",qfr:"ð®",qint:"â¨",Qopf:"â",qopf:"ð¢",qprime:"â",Qscr:"ð¬",qscr:"ð",quaternions:"â",quatint:"â¨",quest:"?",questeq:"â",QUOT:'"',quot:'"',rAarr:"â",race:"â½Ì±",Racute:"Å",racute:"Å",radic:"â",raemptyv:"â¦³",Rang:"â«",rang:"â©",rangd:"â¦",range:"â¦¥",rangle:"â©",raquo:"Â»",Rarr:"â ",rArr:"â",rarr:"â",rarrap:"â¥µ",rarrb:"â¥",rarrbfs:"â¤ ",rarrc:"â¤³",rarrfs:"â¤",rarrhk:"âª",rarrlp:"â¬",rarrpl:"â¥",rarrsim:"â¥´",Rarrtl:"â¤",rarrtl:"â£",rarrw:"â",rAtail:"â¤",ratail:"â¤",ratio:"â¶",rationals:"â",RBarr:"â¤",rBarr:"â¤",rbarr:"â¤",rbbrk:"â³",rbrace:"}",rbrack:"]",rbrke:"â¦",rbrksld:"â¦",rbrkslu:"â¦",Rcaron:"Å",rcaron:"Å",Rcedil:"Å",rcedil:"Å",rceil:"â",rcub:"}",Rcy:"Ð ",rcy:"Ñ",rdca:"â¤·",rdldhar:"â¥©",rdquo:"â",rdquor:"â",rdsh:"â³",Re:"â",real:"â",realine:"â",realpart:"â",reals:"â",rect:"â­",REG:"Â®",reg:"Â®",ReverseElement:"â",ReverseEquilibrium:"â",ReverseUpEquilibrium:"â¥¯",rfisht:"â¥½",rfloor:"â",Rfr:"â",rfr:"ð¯",rHar:"â¥¤",rhard:"â",rharu:"â",rharul:"â¥¬",Rho:"Î¡",rho:"Ï",rhov:"Ï±",RightAngleBracket:"â©",RightArrow:"â",Rightarrow:"â",rightarrow:"â",RightArrowBar:"â¥",RightArrowLeftArrow:"â",rightarrowtail:"â£",RightCeiling:"â",RightDoubleBracket:"â§",RightDownTeeVector:"â¥",RightDownVector:"â",RightDownVectorBar:"â¥",RightFloor:"â",rightharpoondown:"â",rightharpoonup:"â",rightleftarrows:"â",rightleftharpoons:"â",rightrightarrows:"â",rightsquigarrow:"â",RightTee:"â¢",RightTeeArrow:"â¦",RightTeeVector:"â¥",rightthreetimes:"â",RightTriangle:"â³",RightTriangleBar:"â§",RightTriangleEqual:"âµ",RightUpDownVector:"â¥",RightUpTeeVector:"â¥",RightUpVector:"â¾",RightUpVectorBar:"â¥",RightVector:"â",RightVectorBar:"â¥",ring:"Ë",risingdotseq:"â",rlarr:"â",rlhar:"â",rlm:"â",rmoust:"â±",rmoustache:"â±",rnmid:"â«®",roang:"â­",roarr:"â¾",robrk:"â§",ropar:"â¦",Ropf:"â",ropf:"ð£",roplus:"â¨®",rotimes:"â¨µ",RoundImplies:"â¥°",rpar:")",rpargt:"â¦",rppolint:"â¨",rrarr:"â",Rrightarrow:"â",rsaquo:"âº",Rscr:"â",rscr:"ð",Rsh:"â±",rsh:"â±",rsqb:"]",rsquo:"â",rsquor:"â",rthree:"â",rtimes:"â",rtri:"â¹",rtrie:"âµ",rtrif:"â¸",rtriltri:"â§",RuleDelayed:"â§´",ruluhar:"â¥¨",rx:"â",Sacute:"Å",sacute:"Å",sbquo:"â",Sc:"âª¼",sc:"â»",scap:"âª¸",Scaron:"Å ",scaron:"Å¡",sccue:"â½",scE:"âª´",sce:"âª°",Scedil:"Å",scedil:"Å",Scirc:"Å",scirc:"Å",scnap:"âªº",scnE:"âª¶",scnsim:"â©",scpolint:"â¨",scsim:"â¿",Scy:"Ð¡",scy:"Ñ",sdot:"â",sdotb:"â¡",sdote:"â©¦",searhk:"â¤¥",seArr:"â",searr:"â",searrow:"â",sect:"Â§",semi:";",seswar:"â¤©",setminus:"â",setmn:"â",sext:"â¶",Sfr:"ð",sfr:"ð°",sfrown:"â¢",sharp:"â¯",SHCHcy:"Ð©",shchcy:"Ñ",SHcy:"Ð¨",shcy:"Ñ",ShortDownArrow:"â",ShortLeftArrow:"â",shortmid:"â£",shortparallel:"â¥",ShortRightArrow:"â",ShortUpArrow:"â",shy:"Â­",Sigma:"Î£",sigma:"Ï",sigmaf:"Ï",sigmav:"Ï",sim:"â¼",simdot:"â©ª",sime:"â",simeq:"â",simg:"âª",simgE:"âª ",siml:"âª",simlE:"âª",simne:"â",simplus:"â¨¤",simrarr:"â¥²",slarr:"â",SmallCircle:"â",smallsetminus:"â",smashp:"â¨³",smeparsl:"â§¤",smid:"â£",smile:"â£",smt:"âªª",smte:"âª¬",smtes:"âª¬ï¸",SOFTcy:"Ð¬",softcy:"Ñ",sol:"/",solb:"â§",solbar:"â¿",Sopf:"ð",sopf:"ð¤",spades:"â ",spadesuit:"â ",spar:"â¥",sqcap:"â",sqcaps:"âï¸",sqcup:"â",sqcups:"âï¸",Sqrt:"â",sqsub:"â",sqsube:"â",sqsubset:"â",sqsubseteq:"â",sqsup:"â",sqsupe:"â",sqsupset:"â",sqsupseteq:"â",squ:"â¡",Square:"â¡",square:"â¡",SquareIntersection:"â",SquareSubset:"â",SquareSubsetEqual:"â",SquareSuperset:"â",SquareSupersetEqual:"â",SquareUnion:"â",squarf:"âª",squf:"âª",srarr:"â",Sscr:"ð®",sscr:"ð",ssetmn:"â",ssmile:"â£",sstarf:"â",Star:"â",star:"â",starf:"â",straightepsilon:"Ïµ",straightphi:"Ï",strns:"Â¯",Sub:"â",sub:"â",subdot:"âª½",subE:"â«",sube:"â",subedot:"â«",submult:"â«",subnE:"â«",subne:"â",subplus:"âª¿",subrarr:"â¥¹",Subset:"â",subset:"â",subseteq:"â",subseteqq:"â«",SubsetEqual:"â",subsetneq:"â",subsetneqq:"â«",subsim:"â«",subsub:"â«",subsup:"â«",succ:"â»",succapprox:"âª¸",succcurlyeq:"â½",Succeeds:"â»",SucceedsEqual:"âª°",SucceedsSlantEqual:"â½",SucceedsTilde:"â¿",succeq:"âª°",succnapprox:"âªº",succneqq:"âª¶",succnsim:"â©",succsim:"â¿",SuchThat:"â",Sum:"â",sum:"â",sung:"âª",Sup:"â",sup:"â",sup1:"Â¹",sup2:"Â²",sup3:"Â³",supdot:"âª¾",supdsub:"â«",supE:"â«",supe:"â",supedot:"â«",Superset:"â",SupersetEqual:"â",suphsol:"â",suphsub:"â«",suplarr:"â¥»",supmult:"â«",supnE:"â«",supne:"â",supplus:"â«",Supset:"â",supset:"â",supseteq:"â",supseteqq:"â«",supsetneq:"â",supsetneqq:"â«",supsim:"â«",supsub:"â«",supsup:"â«",swarhk:"â¤¦",swArr:"â",swarr:"â",swarrow:"â",swnwar:"â¤ª",szlig:"Ã",Tab:"	",target:"â",Tau:"Î¤",tau:"Ï",tbrk:"â´",Tcaron:"Å¤",tcaron:"Å¥",Tcedil:"Å¢",tcedil:"Å£",Tcy:"Ð¢",tcy:"Ñ",tdot:"â",telrec:"â",Tfr:"ð",tfr:"ð±",there4:"â´",Therefore:"â´",therefore:"â´",Theta:"Î",theta:"Î¸",thetasym:"Ï",thetav:"Ï",thickapprox:"â",thicksim:"â¼",ThickSpace:"ââ",thinsp:"â",ThinSpace:"â",thkap:"â",thksim:"â¼",THORN:"Ã",thorn:"Ã¾",Tilde:"â¼",tilde:"Ë",TildeEqual:"â",TildeFullEqual:"â",TildeTilde:"â",times:"Ã",timesb:"â ",timesbar:"â¨±",timesd:"â¨°",tint:"â­",toea:"â¤¨",top:"â¤",topbot:"â¶",topcir:"â«±",Topf:"ð",topf:"ð¥",topfork:"â«",tosa:"â¤©",tprime:"â´",TRADE:"â¢",trade:"â¢",triangle:"âµ",triangledown:"â¿",triangleleft:"â",trianglelefteq:"â´",triangleq:"â",triangleright:"â¹",trianglerighteq:"âµ",tridot:"â¬",trie:"â",triminus:"â¨º",TripleDot:"â",triplus:"â¨¹",trisb:"â§",tritime:"â¨»",trpezium:"â¢",Tscr:"ð¯",tscr:"ð",TScy:"Ð¦",tscy:"Ñ",TSHcy:"Ð",tshcy:"Ñ",Tstrok:"Å¦",tstrok:"Å§",twixt:"â¬",twoheadleftarrow:"â",twoheadrightarrow:"â ",Uacute:"Ã",uacute:"Ãº",Uarr:"â",uArr:"â",uarr:"â",Uarrocir:"â¥",Ubrcy:"Ð",ubrcy:"Ñ",Ubreve:"Å¬",ubreve:"Å­",Ucirc:"Ã",ucirc:"Ã»",Ucy:"Ð£",ucy:"Ñ",udarr:"â",Udblac:"Å°",udblac:"Å±",udhar:"â¥®",ufisht:"â¥¾",Ufr:"ð",ufr:"ð²",Ugrave:"Ã",ugrave:"Ã¹",uHar:"â¥£",uharl:"â¿",uharr:"â¾",uhblk:"â",ulcorn:"â",ulcorner:"â",ulcrop:"â",ultri:"â¸",Umacr:"Åª",umacr:"Å«",uml:"Â¨",UnderBar:"_",UnderBrace:"â",UnderBracket:"âµ",UnderParenthesis:"â",Union:"â",UnionPlus:"â",Uogon:"Å²",uogon:"Å³",Uopf:"ð",uopf:"ð¦",UpArrow:"â",Uparrow:"â",uparrow:"â",UpArrowBar:"â¤",UpArrowDownArrow:"â",UpDownArrow:"â",Updownarrow:"â",updownarrow:"â",UpEquilibrium:"â¥®",upharpoonleft:"â¿",upharpoonright:"â¾",uplus:"â",UpperLeftArrow:"â",UpperRightArrow:"â",Upsi:"Ï",upsi:"Ï",upsih:"Ï",Upsilon:"Î¥",upsilon:"Ï",UpTee:"â¥",UpTeeArrow:"â¥",upuparrows:"â",urcorn:"â",urcorner:"â",urcrop:"â",Uring:"Å®",uring:"Å¯",urtri:"â¹",Uscr:"ð°",uscr:"ð",utdot:"â°",Utilde:"Å¨",utilde:"Å©",utri:"âµ",utrif:"â´",uuarr:"â",Uuml:"Ã",uuml:"Ã¼",uwangle:"â¦§",vangrt:"â¦",varepsilon:"Ïµ",varkappa:"Ï°",varnothing:"â",varphi:"Ï",varpi:"Ï",varpropto:"â",vArr:"â",varr:"â",varrho:"Ï±",varsigma:"Ï",varsubsetneq:"âï¸",varsubsetneqq:"â«ï¸",varsupsetneq:"âï¸",varsupsetneqq:"â«ï¸",vartheta:"Ï",vartriangleleft:"â²",vartriangleright:"â³",Vbar:"â««",vBar:"â«¨",vBarv:"â«©",Vcy:"Ð",vcy:"Ð²",VDash:"â«",Vdash:"â©",vDash:"â¨",vdash:"â¢",Vdashl:"â«¦",Vee:"â",vee:"â¨",veebar:"â»",veeeq:"â",vellip:"â®",Verbar:"â",verbar:"|",Vert:"â",vert:"|",VerticalBar:"â£",VerticalLine:"|",VerticalSeparator:"â",VerticalTilde:"â",VeryThinSpace:"â",Vfr:"ð",vfr:"ð³",vltri:"â²",vnsub:"ââ",vnsup:"ââ",Vopf:"ð",vopf:"ð§",vprop:"â",vrtri:"â³",Vscr:"ð±",vscr:"ð",vsubnE:"â«ï¸",vsubne:"âï¸",vsupnE:"â«ï¸",vsupne:"âï¸",Vvdash:"âª",vzigzag:"â¦",Wcirc:"Å´",wcirc:"Åµ",wedbar:"â©",Wedge:"â",wedge:"â§",wedgeq:"â",weierp:"â",Wfr:"ð",wfr:"ð´",Wopf:"ð",wopf:"ð¨",wp:"â",wr:"â",wreath:"â",Wscr:"ð²",wscr:"ð",xcap:"â",xcirc:"â¯",xcup:"â",xdtri:"â½",Xfr:"ð",xfr:"ðµ",xhArr:"âº",xharr:"â·",Xi:"Î",xi:"Î¾",xlArr:"â¸",xlarr:"âµ",xmap:"â¼",xnis:"â»",xodot:"â¨",Xopf:"ð",xopf:"ð©",xoplus:"â¨",xotime:"â¨",xrArr:"â¹",xrarr:"â¶",Xscr:"ð³",xscr:"ð",xsqcup:"â¨",xuplus:"â¨",xutri:"â³",xvee:"â",xwedge:"â",Yacute:"Ã",yacute:"Ã½",YAcy:"Ð¯",yacy:"Ñ",Ycirc:"Å¶",ycirc:"Å·",Ycy:"Ð«",ycy:"Ñ",yen:"Â¥",Yfr:"ð",yfr:"ð¶",YIcy:"Ð",yicy:"Ñ",Yopf:"ð",yopf:"ðª",Yscr:"ð´",yscr:"ð",YUcy:"Ð®",yucy:"Ñ",Yuml:"Å¸",yuml:"Ã¿",Zacute:"Å¹",zacute:"Åº",Zcaron:"Å½",zcaron:"Å¾",Zcy:"Ð",zcy:"Ð·",Zdot:"Å»",zdot:"Å¼",zeetrf:"â¨",ZeroWidthSpace:"â",Zeta:"Î",zeta:"Î¶",Zfr:"â¨",zfr:"ð·",ZHcy:"Ð",zhcy:"Ð¶",zigrarr:"â",Zopf:"â¤",zopf:"ð«",Zscr:"ðµ",zscr:"ð",zwj:"â",zwnj:"â"}),e.entityMap=e.HTML_ENTITIES});O_.XML_ENTITIES,O_.HTML_ENTITIES,O_.entityMap;var F_=D_.NAMESPACE,T1=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,qD=new RegExp("[\\-\\.0-9"+T1.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),GD=new RegExp("^"+T1.source+qD.source+"*(?::"+T1.source+qD.source+"*)?$"),B_=0,Yh=1,Sg=2,U_=3,xg=4,Ag=5,j_=6,UT=7;function Cg(r,e){this.message=r,this.locator=e,Error.captureStackTrace&&Error.captureStackTrace(this,Cg)}Cg.prototype=new Error,Cg.prototype.name=Cg.name;function XD(){}XD.prototype={parse:function(r,e,s){var a=this.domBuilder;a.startDocument(),ZD(e,e={}),p8(r,e,s,a,this.errorHandler),a.endDocument()}};function p8(r,e,s,a,h){function p(ys){if(ys>65535){ys-=65536;var Cn=55296+(ys>>10),Eu=56320+(ys&1023);return String.fromCharCode(Cn,Eu)}else return String.fromCharCode(ys)}function _(ys){var Cn=ys.slice(1,-1);return Object.hasOwnProperty.call(s,Cn)?s[Cn]:Cn.charAt(0)==="#"?p(parseInt(Cn.substr(1).replace("x","0x"))):(h.error("entity not found:"+ys),ys)}function w(ys){if(ys>ce){var Cn=r.substring(ce,ys).replace(/&#?\w+;/g,_);pe&&I(ce),a.characters(Cn,0,ys-ce),ce=ys}}function I(ys,Cn){for(;ys>=G&&(Cn=se.exec(r));)B=Cn.index,G=B+Cn[0].length,pe.lineNumber++;pe.columnNumber=ys-B+1}for(var B=0,G=0,se=/.*(?:\r\n?|\n)|.*$/g,pe=a.locator,Ee=[{currentNSMap:e}],Ie={},ce=0;;){try{var Ve=r.indexOf("<",ce);if(Ve<0){if(!r.substr(ce).match(/^\s*$/)){var Be=a.doc,Ke=Be.createTextNode(r.substr(ce));Be.appendChild(Ke),a.currentElement=Ke}return}switch(Ve>ce&&w(Ve),r.charAt(Ve+1)){case"/":var us=r.indexOf(">",Ve+3),ze=r.substring(Ve+2,us).replace(/[ \t\n\r]+$/g,""),it=Ee.pop();us<0?(ze=r.substring(Ve+2).replace(/[\s<].*/,""),h.error("end tag name: "+ze+" is not complete:"+it.tagName),us=Ve+1+ze.length):ze.match(/\s</)&&(ze=ze.replace(/[\s<].*/,""),h.error("end tag name: "+ze+" maybe not complete"),us=Ve+1+ze.length);var lt=it.localNSMap,Et=it.tagName==ze,yt=Et||it.tagName&&it.tagName.toLowerCase()==ze.toLowerCase();if(yt){if(a.endElement(it.uri,it.localName,ze),lt)for(var Pt in lt)Object.prototype.hasOwnProperty.call(lt,Pt)&&a.endPrefixMapping(Pt);Et||h.fatalError("end tag name: "+ze+" is not match the current start tagName:"+it.tagName)}else Ee.push(it);us++;break;case"?":pe&&I(Ve),us=y8(r,Ve,a);break;case"!":pe&&I(Ve),us=b8(r,Ve,a,h);break;default:pe&&I(Ve);var Ti=new QD,Ms=Ee[Ee.length-1].currentNSMap,us=g8(r,Ve,Ti,Ms,_,h),Vs=Ti.length;if(!Ti.closed&&_8(r,us,Ti.tagName,Ie)&&(Ti.closed=!0,s.nbsp||h.warning("unclosed xml attribute")),pe&&Vs){for(var ai=KD(pe,{}),cs=0;cs<Vs;cs++){var Yr=Ti[cs];I(Yr.offset),Yr.locator=KD(pe,{})}a.locator=ai,YD(Ti,a,Ms)&&Ee.push(Ti),a.locator=pe}else YD(Ti,a,Ms)&&Ee.push(Ti);F_.isHTML(Ti.uri)&&!Ti.closed?us=m8(r,us,Ti.tagName,_,a):us++}}catch(ys){if(ys instanceof Cg)throw ys;h.error("element parse error: "+ys),us=-1}us>ce?ce=us:w(Math.max(Ve,ce)+1)}}function KD(r,e){return e.lineNumber=r.lineNumber,e.columnNumber=r.columnNumber,e}function g8(r,e,s,a,h,p){function _(pe,Ee,Ie){s.attributeNames.hasOwnProperty(pe)&&p.fatalError("Attribute "+pe+" redefined"),s.addValue(pe,Ee.replace(/[\t\n\r]/g," ").replace(/&#?\w+;/g,h),Ie)}for(var w,I,B=++e,G=B_;;){var se=r.charAt(B);switch(se){case"=":if(G===Yh)w=r.slice(e,B),G=U_;else if(G===Sg)G=U_;else throw new Error("attribute equal must after attrName");break;case"'":case'"':if(G===U_||G===Yh)if(G===Yh&&(p.warning('attribute value must after "="'),w=r.slice(e,B)),e=B+1,B=r.indexOf(se,e),B>0)I=r.slice(e,B),_(w,I,e-1),G=Ag;else throw new Error("attribute value no end '"+se+"' match");else if(G==xg)I=r.slice(e,B),_(w,I,e),p.warning('attribute "'+w+'" missed start quot('+se+")!!"),e=B+1,G=Ag;else throw new Error('attribute value must after "="');break;case"/":switch(G){case B_:s.setTagName(r.slice(e,B));case Ag:case j_:case UT:G=UT,s.closed=!0;case xg:case Yh:break;case Sg:s.closed=!0;break;default:throw new Error("attribute invalid close char('/')")}break;case"":return p.error("unexpected end of input"),G==B_&&s.setTagName(r.slice(e,B)),B;case">":switch(G){case B_:s.setTagName(r.slice(e,B));case Ag:case j_:case UT:break;case xg:case Yh:I=r.slice(e,B),I.slice(-1)==="/"&&(s.closed=!0,I=I.slice(0,-1));case Sg:G===Sg&&(I=w),G==xg?(p.warning('attribute "'+I+'" missed quot(")!'),_(w,I,e)):((!F_.isHTML(a[""])||!I.match(/^(?:disabled|checked|selected)$/i))&&p.warning('attribute "'+I+'" missed value!! "'+I+'" instead!!'),_(I,I,e));break;case U_:throw new Error("attribute value missed!!")}return B;case"Â":se=" ";default:if(se<=" ")switch(G){case B_:s.setTagName(r.slice(e,B)),G=j_;break;case Yh:w=r.slice(e,B),G=Sg;break;case xg:var I=r.slice(e,B);p.warning('attribute "'+I+'" missed quot(")!!'),_(w,I,e);case Ag:G=j_;break}else switch(G){case Sg:s.tagName,(!F_.isHTML(a[""])||!w.match(/^(?:disabled|checked|selected)$/i))&&p.warning('attribute "'+w+'" missed value!! "'+w+'" instead2!!'),_(w,w,e),e=B,G=Yh;break;case Ag:p.warning('attribute space is required"'+w+'"!!');case j_:G=Yh,e=B;break;case U_:G=xg,e=B;break;case UT:throw new Error("elements closed character '/' and '>' must be connected to")}}B++}}function YD(r,e,s){for(var a=r.tagName,h=null,se=r.length;se--;){var p=r[se],_=p.qName,w=p.value,pe=_.indexOf(":");if(pe>0)var I=p.prefix=_.slice(0,pe),B=_.slice(pe+1),G=I==="xmlns"&&B;else B=_,I=null,G=_==="xmlns"&&"";p.localName=B,G!==!1&&(h==null&&(h={},ZD(s,s={})),s[G]=h[G]=w,p.uri=F_.XMLNS,e.startPrefixMapping(G,w))}for(var se=r.length;se--;){p=r[se];var I=p.prefix;I&&(I==="xml"&&(p.uri=F_.XML),I!=="xmlns"&&(p.uri=s[I||""]))}var pe=a.indexOf(":");pe>0?(I=r.prefix=a.slice(0,pe),B=r.localName=a.slice(pe+1)):(I=null,B=r.localName=a);var Ee=r.uri=s[I||""];if(e.startElement(Ee,B,a,r),r.closed){if(e.endElement(Ee,B,a),h)for(I in h)Object.prototype.hasOwnProperty.call(h,I)&&e.endPrefixMapping(I)}else return r.currentNSMap=s,r.localNSMap=h,!0}function m8(r,e,s,a,h){if(/^(?:script|textarea)$/i.test(s)){var p=r.indexOf("</"+s+">",e),_=r.substring(e+1,p);if(/[&<]/.test(_))return/^script$/i.test(s)?(h.characters(_,0,_.length),p):(_=_.replace(/&#?\w+;/g,a),h.characters(_,0,_.length),p)}return e+1}function _8(r,e,s,a){var h=a[s];return h==null&&(h=r.lastIndexOf("</"+s+">"),h<e&&(h=r.lastIndexOf("</"+s)),a[s]=h),h<e}function ZD(r,e){for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}function b8(r,e,s,a){var h=r.charAt(e+2);switch(h){case"-":if(r.charAt(e+3)==="-"){var p=r.indexOf("-->",e+4);return p>e?(s.comment(r,e+4,p-e-4),p+3):(a.error("Unclosed comment"),-1)}else return-1;default:if(r.substr(e+3,6)=="CDATA["){var p=r.indexOf("]]>",e+9);return s.startCDATA(),s.characters(r,e+9,p-e-9),s.endCDATA(),p+3}var _=v8(r,e),w=_.length;if(w>1&&/!doctype/i.test(_[0][0])){var I=_[1][0],B=!1,G=!1;w>3&&(/^public$/i.test(_[2][0])?(B=_[3][0],G=w>4&&_[4][0]):/^system$/i.test(_[2][0])&&(G=_[3][0]));var se=_[w-1];return s.startDTD(I,B,G),s.endDTD(),se.index+se[0].length}}return-1}function y8(r,e,s){var a=r.indexOf("?>",e);if(a){var h=r.substring(e,a).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);return h?(h[0].length,s.processingInstruction(h[1],h[2]),a+2):-1}return-1}function QD(){this.attributeNames={}}QD.prototype={setTagName:function(r){if(!GD.test(r))throw new Error("invalid tagName:"+r);this.tagName=r},addValue:function(r,e,s){if(!GD.test(r))throw new Error("invalid attribute:"+r);this.attributeNames[r]=this.length,this[this.length++]={qName:r,value:e,offset:s}},length:0,getLocalName:function(r){return this[r].localName},getLocator:function(r){return this[r].locator},getQName:function(r){return this[r].qName},getURI:function(r){return this[r].uri},getValue:function(r){return this[r].value}};function v8(r,e){var s,a=[],h=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;for(h.lastIndex=e,h.exec(r);s=h.exec(r);)if(a.push(s),s[1])return a}var w8=XD,T8=Cg,JD={XMLReader:w8,ParseError:T8},E8=f8.DOMImplementation,eI=D_.NAMESPACE,S8=JD.ParseError,x8=JD.XMLReader;function A8(r){return r.replace(/\r[\n\u0085]/g,`
`).replace(/[\r\u0085\u2028]/g,`
`)}function tI(r){this.options=r||{locator:{}}}tI.prototype.parseFromString=function(r,e){var s=this.options,a=new x8,h=s.domBuilder||new jT,p=s.errorHandler,_=s.locator,w=s.xmlns||{},I=/\/x?html?$/.test(e),B=I?O_.HTML_ENTITIES:O_.XML_ENTITIES;_&&h.setDocumentLocator(_),a.errorHandler=C8(p,h,_),a.domBuilder=s.domBuilder||h,I&&(w[""]=eI.HTML),w.xml=w.xml||eI.XML;var G=s.normalizeLineEndings||A8;return r&&typeof r=="string"?a.parse(G(r),w,B):a.errorHandler.error("invalid doc source"),h.doc};function C8(r,e,s){if(!r){if(e instanceof jT)return e;r=e}var a={},h=r instanceof Function;s=s||{};function p(_){var w=r[_];!w&&h&&(w=r.length==2?function(I){r(_,I)}:r),a[_]=w&&function(I){w("[xmldom "+_+"]	"+I+E1(s))}||function(){}}return p("warning"),p("error"),p("fatalError"),a}function jT(){this.cdata=!1}function kg(r,e){e.lineNumber=r.lineNumber,e.columnNumber=r.columnNumber}jT.prototype={startDocument:function(){this.doc=new E8().createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(r,e,s,a){var h=this.doc,p=h.createElementNS(r,s||e),_=a.length;HT(this,p),this.currentElement=p,this.locator&&kg(this.locator,p);for(var w=0;w<_;w++){var r=a.getURI(w),I=a.getValue(w),s=a.getQName(w),B=h.createAttributeNS(r,s);this.locator&&kg(a.getLocator(w),B),B.value=B.nodeValue=I,p.setAttributeNode(B)}},endElement:function(r,e,s){var a=this.currentElement;a.tagName,this.currentElement=a.parentNode},startPrefixMapping:function(r,e){},endPrefixMapping:function(r){},processingInstruction:function(r,e){var s=this.doc.createProcessingInstruction(r,e);this.locator&&kg(this.locator,s),HT(this,s)},ignorableWhitespace:function(r,e,s){},characters:function(r,e,s){if(r=iI.apply(this,arguments),r){if(this.cdata)var a=this.doc.createCDATASection(r);else var a=this.doc.createTextNode(r);this.currentElement?this.currentElement.appendChild(a):/^\s*$/.test(r)&&this.doc.appendChild(a),this.locator&&kg(this.locator,a)}},skippedEntity:function(r){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(r){(this.locator=r)&&(r.lineNumber=0)},comment:function(r,e,s){r=iI.apply(this,arguments);var a=this.doc.createComment(r);this.locator&&kg(this.locator,a),HT(this,a)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(r,e,s){var a=this.doc.implementation;if(a&&a.createDocumentType){var h=a.createDocumentType(r,e,s);this.locator&&kg(this.locator,h),HT(this,h),this.doc.doctype=h}},warning:function(r){console.warn("[xmldom warning]	"+r,E1(this.locator))},error:function(r){console.error("[xmldom error]	"+r,E1(this.locator))},fatalError:function(r){throw new S8(r,this.locator)}};function E1(r){if(r)return`
@`+(r.systemId||"")+"#[line:"+r.lineNumber+",col:"+r.columnNumber+"]"}function iI(r,e,s){return typeof r=="string"?r.substr(e,s):r.length>=e+s||e?new java.lang.String(r,e,s)+"":r}"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(r){jT.prototype[r]=function(){return null}});function HT(r,e){r.currentElement?r.currentElement.appendChild(e):r.doc.appendChild(e)}var k8=tI,P8={DOMParser:k8},D8=P8.DOMParser;/*! @name mpd-parser @version 1.3.1 @license Apache-2.0 */const sI=r=>!!r&&typeof r=="object",lr=(...r)=>r.reduce((e,s)=>(typeof s!="object"||Object.keys(s).forEach(a=>{Array.isArray(e[a])&&Array.isArray(s[a])?e[a]=e[a].concat(s[a]):sI(e[a])&&sI(s[a])?e[a]=lr(e[a],s[a]):e[a]=s[a]}),e),{}),nI=r=>Object.keys(r).map(e=>r[e]),I8=(r,e)=>{const s=[];for(let a=r;a<e;a++)s.push(a);return s},Pg=r=>r.reduce((e,s)=>e.concat(s),[]),rI=r=>{if(!r.length)return[];const e=[];for(let s=0;s<r.length;s++)e.push(r[s]);return e},L8=(r,e)=>r.reduce((s,a,h)=>(a[e]&&s.push(h),s),[]),N8=(r,e)=>nI(r.reduce((s,a)=>(a.forEach(h=>{s[e(h)]=h}),s),{}));var Dg={INVALID_NUMBER_OF_PERIOD:"INVALID_NUMBER_OF_PERIOD",DASH_EMPTY_MANIFEST:"DASH_EMPTY_MANIFEST",DASH_INVALID_XML:"DASH_INVALID_XML",NO_BASE_URL:"NO_BASE_URL",SEGMENT_TIME_UNSPECIFIED:"SEGMENT_TIME_UNSPECIFIED",UNSUPPORTED_UTC_TIMING_SCHEME:"UNSUPPORTED_UTC_TIMING_SCHEME"};const H_=({baseUrl:r="",source:e="",range:s="",indexRange:a=""})=>{const h={uri:e,resolvedUri:NT(r||"",e)};if(s||a){const _=(s||a).split("-");let w=window.BigInt?window.BigInt(_[0]):parseInt(_[0],10),I=window.BigInt?window.BigInt(_[1]):parseInt(_[1],10);w<Number.MAX_SAFE_INTEGER&&typeof w=="bigint"&&(w=Number(w)),I<Number.MAX_SAFE_INTEGER&&typeof I=="bigint"&&(I=Number(I));let B;typeof I=="bigint"||typeof w=="bigint"?B=window.BigInt(I)-window.BigInt(w)+window.BigInt(1):B=I-w+1,typeof B=="bigint"&&B<Number.MAX_SAFE_INTEGER&&(B=Number(B)),h.byterange={length:B,offset:w}}return h},R8=r=>{let e;return typeof r.offset=="bigint"||typeof r.length=="bigint"?e=window.BigInt(r.offset)+window.BigInt(r.length)-window.BigInt(1):e=r.offset+r.length-1,`${r.offset}-${e}`},aI=r=>(r&&typeof r!="number"&&(r=parseInt(r,10)),isNaN(r)?null:r),M8={static(r){const{duration:e,timescale:s=1,sourceDuration:a,periodDuration:h}=r,p=aI(r.endNumber),_=e/s;return typeof p=="number"?{start:0,end:p}:typeof h=="number"?{start:0,end:h/_}:{start:0,end:a/_}},dynamic(r){const{NOW:e,clientOffset:s,availabilityStartTime:a,timescale:h=1,duration:p,periodStart:_=0,minimumUpdatePeriod:w=0,timeShiftBufferDepth:I=1/0}=r,B=aI(r.endNumber),G=(e+s)/1e3,se=a+_,Ee=G+w-se,Ie=Math.ceil(Ee*h/p),ce=Math.floor((G-se-I)*h/p),Ve=Math.floor((G-se)*h/p);return{start:Math.max(0,ce),end:typeof B=="number"?B:Math.min(Ie,Ve)}}},O8=r=>e=>{const{duration:s,timescale:a=1,periodStart:h,startNumber:p=1}=r;return{number:p+e,duration:s/a,timeline:h,time:e*s}},S1=r=>{const{type:e,duration:s,timescale:a=1,periodDuration:h,sourceDuration:p}=r,{start:_,end:w}=M8[e](r),I=I8(_,w).map(O8(r));if(e==="static"){const B=I.length-1,G=typeof h=="number"?h:p;I[B].duration=G-s/a*B}return I},oI=r=>{const{baseUrl:e,initialization:s={},sourceDuration:a,indexRange:h="",periodStart:p,presentationTime:_,number:w=0,duration:I}=r;if(!e)throw new Error(Dg.NO_BASE_URL);const B=H_({baseUrl:e,source:s.sourceURL,range:s.range}),G=H_({baseUrl:e,source:e,indexRange:h});if(G.map=B,I){const se=S1(r);se.length&&(G.duration=se[0].duration,G.timeline=se[0].timeline)}else a&&(G.duration=a,G.timeline=p);return G.presentationTime=_||p,G.number=w,[G]},x1=(r,e,s)=>{const a=r.sidx.map?r.sidx.map:null,h=r.sidx.duration,p=r.timeline||0,_=r.sidx.byterange,w=_.offset+_.length,I=e.timescale,B=e.references.filter(Ve=>Ve.referenceType!==1),G=[],se=r.endList?"static":"dynamic",pe=r.sidx.timeline;let Ee=pe,Ie=r.mediaSequence||0,ce;typeof e.firstOffset=="bigint"?ce=window.BigInt(w)+e.firstOffset:ce=w+e.firstOffset;for(let Ve=0;Ve<B.length;Ve++){const Be=e.references[Ve],Ke=Be.referencedSize,ze=Be.subsegmentDuration;let it;typeof ce=="bigint"?it=ce+window.BigInt(Ke)-window.BigInt(1):it=ce+Ke-1;const lt=`${ce}-${it}`,yt=oI({baseUrl:s,timescale:I,timeline:p,periodStart:pe,presentationTime:Ee,number:Ie,duration:ze,sourceDuration:h,indexRange:lt,type:se})[0];a&&(yt.map=a),G.push(yt),typeof ce=="bigint"?ce+=window.BigInt(Ke):ce+=Ke,Ee+=ze/I,Ie++}return r.segments=G,r},F8=["AUDIO","SUBTITLES"],B8=1/60,lI=r=>N8(r,({timeline:e})=>e).sort((e,s)=>e.timeline>s.timeline?1:-1),U8=(r,e)=>{for(let s=0;s<r.length;s++)if(r[s].attributes.NAME===e)return r[s];return null},uI=r=>{let e=[];return G4(r,F8,(s,a,h,p)=>{e=e.concat(s.playlists||[])}),e},hI=({playlist:r,mediaSequence:e})=>{r.mediaSequence=e,r.segments.forEach((s,a)=>{s.number=r.mediaSequence+a})},j8=({oldPlaylists:r,newPlaylists:e,timelineStarts:s})=>{e.forEach(a=>{a.discontinuitySequence=s.findIndex(function({timeline:I}){return I===a.timeline});const h=U8(r,a.attributes.NAME);if(!h||a.sidx)return;const p=a.segments[0],_=h.segments.findIndex(function(I){return Math.abs(I.presentationTime-p.presentationTime)<B8});if(_===-1){hI({playlist:a,mediaSequence:h.mediaSequence+h.segments.length}),a.segments[0].discontinuity=!0,a.discontinuityStarts.unshift(0),(!h.segments.length&&a.timeline>h.timeline||h.segments.length&&a.timeline>h.segments[h.segments.length-1].timeline)&&a.discontinuitySequence--;return}h.segments[_].discontinuity&&!p.discontinuity&&(p.discontinuity=!0,a.discontinuityStarts.unshift(0),a.discontinuitySequence--),hI({playlist:a,mediaSequence:h.segments[_].number})})},H8=({oldManifest:r,newManifest:e})=>{const s=r.playlists.concat(uI(r)),a=e.playlists.concat(uI(e));return e.timelineStarts=lI([r.timelineStarts,e.timelineStarts]),j8({oldPlaylists:s,newPlaylists:a,timelineStarts:e.timelineStarts}),e},VT=r=>r&&r.uri+"-"+R8(r.byterange),A1=r=>{const e=r.reduce(function(a,h){return a[h.attributes.baseUrl]||(a[h.attributes.baseUrl]=[]),a[h.attributes.baseUrl].push(h),a},{});let s=[];return Object.values(e).forEach(a=>{const h=nI(a.reduce((p,_)=>{const w=_.attributes.id+(_.attributes.lang||"");return p[w]?(_.segments&&(_.segments[0]&&(_.segments[0].discontinuity=!0),p[w].segments.push(..._.segments)),_.attributes.contentProtection&&(p[w].attributes.contentProtection=_.attributes.contentProtection)):(p[w]=_,p[w].attributes.timelineStarts=[]),p[w].attributes.timelineStarts.push({start:_.attributes.periodStart,timeline:_.attributes.periodStart}),p},{}));s=s.concat(h)}),s.map(a=>(a.discontinuityStarts=L8(a.segments||[],"discontinuity"),a))},C1=(r,e)=>{const s=VT(r.sidx),a=s&&e[s]&&e[s].sidx;return a&&x1(r,a,r.sidx.resolvedUri),r},V8=(r,e={})=>{if(!Object.keys(e).length)return r;for(const s in r)r[s]=C1(r[s],e);return r},$8=({attributes:r,segments:e,sidx:s,mediaSequence:a,discontinuitySequence:h,discontinuityStarts:p},_)=>{const w={attributes:{NAME:r.id,BANDWIDTH:r.bandwidth,CODECS:r.codecs,"PROGRAM-ID":1},uri:"",endList:r.type==="static",timeline:r.periodStart,resolvedUri:r.baseUrl||"",targetDuration:r.duration,discontinuitySequence:h,discontinuityStarts:p,timelineStarts:r.timelineStarts,mediaSequence:a,segments:e};return r.contentProtection&&(w.contentProtection=r.contentProtection),r.serviceLocation&&(w.attributes.serviceLocation=r.serviceLocation),s&&(w.sidx=s),_&&(w.attributes.AUDIO="audio",w.attributes.SUBTITLES="subs"),w},z8=({attributes:r,segments:e,mediaSequence:s,discontinuityStarts:a,discontinuitySequence:h})=>{typeof e>"u"&&(e=[{uri:r.baseUrl,timeline:r.periodStart,resolvedUri:r.baseUrl||"",duration:r.sourceDuration,number:0}],r.duration=r.sourceDuration);const p={NAME:r.id,BANDWIDTH:r.bandwidth,"PROGRAM-ID":1};r.codecs&&(p.CODECS=r.codecs);const _={attributes:p,uri:"",endList:r.type==="static",timeline:r.periodStart,resolvedUri:r.baseUrl||"",targetDuration:r.duration,timelineStarts:r.timelineStarts,discontinuityStarts:a,discontinuitySequence:h,mediaSequence:s,segments:e};return r.serviceLocation&&(_.attributes.serviceLocation=r.serviceLocation),_},W8=(r,e={},s=!1)=>{let a;const h=r.reduce((p,_)=>{const w=_.attributes.role&&_.attributes.role.value||"",I=_.attributes.lang||"";let B=_.attributes.label||"main";if(I&&!_.attributes.label){const se=w?` (${w})`:"";B=`${_.attributes.lang}${se}`}p[B]||(p[B]={language:I,autoselect:!0,default:w==="main",playlists:[],uri:""});const G=C1($8(_,s),e);return p[B].playlists.push(G),typeof a>"u"&&w==="main"&&(a=_,a.default=!0),p},{});if(!a){const p=Object.keys(h)[0];h[p].default=!0}return h},q8=(r,e={})=>r.reduce((s,a)=>{const h=a.attributes.label||a.attributes.lang||"text",p=a.attributes.lang||"und";return s[h]||(s[h]={language:p,default:!1,autoselect:!1,playlists:[],uri:""}),s[h].playlists.push(C1(z8(a),e)),s},{}),G8=r=>r.reduce((e,s)=>(s&&s.forEach(a=>{const{channel:h,language:p}=a;e[p]={autoselect:!1,default:!1,instreamId:h,language:p},a.hasOwnProperty("aspectRatio")&&(e[p].aspectRatio=a.aspectRatio),a.hasOwnProperty("easyReader")&&(e[p].easyReader=a.easyReader),a.hasOwnProperty("3D")&&(e[p]["3D"]=a["3D"])}),e),{}),X8=({attributes:r,segments:e,sidx:s,discontinuityStarts:a})=>{const h={attributes:{NAME:r.id,AUDIO:"audio",SUBTITLES:"subs",RESOLUTION:{width:r.width,height:r.height},CODECS:r.codecs,BANDWIDTH:r.bandwidth,"PROGRAM-ID":1},uri:"",endList:r.type==="static",timeline:r.periodStart,resolvedUri:r.baseUrl||"",targetDuration:r.duration,discontinuityStarts:a,timelineStarts:r.timelineStarts,segments:e};return r.frameRate&&(h.attributes["FRAME-RATE"]=r.frameRate),r.contentProtection&&(h.contentProtection=r.contentProtection),r.serviceLocation&&(h.attributes.serviceLocation=r.serviceLocation),s&&(h.sidx=s),h},K8=({attributes:r})=>r.mimeType==="video/mp4"||r.mimeType==="video/webm"||r.contentType==="video",Y8=({attributes:r})=>r.mimeType==="audio/mp4"||r.mimeType==="audio/webm"||r.contentType==="audio",Z8=({attributes:r})=>r.mimeType==="text/vtt"||r.contentType==="text",Q8=(r,e)=>{r.forEach(s=>{s.mediaSequence=0,s.discontinuitySequence=e.findIndex(function({timeline:a}){return a===s.timeline}),s.segments&&s.segments.forEach((a,h)=>{a.number=h})})},cI=r=>r?Object.keys(r).reduce((e,s)=>{const a=r[s];return e.concat(a.playlists)},[]):[],J8=({dashPlaylists:r,locations:e,contentSteering:s,sidxMapping:a={},previousManifest:h,eventStream:p})=>{if(!r.length)return{};const{sourceDuration:_,type:w,suggestedPresentationDelay:I,minimumUpdatePeriod:B}=r[0].attributes,G=A1(r.filter(K8)).map(X8),se=A1(r.filter(Y8)),pe=A1(r.filter(Z8)),Ee=r.map(it=>it.attributes.captionServices).filter(Boolean),Ie={allowCache:!0,discontinuityStarts:[],segments:[],endList:!0,mediaGroups:{AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},uri:"",duration:_,playlists:V8(G,a)};B>=0&&(Ie.minimumUpdatePeriod=B*1e3),e&&(Ie.locations=e),s&&(Ie.contentSteering=s),w==="dynamic"&&(Ie.suggestedPresentationDelay=I),p&&p.length>0&&(Ie.eventStream=p);const ce=Ie.playlists.length===0,Ve=se.length?W8(se,a,ce):null,Be=pe.length?q8(pe,a):null,Ke=G.concat(cI(Ve),cI(Be)),ze=Ke.map(({timelineStarts:it})=>it);return Ie.timelineStarts=lI(ze),Q8(Ke,Ie.timelineStarts),Ve&&(Ie.mediaGroups.AUDIO.audio=Ve),Be&&(Ie.mediaGroups.SUBTITLES.subs=Be),Ee.length&&(Ie.mediaGroups["CLOSED-CAPTIONS"].cc=G8(Ee)),h?H8({oldManifest:h,newManifest:Ie}):Ie},eU=(r,e,s)=>{const{NOW:a,clientOffset:h,availabilityStartTime:p,timescale:_=1,periodStart:w=0,minimumUpdatePeriod:I=0}=r,B=(a+h)/1e3,G=p+w,pe=B+I-G;return Math.ceil((pe*_-e)/s)},dI=(r,e)=>{const{type:s,minimumUpdatePeriod:a=0,media:h="",sourceDuration:p,timescale:_=1,startNumber:w=1,periodStart:I}=r,B=[];let G=-1;for(let se=0;se<e.length;se++){const pe=e[se],Ee=pe.d,Ie=pe.r||0,ce=pe.t||0;G<0&&(G=ce),ce&&ce>G&&(G=ce);let Ve;if(Ie<0){const ze=se+1;ze===e.length?s==="dynamic"&&a>0&&h.indexOf("$Number$")>0?Ve=eU(r,G,Ee):Ve=(p*_-G)/Ee:Ve=(e[ze].t-G)/Ee}else Ve=Ie+1;const Be=w+B.length+Ve;let Ke=w+B.length;for(;Ke<Be;)B.push({number:Ke,duration:Ee/_,time:G,timeline:I}),G+=Ee,Ke++}return B},tU=/\$([A-z]*)(?:(%0)([0-9]+)d)?\$/g,iU=r=>(e,s,a,h)=>{if(e==="$$")return"$";if(typeof r[s]>"u")return e;const p=""+r[s];return s==="RepresentationID"||(a?h=parseInt(h,10):h=1,p.length>=h)?p:`${new Array(h-p.length+1).join("0")}${p}`},fI=(r,e)=>r.replace(tU,iU(e)),sU=(r,e)=>!r.duration&&!e?[{number:r.startNumber||1,duration:r.sourceDuration,time:0,timeline:r.periodStart}]:r.duration?S1(r):dI(r,e),nU=(r,e)=>{const s={RepresentationID:r.id,Bandwidth:r.bandwidth||0},{initialization:a={sourceURL:"",range:""}}=r,h=H_({baseUrl:r.baseUrl,source:fI(a.sourceURL,s),range:a.range});return sU(r,e).map(_=>{s.Number=_.number,s.Time=_.time;const w=fI(r.media||"",s),I=r.timescale||1,B=r.presentationTimeOffset||0,G=r.periodStart+(_.time-B)/I;return{uri:w,timeline:_.timeline,duration:_.duration,resolvedUri:NT(r.baseUrl||"",w),map:h,number:_.number,presentationTime:G}})},rU=(r,e)=>{const{baseUrl:s,initialization:a={}}=r,h=H_({baseUrl:s,source:a.sourceURL,range:a.range}),p=H_({baseUrl:s,source:e.media,range:e.mediaRange});return p.map=h,p},aU=(r,e)=>{const{duration:s,segmentUrls:a=[],periodStart:h}=r;if(!s&&!e||s&&e)throw new Error(Dg.SEGMENT_TIME_UNSPECIFIED);const p=a.map(I=>rU(r,I));let _;return s&&(_=S1(r)),e&&(_=dI(r,e)),_.map((I,B)=>{if(p[B]){const G=p[B],se=r.timescale||1,pe=r.presentationTimeOffset||0;return G.timeline=I.timeline,G.duration=I.duration,G.number=I.number,G.presentationTime=h+(I.time-pe)/se,G}}).filter(I=>I)},oU=({attributes:r,segmentInfo:e})=>{let s,a;e.template?(a=nU,s=lr(r,e.template)):e.base?(a=oI,s=lr(r,e.base)):e.list&&(a=aU,s=lr(r,e.list));const h={attributes:r};if(!a)return h;const p=a(s,e.segmentTimeline);if(s.duration){const{duration:_,timescale:w=1}=s;s.duration=_/w}else p.length?s.duration=p.reduce((_,w)=>Math.max(_,Math.ceil(w.duration)),0):s.duration=0;return h.attributes=s,h.segments=p,e.base&&s.indexRange&&(h.sidx=p[0],h.segments=[]),h},lU=r=>r.map(oU),an=(r,e)=>rI(r.childNodes).filter(({tagName:s})=>s===e),V_=r=>r.textContent.trim(),uU=r=>parseFloat(r.split("/").reduce((e,s)=>e/s)),Ig=r=>{const w=/P(?:(\d*)Y)?(?:(\d*)M)?(?:(\d*)D)?(?:T(?:(\d*)H)?(?:(\d*)M)?(?:([\d.]*)S)?)?/.exec(r);if(!w)return 0;const[I,B,G,se,pe,Ee]=w.slice(1);return parseFloat(I||0)*31536e3+parseFloat(B||0)*2592e3+parseFloat(G||0)*86400+parseFloat(se||0)*3600+parseFloat(pe||0)*60+parseFloat(Ee||0)},hU=r=>(/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(r)&&(r+="Z"),Date.parse(r)),pI={mediaPresentationDuration(r){return Ig(r)},availabilityStartTime(r){return hU(r)/1e3},minimumUpdatePeriod(r){return Ig(r)},suggestedPresentationDelay(r){return Ig(r)},type(r){return r},timeShiftBufferDepth(r){return Ig(r)},start(r){return Ig(r)},width(r){return parseInt(r,10)},height(r){return parseInt(r,10)},bandwidth(r){return parseInt(r,10)},frameRate(r){return uU(r)},startNumber(r){return parseInt(r,10)},timescale(r){return parseInt(r,10)},presentationTimeOffset(r){return parseInt(r,10)},duration(r){const e=parseInt(r,10);return isNaN(e)?Ig(r):e},d(r){return parseInt(r,10)},t(r){return parseInt(r,10)},r(r){return parseInt(r,10)},presentationTime(r){return parseInt(r,10)},DEFAULT(r){return r}},Un=r=>r&&r.attributes?rI(r.attributes).reduce((e,s)=>{const a=pI[s.name]||pI.DEFAULT;return e[s.name]=a(s.value),e},{}):{},cU={"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b":"org.w3.clearkey","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":"com.widevine.alpha","urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb":"com.adobe.primetime","urn:mpeg:dash:mp4protection:2011":"mp4protection"},$T=(r,e)=>e.length?Pg(r.map(function(s){return e.map(function(a){const h=V_(a),p=NT(s.baseUrl,h),_=lr(Un(a),{baseUrl:p});return p!==h&&!_.serviceLocation&&s.serviceLocation&&(_.serviceLocation=s.serviceLocation),_})})):r,k1=r=>{const e=an(r,"SegmentTemplate")[0],s=an(r,"SegmentList")[0],a=s&&an(s,"SegmentURL").map(se=>lr({tag:"SegmentURL"},Un(se))),h=an(r,"SegmentBase")[0],p=s||e,_=p&&an(p,"SegmentTimeline")[0],w=s||h||e,I=w&&an(w,"Initialization")[0],B=e&&Un(e);B&&I?B.initialization=I&&Un(I):B&&B.initialization&&(B.initialization={sourceURL:B.initialization});const G={template:B,segmentTimeline:_&&an(_,"S").map(se=>Un(se)),list:s&&lr(Un(s),{segmentUrls:a,initialization:Un(I)}),base:h&&lr(Un(h),{initialization:Un(I)})};return Object.keys(G).forEach(se=>{G[se]||delete G[se]}),G},dU=(r,e,s)=>a=>{const h=an(a,"BaseURL"),p=$T(e,h),_=lr(r,Un(a)),w=k1(a);return p.map(I=>({segmentInfo:lr(s,w),attributes:lr(_,I)}))},fU=r=>r.reduce((e,s)=>{const a=Un(s);a.schemeIdUri&&(a.schemeIdUri=a.schemeIdUri.toLowerCase());const h=cU[a.schemeIdUri];if(h){e[h]={attributes:a};const p=an(s,"cenc:pssh")[0];if(p){const _=V_(p);e[h].pssh=_&&dD(_)}}return e},{}),pU=r=>{if(r.schemeIdUri==="urn:scte:dash:cc:cea-608:2015")return(typeof r.value!="string"?[]:r.value.split(";")).map(s=>{let a,h;return h=s,/^CC\d=/.test(s)?[a,h]=s.split("="):/^CC\d$/.test(s)&&(a=s),{channel:a,language:h}});if(r.schemeIdUri==="urn:scte:dash:cc:cea-708:2015")return(typeof r.value!="string"?[]:r.value.split(";")).map(s=>{const a={channel:void 0,language:void 0,aspectRatio:1,easyReader:0,"3D":0};if(/=/.test(s)){const[h,p=""]=s.split("=");a.channel=h,a.language=s,p.split(",").forEach(_=>{const[w,I]=_.split(":");w==="lang"?a.language=I:w==="er"?a.easyReader=Number(I):w==="war"?a.aspectRatio=Number(I):w==="3D"&&(a["3D"]=Number(I))})}else a.language=s;return a.channel&&(a.channel="SERVICE"+a.channel),a})},gU=r=>Pg(an(r.node,"EventStream").map(e=>{const s=Un(e),a=s.schemeIdUri;return an(e,"Event").map(h=>{const p=Un(h),_=p.presentationTime||0,w=s.timescale||1,I=p.duration||0,B=_/w+r.attributes.start;return{schemeIdUri:a,value:s.value,id:p.id,start:B,end:B+I/w,messageData:V_(h)||p.messageData,contentEncoding:s.contentEncoding,presentationTimeOffset:s.presentationTimeOffset||0}})})),mU=(r,e,s)=>a=>{const h=Un(a),p=$T(e,an(a,"BaseURL")),_=an(a,"Role")[0],w={role:Un(_)};let I=lr(r,h,w);const B=an(a,"Accessibility")[0],G=pU(Un(B));G&&(I=lr(I,{captionServices:G}));const se=an(a,"Label")[0];if(se&&se.childNodes.length){const Ve=se.childNodes[0].nodeValue.trim();I=lr(I,{label:Ve})}const pe=fU(an(a,"ContentProtection"));Object.keys(pe).length&&(I=lr(I,{contentProtection:pe}));const Ee=k1(a),Ie=an(a,"Representation"),ce=lr(s,Ee);return Pg(Ie.map(dU(I,p,ce)))},_U=(r,e)=>(s,a)=>{const h=$T(e,an(s.node,"BaseURL")),p=lr(r,{periodStart:s.attributes.start});typeof s.attributes.duration=="number"&&(p.periodDuration=s.attributes.duration);const _=an(s.node,"AdaptationSet"),w=k1(s.node);return Pg(_.map(mU(p,h,w)))},bU=(r,e)=>{if(r.length>1&&e({type:"warn",message:"The MPD manifest should contain no more than one ContentSteering tag"}),!r.length)return null;const s=lr({serverURL:V_(r[0])},Un(r[0]));return s.queryBeforeStart=s.queryBeforeStart==="true",s},yU=({attributes:r,priorPeriodAttributes:e,mpdType:s})=>typeof r.start=="number"?r.start:e&&typeof e.start=="number"&&typeof e.duration=="number"?e.start+e.duration:!e&&s==="static"?0:null,vU=(r,e={})=>{const{manifestUri:s="",NOW:a=Date.now(),clientOffset:h=0,eventHandler:p=function(){}}=e,_=an(r,"Period");if(!_.length)throw new Error(Dg.INVALID_NUMBER_OF_PERIOD);const w=an(r,"Location"),I=Un(r),B=$T([{baseUrl:s}],an(r,"BaseURL")),G=an(r,"ContentSteering");I.type=I.type||"static",I.sourceDuration=I.mediaPresentationDuration||0,I.NOW=a,I.clientOffset=h,w.length&&(I.locations=w.map(V_));const se=[];return _.forEach((pe,Ee)=>{const Ie=Un(pe),ce=se[Ee-1];Ie.start=yU({attributes:Ie,priorPeriodAttributes:ce?ce.attributes:null,mpdType:I.type}),se.push({node:pe,attributes:Ie})}),{locations:I.locations,contentSteeringInfo:bU(G,p),representationInfo:Pg(se.map(_U(I,B))),eventStream:Pg(se.map(gU))}},gI=r=>{if(r==="")throw new Error(Dg.DASH_EMPTY_MANIFEST);const e=new D8;let s,a;try{s=e.parseFromString(r,"application/xml"),a=s&&s.documentElement.tagName==="MPD"?s.documentElement:null}catch{}if(!a||a&&a.getElementsByTagName("parsererror").length>0)throw new Error(Dg.DASH_INVALID_XML);return a},wU=r=>{const e=an(r,"UTCTiming")[0];if(!e)return null;const s=Un(e);switch(s.schemeIdUri){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":s.method="HEAD";break;case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":s.method="GET";break;case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":s.method="DIRECT",s.value=Date.parse(s.value);break;case"urn:mpeg:dash:utc:http-ntp:2014":case"urn:mpeg:dash:utc:ntp:2014":case"urn:mpeg:dash:utc:sntp:2014":default:throw new Error(Dg.UNSUPPORTED_UTC_TIMING_SCHEME)}return s},TU=(r,e={})=>{const s=vU(gI(r),e),a=lU(s.representationInfo);return J8({dashPlaylists:a,locations:s.locations,contentSteering:s.contentSteeringInfo,sidxMapping:e.sidxMapping,previousManifest:e.previousManifest,eventStream:s.eventStream})},EU=r=>wU(gI(r));var SU=Math.pow(2,32),xU=function(r){var e=new DataView(r.buffer,r.byteOffset,r.byteLength),s;return e.getBigUint64?(s=e.getBigUint64(0),s<Number.MAX_SAFE_INTEGER?Number(s):s):e.getUint32(0)*SU+e.getUint32(4)},AU={getUint64:xU},mI=AU.getUint64,CU=function(r){var e=new DataView(r.buffer,r.byteOffset,r.byteLength),s={version:r[0],flags:new Uint8Array(r.subarray(1,4)),references:[],referenceId:e.getUint32(4),timescale:e.getUint32(8)},a=12;s.version===0?(s.earliestPresentationTime=e.getUint32(a),s.firstOffset=e.getUint32(a+4),a+=8):(s.earliestPresentationTime=mI(r.subarray(a)),s.firstOffset=mI(r.subarray(a+8)),a+=16),a+=2;var h=e.getUint16(a);for(a+=2;h>0;a+=12,h--)s.references.push({referenceType:(r[a]&128)>>>7,referencedSize:e.getUint32(a)&2147483647,subsegmentDuration:e.getUint32(a+4),startsWithSap:!!(r[a+8]&128),sapType:(r[a+8]&112)>>>4,sapDeltaTime:e.getUint32(a+8)&268435455});return s},kU=CU,PU=_i([73,68,51]),DU=function(e,s){s===void 0&&(s=0),e=_i(e);var a=e[s+5],h=e[s+6]<<21|e[s+7]<<14|e[s+8]<<7|e[s+9],p=(a&16)>>4;return p?h+20:h+10},$_=function r(e,s){return s===void 0&&(s=0),e=_i(e),e.length-s<10||!rn(e,PU,{offset:s})?s:(s+=DU(e,s),r(e,s))},_I=function(e){return typeof e=="string"?vD(e):e},IU=function(e){return Array.isArray(e)?e.map(function(s){return _I(s)}):[_I(e)]},LU=function r(e,s,a){a===void 0&&(a=!1),s=IU(s),e=_i(e);var h=[];if(!s.length)return h;for(var p=0;p<e.length;){var _=(e[p]<<24|e[p+1]<<16|e[p+2]<<8|e[p+3])>>>0,w=e.subarray(p+4,p+8);if(_===0)break;var I=p+_;if(I>e.length){if(a)break;I=e.length}var B=e.subarray(p+8,I);rn(w,s[0])&&(s.length===1?h.push(B):h.push.apply(h,r(B,s.slice(1),a))),p=I}return h},zT={EBML:_i([26,69,223,163]),DocType:_i([66,130]),Segment:_i([24,83,128,103]),SegmentInfo:_i([21,73,169,102]),Tracks:_i([22,84,174,107]),Track:_i([174]),TrackNumber:_i([215]),DefaultDuration:_i([35,227,131]),TrackEntry:_i([174]),TrackType:_i([131]),FlagDefault:_i([136]),CodecID:_i([134]),CodecPrivate:_i([99,162]),VideoTrack:_i([224]),AudioTrack:_i([225]),Cluster:_i([31,67,182,117]),Timestamp:_i([231]),TimestampScale:_i([42,215,177]),BlockGroup:_i([160]),BlockDuration:_i([155]),Block:_i([161]),SimpleBlock:_i([163])},P1=[128,64,32,16,8,4,2,1],NU=function(e){for(var s=1,a=0;a<P1.length&&!(e&P1[a]);a++)s++;return s},WT=function(e,s,a,h){a===void 0&&(a=!0),h===void 0&&(h=!1);var p=NU(e[s]),_=e.subarray(s,s+p);return a&&(_=Array.prototype.slice.call(e,s,s+p),_[0]^=P1[p-1]),{length:p,value:z4(_,{signed:h}),bytes:_}},bI=function r(e){return typeof e=="string"?e.match(/.{1,2}/g).map(function(s){return r(s)}):typeof e=="number"?W4(e):e},RU=function(e){return Array.isArray(e)?e.map(function(s){return bI(s)}):[bI(e)]},MU=function r(e,s,a){if(a>=s.length)return s.length;var h=WT(s,a,!1);if(rn(e.bytes,h.bytes))return a;var p=WT(s,a+h.length);return r(e,s,a+p.length+p.value+h.length)},yI=function r(e,s){s=RU(s),e=_i(e);var a=[];if(!s.length)return a;for(var h=0;h<e.length;){var p=WT(e,h,!1),_=WT(e,h+p.length),w=h+p.length+_.length;_.value===127&&(_.value=MU(p,e,w),_.value!==e.length&&(_.value-=w));var I=w+_.value>e.length?e.length:w+_.value,B=e.subarray(w,I);rn(s[0],p.bytes)&&(s.length===1?a.push(B):a=a.concat(r(B,s.slice(1))));var G=p.length+_.length+B.length;h+=G}return a},OU=_i([0,0,0,1]),FU=_i([0,0,1]),BU=_i([0,0,3]),UU=function(e){for(var s=[],a=1;a<e.length-2;)rn(e.subarray(a,a+3),BU)&&(s.push(a+2),a++),a++;if(s.length===0)return e;var h=e.length-s.length,p=new Uint8Array(h),_=0;for(a=0;a<h;_++,a++)_===s[0]&&(_++,s.shift()),p[a]=e[_];return p},vI=function(e,s,a,h){e=_i(e),a=[].concat(a);for(var p=0,_,w=0;p<e.length&&(w<h||_);){var I=void 0;if(rn(e.subarray(p),OU)?I=4:rn(e.subarray(p),FU)&&(I=3),!I){p++;continue}if(w++,_)return UU(e.subarray(_,p));var B=void 0;s==="h264"?B=e[p+I]&31:s==="h265"&&(B=e[p+I]>>1&63),a.indexOf(B)!==-1&&(_=p+I),p+=I+(s==="h264"?1:2)}return e.subarray(0,0)},jU=function(e,s,a){return vI(e,"h264",s,a)},HU=function(e,s,a){return vI(e,"h265",s,a)},Kr={webm:_i([119,101,98,109]),matroska:_i([109,97,116,114,111,115,107,97]),flac:_i([102,76,97,67]),ogg:_i([79,103,103,83]),ac3:_i([11,119]),riff:_i([82,73,70,70]),avi:_i([65,86,73]),wav:_i([87,65,86,69]),"3gp":_i([102,116,121,112,51,103]),mp4:_i([102,116,121,112]),fmp4:_i([115,116,121,112]),mov:_i([102,116,121,112,113,116]),moov:_i([109,111,111,118]),moof:_i([109,111,111,102])},Lg={aac:function(e){var s=$_(e);return rn(e,[255,16],{offset:s,mask:[255,22]})},mp3:function(e){var s=$_(e);return rn(e,[255,2],{offset:s,mask:[255,6]})},webm:function(e){var s=yI(e,[zT.EBML,zT.DocType])[0];return rn(s,Kr.webm)},mkv:function(e){var s=yI(e,[zT.EBML,zT.DocType])[0];return rn(s,Kr.matroska)},mp4:function(e){if(Lg["3gp"](e)||Lg.mov(e))return!1;if(rn(e,Kr.mp4,{offset:4})||rn(e,Kr.fmp4,{offset:4})||rn(e,Kr.moof,{offset:4})||rn(e,Kr.moov,{offset:4}))return!0},mov:function(e){return rn(e,Kr.mov,{offset:4})},"3gp":function(e){return rn(e,Kr["3gp"],{offset:4})},ac3:function(e){var s=$_(e);return rn(e,Kr.ac3,{offset:s})},ts:function(e){if(e.length<189&&e.length>=1)return e[0]===71;for(var s=0;s+188<e.length&&s<188;){if(e[s]===71&&e[s+188]===71)return!0;s+=1}return!1},flac:function(e){var s=$_(e);return rn(e,Kr.flac,{offset:s})},ogg:function(e){return rn(e,Kr.ogg)},avi:function(e){return rn(e,Kr.riff)&&rn(e,Kr.avi,{offset:8})},wav:function(e){return rn(e,Kr.riff)&&rn(e,Kr.wav,{offset:8})},h264:function(e){return jU(e,7,3).length},h265:function(e){return HU(e,[32,33],3).length}},D1=Object.keys(Lg).filter(function(r){return r!=="ts"&&r!=="h264"&&r!=="h265"}).concat(["ts","h264","h265"]);D1.forEach(function(r){var e=Lg[r];Lg[r]=function(s){return e(_i(s))}});var VU=Lg,I1=function(e){e=_i(e);for(var s=0;s<D1.length;s++){var a=D1[s];if(VU[a](e))return a}return""},$U=function(e){return LU(e,["moof"]).length>0},zU=9e4,WU={ONE_SECOND_IN_TS:zU},$d=WU.ONE_SECOND_IN_TS;/*! @name @videojs/http-streaming @version 3.17.0 @license Apache-2.0 */const ma=NT,qT=(r,e)=>e&&e.responseURL&&r!==e.responseURL?e.responseURL:r,mo=r=>Ye.log.debug?Ye.log.debug.bind(Ye,"VHS:",`${r} >`):function(){};function As(...r){const e=Ye.obj||Ye;return(e.merge||e.mergeOptions).apply(e,r)}function ur(...r){const e=Ye.time||Ye;return(e.createTimeRanges||e.createTimeRanges).apply(e,r)}function qU(r){if(r.length===0)return"Buffered Ranges are empty";let e=`Buffered Ranges: 
`;for(let s=0;s<r.length;s++){const a=r.start(s),h=r.end(s);e+=`${a} --> ${h}. Duration (${h-a})
`}return e}const kl=1/30,Pl=kl*3,wI=function(r,e){const s=[];let a;if(r&&r.length)for(a=0;a<r.length;a++)e(r.start(a),r.end(a))&&s.push([r.start(a),r.end(a)]);return ur(s)},Ng=function(r,e){return wI(r,function(s,a){return s-Pl<=e&&a+Pl>=e})},GT=function(r,e){return wI(r,function(s){return s-kl>=e})},GU=function(r){if(r.length<2)return ur();const e=[];for(let s=1;s<r.length;s++){const a=r.end(s-1),h=r.start(s);e.push([a,h])}return ur(e)},XU=function(r,e){let s=null,a=null,h=0;const p=[],_=[];if(!r||!r.length||!e||!e.length)return ur();let w=r.length;for(;w--;)p.push({time:r.start(w),type:"start"}),p.push({time:r.end(w),type:"end"});for(w=e.length;w--;)p.push({time:e.start(w),type:"start"}),p.push({time:e.end(w),type:"end"});for(p.sort(function(I,B){return I.time-B.time}),w=0;w<p.length;w++)p[w].type==="start"?(h++,h===2&&(s=p[w].time)):p[w].type==="end"&&(h--,h===1&&(a=p[w].time)),s!==null&&a!==null&&(_.push([s,a]),s=null,a=null);return ur(_)},TI=r=>{const e=[];if(!r||!r.length)return"";for(let s=0;s<r.length;s++)e.push(r.start(s)+" => "+r.end(s));return e.join(", ")},KU=function(r,e,s=1){return((r.length?r.end(r.length-1):0)-e)/s},zd=r=>{const e=[];for(let s=0;s<r.length;s++)e.push({start:r.start(s),end:r.end(s)});return e},YU=function(r,e){if(r===e)return!1;if(!r&&e||!e&&r||r.length!==e.length)return!0;for(let s=0;s<r.length;s++)if(r.start(s)!==e.start(s)||r.end(s)!==e.end(s))return!0;return!1},L1=function(r){if(!(!r||!r.length||!r.end))return r.end(r.length-1)},N1=function(r,e){let s=0;if(!r||!r.length)return s;for(let a=0;a<r.length;a++){const h=r.start(a),p=r.end(a);if(!(e>p)){if(e>h&&e<=p){s+=p-e;continue}s+=p-h}}return s},R1=(r,e)=>{if(!e.preload)return e.duration;let s=0;return(e.parts||[]).forEach(function(a){s+=a.duration}),(e.preloadHints||[]).forEach(function(a){a.type==="PART"&&(s+=r.partTargetDuration)}),s},M1=r=>(r.segments||[]).reduce((e,s,a)=>(s.parts?s.parts.forEach(function(h,p){e.push({duration:h.duration,segmentIndex:a,partIndex:p,part:h,segment:s})}):e.push({duration:s.duration,segmentIndex:a,partIndex:null,segment:s,part:null}),e),[]),EI=r=>{const e=r.segments&&r.segments.length&&r.segments[r.segments.length-1];return e&&e.parts||[]},SI=({preloadSegment:r})=>{if(!r)return;const{parts:e,preloadHints:s}=r;let a=(s||[]).reduce((h,p)=>h+(p.type==="PART"?1:0),0);return a+=e&&e.length?e.length:0,a},xI=(r,e)=>{if(e.endList)return 0;if(r&&r.suggestedPresentationDelay)return r.suggestedPresentationDelay;const s=EI(e).length>0;return s&&e.serverControl&&e.serverControl.partHoldBack?e.serverControl.partHoldBack:s&&e.partTargetDuration?e.partTargetDuration*3:e.serverControl&&e.serverControl.holdBack?e.serverControl.holdBack:e.targetDuration?e.targetDuration*3:0},ZU=function(r,e){let s=0,a=e-r.mediaSequence,h=r.segments[a];if(h){if(typeof h.start<"u")return{result:h.start,precise:!0};if(typeof h.end<"u")return{result:h.end-h.duration,precise:!0}}for(;a--;){if(h=r.segments[a],typeof h.end<"u")return{result:s+h.end,precise:!0};if(s+=R1(r,h),typeof h.start<"u")return{result:s+h.start,precise:!0}}return{result:s,precise:!1}},QU=function(r,e){let s=0,a,h=e-r.mediaSequence;for(;h<r.segments.length;h++){if(a=r.segments[h],typeof a.start<"u")return{result:a.start-s,precise:!0};if(s+=R1(r,a),typeof a.end<"u")return{result:a.end-s,precise:!0}}return{result:-1,precise:!1}},AI=function(r,e,s){if(typeof e>"u"&&(e=r.mediaSequence+r.segments.length),e<r.mediaSequence)return 0;const a=ZU(r,e);if(a.precise)return a.result;const h=QU(r,e);return h.precise?h.result:a.result+s},CI=function(r,e,s){if(!r)return 0;if(typeof s!="number"&&(s=0),typeof e>"u"){if(r.totalDuration)return r.totalDuration;if(!r.endList)return window.Infinity}return AI(r,e,s)},z_=function({defaultDuration:r,durationList:e,startIndex:s,endIndex:a}){let h=0;if(s>a&&([s,a]=[a,s]),s<0){for(let p=s;p<Math.min(0,a);p++)h+=r;s=0}for(let p=s;p<a;p++)h+=e[p].duration;return h},kI=function(r,e,s,a){if(!r||!r.segments)return null;if(r.endList)return CI(r);if(e===null)return null;e=e||0;let h=AI(r,r.mediaSequence+r.segments.length,e);return s&&(a=typeof a=="number"?a:xI(null,r),h-=a),Math.max(0,h)},JU=function(r,e,s){const h=e||0;let p=kI(r,e,!0,s);return p===null?ur():(p<h&&(p=h),ur(h,p))},e5=function({playlist:r,currentTime:e,startingSegmentIndex:s,startingPartIndex:a,startTime:h,exactManifestTimings:p}){let _=e-h;const w=M1(r);let I=0;for(let B=0;B<w.length;B++){const G=w[B];if(s===G.segmentIndex&&!(typeof a=="number"&&typeof G.partIndex=="number"&&a!==G.partIndex)){I=B;break}}if(_<0){if(I>0)for(let B=I-1;B>=0;B--){const G=w[B];if(_+=G.duration,p){if(_<0)continue}else if(_+kl<=0)continue;return{partIndex:G.partIndex,segmentIndex:G.segmentIndex,startTime:h-z_({defaultDuration:r.targetDuration,durationList:w,startIndex:I,endIndex:B})}}return{partIndex:w[0]&&w[0].partIndex||null,segmentIndex:w[0]&&w[0].segmentIndex||0,startTime:e}}if(I<0){for(let B=I;B<0;B++)if(_-=r.targetDuration,_<0)return{partIndex:w[0]&&w[0].partIndex||null,segmentIndex:w[0]&&w[0].segmentIndex||0,startTime:e};I=0}for(let B=I;B<w.length;B++){const G=w[B];_-=G.duration;const se=G.duration>kl,pe=_===0,Ee=se&&_+kl>=0;if(!((pe||Ee)&&B!==w.length-1)){if(p){if(_>0)continue}else if(_-kl>=0)continue;return{partIndex:G.partIndex,segmentIndex:G.segmentIndex,startTime:h+z_({defaultDuration:r.targetDuration,durationList:w,startIndex:I,endIndex:B})}}}return{segmentIndex:w[w.length-1].segmentIndex,partIndex:w[w.length-1].partIndex,startTime:e}},PI=function(r){return r.excludeUntil&&r.excludeUntil>Date.now()},O1=function(r){return r.excludeUntil&&r.excludeUntil===1/0},XT=function(r){const e=PI(r);return!r.disabled&&!e},t5=function(r){return r.disabled},i5=function(r){for(let e=0;e<r.segments.length;e++)if(r.segments[e].key)return!0;return!1},DI=function(r,e){return e.attributes&&e.attributes[r]},s5=function(r,e,s,a=0){return DI("BANDWIDTH",s)?(r*s.attributes.BANDWIDTH-a*8)/e:NaN},F1=(r,e)=>{if(r.playlists.length===1)return!0;const s=e.attributes.BANDWIDTH||Number.MAX_VALUE;return r.playlists.filter(a=>XT(a)?(a.attributes.BANDWIDTH||0)<s:!1).length===0},B1=(r,e)=>!r&&!e||!r&&e||r&&!e?!1:!!(r===e||r.id&&e.id&&r.id===e.id||r.resolvedUri&&e.resolvedUri&&r.resolvedUri===e.resolvedUri||r.uri&&e.uri&&r.uri===e.uri),II=function(r,e){const s=r&&r.mediaGroups&&r.mediaGroups.AUDIO||{};let a=!1;for(const h in s){for(const p in s[h])if(a=e(s[h][p]),a)break;if(a)break}return!!a},W_=r=>{if(!r||!r.playlists||!r.playlists.length)return II(r,s=>s.playlists&&s.playlists.length||s.uri);for(let e=0;e<r.playlists.length;e++){const s=r.playlists[e],a=s.attributes&&s.attributes.CODECS;if(!(a&&a.split(",").every(p=>mD(p))||II(r,p=>B1(s,p))))return!1}return!0};var _a={liveEdgeDelay:xI,duration:CI,seekable:JU,getMediaInfoForTime:e5,isEnabled:XT,isDisabled:t5,isExcluded:PI,isIncompatible:O1,playlistEnd:kI,isAes:i5,hasAttribute:DI,estimateSegmentRequestTime:s5,isLowestEnabledRendition:F1,isAudioOnly:W_,playlistMatch:B1,segmentDurationWithParts:R1};const{log:LI}=Ye,Rg=(r,e)=>`${r}-${e}`,NI=(r,e,s)=>`placeholder-uri-${r}-${e}-${s}`,n5=({onwarn:r,oninfo:e,manifestString:s,customTagParsers:a=[],customTagMappers:h=[],llhls:p})=>{const _=new R4;r&&_.on("warn",r),e&&_.on("info",e),a.forEach(B=>_.addParser(B)),h.forEach(B=>_.addTagMapper(B)),_.push(s),_.end();const w=_.manifest;if(p||(["preloadSegment","skip","serverControl","renditionReports","partInf","partTargetDuration"].forEach(function(B){w.hasOwnProperty(B)&&delete w[B]}),w.segments&&w.segments.forEach(function(B){["parts","preloadHints"].forEach(function(G){B.hasOwnProperty(G)&&delete B[G]})})),!w.targetDuration){let B=10;w.segments&&w.segments.length&&(B=w.segments.reduce((G,se)=>Math.max(G,se.duration),0)),r&&r({message:`manifest has no targetDuration defaulting to ${B}`}),w.targetDuration=B}const I=EI(w);if(I.length&&!w.partTargetDuration){const B=I.reduce((G,se)=>Math.max(G,se.duration),0);r&&(r({message:`manifest has no partTargetDuration defaulting to ${B}`}),LI.error("LL-HLS manifest has parts but lacks required #EXT-X-PART-INF:PART-TARGET value. See https://datatracker.ietf.org/doc/html/draft-pantos-hls-rfc8216bis-09#section-4.4.3.7. Playback is not guaranteed.")),w.partTargetDuration=B}return w},Mg=(r,e)=>{r.mediaGroups&&["AUDIO","SUBTITLES"].forEach(s=>{if(r.mediaGroups[s])for(const a in r.mediaGroups[s])for(const h in r.mediaGroups[s][a]){const p=r.mediaGroups[s][a][h];e(p,s,a,h)}})},RI=({playlist:r,uri:e,id:s})=>{r.id=s,r.playlistErrors_=0,e&&(r.uri=e),r.attributes=r.attributes||{}},r5=r=>{let e=r.playlists.length;for(;e--;){const s=r.playlists[e];RI({playlist:s,id:Rg(e,s.uri)}),s.resolvedUri=ma(r.uri,s.uri),r.playlists[s.id]=s,r.playlists[s.uri]=s,s.attributes.BANDWIDTH||LI.warn("Invalid playlist STREAM-INF detected. Missing BANDWIDTH attribute.")}},a5=r=>{Mg(r,e=>{e.uri&&(e.resolvedUri=ma(r.uri,e.uri))})},o5=(r,e)=>{const s=Rg(0,e),a={mediaGroups:{AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},uri:window.location.href,resolvedUri:window.location.href,playlists:[{uri:e,id:s,resolvedUri:e,attributes:{}}]};return a.playlists[s]=a.playlists[0],a.playlists[e]=a.playlists[0],a},MI=(r,e,s=NI)=>{r.uri=e;for(let h=0;h<r.playlists.length;h++)if(!r.playlists[h].uri){const p=`placeholder-uri-${h}`;r.playlists[h].uri=p}const a=W_(r);Mg(r,(h,p,_,w)=>{if(!h.playlists||!h.playlists.length){if(a&&p==="AUDIO"&&!h.uri)for(let I=0;I<r.playlists.length;I++){const B=r.playlists[I];if(B.attributes&&B.attributes.AUDIO&&B.attributes.AUDIO===_)return}h.playlists=[Z({},h)]}h.playlists.forEach(function(I,B){const G=s(p,_,w,I),se=Rg(B,G);I.uri?I.resolvedUri=I.resolvedUri||ma(r.uri,I.uri):(I.uri=B===0?G:se,I.resolvedUri=I.uri),I.id=I.id||se,I.attributes=I.attributes||{},r.playlists[I.id]=I,r.playlists[I.uri]=I})}),r5(r),a5(r)};class OI{constructor(){this.offset_=null,this.pendingDateRanges_=new Map,this.processedDateRanges_=new Map}setOffset(e=[]){if(this.offset_!==null||!e.length)return;const[s]=e;s.programDateTime!==void 0&&(this.offset_=s.programDateTime/1e3)}setPendingDateRanges(e=[]){if(!e.length)return;const[s]=e,a=s.startDate.getTime();this.trimProcessedDateRanges_(a),this.pendingDateRanges_=e.reduce((h,p)=>(h.set(p.id,p),h),new Map)}processDateRange(e){this.pendingDateRanges_.delete(e.id),this.processedDateRanges_.set(e.id,e)}getDateRangesToProcess(){if(this.offset_===null)return[];const e={},s=[];this.pendingDateRanges_.forEach((a,h)=>{if(!this.processedDateRanges_.has(h)&&(a.startTime=a.startDate.getTime()/1e3-this.offset_,a.processDateRange=()=>this.processDateRange(a),s.push(a),!!a.class))if(e[a.class]){const p=e[a.class].push(a);a.classListIndex=p-1}else e[a.class]=[a],a.classListIndex=0});for(const a of s){const h=e[a.class]||[];a.endDate?a.endTime=a.endDate.getTime()/1e3-this.offset_:a.endOnNext&&h[a.classListIndex+1]?a.endTime=h[a.classListIndex+1].startTime:a.duration?a.endTime=a.startTime+a.duration:a.plannedDuration?a.endTime=a.startTime+a.plannedDuration:a.endTime=a.startTime}return s}trimProcessedDateRanges_(e){new Map(this.processedDateRanges_).forEach((a,h)=>{a.startDate.getTime()<e&&this.processedDateRanges_.delete(h)})}}const FI=22,Wd=({requestType:r,request:e,error:s,parseFailure:a})=>{const h=e.status<200||e.status>299,p=e.status>=400&&e.status<=499,_={uri:e.uri,requestType:r},w=h&&!p||a;if(s&&p)_.error=Z({},s),_.errorType=Ye.Error.NetworkRequestFailed;else if(e.aborted)_.errorType=Ye.Error.NetworkRequestAborted;else if(e.timedout)_.erroType=Ye.Error.NetworkRequestTimeout;else if(w){const I=a?Ye.Error.NetworkBodyParserFailed:Ye.Error.NetworkBadStatus;_.errorType=I,_.status=e.status,_.headers=e.headers}return _},l5=mo("CodecUtils"),BI=function(r){const e=r.attributes||{};if(e.CODECS)return xl(e.CODECS)},UI=(r,e)=>{const s=e.attributes||{};return r&&r.mediaGroups&&r.mediaGroups.AUDIO&&s.AUDIO&&r.mediaGroups.AUDIO[s.AUDIO]},u5=(r,e)=>{if(!UI(r,e))return!0;const s=e.attributes||{},a=r.mediaGroups.AUDIO[s.AUDIO];for(const h in a)if(!a[h].uri&&!a[h].playlists)return!0;return!1},q_=function(r){const e={};return r.forEach(({mediaType:s,type:a,details:h})=>{e[s]=e[s]||[],e[s].push(gD(`${a}${h}`))}),Object.keys(e).forEach(function(s){if(e[s].length>1){l5(`multiple ${s} codecs found as attributes: ${e[s].join(", ")}. Setting playlist codecs to null so that we wait for mux.js to probe segments for real codecs.`),e[s]=null;return}e[s]=e[s][0]}),e},jI=function(r){let e=0;return r.audio&&e++,r.video&&e++,e},G_=function(r,e){const s=e.attributes||{},a=q_(BI(e)||[]);if(UI(r,e)&&!a.audio&&!u5(r,e)){const h=q_(O4(r,s.AUDIO)||[]);h.audio&&(a.audio=h.audio)}return a},{EventTarget:h5}=Ye,c5=(r,e)=>{if(e.endList||!e.serverControl)return r;const s={};if(e.serverControl.canBlockReload){const{preloadSegment:a}=e;let h=e.mediaSequence+e.segments.length;if(a){const p=a.parts||[],_=SI(e)-1;_>-1&&_!==p.length-1&&(s._HLS_part=_),(_>-1||p.length)&&h--}s._HLS_msn=h}if(e.serverControl&&e.serverControl.canSkipUntil&&(s._HLS_skip=e.serverControl.canSkipDateranges?"v2":"YES"),Object.keys(s).length){const a=new window.URL(r);["_HLS_skip","_HLS_msn","_HLS_part"].forEach(function(h){s.hasOwnProperty(h)&&a.searchParams.set(h,s[h])}),r=a.toString()}return r},d5=(r,e)=>{if(!r)return e;const s=As(r,e);if(r.preloadHints&&!e.preloadHints&&delete s.preloadHints,r.parts&&!e.parts)delete s.parts;else if(r.parts&&e.parts)for(let a=0;a<e.parts.length;a++)r.parts&&r.parts[a]&&(s.parts[a]=As(r.parts[a],e.parts[a]));return!r.skipped&&e.skipped&&(s.skipped=!1),r.preload&&!e.preload&&(s.preload=!1),s},f5=(r,e,s)=>{const a=r.slice(),h=e.slice();s=s||0;const p=[];let _;for(let w=0;w<h.length;w++){const I=a[w+s],B=h[w];I?(_=I.map||_,p.push(d5(I,B))):(_&&!B.map&&(B.map=_),p.push(B))}return p},HI=(r,e)=>{!r.resolvedUri&&r.uri&&(r.resolvedUri=ma(e,r.uri)),r.key&&!r.key.resolvedUri&&(r.key.resolvedUri=ma(e,r.key.uri)),r.map&&!r.map.resolvedUri&&(r.map.resolvedUri=ma(e,r.map.uri)),r.map&&r.map.key&&!r.map.key.resolvedUri&&(r.map.key.resolvedUri=ma(e,r.map.key.uri)),r.parts&&r.parts.length&&r.parts.forEach(s=>{s.resolvedUri||(s.resolvedUri=ma(e,s.uri))}),r.preloadHints&&r.preloadHints.length&&r.preloadHints.forEach(s=>{s.resolvedUri||(s.resolvedUri=ma(e,s.uri))})},VI=function(r){const e=r.segments||[],s=r.preloadSegment;if(s&&s.parts&&s.parts.length){if(s.preloadHints){for(let a=0;a<s.preloadHints.length;a++)if(s.preloadHints[a].type==="MAP")return e}s.duration=r.targetDuration,s.preload=!0,e.push(s)}return e},$I=(r,e)=>r===e||r.segments&&e.segments&&r.segments.length===e.segments.length&&r.endList===e.endList&&r.mediaSequence===e.mediaSequence&&r.preloadSegment===e.preloadSegment,U1=(r,e,s=$I)=>{const a=As(r,{}),h=a.playlists[e.id];if(!h||s(h,e))return null;e.segments=VI(e);const p=As(h,e);if(p.preloadSegment&&!e.preloadSegment&&delete p.preloadSegment,h.segments){if(e.skip){e.segments=e.segments||[];for(let _=0;_<e.skip.skippedSegments;_++)e.segments.unshift({skipped:!0})}p.segments=f5(h.segments,e.segments,e.mediaSequence-h.mediaSequence)}p.segments.forEach(_=>{HI(_,p.resolvedUri)});for(let _=0;_<a.playlists.length;_++)a.playlists[_].id===e.id&&(a.playlists[_]=p);return a.playlists[e.id]=p,a.playlists[e.uri]=p,Mg(r,(_,w,I,B)=>{if(_.playlists)for(let G=0;G<_.playlists.length;G++)e.id===_.playlists[G].id&&(_.playlists[G]=p)}),a},j1=(r,e)=>{const s=r.segments||[],a=s[s.length-1],h=a&&a.parts&&a.parts[a.parts.length-1],p=h&&h.duration||a&&a.duration;return e&&p?p*1e3:(r.partTargetDuration||r.targetDuration||10)*500},zI=(r,e,s)=>{if(!r)return;const a=[];return r.forEach(h=>{if(!h.attributes)return;const{BANDWIDTH:p,RESOLUTION:_,CODECS:w}=h.attributes;a.push({id:h.id,bandwidth:p,resolution:_,codecs:w})}),{type:e,isLive:s,renditions:a}};class Og extends h5{constructor(e,s,a={}){if(super(),!e)throw new Error("A non-empty playlist URL or object is required");this.logger_=mo("PlaylistLoader");const{withCredentials:h=!1}=a;this.src=e,this.vhs_=s,this.withCredentials=h,this.addDateRangesToTextTrack_=a.addDateRangesToTextTrack;const p=s.options_;this.customTagParsers=p&&p.customTagParsers||[],this.customTagMappers=p&&p.customTagMappers||[],this.llhls=p&&p.llhls,this.dateRangesStorage_=new OI,this.state="HAVE_NOTHING",this.handleMediaupdatetimeout_=this.handleMediaupdatetimeout_.bind(this),this.on("mediaupdatetimeout",this.handleMediaupdatetimeout_),this.on("loadedplaylist",this.handleLoadedPlaylist_.bind(this))}handleLoadedPlaylist_(){const e=this.media();if(!e)return;this.dateRangesStorage_.setOffset(e.segments),this.dateRangesStorage_.setPendingDateRanges(e.dateRanges);const s=this.dateRangesStorage_.getDateRangesToProcess();!s.length||!this.addDateRangesToTextTrack_||this.addDateRangesToTextTrack_(s)}handleMediaupdatetimeout_(){if(this.state!=="HAVE_METADATA")return;const e=this.media();let s=ma(this.main.uri,e.uri);this.llhls&&(s=c5(s,e)),this.state="HAVE_CURRENT_METADATA",this.request=this.vhs_.xhr({uri:s,withCredentials:this.withCredentials,requestType:"hls-playlist"},(a,h)=>{if(this.request){if(a)return this.playlistRequestError(this.request,this.media(),"HAVE_METADATA");this.haveMetadata({playlistString:this.request.responseText,url:this.media().uri,id:this.media().id})}})}playlistRequestError(e,s,a){const{uri:h,id:p}=s;this.request=null,a&&(this.state=a),this.error={playlist:this.main.playlists[p],status:e.status,message:`HLS playlist request error at URL: ${h}.`,responseText:e.responseText,code:e.status>=500?4:2,metadata:Wd({requestType:e.requestType,request:e,error:e.error})},this.trigger("error")}parseManifest_({url:e,manifestString:s}){try{const a=n5({onwarn:({message:h})=>this.logger_(`m3u8-parser warn for ${e}: ${h}`),oninfo:({message:h})=>this.logger_(`m3u8-parser info for ${e}: ${h}`),manifestString:s,customTagParsers:this.customTagParsers,customTagMappers:this.customTagMappers,llhls:this.llhls});return!a.playlists||!a.playlists.length||this.excludeAudioOnlyVariants(a.playlists),a}catch(a){this.error=a,this.error.metadata={errorType:Ye.Error.StreamingHlsPlaylistParserError,error:a}}}excludeAudioOnlyVariants(e){const s=a=>{const h=a.attributes||{},{width:p,height:_}=h.RESOLUTION||{};if(p&&_)return!0;const w=BI(a)||[];return!!q_(w).video};e.some(s)&&e.forEach(a=>{s(a)||(a.excludeUntil=1/0)})}haveMetadata({playlistString:e,playlistObject:s,url:a,id:h}){this.request=null,this.state="HAVE_METADATA";const p={playlistInfo:{type:"media",uri:a}};this.trigger({type:"playlistparsestart",metadata:p});const _=s||this.parseManifest_({url:a,manifestString:e});_.lastRequest=Date.now(),RI({playlist:_,uri:a,id:h});const w=U1(this.main,_);this.targetDuration=_.partTargetDuration||_.targetDuration,this.pendingMedia_=null,w?(this.main=w,this.media_=this.main.playlists[h]):this.trigger("playlistunchanged"),this.updateMediaUpdateTimeout_(j1(this.media(),!!w)),p.parsedPlaylist=zI(this.main.playlists,p.playlistInfo.type,!this.media_.endList),this.trigger({type:"playlistparsecomplete",metadata:p}),this.trigger("loadedplaylist")}dispose(){this.trigger("dispose"),this.stopRequest(),window.clearTimeout(this.mediaUpdateTimeout),window.clearTimeout(this.finalRenditionTimeout),this.dateRangesStorage_=new OI,this.off()}stopRequest(){if(this.request){const e=this.request;this.request=null,e.onreadystatechange=null,e.abort()}}media(e,s){if(!e)return this.media_;if(this.state==="HAVE_NOTHING")throw new Error("Cannot switch media playlist from "+this.state);if(typeof e=="string"){if(!this.main.playlists[e])throw new Error("Unknown playlist URI: "+e);e=this.main.playlists[e]}if(window.clearTimeout(this.finalRenditionTimeout),s){const w=(e.partTargetDuration||e.targetDuration)/2*1e3||5e3;this.finalRenditionTimeout=window.setTimeout(this.media.bind(this,e,!1),w);return}const a=this.state,h=!this.media_||e.id!==this.media_.id,p=this.main.playlists[e.id];if(p&&p.endList||e.endList&&e.segments.length){this.request&&(this.request.onreadystatechange=null,this.request.abort(),this.request=null),this.state="HAVE_METADATA",this.media_=e,h&&(this.trigger("mediachanging"),a==="HAVE_MAIN_MANIFEST"?this.trigger("loadedmetadata"):this.trigger("mediachange"));return}if(this.updateMediaUpdateTimeout_(j1(e,!0)),!h)return;if(this.state="SWITCHING_MEDIA",this.request){if(e.resolvedUri===this.request.url)return;this.request.onreadystatechange=null,this.request.abort(),this.request=null}this.media_&&this.trigger("mediachanging"),this.pendingMedia_=e;const _={playlistInfo:{type:"media",uri:e.uri}};this.trigger({type:"playlistrequeststart",metadata:_}),this.request=this.vhs_.xhr({uri:e.resolvedUri,withCredentials:this.withCredentials,requestType:"hls-playlist"},(w,I)=>{if(this.request){if(e.lastRequest=Date.now(),e.resolvedUri=qT(e.resolvedUri,I),w)return this.playlistRequestError(this.request,e,a);this.trigger({type:"playlistrequestcomplete",metadata:_}),this.haveMetadata({playlistString:I.responseText,url:e.uri,id:e.id}),a==="HAVE_MAIN_MANIFEST"?this.trigger("loadedmetadata"):this.trigger("mediachange")}})}pause(){this.mediaUpdateTimeout&&(window.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null),this.stopRequest(),this.state==="HAVE_NOTHING"&&(this.started=!1),this.state==="SWITCHING_MEDIA"?this.media_?this.state="HAVE_METADATA":this.state="HAVE_MAIN_MANIFEST":this.state==="HAVE_CURRENT_METADATA"&&(this.state="HAVE_METADATA")}load(e){this.mediaUpdateTimeout&&(window.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null);const s=this.media();if(e){const a=s?(s.partTargetDuration||s.targetDuration)/2*1e3:5e3;this.mediaUpdateTimeout=window.setTimeout(()=>{this.mediaUpdateTimeout=null,this.load()},a);return}if(!this.started){this.start();return}s&&!s.endList?this.trigger("mediaupdatetimeout"):this.trigger("loadedplaylist")}updateMediaUpdateTimeout_(e){this.mediaUpdateTimeout&&(window.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null),!(!this.media()||this.media().endList)&&(this.mediaUpdateTimeout=window.setTimeout(()=>{this.mediaUpdateTimeout=null,this.trigger("mediaupdatetimeout"),this.updateMediaUpdateTimeout_(e)},e))}start(){if(this.started=!0,typeof this.src=="object"){this.src.uri||(this.src.uri=window.location.href),this.src.resolvedUri=this.src.uri,setTimeout(()=>{this.setupInitialPlaylist(this.src)},0);return}const e={playlistInfo:{type:"multivariant",uri:this.src}};this.trigger({type:"playlistrequeststart",metadata:e}),this.request=this.vhs_.xhr({uri:this.src,withCredentials:this.withCredentials,requestType:"hls-playlist"},(s,a)=>{if(!this.request)return;if(this.request=null,s)return this.error={status:a.status,message:`HLS playlist request error at URL: ${this.src}.`,responseText:a.responseText,code:2,metadata:Wd({requestType:a.requestType,request:a,error:s})},this.state==="HAVE_NOTHING"&&(this.started=!1),this.trigger("error");this.trigger({type:"playlistrequestcomplete",metadata:e}),this.src=qT(this.src,a),this.trigger({type:"playlistparsestart",metadata:e});const h=this.parseManifest_({manifestString:a.responseText,url:this.src});e.parsedPlaylist=zI(h.playlists,e.playlistInfo.type,!1),this.trigger({type:"playlistparsecomplete",metadata:e}),this.setupInitialPlaylist(h)})}srcUri(){return typeof this.src=="string"?this.src:this.src.uri}setupInitialPlaylist(e){if(this.state="HAVE_MAIN_MANIFEST",e.playlists){this.main=e,MI(this.main,this.srcUri()),e.playlists.forEach(a=>{a.segments=VI(a),a.segments.forEach(h=>{HI(h,a.resolvedUri)})}),this.trigger("loadedplaylist"),this.request||this.media(this.main.playlists[0]);return}const s=this.srcUri()||window.location.href;this.main=o5(e,s),this.haveMetadata({playlistObject:e,url:s,id:this.main.playlists[0].id}),this.trigger("loadedmetadata")}updateOrDeleteClone(e,s){const a=this.main,h=e.ID;let p=a.playlists.length;for(;p--;){const _=a.playlists[p];if(_.attributes["PATHWAY-ID"]===h){const w=_.resolvedUri,I=_.id;if(s){const B=this.createCloneURI_(_.resolvedUri,e),G=Rg(h,B),se=this.createCloneAttributes_(h,_.attributes),pe=this.createClonePlaylist_(_,G,e,se);a.playlists[p]=pe,a.playlists[G]=pe,a.playlists[B]=pe}else a.playlists.splice(p,1);delete a.playlists[I],delete a.playlists[w]}}this.updateOrDeleteCloneMedia(e,s)}updateOrDeleteCloneMedia(e,s){const a=this.main,h=e.ID;["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(p=>{if(!(!a.mediaGroups[p]||!a.mediaGroups[p][h])){for(const _ in a.mediaGroups[p])if(_===h){for(const w in a.mediaGroups[p][_])a.mediaGroups[p][_][w].playlists.forEach((B,G)=>{const se=a.playlists[B.id],pe=se.id,Ee=se.resolvedUri;delete a.playlists[pe],delete a.playlists[Ee]});delete a.mediaGroups[p][_]}}}),s&&this.createClonedMediaGroups_(e)}addClonePathway(e,s={}){const a=this.main,h=a.playlists.length,p=this.createCloneURI_(s.resolvedUri,e),_=Rg(e.ID,p),w=this.createCloneAttributes_(e.ID,s.attributes),I=this.createClonePlaylist_(s,_,e,w);a.playlists[h]=I,a.playlists[_]=I,a.playlists[p]=I,this.createClonedMediaGroups_(e)}createClonedMediaGroups_(e){const s=e.ID,a=e["BASE-ID"],h=this.main;["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(p=>{if(!(!h.mediaGroups[p]||h.mediaGroups[p][s]))for(const _ in h.mediaGroups[p]){if(_===a)h.mediaGroups[p][s]={};else continue;for(const w in h.mediaGroups[p][_]){const I=h.mediaGroups[p][_][w];h.mediaGroups[p][s][w]=Z({},I);const B=h.mediaGroups[p][s][w],G=this.createCloneURI_(I.resolvedUri,e);B.resolvedUri=G,B.uri=G,B.playlists=[],I.playlists.forEach((se,pe)=>{const Ee=h.playlists[se.id],Ie=NI(p,s,w),ce=Rg(s,Ie);if(Ee&&!h.playlists[ce]){const Ve=this.createClonePlaylist_(Ee,ce,e),Be=Ve.resolvedUri;h.playlists[ce]=Ve,h.playlists[Be]=Ve}B.playlists[pe]=this.createClonePlaylist_(se,ce,e)})}}})}createClonePlaylist_(e,s,a,h){const p=this.createCloneURI_(e.resolvedUri,a),_={resolvedUri:p,uri:p,id:s};return e.segments&&(_.segments=[]),h&&(_.attributes=h),As(e,_)}createCloneURI_(e,s){const a=new URL(e);a.hostname=s["URI-REPLACEMENT"].HOST;const h=s["URI-REPLACEMENT"].PARAMS;for(const p of Object.keys(h))a.searchParams.set(p,h[p]);return a.href}createCloneAttributes_(e,s){const a={"PATHWAY-ID":e};return["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(h=>{s[h]&&(a[h]=e)}),a}getKeyIdSet(e){if(e.contentProtection){const s=new Set;for(const a in e.contentProtection){const h=e.contentProtection[a].attributes.keyId;h&&s.add(h.toLowerCase())}return s}}}const H1=function(r,e,s,a){const h=r.responseType==="arraybuffer"?r.response:r.responseText;!e&&h&&(r.responseTime=Date.now(),r.roundTripTime=r.responseTime-r.requestTime,r.bytesReceived=h.byteLength||h.length,r.bandwidth||(r.bandwidth=Math.floor(r.bytesReceived/r.roundTripTime*8*1e3))),s.headers&&(r.responseHeaders=s.headers),e&&e.code==="ETIMEDOUT"&&(r.timedout=!0),!e&&!r.aborted&&s.statusCode!==200&&s.statusCode!==206&&s.statusCode!==0&&(e=new Error("XHR Failed with a response of: "+(r&&(h||r.responseText)))),a(e,r)},p5=(r,e)=>{if(!r||!r.size)return;let s=e;return r.forEach(a=>{s=a(s)}),s},g5=(r,e,s,a)=>{!r||!r.size||r.forEach(h=>{h(e,s,a)})},WI=function(){const r=function e(s,a){s=As({timeout:45e3},s);const h=e.beforeRequest||Ye.Vhs.xhr.beforeRequest,p=e._requestCallbackSet||Ye.Vhs.xhr._requestCallbackSet||new Set,_=e._responseCallbackSet||Ye.Vhs.xhr._responseCallbackSet;h&&typeof h=="function"&&(Ye.log.warn("beforeRequest is deprecated, use onRequest instead."),p.add(h));const w=Ye.Vhs.xhr.original===!0?Ye.xhr:Ye.Vhs.xhr,I=p5(p,s);p.delete(h);const B=w(I||s,function(se,pe){return g5(_,B,se,pe),H1(B,se,pe,a)}),G=B.abort;return B.abort=function(){return B.aborted=!0,G.apply(B,arguments)},B.uri=s.uri,B.requestType=s.requestType,B.requestTime=Date.now(),B};return r.original=!0,r},m5=function(r){let e;const s=r.offset;return typeof r.offset=="bigint"||typeof r.length=="bigint"?e=window.BigInt(r.offset)+window.BigInt(r.length)-window.BigInt(1):e=r.offset+r.length-1,"bytes="+s+"-"+e},V1=function(r){const e={};return r.byterange&&(e.Range=m5(r.byterange)),e},_5=function(r,e){return r.start(e)+"-"+r.end(e)},b5=function(r,e){const s=r.toString(16);return"00".substring(0,2-s.length)+s+(e%2?" ":"")},y5=function(r){return r>=32&&r<126?String.fromCharCode(r):"."},qI=function(r){const e={};return Object.keys(r).forEach(s=>{const a=r[s];yD(a)?e[s]={bytes:a.buffer,byteOffset:a.byteOffset,byteLength:a.byteLength}:e[s]=a}),e},KT=function(r){const e=r.byterange||{length:1/0,offset:0};return[e.length,e.offset,r.resolvedUri].join(",")},GI=function(r){return r.resolvedUri},XI=r=>{const e=Array.prototype.slice.call(r),s=16;let a="",h,p;for(let _=0;_<e.length/s;_++)h=e.slice(_*s,_*s+s).map(b5).join(""),p=e.slice(_*s,_*s+s).map(y5).join(""),a+=h+" "+p+`
`;return a};var v5=Object.freeze({__proto__:null,createTransferableMessage:qI,initSegmentId:KT,segmentKeyId:GI,hexDump:XI,tagDump:({bytes:r})=>XI(r),textRanges:r=>{let e="",s;for(s=0;s<r.length;s++)e+=_5(r,s)+" ";return e}});const KI=.25,w5=(r,e)=>{if(!e.dateTimeObject)return null;const s=e.videoTimingInfo.transmuxerPrependedSeconds,h=e.videoTimingInfo.transmuxedPresentationStart+s,p=r-h;return new Date(e.dateTimeObject.getTime()+p*1e3)},T5=r=>r.transmuxedPresentationEnd-r.transmuxedPresentationStart-r.transmuxerPrependedSeconds,E5=(r,e)=>{let s;try{s=new Date(r)}catch{return null}if(!e||!e.segments||e.segments.length===0)return null;let a=e.segments[0];if(s<new Date(a.dateTimeObject))return null;for(let I=0;I<e.segments.length-1;I++){a=e.segments[I];const B=new Date(e.segments[I+1].dateTimeObject);if(s<B)break}const h=e.segments[e.segments.length-1],p=h.dateTimeObject,_=h.videoTimingInfo?T5(h.videoTimingInfo):h.duration+h.duration*KI,w=new Date(p.getTime()+_*1e3);return s>w?null:(s>new Date(p)&&(a=h),{segment:a,estimatedStart:a.videoTimingInfo?a.videoTimingInfo.transmuxedPresentationStart:_a.duration(e,e.mediaSequence+e.segments.indexOf(a)),type:a.videoTimingInfo?"accurate":"estimate"})},S5=(r,e)=>{if(!e||!e.segments||e.segments.length===0)return null;let s=0,a;for(let p=0;p<e.segments.length&&(a=e.segments[p],s=a.videoTimingInfo?a.videoTimingInfo.transmuxedPresentationEnd:s+a.duration,!(r<=s));p++);const h=e.segments[e.segments.length-1];if(h.videoTimingInfo&&h.videoTimingInfo.transmuxedPresentationEnd<r)return null;if(r>s){if(r>s+h.duration*KI)return null;a=h}return{segment:a,estimatedStart:a.videoTimingInfo?a.videoTimingInfo.transmuxedPresentationStart:s-a.duration,type:a.videoTimingInfo?"accurate":"estimate"}},x5=(r,e)=>{let s,a;try{s=new Date(r),a=new Date(e)}catch{}const h=s.getTime();return(a.getTime()-h)/1e3},A5=r=>{if(!r.segments||r.segments.length===0)return!1;for(let e=0;e<r.segments.length;e++)if(!r.segments[e].dateTimeObject)return!1;return!0},C5=({playlist:r,time:e=void 0,callback:s})=>{if(!s)throw new Error("getProgramTime: callback must be provided");if(!r||e===void 0)return s({message:"getProgramTime: playlist and time must be provided"});const a=S5(e,r);if(!a)return s({message:"valid programTime was not found"});if(a.type==="estimate")return s({message:"Accurate programTime could not be determined. Please seek to e.seekTime and try again",seekTime:a.estimatedStart});const h={mediaSeconds:e},p=w5(e,a.segment);return p&&(h.programDateTime=p.toISOString()),s(null,h)},YI=({programTime:r,playlist:e,retryCount:s=2,seekTo:a,pauseAfterSeek:h=!0,tech:p,callback:_})=>{if(!_)throw new Error("seekToProgramTime: callback must be provided");if(typeof r>"u"||!e||!a)return _({message:"seekToProgramTime: programTime, seekTo and playlist must be provided"});if(!e.endList&&!p.hasStarted_)return _({message:"player must be playing a live stream to start buffering"});if(!A5(e))return _({message:"programDateTime tags must be provided in the manifest "+e.resolvedUri});const w=E5(r,e);if(!w)return _({message:`${r} was not found in the stream`});const I=w.segment,B=x5(I.dateTimeObject,r);if(w.type==="estimate"){if(s===0)return _({message:`${r} is not buffered yet. Try again`});a(w.estimatedStart+B),p.one("seeked",()=>{YI({programTime:r,playlist:e,retryCount:s-1,seekTo:a,pauseAfterSeek:h,tech:p,callback:_})});return}const G=I.start+B,se=()=>_(null,p.currentTime());p.one("seeked",se),h&&p.pause(),a(G)},$1=(r,e)=>{if(r.readyState===4)return e()},k5=(r,e,s,a)=>{let h=[],p,_=!1;const w=function(se,pe,Ee,Ie){return pe.abort(),_=!0,s(se,pe,Ee,Ie)},I=function(se,pe){if(_)return;if(se)return se.metadata=Wd({requestType:a,request:pe,error:se}),w(se,pe,"",h);const Ee=pe.responseText.substring(h&&h.byteLength||0,pe.responseText.length);if(h=q4(h,vD(Ee,!0)),p=p||$_(h),h.length<10||p&&h.length<p+2)return $1(pe,()=>w(se,pe,"",h));const Ie=I1(h);return Ie==="ts"&&h.length<188?$1(pe,()=>w(se,pe,"",h)):!Ie&&h.length<376?$1(pe,()=>w(se,pe,"",h)):w(null,pe,Ie,h)},G=e({uri:r,beforeSend(se){se.overrideMimeType("text/plain; charset=x-user-defined"),se.addEventListener("progress",function({total:pe,loaded:Ee}){return H1(se,null,{statusCode:se.status},I)})}},function(se,pe){return H1(G,se,pe,I)});return G},{EventTarget:P5}=Ye,ZI=function(r,e){if(!$I(r,e)||r.sidx&&e.sidx&&(r.sidx.offset!==e.sidx.offset||r.sidx.length!==e.sidx.length))return!1;if(!r.sidx&&e.sidx||r.sidx&&!e.sidx||r.segments&&!e.segments||!r.segments&&e.segments)return!1;if(!r.segments&&!e.segments)return!0;for(let s=0;s<r.segments.length;s++){const a=r.segments[s],h=e.segments[s];if(a.uri!==h.uri)return!1;if(!a.byterange&&!h.byterange)continue;const p=a.byterange,_=h.byterange;if(p&&!_||!p&&_||p.offset!==_.offset||p.length!==_.length)return!1}return!0},D5=(r,e,s,a)=>{const h=a.attributes.NAME||s;return`placeholder-uri-${r}-${e}-${h}`},I5=({mainXml:r,srcUrl:e,clientOffset:s,sidxMapping:a,previousManifest:h})=>{const p=TU(r,{manifestUri:e,clientOffset:s,sidxMapping:a,previousManifest:h});return MI(p,e,D5),p},L5=(r,e)=>{Mg(r,(s,a,h,p)=>{(!e.mediaGroups[a][h]||!(p in e.mediaGroups[a][h]))&&delete r.mediaGroups[a][h][p]})},N5=(r,e,s)=>{let a=!0,h=As(r,{duration:e.duration,minimumUpdatePeriod:e.minimumUpdatePeriod,timelineStarts:e.timelineStarts});for(let p=0;p<e.playlists.length;p++){const _=e.playlists[p];if(_.sidx){const I=VT(_.sidx);s&&s[I]&&s[I].sidx&&x1(_,s[I].sidx,_.sidx.resolvedUri)}const w=U1(h,_,ZI);w&&(h=w,a=!1)}return Mg(e,(p,_,w,I)=>{if(p.playlists&&p.playlists.length){const B=p.playlists[0].id,G=U1(h,p.playlists[0],ZI);G&&(h=G,I in h.mediaGroups[_][w]||(h.mediaGroups[_][w][I]=p),h.mediaGroups[_][w][I].playlists[0]=h.playlists[B],a=!1)}}),L5(h,e),e.minimumUpdatePeriod!==r.minimumUpdatePeriod&&(a=!1),a?null:h},R5=(r,e)=>(!r.map&&!e.map||!!(r.map&&e.map&&r.map.byterange.offset===e.map.byterange.offset&&r.map.byterange.length===e.map.byterange.length))&&r.uri===e.uri&&r.byterange.offset===e.byterange.offset&&r.byterange.length===e.byterange.length,QI=(r,e)=>{const s={};for(const a in r){const p=r[a].sidx;if(p){const _=VT(p);if(!e[_])break;const w=e[_].sidxInfo;R5(w,p)&&(s[_]=e[_])}}return s},M5=(r,e)=>{let a=QI(r.playlists,e);return Mg(r,(h,p,_,w)=>{if(h.playlists&&h.playlists.length){const I=h.playlists;a=As(a,QI(I,e))}}),a};class z1 extends P5{constructor(e,s,a={},h){super(),this.isPaused_=!0,this.mainPlaylistLoader_=h||this,h||(this.isMain_=!0);const{withCredentials:p=!1}=a;if(this.vhs_=s,this.withCredentials=p,this.addMetadataToTextTrack=a.addMetadataToTextTrack,!e)throw new Error("A non-empty playlist URL or object is required");this.on("minimumUpdatePeriod",()=>{this.refreshXml_()}),this.on("mediaupdatetimeout",()=>{this.refreshMedia_(this.media().id)}),this.state="HAVE_NOTHING",this.loadedPlaylists_={},this.logger_=mo("DashPlaylistLoader"),this.isMain_?(this.mainPlaylistLoader_.srcUrl=e,this.mainPlaylistLoader_.sidxMapping_={}):this.childPlaylist_=e}get isPaused(){return this.isPaused_}requestErrored_(e,s,a){if(!this.request)return!0;if(this.request=null,e)return this.error=typeof e=="object"&&!(e instanceof Error)?e:{status:s.status,message:"DASH request error at URL: "+s.uri,response:s.response,code:2,metadata:e.metadata},a&&(this.state=a),this.trigger("error"),!0}addSidxSegments_(e,s,a){const h=e.sidx&&VT(e.sidx);if(!e.sidx||!h||this.mainPlaylistLoader_.sidxMapping_[h]){window.clearTimeout(this.mediaRequest_),this.mediaRequest_=window.setTimeout(()=>a(!1),0);return}const p=qT(e.sidx.resolvedUri),_=(I,B)=>{if(this.requestErrored_(I,B,s))return;const G=this.mainPlaylistLoader_.sidxMapping_,{requestType:se}=B;let pe;try{pe=kU(_i(B.response).subarray(8))}catch(Ee){Ee.metadata=Wd({requestType:se,request:B,parseFailure:!0}),this.requestErrored_(Ee,B,s);return}return G[h]={sidxInfo:e.sidx,sidx:pe},x1(e,pe,e.sidx.resolvedUri),a(!0)},w="dash-sidx";this.request=k5(p,this.vhs_.xhr,(I,B,G,se)=>{if(I)return _(I,B);if(!G||G!=="mp4"){const Ie=G||"unknown";return _({status:B.status,message:`Unsupported ${Ie} container type for sidx segment at URL: ${p}`,response:"",playlist:e,internal:!0,playlistExclusionDuration:1/0,code:2},B)}const{offset:pe,length:Ee}=e.sidx.byterange;if(se.length>=Ee+pe)return _(I,{response:se.subarray(pe,pe+Ee),status:B.status,uri:B.uri});this.request=this.vhs_.xhr({uri:p,responseType:"arraybuffer",requestType:"dash-sidx",headers:V1({byterange:e.sidx.byterange})},_)},w)}dispose(){this.isPaused_=!0,this.trigger("dispose"),this.stopRequest(),this.loadedPlaylists_={},window.clearTimeout(this.minimumUpdatePeriodTimeout_),window.clearTimeout(this.mediaRequest_),window.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null,this.mediaRequest_=null,this.minimumUpdatePeriodTimeout_=null,this.mainPlaylistLoader_.createMupOnMedia_&&(this.off("loadedmetadata",this.mainPlaylistLoader_.createMupOnMedia_),this.mainPlaylistLoader_.createMupOnMedia_=null),this.off()}hasPendingRequest(){return this.request||this.mediaRequest_}stopRequest(){if(this.request){const e=this.request;this.request=null,e.onreadystatechange=null,e.abort()}}media(e){if(!e)return this.media_;if(this.state==="HAVE_NOTHING")throw new Error("Cannot switch media playlist from "+this.state);const s=this.state;if(typeof e=="string"){if(!this.mainPlaylistLoader_.main.playlists[e])throw new Error("Unknown playlist URI: "+e);e=this.mainPlaylistLoader_.main.playlists[e]}const a=!this.media_||e.id!==this.media_.id;if(a&&this.loadedPlaylists_[e.id]&&this.loadedPlaylists_[e.id].endList){this.state="HAVE_METADATA",this.media_=e,a&&(this.trigger("mediachanging"),this.trigger("mediachange"));return}a&&(this.media_&&this.trigger("mediachanging"),this.addSidxSegments_(e,s,h=>{this.haveMetadata({startingState:s,playlist:e})}))}haveMetadata({startingState:e,playlist:s}){this.state="HAVE_METADATA",this.loadedPlaylists_[s.id]=s,window.clearTimeout(this.mediaRequest_),this.mediaRequest_=null,this.refreshMedia_(s.id),e==="HAVE_MAIN_MANIFEST"?this.trigger("loadedmetadata"):this.trigger("mediachange")}pause(){this.isPaused_=!0,this.mainPlaylistLoader_.createMupOnMedia_&&(this.off("loadedmetadata",this.mainPlaylistLoader_.createMupOnMedia_),this.mainPlaylistLoader_.createMupOnMedia_=null),this.stopRequest(),window.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null,this.isMain_&&(window.clearTimeout(this.mainPlaylistLoader_.minimumUpdatePeriodTimeout_),this.mainPlaylistLoader_.minimumUpdatePeriodTimeout_=null),this.state==="HAVE_NOTHING"&&(this.started=!1)}load(e){this.isPaused_=!1,window.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null;const s=this.media();if(e){const a=s?s.targetDuration/2*1e3:5e3;this.mediaUpdateTimeout=window.setTimeout(()=>this.load(),a);return}if(!this.started){this.start();return}s&&!s.endList?(this.isMain_&&!this.minimumUpdatePeriodTimeout_&&(this.trigger("minimumUpdatePeriod"),this.updateMinimumUpdatePeriodTimeout_()),this.trigger("mediaupdatetimeout")):this.trigger("loadedplaylist")}start(){if(this.started=!0,!this.isMain_){window.clearTimeout(this.mediaRequest_),this.mediaRequest_=window.setTimeout(()=>this.haveMain_(),0);return}this.requestMain_((e,s)=>{this.haveMain_(),!this.hasPendingRequest()&&!this.media_&&this.media(this.mainPlaylistLoader_.main.playlists[0])})}requestMain_(e){const s={manifestInfo:{uri:this.mainPlaylistLoader_.srcUrl}};this.trigger({type:"manifestrequeststart",metadata:s}),this.request=this.vhs_.xhr({uri:this.mainPlaylistLoader_.srcUrl,withCredentials:this.withCredentials,requestType:"dash-manifest"},(a,h)=>{if(a){const{requestType:_}=h;a.metadata=Wd({requestType:_,request:h,error:a})}if(this.requestErrored_(a,h)){this.state==="HAVE_NOTHING"&&(this.started=!1);return}this.trigger({type:"manifestrequestcomplete",metadata:s});const p=h.responseText!==this.mainPlaylistLoader_.mainXml_;if(this.mainPlaylistLoader_.mainXml_=h.responseText,h.responseHeaders&&h.responseHeaders.date?this.mainLoaded_=Date.parse(h.responseHeaders.date):this.mainLoaded_=Date.now(),this.mainPlaylistLoader_.srcUrl=qT(this.mainPlaylistLoader_.srcUrl,h),p){this.handleMain_(),this.syncClientServerClock_(()=>e(h,p));return}return e(h,p)})}syncClientServerClock_(e){const s=EU(this.mainPlaylistLoader_.mainXml_);if(s===null)return this.mainPlaylistLoader_.clientOffset_=this.mainLoaded_-Date.now(),e();if(s.method==="DIRECT")return this.mainPlaylistLoader_.clientOffset_=s.value-Date.now(),e();this.request=this.vhs_.xhr({uri:ma(this.mainPlaylistLoader_.srcUrl,s.value),method:s.method,withCredentials:this.withCredentials,requestType:"dash-clock-sync"},(a,h)=>{if(!this.request)return;if(a){const{requestType:_}=h;return this.error.metadata=Wd({requestType:_,request:h,error:a}),this.mainPlaylistLoader_.clientOffset_=this.mainLoaded_-Date.now(),e()}let p;s.method==="HEAD"?!h.responseHeaders||!h.responseHeaders.date?p=this.mainLoaded_:p=Date.parse(h.responseHeaders.date):p=Date.parse(h.responseText),this.mainPlaylistLoader_.clientOffset_=p-Date.now(),e()})}haveMain_(){this.state="HAVE_MAIN_MANIFEST",this.isMain_?this.trigger("loadedplaylist"):this.media_||this.media(this.childPlaylist_)}handleMain_(){window.clearTimeout(this.mediaRequest_),this.mediaRequest_=null;const e=this.mainPlaylistLoader_.main,s={manifestInfo:{uri:this.mainPlaylistLoader_.srcUrl}};this.trigger({type:"manifestparsestart",metadata:s});let a;try{a=I5({mainXml:this.mainPlaylistLoader_.mainXml_,srcUrl:this.mainPlaylistLoader_.srcUrl,clientOffset:this.mainPlaylistLoader_.clientOffset_,sidxMapping:this.mainPlaylistLoader_.sidxMapping_,previousManifest:e})}catch(p){this.error=p,this.error.metadata={errorType:Ye.Error.StreamingDashManifestParserError,error:p},this.trigger("error")}e&&(a=N5(e,a,this.mainPlaylistLoader_.sidxMapping_)),this.mainPlaylistLoader_.main=a||e;const h=this.mainPlaylistLoader_.main.locations&&this.mainPlaylistLoader_.main.locations[0];if(h&&h!==this.mainPlaylistLoader_.srcUrl&&(this.mainPlaylistLoader_.srcUrl=h),(!e||a&&a.minimumUpdatePeriod!==e.minimumUpdatePeriod)&&this.updateMinimumUpdatePeriodTimeout_(),this.addEventStreamToMetadataTrack_(a),a){const{duration:p,endList:_}=a,w=[];a.playlists.forEach(B=>{w.push({id:B.id,bandwidth:B.attributes.BANDWIDTH,resolution:B.attributes.RESOLUTION,codecs:B.attributes.CODECS})});const I={duration:p,isLive:!_,renditions:w};s.parsedManifest=I,this.trigger({type:"manifestparsecomplete",metadata:s})}return!!a}updateMinimumUpdatePeriodTimeout_(){const e=this.mainPlaylistLoader_;e.createMupOnMedia_&&(e.off("loadedmetadata",e.createMupOnMedia_),e.createMupOnMedia_=null),e.minimumUpdatePeriodTimeout_&&(window.clearTimeout(e.minimumUpdatePeriodTimeout_),e.minimumUpdatePeriodTimeout_=null);let s=e.main&&e.main.minimumUpdatePeriod;if(s===0&&(e.media()?s=e.media().targetDuration*1e3:(e.createMupOnMedia_=e.updateMinimumUpdatePeriodTimeout_,e.one("loadedmetadata",e.createMupOnMedia_))),typeof s!="number"||s<=0){s<0&&this.logger_(`found invalid minimumUpdatePeriod of ${s}, not setting a timeout`);return}this.createMUPTimeout_(s)}createMUPTimeout_(e){const s=this.mainPlaylistLoader_;s.minimumUpdatePeriodTimeout_=window.setTimeout(()=>{s.minimumUpdatePeriodTimeout_=null,s.trigger("minimumUpdatePeriod"),s.createMUPTimeout_(e)},e)}refreshXml_(){this.requestMain_((e,s)=>{s&&(this.media_&&(this.media_=this.mainPlaylistLoader_.main.playlists[this.media_.id]),this.mainPlaylistLoader_.sidxMapping_=M5(this.mainPlaylistLoader_.main,this.mainPlaylistLoader_.sidxMapping_),this.addSidxSegments_(this.media(),this.state,a=>{this.refreshMedia_(this.media().id)}))})}refreshMedia_(e){if(!e)throw new Error("refreshMedia_ must take a media id");this.media_&&this.isMain_&&this.handleMain_();const s=this.mainPlaylistLoader_.main.playlists,a=!this.media_||this.media_!==s[e];if(a?this.media_=s[e]:this.trigger("playlistunchanged"),!this.mediaUpdateTimeout){const h=()=>{this.media().endList||(this.mediaUpdateTimeout=window.setTimeout(()=>{this.trigger("mediaupdatetimeout"),h()},j1(this.media(),!!a)))};h()}this.trigger("loadedplaylist")}addEventStreamToMetadataTrack_(e){if(e&&this.mainPlaylistLoader_.main.eventStream){const s=this.mainPlaylistLoader_.main.eventStream.map(a=>({cueTime:a.start,frames:[{data:a.messageData}]}));this.addMetadataToTextTrack("EventStream",s,this.mainPlaylistLoader_.main.duration)}}getKeyIdSet(e){if(e.contentProtection){const s=new Set;for(const a in e.contentProtection){const h=e.contentProtection[a].attributes["cenc:default_KID"];h&&s.add(h.replace(/-/g,"").toLowerCase())}return s}}}var hr={GOAL_BUFFER_LENGTH:30,MAX_GOAL_BUFFER_LENGTH:60,BACK_BUFFER_LENGTH:30,GOAL_BUFFER_LENGTH_RATE:1,INITIAL_BANDWIDTH:4194304,BANDWIDTH_VARIANCE:1.2,BUFFER_LOW_WATER_LINE:0,MAX_BUFFER_LOW_WATER_LINE:30,EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE:16,BUFFER_LOW_WATER_LINE_RATE:1,BUFFER_HIGH_WATER_LINE:30};const O5=r=>{const e=new Uint8Array(new ArrayBuffer(r.length));for(let s=0;s<r.length;s++)e[s]=r.charCodeAt(s);return e.buffer},JI=function(r){return r.on=r.addEventListener,r.off=r.removeEventListener,r},F5=function(r){try{return URL.createObjectURL(new Blob([r],{type:"application/javascript"}))}catch{const s=new BlobBuilder;return s.append(r),URL.createObjectURL(s.getBlob())}},eL=function(r){return function(){const e=F5(r),s=JI(new Worker(e));s.objURL=e;const a=s.terminate;return s.on=s.addEventListener,s.off=s.removeEventListener,s.terminate=function(){return URL.revokeObjectURL(e),a.call(this)},s}},tL=function(r){return`var browserWorkerPolyFill = ${JI.toString()};
browserWorkerPolyFill(self);
`+r},iL=function(r){return r.toString().replace(/^function.+?{/,"").slice(0,-1)},B5=tL(iL(function(){var r=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},e=function(){this.init=function(){var v={};this.on=function(N,O){v[N]||(v[N]=[]),v[N]=v[N].concat(O)},this.off=function(N,O){var M;return v[N]?(M=v[N].indexOf(O),v[N]=v[N].slice(),v[N].splice(M,1),M>-1):!1},this.trigger=function(N){var O,M,W,Y;if(O=v[N],!!O)if(arguments.length===2)for(W=O.length,M=0;M<W;++M)O[M].call(this,arguments[1]);else{for(Y=[],M=arguments.length,M=1;M<arguments.length;++M)Y.push(arguments[M]);for(W=O.length,M=0;M<W;++M)O[M].apply(this,Y)}},this.dispose=function(){v={}}}};e.prototype.pipe=function(v){return this.on("data",function(N){v.push(N)}),this.on("done",function(N){v.flush(N)}),this.on("partialdone",function(N){v.partialFlush(N)}),this.on("endedtimeline",function(N){v.endTimeline(N)}),this.on("reset",function(N){v.reset(N)}),v},e.prototype.push=function(v){this.trigger("data",v)},e.prototype.flush=function(v){this.trigger("done",v)},e.prototype.partialFlush=function(v){this.trigger("partialdone",v)},e.prototype.endTimeline=function(v){this.trigger("endedtimeline",v)},e.prototype.reset=function(v){this.trigger("reset",v)};var s=e,a=Math.pow(2,32),h=function(v){var N=new DataView(v.buffer,v.byteOffset,v.byteLength),O;return N.getBigUint64?(O=N.getBigUint64(0),O<Number.MAX_SAFE_INTEGER?Number(O):O):N.getUint32(0)*a+N.getUint32(4)},p={getUint64:h,MAX_UINT32:a},_=p.MAX_UINT32,w,I,B,G,se,pe,Ee,Ie,ce,Ve,Be,Ke,ze,it,lt,Et,yt,Pt,Ti,Ms,us,Vs,ai,cs,Yr,ys,Cn,Eu,Gd,Xd,Kd,Yd,eE,WL,qL,GL;(function(){var v;if(ai={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],pasp:[],sdtp:[],smhd:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],styp:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[]},!(typeof Uint8Array>"u")){for(v in ai)ai.hasOwnProperty(v)&&(ai[v]=[v.charCodeAt(0),v.charCodeAt(1),v.charCodeAt(2),v.charCodeAt(3)]);cs=new Uint8Array([105,115,111,109]),ys=new Uint8Array([97,118,99,49]),Yr=new Uint8Array([0,0,0,1]),Cn=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),Eu=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),Gd={video:Cn,audio:Eu},Yd=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),Kd=new Uint8Array([0,0,0,0,0,0,0,0]),eE=new Uint8Array([0,0,0,0,0,0,0,0]),WL=eE,qL=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),GL=eE,Xd=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])}})(),w=function(v){var N=[],O=0,M,W,Y;for(M=1;M<arguments.length;M++)N.push(arguments[M]);for(M=N.length;M--;)O+=N[M].byteLength;for(W=new Uint8Array(O+8),Y=new DataView(W.buffer,W.byteOffset,W.byteLength),Y.setUint32(0,W.byteLength),W.set(v,4),M=0,O=8;M<N.length;M++)W.set(N[M],O),O+=N[M].byteLength;return W},I=function(){return w(ai.dinf,w(ai.dref,Yd))},B=function(v){return w(ai.esds,new Uint8Array([0,0,0,0,3,25,0,0,0,4,17,64,21,0,6,0,0,0,218,192,0,0,218,192,5,2,v.audioobjecttype<<3|v.samplingfrequencyindex>>>1,v.samplingfrequencyindex<<7|v.channelcount<<3,6,1,2]))},G=function(){return w(ai.ftyp,cs,Yr,cs,ys)},Et=function(v){return w(ai.hdlr,Gd[v])},se=function(v){return w(ai.mdat,v)},lt=function(v){var N=new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,v.duration>>>24&255,v.duration>>>16&255,v.duration>>>8&255,v.duration&255,85,196,0,0]);return v.samplerate&&(N[12]=v.samplerate>>>24&255,N[13]=v.samplerate>>>16&255,N[14]=v.samplerate>>>8&255,N[15]=v.samplerate&255),w(ai.mdhd,N)},it=function(v){return w(ai.mdia,lt(v),Et(v.type),Ee(v))},pe=function(v){return w(ai.mfhd,new Uint8Array([0,0,0,0,(v&4278190080)>>24,(v&16711680)>>16,(v&65280)>>8,v&255]))},Ee=function(v){return w(ai.minf,v.type==="video"?w(ai.vmhd,Xd):w(ai.smhd,Kd),I(),Pt(v))},Ie=function(v,N){for(var O=[],M=N.length;M--;)O[M]=Ms(N[M]);return w.apply(null,[ai.moof,pe(v)].concat(O))},ce=function(v){for(var N=v.length,O=[];N--;)O[N]=Ke(v[N]);return w.apply(null,[ai.moov,Be(4294967295)].concat(O).concat(Ve(v)))},Ve=function(v){for(var N=v.length,O=[];N--;)O[N]=us(v[N]);return w.apply(null,[ai.mvex].concat(O))},Be=function(v){var N=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(v&4278190080)>>24,(v&16711680)>>16,(v&65280)>>8,v&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return w(ai.mvhd,N)},yt=function(v){var N=v.samples||[],O=new Uint8Array(4+N.length),M,W;for(W=0;W<N.length;W++)M=N[W].flags,O[W+4]=M.dependsOn<<4|M.isDependedOn<<2|M.hasRedundancy;return w(ai.sdtp,O)},Pt=function(v){return w(ai.stbl,Ti(v),w(ai.stts,GL),w(ai.stsc,WL),w(ai.stsz,qL),w(ai.stco,eE))},function(){var v,N;Ti=function(O){return w(ai.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),O.type==="video"?v(O):N(O))},v=function(O){var M=O.sps||[],W=O.pps||[],Y=[],ge=[],_e,ve;for(_e=0;_e<M.length;_e++)Y.push((M[_e].byteLength&65280)>>>8),Y.push(M[_e].byteLength&255),Y=Y.concat(Array.prototype.slice.call(M[_e]));for(_e=0;_e<W.length;_e++)ge.push((W[_e].byteLength&65280)>>>8),ge.push(W[_e].byteLength&255),ge=ge.concat(Array.prototype.slice.call(W[_e]));if(ve=[ai.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(O.width&65280)>>8,O.width&255,(O.height&65280)>>8,O.height&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),w(ai.avcC,new Uint8Array([1,O.profileIdc,O.profileCompatibility,O.levelIdc,255].concat([M.length],Y,[W.length],ge))),w(ai.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192]))],O.sarRatio){var xe=O.sarRatio[0],Ue=O.sarRatio[1];ve.push(w(ai.pasp,new Uint8Array([(xe&4278190080)>>24,(xe&16711680)>>16,(xe&65280)>>8,xe&255,(Ue&4278190080)>>24,(Ue&16711680)>>16,(Ue&65280)>>8,Ue&255])))}return w.apply(null,ve)},N=function(O){return w(ai.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(O.channelcount&65280)>>8,O.channelcount&255,(O.samplesize&65280)>>8,O.samplesize&255,0,0,0,0,(O.samplerate&65280)>>8,O.samplerate&255,0,0]),B(O))}}(),ze=function(v){var N=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,(v.id&4278190080)>>24,(v.id&16711680)>>16,(v.id&65280)>>8,v.id&255,0,0,0,0,(v.duration&4278190080)>>24,(v.duration&16711680)>>16,(v.duration&65280)>>8,v.duration&255,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(v.width&65280)>>8,v.width&255,0,0,(v.height&65280)>>8,v.height&255,0,0]);return w(ai.tkhd,N)},Ms=function(v){var N,O,M,W,Y,ge,_e;return N=w(ai.tfhd,new Uint8Array([0,0,0,58,(v.id&4278190080)>>24,(v.id&16711680)>>16,(v.id&65280)>>8,v.id&255,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),ge=Math.floor(v.baseMediaDecodeTime/_),_e=Math.floor(v.baseMediaDecodeTime%_),O=w(ai.tfdt,new Uint8Array([1,0,0,0,ge>>>24&255,ge>>>16&255,ge>>>8&255,ge&255,_e>>>24&255,_e>>>16&255,_e>>>8&255,_e&255])),Y=92,v.type==="audio"?(M=Vs(v,Y),w(ai.traf,N,O,M)):(W=yt(v),M=Vs(v,W.length+Y),w(ai.traf,N,O,M,W))},Ke=function(v){return v.duration=v.duration||4294967295,w(ai.trak,ze(v),it(v))},us=function(v){var N=new Uint8Array([0,0,0,0,(v.id&4278190080)>>24,(v.id&16711680)>>16,(v.id&65280)>>8,v.id&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return v.type!=="video"&&(N[N.length-1]=0),w(ai.trex,N)},function(){var v,N,O;O=function(M,W){var Y=0,ge=0,_e=0,ve=0;return M.length&&(M[0].duration!==void 0&&(Y=1),M[0].size!==void 0&&(ge=2),M[0].flags!==void 0&&(_e=4),M[0].compositionTimeOffset!==void 0&&(ve=8)),[0,0,Y|ge|_e|ve,1,(M.length&4278190080)>>>24,(M.length&16711680)>>>16,(M.length&65280)>>>8,M.length&255,(W&4278190080)>>>24,(W&16711680)>>>16,(W&65280)>>>8,W&255]},N=function(M,W){var Y,ge,_e,ve,xe,Ue;for(ve=M.samples||[],W+=20+16*ve.length,_e=O(ve,W),ge=new Uint8Array(_e.length+ve.length*16),ge.set(_e),Y=_e.length,Ue=0;Ue<ve.length;Ue++)xe=ve[Ue],ge[Y++]=(xe.duration&4278190080)>>>24,ge[Y++]=(xe.duration&16711680)>>>16,ge[Y++]=(xe.duration&65280)>>>8,ge[Y++]=xe.duration&255,ge[Y++]=(xe.size&4278190080)>>>24,ge[Y++]=(xe.size&16711680)>>>16,ge[Y++]=(xe.size&65280)>>>8,ge[Y++]=xe.size&255,ge[Y++]=xe.flags.isLeading<<2|xe.flags.dependsOn,ge[Y++]=xe.flags.isDependedOn<<6|xe.flags.hasRedundancy<<4|xe.flags.paddingValue<<1|xe.flags.isNonSyncSample,ge[Y++]=xe.flags.degradationPriority&61440,ge[Y++]=xe.flags.degradationPriority&15,ge[Y++]=(xe.compositionTimeOffset&4278190080)>>>24,ge[Y++]=(xe.compositionTimeOffset&16711680)>>>16,ge[Y++]=(xe.compositionTimeOffset&65280)>>>8,ge[Y++]=xe.compositionTimeOffset&255;return w(ai.trun,ge)},v=function(M,W){var Y,ge,_e,ve,xe,Ue;for(ve=M.samples||[],W+=20+8*ve.length,_e=O(ve,W),Y=new Uint8Array(_e.length+ve.length*8),Y.set(_e),ge=_e.length,Ue=0;Ue<ve.length;Ue++)xe=ve[Ue],Y[ge++]=(xe.duration&4278190080)>>>24,Y[ge++]=(xe.duration&16711680)>>>16,Y[ge++]=(xe.duration&65280)>>>8,Y[ge++]=xe.duration&255,Y[ge++]=(xe.size&4278190080)>>>24,Y[ge++]=(xe.size&16711680)>>>16,Y[ge++]=(xe.size&65280)>>>8,Y[ge++]=xe.size&255;return w(ai.trun,Y)},Vs=function(M,W){return M.type==="audio"?v(M,W):N(M,W)}}();var Ej={ftyp:G,mdat:se,moof:Ie,moov:ce,initSegment:function(v){var N=G(),O=ce(v),M;return M=new Uint8Array(N.byteLength+O.byteLength),M.set(N),M.set(O,N.byteLength),M}},Sj=function(v){var N,O,M=[],W=[];for(W.byteLength=0,W.nalCount=0,W.duration=0,M.byteLength=0,N=0;N<v.length;N++)O=v[N],O.nalUnitType==="access_unit_delimiter_rbsp"?(M.length&&(M.duration=O.dts-M.dts,W.byteLength+=M.byteLength,W.nalCount+=M.length,W.duration+=M.duration,W.push(M)),M=[O],M.byteLength=O.data.byteLength,M.pts=O.pts,M.dts=O.dts):(O.nalUnitType==="slice_layer_without_partitioning_rbsp_idr"&&(M.keyFrame=!0),M.duration=O.dts-M.dts,M.byteLength+=O.data.byteLength,M.push(O));return W.length&&(!M.duration||M.duration<=0)&&(M.duration=W[W.length-1].duration),W.byteLength+=M.byteLength,W.nalCount+=M.length,W.duration+=M.duration,W.push(M),W},xj=function(v){var N,O,M=[],W=[];for(M.byteLength=0,M.nalCount=0,M.duration=0,M.pts=v[0].pts,M.dts=v[0].dts,W.byteLength=0,W.nalCount=0,W.duration=0,W.pts=v[0].pts,W.dts=v[0].dts,N=0;N<v.length;N++)O=v[N],O.keyFrame?(M.length&&(W.push(M),W.byteLength+=M.byteLength,W.nalCount+=M.nalCount,W.duration+=M.duration),M=[O],M.nalCount=O.length,M.byteLength=O.byteLength,M.pts=O.pts,M.dts=O.dts,M.duration=O.duration):(M.duration+=O.duration,M.nalCount+=O.length,M.byteLength+=O.byteLength,M.push(O));return W.length&&M.duration<=0&&(M.duration=W[W.length-1].duration),W.byteLength+=M.byteLength,W.nalCount+=M.nalCount,W.duration+=M.duration,W.push(M),W},Aj=function(v){var N;return!v[0][0].keyFrame&&v.length>1&&(N=v.shift(),v.byteLength-=N.byteLength,v.nalCount-=N.nalCount,v[0][0].dts=N.dts,v[0][0].pts=N.pts,v[0][0].duration+=N.duration),v},Cj=function(){return{size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0,isNonSyncSample:1}}},XL=function(v,N){var O=Cj();return O.dataOffset=N,O.compositionTimeOffset=v.pts-v.dts,O.duration=v.duration,O.size=4*v.length,O.size+=v.byteLength,v.keyFrame&&(O.flags.dependsOn=2,O.flags.isNonSyncSample=0),O},kj=function(v,N){var O,M,W,Y,ge,_e=N||0,ve=[];for(O=0;O<v.length;O++)for(Y=v[O],M=0;M<Y.length;M++)ge=Y[M],W=XL(ge,_e),_e+=W.size,ve.push(W);return ve},Pj=function(v){var N,O,M,W,Y,ge,_e=0,ve=v.byteLength,xe=v.nalCount,Ue=ve+4*xe,ut=new Uint8Array(Ue),Ft=new DataView(ut.buffer);for(N=0;N<v.length;N++)for(W=v[N],O=0;O<W.length;O++)for(Y=W[O],M=0;M<Y.length;M++)ge=Y[M],Ft.setUint32(_e,ge.data.byteLength),_e+=4,ut.set(ge.data,_e),_e+=ge.data.byteLength;return ut},Dj=function(v,N){var O,M=N||0,W=[];return O=XL(v,M),W.push(O),W},Ij=function(v){var N,O,M=0,W=v.byteLength,Y=v.length,ge=W+4*Y,_e=new Uint8Array(ge),ve=new DataView(_e.buffer);for(N=0;N<v.length;N++)O=v[N],ve.setUint32(M,O.data.byteLength),M+=4,_e.set(O.data,M),M+=O.data.byteLength;return _e},Lj={groupNalsIntoFrames:Sj,groupFramesIntoGops:xj,extendFirstKeyFrame:Aj,generateSampleTable:kj,concatenateNalData:Pj,generateSampleTableForFrame:Dj,concatenateNalDataForFrame:Ij},Jh=[33,16,5,32,164,27],eA=[33,65,108,84,1,2,4,8,168,2,4,8,17,191,252],Ps=function(v){for(var N=[];v--;)N.push(0);return N},Nj=function(v){return Object.keys(v).reduce(function(N,O){return N[O]=new Uint8Array(v[O].reduce(function(M,W){return M.concat(W)},[])),N},{})},tA,Rj=function(){if(!tA){var v={96e3:[Jh,[227,64],Ps(154),[56]],88200:[Jh,[231],Ps(170),[56]],64e3:[Jh,[248,192],Ps(240),[56]],48e3:[Jh,[255,192],Ps(268),[55,148,128],Ps(54),[112]],44100:[Jh,[255,192],Ps(268),[55,163,128],Ps(84),[112]],32e3:[Jh,[255,192],Ps(268),[55,234],Ps(226),[112]],24e3:[Jh,[255,192],Ps(268),[55,255,128],Ps(268),[111,112],Ps(126),[224]],16e3:[Jh,[255,192],Ps(268),[55,255,128],Ps(268),[111,255],Ps(269),[223,108],Ps(195),[1,192]],12e3:[eA,Ps(268),[3,127,248],Ps(268),[6,255,240],Ps(268),[13,255,224],Ps(268),[27,253,128],Ps(259),[56]],11025:[eA,Ps(268),[3,127,248],Ps(268),[6,255,240],Ps(268),[13,255,224],Ps(268),[27,255,192],Ps(268),[55,175,128],Ps(108),[112]],8e3:[eA,Ps(268),[3,121,16],Ps(47),[7]]};tA=Nj(v)}return tA},iA=9e4,sA,nA,tE,rA,KL,YL,ZL;sA=function(v){return v*iA},nA=function(v,N){return v*N},tE=function(v){return v/iA},rA=function(v,N){return v/N},KL=function(v,N){return sA(rA(v,N))},YL=function(v,N){return nA(tE(v),N)},ZL=function(v,N,O){return tE(O?v:v-N)};var Js={ONE_SECOND_IN_TS:iA,secondsToVideoTs:sA,secondsToAudioTs:nA,videoTsToSeconds:tE,audioTsToSeconds:rA,audioTsToVideoTs:KL,videoTsToAudioTs:YL,metadataTsToSeconds:ZL},Mj=Rj,iE=Js,Oj=function(v){var N,O,M=0;for(N=0;N<v.length;N++)O=v[N],M+=O.data.byteLength;return M},Fj=function(v,N,O,M){var W,Y=0,ge=0,_e=0,ve=0,xe,Ue,ut;if(N.length&&(W=iE.audioTsToVideoTs(v.baseMediaDecodeTime,v.samplerate),Y=Math.ceil(iE.ONE_SECOND_IN_TS/(v.samplerate/1024)),O&&M&&(ge=W-Math.max(O,M),_e=Math.floor(ge/Y),ve=_e*Y),!(_e<1||ve>iE.ONE_SECOND_IN_TS/2))){for(xe=Mj()[v.samplerate],xe||(xe=N[0].data),Ue=0;Ue<_e;Ue++)ut=N[0],N.splice(0,0,{data:xe,dts:ut.dts-Y,pts:ut.pts-Y});return v.baseMediaDecodeTime-=Math.floor(iE.videoTsToAudioTs(ve,v.samplerate)),ve}},Bj=function(v,N,O){return N.minSegmentDts>=O?v:(N.minSegmentDts=1/0,v.filter(function(M){return M.dts>=O?(N.minSegmentDts=Math.min(N.minSegmentDts,M.dts),N.minSegmentPts=N.minSegmentDts,!0):!1}))},Uj=function(v){var N,O,M=[];for(N=0;N<v.length;N++)O=v[N],M.push({size:O.data.byteLength,duration:1024});return M},jj=function(v){var N,O,M=0,W=new Uint8Array(Oj(v));for(N=0;N<v.length;N++)O=v[N],W.set(O.data,M),M+=O.data.byteLength;return W},Hj={prefixWithSilence:Fj,trimAdtsFramesByEarliestDts:Bj,generateSampleTable:Uj,concatenateFrameData:jj},Vj=Js.ONE_SECOND_IN_TS,$j=function(v,N){typeof N.pts=="number"&&(v.timelineStartInfo.pts===void 0&&(v.timelineStartInfo.pts=N.pts),v.minSegmentPts===void 0?v.minSegmentPts=N.pts:v.minSegmentPts=Math.min(v.minSegmentPts,N.pts),v.maxSegmentPts===void 0?v.maxSegmentPts=N.pts:v.maxSegmentPts=Math.max(v.maxSegmentPts,N.pts)),typeof N.dts=="number"&&(v.timelineStartInfo.dts===void 0&&(v.timelineStartInfo.dts=N.dts),v.minSegmentDts===void 0?v.minSegmentDts=N.dts:v.minSegmentDts=Math.min(v.minSegmentDts,N.dts),v.maxSegmentDts===void 0?v.maxSegmentDts=N.dts:v.maxSegmentDts=Math.max(v.maxSegmentDts,N.dts))},zj=function(v){delete v.minSegmentDts,delete v.maxSegmentDts,delete v.minSegmentPts,delete v.maxSegmentPts},Wj=function(v,N){var O,M,W=v.minSegmentDts;return N||(W-=v.timelineStartInfo.dts),O=v.timelineStartInfo.baseMediaDecodeTime,O+=W,O=Math.max(0,O),v.type==="audio"&&(M=v.samplerate/Vj,O*=M,O=Math.floor(O)),O},qj={clearDtsInfo:zj,calculateTrackBaseMediaDecodeTime:Wj,collectDtsInfo:$j},QL=4,Gj=128,Xj=function(v){for(var N=0,O={payloadType:-1,payloadSize:0},M=0,W=0;N<v.byteLength&&v[N]!==Gj;){for(;v[N]===255;)M+=255,N++;for(M+=v[N++];v[N]===255;)W+=255,N++;if(W+=v[N++],!O.payload&&M===QL){var Y=String.fromCharCode(v[N+3],v[N+4],v[N+5],v[N+6]);if(Y==="GA94"){O.payloadType=M,O.payloadSize=W,O.payload=v.subarray(N,N+W);break}else O.payload=void 0}N+=W,M=0,W=0}return O},Kj=function(v){return v.payload[0]!==181||(v.payload[1]<<8|v.payload[2])!==49||String.fromCharCode(v.payload[3],v.payload[4],v.payload[5],v.payload[6])!=="GA94"||v.payload[7]!==3?null:v.payload.subarray(8,v.payload.length-1)},Yj=function(v,N){var O=[],M,W,Y,ge;if(!(N[0]&64))return O;for(W=N[0]&31,M=0;M<W;M++)Y=M*3,ge={type:N[Y+2]&3,pts:v},N[Y+2]&4&&(ge.ccData=N[Y+3]<<8|N[Y+4],O.push(ge));return O},Zj=function(v){for(var N=v.byteLength,O=[],M=1,W,Y;M<N-2;)v[M]===0&&v[M+1]===0&&v[M+2]===3?(O.push(M+2),M+=2):M++;if(O.length===0)return v;W=N-O.length,Y=new Uint8Array(W);var ge=0;for(M=0;M<W;ge++,M++)ge===O[0]&&(ge++,O.shift()),Y[M]=v[ge];return Y},JL={parseSei:Xj,parseUserData:Kj,parseCaptionPackets:Yj,discardEmulationPreventionBytes:Zj,USER_DATA_REGISTERED_ITU_T_T35:QL},aA=s,sE=JL,ba=function(v){v=v||{},ba.prototype.init.call(this),this.parse708captions_=typeof v.parse708captions=="boolean"?v.parse708captions:!0,this.captionPackets_=[],this.ccStreams_=[new on(0,0),new on(0,1),new on(1,0),new on(1,1)],this.parse708captions_&&(this.cc708Stream_=new $s({captionServices:v.captionServices})),this.reset(),this.ccStreams_.forEach(function(N){N.on("data",this.trigger.bind(this,"data")),N.on("partialdone",this.trigger.bind(this,"partialdone")),N.on("done",this.trigger.bind(this,"done"))},this),this.parse708captions_&&(this.cc708Stream_.on("data",this.trigger.bind(this,"data")),this.cc708Stream_.on("partialdone",this.trigger.bind(this,"partialdone")),this.cc708Stream_.on("done",this.trigger.bind(this,"done")))};ba.prototype=new aA,ba.prototype.push=function(v){var N,O,M;if(v.nalUnitType==="sei_rbsp"&&(N=sE.parseSei(v.escapedRBSP),!!N.payload&&N.payloadType===sE.USER_DATA_REGISTERED_ITU_T_T35&&(O=sE.parseUserData(N),!!O))){if(v.dts<this.latestDts_){this.ignoreNextEqualDts_=!0;return}else if(v.dts===this.latestDts_&&this.ignoreNextEqualDts_){this.numSameDts_--,this.numSameDts_||(this.ignoreNextEqualDts_=!1);return}M=sE.parseCaptionPackets(v.pts,O),this.captionPackets_=this.captionPackets_.concat(M),this.latestDts_!==v.dts&&(this.numSameDts_=0),this.numSameDts_++,this.latestDts_=v.dts}},ba.prototype.flushCCStreams=function(v){this.ccStreams_.forEach(function(N){return v==="flush"?N.flush():N.partialFlush()},this)},ba.prototype.flushStream=function(v){if(!this.captionPackets_.length){this.flushCCStreams(v);return}this.captionPackets_.forEach(function(N,O){N.presortIndex=O}),this.captionPackets_.sort(function(N,O){return N.pts===O.pts?N.presortIndex-O.presortIndex:N.pts-O.pts}),this.captionPackets_.forEach(function(N){N.type<2?this.dispatchCea608Packet(N):this.dispatchCea708Packet(N)},this),this.captionPackets_.length=0,this.flushCCStreams(v)},ba.prototype.flush=function(){return this.flushStream("flush")},ba.prototype.partialFlush=function(){return this.flushStream("partialFlush")},ba.prototype.reset=function(){this.latestDts_=null,this.ignoreNextEqualDts_=!1,this.numSameDts_=0,this.activeCea608Channel_=[null,null],this.ccStreams_.forEach(function(v){v.reset()})},ba.prototype.dispatchCea608Packet=function(v){this.setsTextOrXDSActive(v)?this.activeCea608Channel_[v.type]=null:this.setsChannel1Active(v)?this.activeCea608Channel_[v.type]=0:this.setsChannel2Active(v)&&(this.activeCea608Channel_[v.type]=1),this.activeCea608Channel_[v.type]!==null&&this.ccStreams_[(v.type<<1)+this.activeCea608Channel_[v.type]].push(v)},ba.prototype.setsChannel1Active=function(v){return(v.ccData&30720)===4096},ba.prototype.setsChannel2Active=function(v){return(v.ccData&30720)===6144},ba.prototype.setsTextOrXDSActive=function(v){return(v.ccData&28928)===256||(v.ccData&30974)===4138||(v.ccData&30974)===6186},ba.prototype.dispatchCea708Packet=function(v){this.parse708captions_&&this.cc708Stream_.push(v)};var Qj={127:9834,4128:32,4129:160,4133:8230,4138:352,4140:338,4144:9608,4145:8216,4146:8217,4147:8220,4148:8221,4149:8226,4153:8482,4154:353,4156:339,4157:8480,4159:376,4214:8539,4215:8540,4216:8541,4217:8542,4218:9168,4219:9124,4220:9123,4221:9135,4222:9126,4223:9121,4256:12600},Jj=function(v){var N=Qj[v]||v;return v&4096&&v===N?"":String.fromCharCode(N)},nE=function(v){return 32<=v&&v<=127||160<=v&&v<=255},Su=function(v){this.windowNum=v,this.reset()};Su.prototype.reset=function(){this.clearText(),this.pendingNewLine=!1,this.winAttr={},this.penAttr={},this.penLoc={},this.penColor={},this.visible=0,this.rowLock=0,this.columnLock=0,this.priority=0,this.relativePositioning=0,this.anchorVertical=0,this.anchorHorizontal=0,this.anchorPoint=0,this.rowCount=1,this.virtualRowCount=this.rowCount+1,this.columnCount=41,this.windowStyle=0,this.penStyle=0},Su.prototype.getText=function(){return this.rows.join(`
`)},Su.prototype.clearText=function(){this.rows=[""],this.rowIdx=0},Su.prototype.newLine=function(v){for(this.rows.length>=this.virtualRowCount&&typeof this.beforeRowOverflow=="function"&&this.beforeRowOverflow(v),this.rows.length>0&&(this.rows.push(""),this.rowIdx++);this.rows.length>this.virtualRowCount;)this.rows.shift(),this.rowIdx--},Su.prototype.isEmpty=function(){return this.rows.length===0?!0:this.rows.length===1?this.rows[0]==="":!1},Su.prototype.addText=function(v){this.rows[this.rowIdx]+=v},Su.prototype.backspace=function(){if(!this.isEmpty()){var v=this.rows[this.rowIdx];this.rows[this.rowIdx]=v.substr(0,v.length-1)}};var rE=function(v,N,O){this.serviceNum=v,this.text="",this.currentWindow=new Su(-1),this.windows=[],this.stream=O,typeof N=="string"&&this.createTextDecoder(N)};rE.prototype.init=function(v,N){this.startPts=v;for(var O=0;O<8;O++)this.windows[O]=new Su(O),typeof N=="function"&&(this.windows[O].beforeRowOverflow=N)},rE.prototype.setCurrentWindow=function(v){this.currentWindow=this.windows[v]},rE.prototype.createTextDecoder=function(v){if(typeof TextDecoder>"u")this.stream.trigger("log",{level:"warn",message:"The `encoding` option is unsupported without TextDecoder support"});else try{this.textDecoder_=new TextDecoder(v)}catch(N){this.stream.trigger("log",{level:"warn",message:"TextDecoder could not be created with "+v+" encoding. "+N})}};var $s=function(v){v=v||{},$s.prototype.init.call(this);var N=this,O=v.captionServices||{},M={},W;Object.keys(O).forEach(Y=>{W=O[Y],/^SERVICE/.test(Y)&&(M[Y]=W.encoding)}),this.serviceEncodings=M,this.current708Packet=null,this.services={},this.push=function(Y){Y.type===3?(N.new708Packet(),N.add708Bytes(Y)):(N.current708Packet===null&&N.new708Packet(),N.add708Bytes(Y))}};$s.prototype=new aA,$s.prototype.new708Packet=function(){this.current708Packet!==null&&this.push708Packet(),this.current708Packet={data:[],ptsVals:[]}},$s.prototype.add708Bytes=function(v){var N=v.ccData,O=N>>>8,M=N&255;this.current708Packet.ptsVals.push(v.pts),this.current708Packet.data.push(O),this.current708Packet.data.push(M)},$s.prototype.push708Packet=function(){var v=this.current708Packet,N=v.data,O=null,M=null,W=0,Y=N[W++];for(v.seq=Y>>6,v.sizeCode=Y&63;W<N.length;W++)Y=N[W++],O=Y>>5,M=Y&31,O===7&&M>0&&(Y=N[W++],O=Y),this.pushServiceBlock(O,W,M),M>0&&(W+=M-1)},$s.prototype.pushServiceBlock=function(v,N,O){var M,W=N,Y=this.current708Packet.data,ge=this.services[v];for(ge||(ge=this.initService(v,W));W<N+O&&W<Y.length;W++)M=Y[W],nE(M)?W=this.handleText(W,ge):M===24?W=this.multiByteCharacter(W,ge):M===16?W=this.extendedCommands(W,ge):128<=M&&M<=135?W=this.setCurrentWindow(W,ge):152<=M&&M<=159?W=this.defineWindow(W,ge):M===136?W=this.clearWindows(W,ge):M===140?W=this.deleteWindows(W,ge):M===137?W=this.displayWindows(W,ge):M===138?W=this.hideWindows(W,ge):M===139?W=this.toggleWindows(W,ge):M===151?W=this.setWindowAttributes(W,ge):M===144?W=this.setPenAttributes(W,ge):M===145?W=this.setPenColor(W,ge):M===146?W=this.setPenLocation(W,ge):M===143?ge=this.reset(W,ge):M===8?ge.currentWindow.backspace():M===12?ge.currentWindow.clearText():M===13?ge.currentWindow.pendingNewLine=!0:M===14?ge.currentWindow.clearText():M===141&&W++},$s.prototype.extendedCommands=function(v,N){var O=this.current708Packet.data,M=O[++v];return nE(M)&&(v=this.handleText(v,N,{isExtended:!0})),v},$s.prototype.getPts=function(v){return this.current708Packet.ptsVals[Math.floor(v/2)]},$s.prototype.initService=function(v,N){var M="SERVICE"+v,O=this,M,W;return M in this.serviceEncodings&&(W=this.serviceEncodings[M]),this.services[v]=new rE(v,W,O),this.services[v].init(this.getPts(N),function(Y){O.flushDisplayed(Y,O.services[v])}),this.services[v]},$s.prototype.handleText=function(v,N,O){var M=O&&O.isExtended,W=O&&O.isMultiByte,Y=this.current708Packet.data,ge=M?4096:0,_e=Y[v],ve=Y[v+1],xe=N.currentWindow,Ue,ut;function Ft(bt){return bt.map(pi=>("0"+(pi&255).toString(16)).slice(-2)).join("")}if(W?(ut=[_e,ve],v++):ut=[_e],N.textDecoder_&&!M)Ue=N.textDecoder_.decode(new Uint8Array(ut));else if(W){const bt=Ft(ut);Ue=String.fromCharCode(parseInt(bt,16))}else Ue=Jj(ge|_e);return xe.pendingNewLine&&!xe.isEmpty()&&xe.newLine(this.getPts(v)),xe.pendingNewLine=!1,xe.addText(Ue),v},$s.prototype.multiByteCharacter=function(v,N){var O=this.current708Packet.data,M=O[v+1],W=O[v+2];return nE(M)&&nE(W)&&(v=this.handleText(++v,N,{isMultiByte:!0})),v},$s.prototype.setCurrentWindow=function(v,N){var O=this.current708Packet.data,M=O[v],W=M&7;return N.setCurrentWindow(W),v},$s.prototype.defineWindow=function(v,N){var O=this.current708Packet.data,M=O[v],W=M&7;N.setCurrentWindow(W);var Y=N.currentWindow;return M=O[++v],Y.visible=(M&32)>>5,Y.rowLock=(M&16)>>4,Y.columnLock=(M&8)>>3,Y.priority=M&7,M=O[++v],Y.relativePositioning=(M&128)>>7,Y.anchorVertical=M&127,M=O[++v],Y.anchorHorizontal=M,M=O[++v],Y.anchorPoint=(M&240)>>4,Y.rowCount=M&15,M=O[++v],Y.columnCount=M&63,M=O[++v],Y.windowStyle=(M&56)>>3,Y.penStyle=M&7,Y.virtualRowCount=Y.rowCount+1,v},$s.prototype.setWindowAttributes=function(v,N){var O=this.current708Packet.data,M=O[v],W=N.currentWindow.winAttr;return M=O[++v],W.fillOpacity=(M&192)>>6,W.fillRed=(M&48)>>4,W.fillGreen=(M&12)>>2,W.fillBlue=M&3,M=O[++v],W.borderType=(M&192)>>6,W.borderRed=(M&48)>>4,W.borderGreen=(M&12)>>2,W.borderBlue=M&3,M=O[++v],W.borderType+=(M&128)>>5,W.wordWrap=(M&64)>>6,W.printDirection=(M&48)>>4,W.scrollDirection=(M&12)>>2,W.justify=M&3,M=O[++v],W.effectSpeed=(M&240)>>4,W.effectDirection=(M&12)>>2,W.displayEffect=M&3,v},$s.prototype.flushDisplayed=function(v,N){for(var O=[],M=0;M<8;M++)N.windows[M].visible&&!N.windows[M].isEmpty()&&O.push(N.windows[M].getText());N.endPts=v,N.text=O.join(`

`),this.pushCaption(N),N.startPts=v},$s.prototype.pushCaption=function(v){v.text!==""&&(this.trigger("data",{startPts:v.startPts,endPts:v.endPts,text:v.text,stream:"cc708_"+v.serviceNum}),v.text="",v.startPts=v.endPts)},$s.prototype.displayWindows=function(v,N){var O=this.current708Packet.data,M=O[++v],W=this.getPts(v);this.flushDisplayed(W,N);for(var Y=0;Y<8;Y++)M&1<<Y&&(N.windows[Y].visible=1);return v},$s.prototype.hideWindows=function(v,N){var O=this.current708Packet.data,M=O[++v],W=this.getPts(v);this.flushDisplayed(W,N);for(var Y=0;Y<8;Y++)M&1<<Y&&(N.windows[Y].visible=0);return v},$s.prototype.toggleWindows=function(v,N){var O=this.current708Packet.data,M=O[++v],W=this.getPts(v);this.flushDisplayed(W,N);for(var Y=0;Y<8;Y++)M&1<<Y&&(N.windows[Y].visible^=1);return v},$s.prototype.clearWindows=function(v,N){var O=this.current708Packet.data,M=O[++v],W=this.getPts(v);this.flushDisplayed(W,N);for(var Y=0;Y<8;Y++)M&1<<Y&&N.windows[Y].clearText();return v},$s.prototype.deleteWindows=function(v,N){var O=this.current708Packet.data,M=O[++v],W=this.getPts(v);this.flushDisplayed(W,N);for(var Y=0;Y<8;Y++)M&1<<Y&&N.windows[Y].reset();return v},$s.prototype.setPenAttributes=function(v,N){var O=this.current708Packet.data,M=O[v],W=N.currentWindow.penAttr;return M=O[++v],W.textTag=(M&240)>>4,W.offset=(M&12)>>2,W.penSize=M&3,M=O[++v],W.italics=(M&128)>>7,W.underline=(M&64)>>6,W.edgeType=(M&56)>>3,W.fontStyle=M&7,v},$s.prototype.setPenColor=function(v,N){var O=this.current708Packet.data,M=O[v],W=N.currentWindow.penColor;return M=O[++v],W.fgOpacity=(M&192)>>6,W.fgRed=(M&48)>>4,W.fgGreen=(M&12)>>2,W.fgBlue=M&3,M=O[++v],W.bgOpacity=(M&192)>>6,W.bgRed=(M&48)>>4,W.bgGreen=(M&12)>>2,W.bgBlue=M&3,M=O[++v],W.edgeRed=(M&48)>>4,W.edgeGreen=(M&12)>>2,W.edgeBlue=M&3,v},$s.prototype.setPenLocation=function(v,N){var O=this.current708Packet.data,M=O[v],W=N.currentWindow.penLoc;return N.currentWindow.pendingNewLine=!0,M=O[++v],W.row=M&15,M=O[++v],W.column=M&63,v},$s.prototype.reset=function(v,N){var O=this.getPts(v);return this.flushDisplayed(O,N),this.initService(N.serviceNum,v)};var eH={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,304:174,305:176,306:189,307:191,308:8482,309:162,310:163,311:9834,312:224,313:160,314:232,315:226,316:234,317:238,318:244,319:251,544:193,545:201,546:211,547:218,548:220,549:252,550:8216,551:161,552:42,553:39,554:8212,555:169,556:8480,557:8226,558:8220,559:8221,560:192,561:194,562:199,563:200,564:202,565:203,566:235,567:206,568:207,569:239,570:212,571:217,572:249,573:219,574:171,575:187,800:195,801:227,802:205,803:204,804:236,805:210,806:242,807:213,808:245,809:123,810:125,811:92,812:94,813:95,814:124,815:126,816:196,817:228,818:214,819:246,820:223,821:165,822:164,823:9474,824:197,825:229,826:216,827:248,828:9484,829:9488,830:9492,831:9496},aE=function(v){return v===null?"":(v=eH[v]||v,String.fromCharCode(v))},oE=14,tH=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152],Zd=function(){for(var v=[],N=oE+1;N--;)v.push({text:"",indent:0,offset:0});return v},on=function(v,N){on.prototype.init.call(this),this.field_=v||0,this.dataChannel_=N||0,this.name_="CC"+((this.field_<<1|this.dataChannel_)+1),this.setConstants(),this.reset(),this.push=function(O){var M,W,Y,ge,_e;if(M=O.ccData&32639,M===this.lastControlCode_){this.lastControlCode_=null;return}if((M&61440)===4096?this.lastControlCode_=M:M!==this.PADDING_&&(this.lastControlCode_=null),Y=M>>>8,ge=M&255,M!==this.PADDING_)if(M===this.RESUME_CAPTION_LOADING_)this.mode_="popOn";else if(M===this.END_OF_CAPTION_)this.mode_="popOn",this.clearFormatting(O.pts),this.flushDisplayed(O.pts),W=this.displayed_,this.displayed_=this.nonDisplayed_,this.nonDisplayed_=W,this.startPts_=O.pts;else if(M===this.ROLL_UP_2_ROWS_)this.rollUpRows_=2,this.setRollUp(O.pts);else if(M===this.ROLL_UP_3_ROWS_)this.rollUpRows_=3,this.setRollUp(O.pts);else if(M===this.ROLL_UP_4_ROWS_)this.rollUpRows_=4,this.setRollUp(O.pts);else if(M===this.CARRIAGE_RETURN_)this.clearFormatting(O.pts),this.flushDisplayed(O.pts),this.shiftRowsUp_(),this.startPts_=O.pts;else if(M===this.BACKSPACE_)this.mode_==="popOn"?this.nonDisplayed_[this.row_].text=this.nonDisplayed_[this.row_].text.slice(0,-1):this.displayed_[this.row_].text=this.displayed_[this.row_].text.slice(0,-1);else if(M===this.ERASE_DISPLAYED_MEMORY_)this.flushDisplayed(O.pts),this.displayed_=Zd();else if(M===this.ERASE_NON_DISPLAYED_MEMORY_)this.nonDisplayed_=Zd();else if(M===this.RESUME_DIRECT_CAPTIONING_)this.mode_!=="paintOn"&&(this.flushDisplayed(O.pts),this.displayed_=Zd()),this.mode_="paintOn",this.startPts_=O.pts;else if(this.isSpecialCharacter(Y,ge))Y=(Y&3)<<8,_e=aE(Y|ge),this[this.mode_](O.pts,_e),this.column_++;else if(this.isExtCharacter(Y,ge))this.mode_==="popOn"?this.nonDisplayed_[this.row_].text=this.nonDisplayed_[this.row_].text.slice(0,-1):this.displayed_[this.row_].text=this.displayed_[this.row_].text.slice(0,-1),Y=(Y&3)<<8,_e=aE(Y|ge),this[this.mode_](O.pts,_e),this.column_++;else if(this.isMidRowCode(Y,ge))this.clearFormatting(O.pts),this[this.mode_](O.pts," "),this.column_++,(ge&14)===14&&this.addFormatting(O.pts,["i"]),(ge&1)===1&&this.addFormatting(O.pts,["u"]);else if(this.isOffsetControlCode(Y,ge)){const xe=ge&3;this.nonDisplayed_[this.row_].offset=xe,this.column_+=xe}else if(this.isPAC(Y,ge)){var ve=tH.indexOf(M&7968);if(this.mode_==="rollUp"&&(ve-this.rollUpRows_+1<0&&(ve=this.rollUpRows_-1),this.setRollUp(O.pts,ve)),ve!==this.row_&&ve>=0&&ve<=14&&(this.clearFormatting(O.pts),this.row_=ve),ge&1&&this.formatting_.indexOf("u")===-1&&this.addFormatting(O.pts,["u"]),(M&16)===16){const xe=(M&14)>>1;this.column_=xe*4,this.nonDisplayed_[this.row_].indent+=xe}this.isColorPAC(ge)&&(ge&14)===14&&this.addFormatting(O.pts,["i"])}else this.isNormalChar(Y)&&(ge===0&&(ge=null),_e=aE(Y),_e+=aE(ge),this[this.mode_](O.pts,_e),this.column_+=_e.length)}};on.prototype=new aA,on.prototype.flushDisplayed=function(v){const N=M=>{this.trigger("log",{level:"warn",message:"Skipping a malformed 608 caption at index "+M+"."})},O=[];this.displayed_.forEach((M,W)=>{if(M&&M.text&&M.text.length){try{M.text=M.text.trim()}catch{N(W)}M.text.length&&O.push({text:M.text,line:W+1,position:10+Math.min(70,M.indent*10)+M.offset*2.5})}else M==null&&N(W)}),O.length&&this.trigger("data",{startPts:this.startPts_,endPts:v,content:O,stream:this.name_})},on.prototype.reset=function(){this.mode_="popOn",this.topRow_=0,this.startPts_=0,this.displayed_=Zd(),this.nonDisplayed_=Zd(),this.lastControlCode_=null,this.column_=0,this.row_=oE,this.rollUpRows_=2,this.formatting_=[]},on.prototype.setConstants=function(){this.dataChannel_===0?(this.BASE_=16,this.EXT_=17,this.CONTROL_=(20|this.field_)<<8,this.OFFSET_=23):this.dataChannel_===1&&(this.BASE_=24,this.EXT_=25,this.CONTROL_=(28|this.field_)<<8,this.OFFSET_=31),this.PADDING_=0,this.RESUME_CAPTION_LOADING_=this.CONTROL_|32,this.END_OF_CAPTION_=this.CONTROL_|47,this.ROLL_UP_2_ROWS_=this.CONTROL_|37,this.ROLL_UP_3_ROWS_=this.CONTROL_|38,this.ROLL_UP_4_ROWS_=this.CONTROL_|39,this.CARRIAGE_RETURN_=this.CONTROL_|45,this.RESUME_DIRECT_CAPTIONING_=this.CONTROL_|41,this.BACKSPACE_=this.CONTROL_|33,this.ERASE_DISPLAYED_MEMORY_=this.CONTROL_|44,this.ERASE_NON_DISPLAYED_MEMORY_=this.CONTROL_|46},on.prototype.isSpecialCharacter=function(v,N){return v===this.EXT_&&N>=48&&N<=63},on.prototype.isExtCharacter=function(v,N){return(v===this.EXT_+1||v===this.EXT_+2)&&N>=32&&N<=63},on.prototype.isMidRowCode=function(v,N){return v===this.EXT_&&N>=32&&N<=47},on.prototype.isOffsetControlCode=function(v,N){return v===this.OFFSET_&&N>=33&&N<=35},on.prototype.isPAC=function(v,N){return v>=this.BASE_&&v<this.BASE_+8&&N>=64&&N<=127},on.prototype.isColorPAC=function(v){return v>=64&&v<=79||v>=96&&v<=127},on.prototype.isNormalChar=function(v){return v>=32&&v<=127},on.prototype.setRollUp=function(v,N){if(this.mode_!=="rollUp"&&(this.row_=oE,this.mode_="rollUp",this.flushDisplayed(v),this.nonDisplayed_=Zd(),this.displayed_=Zd()),N!==void 0&&N!==this.row_)for(var O=0;O<this.rollUpRows_;O++)this.displayed_[N-O]=this.displayed_[this.row_-O],this.displayed_[this.row_-O]={text:"",indent:0,offset:0};N===void 0&&(N=this.row_),this.topRow_=N-this.rollUpRows_+1},on.prototype.addFormatting=function(v,N){this.formatting_=this.formatting_.concat(N);var O=N.reduce(function(M,W){return M+"<"+W+">"},"");this[this.mode_](v,O)},on.prototype.clearFormatting=function(v){if(this.formatting_.length){var N=this.formatting_.reverse().reduce(function(O,M){return O+"</"+M+">"},"");this.formatting_=[],this[this.mode_](v,N)}},on.prototype.popOn=function(v,N){var O=this.nonDisplayed_[this.row_].text;O+=N,this.nonDisplayed_[this.row_].text=O},on.prototype.rollUp=function(v,N){var O=this.displayed_[this.row_].text;O+=N,this.displayed_[this.row_].text=O},on.prototype.shiftRowsUp_=function(){var v;for(v=0;v<this.topRow_;v++)this.displayed_[v]={text:"",indent:0,offset:0};for(v=this.row_+1;v<oE+1;v++)this.displayed_[v]={text:"",indent:0,offset:0};for(v=this.topRow_;v<this.row_;v++)this.displayed_[v]=this.displayed_[v+1];this.displayed_[this.row_]={text:"",indent:0,offset:0}},on.prototype.paintOn=function(v,N){var O=this.displayed_[this.row_].text;O+=N,this.displayed_[this.row_].text=O};var eN={CaptionStream:ba,Cea608Stream:on,Cea708Stream:$s},lE={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21},iH=s,sH=8589934592,nH=4294967296,tN="shared",oA=function(v,N){var O=1;for(v>N&&(O=-1);Math.abs(N-v)>nH;)v+=O*sH;return v},lA=function(v){var N,O;lA.prototype.init.call(this),this.type_=v||tN,this.push=function(M){if(M.type==="metadata"){this.trigger("data",M);return}this.type_!==tN&&M.type!==this.type_||(O===void 0&&(O=M.dts),M.dts=oA(M.dts,O),M.pts=oA(M.pts,O),N=M.dts,this.trigger("data",M))},this.flush=function(){O=N,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.discontinuity=function(){O=void 0,N=void 0},this.reset=function(){this.discontinuity(),this.trigger("reset")}};lA.prototype=new iH;var iN={TimestampRolloverStream:lA,handleRollover:oA},rH=(v,N,O)=>{if(!v)return-1;for(var M=O;M<v.length;M++)if(v[M]===N)return M;return-1},aH={typedArrayIndexOf:rH},uE=aH.typedArrayIndexOf,hE={Utf8:3},sN=function(v,N,O){var M,W="";for(M=N;M<O;M++)W+="%"+("00"+v[M].toString(16)).slice(-2);return W},Y_=function(v,N,O){return decodeURIComponent(sN(v,N,O))},Z_=function(v,N,O){return unescape(sN(v,N,O))},Q_=function(v){return v[0]<<21|v[1]<<14|v[2]<<7|v[3]},J_={APIC:function(v){var N=1,O,M,W="-->";v.data[0]===hE.Utf8&&(O=uE(v.data,0,N),!(O<0)&&(v.mimeType=Z_(v.data,N,O),N=O+1,v.pictureType=v.data[N],N++,M=uE(v.data,0,N),!(M<0)&&(v.description=Y_(v.data,N,M),N=M+1,v.mimeType===W?v.url=Z_(v.data,N,v.data.length):v.pictureData=v.data.subarray(N,v.data.length))))},"T*":function(v){v.data[0]===hE.Utf8&&(v.value=Y_(v.data,1,v.data.length).replace(/\0*$/,""),v.values=v.value.split("\0"))},TXXX:function(v){var N;v.data[0]===hE.Utf8&&(N=uE(v.data,0,1),N!==-1&&(v.description=Y_(v.data,1,N),v.value=Y_(v.data,N+1,v.data.length).replace(/\0*$/,""),v.data=v.value))},"W*":function(v){v.url=Z_(v.data,0,v.data.length).replace(/\0.*$/,"")},WXXX:function(v){var N;v.data[0]===hE.Utf8&&(N=uE(v.data,0,1),N!==-1&&(v.description=Y_(v.data,1,N),v.url=Z_(v.data,N+1,v.data.length).replace(/\0.*$/,"")))},PRIV:function(v){var N;for(N=0;N<v.data.length;N++)if(v.data[N]===0){v.owner=Z_(v.data,0,N);break}v.privateData=v.data.subarray(N+1),v.data=v.privateData}},oH=function(v){var N,O,M=10,W=0,Y=[];if(!(v.length<10||v[0]!==73||v[1]!==68||v[2]!==51)){W=Q_(v.subarray(6,10)),W+=10;var ge=v[5]&64;ge&&(M+=4,M+=Q_(v.subarray(10,14)),W-=Q_(v.subarray(16,20)));do{if(N=Q_(v.subarray(M+4,M+8)),N<1)break;O=String.fromCharCode(v[M],v[M+1],v[M+2],v[M+3]);var _e={id:O,data:v.subarray(M+10,M+N+10)};_e.key=_e.id,J_[_e.id]?J_[_e.id](_e):_e.id[0]==="T"?J_["T*"](_e):_e.id[0]==="W"&&J_["W*"](_e),Y.push(_e),M+=10,M+=N}while(M<W);return Y}},nN={parseId3Frames:oH,parseSyncSafeInteger:Q_,frameParsers:J_},lH=s,uH=lE,ec=nN,cE;cE=function(v){var N={descriptor:v&&v.descriptor},O=0,M=[],W=0,Y;if(cE.prototype.init.call(this),this.dispatchType=uH.METADATA_STREAM_TYPE.toString(16),N.descriptor)for(Y=0;Y<N.descriptor.length;Y++)this.dispatchType+=("00"+N.descriptor[Y].toString(16)).slice(-2);this.push=function(ge){var _e,ve,xe,Ue,ut,Ft;if(ge.type==="timed-metadata"){if(ge.dataAlignmentIndicator&&(W=0,M.length=0),M.length===0&&(ge.data.length<10||ge.data[0]!==73||ge.data[1]!==68||ge.data[2]!==51)){this.trigger("log",{level:"warn",message:"Skipping unrecognized metadata packet"});return}if(M.push(ge),W+=ge.data.byteLength,M.length===1&&(O=ec.parseSyncSafeInteger(ge.data.subarray(6,10)),O+=10),!(W<O)){for(_e={data:new Uint8Array(O),frames:[],pts:M[0].pts,dts:M[0].dts},ut=0;ut<O;)_e.data.set(M[0].data.subarray(0,O-ut),ut),ut+=M[0].data.byteLength,W-=M[0].data.byteLength,M.shift();ve=10,_e.data[5]&64&&(ve+=4,ve+=ec.parseSyncSafeInteger(_e.data.subarray(10,14)),O-=ec.parseSyncSafeInteger(_e.data.subarray(16,20)));do{if(xe=ec.parseSyncSafeInteger(_e.data.subarray(ve+4,ve+8)),xe<1){this.trigger("log",{level:"warn",message:"Malformed ID3 frame encountered. Skipping remaining metadata parsing."});break}if(Ft=String.fromCharCode(_e.data[ve],_e.data[ve+1],_e.data[ve+2],_e.data[ve+3]),Ue={id:Ft,data:_e.data.subarray(ve+10,ve+xe+10)},Ue.key=Ue.id,ec.frameParsers[Ue.id]?ec.frameParsers[Ue.id](Ue):Ue.id[0]==="T"?ec.frameParsers["T*"](Ue):Ue.id[0]==="W"&&ec.frameParsers["W*"](Ue),Ue.owner==="com.apple.streaming.transportStreamTimestamp"){var bt=Ue.data,pi=(bt[3]&1)<<30|bt[4]<<22|bt[5]<<14|bt[6]<<6|bt[7]>>>2;pi*=4,pi+=bt[7]&3,Ue.timeStamp=pi,_e.pts===void 0&&_e.dts===void 0&&(_e.pts=Ue.timeStamp,_e.dts=Ue.timeStamp),this.trigger("timestamp",Ue)}_e.frames.push(Ue),ve+=10,ve+=xe}while(ve<O);this.trigger("data",_e)}}}},cE.prototype=new lH;var hH=cE,uA=s,hA=eN,jo=lE,cH=iN.TimestampRolloverStream,dE,eb,fE,Vg=188,cA=71;dE=function(){var v=new Uint8Array(Vg),N=0;dE.prototype.init.call(this),this.push=function(O){var M=0,W=Vg,Y;for(N?(Y=new Uint8Array(O.byteLength+N),Y.set(v.subarray(0,N)),Y.set(O,N),N=0):Y=O;W<Y.byteLength;){if(Y[M]===cA&&Y[W]===cA){this.trigger("data",Y.subarray(M,W)),M+=Vg,W+=Vg;continue}M++,W++}M<Y.byteLength&&(v.set(Y.subarray(M),0),N=Y.byteLength-M)},this.flush=function(){N===Vg&&v[0]===cA&&(this.trigger("data",v),N=0),this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.reset=function(){N=0,this.trigger("reset")}},dE.prototype=new uA,eb=function(){var v,N,O,M;eb.prototype.init.call(this),M=this,this.packetsWaitingForPmt=[],this.programMapTable=void 0,v=function(W,Y){var ge=0;Y.payloadUnitStartIndicator&&(ge+=W[ge]+1),Y.type==="pat"?N(W.subarray(ge),Y):O(W.subarray(ge),Y)},N=function(W,Y){Y.section_number=W[7],Y.last_section_number=W[8],M.pmtPid=(W[10]&31)<<8|W[11],Y.pmtPid=M.pmtPid},O=function(W,Y){var ge,_e,ve,xe;if(W[5]&1){for(M.programMapTable={video:null,audio:null,"timed-metadata":{}},ge=(W[1]&15)<<8|W[2],_e=3+ge-4,ve=(W[10]&15)<<8|W[11],xe=12+ve;xe<_e;){var Ue=W[xe],ut=(W[xe+1]&31)<<8|W[xe+2];Ue===jo.H264_STREAM_TYPE&&M.programMapTable.video===null?M.programMapTable.video=ut:Ue===jo.ADTS_STREAM_TYPE&&M.programMapTable.audio===null?M.programMapTable.audio=ut:Ue===jo.METADATA_STREAM_TYPE&&(M.programMapTable["timed-metadata"][ut]=Ue),xe+=((W[xe+3]&15)<<8|W[xe+4])+5}Y.programMapTable=M.programMapTable}},this.push=function(W){var Y={},ge=4;if(Y.payloadUnitStartIndicator=!!(W[1]&64),Y.pid=W[1]&31,Y.pid<<=8,Y.pid|=W[2],(W[3]&48)>>>4>1&&(ge+=W[ge]+1),Y.pid===0)Y.type="pat",v(W.subarray(ge),Y),this.trigger("data",Y);else if(Y.pid===this.pmtPid)for(Y.type="pmt",v(W.subarray(ge),Y),this.trigger("data",Y);this.packetsWaitingForPmt.length;)this.processPes_.apply(this,this.packetsWaitingForPmt.shift());else this.programMapTable===void 0?this.packetsWaitingForPmt.push([W,ge,Y]):this.processPes_(W,ge,Y)},this.processPes_=function(W,Y,ge){ge.pid===this.programMapTable.video?ge.streamType=jo.H264_STREAM_TYPE:ge.pid===this.programMapTable.audio?ge.streamType=jo.ADTS_STREAM_TYPE:ge.streamType=this.programMapTable["timed-metadata"][ge.pid],ge.type="pes",ge.data=W.subarray(Y),this.trigger("data",ge)}},eb.prototype=new uA,eb.STREAM_TYPES={h264:27,adts:15},fE=function(){var v=this,N=!1,O={data:[],size:0},M={data:[],size:0},W={data:[],size:0},Y,ge=function(ve,xe){var Ue;const ut=ve[0]<<16|ve[1]<<8|ve[2];xe.data=new Uint8Array,ut===1&&(xe.packetLength=6+(ve[4]<<8|ve[5]),xe.dataAlignmentIndicator=(ve[6]&4)!==0,Ue=ve[7],Ue&192&&(xe.pts=(ve[9]&14)<<27|(ve[10]&255)<<20|(ve[11]&254)<<12|(ve[12]&255)<<5|(ve[13]&254)>>>3,xe.pts*=4,xe.pts+=(ve[13]&6)>>>1,xe.dts=xe.pts,Ue&64&&(xe.dts=(ve[14]&14)<<27|(ve[15]&255)<<20|(ve[16]&254)<<12|(ve[17]&255)<<5|(ve[18]&254)>>>3,xe.dts*=4,xe.dts+=(ve[18]&6)>>>1)),xe.data=ve.subarray(9+ve[8]))},_e=function(ve,xe,Ue){var ut=new Uint8Array(ve.size),Ft={type:xe},bt=0,pi=0,Hi=!1,cr;if(!(!ve.data.length||ve.size<9)){for(Ft.trackId=ve.data[0].pid,bt=0;bt<ve.data.length;bt++)cr=ve.data[bt],ut.set(cr.data,pi),pi+=cr.data.byteLength;ge(ut,Ft),Hi=xe==="video"||Ft.packetLength<=ve.size,(Ue||Hi)&&(ve.size=0,ve.data.length=0),Hi&&v.trigger("data",Ft)}};fE.prototype.init.call(this),this.push=function(ve){({pat:function(){},pes:function(){var xe,Ue;switch(ve.streamType){case jo.H264_STREAM_TYPE:xe=O,Ue="video";break;case jo.ADTS_STREAM_TYPE:xe=M,Ue="audio";break;case jo.METADATA_STREAM_TYPE:xe=W,Ue="timed-metadata";break;default:return}ve.payloadUnitStartIndicator&&_e(xe,Ue,!0),xe.data.push(ve),xe.size+=ve.data.byteLength},pmt:function(){var xe={type:"metadata",tracks:[]};Y=ve.programMapTable,Y.video!==null&&xe.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+Y.video,codec:"avc",type:"video"}),Y.audio!==null&&xe.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+Y.audio,codec:"adts",type:"audio"}),N=!0,v.trigger("data",xe)}})[ve.type]()},this.reset=function(){O.size=0,O.data.length=0,M.size=0,M.data.length=0,this.trigger("reset")},this.flushStreams_=function(){_e(O,"video"),_e(M,"audio"),_e(W,"timed-metadata")},this.flush=function(){if(!N&&Y){var ve={type:"metadata",tracks:[]};Y.video!==null&&ve.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+Y.video,codec:"avc",type:"video"}),Y.audio!==null&&ve.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+Y.audio,codec:"adts",type:"audio"}),v.trigger("data",ve)}N=!1,this.flushStreams_(),this.trigger("done")}},fE.prototype=new uA;var rN={PAT_PID:0,MP2T_PACKET_LENGTH:Vg,TransportPacketStream:dE,TransportParseStream:eb,ElementaryStream:fE,TimestampRolloverStream:cH,CaptionStream:hA.CaptionStream,Cea608Stream:hA.Cea608Stream,Cea708Stream:hA.Cea708Stream,MetadataStream:hH};for(var dA in jo)jo.hasOwnProperty(dA)&&(rN[dA]=jo[dA]);var dH=rN,fH=s,pH=Js.ONE_SECOND_IN_TS,pE,aN=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];pE=function(v){var N,O=0;pE.prototype.init.call(this),this.skipWarn_=function(M,W){this.trigger("log",{level:"warn",message:`adts skiping bytes ${M} to ${W} in frame ${O} outside syncword`})},this.push=function(M){var W=0,Y,ge,_e,ve,xe;if(v||(O=0),M.type==="audio"){N&&N.length?(_e=N,N=new Uint8Array(_e.byteLength+M.data.byteLength),N.set(_e),N.set(M.data,_e.byteLength)):N=M.data;for(var Ue;W+7<N.length;){if(N[W]!==255||(N[W+1]&246)!==240){typeof Ue!="number"&&(Ue=W),W++;continue}if(typeof Ue=="number"&&(this.skipWarn_(Ue,W),Ue=null),ge=(~N[W+1]&1)*2,Y=(N[W+3]&3)<<11|N[W+4]<<3|(N[W+5]&224)>>5,ve=((N[W+6]&3)+1)*1024,xe=ve*pH/aN[(N[W+2]&60)>>>2],N.byteLength-W<Y)break;this.trigger("data",{pts:M.pts+O*xe,dts:M.dts+O*xe,sampleCount:ve,audioobjecttype:(N[W+2]>>>6&3)+1,channelcount:(N[W+2]&1)<<2|(N[W+3]&192)>>>6,samplerate:aN[(N[W+2]&60)>>>2],samplingfrequencyindex:(N[W+2]&60)>>>2,samplesize:16,data:N.subarray(W+7+ge,W+Y)}),O++,W+=Y}typeof Ue=="number"&&(this.skipWarn_(Ue,W),Ue=null),N=N.subarray(W)}},this.flush=function(){O=0,this.trigger("done")},this.reset=function(){N=void 0,this.trigger("reset")},this.endTimeline=function(){N=void 0,this.trigger("endedtimeline")}},pE.prototype=new fH;var gH=pE,oN;oN=function(v){var N=v.byteLength,O=0,M=0;this.length=function(){return 8*N},this.bitsAvailable=function(){return 8*N+M},this.loadWord=function(){var W=v.byteLength-N,Y=new Uint8Array(4),ge=Math.min(4,N);if(ge===0)throw new Error("no bytes available");Y.set(v.subarray(W,W+ge)),O=new DataView(Y.buffer).getUint32(0),M=ge*8,N-=ge},this.skipBits=function(W){var Y;M>W?(O<<=W,M-=W):(W-=M,Y=Math.floor(W/8),W-=Y*8,N-=Y,this.loadWord(),O<<=W,M-=W)},this.readBits=function(W){var Y=Math.min(M,W),ge=O>>>32-Y;return M-=Y,M>0?O<<=Y:N>0&&this.loadWord(),Y=W-Y,Y>0?ge<<Y|this.readBits(Y):ge},this.skipLeadingZeros=function(){var W;for(W=0;W<M;++W)if((O&2147483648>>>W)!==0)return O<<=W,M-=W,W;return this.loadWord(),W+this.skipLeadingZeros()},this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.readUnsignedExpGolomb=function(){var W=this.skipLeadingZeros();return this.readBits(W+1)-1},this.readExpGolomb=function(){var W=this.readUnsignedExpGolomb();return 1&W?1+W>>>1:-1*(W>>>1)},this.readBoolean=function(){return this.readBits(1)===1},this.readUnsignedByte=function(){return this.readBits(8)},this.loadWord()};var mH=oN,lN=s,_H=mH,gE,mE,uN;mE=function(){var v=0,N,O;mE.prototype.init.call(this),this.push=function(M){var W;O?(W=new Uint8Array(O.byteLength+M.data.byteLength),W.set(O),W.set(M.data,O.byteLength),O=W):O=M.data;for(var Y=O.byteLength;v<Y-3;v++)if(O[v+2]===1){N=v+5;break}for(;N<Y;)switch(O[N]){case 0:if(O[N-1]!==0){N+=2;break}else if(O[N-2]!==0){N++;break}v+3!==N-2&&this.trigger("data",O.subarray(v+3,N-2));do N++;while(O[N]!==1&&N<Y);v=N-2,N+=3;break;case 1:if(O[N-1]!==0||O[N-2]!==0){N+=3;break}this.trigger("data",O.subarray(v+3,N-2)),v=N-2,N+=3;break;default:N+=3;break}O=O.subarray(v),N-=v,v=0},this.reset=function(){O=null,v=0,this.trigger("reset")},this.flush=function(){O&&O.byteLength>3&&this.trigger("data",O.subarray(v+3)),O=null,v=0,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")}},mE.prototype=new lN,uN={100:!0,110:!0,122:!0,244:!0,44:!0,83:!0,86:!0,118:!0,128:!0,138:!0,139:!0,134:!0},gE=function(){var v=new mE,N,O,M,W,Y,ge,_e;gE.prototype.init.call(this),N=this,this.push=function(ve){ve.type==="video"&&(O=ve.trackId,M=ve.pts,W=ve.dts,v.push(ve))},v.on("data",function(ve){var xe={trackId:O,pts:M,dts:W,data:ve,nalUnitTypeCode:ve[0]&31};switch(xe.nalUnitTypeCode){case 5:xe.nalUnitType="slice_layer_without_partitioning_rbsp_idr";break;case 6:xe.nalUnitType="sei_rbsp",xe.escapedRBSP=Y(ve.subarray(1));break;case 7:xe.nalUnitType="seq_parameter_set_rbsp",xe.escapedRBSP=Y(ve.subarray(1)),xe.config=ge(xe.escapedRBSP);break;case 8:xe.nalUnitType="pic_parameter_set_rbsp";break;case 9:xe.nalUnitType="access_unit_delimiter_rbsp";break}N.trigger("data",xe)}),v.on("done",function(){N.trigger("done")}),v.on("partialdone",function(){N.trigger("partialdone")}),v.on("reset",function(){N.trigger("reset")}),v.on("endedtimeline",function(){N.trigger("endedtimeline")}),this.flush=function(){v.flush()},this.partialFlush=function(){v.partialFlush()},this.reset=function(){v.reset()},this.endTimeline=function(){v.endTimeline()},_e=function(ve,xe){var Ue=8,ut=8,Ft,bt;for(Ft=0;Ft<ve;Ft++)ut!==0&&(bt=xe.readExpGolomb(),ut=(Ue+bt+256)%256),Ue=ut===0?Ue:ut},Y=function(ve){for(var xe=ve.byteLength,Ue=[],ut=1,Ft,bt;ut<xe-2;)ve[ut]===0&&ve[ut+1]===0&&ve[ut+2]===3?(Ue.push(ut+2),ut+=2):ut++;if(Ue.length===0)return ve;Ft=xe-Ue.length,bt=new Uint8Array(Ft);var pi=0;for(ut=0;ut<Ft;pi++,ut++)pi===Ue[0]&&(pi++,Ue.shift()),bt[ut]=ve[pi];return bt},ge=function(ve){var xe=0,Ue=0,ut=0,Ft=0,bt,pi,Hi,cr,Ba,ic,ob,lb,ub,hb,kE,en=[1,1],cb,Vo;if(bt=new _H(ve),pi=bt.readUnsignedByte(),cr=bt.readUnsignedByte(),Hi=bt.readUnsignedByte(),bt.skipUnsignedExpGolomb(),uN[pi]&&(Ba=bt.readUnsignedExpGolomb(),Ba===3&&bt.skipBits(1),bt.skipUnsignedExpGolomb(),bt.skipUnsignedExpGolomb(),bt.skipBits(1),bt.readBoolean()))for(kE=Ba!==3?8:12,Vo=0;Vo<kE;Vo++)bt.readBoolean()&&(Vo<6?_e(16,bt):_e(64,bt));if(bt.skipUnsignedExpGolomb(),ic=bt.readUnsignedExpGolomb(),ic===0)bt.readUnsignedExpGolomb();else if(ic===1)for(bt.skipBits(1),bt.skipExpGolomb(),bt.skipExpGolomb(),ob=bt.readUnsignedExpGolomb(),Vo=0;Vo<ob;Vo++)bt.skipExpGolomb();if(bt.skipUnsignedExpGolomb(),bt.skipBits(1),lb=bt.readUnsignedExpGolomb(),ub=bt.readUnsignedExpGolomb(),hb=bt.readBits(1),hb===0&&bt.skipBits(1),bt.skipBits(1),bt.readBoolean()&&(xe=bt.readUnsignedExpGolomb(),Ue=bt.readUnsignedExpGolomb(),ut=bt.readUnsignedExpGolomb(),Ft=bt.readUnsignedExpGolomb()),bt.readBoolean()&&bt.readBoolean()){switch(cb=bt.readUnsignedByte(),cb){case 1:en=[1,1];break;case 2:en=[12,11];break;case 3:en=[10,11];break;case 4:en=[16,11];break;case 5:en=[40,33];break;case 6:en=[24,11];break;case 7:en=[20,11];break;case 8:en=[32,11];break;case 9:en=[80,33];break;case 10:en=[18,11];break;case 11:en=[15,11];break;case 12:en=[64,33];break;case 13:en=[160,99];break;case 14:en=[4,3];break;case 15:en=[3,2];break;case 16:en=[2,1];break;case 255:{en=[bt.readUnsignedByte()<<8|bt.readUnsignedByte(),bt.readUnsignedByte()<<8|bt.readUnsignedByte()];break}}en&&en[0]/en[1]}return{profileIdc:pi,levelIdc:Hi,profileCompatibility:cr,width:(lb+1)*16-xe*2-Ue*2,height:(2-hb)*(ub+1)*16-ut*2-Ft*2,sarRatio:en}}},gE.prototype=new lN;var bH={H264Stream:gE},yH=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],hN=function(v,N){var O=v[N+6]<<21|v[N+7]<<14|v[N+8]<<7|v[N+9],M=v[N+5],W=(M&16)>>4;return O=O>=0?O:0,W?O+20:O+10},cN=function(v,N){return v.length-N<10||v[N]!==73||v[N+1]!==68||v[N+2]!==51?N:(N+=hN(v,N),cN(v,N))},vH=function(v){var N=cN(v,0);return v.length>=N+2&&(v[N]&255)===255&&(v[N+1]&240)===240&&(v[N+1]&22)===16},dN=function(v){return v[0]<<21|v[1]<<14|v[2]<<7|v[3]},wH=function(v,N,O){var M,W="";for(M=N;M<O;M++)W+="%"+("00"+v[M].toString(16)).slice(-2);return W},TH=function(v,N,O){return unescape(wH(v,N,O))},EH=function(v,N){var O=(v[N+5]&224)>>5,M=v[N+4]<<3,W=v[N+3]&6144;return W|M|O},SH=function(v,N){return v[N]===73&&v[N+1]===68&&v[N+2]===51?"timed-metadata":v[N]&!0&&(v[N+1]&240)===240?"audio":null},xH=function(v){for(var N=0;N+5<v.length;){if(v[N]!==255||(v[N+1]&246)!==240){N++;continue}return yH[(v[N+2]&60)>>>2]}return null},AH=function(v){var N,O,M,W;N=10,v[5]&64&&(N+=4,N+=dN(v.subarray(10,14)));do{if(O=dN(v.subarray(N+4,N+8)),O<1)return null;if(W=String.fromCharCode(v[N],v[N+1],v[N+2],v[N+3]),W==="PRIV"){M=v.subarray(N+10,N+O+10);for(var Y=0;Y<M.byteLength;Y++)if(M[Y]===0){var ge=TH(M,0,Y);if(ge==="com.apple.streaming.transportStreamTimestamp"){var _e=M.subarray(Y+1),ve=(_e[3]&1)<<30|_e[4]<<22|_e[5]<<14|_e[6]<<6|_e[7]>>>2;return ve*=4,ve+=_e[7]&3,ve}break}}N+=10,N+=O}while(N<v.byteLength);return null},fA={isLikelyAacData:vH,parseId3TagSize:hN,parseAdtsSize:EH,parseType:SH,parseSampleRate:xH,parseAacTimestamp:AH},CH=s,fN=fA,_E;_E=function(){var v=new Uint8Array,N=0;_E.prototype.init.call(this),this.setTimestamp=function(O){N=O},this.push=function(O){var M=0,W=0,Y,ge,_e,ve;for(v.length?(ve=v.length,v=new Uint8Array(O.byteLength+ve),v.set(v.subarray(0,ve)),v.set(O,ve)):v=O;v.length-W>=3;){if(v[W]===73&&v[W+1]===68&&v[W+2]===51){if(v.length-W<10||(M=fN.parseId3TagSize(v,W),W+M>v.length))break;ge={type:"timed-metadata",data:v.subarray(W,W+M)},this.trigger("data",ge),W+=M;continue}else if((v[W]&255)===255&&(v[W+1]&240)===240){if(v.length-W<7||(M=fN.parseAdtsSize(v,W),W+M>v.length))break;_e={type:"audio",data:v.subarray(W,W+M),pts:N,dts:N},this.trigger("data",_e),W+=M;continue}W++}Y=v.length-W,Y>0?v=v.subarray(W):v=new Uint8Array},this.reset=function(){v=new Uint8Array,this.trigger("reset")},this.endTimeline=function(){v=new Uint8Array,this.trigger("endedtimeline")}},_E.prototype=new CH;var kH=_E,PH=["audioobjecttype","channelcount","samplerate","samplingfrequencyindex","samplesize"],DH=PH,IH=["width","height","profileIdc","levelIdc","profileCompatibility","sarRatio"],LH=IH,bE=s,tb=Ej,ib=Lj,yE=Hj,Ho=qj,xu=dH,vE=Js,pN=gH,NH=bH.H264Stream,RH=kH,MH=fA.isLikelyAacData,OH=Js.ONE_SECOND_IN_TS,gN=DH,mN=LH,wE,sb,TE,Qd,FH=function(v,N){N.stream=v,this.trigger("log",N)},_N=function(v,N){for(var O=Object.keys(N),M=0;M<O.length;M++){var W=O[M];W==="headOfPipeline"||!N[W].on||N[W].on("log",FH.bind(v,W))}},bN=function(v,N){var O;if(v.length!==N.length)return!1;for(O=0;O<v.length;O++)if(v[O]!==N[O])return!1;return!0},yN=function(v,N,O,M,W,Y){var ge=O-N,_e=M-N,ve=W-O;return{start:{dts:v,pts:v+ge},end:{dts:v+_e,pts:v+ve},prependedContentDuration:Y,baseMediaDecodeTime:v}};sb=function(v,N){var O=[],M,W=0,Y=0,ge=1/0;N=N||{},M=N.firstSequenceNumber||0,sb.prototype.init.call(this),this.push=function(_e){Ho.collectDtsInfo(v,_e),v&&gN.forEach(function(ve){v[ve]=_e[ve]}),O.push(_e)},this.setEarliestDts=function(_e){W=_e},this.setVideoBaseMediaDecodeTime=function(_e){ge=_e},this.setAudioAppendStart=function(_e){Y=_e},this.flush=function(){var _e,ve,xe,Ue,ut,Ft,bt;if(O.length===0){this.trigger("done","AudioSegmentStream");return}_e=yE.trimAdtsFramesByEarliestDts(O,v,W),v.baseMediaDecodeTime=Ho.calculateTrackBaseMediaDecodeTime(v,N.keepOriginalTimestamps),bt=yE.prefixWithSilence(v,_e,Y,ge),v.samples=yE.generateSampleTable(_e),xe=tb.mdat(yE.concatenateFrameData(_e)),O=[],ve=tb.moof(M,[v]),Ue=new Uint8Array(ve.byteLength+xe.byteLength),M++,Ue.set(ve),Ue.set(xe,ve.byteLength),Ho.clearDtsInfo(v),ut=Math.ceil(OH*1024/v.samplerate),_e.length&&(Ft=_e.length*ut,this.trigger("segmentTimingInfo",yN(vE.audioTsToVideoTs(v.baseMediaDecodeTime,v.samplerate),_e[0].dts,_e[0].pts,_e[0].dts+Ft,_e[0].pts+Ft,bt||0)),this.trigger("timingInfo",{start:_e[0].pts,end:_e[0].pts+Ft})),this.trigger("data",{track:v,boxes:Ue}),this.trigger("done","AudioSegmentStream")},this.reset=function(){Ho.clearDtsInfo(v),O=[],this.trigger("reset")}},sb.prototype=new bE,wE=function(v,N){var O,M=[],W=[],Y,ge;N=N||{},O=N.firstSequenceNumber||0,wE.prototype.init.call(this),delete v.minPTS,this.gopCache_=[],this.push=function(_e){Ho.collectDtsInfo(v,_e),_e.nalUnitType==="seq_parameter_set_rbsp"&&!Y&&(Y=_e.config,v.sps=[_e.data],mN.forEach(function(ve){v[ve]=Y[ve]},this)),_e.nalUnitType==="pic_parameter_set_rbsp"&&!ge&&(ge=_e.data,v.pps=[_e.data]),M.push(_e)},this.flush=function(){for(var _e,ve,xe,Ue,ut,Ft,bt=0,pi,Hi;M.length&&M[0].nalUnitType!=="access_unit_delimiter_rbsp";)M.shift();if(M.length===0){this.resetStream_(),this.trigger("done","VideoSegmentStream");return}if(_e=ib.groupNalsIntoFrames(M),xe=ib.groupFramesIntoGops(_e),xe[0][0].keyFrame||(ve=this.getGopForFusion_(M[0],v),ve?(bt=ve.duration,xe.unshift(ve),xe.byteLength+=ve.byteLength,xe.nalCount+=ve.nalCount,xe.pts=ve.pts,xe.dts=ve.dts,xe.duration+=ve.duration):xe=ib.extendFirstKeyFrame(xe)),W.length){var cr;if(N.alignGopsAtEnd?cr=this.alignGopsAtEnd_(xe):cr=this.alignGopsAtStart_(xe),!cr){this.gopCache_.unshift({gop:xe.pop(),pps:v.pps,sps:v.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),M=[],this.resetStream_(),this.trigger("done","VideoSegmentStream");return}Ho.clearDtsInfo(v),xe=cr}Ho.collectDtsInfo(v,xe),v.samples=ib.generateSampleTable(xe),ut=tb.mdat(ib.concatenateNalData(xe)),v.baseMediaDecodeTime=Ho.calculateTrackBaseMediaDecodeTime(v,N.keepOriginalTimestamps),this.trigger("processedGopsInfo",xe.map(function(Ba){return{pts:Ba.pts,dts:Ba.dts,byteLength:Ba.byteLength}})),pi=xe[0],Hi=xe[xe.length-1],this.trigger("segmentTimingInfo",yN(v.baseMediaDecodeTime,pi.dts,pi.pts,Hi.dts+Hi.duration,Hi.pts+Hi.duration,bt)),this.trigger("timingInfo",{start:xe[0].pts,end:xe[xe.length-1].pts+xe[xe.length-1].duration}),this.gopCache_.unshift({gop:xe.pop(),pps:v.pps,sps:v.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),M=[],this.trigger("baseMediaDecodeTime",v.baseMediaDecodeTime),this.trigger("timelineStartInfo",v.timelineStartInfo),Ue=tb.moof(O,[v]),Ft=new Uint8Array(Ue.byteLength+ut.byteLength),O++,Ft.set(Ue),Ft.set(ut,Ue.byteLength),this.trigger("data",{track:v,boxes:Ft}),this.resetStream_(),this.trigger("done","VideoSegmentStream")},this.reset=function(){this.resetStream_(),M=[],this.gopCache_.length=0,W.length=0,this.trigger("reset")},this.resetStream_=function(){Ho.clearDtsInfo(v),Y=void 0,ge=void 0},this.getGopForFusion_=function(_e){var ve=45e3,xe=1/0,Ue,ut,Ft,bt,pi;for(pi=0;pi<this.gopCache_.length;pi++)bt=this.gopCache_[pi],Ft=bt.gop,!(!(v.pps&&bN(v.pps[0],bt.pps[0]))||!(v.sps&&bN(v.sps[0],bt.sps[0])))&&(Ft.dts<v.timelineStartInfo.dts||(Ue=_e.dts-Ft.dts-Ft.duration,Ue>=-1e4&&Ue<=ve&&(!ut||xe>Ue)&&(ut=bt,xe=Ue)));return ut?ut.gop:null},this.alignGopsAtStart_=function(_e){var ve,xe,Ue,ut,Ft,bt,pi,Hi;for(Ft=_e.byteLength,bt=_e.nalCount,pi=_e.duration,ve=xe=0;ve<W.length&&xe<_e.length&&(Ue=W[ve],ut=_e[xe],Ue.pts!==ut.pts);){if(ut.pts>Ue.pts){ve++;continue}xe++,Ft-=ut.byteLength,bt-=ut.nalCount,pi-=ut.duration}return xe===0?_e:xe===_e.length?null:(Hi=_e.slice(xe),Hi.byteLength=Ft,Hi.duration=pi,Hi.nalCount=bt,Hi.pts=Hi[0].pts,Hi.dts=Hi[0].dts,Hi)},this.alignGopsAtEnd_=function(_e){var ve,xe,Ue,ut,Ft,bt;for(ve=W.length-1,xe=_e.length-1,Ft=null,bt=!1;ve>=0&&xe>=0;){if(Ue=W[ve],ut=_e[xe],Ue.pts===ut.pts){bt=!0;break}if(Ue.pts>ut.pts){ve--;continue}ve===W.length-1&&(Ft=xe),xe--}if(!bt&&Ft===null)return null;var pi;if(bt?pi=xe:pi=Ft,pi===0)return _e;var Hi=_e.slice(pi),cr=Hi.reduce(function(Ba,ic){return Ba.byteLength+=ic.byteLength,Ba.duration+=ic.duration,Ba.nalCount+=ic.nalCount,Ba},{byteLength:0,duration:0,nalCount:0});return Hi.byteLength=cr.byteLength,Hi.duration=cr.duration,Hi.nalCount=cr.nalCount,Hi.pts=Hi[0].pts,Hi.dts=Hi[0].dts,Hi},this.alignGopsWith=function(_e){W=_e}},wE.prototype=new bE,Qd=function(v,N){this.numberOfTracks=0,this.metadataStream=N,v=v||{},typeof v.remux<"u"?this.remuxTracks=!!v.remux:this.remuxTracks=!0,typeof v.keepOriginalTimestamps=="boolean"?this.keepOriginalTimestamps=v.keepOriginalTimestamps:this.keepOriginalTimestamps=!1,this.pendingTracks=[],this.videoTrack=null,this.pendingBoxes=[],this.pendingCaptions=[],this.pendingMetadata=[],this.pendingBytes=0,this.emittedTracks=0,Qd.prototype.init.call(this),this.push=function(O){if(O.content||O.text)return this.pendingCaptions.push(O);if(O.frames)return this.pendingMetadata.push(O);this.pendingTracks.push(O.track),this.pendingBytes+=O.boxes.byteLength,O.track.type==="video"&&(this.videoTrack=O.track,this.pendingBoxes.push(O.boxes)),O.track.type==="audio"&&(this.audioTrack=O.track,this.pendingBoxes.unshift(O.boxes))}},Qd.prototype=new bE,Qd.prototype.flush=function(v){var N=0,O={captions:[],captionStreams:{},metadata:[],info:{}},M,W,Y,ge=0,_e;if(this.pendingTracks.length<this.numberOfTracks){if(v!=="VideoSegmentStream"&&v!=="AudioSegmentStream")return;if(this.remuxTracks)return;if(this.pendingTracks.length===0){this.emittedTracks++,this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0);return}}if(this.videoTrack?(ge=this.videoTrack.timelineStartInfo.pts,mN.forEach(function(ve){O.info[ve]=this.videoTrack[ve]},this)):this.audioTrack&&(ge=this.audioTrack.timelineStartInfo.pts,gN.forEach(function(ve){O.info[ve]=this.audioTrack[ve]},this)),this.videoTrack||this.audioTrack){for(this.pendingTracks.length===1?O.type=this.pendingTracks[0].type:O.type="combined",this.emittedTracks+=this.pendingTracks.length,Y=tb.initSegment(this.pendingTracks),O.initSegment=new Uint8Array(Y.byteLength),O.initSegment.set(Y),O.data=new Uint8Array(this.pendingBytes),_e=0;_e<this.pendingBoxes.length;_e++)O.data.set(this.pendingBoxes[_e],N),N+=this.pendingBoxes[_e].byteLength;for(_e=0;_e<this.pendingCaptions.length;_e++)M=this.pendingCaptions[_e],M.startTime=vE.metadataTsToSeconds(M.startPts,ge,this.keepOriginalTimestamps),M.endTime=vE.metadataTsToSeconds(M.endPts,ge,this.keepOriginalTimestamps),O.captionStreams[M.stream]=!0,O.captions.push(M);for(_e=0;_e<this.pendingMetadata.length;_e++)W=this.pendingMetadata[_e],W.cueTime=vE.metadataTsToSeconds(W.pts,ge,this.keepOriginalTimestamps),O.metadata.push(W);for(O.metadata.dispatchType=this.metadataStream.dispatchType,this.pendingTracks.length=0,this.videoTrack=null,this.pendingBoxes.length=0,this.pendingCaptions.length=0,this.pendingBytes=0,this.pendingMetadata.length=0,this.trigger("data",O),_e=0;_e<O.captions.length;_e++)M=O.captions[_e],this.trigger("caption",M);for(_e=0;_e<O.metadata.length;_e++)W=O.metadata[_e],this.trigger("id3Frame",W)}this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0)},Qd.prototype.setRemux=function(v){this.remuxTracks=v},TE=function(v){var N=this,O=!0,M,W;TE.prototype.init.call(this),v=v||{},this.baseMediaDecodeTime=v.baseMediaDecodeTime||0,this.transmuxPipeline_={},this.setupAacPipeline=function(){var Y={};this.transmuxPipeline_=Y,Y.type="aac",Y.metadataStream=new xu.MetadataStream,Y.aacStream=new RH,Y.audioTimestampRolloverStream=new xu.TimestampRolloverStream("audio"),Y.timedMetadataTimestampRolloverStream=new xu.TimestampRolloverStream("timed-metadata"),Y.adtsStream=new pN,Y.coalesceStream=new Qd(v,Y.metadataStream),Y.headOfPipeline=Y.aacStream,Y.aacStream.pipe(Y.audioTimestampRolloverStream).pipe(Y.adtsStream),Y.aacStream.pipe(Y.timedMetadataTimestampRolloverStream).pipe(Y.metadataStream).pipe(Y.coalesceStream),Y.metadataStream.on("timestamp",function(ge){Y.aacStream.setTimestamp(ge.timeStamp)}),Y.aacStream.on("data",function(ge){ge.type!=="timed-metadata"&&ge.type!=="audio"||Y.audioSegmentStream||(W=W||{timelineStartInfo:{baseMediaDecodeTime:N.baseMediaDecodeTime},codec:"adts",type:"audio"},Y.coalesceStream.numberOfTracks++,Y.audioSegmentStream=new sb(W,v),Y.audioSegmentStream.on("log",N.getLogTrigger_("audioSegmentStream")),Y.audioSegmentStream.on("timingInfo",N.trigger.bind(N,"audioTimingInfo")),Y.adtsStream.pipe(Y.audioSegmentStream).pipe(Y.coalesceStream),N.trigger("trackinfo",{hasAudio:!!W,hasVideo:!!M}))}),Y.coalesceStream.on("data",this.trigger.bind(this,"data")),Y.coalesceStream.on("done",this.trigger.bind(this,"done")),_N(this,Y)},this.setupTsPipeline=function(){var Y={};this.transmuxPipeline_=Y,Y.type="ts",Y.metadataStream=new xu.MetadataStream,Y.packetStream=new xu.TransportPacketStream,Y.parseStream=new xu.TransportParseStream,Y.elementaryStream=new xu.ElementaryStream,Y.timestampRolloverStream=new xu.TimestampRolloverStream,Y.adtsStream=new pN,Y.h264Stream=new NH,Y.captionStream=new xu.CaptionStream(v),Y.coalesceStream=new Qd(v,Y.metadataStream),Y.headOfPipeline=Y.packetStream,Y.packetStream.pipe(Y.parseStream).pipe(Y.elementaryStream).pipe(Y.timestampRolloverStream),Y.timestampRolloverStream.pipe(Y.h264Stream),Y.timestampRolloverStream.pipe(Y.adtsStream),Y.timestampRolloverStream.pipe(Y.metadataStream).pipe(Y.coalesceStream),Y.h264Stream.pipe(Y.captionStream).pipe(Y.coalesceStream),Y.elementaryStream.on("data",function(ge){var _e;if(ge.type==="metadata"){for(_e=ge.tracks.length;_e--;)!M&&ge.tracks[_e].type==="video"?(M=ge.tracks[_e],M.timelineStartInfo.baseMediaDecodeTime=N.baseMediaDecodeTime):!W&&ge.tracks[_e].type==="audio"&&(W=ge.tracks[_e],W.timelineStartInfo.baseMediaDecodeTime=N.baseMediaDecodeTime);M&&!Y.videoSegmentStream&&(Y.coalesceStream.numberOfTracks++,Y.videoSegmentStream=new wE(M,v),Y.videoSegmentStream.on("log",N.getLogTrigger_("videoSegmentStream")),Y.videoSegmentStream.on("timelineStartInfo",function(ve){W&&!v.keepOriginalTimestamps&&(W.timelineStartInfo=ve,Y.audioSegmentStream.setEarliestDts(ve.dts-N.baseMediaDecodeTime))}),Y.videoSegmentStream.on("processedGopsInfo",N.trigger.bind(N,"gopInfo")),Y.videoSegmentStream.on("segmentTimingInfo",N.trigger.bind(N,"videoSegmentTimingInfo")),Y.videoSegmentStream.on("baseMediaDecodeTime",function(ve){W&&Y.audioSegmentStream.setVideoBaseMediaDecodeTime(ve)}),Y.videoSegmentStream.on("timingInfo",N.trigger.bind(N,"videoTimingInfo")),Y.h264Stream.pipe(Y.videoSegmentStream).pipe(Y.coalesceStream)),W&&!Y.audioSegmentStream&&(Y.coalesceStream.numberOfTracks++,Y.audioSegmentStream=new sb(W,v),Y.audioSegmentStream.on("log",N.getLogTrigger_("audioSegmentStream")),Y.audioSegmentStream.on("timingInfo",N.trigger.bind(N,"audioTimingInfo")),Y.audioSegmentStream.on("segmentTimingInfo",N.trigger.bind(N,"audioSegmentTimingInfo")),Y.adtsStream.pipe(Y.audioSegmentStream).pipe(Y.coalesceStream)),N.trigger("trackinfo",{hasAudio:!!W,hasVideo:!!M})}}),Y.coalesceStream.on("data",this.trigger.bind(this,"data")),Y.coalesceStream.on("id3Frame",function(ge){ge.dispatchType=Y.metadataStream.dispatchType,N.trigger("id3Frame",ge)}),Y.coalesceStream.on("caption",this.trigger.bind(this,"caption")),Y.coalesceStream.on("done",this.trigger.bind(this,"done")),_N(this,Y)},this.setBaseMediaDecodeTime=function(Y){var ge=this.transmuxPipeline_;v.keepOriginalTimestamps||(this.baseMediaDecodeTime=Y),W&&(W.timelineStartInfo.dts=void 0,W.timelineStartInfo.pts=void 0,Ho.clearDtsInfo(W),ge.audioTimestampRolloverStream&&ge.audioTimestampRolloverStream.discontinuity()),M&&(ge.videoSegmentStream&&(ge.videoSegmentStream.gopCache_=[]),M.timelineStartInfo.dts=void 0,M.timelineStartInfo.pts=void 0,Ho.clearDtsInfo(M),ge.captionStream.reset()),ge.timestampRolloverStream&&ge.timestampRolloverStream.discontinuity()},this.setAudioAppendStart=function(Y){W&&this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(Y)},this.setRemux=function(Y){var ge=this.transmuxPipeline_;v.remux=Y,ge&&ge.coalesceStream&&ge.coalesceStream.setRemux(Y)},this.alignGopsWith=function(Y){M&&this.transmuxPipeline_.videoSegmentStream&&this.transmuxPipeline_.videoSegmentStream.alignGopsWith(Y)},this.getLogTrigger_=function(Y){var ge=this;return function(_e){_e.stream=Y,ge.trigger("log",_e)}},this.push=function(Y){if(O){var ge=MH(Y);ge&&this.transmuxPipeline_.type!=="aac"?this.setupAacPipeline():!ge&&this.transmuxPipeline_.type!=="ts"&&this.setupTsPipeline(),O=!1}this.transmuxPipeline_.headOfPipeline.push(Y)},this.flush=function(){O=!0,this.transmuxPipeline_.headOfPipeline.flush()},this.endTimeline=function(){this.transmuxPipeline_.headOfPipeline.endTimeline()},this.reset=function(){this.transmuxPipeline_.headOfPipeline&&this.transmuxPipeline_.headOfPipeline.reset()},this.resetCaptions=function(){this.transmuxPipeline_.captionStream&&this.transmuxPipeline_.captionStream.reset()}},TE.prototype=new bE;var BH={Transmuxer:TE},UH=function(v){return v>>>0},jH=function(v){return("00"+v.toString(16)).slice(-2)},EE={toUnsigned:UH,toHexString:jH},HH=function(v){var N="";return N+=String.fromCharCode(v[0]),N+=String.fromCharCode(v[1]),N+=String.fromCharCode(v[2]),N+=String.fromCharCode(v[3]),N},vN=HH,VH=EE.toUnsigned,$H=vN,wN=function(v,N){var O=[],M,W,Y,ge,_e;if(!N.length)return null;for(M=0;M<v.byteLength;)W=VH(v[M]<<24|v[M+1]<<16|v[M+2]<<8|v[M+3]),Y=$H(v.subarray(M+4,M+8)),ge=W>1?M+W:v.byteLength,Y===N[0]&&(N.length===1?O.push(v.subarray(M+8,ge)):(_e=wN(v.subarray(M+8,ge),N.slice(1)),_e.length&&(O=O.concat(_e)))),M=ge;return O},pA=wN,zH=EE.toUnsigned,WH=p.getUint64,qH=function(v){var N={version:v[0],flags:new Uint8Array(v.subarray(1,4))};return N.version===1?N.baseMediaDecodeTime=WH(v.subarray(4)):N.baseMediaDecodeTime=zH(v[4]<<24|v[5]<<16|v[6]<<8|v[7]),N},gA=qH,GH=function(v){var N=new DataView(v.buffer,v.byteOffset,v.byteLength),O={version:v[0],flags:new Uint8Array(v.subarray(1,4)),trackId:N.getUint32(4)},M=O.flags[2]&1,W=O.flags[2]&2,Y=O.flags[2]&8,ge=O.flags[2]&16,_e=O.flags[2]&32,ve=O.flags[0]&65536,xe=O.flags[0]&131072,Ue;return Ue=8,M&&(Ue+=4,O.baseDataOffset=N.getUint32(12),Ue+=4),W&&(O.sampleDescriptionIndex=N.getUint32(Ue),Ue+=4),Y&&(O.defaultSampleDuration=N.getUint32(Ue),Ue+=4),ge&&(O.defaultSampleSize=N.getUint32(Ue),Ue+=4),_e&&(O.defaultSampleFlags=N.getUint32(Ue)),ve&&(O.durationIsEmpty=!0),!M&&xe&&(O.baseDataOffsetIsMoof=!0),O},TN=GH,XH=function(v){return{isLeading:(v[0]&12)>>>2,dependsOn:v[0]&3,isDependedOn:(v[1]&192)>>>6,hasRedundancy:(v[1]&48)>>>4,paddingValue:(v[1]&14)>>>1,isNonSyncSample:v[1]&1,degradationPriority:v[2]<<8|v[3]}},KH=XH,EN=KH,YH=function(v){var N={version:v[0],flags:new Uint8Array(v.subarray(1,4)),samples:[]},O=new DataView(v.buffer,v.byteOffset,v.byteLength),M=N.flags[2]&1,W=N.flags[2]&4,Y=N.flags[1]&1,ge=N.flags[1]&2,_e=N.flags[1]&4,ve=N.flags[1]&8,xe=O.getUint32(4),Ue=8,ut;for(M&&(N.dataOffset=O.getInt32(Ue),Ue+=4),W&&xe&&(ut={flags:EN(v.subarray(Ue,Ue+4))},Ue+=4,Y&&(ut.duration=O.getUint32(Ue),Ue+=4),ge&&(ut.size=O.getUint32(Ue),Ue+=4),ve&&(N.version===1?ut.compositionTimeOffset=O.getInt32(Ue):ut.compositionTimeOffset=O.getUint32(Ue),Ue+=4),N.samples.push(ut),xe--);xe--;)ut={},Y&&(ut.duration=O.getUint32(Ue),Ue+=4),ge&&(ut.size=O.getUint32(Ue),Ue+=4),_e&&(ut.flags=EN(v.subarray(Ue,Ue+4)),Ue+=4),ve&&(N.version===1?ut.compositionTimeOffset=O.getInt32(Ue):ut.compositionTimeOffset=O.getUint32(Ue),Ue+=4),N.samples.push(ut);return N},SN=YH,xN={tfdt:gA,trun:SN},AN={parseTfdt:xN.tfdt,parseTrun:xN.trun},ZH=function(v){for(var N=0,O=String.fromCharCode(v[N]),M="";O!=="\0";)M+=O,N++,O=String.fromCharCode(v[N]);return M+=O,M},QH={uint8ToCString:ZH},SE=QH.uint8ToCString,JH=p.getUint64,eV=function(v){var N=4,O=v[0],M,W,Y,ge,_e,ve,xe,Ue;if(O===0){M=SE(v.subarray(N)),N+=M.length,W=SE(v.subarray(N)),N+=W.length;var ut=new DataView(v.buffer);Y=ut.getUint32(N),N+=4,_e=ut.getUint32(N),N+=4,ve=ut.getUint32(N),N+=4,xe=ut.getUint32(N),N+=4}else if(O===1){var ut=new DataView(v.buffer);Y=ut.getUint32(N),N+=4,ge=JH(v.subarray(N)),N+=8,ve=ut.getUint32(N),N+=4,xe=ut.getUint32(N),N+=4,M=SE(v.subarray(N)),N+=M.length,W=SE(v.subarray(N)),N+=W.length}Ue=new Uint8Array(v.subarray(N,v.byteLength));var Ft={scheme_id_uri:M,value:W,timescale:Y||1,presentation_time:ge,presentation_time_delta:_e,event_duration:ve,id:xe,message_data:Ue};return iV(O,Ft)?Ft:void 0},tV=function(v,N,O,M){return v||v===0?v/N:M+O/N},iV=function(v,N){var O=N.scheme_id_uri!=="\0",M=v===0&&CN(N.presentation_time_delta)&&O,W=v===1&&CN(N.presentation_time)&&O;return!(v>1)&&M||W},CN=function(v){return v!==void 0||v!==null},sV={parseEmsgBox:eV,scaleTime:tV},nb;typeof window<"u"?nb=window:typeof r<"u"?nb=r:typeof self<"u"?nb=self:nb={};var kN=nb,xE=EE.toUnsigned,rb=EE.toHexString,kn=pA,$g=vN,mA=sV,nV=TN,rV=SN,aV=gA,oV=p.getUint64,PN,DN,IN,LN,NN,_A,RN,bA=kN,lV=nN.parseId3Frames;PN=function(v){var N={},O=kn(v,["moov","trak"]);return O.reduce(function(M,W){var Y,ge,_e,ve,xe;return Y=kn(W,["tkhd"])[0],!Y||(ge=Y[0],_e=ge===0?12:20,ve=xE(Y[_e]<<24|Y[_e+1]<<16|Y[_e+2]<<8|Y[_e+3]),xe=kn(W,["mdia","mdhd"])[0],!xe)?null:(ge=xe[0],_e=ge===0?12:20,M[ve]=xE(xe[_e]<<24|xe[_e+1]<<16|xe[_e+2]<<8|xe[_e+3]),M)},N)},DN=function(v,N){var O;O=kn(N,["moof","traf"]);var M=O.reduce(function(W,Y){var ge=kn(Y,["tfhd"])[0],_e=xE(ge[4]<<24|ge[5]<<16|ge[6]<<8|ge[7]),ve=v[_e]||9e4,xe=kn(Y,["tfdt"])[0],Ue=new DataView(xe.buffer,xe.byteOffset,xe.byteLength),ut;xe[0]===1?ut=oV(xe.subarray(4,12)):ut=Ue.getUint32(4);let Ft;return typeof ut=="bigint"?Ft=ut/bA.BigInt(ve):typeof ut=="number"&&!isNaN(ut)&&(Ft=ut/ve),Ft<Number.MAX_SAFE_INTEGER&&(Ft=Number(Ft)),Ft<W&&(W=Ft),W},1/0);return typeof M=="bigint"||isFinite(M)?M:0},IN=function(v,N){var O=kn(N,["moof","traf"]),M=0,W=0,Y;if(O&&O.length){var ge=kn(O[0],["tfhd"])[0],_e=kn(O[0],["trun"])[0],ve=kn(O[0],["tfdt"])[0];if(ge){var xe=nV(ge);Y=xe.trackId}if(ve){var Ue=aV(ve);M=Ue.baseMediaDecodeTime}if(_e){var ut=rV(_e);ut.samples&&ut.samples.length&&(W=ut.samples[0].compositionTimeOffset||0)}}var Ft=v[Y]||9e4;typeof M=="bigint"&&(W=bA.BigInt(W),Ft=bA.BigInt(Ft));var bt=(M+W)/Ft;return typeof bt=="bigint"&&bt<Number.MAX_SAFE_INTEGER&&(bt=Number(bt)),bt},LN=function(v){var N=kn(v,["moov","trak"]),O=[];return N.forEach(function(M){var W=kn(M,["mdia","hdlr"]),Y=kn(M,["tkhd"]);W.forEach(function(ge,_e){var ve=$g(ge.subarray(8,12)),xe=Y[_e],Ue,ut,Ft;ve==="vide"&&(Ue=new DataView(xe.buffer,xe.byteOffset,xe.byteLength),ut=Ue.getUint8(0),Ft=ut===0?Ue.getUint32(12):Ue.getUint32(20),O.push(Ft))})}),O},_A=function(v){var N=v[0],O=N===0?12:20;return xE(v[O]<<24|v[O+1]<<16|v[O+2]<<8|v[O+3])},NN=function(v){var N=kn(v,["moov","trak"]),O=[];return N.forEach(function(M){var W={},Y=kn(M,["tkhd"])[0],ge,_e;Y&&(ge=new DataView(Y.buffer,Y.byteOffset,Y.byteLength),_e=ge.getUint8(0),W.id=_e===0?ge.getUint32(12):ge.getUint32(20));var ve=kn(M,["mdia","hdlr"])[0];if(ve){var xe=$g(ve.subarray(8,12));xe==="vide"?W.type="video":xe==="soun"?W.type="audio":W.type=xe}var Ue=kn(M,["mdia","minf","stbl","stsd"])[0];if(Ue){var ut=Ue.subarray(8);W.codec=$g(ut.subarray(4,8));var Ft=kn(ut,[W.codec])[0],bt,pi;Ft&&(/^[asm]vc[1-9]$/i.test(W.codec)?(bt=Ft.subarray(78),pi=$g(bt.subarray(4,8)),pi==="avcC"&&bt.length>11?(W.codec+=".",W.codec+=rb(bt[9]),W.codec+=rb(bt[10]),W.codec+=rb(bt[11])):W.codec="avc1.4d400d"):/^mp4[a,v]$/i.test(W.codec)?(bt=Ft.subarray(28),pi=$g(bt.subarray(4,8)),pi==="esds"&&bt.length>20&&bt[19]!==0?(W.codec+="."+rb(bt[19]),W.codec+="."+rb(bt[20]>>>2&63).replace(/^0/,"")):W.codec="mp4a.40.2"):W.codec=W.codec.toLowerCase())}var Hi=kn(M,["mdia","mdhd"])[0];Hi&&(W.timescale=_A(Hi)),O.push(W)}),O},RN=function(v,N=0){var O=kn(v,["emsg"]);return O.map(M=>{var W=mA.parseEmsgBox(new Uint8Array(M)),Y=lV(W.message_data);return{cueTime:mA.scaleTime(W.presentation_time,W.timescale,W.presentation_time_delta,N),duration:mA.scaleTime(W.event_duration,W.timescale),frames:Y}})};var ab={findBox:kn,parseType:$g,timescale:PN,startTime:DN,compositionStartTime:IN,videoTrackIds:LN,tracks:NN,getTimescaleFromMediaHeader:_A,getEmsgID3:RN};const{parseTrun:uV}=AN,{findBox:MN}=ab;var ON=kN,hV=function(v){var N=MN(v,["moof","traf"]),O=MN(v,["mdat"]),M=[];return O.forEach(function(W,Y){var ge=N[Y];M.push({mdat:W,traf:ge})}),M},cV=function(v,N,O){var M=N,W=O.defaultSampleDuration||0,Y=O.defaultSampleSize||0,ge=O.trackId,_e=[];return v.forEach(function(ve){var xe=uV(ve),Ue=xe.samples;Ue.forEach(function(ut){ut.duration===void 0&&(ut.duration=W),ut.size===void 0&&(ut.size=Y),ut.trackId=ge,ut.dts=M,ut.compositionTimeOffset===void 0&&(ut.compositionTimeOffset=0),typeof M=="bigint"?(ut.pts=M+ON.BigInt(ut.compositionTimeOffset),M+=ON.BigInt(ut.duration)):(ut.pts=M+ut.compositionTimeOffset,M+=ut.duration)}),_e=_e.concat(Ue)}),_e},FN={getMdatTrafPairs:hV,parseSamples:cV},dV=JL.discardEmulationPreventionBytes,fV=eN.CaptionStream,yA=pA,pV=gA,gV=TN,{getMdatTrafPairs:mV,parseSamples:_V}=FN,bV=function(v,N){for(var O=v,M=0;M<N.length;M++){var W=N[M];if(O<W.size)return W;O-=W.size}return null},yV=function(v,N,O){var M=new DataView(v.buffer,v.byteOffset,v.byteLength),W={logs:[],seiNals:[]},Y,ge,_e,ve;for(ge=0;ge+4<v.length;ge+=_e)if(_e=M.getUint32(ge),ge+=4,!(_e<=0))switch(v[ge]&31){case 6:var xe=v.subarray(ge+1,ge+1+_e),Ue=bV(ge,N);if(Y={nalUnitType:"sei_rbsp",size:_e,data:xe,escapedRBSP:dV(xe),trackId:O},Ue)Y.pts=Ue.pts,Y.dts=Ue.dts,ve=Ue;else if(ve)Y.pts=ve.pts,Y.dts=ve.dts;else{W.logs.push({level:"warn",message:"We've encountered a nal unit without data at "+ge+" for trackId "+O+". See mux.js#223."});break}W.seiNals.push(Y);break}return W},vV=function(v,N){var O={},M=mV(v);return M.forEach(function(W){var Y=W.mdat,ge=W.traf,_e=yA(ge,["tfhd"]),ve=gV(_e[0]),xe=ve.trackId,Ue=yA(ge,["tfdt"]),ut=Ue.length>0?pV(Ue[0]).baseMediaDecodeTime:0,Ft=yA(ge,["trun"]),bt,pi;N===xe&&Ft.length>0&&(bt=_V(Ft,ut,ve),pi=yV(Y,bt,xe),O[xe]||(O[xe]={seiNals:[],logs:[]}),O[xe].seiNals=O[xe].seiNals.concat(pi.seiNals),O[xe].logs=O[xe].logs.concat(pi.logs))}),O},wV=function(v,N,O){var M;if(N===null)return null;M=vV(v,N);var W=M[N]||{};return{seiNals:W.seiNals,logs:W.logs,timescale:O}},TV=function(){var v=!1,N,O,M,W,Y,ge;this.isInitialized=function(){return v},this.init=function(_e){N=new fV,v=!0,ge=_e?_e.isPartial:!1,N.on("data",function(ve){ve.startTime=ve.startPts/W,ve.endTime=ve.endPts/W,Y.captions.push(ve),Y.captionStreams[ve.stream]=!0}),N.on("log",function(ve){Y.logs.push(ve)})},this.isNewInit=function(_e,ve){return _e&&_e.length===0||ve&&typeof ve=="object"&&Object.keys(ve).length===0?!1:M!==_e[0]||W!==ve[M]},this.parse=function(_e,ve,xe){var Ue;if(this.isInitialized()){if(!ve||!xe)return null;if(this.isNewInit(ve,xe))M=ve[0],W=xe[M];else if(M===null||!W)return O.push(_e),null}else return null;for(;O.length>0;){var ut=O.shift();this.parse(ut,ve,xe)}return Ue=wV(_e,M,W),Ue&&Ue.logs&&(Y.logs=Y.logs.concat(Ue.logs)),Ue===null||!Ue.seiNals?Y.logs.length?{logs:Y.logs,captions:[],captionStreams:[]}:null:(this.pushNals(Ue.seiNals),this.flushStream(),Y)},this.pushNals=function(_e){if(!this.isInitialized()||!_e||_e.length===0)return null;_e.forEach(function(ve){N.push(ve)})},this.flushStream=function(){if(!this.isInitialized())return null;ge?N.partialFlush():N.flush()},this.clearParsedCaptions=function(){Y.captions=[],Y.captionStreams={},Y.logs=[]},this.resetCaptionStream=function(){if(!this.isInitialized())return null;N.reset()},this.clearAllCaptions=function(){this.clearParsedCaptions(),this.resetCaptionStream()},this.reset=function(){O=[],M=null,W=null,Y?this.clearParsedCaptions():Y={captions:[],captionStreams:{},logs:[]},this.resetCaptionStream()},this.reset()},EV=TV;const{parseTfdt:SV}=AN,tc=pA,{getTimescaleFromMediaHeader:xV}=ab,{parseSamples:AV,getMdatTrafPairs:CV}=FN;var BN=function(){let v=9e4;this.init=function(N){const O=tc(N,["moov","trak","mdia","mdhd"])[0];O&&(v=xV(O))},this.parseSegment=function(N){const O=[],M=CV(N);let W=0;return M.forEach(function(Y){const ge=Y.mdat,_e=Y.traf,ve=tc(_e,["tfdt"])[0],xe=tc(_e,["tfhd"])[0],Ue=tc(_e,["trun"]);if(ve&&(W=SV(ve).baseMediaDecodeTime),Ue.length&&xe){const ut=AV(Ue,W,xe);let Ft=0;ut.forEach(function(bt){const pi="utf-8",Hi=new TextDecoder(pi),cr=ge.slice(Ft,Ft+bt.size);if(tc(cr,["vtte"])[0]){Ft+=bt.size;return}tc(cr,["vttc"]).forEach(function(ob){const lb=tc(ob,["payl"])[0],ub=tc(ob,["sttg"])[0],hb=bt.pts/v,kE=(bt.pts+bt.duration)/v;let en,cb;if(lb)try{en=Hi.decode(lb)}catch(Vo){console.error(Vo)}if(ub)try{cb=Hi.decode(ub)}catch(Vo){console.error(Vo)}bt.duration&&en&&O.push({cueText:en,start:hb,end:kE,settings:cb})}),Ft+=bt.size})}}),O}},vA=lE,UN=function(v){var N=v[1]&31;return N<<=8,N|=v[2],N},AE=function(v){return!!(v[1]&64)},CE=function(v){var N=0;return(v[3]&48)>>>4>1&&(N+=v[4]+1),N},kV=function(v,N){var O=UN(v);return O===0?"pat":O===N?"pmt":N?"pes":null},PV=function(v){var N=AE(v),O=4+CE(v);return N&&(O+=v[O]+1),(v[O+10]&31)<<8|v[O+11]},DV=function(v){var N={},O=AE(v),M=4+CE(v);if(O&&(M+=v[M]+1),!!(v[M+5]&1)){var W,Y,ge;W=(v[M+1]&15)<<8|v[M+2],Y=3+W-4,ge=(v[M+10]&15)<<8|v[M+11];for(var _e=12+ge;_e<Y;){var ve=M+_e;N[(v[ve+1]&31)<<8|v[ve+2]]=v[ve],_e+=((v[ve+3]&15)<<8|v[ve+4])+5}return N}},IV=function(v,N){var O=UN(v),M=N[O];switch(M){case vA.H264_STREAM_TYPE:return"video";case vA.ADTS_STREAM_TYPE:return"audio";case vA.METADATA_STREAM_TYPE:return"timed-metadata";default:return null}},LV=function(v){var N=AE(v);if(!N)return null;var O=4+CE(v);if(O>=v.byteLength)return null;var M=null,W;return W=v[O+7],W&192&&(M={},M.pts=(v[O+9]&14)<<27|(v[O+10]&255)<<20|(v[O+11]&254)<<12|(v[O+12]&255)<<5|(v[O+13]&254)>>>3,M.pts*=4,M.pts+=(v[O+13]&6)>>>1,M.dts=M.pts,W&64&&(M.dts=(v[O+14]&14)<<27|(v[O+15]&255)<<20|(v[O+16]&254)<<12|(v[O+17]&255)<<5|(v[O+18]&254)>>>3,M.dts*=4,M.dts+=(v[O+18]&6)>>>1)),M},wA=function(v){switch(v){case 5:return"slice_layer_without_partitioning_rbsp_idr";case 6:return"sei_rbsp";case 7:return"seq_parameter_set_rbsp";case 8:return"pic_parameter_set_rbsp";case 9:return"access_unit_delimiter_rbsp";default:return null}},NV=function(v){for(var N=4+CE(v),O=v.subarray(N),M=0,W=0,Y=!1,ge;W<O.byteLength-3;W++)if(O[W+2]===1){M=W+5;break}for(;M<O.byteLength;)switch(O[M]){case 0:if(O[M-1]!==0){M+=2;break}else if(O[M-2]!==0){M++;break}W+3!==M-2&&(ge=wA(O[W+3]&31),ge==="slice_layer_without_partitioning_rbsp_idr"&&(Y=!0));do M++;while(O[M]!==1&&M<O.length);W=M-2,M+=3;break;case 1:if(O[M-1]!==0||O[M-2]!==0){M+=3;break}ge=wA(O[W+3]&31),ge==="slice_layer_without_partitioning_rbsp_idr"&&(Y=!0),W=M-2,M+=3;break;default:M+=3;break}return O=O.subarray(W),M-=W,W=0,O&&O.byteLength>3&&(ge=wA(O[W+3]&31),ge==="slice_layer_without_partitioning_rbsp_idr"&&(Y=!0)),Y},RV={parseType:kV,parsePat:PV,parsePmt:DV,parsePayloadUnitStartIndicator:AE,parsePesType:IV,parsePesTime:LV,videoPacketContainsKeyFrame:NV},jN=lE,zg=iN.handleRollover,Ds={};Ds.ts=RV,Ds.aac=fA;var Jd=Js.ONE_SECOND_IN_TS,Zr=188,Ll=71,MV=function(v,N){for(var O=0,M=Zr,W,Y;M<v.byteLength;){if(v[O]===Ll&&v[M]===Ll){switch(W=v.subarray(O,M),Y=Ds.ts.parseType(W,N.pid),Y){case"pat":N.pid=Ds.ts.parsePat(W);break;case"pmt":var ge=Ds.ts.parsePmt(W);N.table=N.table||{},Object.keys(ge).forEach(function(_e){N.table[_e]=ge[_e]});break}O+=Zr,M+=Zr;continue}O++,M++}},HN=function(v,N,O){for(var M=0,W=Zr,Y,ge,_e,ve,xe,Ue=!1;W<=v.byteLength;){if(v[M]===Ll&&(v[W]===Ll||W===v.byteLength)){switch(Y=v.subarray(M,W),ge=Ds.ts.parseType(Y,N.pid),ge){case"pes":_e=Ds.ts.parsePesType(Y,N.table),ve=Ds.ts.parsePayloadUnitStartIndicator(Y),_e==="audio"&&ve&&(xe=Ds.ts.parsePesTime(Y),xe&&(xe.type="audio",O.audio.push(xe),Ue=!0));break}if(Ue)break;M+=Zr,W+=Zr;continue}M++,W++}for(W=v.byteLength,M=W-Zr,Ue=!1;M>=0;){if(v[M]===Ll&&(v[W]===Ll||W===v.byteLength)){switch(Y=v.subarray(M,W),ge=Ds.ts.parseType(Y,N.pid),ge){case"pes":_e=Ds.ts.parsePesType(Y,N.table),ve=Ds.ts.parsePayloadUnitStartIndicator(Y),_e==="audio"&&ve&&(xe=Ds.ts.parsePesTime(Y),xe&&(xe.type="audio",O.audio.push(xe),Ue=!0));break}if(Ue)break;M-=Zr,W-=Zr;continue}M--,W--}},OV=function(v,N,O){for(var M=0,W=Zr,Y,ge,_e,ve,xe,Ue,ut,Ft,bt=!1,pi={data:[],size:0};W<v.byteLength;){if(v[M]===Ll&&v[W]===Ll){switch(Y=v.subarray(M,W),ge=Ds.ts.parseType(Y,N.pid),ge){case"pes":if(_e=Ds.ts.parsePesType(Y,N.table),ve=Ds.ts.parsePayloadUnitStartIndicator(Y),_e==="video"&&(ve&&!bt&&(xe=Ds.ts.parsePesTime(Y),xe&&(xe.type="video",O.video.push(xe),bt=!0)),!O.firstKeyFrame)){if(ve&&pi.size!==0){for(Ue=new Uint8Array(pi.size),ut=0;pi.data.length;)Ft=pi.data.shift(),Ue.set(Ft,ut),ut+=Ft.byteLength;if(Ds.ts.videoPacketContainsKeyFrame(Ue)){var Hi=Ds.ts.parsePesTime(Ue);Hi?(O.firstKeyFrame=Hi,O.firstKeyFrame.type="video"):console.warn("Failed to extract PTS/DTS from PES at first keyframe. This could be an unusual TS segment, or else mux.js did not parse your TS segment correctly. If you know your TS segments do contain PTS/DTS on keyframes please file a bug report! You can try ffprobe to double check for yourself.")}pi.size=0}pi.data.push(Y),pi.size+=Y.byteLength}break}if(bt&&O.firstKeyFrame)break;M+=Zr,W+=Zr;continue}M++,W++}for(W=v.byteLength,M=W-Zr,bt=!1;M>=0;){if(v[M]===Ll&&v[W]===Ll){switch(Y=v.subarray(M,W),ge=Ds.ts.parseType(Y,N.pid),ge){case"pes":_e=Ds.ts.parsePesType(Y,N.table),ve=Ds.ts.parsePayloadUnitStartIndicator(Y),_e==="video"&&ve&&(xe=Ds.ts.parsePesTime(Y),xe&&(xe.type="video",O.video.push(xe),bt=!0));break}if(bt)break;M-=Zr,W-=Zr;continue}M--,W--}},FV=function(v,N){if(v.audio&&v.audio.length){var O=N;(typeof O>"u"||isNaN(O))&&(O=v.audio[0].dts),v.audio.forEach(function(Y){Y.dts=zg(Y.dts,O),Y.pts=zg(Y.pts,O),Y.dtsTime=Y.dts/Jd,Y.ptsTime=Y.pts/Jd})}if(v.video&&v.video.length){var M=N;if((typeof M>"u"||isNaN(M))&&(M=v.video[0].dts),v.video.forEach(function(Y){Y.dts=zg(Y.dts,M),Y.pts=zg(Y.pts,M),Y.dtsTime=Y.dts/Jd,Y.ptsTime=Y.pts/Jd}),v.firstKeyFrame){var W=v.firstKeyFrame;W.dts=zg(W.dts,M),W.pts=zg(W.pts,M),W.dtsTime=W.dts/Jd,W.ptsTime=W.pts/Jd}}},BV=function(v){for(var N=!1,O=0,M=null,W=null,Y=0,ge=0,_e;v.length-ge>=3;){var ve=Ds.aac.parseType(v,ge);switch(ve){case"timed-metadata":if(v.length-ge<10){N=!0;break}if(Y=Ds.aac.parseId3TagSize(v,ge),Y>v.length){N=!0;break}W===null&&(_e=v.subarray(ge,ge+Y),W=Ds.aac.parseAacTimestamp(_e)),ge+=Y;break;case"audio":if(v.length-ge<7){N=!0;break}if(Y=Ds.aac.parseAdtsSize(v,ge),Y>v.length){N=!0;break}M===null&&(_e=v.subarray(ge,ge+Y),M=Ds.aac.parseSampleRate(_e)),O++,ge+=Y;break;default:ge++;break}if(N)return null}if(M===null||W===null)return null;var xe=Jd/M,Ue={audio:[{type:"audio",dts:W,pts:W},{type:"audio",dts:W+O*1024*xe,pts:W+O*1024*xe}]};return Ue},UV=function(v){var N={pid:null,table:null},O={};MV(v,N);for(var M in N.table)if(N.table.hasOwnProperty(M)){var W=N.table[M];switch(W){case jN.H264_STREAM_TYPE:O.video=[],OV(v,N,O),O.video.length===0&&delete O.video;break;case jN.ADTS_STREAM_TYPE:O.audio=[],HN(v,N,O),O.audio.length===0&&delete O.audio;break}}return O},jV=function(v,N){var O=Ds.aac.isLikelyAacData(v),M;return O?M=BV(v):M=UV(v),!M||!M.audio&&!M.video?null:(FV(M,N),M)},HV={inspect:jV,parseAudioPes_:HN};const VV=function(v,N){N.on("data",function(O){const M=O.initSegment;O.initSegment={data:M.buffer,byteOffset:M.byteOffset,byteLength:M.byteLength};const W=O.data;O.data=W.buffer,v.postMessage({action:"data",segment:O,byteOffset:W.byteOffset,byteLength:W.byteLength},[O.data])}),N.on("done",function(O){v.postMessage({action:"done"})}),N.on("gopInfo",function(O){v.postMessage({action:"gopInfo",gopInfo:O})}),N.on("videoSegmentTimingInfo",function(O){const M={start:{decode:Js.videoTsToSeconds(O.start.dts),presentation:Js.videoTsToSeconds(O.start.pts)},end:{decode:Js.videoTsToSeconds(O.end.dts),presentation:Js.videoTsToSeconds(O.end.pts)},baseMediaDecodeTime:Js.videoTsToSeconds(O.baseMediaDecodeTime)};O.prependedContentDuration&&(M.prependedContentDuration=Js.videoTsToSeconds(O.prependedContentDuration)),v.postMessage({action:"videoSegmentTimingInfo",videoSegmentTimingInfo:M})}),N.on("audioSegmentTimingInfo",function(O){const M={start:{decode:Js.videoTsToSeconds(O.start.dts),presentation:Js.videoTsToSeconds(O.start.pts)},end:{decode:Js.videoTsToSeconds(O.end.dts),presentation:Js.videoTsToSeconds(O.end.pts)},baseMediaDecodeTime:Js.videoTsToSeconds(O.baseMediaDecodeTime)};O.prependedContentDuration&&(M.prependedContentDuration=Js.videoTsToSeconds(O.prependedContentDuration)),v.postMessage({action:"audioSegmentTimingInfo",audioSegmentTimingInfo:M})}),N.on("id3Frame",function(O){v.postMessage({action:"id3Frame",id3Frame:O})}),N.on("caption",function(O){v.postMessage({action:"caption",caption:O})}),N.on("trackinfo",function(O){v.postMessage({action:"trackinfo",trackInfo:O})}),N.on("audioTimingInfo",function(O){v.postMessage({action:"audioTimingInfo",audioTimingInfo:{start:Js.videoTsToSeconds(O.start),end:Js.videoTsToSeconds(O.end)}})}),N.on("videoTimingInfo",function(O){v.postMessage({action:"videoTimingInfo",videoTimingInfo:{start:Js.videoTsToSeconds(O.start),end:Js.videoTsToSeconds(O.end)}})}),N.on("log",function(O){v.postMessage({action:"log",log:O})})};class VN{constructor(N,O){this.options=O||{},this.self=N,this.init()}init(){this.transmuxer&&this.transmuxer.dispose(),this.transmuxer=new BH.Transmuxer(this.options),VV(this.self,this.transmuxer)}pushMp4Captions(N){this.captionParser||(this.captionParser=new EV,this.captionParser.init());const O=new Uint8Array(N.data,N.byteOffset,N.byteLength),M=this.captionParser.parse(O,N.trackIds,N.timescales);this.self.postMessage({action:"mp4Captions",captions:M&&M.captions||[],logs:M&&M.logs||[],data:O.buffer},[O.buffer])}initMp4WebVttParser(N){this.webVttParser||(this.webVttParser=new BN);const O=new Uint8Array(N.data,N.byteOffset,N.byteLength);this.webVttParser.init(O)}getMp4WebVttText(N){this.webVttParser||(this.webVttParser=new BN);const O=new Uint8Array(N.data,N.byteOffset,N.byteLength),M=this.webVttParser.parseSegment(O);this.self.postMessage({action:"getMp4WebVttText",mp4VttCues:M||[],data:O.buffer},[O.buffer])}probeMp4StartTime({timescales:N,data:O}){const M=ab.startTime(N,O);this.self.postMessage({action:"probeMp4StartTime",startTime:M,data:O},[O.buffer])}probeMp4Tracks({data:N}){const O=ab.tracks(N);this.self.postMessage({action:"probeMp4Tracks",tracks:O,data:N},[N.buffer])}probeEmsgID3({data:N,offset:O}){const M=ab.getEmsgID3(N,O);this.self.postMessage({action:"probeEmsgID3",id3Frames:M,emsgData:N},[N.buffer])}probeTs({data:N,baseStartTime:O}){const M=typeof O=="number"&&!isNaN(O)?O*Js.ONE_SECOND_IN_TS:void 0,W=HV.inspect(N,M);let Y=null;W&&(Y={hasVideo:W.video&&W.video.length===2||!1,hasAudio:W.audio&&W.audio.length===2||!1},Y.hasVideo&&(Y.videoStart=W.video[0].ptsTime),Y.hasAudio&&(Y.audioStart=W.audio[0].ptsTime)),this.self.postMessage({action:"probeTs",result:Y,data:N},[N.buffer])}clearAllMp4Captions(){this.captionParser&&this.captionParser.clearAllCaptions()}clearParsedMp4Captions(){this.captionParser&&this.captionParser.clearParsedCaptions()}push(N){const O=new Uint8Array(N.data,N.byteOffset,N.byteLength);this.transmuxer.push(O)}reset(){this.transmuxer.reset()}setTimestampOffset(N){const O=N.timestampOffset||0;this.transmuxer.setBaseMediaDecodeTime(Math.round(Js.secondsToVideoTs(O)))}setAudioAppendStart(N){this.transmuxer.setAudioAppendStart(Math.ceil(Js.secondsToVideoTs(N.appendStart)))}setRemux(N){this.transmuxer.setRemux(N.remux)}flush(N){this.transmuxer.flush(),self.postMessage({action:"done",type:"transmuxed"})}endTimeline(){this.transmuxer.endTimeline(),self.postMessage({action:"endedtimeline",type:"transmuxed"})}alignGopsWith(N){this.transmuxer.alignGopsWith(N.gopsToAlignWith.slice())}}self.onmessage=function(v){if(v.data.action==="init"&&v.data.options){this.messageHandlers=new VN(self,v.data.options);return}this.messageHandlers||(this.messageHandlers=new VN(self)),v.data&&v.data.action&&v.data.action!=="init"&&this.messageHandlers[v.data.action]&&this.messageHandlers[v.data.action](v.data)}}));var U5=eL(B5);const j5=(r,e,s)=>{const{type:a,initSegment:h,captions:p,captionStreams:_,metadata:w,videoFrameDtsTime:I,videoFramePtsTime:B}=r.data.segment;e.buffer.push({captions:p,captionStreams:_,metadata:w});const G=r.data.segment.boxes||{data:r.data.segment.data},se={type:a,data:new Uint8Array(G.data,G.data.byteOffset,G.data.byteLength),initSegment:new Uint8Array(h.data,h.byteOffset,h.byteLength)};typeof I<"u"&&(se.videoFrameDtsTime=I),typeof B<"u"&&(se.videoFramePtsTime=B),s(se)},H5=({transmuxedData:r,callback:e})=>{r.buffer=[],e(r)},V5=(r,e)=>{e.gopInfo=r.data.gopInfo},sL=r=>{const{transmuxer:e,bytes:s,audioAppendStart:a,gopsToAlignWith:h,remux:p,onData:_,onTrackInfo:w,onAudioTimingInfo:I,onVideoTimingInfo:B,onVideoSegmentTimingInfo:G,onAudioSegmentTimingInfo:se,onId3:pe,onCaptions:Ee,onDone:Ie,onEndedTimeline:ce,onTransmuxerLog:Ve,isEndOfTimeline:Be,segment:Ke,triggerSegmentEventFn:ze}=r,it={buffer:[]};let lt=Be;const Et=Pt=>{e.currentTransmux===r&&(Pt.data.action==="data"&&j5(Pt,it,_),Pt.data.action==="trackinfo"&&w(Pt.data.trackInfo),Pt.data.action==="gopInfo"&&V5(Pt,it),Pt.data.action==="audioTimingInfo"&&I(Pt.data.audioTimingInfo),Pt.data.action==="videoTimingInfo"&&B(Pt.data.videoTimingInfo),Pt.data.action==="videoSegmentTimingInfo"&&G(Pt.data.videoSegmentTimingInfo),Pt.data.action==="audioSegmentTimingInfo"&&se(Pt.data.audioSegmentTimingInfo),Pt.data.action==="id3Frame"&&pe([Pt.data.id3Frame],Pt.data.id3Frame.dispatchType),Pt.data.action==="caption"&&Ee(Pt.data.caption),Pt.data.action==="endedtimeline"&&(lt=!1,ce()),Pt.data.action==="log"&&Ve(Pt.data.log),Pt.data.type==="transmuxed"&&(lt||(e.onmessage=null,H5({transmuxedData:it,callback:Ie}),nL(e))))},yt=()=>{const Pt={message:"Received an error message from the transmuxer worker",metadata:{errorType:Ye.Error.StreamingFailedToTransmuxSegment,segmentInfo:qd({segment:Ke})}};Ie(null,Pt)};if(e.onmessage=Et,e.onerror=yt,a&&e.postMessage({action:"setAudioAppendStart",appendStart:a}),Array.isArray(h)&&e.postMessage({action:"alignGopsWith",gopsToAlignWith:h}),typeof p<"u"&&e.postMessage({action:"setRemux",remux:p}),s.byteLength){const Pt=s instanceof ArrayBuffer?s:s.buffer,Ti=s instanceof ArrayBuffer?0:s.byteOffset;ze({type:"segmenttransmuxingstart",segment:Ke}),e.postMessage({action:"push",data:Pt,byteOffset:Ti,byteLength:s.byteLength},[Pt])}Be&&e.postMessage({action:"endTimeline"}),e.postMessage({action:"flush"})},nL=r=>{r.currentTransmux=null,r.transmuxQueue.length&&(r.currentTransmux=r.transmuxQueue.shift(),typeof r.currentTransmux=="function"?r.currentTransmux():sL(r.currentTransmux))},rL=(r,e)=>{r.postMessage({action:e}),nL(r)},aL=(r,e)=>{if(!e.currentTransmux){e.currentTransmux=r,rL(e,r);return}e.transmuxQueue.push(rL.bind(null,e,r))},$5=r=>{aL("reset",r)},z5=r=>{aL("endTimeline",r)},oL=r=>{if(!r.transmuxer.currentTransmux){r.transmuxer.currentTransmux=r,sL(r);return}r.transmuxer.transmuxQueue.push(r)};var W1={reset:$5,endTimeline:z5,transmux:oL,createTransmuxer:r=>{const e=new U5;e.currentTransmux=null,e.transmuxQueue=[];const s=e.terminate;return e.terminate=()=>(e.currentTransmux=null,e.transmuxQueue.length=0,s.call(e)),e.postMessage({action:"init",options:r}),e}};const Fg=function(r){const e=r.transmuxer,s=r.endAction||r.action,a=r.callback,h=Z({},r,{endAction:null,transmuxer:null,callback:null}),p=_=>{_.data.action===s&&(e.removeEventListener("message",p),_.data.data&&(_.data.data=new Uint8Array(_.data.data,r.byteOffset||0,r.byteLength||_.data.data.byteLength),r.data&&(r.data=_.data.data)),a(_.data))};if(e.addEventListener("message",p),r.data){const _=r.data instanceof ArrayBuffer;h.byteOffset=_?0:r.data.byteOffset,h.byteLength=r.data.byteLength;const w=[_?r.data:r.data.buffer];e.postMessage(h,w)}else e.postMessage(h)},Dl={FAILURE:2,TIMEOUT:-101,ABORTED:-102},lL="wvtt",q1=r=>{r.forEach(e=>{e.abort()})},W5=r=>({bandwidth:r.bandwidth,bytesReceived:r.bytesReceived||0,roundTripTime:r.roundTripTime||0}),q5=r=>{const e=r.target,a={bandwidth:1/0,bytesReceived:0,roundTripTime:Date.now()-e.requestTime||0};return a.bytesReceived=r.loaded,a.bandwidth=Math.floor(a.bytesReceived/a.roundTripTime*8*1e3),a},G1=(r,e)=>{const{requestType:s}=e,a=Wd({requestType:s,request:e,error:r});return e.timedout?{status:e.status,message:"HLS request timed-out at URL: "+e.uri,code:Dl.TIMEOUT,xhr:e,metadata:a}:e.aborted?{status:e.status,message:"HLS request aborted at URL: "+e.uri,code:Dl.ABORTED,xhr:e,metadata:a}:r?{status:e.status,message:"HLS request errored at URL: "+e.uri,code:Dl.FAILURE,xhr:e,metadata:a}:e.responseType==="arraybuffer"&&e.response.byteLength===0?{status:e.status,message:"Empty HLS response at URL: "+e.uri,code:Dl.FAILURE,xhr:e,metadata:a}:null},uL=(r,e,s,a)=>(h,p)=>{const _=p.response,w=G1(h,p);if(w)return s(w,r);if(_.byteLength!==16)return s({status:p.status,message:"Invalid HLS key at URL: "+p.uri,code:Dl.FAILURE,xhr:p},r);const I=new DataView(_),B=new Uint32Array([I.getUint32(0),I.getUint32(4),I.getUint32(8),I.getUint32(12)]);for(let se=0;se<e.length;se++)e[se].bytes=B;const G={uri:p.uri};return a({type:"segmentkeyloadcomplete",segment:r,keyInfo:G}),s(null,r)},G5=(r,e)=>{e===lL&&r.transmuxer.postMessage({action:"initMp4WebVttParser",data:r.map.bytes})},X5=(r,e,s)=>{e===lL&&Fg({action:"getMp4WebVttText",data:r.bytes,transmuxer:r.transmuxer,callback:({data:a,mp4VttCues:h})=>{r.bytes=a,s(null,r,{mp4VttCues:h})}})},hL=(r,e)=>{const s=I1(r.map.bytes);if(s!=="mp4"){const a=r.map.resolvedUri||r.map.uri,h=s||"unknown";return e({internal:!0,message:`Found unsupported ${h} container for initialization segment at URL: ${a}`,code:Dl.FAILURE,metadata:{mediaType:h}})}Fg({action:"probeMp4Tracks",data:r.map.bytes,transmuxer:r.transmuxer,callback:({tracks:a,data:h})=>(r.map.bytes=h,a.forEach(function(p){r.map.tracks=r.map.tracks||{},!r.map.tracks[p.type]&&(r.map.tracks[p.type]=p,typeof p.id=="number"&&p.timescale&&(r.map.timescales=r.map.timescales||{},r.map.timescales[p.id]=p.timescale),p.type==="text"&&G5(r,p.codec))}),e(null))})},K5=({segment:r,finishProcessingFn:e,triggerSegmentEventFn:s})=>(a,h)=>{const p=G1(a,h);if(p)return e(p,r);const _=new Uint8Array(h.response);if(s({type:"segmentloaded",segment:r}),r.map.key)return r.map.encryptedBytes=_,e(null,r);r.map.bytes=_,hL(r,function(w){if(w)return w.xhr=h,w.status=h.status,e(w,r);e(null,r)})},Y5=({segment:r,finishProcessingFn:e,responseType:s,triggerSegmentEventFn:a})=>(h,p)=>{const _=G1(h,p);if(_)return e(_,r);a({type:"segmentloaded",segment:r});const w=s==="arraybuffer"||!p.responseText?p.response:O5(p.responseText.substring(r.lastReachedChar||0));return r.stats=W5(p),r.key?r.encryptedBytes=new Uint8Array(w):r.bytes=new Uint8Array(w),e(null,r)},Z5=({segment:r,bytes:e,trackInfoFn:s,timingInfoFn:a,videoSegmentTimingInfoFn:h,audioSegmentTimingInfoFn:p,id3Fn:_,captionsFn:w,isEndOfTimeline:I,endedTimelineFn:B,dataFn:G,doneFn:se,onTransmuxerLog:pe,triggerSegmentEventFn:Ee})=>{const Ie=r.map&&r.map.tracks||{},ce=!!(Ie.audio&&Ie.video);let Ve=a.bind(null,r,"audio","start");const Be=a.bind(null,r,"audio","end");let Ke=a.bind(null,r,"video","start");const ze=a.bind(null,r,"video","end"),it=()=>oL({bytes:e,transmuxer:r.transmuxer,audioAppendStart:r.audioAppendStart,gopsToAlignWith:r.gopsToAlignWith,remux:ce,onData:lt=>{lt.type=lt.type==="combined"?"video":lt.type,G(r,lt)},onTrackInfo:lt=>{s&&(ce&&(lt.isMuxed=!0),s(r,lt))},onAudioTimingInfo:lt=>{Ve&&typeof lt.start<"u"&&(Ve(lt.start),Ve=null),Be&&typeof lt.end<"u"&&Be(lt.end)},onVideoTimingInfo:lt=>{Ke&&typeof lt.start<"u"&&(Ke(lt.start),Ke=null),ze&&typeof lt.end<"u"&&ze(lt.end)},onVideoSegmentTimingInfo:lt=>{const Et={pts:{start:lt.start.presentation,end:lt.end.presentation},dts:{start:lt.start.decode,end:lt.end.decode}};Ee({type:"segmenttransmuxingtiminginfoavailable",segment:r,timingInfo:Et}),h(lt)},onAudioSegmentTimingInfo:lt=>{const Et={pts:{start:lt.start.pts,end:lt.end.pts},dts:{start:lt.start.dts,end:lt.end.dts}};Ee({type:"segmenttransmuxingtiminginfoavailable",segment:r,timingInfo:Et}),p(lt)},onId3:(lt,Et)=>{_(r,lt,Et)},onCaptions:lt=>{w(r,[lt])},isEndOfTimeline:I,onEndedTimeline:()=>{B()},onTransmuxerLog:pe,onDone:(lt,Et)=>{se&&(lt.type=lt.type==="combined"?"video":lt.type,Ee({type:"segmenttransmuxingcomplete",segment:r}),se(Et,r,lt))},segment:r,triggerSegmentEventFn:Ee});Fg({action:"probeTs",transmuxer:r.transmuxer,data:e,baseStartTime:r.baseStartTime,callback:lt=>{r.bytes=e=lt.data;const Et=lt.result;Et&&(s(r,{hasAudio:Et.hasAudio,hasVideo:Et.hasVideo,isMuxed:ce}),s=null),it()}})},cL=({segment:r,bytes:e,trackInfoFn:s,timingInfoFn:a,videoSegmentTimingInfoFn:h,audioSegmentTimingInfoFn:p,id3Fn:_,captionsFn:w,isEndOfTimeline:I,endedTimelineFn:B,dataFn:G,doneFn:se,onTransmuxerLog:pe,triggerSegmentEventFn:Ee})=>{let Ie=new Uint8Array(e);if($U(Ie)){r.isFmp4=!0;const{tracks:ce}=r.map;if(ce.text&&(!ce.audio||!ce.video)){G(r,{data:Ie,type:"text"}),X5(r,ce.text.codec,se);return}const Be={isFmp4:!0,hasVideo:!!ce.video,hasAudio:!!ce.audio};ce.audio&&ce.audio.codec&&ce.audio.codec!=="enca"&&(Be.audioCodec=ce.audio.codec),ce.video&&ce.video.codec&&ce.video.codec!=="encv"&&(Be.videoCodec=ce.video.codec),ce.video&&ce.audio&&(Be.isMuxed=!0),s(r,Be);const Ke=(ze,it)=>{G(r,{data:Ie,type:Be.hasAudio&&!Be.isMuxed?"audio":"video"}),it&&it.length&&_(r,it),ze&&ze.length&&w(r,ze),se(null,r,{})};Fg({action:"probeMp4StartTime",timescales:r.map.timescales,data:Ie,transmuxer:r.transmuxer,callback:({data:ze,startTime:it})=>{e=ze.buffer,r.bytes=Ie=ze,Be.hasAudio&&!Be.isMuxed&&a(r,"audio","start",it),Be.hasVideo&&a(r,"video","start",it),Fg({action:"probeEmsgID3",data:Ie,transmuxer:r.transmuxer,offset:it,callback:({emsgData:lt,id3Frames:Et})=>{if(e=lt.buffer,r.bytes=Ie=lt,!ce.video||!lt.byteLength||!r.transmuxer){Ke(void 0,Et);return}Fg({action:"pushMp4Captions",endAction:"mp4Captions",transmuxer:r.transmuxer,data:Ie,timescales:r.map.timescales,trackIds:[ce.video.id],callback:yt=>{e=yt.data.buffer,r.bytes=Ie=yt.data,yt.logs.forEach(function(Pt){pe(As(Pt,{stream:"mp4CaptionParser"}))}),Ke(yt.captions,Et)}})}})}});return}if(!r.transmuxer){se(null,r,{});return}if(typeof r.container>"u"&&(r.container=I1(Ie)),r.container!=="ts"&&r.container!=="aac"){s(r,{hasAudio:!1,hasVideo:!1}),se(null,r,{});return}Z5({segment:r,bytes:e,trackInfoFn:s,timingInfoFn:a,videoSegmentTimingInfoFn:h,audioSegmentTimingInfoFn:p,id3Fn:_,captionsFn:w,isEndOfTimeline:I,endedTimelineFn:B,dataFn:G,doneFn:se,onTransmuxerLog:pe,triggerSegmentEventFn:Ee})},dL=function({id:r,key:e,encryptedBytes:s,decryptionWorker:a,segment:h,doneFn:p},_){const w=B=>{if(B.data.source===r){a.removeEventListener("message",w);const G=B.data.decrypted;_(new Uint8Array(G.bytes,G.byteOffset,G.byteLength))}};a.onerror=()=>{const B="An error occurred in the decryption worker",G=qd({segment:h}),se={message:B,metadata:{error:new Error(B),errorType:Ye.Error.StreamingFailedToDecryptSegment,segmentInfo:G,keyInfo:{uri:h.key.resolvedUri||h.map.key.resolvedUri}}};p(se,h)},a.addEventListener("message",w);let I;e.bytes.slice?I=e.bytes.slice():I=new Uint32Array(Array.prototype.slice.call(e.bytes)),a.postMessage(qI({source:r,encrypted:s,key:I,iv:e.iv}),[s.buffer,I.buffer])},Q5=({decryptionWorker:r,segment:e,trackInfoFn:s,timingInfoFn:a,videoSegmentTimingInfoFn:h,audioSegmentTimingInfoFn:p,id3Fn:_,captionsFn:w,isEndOfTimeline:I,endedTimelineFn:B,dataFn:G,doneFn:se,onTransmuxerLog:pe,triggerSegmentEventFn:Ee})=>{Ee({type:"segmentdecryptionstart"}),dL({id:e.requestId,key:e.key,encryptedBytes:e.encryptedBytes,decryptionWorker:r,segment:e,doneFn:se},Ie=>{e.bytes=Ie,Ee({type:"segmentdecryptioncomplete",segment:e}),cL({segment:e,bytes:e.bytes,trackInfoFn:s,timingInfoFn:a,videoSegmentTimingInfoFn:h,audioSegmentTimingInfoFn:p,id3Fn:_,captionsFn:w,isEndOfTimeline:I,endedTimelineFn:B,dataFn:G,doneFn:se,onTransmuxerLog:pe,triggerSegmentEventFn:Ee})})},J5=({activeXhrs:r,decryptionWorker:e,trackInfoFn:s,timingInfoFn:a,videoSegmentTimingInfoFn:h,audioSegmentTimingInfoFn:p,id3Fn:_,captionsFn:w,isEndOfTimeline:I,endedTimelineFn:B,dataFn:G,doneFn:se,onTransmuxerLog:pe,triggerSegmentEventFn:Ee})=>{let Ie=0,ce=!1;return(Ve,Be)=>{if(!ce){if(Ve)return ce=!0,q1(r),se(Ve,Be);if(Ie+=1,Ie===r.length){const Ke=function(){if(Be.encryptedBytes)return Q5({decryptionWorker:e,segment:Be,trackInfoFn:s,timingInfoFn:a,videoSegmentTimingInfoFn:h,audioSegmentTimingInfoFn:p,id3Fn:_,captionsFn:w,isEndOfTimeline:I,endedTimelineFn:B,dataFn:G,doneFn:se,onTransmuxerLog:pe,triggerSegmentEventFn:Ee});cL({segment:Be,bytes:Be.bytes,trackInfoFn:s,timingInfoFn:a,videoSegmentTimingInfoFn:h,audioSegmentTimingInfoFn:p,id3Fn:_,captionsFn:w,isEndOfTimeline:I,endedTimelineFn:B,dataFn:G,doneFn:se,onTransmuxerLog:pe,triggerSegmentEventFn:Ee})};if(Be.endOfAllRequests=Date.now(),Be.map&&Be.map.encryptedBytes&&!Be.map.bytes)return Ee({type:"segmentdecryptionstart",segment:Be}),dL({decryptionWorker:e,id:Be.requestId+"-init",encryptedBytes:Be.map.encryptedBytes,key:Be.map.key,segment:Be,doneFn:se},ze=>{Be.map.bytes=ze,Ee({type:"segmentdecryptioncomplete",segment:Be}),hL(Be,it=>{if(it)return q1(r),se(it,Be);Ke()})});Ke()}}}},e6=({loadendState:r,abortFn:e})=>s=>{s.target.aborted&&e&&!r.calledAbortFn&&(e(),r.calledAbortFn=!0)},t6=({segment:r,progressFn:e,trackInfoFn:s,timingInfoFn:a,videoSegmentTimingInfoFn:h,audioSegmentTimingInfoFn:p,id3Fn:_,captionsFn:w,isEndOfTimeline:I,endedTimelineFn:B,dataFn:G})=>se=>{if(!se.target.aborted)return r.stats=As(r.stats,q5(se)),!r.stats.firstBytesReceivedAt&&r.stats.bytesReceived&&(r.stats.firstBytesReceivedAt=Date.now()),e(se,r)},i6=({xhr:r,xhrOptions:e,decryptionWorker:s,segment:a,abortFn:h,progressFn:p,trackInfoFn:_,timingInfoFn:w,videoSegmentTimingInfoFn:I,audioSegmentTimingInfoFn:B,id3Fn:G,captionsFn:se,isEndOfTimeline:pe,endedTimelineFn:Ee,dataFn:Ie,doneFn:ce,onTransmuxerLog:Ve,triggerSegmentEventFn:Be})=>{const Ke=[],ze=J5({activeXhrs:Ke,decryptionWorker:s,trackInfoFn:_,timingInfoFn:w,videoSegmentTimingInfoFn:I,audioSegmentTimingInfoFn:B,id3Fn:G,captionsFn:se,isEndOfTimeline:pe,endedTimelineFn:Ee,dataFn:Ie,doneFn:ce,onTransmuxerLog:Ve,triggerSegmentEventFn:Be});if(a.key&&!a.key.bytes){const Pt=[a.key];a.map&&!a.map.bytes&&a.map.key&&a.map.key.resolvedUri===a.key.resolvedUri&&Pt.push(a.map.key);const Ti=As(e,{uri:a.key.resolvedUri,responseType:"arraybuffer",requestType:"segment-key"}),Ms=uL(a,Pt,ze,Be),us={uri:a.key.resolvedUri};Be({type:"segmentkeyloadstart",segment:a,keyInfo:us});const Vs=r(Ti,Ms);Ke.push(Vs)}if(a.map&&!a.map.bytes){if(a.map.key&&(!a.key||a.key.resolvedUri!==a.map.key.resolvedUri)){const Vs=As(e,{uri:a.map.key.resolvedUri,responseType:"arraybuffer",requestType:"segment-key"}),ai=uL(a,[a.map.key],ze,Be),cs={uri:a.map.key.resolvedUri};Be({type:"segmentkeyloadstart",segment:a,keyInfo:cs});const Yr=r(Vs,ai);Ke.push(Yr)}const Ti=As(e,{uri:a.map.resolvedUri,responseType:"arraybuffer",headers:V1(a.map),requestType:"segment-media-initialization"}),Ms=K5({segment:a,finishProcessingFn:ze,triggerSegmentEventFn:Be});Be({type:"segmentloadstart",segment:a});const us=r(Ti,Ms);Ke.push(us)}const it=As(e,{uri:a.part&&a.part.resolvedUri||a.resolvedUri,responseType:"arraybuffer",headers:V1(a),requestType:"segment"}),lt=Y5({segment:a,finishProcessingFn:ze,responseType:it.responseType,triggerSegmentEventFn:Be});Be({type:"segmentloadstart",segment:a});const Et=r(it,lt);Et.addEventListener("progress",t6({segment:a,progressFn:p,trackInfoFn:_,timingInfoFn:w,videoSegmentTimingInfoFn:I,audioSegmentTimingInfoFn:B,id3Fn:G,captionsFn:se,isEndOfTimeline:pe,endedTimelineFn:Ee,dataFn:Ie})),Ke.push(Et);const yt={};return Ke.forEach(Pt=>{Pt.addEventListener("loadend",e6({loadendState:yt,abortFn:h}))}),()=>q1(Ke)},YT=mo("PlaylistSelector"),fL=function(r){if(!r||!r.playlist)return;const e=r.playlist;return JSON.stringify({id:e.id,bandwidth:r.bandwidth,width:r.width,height:r.height,codecs:e.attributes&&e.attributes.CODECS||""})},Bg=function(r,e){if(!r)return"";const s=window.getComputedStyle(r);return s?s[e]:""},Ug=function(r,e){const s=r.slice();r.sort(function(a,h){const p=e(a,h);return p===0?s.indexOf(a)-s.indexOf(h):p})},X1=function(r,e){let s,a;return r.attributes.BANDWIDTH&&(s=r.attributes.BANDWIDTH),s=s||window.Number.MAX_VALUE,e.attributes.BANDWIDTH&&(a=e.attributes.BANDWIDTH),a=a||window.Number.MAX_VALUE,s-a},s6=function(r,e){let s,a;return r.attributes.RESOLUTION&&r.attributes.RESOLUTION.width&&(s=r.attributes.RESOLUTION.width),s=s||window.Number.MAX_VALUE,e.attributes.RESOLUTION&&e.attributes.RESOLUTION.width&&(a=e.attributes.RESOLUTION.width),a=a||window.Number.MAX_VALUE,s===a&&r.attributes.BANDWIDTH&&e.attributes.BANDWIDTH?r.attributes.BANDWIDTH-e.attributes.BANDWIDTH:s-a};let pL=function(r){const{main:e,bandwidth:s,playerWidth:a,playerHeight:h,playerObjectFit:p,limitRenditionByPlayerDimensions:_,playlistController:w}=r;if(!e)return;const I={bandwidth:s,width:a,height:h,limitRenditionByPlayerDimensions:_};let B=e.playlists;_a.isAudioOnly(e)&&(B=w.getAudioTrackPlaylists_(),I.audioOnly=!0);let G=B.map(yt=>{let Pt;const Ti=yt.attributes&&yt.attributes.RESOLUTION&&yt.attributes.RESOLUTION.width,Ms=yt.attributes&&yt.attributes.RESOLUTION&&yt.attributes.RESOLUTION.height;return Pt=yt.attributes&&yt.attributes.BANDWIDTH,Pt=Pt||window.Number.MAX_VALUE,{bandwidth:Pt,width:Ti,height:Ms,playlist:yt}});Ug(G,(yt,Pt)=>yt.bandwidth-Pt.bandwidth),G=G.filter(yt=>!_a.isIncompatible(yt.playlist));let se=G.filter(yt=>_a.isEnabled(yt.playlist));se.length||(se=G.filter(yt=>!_a.isDisabled(yt.playlist)));const pe=se.filter(yt=>yt.bandwidth*hr.BANDWIDTH_VARIANCE<s);let Ee=pe[pe.length-1];const Ie=pe.filter(yt=>yt.bandwidth===Ee.bandwidth)[0];if(_===!1){const yt=Ie||se[0]||G[0];if(yt&&yt.playlist){let Pt="sortedPlaylistReps";return Ie&&(Pt="bandwidthBestRep"),se[0]&&(Pt="enabledPlaylistReps"),YT(`choosing ${fL(yt)} using ${Pt} with options`,I),yt.playlist}return YT("could not choose a playlist with options",I),null}const ce=pe.filter(yt=>yt.width&&yt.height);Ug(ce,(yt,Pt)=>yt.width-Pt.width);const Ve=ce.filter(yt=>yt.width===a&&yt.height===h);Ee=Ve[Ve.length-1];const Be=Ve.filter(yt=>yt.bandwidth===Ee.bandwidth)[0];let Ke,ze,it;Be||(Ke=ce.filter(yt=>p==="cover"?yt.width>a&&yt.height>h:yt.width>a||yt.height>h),ze=Ke.filter(yt=>yt.width===Ke[0].width&&yt.height===Ke[0].height),Ee=ze[ze.length-1],it=ze.filter(yt=>yt.bandwidth===Ee.bandwidth)[0]);let lt;if(w.leastPixelDiffSelector){const yt=ce.map(Pt=>(Pt.pixelDiff=Math.abs(Pt.width-a)+Math.abs(Pt.height-h),Pt));Ug(yt,(Pt,Ti)=>Pt.pixelDiff===Ti.pixelDiff?Ti.bandwidth-Pt.bandwidth:Pt.pixelDiff-Ti.pixelDiff),lt=yt[0]}const Et=lt||it||Be||Ie||se[0]||G[0];if(Et&&Et.playlist){let yt="sortedPlaylistReps";return lt?yt="leastPixelDiffRep":it?yt="resolutionPlusOneRep":Be?yt="resolutionBestRep":Ie?yt="bandwidthBestRep":se[0]&&(yt="enabledPlaylistReps"),YT(`choosing ${fL(Et)} using ${yt} with options`,I),Et.playlist}return YT("could not choose a playlist with options",I),null};const gL=function(){let r=this.useDevicePixelRatio&&window.devicePixelRatio||1;return isNaN(this.customPixelRatio)||(r=this.customPixelRatio),pL({main:this.playlists.main,bandwidth:this.systemBandwidth,playerWidth:parseInt(Bg(this.tech_.el(),"width"),10)*r,playerHeight:parseInt(Bg(this.tech_.el(),"height"),10)*r,playerObjectFit:this.usePlayerObjectFit?Bg(this.tech_.el(),"objectFit"):"",limitRenditionByPlayerDimensions:this.limitRenditionByPlayerDimensions,playlistController:this.playlistController_})},n6=function(r){let e=-1,s=-1;if(r<0||r>1)throw new Error("Moving average bandwidth decay must be between 0 and 1.");return function(){let a=this.useDevicePixelRatio&&window.devicePixelRatio||1;return isNaN(this.customPixelRatio)||(a=this.customPixelRatio),e<0&&(e=this.systemBandwidth,s=this.systemBandwidth),this.systemBandwidth>0&&this.systemBandwidth!==s&&(e=r*this.systemBandwidth+(1-r)*e,s=this.systemBandwidth),pL({main:this.playlists.main,bandwidth:e,playerWidth:parseInt(Bg(this.tech_.el(),"width"),10)*a,playerHeight:parseInt(Bg(this.tech_.el(),"height"),10)*a,playerObjectFit:this.usePlayerObjectFit?Bg(this.tech_.el(),"objectFit"):"",limitRenditionByPlayerDimensions:this.limitRenditionByPlayerDimensions,playlistController:this.playlistController_})}},r6=function(r){const{main:e,currentTime:s,bandwidth:a,duration:h,segmentDuration:p,timeUntilRebuffer:_,currentTimeline:w,syncController:I}=r,B=e.playlists.filter(Ie=>!_a.isIncompatible(Ie));let G=B.filter(_a.isEnabled);G.length||(G=B.filter(Ie=>!_a.isDisabled(Ie)));const pe=G.filter(_a.hasAttribute.bind(null,"BANDWIDTH")).map(Ie=>{const Ve=I.getSyncPoint(Ie,h,w,s)?1:2,Ke=_a.estimateSegmentRequestTime(p,a,Ie)*Ve-_;return{playlist:Ie,rebufferingImpact:Ke}}),Ee=pe.filter(Ie=>Ie.rebufferingImpact<=0);return Ug(Ee,(Ie,ce)=>X1(ce.playlist,Ie.playlist)),Ee.length?Ee[0]:(Ug(pe,(Ie,ce)=>Ie.rebufferingImpact-ce.rebufferingImpact),pe[0]||null)},a6=function(){const r=this.playlists.main.playlists.filter(_a.isEnabled);return Ug(r,(s,a)=>X1(s,a)),r.filter(s=>!!G_(this.playlists.main,s).video)[0]||null},o6=r=>{let e=0,s;return r.bytes&&(s=new Uint8Array(r.bytes),r.segments.forEach(a=>{s.set(a,e),e+=a.byteLength})),s};function mL(r){try{return new URL(r).pathname.split("/").slice(-2).join("/")}catch{return""}}const l6=function(r,e,s){if(!r[s]){e.trigger({type:"usage",name:"vhs-608"});let a=s;/^cc708_/.test(s)&&(a="SERVICE"+s.split("_")[1]);const h=e.textTracks().getTrackById(a);if(h)r[s]=h;else{const p=e.options_.vhs&&e.options_.vhs.captionServices||{};let _=s,w=s,I=!1;const B=p[a];B&&(_=B.label,w=B.language,I=B.default),r[s]=e.addRemoteTextTrack({kind:"captions",id:a,default:I,label:_,language:w},!1).track}}},u6=function({inbandTextTracks:r,captionArray:e,timestampOffset:s}){if(!e)return;const a=window.WebKitDataCue||window.VTTCue;e.forEach(h=>{const p=h.stream;h.content?h.content.forEach(_=>{const w=new a(h.startTime+s,h.endTime+s,_.text);w.line=_.line,w.align="left",w.position=_.position,w.positionAlign="line-left",r[p].addCue(w)}):r[p].addCue(new a(h.startTime+s,h.endTime+s,h.text))})},h6=function(r){Object.defineProperties(r.frame,{id:{get(){return Ye.log.warn("cue.frame.id is deprecated. Use cue.value.key instead."),r.value.key}},value:{get(){return Ye.log.warn("cue.frame.value is deprecated. Use cue.value.data instead."),r.value.data}},privateData:{get(){return Ye.log.warn("cue.frame.privateData is deprecated. Use cue.value.data instead."),r.value.data}}})},c6=({inbandTextTracks:r,metadataArray:e,timestampOffset:s,videoDuration:a})=>{if(!e)return;const h=window.WebKitDataCue||window.VTTCue,p=r.metadataTrack_;if(!p||(e.forEach(G=>{const se=G.cueTime+s;typeof se!="number"||window.isNaN(se)||se<0||!(se<1/0)||!G.frames||!G.frames.length||G.frames.forEach(pe=>{const Ee=new h(se,se,pe.value||pe.url||pe.data||"");Ee.frame=pe,Ee.value=pe,h6(Ee),p.addCue(Ee)})}),!p.cues||!p.cues.length))return;const _=p.cues,w=[];for(let G=0;G<_.length;G++)_[G]&&w.push(_[G]);const I=w.reduce((G,se)=>{const pe=G[se.startTime]||[];return pe.push(se),G[se.startTime]=pe,G},{}),B=Object.keys(I).sort((G,se)=>Number(G)-Number(se));B.forEach((G,se)=>{const pe=I[G],Ee=isFinite(a)?a:G,Ie=Number(B[se+1])||Ee;pe.forEach(ce=>{ce.endTime=Ie})})},d6={id:"ID",class:"CLASS",startDate:"START-DATE",duration:"DURATION",endDate:"END-DATE",endOnNext:"END-ON-NEXT",plannedDuration:"PLANNED-DURATION",scte35Out:"SCTE35-OUT",scte35In:"SCTE35-IN"},f6=new Set(["id","class","startDate","duration","endDate","endOnNext","startTime","endTime","processDateRange"]),p6=({inbandTextTracks:r,dateRanges:e})=>{const s=r.metadataTrack_;if(!s)return;const a=window.WebKitDataCue||window.VTTCue;e.forEach(h=>{for(const p of Object.keys(h)){if(f6.has(p))continue;const _=new a(h.startTime,h.endTime,"");_.id=h.id,_.type="com.apple.quicktime.HLS",_.value={key:d6[p],data:h[p]},(p==="scte35Out"||p==="scte35In")&&(_.value.data=new Uint8Array(_.value.data.match(/[\da-f]{2}/gi)).buffer),s.addCue(_)}h.processDateRange()})},_L=(r,e,s)=>{r.metadataTrack_||(r.metadataTrack_=s.addRemoteTextTrack({kind:"metadata",label:"Timed Metadata"},!1).track,Ye.browser.IS_ANY_SAFARI||(r.metadataTrack_.inBandMetadataTrackDispatchType=e))},X_=function(r,e,s){let a,h;if(s&&s.cues)for(a=s.cues.length;a--;)h=s.cues[a],h.startTime>=r&&h.endTime<=e&&s.removeCue(h)},g6=function(r){const e=r.cues;if(!e)return;const s={};for(let a=e.length-1;a>=0;a--){const h=e[a],p=`${h.startTime}-${h.endTime}-${h.text}`;s[p]?r.removeCue(h):s[p]=h}},m6=(r,e,s)=>{if(typeof e>"u"||e===null||!r.length)return[];const a=Math.ceil((e-s+3)*$d);let h;for(h=0;h<r.length&&!(r[h].pts>a);h++);return r.slice(h)},_6=(r,e,s)=>{if(!e.length)return r;if(s)return e.slice();const a=e[0].pts;let h=0;for(h;h<r.length&&!(r[h].pts>=a);h++);return r.slice(0,h).concat(e)},b6=(r,e,s,a)=>{const h=Math.ceil((e-a)*$d),p=Math.ceil((s-a)*$d),_=r.slice();let w=r.length;for(;w--&&!(r[w].pts<=p););if(w===-1)return _;let I=w+1;for(;I--&&!(r[I].pts<=h););return I=Math.max(I,0),_.splice(I,w-I+1),_},y6=function(r,e){if(!r&&!e||!r&&e||r&&!e)return!1;if(r===e)return!0;const s=Object.keys(r).sort(),a=Object.keys(e).sort();if(s.length!==a.length)return!1;for(let h=0;h<s.length;h++){const p=s[h];if(p!==a[h]||r[p]!==e[p])return!1}return!0},v6=function(r,e,s){e=e||[];const a=[];let h=0;for(let p=0;p<e.length;p++){const _=e[p];if(r===_.timeline&&(a.push(p),h+=_.duration,h>s))return p}return a.length===0?0:a[a.length-1]},K_=1,w6=500,bL=r=>typeof r=="number"&&isFinite(r),ZT=1/60,T6=(r,e,s)=>r!=="main"||!e||!s?null:!s.hasAudio&&!s.hasVideo?"Neither audio nor video found in segment.":e.hasVideo&&!s.hasVideo?"Only audio found in segment when we expected video. We can't switch to audio only from a stream that had video. To get rid of this message, please add codec information to the manifest.":!e.hasVideo&&s.hasVideo?"Video found in segment when we expected only audio. We can't switch to a stream with video from an audio only stream. To get rid of this message, please add codec information to the manifest.":null,E6=(r,e,s)=>{let a=e-hr.BACK_BUFFER_LENGTH;r.length&&(a=Math.max(a,r.start(0)));const h=e-s;return Math.min(h,a)},jg=r=>{const{startOfSegment:e,duration:s,segment:a,part:h,playlist:{mediaSequence:p,id:_,segments:w=[]},mediaIndex:I,partIndex:B,timeline:G}=r,se=w.length-1;let pe="mediaIndex/partIndex increment";r.getMediaInfoForTime?pe=`getMediaInfoForTime (${r.getMediaInfoForTime})`:r.isSyncRequest&&(pe="getSyncSegmentCandidate (isSyncRequest)"),r.independent&&(pe+=` with independent ${r.independent}`);const Ee=typeof B=="number",Ie=r.segment.uri?"segment":"pre-segment",ce=Ee?SI({preloadSegment:a})-1:0;return`${Ie} [${p+I}/${p+se}]`+(Ee?` part [${B}/${ce}]`:"")+` segment start/end [${a.start} => ${a.end}]`+(Ee?` part start/end [${h.start} => ${h.end}]`:"")+` startOfSegment [${e}] duration [${s}] timeline [${G}] selected by [${pe}] playlist [${_}]`},yL=r=>`${r}TimingInfo`,S6=({segmentTimeline:r,currentTimeline:e,startOfSegment:s,buffered:a,overrideCheck:h})=>!h&&r===e?null:r<e?s:a.length?a.end(a.length-1):s,K1=({timelineChangeController:r,currentTimeline:e,segmentTimeline:s,loaderType:a,audioDisabled:h})=>{if(e===s)return!1;if(a==="audio"){const p=r.lastTimelineChange({type:"main"});return!p||p.to!==s}if(a==="main"&&h){const p=r.pendingTimelineChange({type:"audio"});return!(p&&p.to===s)}return!1},x6=r=>{if(!r)return!1;const e=r.pendingTimelineChange({type:"audio"}),s=r.pendingTimelineChange({type:"main"}),a=e&&s,h=a&&e.to!==s.to;return!!(a&&e.from!==-1&&s.from!==-1&&h)},A6=r=>{const e=r.timelineChangeController_.pendingTimelineChange({type:"audio"}),s=r.timelineChangeController_.pendingTimelineChange({type:"main"});return e&&s&&e.to<s.to},Zh=r=>{const e=r.pendingSegment_;if(!e)return;if(K1({timelineChangeController:r.timelineChangeController_,currentTimeline:r.currentTimeline_,segmentTimeline:e.timeline,loaderType:r.loaderType_,audioDisabled:r.audioDisabled_})&&x6(r.timelineChangeController_)){if(A6(r)){r.timelineChangeController_.trigger("audioTimelineBehind");return}r.timelineChangeController_.trigger("fixBadTimelineChange")}},C6=r=>{let e=0;return["video","audio"].forEach(function(s){const a=r[`${s}TimingInfo`];if(!a)return;const{start:h,end:p}=a;let _;typeof h=="bigint"||typeof p=="bigint"?_=window.BigInt(p)-window.BigInt(h):typeof h=="number"&&typeof p=="number"&&(_=p-h),typeof _<"u"&&_>e&&(e=_)}),typeof e=="bigint"&&e<Number.MAX_SAFE_INTEGER&&(e=Number(e)),e},vL=({segmentDuration:r,maxDuration:e})=>r?Math.round(r)>e+kl:!1,k6=(r,e)=>{if(e!=="hls")return null;const s=C6({audioTimingInfo:r.audioTimingInfo,videoTimingInfo:r.videoTimingInfo});if(!s)return null;const a=r.playlist.targetDuration,h=vL({segmentDuration:s,maxDuration:a*2}),p=vL({segmentDuration:s,maxDuration:a}),_=`Segment with index ${r.mediaIndex} from playlist ${r.playlist.id} has a duration of ${s} when the reported duration is ${r.duration} and the target duration is ${a}. For HLS content, a duration in excess of the target duration may result in playback issues. See the HLS specification section on EXT-X-TARGETDURATION for more details: https://tools.ietf.org/html/draft-pantos-http-live-streaming-23#section-4.3.3.1`;return h||p?{severity:h?"warn":"info",message:_}:null},qd=({type:r,segment:e})=>{if(!e)return;const s=!!(e.key||e.map&&e.map.ke),a=!!(e.map&&!e.map.bytes),h=e.startOfSegment===void 0?e.start:e.startOfSegment;return{type:r||e.type,uri:e.resolvedUri||e.uri,start:h,duration:e.duration,isEncrypted:s,isMediaInitialization:a}};class Y1 extends Ye.EventTarget{constructor(e,s={}){if(super(),!e)throw new TypeError("Initialization settings are required");if(typeof e.currentTime!="function")throw new TypeError("No currentTime getter specified");if(!e.mediaSource)throw new TypeError("No MediaSource specified");this.bandwidth=e.bandwidth,this.throughput={rate:0,count:0},this.roundTrip=NaN,this.resetStats_(),this.mediaIndex=null,this.partIndex=null,this.hasPlayed_=e.hasPlayed,this.currentTime_=e.currentTime,this.seekable_=e.seekable,this.seeking_=e.seeking,this.duration_=e.duration,this.mediaSource_=e.mediaSource,this.vhs_=e.vhs,this.loaderType_=e.loaderType,this.currentMediaInfo_=void 0,this.startingMediaInfo_=void 0,this.segmentMetadataTrack_=e.segmentMetadataTrack,this.goalBufferLength_=e.goalBufferLength,this.sourceType_=e.sourceType,this.sourceUpdater_=e.sourceUpdater,this.inbandTextTracks_=e.inbandTextTracks,this.state_="INIT",this.timelineChangeController_=e.timelineChangeController,this.shouldSaveSegmentTimingInfo_=!0,this.parse708captions_=e.parse708captions,this.useDtsForTimestampOffset_=e.useDtsForTimestampOffset,this.captionServices_=e.captionServices,this.exactManifestTimings=e.exactManifestTimings,this.addMetadataToTextTrack=e.addMetadataToTextTrack,this.checkBufferTimeout_=null,this.error_=void 0,this.currentTimeline_=-1,this.shouldForceTimestampOffsetAfterResync_=!1,this.pendingSegment_=null,this.xhrOptions_=null,this.pendingSegments_=[],this.audioDisabled_=!1,this.isPendingTimestampOffset_=!1,this.gopBuffer_=[],this.timeMapping_=0,this.safeAppend_=!1,this.appendInitSegment_={audio:!0,video:!0},this.playlistOfLastInitSegment_={audio:null,video:null},this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_={id3:[],caption:[]},this.waitingOnRemove_=!1,this.quotaExceededErrorRetryTimeout_=null,this.activeInitSegmentId_=null,this.initSegments_={},this.cacheEncryptionKeys_=e.cacheEncryptionKeys,this.keyCache_={},this.decrypter_=e.decrypter,this.syncController_=e.syncController,this.syncPoint_={segmentIndex:0,time:0},this.transmuxer_=this.createTransmuxer_(),this.triggerSyncInfoUpdate_=()=>this.trigger("syncinfoupdate"),this.syncController_.on("syncinfoupdate",this.triggerSyncInfoUpdate_),this.mediaSource_.addEventListener("sourceopen",()=>{this.isEndOfStream_()||(this.ended_=!1)}),this.fetchAtBuffer_=!1,this.logger_=mo(`SegmentLoader[${this.loaderType_}]`),Object.defineProperty(this,"state",{get(){return this.state_},set(a){a!==this.state_&&(this.logger_(`${this.state_} -> ${a}`),this.state_=a,this.trigger("statechange"))}}),this.sourceUpdater_.on("ready",()=>{this.hasEnoughInfoToAppend_()?this.processCallQueue_():Zh(this)}),this.sourceUpdater_.on("codecschange",a=>{this.trigger(Z({type:"codecschange"},a))}),this.loaderType_==="main"&&this.timelineChangeController_.on("pendingtimelinechange",()=>{this.hasEnoughInfoToAppend_()?this.processCallQueue_():Zh(this)}),this.loaderType_==="audio"&&this.timelineChangeController_.on("timelinechange",a=>{this.trigger(Z({type:"timelinechange"},a)),this.hasEnoughInfoToLoad_()?this.processLoadQueue_():Zh(this),this.hasEnoughInfoToAppend_()?this.processCallQueue_():Zh(this)})}get mediaSequenceSync_(){return this.syncController_.getMediaSequenceSync(this.loaderType_)}createTransmuxer_(){return W1.createTransmuxer({remux:!1,alignGopsAtEnd:this.safeAppend_,keepOriginalTimestamps:!0,parse708captions:this.parse708captions_,captionServices:this.captionServices_})}resetStats_(){this.mediaBytesTransferred=0,this.mediaRequests=0,this.mediaRequestsAborted=0,this.mediaRequestsTimedout=0,this.mediaRequestsErrored=0,this.mediaTransferDuration=0,this.mediaSecondsLoaded=0,this.mediaAppends=0}dispose(){this.trigger("dispose"),this.state="DISPOSED",this.pause(),this.abort_(),this.transmuxer_&&this.transmuxer_.terminate(),this.resetStats_(),this.checkBufferTimeout_&&window.clearTimeout(this.checkBufferTimeout_),this.syncController_&&this.triggerSyncInfoUpdate_&&this.syncController_.off("syncinfoupdate",this.triggerSyncInfoUpdate_),this.off()}setAudio(e){this.audioDisabled_=!e,e?this.appendInitSegment_.audio=!0:this.sourceUpdater_.removeAudio(0,this.duration_())}abort(){if(this.state!=="WAITING"){this.pendingSegment_&&(this.pendingSegment_=null),this.timelineChangeController_.clearPendingTimelineChange(this.loaderType_);return}this.abort_(),this.state="READY",this.paused()||this.monitorBuffer_()}abort_(){this.pendingSegment_&&this.pendingSegment_.abortRequests&&this.pendingSegment_.abortRequests(),this.pendingSegment_=null,this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_.id3=[],this.metadataQueue_.caption=[],this.timelineChangeController_.clearPendingTimelineChange(this.loaderType_),this.waitingOnRemove_=!1,window.clearTimeout(this.quotaExceededErrorRetryTimeout_),this.quotaExceededErrorRetryTimeout_=null}checkForAbort_(e){return this.state==="APPENDING"&&!this.pendingSegment_?(this.state="READY",!0):!this.pendingSegment_||this.pendingSegment_.requestId!==e}error(e){return typeof e<"u"&&(this.logger_("error occurred:",e),this.error_=e),this.pendingSegment_=null,this.error_}endOfStream(){this.ended_=!0,this.transmuxer_&&W1.reset(this.transmuxer_),this.gopBuffer_.length=0,this.pause(),this.trigger("ended")}buffered_(){const e=this.getMediaInfo_();if(!this.sourceUpdater_||!e)return ur();if(this.loaderType_==="main"){const{hasAudio:s,hasVideo:a,isMuxed:h}=e;if(a&&s&&!this.audioDisabled_&&!h)return this.sourceUpdater_.buffered();if(a)return this.sourceUpdater_.videoBuffered()}return this.sourceUpdater_.audioBuffered()}initSegmentForMap(e,s=!1){if(!e)return null;const a=KT(e);let h=this.initSegments_[a];return s&&!h&&e.bytes&&(this.initSegments_[a]=h={resolvedUri:e.resolvedUri,byterange:e.byterange,bytes:e.bytes,tracks:e.tracks,timescales:e.timescales}),h||e}segmentKey(e,s=!1){if(!e)return null;const a=GI(e);let h=this.keyCache_[a];this.cacheEncryptionKeys_&&s&&!h&&e.bytes&&(this.keyCache_[a]=h={resolvedUri:e.resolvedUri,bytes:e.bytes});const p={resolvedUri:(h||e).resolvedUri};return h&&(p.bytes=h.bytes),p}couldBeginLoading_(){return this.playlist_&&!this.paused()}load(){if(this.monitorBuffer_(),!!this.playlist_){if(this.state==="INIT"&&this.couldBeginLoading_())return this.init_();!this.couldBeginLoading_()||this.state!=="READY"&&this.state!=="INIT"||(this.state="READY")}}init_(){return this.state="READY",this.resetEverything(),this.monitorBuffer_()}playlist(e,s={}){if(!e||this.playlist_&&this.playlist_.endList&&e.endList&&this.playlist_.uri===e.uri)return;const a=this.playlist_,h=this.pendingSegment_;this.playlist_=e,this.xhrOptions_=s,this.state==="INIT"&&(e.syncInfo={mediaSequence:e.mediaSequence,time:0},this.loaderType_==="main"&&this.syncController_.setDateTimeMappingForStart(e));let p=null;if(a&&(a.id?p=a.id:a.uri&&(p=a.uri)),this.logger_(`playlist update [${p} => ${e.id||e.uri}]`),this.mediaSequenceSync_&&(this.mediaSequenceSync_.update(e,this.currentTime_()),this.logger_(`Playlist update:
currentTime: ${this.currentTime_()}
bufferedEnd: ${L1(this.buffered_())}
`,this.mediaSequenceSync_.diagnostics)),this.trigger("syncinfoupdate"),this.state==="INIT"&&this.couldBeginLoading_())return this.init_();if(!a||a.uri!==e.uri){this.mediaIndex!==null&&(!e.endList&&typeof e.partTargetDuration=="number"?this.resetLoader():this.resyncLoader()),this.currentMediaInfo_=void 0,this.trigger("playlistupdate");return}const _=e.mediaSequence-a.mediaSequence;if(this.logger_(`live window shift [${_}]`),this.mediaIndex!==null)if(this.mediaIndex-=_,this.mediaIndex<0)this.mediaIndex=null,this.partIndex=null;else{const w=this.playlist_.segments[this.mediaIndex];if(this.partIndex&&(!w.parts||!w.parts.length||!w.parts[this.partIndex])){const I=this.mediaIndex;this.logger_(`currently processing part (index ${this.partIndex}) no longer exists.`),this.resetLoader(),this.mediaIndex=I}}h&&(h.mediaIndex-=_,h.mediaIndex<0?(h.mediaIndex=null,h.partIndex=null):(h.mediaIndex>=0&&(h.segment=e.segments[h.mediaIndex]),h.partIndex>=0&&h.segment.parts&&(h.part=h.segment.parts[h.partIndex]))),this.syncController_.saveExpiredSegmentInfo(a,e)}pause(){this.checkBufferTimeout_&&(window.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=null)}paused(){return this.checkBufferTimeout_===null}resetEverything(e){this.ended_=!1,this.activeInitSegmentId_=null,this.appendInitSegment_={audio:!0,video:!0},this.resetLoader(),this.remove(0,1/0,e),this.transmuxer_&&(this.transmuxer_.postMessage({action:"clearAllMp4Captions"}),this.transmuxer_.postMessage({action:"reset"}))}resetLoader(){this.fetchAtBuffer_=!1,this.mediaSequenceSync_&&this.mediaSequenceSync_.resetAppendedStatus(),this.resyncLoader()}resyncLoader(){this.transmuxer_&&W1.reset(this.transmuxer_),this.mediaIndex=null,this.partIndex=null,this.syncPoint_=null,this.isPendingTimestampOffset_=!1;const e=this.currentMediaInfo_&&this.currentMediaInfo_.isFmp4;this.sourceType_==="hls"&&!e&&(this.shouldForceTimestampOffsetAfterResync_=!0),this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_.id3=[],this.metadataQueue_.caption=[],this.abort(),this.transmuxer_&&this.transmuxer_.postMessage({action:"clearParsedMp4Captions"})}remove(e,s,a=()=>{},h=!1){if(s===1/0&&(s=this.duration_()),s<=e){this.logger_("skipping remove because end ${end} is <= start ${start}");return}if(!this.sourceUpdater_||!this.getMediaInfo_()){this.logger_("skipping remove because no source updater or starting media info");return}let p=1;const _=()=>{p--,p===0&&a()};(h||!this.audioDisabled_)&&(p++,this.sourceUpdater_.removeAudio(e,s,_)),(h||this.loaderType_==="main")&&(this.gopBuffer_=b6(this.gopBuffer_,e,s,this.timeMapping_),p++,this.sourceUpdater_.removeVideo(e,s,_));for(const w in this.inbandTextTracks_)X_(e,s,this.inbandTextTracks_[w]);X_(e,s,this.segmentMetadataTrack_),_()}monitorBuffer_(){this.checkBufferTimeout_&&window.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=window.setTimeout(this.monitorBufferTick_.bind(this),1)}monitorBufferTick_(){this.state==="READY"&&this.fillBuffer_(),this.checkBufferTimeout_&&window.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=window.setTimeout(this.monitorBufferTick_.bind(this),w6)}fillBuffer_(){if(this.sourceUpdater_.updating())return;const e=this.chooseNextRequest_();if(!e)return;const s={segmentInfo:qd({type:this.loaderType_,segment:e})};this.trigger({type:"segmentselected",metadata:s}),typeof e.timestampOffset=="number"&&(this.isPendingTimestampOffset_=!1,this.timelineChangeController_.pendingTimelineChange({type:this.loaderType_,from:this.currentTimeline_,to:e.timeline})),this.loadSegment_(e)}isEndOfStream_(e=this.mediaIndex,s=this.playlist_,a=this.partIndex){if(!s||!this.mediaSource_)return!1;const h=typeof e=="number"&&s.segments[e],p=e+1===s.segments.length,_=!h||!h.parts||a+1===h.parts.length;return s.endList&&this.mediaSource_.readyState==="open"&&p&&_}chooseNextRequest_(){const e=this.buffered_(),s=L1(e)||0,a=N1(e,this.currentTime_()),h=!this.hasPlayed_()&&a>=1,p=a>=this.goalBufferLength_(),_=this.playlist_.segments;if(!_.length||h||p)return null;this.syncPoint_=this.syncPoint_||this.syncController_.getSyncPoint(this.playlist_,this.duration_(),this.currentTimeline_,this.currentTime_(),this.loaderType_);const w={partIndex:null,mediaIndex:null,startOfSegment:null,playlist:this.playlist_,isSyncRequest:!this.syncPoint_};if(w.isSyncRequest)w.mediaIndex=v6(this.currentTimeline_,_,s),this.logger_(`choose next request. Can not find sync point. Fallback to media Index: ${w.mediaIndex}`);else if(this.mediaIndex!==null){const pe=_[this.mediaIndex],Ee=typeof this.partIndex=="number"?this.partIndex:-1;w.startOfSegment=pe.end?pe.end:s,pe.parts&&pe.parts[Ee+1]?(w.mediaIndex=this.mediaIndex,w.partIndex=Ee+1):w.mediaIndex=this.mediaIndex+1}else{let pe,Ee,Ie;const ce=this.fetchAtBuffer_?s:this.currentTime_();if(this.mediaSequenceSync_&&this.logger_(`chooseNextRequest_ request after Quality Switch:
For TargetTime: ${ce}.
CurrentTime: ${this.currentTime_()}
BufferedEnd: ${s}
Fetch At Buffer: ${this.fetchAtBuffer_}
`,this.mediaSequenceSync_.diagnostics),this.mediaSequenceSync_&&this.mediaSequenceSync_.isReliable){const Ve=this.getSyncInfoFromMediaSequenceSync_(ce);if(!Ve){const Be="No sync info found while using media sequence sync";return this.error({message:Be,metadata:{errorType:Ye.Error.StreamingFailedToSelectNextSegment,error:new Error(Be)}}),this.logger_("chooseNextRequest_ - no sync info found using media sequence sync"),null}this.logger_(`chooseNextRequest_ mediaSequence syncInfo (${Ve.start} --> ${Ve.end})`),pe=Ve.segmentIndex,Ee=Ve.partIndex,Ie=Ve.start}else{this.logger_("chooseNextRequest_ - fallback to a regular segment selection algorithm, based on a syncPoint.");const Ve=_a.getMediaInfoForTime({exactManifestTimings:this.exactManifestTimings,playlist:this.playlist_,currentTime:ce,startingPartIndex:this.syncPoint_.partIndex,startingSegmentIndex:this.syncPoint_.segmentIndex,startTime:this.syncPoint_.time});pe=Ve.segmentIndex,Ee=Ve.partIndex,Ie=Ve.startTime}w.getMediaInfoForTime=this.fetchAtBuffer_?`bufferedEnd ${ce}`:`currentTime ${ce}`,w.mediaIndex=pe,w.startOfSegment=Ie,w.partIndex=Ee,this.logger_(`choose next request. Playlist switched and we have a sync point. Media Index: ${w.mediaIndex} `)}const I=_[w.mediaIndex];let B=I&&typeof w.partIndex=="number"&&I.parts&&I.parts[w.partIndex];if(!I||typeof w.partIndex=="number"&&!B)return null;typeof w.partIndex!="number"&&I.parts&&(w.partIndex=0,B=I.parts[0]);const G=this.vhs_.playlists&&this.vhs_.playlists.main&&this.vhs_.playlists.main.independentSegments||this.playlist_.independentSegments;if(!a&&B&&!G&&!B.independent)if(w.partIndex===0){const pe=_[w.mediaIndex-1],Ee=pe.parts&&pe.parts.length&&pe.parts[pe.parts.length-1];Ee&&Ee.independent&&(w.mediaIndex-=1,w.partIndex=pe.parts.length-1,w.independent="previous segment")}else I.parts[w.partIndex-1].independent&&(w.partIndex-=1,w.independent="previous part");const se=this.mediaSource_&&this.mediaSource_.readyState==="ended";return w.mediaIndex>=_.length-1&&se&&!this.seeking_()?null:(this.shouldForceTimestampOffsetAfterResync_&&(this.shouldForceTimestampOffsetAfterResync_=!1,w.forceTimestampOffset=!0,this.logger_("choose next request. Force timestamp offset after loader resync")),this.generateSegmentInfo_(w))}getSyncInfoFromMediaSequenceSync_(e){if(!this.mediaSequenceSync_)return null;const s=Math.max(e,this.mediaSequenceSync_.start);e!==s&&this.logger_(`getSyncInfoFromMediaSequenceSync_. Pulled target time from ${e} to ${s}`);const a=this.mediaSequenceSync_.getSyncInfoForTime(s);if(!a)return null;if(!a.isAppended)return a;const h=this.mediaSequenceSync_.getSyncInfoForTime(a.end);return h?(h.isAppended&&this.logger_("getSyncInfoFromMediaSequenceSync_: We encounter unexpected scenario where next media sequence sync info is also appended!"),h):null}generateSegmentInfo_(e){const{independent:s,playlist:a,mediaIndex:h,startOfSegment:p,isSyncRequest:_,partIndex:w,forceTimestampOffset:I,getMediaInfoForTime:B}=e,G=a.segments[h],se=typeof w=="number"&&G.parts[w],pe={requestId:"segment-loader-"+Math.random(),uri:se&&se.resolvedUri||G.resolvedUri,mediaIndex:h,partIndex:se?w:null,isSyncRequest:_,startOfSegment:p,playlist:a,bytes:null,encryptedBytes:null,timestampOffset:null,timeline:G.timeline,duration:se&&se.duration||G.duration,segment:G,part:se,byteLength:0,transmuxer:this.transmuxer_,getMediaInfoForTime:B,independent:s},Ee=typeof I<"u"?I:this.isPendingTimestampOffset_;pe.timestampOffset=this.timestampOffsetForSegment_({segmentTimeline:G.timeline,currentTimeline:this.currentTimeline_,startOfSegment:p,buffered:this.buffered_(),overrideCheck:Ee});const Ie=L1(this.sourceUpdater_.audioBuffered());return typeof Ie=="number"&&(pe.audioAppendStart=Ie-this.sourceUpdater_.audioTimestampOffset()),this.sourceUpdater_.videoBuffered().length&&(pe.gopsToAlignWith=m6(this.gopBuffer_,this.currentTime_()-this.sourceUpdater_.videoTimestampOffset(),this.timeMapping_)),pe}timestampOffsetForSegment_(e){return S6(e)}earlyAbortWhenNeeded_(e){if(this.vhs_.tech_.paused()||!this.xhrOptions_.timeout||!this.playlist_.attributes.BANDWIDTH||Date.now()-(e.firstBytesReceivedAt||Date.now())<1e3)return;const s=this.currentTime_(),a=e.bandwidth,h=this.pendingSegment_.duration,p=_a.estimateSegmentRequestTime(h,a,this.playlist_,e.bytesReceived),_=KU(this.buffered_(),s,this.vhs_.tech_.playbackRate())-1;if(p<=_)return;const w=r6({main:this.vhs_.playlists.main,currentTime:s,bandwidth:a,duration:this.duration_(),segmentDuration:h,timeUntilRebuffer:_,currentTimeline:this.currentTimeline_,syncController:this.syncController_});if(!w)return;const B=p-_-w.rebufferingImpact;let G=.5;_<=kl&&(G=1),!(!w.playlist||w.playlist.uri===this.playlist_.uri||B<G)&&(this.bandwidth=w.playlist.attributes.BANDWIDTH*hr.BANDWIDTH_VARIANCE+1,this.trigger("earlyabort"))}handleAbort_(e){this.logger_(`Aborting ${jg(e)}`),this.mediaRequestsAborted+=1}handleProgress_(e,s){this.earlyAbortWhenNeeded_(s.stats),!this.checkForAbort_(s.requestId)&&this.trigger("progress")}handleTrackInfo_(e,s){const{hasAudio:a,hasVideo:h}=s,p={segmentInfo:qd({type:this.loaderType_,segment:e}),trackInfo:{hasAudio:a,hasVideo:h}};this.trigger({type:"segmenttransmuxingtrackinfoavailable",metadata:p}),this.earlyAbortWhenNeeded_(e.stats),!this.checkForAbort_(e.requestId)&&(this.checkForIllegalMediaSwitch(s)||(s=s||{},y6(this.currentMediaInfo_,s)||(this.appendInitSegment_={audio:!0,video:!0},this.startingMediaInfo_=s,this.currentMediaInfo_=s,this.logger_("trackinfo update",s),this.trigger("trackinfo")),!this.checkForAbort_(e.requestId)&&(this.pendingSegment_.trackInfo=s,this.hasEnoughInfoToAppend_()?this.processCallQueue_():Zh(this))))}handleTimingInfo_(e,s,a,h){if(this.earlyAbortWhenNeeded_(e.stats),this.checkForAbort_(e.requestId))return;const p=this.pendingSegment_,_=yL(s);p[_]=p[_]||{},p[_][a]=h,this.logger_(`timinginfo: ${s} - ${a} - ${h}`),this.hasEnoughInfoToAppend_()?this.processCallQueue_():Zh(this)}handleCaptions_(e,s){if(this.earlyAbortWhenNeeded_(e.stats),this.checkForAbort_(e.requestId))return;if(s.length===0){this.logger_("SegmentLoader received no captions from a caption event");return}if(!this.pendingSegment_.hasAppendedData_){this.metadataQueue_.caption.push(this.handleCaptions_.bind(this,e,s));return}const h=this.sourceUpdater_.videoTimestampOffset()===null?this.sourceUpdater_.audioTimestampOffset():this.sourceUpdater_.videoTimestampOffset(),p={};s.forEach(_=>{p[_.stream]=p[_.stream]||{startTime:1/0,captions:[],endTime:0};const w=p[_.stream];w.startTime=Math.min(w.startTime,_.startTime+h),w.endTime=Math.max(w.endTime,_.endTime+h),w.captions.push(_)}),Object.keys(p).forEach(_=>{const{startTime:w,endTime:I,captions:B}=p[_],G=this.inbandTextTracks_;this.logger_(`adding cues from ${w} -> ${I} for ${_}`),l6(G,this.vhs_.tech_,_),X_(w,I,G[_]),u6({captionArray:B,inbandTextTracks:G,timestampOffset:h})}),this.transmuxer_&&this.transmuxer_.postMessage({action:"clearParsedMp4Captions"})}handleId3_(e,s,a){if(this.earlyAbortWhenNeeded_(e.stats),this.checkForAbort_(e.requestId))return;if(!this.pendingSegment_.hasAppendedData_){this.metadataQueue_.id3.push(this.handleId3_.bind(this,e,s,a));return}this.addMetadataToTextTrack(a,s,this.duration_())}processMetadataQueue_(){this.metadataQueue_.id3.forEach(e=>e()),this.metadataQueue_.caption.forEach(e=>e()),this.metadataQueue_.id3=[],this.metadataQueue_.caption=[]}processCallQueue_(){const e=this.callQueue_;this.callQueue_=[],e.forEach(s=>s())}processLoadQueue_(){const e=this.loadQueue_;this.loadQueue_=[],e.forEach(s=>s())}hasEnoughInfoToLoad_(){if(this.loaderType_!=="audio")return!0;const e=this.pendingSegment_;return e?this.getCurrentMediaInfo_()?!K1({timelineChangeController:this.timelineChangeController_,currentTimeline:this.currentTimeline_,segmentTimeline:e.timeline,loaderType:this.loaderType_,audioDisabled:this.audioDisabled_}):!0:!1}getCurrentMediaInfo_(e=this.pendingSegment_){return e&&e.trackInfo||this.currentMediaInfo_}getMediaInfo_(e=this.pendingSegment_){return this.getCurrentMediaInfo_(e)||this.startingMediaInfo_}getPendingSegmentPlaylist(){return this.pendingSegment_?this.pendingSegment_.playlist:null}hasEnoughInfoToAppend_(){if(!this.sourceUpdater_.ready()||this.waitingOnRemove_||this.quotaExceededErrorRetryTimeout_)return!1;const e=this.pendingSegment_,s=this.getCurrentMediaInfo_();if(!e||!s)return!1;const{hasAudio:a,hasVideo:h,isMuxed:p}=s;return!(h&&!e.videoTimingInfo||a&&!this.audioDisabled_&&!p&&!e.audioTimingInfo||K1({timelineChangeController:this.timelineChangeController_,currentTimeline:this.currentTimeline_,segmentTimeline:e.timeline,loaderType:this.loaderType_,audioDisabled:this.audioDisabled_}))}handleData_(e,s){if(this.earlyAbortWhenNeeded_(e.stats),this.checkForAbort_(e.requestId))return;if(this.callQueue_.length||!this.hasEnoughInfoToAppend_()){Zh(this),this.callQueue_.push(this.handleData_.bind(this,e,s));return}const a=this.pendingSegment_;if(this.setTimeMapping_(a.timeline),this.updateMediaSecondsLoaded_(a.part||a.segment),this.mediaSource_.readyState!=="closed"){if(e.map&&(e.map=this.initSegmentForMap(e.map,!0),a.segment.map=e.map),e.key&&this.segmentKey(e.key,!0),a.isFmp4=e.isFmp4,a.timingInfo=a.timingInfo||{},a.isFmp4)this.trigger("fmp4"),a.timingInfo.start=a[yL(s.type)].start;else{const h=this.getCurrentMediaInfo_(),p=this.loaderType_==="main"&&h&&h.hasVideo;let _;p&&(_=a.videoTimingInfo.start),a.timingInfo.start=this.trueSegmentStart_({currentStart:a.timingInfo.start,playlist:a.playlist,mediaIndex:a.mediaIndex,currentVideoTimestampOffset:this.sourceUpdater_.videoTimestampOffset(),useVideoTimingInfo:p,firstVideoFrameTimeForData:_,videoTimingInfo:a.videoTimingInfo,audioTimingInfo:a.audioTimingInfo})}if(this.updateAppendInitSegmentStatus(a,s.type),this.updateSourceBufferTimestampOffset_(a),a.isSyncRequest){this.updateTimingInfoEnd_(a),this.syncController_.saveSegmentTimingInfo({segmentInfo:a,shouldSaveTimelineMapping:this.loaderType_==="main"});const h=this.chooseNextRequest_();if(h.mediaIndex!==a.mediaIndex||h.partIndex!==a.partIndex){this.logger_("sync segment was incorrect, not appending");return}this.logger_("sync segment was correct, appending")}a.hasAppendedData_=!0,this.processMetadataQueue_(),this.appendData_(a,s)}}updateAppendInitSegmentStatus(e,s){this.loaderType_==="main"&&typeof e.timestampOffset=="number"&&!e.changedTimestampOffset&&(this.appendInitSegment_={audio:!0,video:!0}),this.playlistOfLastInitSegment_[s]!==e.playlist&&(this.appendInitSegment_[s]=!0)}getInitSegmentAndUpdateState_({type:e,initSegment:s,map:a,playlist:h}){if(a){const p=KT(a);if(this.activeInitSegmentId_===p)return null;s=this.initSegmentForMap(a,!0).bytes,this.activeInitSegmentId_=p}return s&&this.appendInitSegment_[e]?(this.playlistOfLastInitSegment_[e]=h,this.appendInitSegment_[e]=!1,this.activeInitSegmentId_=null,s):null}handleQuotaExceededError_({segmentInfo:e,type:s,bytes:a},h){const p=this.sourceUpdater_.audioBuffered(),_=this.sourceUpdater_.videoBuffered();p.length>1&&this.logger_("On QUOTA_EXCEEDED_ERR, found gaps in the audio buffer: "+zd(p).join(", ")),_.length>1&&this.logger_("On QUOTA_EXCEEDED_ERR, found gaps in the video buffer: "+zd(_).join(", "));const w=p.length?p.start(0):0,I=p.length?p.end(p.length-1):0,B=_.length?_.start(0):0,G=_.length?_.end(_.length-1):0;if(I-w<=K_&&G-B<=K_){this.logger_(`On QUOTA_EXCEEDED_ERR, single segment too large to append to buffer, triggering an error. Appended byte length: ${a.byteLength}, audio buffer: ${zd(p).join(", ")}, video buffer: ${zd(_).join(", ")}, `),this.error({message:"Quota exceeded error with append of a single segment of content",excludeUntil:1/0}),this.trigger("error");return}this.waitingOnRemove_=!0,this.callQueue_.push(this.appendToSourceBuffer_.bind(this,{segmentInfo:e,type:s,bytes:a}));const pe=this.currentTime_()-K_;this.logger_(`On QUOTA_EXCEEDED_ERR, removing audio/video from 0 to ${pe}`),this.remove(0,pe,()=>{this.logger_(`On QUOTA_EXCEEDED_ERR, retrying append in ${K_}s`),this.waitingOnRemove_=!1,this.quotaExceededErrorRetryTimeout_=window.setTimeout(()=>{this.logger_("On QUOTA_EXCEEDED_ERR, re-processing call queue"),this.quotaExceededErrorRetryTimeout_=null,this.processCallQueue_()},K_*1e3)},!0)}handleAppendError_({segmentInfo:e,type:s,bytes:a},h){if(h){if(h.code===FI){this.handleQuotaExceededError_({segmentInfo:e,type:s,bytes:a});return}this.logger_("Received non QUOTA_EXCEEDED_ERR on append",h),this.error({message:`${s} append of ${a.length}b failed for segment #${e.mediaIndex} in playlist ${e.playlist.id}`,metadata:{errorType:Ye.Error.StreamingFailedToAppendSegment}}),this.trigger("appenderror")}}appendToSourceBuffer_({segmentInfo:e,type:s,initSegment:a,data:h,bytes:p}){if(!p){const w=[h];let I=h.byteLength;a&&(w.unshift(a),I+=a.byteLength),p=o6({bytes:I,segments:w})}const _={segmentInfo:qd({type:this.loaderType_,segment:e})};this.trigger({type:"segmentappendstart",metadata:_}),this.sourceUpdater_.appendBuffer({segmentInfo:e,type:s,bytes:p},this.handleAppendError_.bind(this,{segmentInfo:e,type:s,bytes:p}))}handleSegmentTimingInfo_(e,s,a){if(!this.pendingSegment_||s!==this.pendingSegment_.requestId)return;const h=this.pendingSegment_.segment,p=`${e}TimingInfo`;h[p]||(h[p]={}),h[p].transmuxerPrependedSeconds=a.prependedContentDuration||0,h[p].transmuxedPresentationStart=a.start.presentation,h[p].transmuxedDecodeStart=a.start.decode,h[p].transmuxedPresentationEnd=a.end.presentation,h[p].transmuxedDecodeEnd=a.end.decode,h[p].baseMediaDecodeTime=a.baseMediaDecodeTime}appendData_(e,s){const{type:a,data:h}=s;if(!h||!h.byteLength||a==="audio"&&this.audioDisabled_)return;const p=this.getInitSegmentAndUpdateState_({type:a,initSegment:s.initSegment,playlist:e.playlist,map:e.isFmp4?e.segment.map:null});this.appendToSourceBuffer_({segmentInfo:e,type:a,initSegment:p,data:h})}loadSegment_(e){if(this.state="WAITING",this.pendingSegment_=e,this.trimBackBuffer_(e),typeof e.timestampOffset=="number"&&this.transmuxer_&&this.transmuxer_.postMessage({action:"clearAllMp4Captions"}),!this.hasEnoughInfoToLoad_()){Zh(this),this.loadQueue_.push(()=>{const s=Z({},e,{forceTimestampOffset:!0});Z(e,this.generateSegmentInfo_(s)),this.isPendingTimestampOffset_=!1,this.updateTransmuxerAndRequestSegment_(e)});return}this.updateTransmuxerAndRequestSegment_(e)}updateTransmuxerAndRequestSegment_(e){this.shouldUpdateTransmuxerTimestampOffset_(e.timestampOffset)&&(this.gopBuffer_.length=0,e.gopsToAlignWith=[],this.timeMapping_=0,this.transmuxer_.postMessage({action:"reset"}),this.transmuxer_.postMessage({action:"setTimestampOffset",timestampOffset:e.timestampOffset}));const s=this.createSimplifiedSegmentObj_(e),a=this.isEndOfStream_(e.mediaIndex,e.playlist,e.partIndex),h=this.mediaIndex!==null,p=e.timeline!==this.currentTimeline_&&e.timeline>0,_=a||h&&p;this.logger_(`Requesting
${mL(e.uri)}
${jg(e)}`),s.map&&!s.map.bytes&&(this.logger_("going to request init segment."),this.appendInitSegment_={video:!0,audio:!0}),e.abortRequests=i6({xhr:this.vhs_.xhr,xhrOptions:this.xhrOptions_,decryptionWorker:this.decrypter_,segment:s,abortFn:this.handleAbort_.bind(this,e),progressFn:this.handleProgress_.bind(this),trackInfoFn:this.handleTrackInfo_.bind(this),timingInfoFn:this.handleTimingInfo_.bind(this),videoSegmentTimingInfoFn:this.handleSegmentTimingInfo_.bind(this,"video",e.requestId),audioSegmentTimingInfoFn:this.handleSegmentTimingInfo_.bind(this,"audio",e.requestId),captionsFn:this.handleCaptions_.bind(this),isEndOfTimeline:_,endedTimelineFn:()=>{this.logger_("received endedtimeline callback")},id3Fn:this.handleId3_.bind(this),dataFn:this.handleData_.bind(this),doneFn:this.segmentRequestFinished_.bind(this),onTransmuxerLog:({message:w,level:I,stream:B})=>{this.logger_(`${jg(e)} logged from transmuxer stream ${B} as a ${I}: ${w}`)},triggerSegmentEventFn:({type:w,segment:I,keyInfo:B,trackInfo:G,timingInfo:se})=>{const Ee={segmentInfo:qd({segment:I})};B&&(Ee.keyInfo=B),G&&(Ee.trackInfo=G),se&&(Ee.timingInfo=se),this.trigger({type:w,metadata:Ee})}})}trimBackBuffer_(e){const s=E6(this.seekable_(),this.currentTime_(),this.playlist_.targetDuration||10);s>0&&this.remove(0,s)}createSimplifiedSegmentObj_(e){const s=e.segment,a=e.part,h=e.segment.key||e.segment.map&&e.segment.map.key,p=e.segment.map&&!e.segment.map.bytes,_={resolvedUri:a?a.resolvedUri:s.resolvedUri,byterange:a?a.byterange:s.byterange,requestId:e.requestId,transmuxer:e.transmuxer,audioAppendStart:e.audioAppendStart,gopsToAlignWith:e.gopsToAlignWith,part:e.part,type:this.loaderType_,start:e.startOfSegment,duration:e.duration,isEncrypted:h,isMediaInitialization:p},w=e.playlist.segments[e.mediaIndex-1];if(w&&w.timeline===s.timeline&&(w.videoTimingInfo?_.baseStartTime=w.videoTimingInfo.transmuxedDecodeEnd:w.audioTimingInfo&&(_.baseStartTime=w.audioTimingInfo.transmuxedDecodeEnd)),s.key){const I=s.key.iv||new Uint32Array([0,0,0,e.mediaIndex+e.playlist.mediaSequence]);_.key=this.segmentKey(s.key),_.key.iv=I}return s.map&&(_.map=this.initSegmentForMap(s.map)),_}saveTransferStats_(e){this.mediaRequests+=1,e&&(this.mediaBytesTransferred+=e.bytesReceived,this.mediaTransferDuration+=e.roundTripTime)}saveBandwidthRelatedStats_(e,s){if(this.pendingSegment_.byteLength=s.bytesReceived,e<ZT){this.logger_(`Ignoring segment's bandwidth because its duration of ${e} is less than the min to record ${ZT}`);return}const a={bandwidthInfo:{from:this.bandwidth,to:s.bandwidth}};this.trigger({type:"bandwidthupdated",metadata:a}),this.bandwidth=s.bandwidth,this.roundTrip=s.roundTripTime}handleTimeout_(){this.mediaRequestsTimedout+=1,this.bandwidth=1,this.roundTrip=NaN,this.trigger("bandwidthupdate"),this.trigger("timeout")}segmentRequestFinished_(e,s,a){if(this.callQueue_.length){this.callQueue_.push(this.segmentRequestFinished_.bind(this,e,s,a));return}if(this.saveTransferStats_(s.stats),!this.pendingSegment_||s.requestId!==this.pendingSegment_.requestId)return;if(e){if(this.pendingSegment_=null,this.state="READY",e.code===Dl.ABORTED)return;if(this.pause(),e.code===Dl.TIMEOUT){this.handleTimeout_();return}this.mediaRequestsErrored+=1,this.error(e),this.trigger("error");return}const h=this.pendingSegment_;this.saveBandwidthRelatedStats_(h.duration,s.stats),h.endOfAllRequests=s.endOfAllRequests,a.gopInfo&&(this.gopBuffer_=_6(this.gopBuffer_,a.gopInfo,this.safeAppend_)),this.state="APPENDING",this.trigger("appending"),this.waitForAppendsToComplete_(h)}setTimeMapping_(e){const s=this.syncController_.mappingForTimeline(e);s!==null&&(this.timeMapping_=s)}updateMediaSecondsLoaded_(e){typeof e.start=="number"&&typeof e.end=="number"?this.mediaSecondsLoaded+=e.end-e.start:this.mediaSecondsLoaded+=e.duration}shouldUpdateTransmuxerTimestampOffset_(e){return e===null?!1:this.loaderType_==="main"&&e!==this.sourceUpdater_.videoTimestampOffset()||!this.audioDisabled_&&e!==this.sourceUpdater_.audioTimestampOffset()}trueSegmentStart_({currentStart:e,playlist:s,mediaIndex:a,firstVideoFrameTimeForData:h,currentVideoTimestampOffset:p,useVideoTimingInfo:_,videoTimingInfo:w,audioTimingInfo:I}){if(typeof e<"u")return e;if(!_)return I.start;const B=s.segments[a-1];return a===0||!B||typeof B.start>"u"||B.end!==h+p?h:w.start}waitForAppendsToComplete_(e){const s=this.getCurrentMediaInfo_(e);if(!s){this.error({message:"No starting media returned, likely due to an unsupported media format.",playlistExclusionDuration:1/0}),this.trigger("error");return}const{hasAudio:a,hasVideo:h,isMuxed:p}=s,_=this.loaderType_==="main"&&h,w=!this.audioDisabled_&&a&&!p;if(e.waitingOnAppends=0,!e.hasAppendedData_){!e.timingInfo&&typeof e.timestampOffset=="number"&&(this.isPendingTimestampOffset_=!0),e.timingInfo={start:0},e.waitingOnAppends++,this.isPendingTimestampOffset_||(this.updateSourceBufferTimestampOffset_(e),this.processMetadataQueue_()),this.checkAppendsDone_(e);return}_&&e.waitingOnAppends++,w&&e.waitingOnAppends++,_&&this.sourceUpdater_.videoQueueCallback(this.checkAppendsDone_.bind(this,e)),w&&this.sourceUpdater_.audioQueueCallback(this.checkAppendsDone_.bind(this,e))}checkAppendsDone_(e){this.checkForAbort_(e.requestId)||(e.waitingOnAppends--,e.waitingOnAppends===0&&this.handleAppendsDone_())}checkForIllegalMediaSwitch(e){const s=T6(this.loaderType_,this.getCurrentMediaInfo_(),e);return s?(this.error({message:s,playlistExclusionDuration:1/0}),this.trigger("error"),!0):!1}updateSourceBufferTimestampOffset_(e){if(e.timestampOffset===null||typeof e.timingInfo.start!="number"||e.changedTimestampOffset||this.loaderType_!=="main")return;let s=!1;e.timestampOffset-=this.getSegmentStartTimeForTimestampOffsetCalculation_({videoTimingInfo:e.segment.videoTimingInfo,audioTimingInfo:e.segment.audioTimingInfo,timingInfo:e.timingInfo}),e.changedTimestampOffset=!0,e.timestampOffset!==this.sourceUpdater_.videoTimestampOffset()&&(this.sourceUpdater_.videoTimestampOffset(e.timestampOffset),s=!0),e.timestampOffset!==this.sourceUpdater_.audioTimestampOffset()&&(this.sourceUpdater_.audioTimestampOffset(e.timestampOffset),s=!0),s&&this.trigger("timestampoffset")}getSegmentStartTimeForTimestampOffsetCalculation_({videoTimingInfo:e,audioTimingInfo:s,timingInfo:a}){return this.useDtsForTimestampOffset_?e&&typeof e.transmuxedDecodeStart=="number"?e.transmuxedDecodeStart:s&&typeof s.transmuxedDecodeStart=="number"?s.transmuxedDecodeStart:a.start:a.start}updateTimingInfoEnd_(e){e.timingInfo=e.timingInfo||{};const s=this.getMediaInfo_(),h=this.loaderType_==="main"&&s&&s.hasVideo&&e.videoTimingInfo?e.videoTimingInfo:e.audioTimingInfo;h&&(e.timingInfo.end=typeof h.end=="number"?h.end:h.start+e.duration)}handleAppendsDone_(){if(this.pendingSegment_){const I={segmentInfo:qd({type:this.loaderType_,segment:this.pendingSegment_})};this.trigger({type:"appendsdone",metadata:I})}if(!this.pendingSegment_){this.state="READY",this.paused()||this.monitorBuffer_();return}const e=this.pendingSegment_;e.part&&e.part.syncInfo?e.part.syncInfo.markAppended():e.segment.syncInfo&&e.segment.syncInfo.markAppended(),this.updateTimingInfoEnd_(e),this.shouldSaveSegmentTimingInfo_&&this.syncController_.saveSegmentTimingInfo({segmentInfo:e,shouldSaveTimelineMapping:this.loaderType_==="main"});const s=k6(e,this.sourceType_);if(s&&(s.severity==="warn"?Ye.log.warn(s.message):this.logger_(s.message)),this.recordThroughput_(e),this.pendingSegment_=null,this.state="READY",e.isSyncRequest&&(this.trigger("syncinfoupdate"),!e.hasAppendedData_)){this.logger_(`Throwing away un-appended sync request ${jg(e)}`);return}this.logger_(`Appended ${jg(e)}`),this.addSegmentMetadataCue_(e),this.fetchAtBuffer_=!0,this.currentTimeline_!==e.timeline&&(this.timelineChangeController_.lastTimelineChange({type:this.loaderType_,from:this.currentTimeline_,to:e.timeline}),this.loaderType_==="main"&&!this.audioDisabled_&&this.timelineChangeController_.lastTimelineChange({type:"audio",from:this.currentTimeline_,to:e.timeline})),this.currentTimeline_=e.timeline,this.trigger("syncinfoupdate");const a=e.segment,h=e.part,p=a.end&&this.currentTime_()-a.end>e.playlist.targetDuration*3,_=h&&h.end&&this.currentTime_()-h.end>e.playlist.partTargetDuration*3;if(p||_){this.logger_(`bad ${p?"segment":"part"} ${jg(e)}`),this.resetEverything();return}this.mediaIndex!==null&&this.trigger("bandwidthupdate"),this.trigger("progress"),this.mediaIndex=e.mediaIndex,this.partIndex=e.partIndex,this.isEndOfStream_(e.mediaIndex,e.playlist,e.partIndex)&&this.endOfStream(),this.trigger("appended"),e.hasAppendedData_&&this.mediaAppends++,this.paused()||this.monitorBuffer_()}recordThroughput_(e){if(e.duration<ZT){this.logger_(`Ignoring segment's throughput because its duration of ${e.duration} is less than the min to record ${ZT}`);return}const s=this.throughput.rate,a=Date.now()-e.endOfAllRequests+1,h=Math.floor(e.byteLength/a*8*1e3);this.throughput.rate+=(h-s)/++this.throughput.count}addSegmentMetadataCue_(e){if(!this.segmentMetadataTrack_)return;const s=e.segment,a=s.start,h=s.end;if(!bL(a)||!bL(h))return;X_(a,h,this.segmentMetadataTrack_);const p=window.WebKitDataCue||window.VTTCue,_={custom:s.custom,dateTimeObject:s.dateTimeObject,dateTimeString:s.dateTimeString,programDateTime:s.programDateTime,bandwidth:e.playlist.attributes.BANDWIDTH,resolution:e.playlist.attributes.RESOLUTION,codecs:e.playlist.attributes.CODECS,byteLength:e.byteLength,uri:e.uri,timeline:e.timeline,playlist:e.playlist.id,start:a,end:h},w=JSON.stringify(_),I=new p(a,h,w);I.value=_,this.segmentMetadataTrack_.addCue(I)}}function Tu(){}const wL=function(r){return typeof r!="string"?r:r.replace(/./,e=>e.toUpperCase())},P6=["video","audio"],Z1=(r,e)=>{const s=e[`${r}Buffer`];return s&&s.updating||e.queuePending[r]},D6=(r,e)=>{for(let s=0;s<e.length;s++){const a=e[s];if(a.type==="mediaSource")return null;if(a.type===r)return s}return null},Hg=(r,e)=>{if(e.queue.length===0)return;let s=0,a=e.queue[s];if(a.type==="mediaSource"){!e.updating()&&e.mediaSource.readyState!=="closed"&&(e.queue.shift(),a.action(e),a.doneFn&&a.doneFn(),Hg("audio",e),Hg("video",e));return}if(r!=="mediaSource"&&!(!e.ready()||e.mediaSource.readyState==="closed"||Z1(r,e))){if(a.type!==r){if(s=D6(r,e.queue),s===null)return;a=e.queue[s]}if(e.queue.splice(s,1),e.queuePending[r]=a,a.action(r,e),!a.doneFn){e.queuePending[r]=null,Hg(r,e);return}}},TL=(r,e)=>{const s=e[`${r}Buffer`],a=wL(r);s&&(s.removeEventListener("updateend",e[`on${a}UpdateEnd_`]),s.removeEventListener("error",e[`on${a}Error_`]),e.codecs[r]=null,e[`${r}Buffer`]=null)},Il=(r,e)=>r&&e&&Array.prototype.indexOf.call(r.sourceBuffers,e)!==-1,Oa={appendBuffer:(r,e,s)=>(a,h)=>{const p=h[`${a}Buffer`];if(Il(h.mediaSource,p)){h.logger_(`Appending segment ${e.mediaIndex}'s ${r.length} bytes to ${a}Buffer`);try{p.appendBuffer(r)}catch(_){h.logger_(`Error with code ${_.code} `+(_.code===FI?"(QUOTA_EXCEEDED_ERR) ":"")+`when appending segment ${e.mediaIndex} to ${a}Buffer`),h.queuePending[a]=null,s(_)}}},remove:(r,e)=>(s,a)=>{const h=a[`${s}Buffer`];if(Il(a.mediaSource,h)){a.logger_(`Removing ${r} to ${e} from ${s}Buffer`);try{h.remove(r,e)}catch{a.logger_(`Remove ${r} to ${e} from ${s}Buffer failed`)}}},timestampOffset:r=>(e,s)=>{const a=s[`${e}Buffer`];Il(s.mediaSource,a)&&(s.logger_(`Setting ${e}timestampOffset to ${r}`),a.timestampOffset=r)},callback:r=>(e,s)=>{r()},endOfStream:r=>e=>{if(e.mediaSource.readyState==="open"){e.logger_(`Calling mediaSource endOfStream(${r||""})`);try{e.mediaSource.endOfStream(r)}catch(s){Ye.log.warn("Failed to call media source endOfStream",s)}}},duration:r=>e=>{e.logger_(`Setting mediaSource duration to ${r}`);try{e.mediaSource.duration=r}catch(s){Ye.log.warn("Failed to set media source duration",s)}},abort:()=>(r,e)=>{if(e.mediaSource.readyState!=="open")return;const s=e[`${r}Buffer`];if(Il(e.mediaSource,s)){e.logger_(`calling abort on ${r}Buffer`);try{s.abort()}catch(a){Ye.log.warn(`Failed to abort on ${r}Buffer`,a)}}},addSourceBuffer:(r,e)=>s=>{const a=wL(r),h=yg(e);s.logger_(`Adding ${r}Buffer with codec ${e} to mediaSource`);const p=s.mediaSource.addSourceBuffer(h);p.addEventListener("updateend",s[`on${a}UpdateEnd_`]),p.addEventListener("error",s[`on${a}Error_`]),s.codecs[r]=e,s[`${r}Buffer`]=p},removeSourceBuffer:r=>e=>{const s=e[`${r}Buffer`];if(TL(r,e),!!Il(e.mediaSource,s)){e.logger_(`Removing ${r}Buffer with codec ${e.codecs[r]} from mediaSource`);try{e.mediaSource.removeSourceBuffer(s)}catch(a){Ye.log.warn(`Failed to removeSourceBuffer ${r}Buffer`,a)}}},changeType:r=>(e,s)=>{const a=s[`${e}Buffer`],h=yg(r);if(!Il(s.mediaSource,a))return;const p=r.substring(0,r.indexOf(".")),_=s.codecs[e];if(_.substring(0,_.indexOf("."))===p)return;const I={codecsChangeInfo:{from:_,to:r}};s.trigger({type:"codecschange",metadata:I}),s.logger_(`changing ${e}Buffer codec from ${_} to ${r}`);try{a.changeType(h),s.codecs[e]=r}catch(B){I.errorType=Ye.Error.StreamingCodecsChangeError,I.error=B,B.metadata=I,s.error_=B,s.trigger("error"),Ye.log.warn(`Failed to changeType on ${e}Buffer`,B)}}},Fa=({type:r,sourceUpdater:e,action:s,doneFn:a,name:h})=>{e.queue.push({type:r,action:s,doneFn:a,name:h}),Hg(r,e)},EL=(r,e)=>s=>{const a=e[`${r}Buffered`](),h=qU(a);if(e.logger_(`received "updateend" event for ${r} Source Buffer: `,h),e.queuePending[r]){const p=e.queuePending[r].doneFn;e.queuePending[r]=null,p&&p(e[`${r}Error_`])}Hg(r,e)};class SL extends Ye.EventTarget{constructor(e){super(),this.mediaSource=e,this.sourceopenListener_=()=>Hg("mediaSource",this),this.mediaSource.addEventListener("sourceopen",this.sourceopenListener_),this.logger_=mo("SourceUpdater"),this.audioTimestampOffset_=0,this.videoTimestampOffset_=0,this.queue=[],this.queuePending={audio:null,video:null},this.delayedAudioAppendQueue_=[],this.videoAppendQueued_=!1,this.codecs={},this.onVideoUpdateEnd_=EL("video",this),this.onAudioUpdateEnd_=EL("audio",this),this.onVideoError_=s=>{this.videoError_=s},this.onAudioError_=s=>{this.audioError_=s},this.createdSourceBuffers_=!1,this.initializedEme_=!1,this.triggeredReady_=!1}initializedEme(){this.initializedEme_=!0,this.triggerReady()}hasCreatedSourceBuffers(){return this.createdSourceBuffers_}hasInitializedAnyEme(){return this.initializedEme_}ready(){return this.hasCreatedSourceBuffers()&&this.hasInitializedAnyEme()}createSourceBuffers(e){this.hasCreatedSourceBuffers()||(this.addOrChangeSourceBuffers(e),this.createdSourceBuffers_=!0,this.trigger("createdsourcebuffers"),this.triggerReady())}triggerReady(){this.ready()&&!this.triggeredReady_&&(this.triggeredReady_=!0,this.trigger("ready"))}addSourceBuffer(e,s){Fa({type:"mediaSource",sourceUpdater:this,action:Oa.addSourceBuffer(e,s),name:"addSourceBuffer"})}abort(e){Fa({type:e,sourceUpdater:this,action:Oa.abort(e),name:"abort"})}removeSourceBuffer(e){if(!this.canRemoveSourceBuffer()){Ye.log.error("removeSourceBuffer is not supported!");return}Fa({type:"mediaSource",sourceUpdater:this,action:Oa.removeSourceBuffer(e),name:"removeSourceBuffer"})}canRemoveSourceBuffer(){return!Ye.browser.IS_FIREFOX&&window.MediaSource&&window.MediaSource.prototype&&typeof window.MediaSource.prototype.removeSourceBuffer=="function"}static canChangeType(){return window.SourceBuffer&&window.SourceBuffer.prototype&&typeof window.SourceBuffer.prototype.changeType=="function"}canChangeType(){return this.constructor.canChangeType()}changeType(e,s){if(!this.canChangeType()){Ye.log.error("changeType is not supported!");return}Fa({type:e,sourceUpdater:this,action:Oa.changeType(s),name:"changeType"})}addOrChangeSourceBuffers(e){if(!e||typeof e!="object"||Object.keys(e).length===0)throw new Error("Cannot addOrChangeSourceBuffers to undefined codecs");Object.keys(e).forEach(s=>{const a=e[s];if(!this.hasCreatedSourceBuffers())return this.addSourceBuffer(s,a);this.canChangeType()&&this.changeType(s,a)})}appendBuffer(e,s){const{segmentInfo:a,type:h,bytes:p}=e;if(this.processedAppend_=!0,h==="audio"&&this.videoBuffer&&!this.videoAppendQueued_){this.delayedAudioAppendQueue_.push([e,s]),this.logger_(`delayed audio append of ${p.length} until video append`);return}const _=s;if(Fa({type:h,sourceUpdater:this,action:Oa.appendBuffer(p,a||{mediaIndex:-1},_),doneFn:s,name:"appendBuffer"}),h==="video"){if(this.videoAppendQueued_=!0,!this.delayedAudioAppendQueue_.length)return;const w=this.delayedAudioAppendQueue_.slice();this.logger_(`queuing delayed audio ${w.length} appendBuffers`),this.delayedAudioAppendQueue_.length=0,w.forEach(I=>{this.appendBuffer.apply(this,I)})}}audioBuffered(){return Il(this.mediaSource,this.audioBuffer)&&this.audioBuffer.buffered?this.audioBuffer.buffered:ur()}videoBuffered(){return Il(this.mediaSource,this.videoBuffer)&&this.videoBuffer.buffered?this.videoBuffer.buffered:ur()}buffered(){const e=Il(this.mediaSource,this.videoBuffer)?this.videoBuffer:null,s=Il(this.mediaSource,this.audioBuffer)?this.audioBuffer:null;return s&&!e?this.audioBuffered():e&&!s?this.videoBuffered():XU(this.audioBuffered(),this.videoBuffered())}setDuration(e,s=Tu){Fa({type:"mediaSource",sourceUpdater:this,action:Oa.duration(e),name:"duration",doneFn:s})}endOfStream(e=null,s=Tu){typeof e!="string"&&(e=void 0),Fa({type:"mediaSource",sourceUpdater:this,action:Oa.endOfStream(e),name:"endOfStream",doneFn:s})}removeAudio(e,s,a=Tu){if(!this.audioBuffered().length||this.audioBuffered().end(0)===0){a();return}Fa({type:"audio",sourceUpdater:this,action:Oa.remove(e,s),doneFn:a,name:"remove"})}removeVideo(e,s,a=Tu){if(!this.videoBuffered().length||this.videoBuffered().end(0)===0){a();return}Fa({type:"video",sourceUpdater:this,action:Oa.remove(e,s),doneFn:a,name:"remove"})}updating(){return!!(Z1("audio",this)||Z1("video",this))}audioTimestampOffset(e){return typeof e<"u"&&this.audioBuffer&&this.audioTimestampOffset_!==e&&(Fa({type:"audio",sourceUpdater:this,action:Oa.timestampOffset(e),name:"timestampOffset"}),this.audioTimestampOffset_=e),this.audioTimestampOffset_}videoTimestampOffset(e){return typeof e<"u"&&this.videoBuffer&&this.videoTimestampOffset_!==e&&(Fa({type:"video",sourceUpdater:this,action:Oa.timestampOffset(e),name:"timestampOffset"}),this.videoTimestampOffset_=e),this.videoTimestampOffset_}audioQueueCallback(e){this.audioBuffer&&Fa({type:"audio",sourceUpdater:this,action:Oa.callback(e),name:"callback"})}videoQueueCallback(e){this.videoBuffer&&Fa({type:"video",sourceUpdater:this,action:Oa.callback(e),name:"callback"})}dispose(){this.trigger("dispose"),P6.forEach(e=>{this.abort(e),this.canRemoveSourceBuffer()?this.removeSourceBuffer(e):this[`${e}QueueCallback`](()=>TL(e,this))}),this.videoAppendQueued_=!1,this.delayedAudioAppendQueue_.length=0,this.sourceopenListener_&&this.mediaSource.removeEventListener("sourceopen",this.sourceopenListener_),this.off()}}const xL=r=>decodeURIComponent(escape(String.fromCharCode.apply(null,r))),I6=r=>{const e=new Uint8Array(r);return Array.from(e).map(s=>s.toString(16).padStart(2,"0")).join("")},AL=new Uint8Array(`

`.split("").map(r=>r.charCodeAt(0)));class L6 extends Error{constructor(){super("Trying to parse received VTT cues, but there is no WebVTT. Make sure vtt.js is loaded.")}}class N6 extends Y1{constructor(e,s={}){super(e,s),this.mediaSource_=null,this.subtitlesTrack_=null,this.featuresNativeTextTracks_=e.featuresNativeTextTracks,this.loadVttJs=e.loadVttJs,this.shouldSaveSegmentTimingInfo_=!1}buffered_(){if(!this.subtitlesTrack_||!this.subtitlesTrack_.cues||!this.subtitlesTrack_.cues.length)return ur();const e=this.subtitlesTrack_.cues,s=e[0].startTime,a=e[e.length-1].startTime;return ur([[s,a]])}initSegmentForMap(e,s=!1){if(!e)return null;const a=KT(e);let h=this.initSegments_[a];if(s&&!h&&e.bytes){const p=AL.byteLength+e.bytes.byteLength,_=new Uint8Array(p);_.set(e.bytes),_.set(AL,e.bytes.byteLength),this.initSegments_[a]=h={resolvedUri:e.resolvedUri,byterange:e.byterange,bytes:_}}return h||e}couldBeginLoading_(){return this.playlist_&&this.subtitlesTrack_&&!this.paused()}init_(){return this.state="READY",this.resetEverything(),this.monitorBuffer_()}track(e){return typeof e>"u"?this.subtitlesTrack_:(this.subtitlesTrack_=e,this.state==="INIT"&&this.couldBeginLoading_()&&this.init_(),this.subtitlesTrack_)}remove(e,s){X_(e,s,this.subtitlesTrack_)}fillBuffer_(){const e=this.chooseNextRequest_();if(e){if(this.syncController_.timestampOffsetForTimeline(e.timeline)===null){const s=()=>{this.state="READY",this.paused()||this.monitorBuffer_()};this.syncController_.one("timestampoffset",s),this.state="WAITING_ON_TIMELINE";return}this.loadSegment_(e)}}timestampOffsetForSegment_(){return null}chooseNextRequest_(){return this.skipEmptySegments_(super.chooseNextRequest_())}skipEmptySegments_(e){for(;e&&e.segment.empty;){if(e.mediaIndex+1>=e.playlist.segments.length){e=null;break}e=this.generateSegmentInfo_({playlist:e.playlist,mediaIndex:e.mediaIndex+1,startOfSegment:e.startOfSegment+e.duration,isSyncRequest:e.isSyncRequest})}return e}stopForError(e){this.error(e),this.state="READY",this.pause(),this.trigger("error")}segmentRequestFinished_(e,s,a){if(!this.subtitlesTrack_){this.state="READY";return}if(this.saveTransferStats_(s.stats),!this.pendingSegment_){this.state="READY",this.mediaRequestsAborted+=1;return}if(e){e.code===Dl.TIMEOUT&&this.handleTimeout_(),e.code===Dl.ABORTED?this.mediaRequestsAborted+=1:this.mediaRequestsErrored+=1,this.stopForError(e);return}const h=this.pendingSegment_,p=a.mp4VttCues&&a.mp4VttCues.length;p&&(h.mp4VttCues=a.mp4VttCues),this.saveBandwidthRelatedStats_(h.duration,s.stats),s.key&&this.segmentKey(s.key,!0),this.state="APPENDING",this.trigger("appending");const _=h.segment;if(_.map&&(_.map.bytes=s.map.bytes),h.bytes=s.bytes,typeof window.WebVTT!="function"&&typeof this.loadVttJs=="function"){this.state="WAITING_ON_VTTJS",this.loadVttJs().then(()=>this.segmentRequestFinished_(e,s,a),()=>this.stopForError({message:"Error loading vtt.js"}));return}_.requested=!0;try{this.parseVTTCues_(h)}catch(w){this.stopForError({message:w.message,metadata:{errorType:Ye.Error.StreamingVttParserError,error:w}});return}if(p||this.updateTimeMapping_(h,this.syncController_.timelines[h.timeline],this.playlist_),h.cues.length?h.timingInfo={start:h.cues[0].startTime,end:h.cues[h.cues.length-1].endTime}:h.timingInfo={start:h.startOfSegment,end:h.startOfSegment+h.duration},h.isSyncRequest){this.trigger("syncinfoupdate"),this.pendingSegment_=null,this.state="READY";return}h.byteLength=h.bytes.byteLength,this.mediaSecondsLoaded+=_.duration,h.cues.forEach(w=>{this.subtitlesTrack_.addCue(this.featuresNativeTextTracks_?new window.VTTCue(w.startTime,w.endTime,w.text):w)}),g6(this.subtitlesTrack_),this.handleAppendsDone_()}handleData_(e,s){const a=e&&e.type==="vtt",h=s&&s.type==="text";a&&h&&super.handleData_(e,s)}updateTimingInfoEnd_(){}parseMp4VttCues_(e){const s=this.sourceUpdater_.videoTimestampOffset()===null?this.sourceUpdater_.audioTimestampOffset():this.sourceUpdater_.videoTimestampOffset();e.mp4VttCues.forEach(a=>{const h=a.start+s,p=a.end+s,_=new window.VTTCue(h,p,a.cueText);a.settings&&a.settings.split(" ").forEach(w=>{const I=w.split(":"),B=I[0],G=I[1];_[B]=isNaN(G)?G:Number(G)}),e.cues.push(_)})}parseVTTCues_(e){let s,a=!1;if(typeof window.WebVTT!="function")throw new L6;if(e.cues=[],e.timestampmap={MPEGTS:0,LOCAL:0},e.mp4VttCues){this.parseMp4VttCues_(e);return}typeof window.TextDecoder=="function"?s=new window.TextDecoder("utf8"):(s=window.WebVTT.StringDecoder(),a=!0);const h=new window.WebVTT.Parser(window,window.vttjs,s);if(h.oncue=e.cues.push.bind(e.cues),h.ontimestampmap=_=>{e.timestampmap=_},h.onparsingerror=_=>{Ye.log.warn("Error encountered when parsing cues: "+_.message)},e.segment.map){let _=e.segment.map.bytes;a&&(_=xL(_)),h.parse(_)}let p=e.bytes;a&&(p=xL(p)),h.parse(p),h.flush()}updateTimeMapping_(e,s,a){const h=e.segment;if(!s)return;if(!e.cues.length){h.empty=!0;return}const{MPEGTS:p,LOCAL:_}=e.timestampmap,I=p/$d-_+s.mapping;if(e.cues.forEach(B=>{const G=B.endTime-B.startTime,se=this.handleRollover_(B.startTime+I,s.time);B.startTime=Math.max(se,0),B.endTime=Math.max(se+G,0)}),!a.syncInfo){const B=e.cues[0].startTime,G=e.cues[e.cues.length-1].startTime;a.syncInfo={mediaSequence:a.mediaSequence+e.mediaIndex,time:Math.min(B,G-h.duration)}}}handleRollover_(e,s){if(s===null)return e;let a=e*$d;const h=s*$d;let p;for(h<a?p=-8589934592:p=8589934592;Math.abs(a-h)>4294967296;)a+=p;return a/$d}}const R6=function(r,e){const s=r.cues;for(let a=0;a<s.length;a++){const h=s[a];if(e>=h.adStartTime&&e<=h.adEndTime)return h}return null},M6=function(r,e,s=0){if(!r.segments)return;let a=s,h;for(let p=0;p<r.segments.length;p++){const _=r.segments[p];if(h||(h=R6(e,a+_.duration/2)),h){if("cueIn"in _){h.endTime=a,h.adEndTime=a,a+=_.duration,h=null;continue}if(a<h.endTime){a+=_.duration;continue}h.endTime+=_.duration}else if("cueOut"in _&&(h=new window.VTTCue(a,a+_.duration,_.cueOut),h.adStartTime=a,h.adEndTime=a+parseFloat(_.cueOut),e.addCue(h)),"cueOutCont"in _){const[w,I]=_.cueOutCont.split("/").map(parseFloat);h=new window.VTTCue(a,a+_.duration,""),h.adStartTime=a-w,h.adEndTime=h.adStartTime+I,e.addCue(h)}a+=_.duration}};class CL{constructor({start:e,end:s,segmentIndex:a,partIndex:h=null,appended:p=!1}){this.start_=e,this.end_=s,this.segmentIndex_=a,this.partIndex_=h,this.appended_=p}isInRange(e){return e>=this.start&&e<this.end}markAppended(){this.appended_=!0}resetAppendedStatus(){this.appended_=!1}get isAppended(){return this.appended_}get start(){return this.start_}get end(){return this.end_}get segmentIndex(){return this.segmentIndex_}get partIndex(){return this.partIndex_}}class O6{constructor(e,s=[]){this.segmentSyncInfo_=e,this.partsSyncInfo_=s}get segmentSyncInfo(){return this.segmentSyncInfo_}get partsSyncInfo(){return this.partsSyncInfo_}get hasPartsSyncInfo(){return this.partsSyncInfo_.length>0}resetAppendStatus(){this.segmentSyncInfo_.resetAppendedStatus(),this.partsSyncInfo_.forEach(e=>e.resetAppendedStatus())}}class kL{constructor(){this.storage_=new Map,this.diagnostics_="",this.isReliable_=!1,this.start_=-1/0,this.end_=1/0}get start(){return this.start_}get end(){return this.end_}get diagnostics(){return this.diagnostics_}get isReliable(){return this.isReliable_}resetAppendedStatus(){this.storage_.forEach(e=>e.resetAppendStatus())}update(e,s){const{mediaSequence:a,segments:h}=e;if(this.isReliable_=this.isReliablePlaylist_(a,h),!!this.isReliable_)return this.updateStorage_(h,a,this.calculateBaseTime_(a,h,s))}getSyncInfoForTime(e){for(const{segmentSyncInfo:s,partsSyncInfo:a}of this.storage_.values())if(a.length){for(const h of a)if(h.isInRange(e))return h}else if(s.isInRange(e))return s;return null}getSyncInfoForMediaSequence(e){return this.storage_.get(e)}updateStorage_(e,s,a){const h=new Map;let p=`
`,_=a,w=s;this.start_=_,e.forEach((I,B)=>{const G=this.storage_.get(w),se=_,pe=se+I.duration,Ee=!!(G&&G.segmentSyncInfo&&G.segmentSyncInfo.isAppended),Ie=new CL({start:se,end:pe,appended:Ee,segmentIndex:B});I.syncInfo=Ie;let ce=_;const Ve=(I.parts||[]).map((Be,Ke)=>{const ze=ce,it=ce+Be.duration,lt=!!(G&&G.partsSyncInfo&&G.partsSyncInfo[Ke]&&G.partsSyncInfo[Ke].isAppended),Et=new CL({start:ze,end:it,appended:lt,segmentIndex:B,partIndex:Ke});return ce=it,p+=`Media Sequence: ${w}.${Ke} | Range: ${ze} --> ${it} | Appended: ${lt}
`,Be.syncInfo=Et,Et});h.set(w,new O6(Ie,Ve)),p+=`${mL(I.resolvedUri)} | Media Sequence: ${w} | Range: ${se} --> ${pe} | Appended: ${Ee}
`,w++,_=pe}),this.end_=_,this.storage_=h,this.diagnostics_=p}calculateBaseTime_(e,s,a){if(!this.storage_.size)return 0;if(this.storage_.has(e))return this.storage_.get(e).segmentSyncInfo.start;const h=Math.min(...this.storage_.keys());if(e<h){const p=h-e;let _=this.storage_.get(h).segmentSyncInfo.start;for(let w=0;w<p;w++){const I=s[w];_-=I.duration}return _}return a}isReliablePlaylist_(e,s){return e!=null&&Array.isArray(s)&&s.length}}class PL extends kL{constructor(e){super(),this.parent_=e}calculateBaseTime_(e,s,a){if(!this.storage_.size){const h=this.parent_.getSyncInfoForMediaSequence(e);return h?h.segmentSyncInfo.start:0}return super.calculateBaseTime_(e,s,a)}}const F6=86400,Q1=[{name:"VOD",run:(r,e,s,a,h)=>s!==1/0?{time:0,segmentIndex:0,partIndex:null}:null},{name:"MediaSequence",run:(r,e,s,a,h,p)=>{const _=r.getMediaSequenceSync(p);if(!_||!_.isReliable)return null;const w=_.getSyncInfoForTime(h);return w?{time:w.start,partIndex:w.partIndex,segmentIndex:w.segmentIndex}:null}},{name:"ProgramDateTime",run:(r,e,s,a,h)=>{if(!Object.keys(r.timelineToDatetimeMappings).length)return null;let p=null,_=null;const w=M1(e);h=h||0;for(let I=0;I<w.length;I++){const B=e.endList||h===0?I:w.length-(I+1),G=w[B],se=G.segment,pe=r.timelineToDatetimeMappings[se.timeline];if(!pe||!se.dateTimeObject)continue;let Ie=se.dateTimeObject.getTime()/1e3+pe;if(se.parts&&typeof G.partIndex=="number")for(let Ve=0;Ve<G.partIndex;Ve++)Ie+=se.parts[Ve].duration;const ce=Math.abs(h-Ie);if(_!==null&&(ce===0||_<ce))break;_=ce,p={time:Ie,segmentIndex:G.segmentIndex,partIndex:G.partIndex}}return p}},{name:"Segment",run:(r,e,s,a,h)=>{let p=null,_=null;h=h||0;const w=M1(e);for(let I=0;I<w.length;I++){const B=e.endList||h===0?I:w.length-(I+1),G=w[B],se=G.segment,pe=G.part&&G.part.start||se&&se.start;if(se.timeline===a&&typeof pe<"u"){const Ee=Math.abs(h-pe);if(_!==null&&_<Ee)break;(!p||_===null||_>=Ee)&&(_=Ee,p={time:pe,segmentIndex:G.segmentIndex,partIndex:G.partIndex})}}return p}},{name:"Discontinuity",run:(r,e,s,a,h)=>{let p=null;if(h=h||0,e.discontinuityStarts&&e.discontinuityStarts.length){let _=null;for(let w=0;w<e.discontinuityStarts.length;w++){const I=e.discontinuityStarts[w],B=e.discontinuitySequence+w+1,G=r.discontinuities[B];if(G){const se=Math.abs(h-G.time);if(_!==null&&_<se)break;(!p||_===null||_>=se)&&(_=se,p={time:G.time,segmentIndex:I,partIndex:null})}}}return p}},{name:"Playlist",run:(r,e,s,a,h)=>e.syncInfo?{time:e.syncInfo.time,segmentIndex:e.syncInfo.mediaSequence-e.mediaSequence,partIndex:null}:null}];class B6 extends Ye.EventTarget{constructor(e={}){super(),this.timelines=[],this.discontinuities=[],this.timelineToDatetimeMappings={};const s=new kL,a=new PL(s),h=new PL(s);this.mediaSequenceStorage_={main:s,audio:a,vtt:h},this.logger_=mo("SyncController")}getMediaSequenceSync(e){return this.mediaSequenceStorage_[e]||null}getSyncPoint(e,s,a,h,p){if(s!==1/0)return Q1.find(({name:I})=>I==="VOD").run(this,e,s);const _=this.runStrategies_(e,s,a,h,p);if(!_.length)return null;for(const w of _){const{syncPoint:I,strategy:B}=w,{segmentIndex:G,time:se}=I;if(G<0)continue;const pe=e.segments[G],Ee=se,Ie=Ee+pe.duration;if(this.logger_(`Strategy: ${B}. Current time: ${h}. selected segment: ${G}. Time: [${Ee} -> ${Ie}]}`),h>=Ee&&h<Ie)return this.logger_("Found sync point with exact match: ",I),I}return this.selectSyncPoint_(_,{key:"time",value:h})}getExpiredTime(e,s){if(!e||!e.segments)return null;const a=this.runStrategies_(e,s,e.discontinuitySequence,0);if(!a.length)return null;const h=this.selectSyncPoint_(a,{key:"segmentIndex",value:0});return h.segmentIndex>0&&(h.time*=-1),Math.abs(h.time+z_({defaultDuration:e.targetDuration,durationList:e.segments,startIndex:h.segmentIndex,endIndex:0}))}runStrategies_(e,s,a,h,p){const _=[];for(let w=0;w<Q1.length;w++){const I=Q1[w],B=I.run(this,e,s,a,h,p);B&&(B.strategy=I.name,_.push({strategy:I.name,syncPoint:B}))}return _}selectSyncPoint_(e,s){let a=e[0].syncPoint,h=Math.abs(e[0].syncPoint[s.key]-s.value),p=e[0].strategy;for(let _=1;_<e.length;_++){const w=Math.abs(e[_].syncPoint[s.key]-s.value);w<h&&(h=w,a=e[_].syncPoint,p=e[_].strategy)}return this.logger_(`syncPoint for [${s.key}: ${s.value}] chosen with strategy [${p}]: [time:${a.time}, segmentIndex:${a.segmentIndex}`+(typeof a.partIndex=="number"?`,partIndex:${a.partIndex}`:"")+"]"),a}saveExpiredSegmentInfo(e,s){const a=s.mediaSequence-e.mediaSequence;if(a>F6){Ye.log.warn(`Not saving expired segment info. Media sequence gap ${a} is too large.`);return}for(let h=a-1;h>=0;h--){const p=e.segments[h];if(p&&typeof p.start<"u"){s.syncInfo={mediaSequence:e.mediaSequence+h,time:p.start},this.logger_(`playlist refresh sync: [time:${s.syncInfo.time}, mediaSequence: ${s.syncInfo.mediaSequence}]`),this.trigger("syncinfoupdate");break}}}setDateTimeMappingForStart(e){if(this.timelineToDatetimeMappings={},e.segments&&e.segments.length&&e.segments[0].dateTimeObject){const s=e.segments[0],a=s.dateTimeObject.getTime()/1e3;this.timelineToDatetimeMappings[s.timeline]=-a}}saveSegmentTimingInfo({segmentInfo:e,shouldSaveTimelineMapping:s}){const a=this.calculateSegmentTimeMapping_(e,e.timingInfo,s),h=e.segment;a&&(this.saveDiscontinuitySyncInfo_(e),e.playlist.syncInfo||(e.playlist.syncInfo={mediaSequence:e.playlist.mediaSequence+e.mediaIndex,time:h.start}));const p=h.dateTimeObject;h.discontinuity&&s&&p&&(this.timelineToDatetimeMappings[h.timeline]=-(p.getTime()/1e3))}timestampOffsetForTimeline(e){return typeof this.timelines[e]>"u"?null:this.timelines[e].time}mappingForTimeline(e){return typeof this.timelines[e]>"u"?null:this.timelines[e].mapping}calculateSegmentTimeMapping_(e,s,a){const h=e.segment,p=e.part;let _=this.timelines[e.timeline],w,I;if(typeof e.timestampOffset=="number")_={time:e.startOfSegment,mapping:e.startOfSegment-s.start},a&&(this.timelines[e.timeline]=_,this.trigger("timestampoffset"),this.logger_(`time mapping for timeline ${e.timeline}: [time: ${_.time}] [mapping: ${_.mapping}]`)),w=e.startOfSegment,I=s.end+_.mapping;else if(_)w=s.start+_.mapping,I=s.end+_.mapping;else return!1;return p&&(p.start=w,p.end=I),(!h.start||w<h.start)&&(h.start=w),h.end=I,!0}saveDiscontinuitySyncInfo_(e){const s=e.playlist,a=e.segment;if(a.discontinuity)this.discontinuities[a.timeline]={time:a.start,accuracy:0};else if(s.discontinuityStarts&&s.discontinuityStarts.length)for(let h=0;h<s.discontinuityStarts.length;h++){const p=s.discontinuityStarts[h],_=s.discontinuitySequence+h+1,w=p-e.mediaIndex,I=Math.abs(w);if(!this.discontinuities[_]||this.discontinuities[_].accuracy>I){let B;w<0?B=a.start-z_({defaultDuration:s.targetDuration,durationList:s.segments,startIndex:e.mediaIndex,endIndex:p}):B=a.end+z_({defaultDuration:s.targetDuration,durationList:s.segments,startIndex:e.mediaIndex+1,endIndex:p}),this.discontinuities[_]={time:B,accuracy:I}}}}dispose(){this.trigger("dispose"),this.off()}}class U6 extends Ye.EventTarget{constructor(){super(),this.pendingTimelineChanges_={},this.lastTimelineChanges_={}}clearPendingTimelineChange(e){this.pendingTimelineChanges_[e]=null,this.trigger("pendingtimelinechange")}pendingTimelineChange({type:e,from:s,to:a}){return typeof s=="number"&&typeof a=="number"&&(this.pendingTimelineChanges_[e]={type:e,from:s,to:a},this.trigger("pendingtimelinechange")),this.pendingTimelineChanges_[e]}lastTimelineChange({type:e,from:s,to:a}){if(typeof s=="number"&&typeof a=="number"){this.lastTimelineChanges_[e]={type:e,from:s,to:a},delete this.pendingTimelineChanges_[e];const h={timelineChangeInfo:{from:s,to:a}};this.trigger({type:"timelinechange",metadata:h})}return this.lastTimelineChanges_[e]}dispose(){this.trigger("dispose"),this.pendingTimelineChanges_={},this.lastTimelineChanges_={},this.off()}}const j6=tL(iL(function(){var r=function(){function ce(){this.listeners={}}var Ve=ce.prototype;return Ve.on=function(Ke,ze){this.listeners[Ke]||(this.listeners[Ke]=[]),this.listeners[Ke].push(ze)},Ve.off=function(Ke,ze){if(!this.listeners[Ke])return!1;var it=this.listeners[Ke].indexOf(ze);return this.listeners[Ke]=this.listeners[Ke].slice(0),this.listeners[Ke].splice(it,1),it>-1},Ve.trigger=function(Ke){var ze=this.listeners[Ke];if(ze)if(arguments.length===2)for(var it=ze.length,lt=0;lt<it;++lt)ze[lt].call(this,arguments[1]);else for(var Et=Array.prototype.slice.call(arguments,1),yt=ze.length,Pt=0;Pt<yt;++Pt)ze[Pt].apply(this,Et)},Ve.dispose=function(){this.listeners={}},Ve.pipe=function(Ke){this.on("data",function(ze){Ke.push(ze)})},ce}();/*! @name pkcs7 @version 1.0.4 @license Apache-2.0 */function e(ce){return ce.subarray(0,ce.byteLength-ce[ce.byteLength-1])}/*! @name aes-decrypter @version 4.0.2 @license Apache-2.0 */const s=function(){const ce=[[[],[],[],[],[]],[[],[],[],[],[]]],Ve=ce[0],Be=ce[1],Ke=Ve[4],ze=Be[4];let it,lt,Et;const yt=[],Pt=[];let Ti,Ms,us,Vs,ai,cs;for(it=0;it<256;it++)Pt[(yt[it]=it<<1^(it>>7)*283)^it]=it;for(lt=Et=0;!Ke[lt];lt^=Ti||1,Et=Pt[Et]||1)for(Vs=Et^Et<<1^Et<<2^Et<<3^Et<<4,Vs=Vs>>8^Vs&255^99,Ke[lt]=Vs,ze[Vs]=lt,us=yt[Ms=yt[Ti=yt[lt]]],cs=us*16843009^Ms*65537^Ti*257^lt*16843008,ai=yt[Vs]*257^Vs*16843008,it=0;it<4;it++)Ve[it][lt]=ai=ai<<24^ai>>>8,Be[it][Vs]=cs=cs<<24^cs>>>8;for(it=0;it<5;it++)Ve[it]=Ve[it].slice(0),Be[it]=Be[it].slice(0);return ce};let a=null;class h{constructor(Ve){a||(a=s()),this._tables=[[a[0][0].slice(),a[0][1].slice(),a[0][2].slice(),a[0][3].slice(),a[0][4].slice()],[a[1][0].slice(),a[1][1].slice(),a[1][2].slice(),a[1][3].slice(),a[1][4].slice()]];let Be,Ke,ze;const it=this._tables[0][4],lt=this._tables[1],Et=Ve.length;let yt=1;if(Et!==4&&Et!==6&&Et!==8)throw new Error("Invalid aes key size");const Pt=Ve.slice(0),Ti=[];for(this._key=[Pt,Ti],Be=Et;Be<4*Et+28;Be++)ze=Pt[Be-1],(Be%Et===0||Et===8&&Be%Et===4)&&(ze=it[ze>>>24]<<24^it[ze>>16&255]<<16^it[ze>>8&255]<<8^it[ze&255],Be%Et===0&&(ze=ze<<8^ze>>>24^yt<<24,yt=yt<<1^(yt>>7)*283)),Pt[Be]=Pt[Be-Et]^ze;for(Ke=0;Be;Ke++,Be--)ze=Pt[Ke&3?Be:Be-4],Be<=4||Ke<4?Ti[Ke]=ze:Ti[Ke]=lt[0][it[ze>>>24]]^lt[1][it[ze>>16&255]]^lt[2][it[ze>>8&255]]^lt[3][it[ze&255]]}decrypt(Ve,Be,Ke,ze,it,lt){const Et=this._key[1];let yt=Ve^Et[0],Pt=ze^Et[1],Ti=Ke^Et[2],Ms=Be^Et[3],us,Vs,ai;const cs=Et.length/4-2;let Yr,ys=4;const Cn=this._tables[1],Eu=Cn[0],Gd=Cn[1],Xd=Cn[2],Kd=Cn[3],Yd=Cn[4];for(Yr=0;Yr<cs;Yr++)us=Eu[yt>>>24]^Gd[Pt>>16&255]^Xd[Ti>>8&255]^Kd[Ms&255]^Et[ys],Vs=Eu[Pt>>>24]^Gd[Ti>>16&255]^Xd[Ms>>8&255]^Kd[yt&255]^Et[ys+1],ai=Eu[Ti>>>24]^Gd[Ms>>16&255]^Xd[yt>>8&255]^Kd[Pt&255]^Et[ys+2],Ms=Eu[Ms>>>24]^Gd[yt>>16&255]^Xd[Pt>>8&255]^Kd[Ti&255]^Et[ys+3],ys+=4,yt=us,Pt=Vs,Ti=ai;for(Yr=0;Yr<4;Yr++)it[(3&-Yr)+lt]=Yd[yt>>>24]<<24^Yd[Pt>>16&255]<<16^Yd[Ti>>8&255]<<8^Yd[Ms&255]^Et[ys++],us=yt,yt=Pt,Pt=Ti,Ti=Ms,Ms=us}}class p extends r{constructor(){super(r),this.jobs=[],this.delay=1,this.timeout_=null}processJob_(){this.jobs.shift()(),this.jobs.length?this.timeout_=setTimeout(this.processJob_.bind(this),this.delay):this.timeout_=null}push(Ve){this.jobs.push(Ve),this.timeout_||(this.timeout_=setTimeout(this.processJob_.bind(this),this.delay))}}const _=function(ce){return ce<<24|(ce&65280)<<8|(ce&16711680)>>8|ce>>>24},w=function(ce,Ve,Be){const Ke=new Int32Array(ce.buffer,ce.byteOffset,ce.byteLength>>2),ze=new h(Array.prototype.slice.call(Ve)),it=new Uint8Array(ce.byteLength),lt=new Int32Array(it.buffer);let Et,yt,Pt,Ti,Ms,us,Vs,ai,cs;for(Et=Be[0],yt=Be[1],Pt=Be[2],Ti=Be[3],cs=0;cs<Ke.length;cs+=4)Ms=_(Ke[cs]),us=_(Ke[cs+1]),Vs=_(Ke[cs+2]),ai=_(Ke[cs+3]),ze.decrypt(Ms,us,Vs,ai,lt,cs),lt[cs]=_(lt[cs]^Et),lt[cs+1]=_(lt[cs+1]^yt),lt[cs+2]=_(lt[cs+2]^Pt),lt[cs+3]=_(lt[cs+3]^Ti),Et=Ms,yt=us,Pt=Vs,Ti=ai;return it};class I{constructor(Ve,Be,Ke,ze){const it=I.STEP,lt=new Int32Array(Ve.buffer),Et=new Uint8Array(Ve.byteLength);let yt=0;for(this.asyncStream_=new p,this.asyncStream_.push(this.decryptChunk_(lt.subarray(yt,yt+it),Be,Ke,Et)),yt=it;yt<lt.length;yt+=it)Ke=new Uint32Array([_(lt[yt-4]),_(lt[yt-3]),_(lt[yt-2]),_(lt[yt-1])]),this.asyncStream_.push(this.decryptChunk_(lt.subarray(yt,yt+it),Be,Ke,Et));this.asyncStream_.push(function(){ze(null,e(Et))})}static get STEP(){return 32e3}decryptChunk_(Ve,Be,Ke,ze){return function(){const it=w(Ve,Be,Ke);ze.set(it,Ve.byteOffset)}}}var B=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},G;typeof window<"u"?G=window:typeof B<"u"?G=B:typeof self<"u"?G=self:G={};var se=G,pe=function(Ve){return ArrayBuffer.isView==="function"?ArrayBuffer.isView(Ve):Ve&&Ve.buffer instanceof ArrayBuffer},Ee=se.BigInt||Number;Ee("0x1"),Ee("0x100"),Ee("0x10000"),Ee("0x1000000"),Ee("0x100000000"),Ee("0x10000000000"),Ee("0x1000000000000"),Ee("0x100000000000000"),Ee("0x10000000000000000"),function(){var ce=new Uint16Array([65484]),Ve=new Uint8Array(ce.buffer,ce.byteOffset,ce.byteLength);return Ve[0]===255?"big":Ve[0]===204?"little":"unknown"}();const Ie=function(ce){const Ve={};return Object.keys(ce).forEach(Be=>{const Ke=ce[Be];pe(Ke)?Ve[Be]={bytes:Ke.buffer,byteOffset:Ke.byteOffset,byteLength:Ke.byteLength}:Ve[Be]=Ke}),Ve};self.onmessage=function(ce){const Ve=ce.data,Be=new Uint8Array(Ve.encrypted.bytes,Ve.encrypted.byteOffset,Ve.encrypted.byteLength),Ke=new Uint32Array(Ve.key.bytes,Ve.key.byteOffset,Ve.key.byteLength/4),ze=new Uint32Array(Ve.iv.bytes,Ve.iv.byteOffset,Ve.iv.byteLength/4);new I(Be,Ke,ze,function(it,lt){self.postMessage(Ie({source:Ve.source,decrypted:lt}),[lt.buffer])})}}));var H6=eL(j6);const V6=r=>{let e=r.default?"main":"alternative";return r.characteristics&&r.characteristics.indexOf("public.accessibility.describes-video")>=0&&(e="main-desc"),e},DL=(r,e)=>{r.abort(),r.pause(),e&&e.activePlaylistLoader&&(e.activePlaylistLoader.pause(),e.activePlaylistLoader=null)},J1=(r,e)=>{e.activePlaylistLoader=r,r.load()},$6=(r,e)=>()=>{const{segmentLoaders:{[r]:s,main:a},mediaTypes:{[r]:h}}=e,p=h.activeTrack(),_=h.getActiveGroup(),w=h.activePlaylistLoader,I=h.lastGroup_;if(!(_&&I&&_.id===I.id)&&(h.lastGroup_=_,h.lastTrack_=p,DL(s,h),!(!_||_.isMainPlaylist))){if(!_.playlistLoader){w&&a.resetEverything();return}s.resyncLoader(),J1(_.playlistLoader,h)}},z6=(r,e)=>()=>{const{segmentLoaders:{[r]:s},mediaTypes:{[r]:a}}=e;a.lastGroup_=null,s.abort(),s.pause()},W6=(r,e)=>()=>{const{mainPlaylistLoader:s,segmentLoaders:{[r]:a,main:h},mediaTypes:{[r]:p}}=e,_=p.activeTrack(),w=p.getActiveGroup(),I=p.activePlaylistLoader,B=p.lastTrack_;if(!(B&&_&&B.id===_.id)&&(p.lastGroup_=w,p.lastTrack_=_,DL(a,p),!!w)){if(w.isMainPlaylist){if(!_||!B||_.id===B.id)return;const G=e.vhs.playlistController_,se=G.selectPlaylist();if(G.media()===se)return;p.logger_(`track change. Switching main audio from ${B.id} to ${_.id}`),s.pause(),h.resetEverything(),G.fastQualityChange_(se);return}if(r==="AUDIO"){if(!w.playlistLoader){h.setAudio(!0),h.resetEverything();return}a.setAudio(!0),h.setAudio(!1)}if(I===w.playlistLoader){J1(w.playlistLoader,p);return}a.track&&a.track(_),a.resetEverything(),J1(w.playlistLoader,p)}},QT={AUDIO:(r,e)=>()=>{const{mediaTypes:{[r]:s},excludePlaylist:a}=e,h=s.activeTrack(),p=s.activeGroup(),_=(p.filter(I=>I.default)[0]||p[0]).id,w=s.tracks[_];if(h===w){a({error:{message:"Problem encountered loading the default audio track."}});return}Ye.log.warn("Problem encountered loading the alternate audio track.Switching back to default.");for(const I in s.tracks)s.tracks[I].enabled=s.tracks[I]===w;s.onTrackChanged()},SUBTITLES:(r,e)=>()=>{const{mediaTypes:{[r]:s}}=e;Ye.log.warn("Problem encountered loading the subtitle track.Disabling subtitle track.");const a=s.activeTrack();a&&(a.mode="disabled"),s.onTrackChanged()}},IL={AUDIO:(r,e,s)=>{if(!e)return;const{tech:a,requestOptions:h,segmentLoaders:{[r]:p}}=s;e.on("loadedmetadata",()=>{const _=e.media();p.playlist(_,h),(!a.paused()||_.endList&&a.preload()!=="none")&&p.load()}),e.on("loadedplaylist",()=>{p.playlist(e.media(),h),a.paused()||p.load()}),e.on("error",QT[r](r,s))},SUBTITLES:(r,e,s)=>{const{tech:a,requestOptions:h,segmentLoaders:{[r]:p},mediaTypes:{[r]:_}}=s;e.on("loadedmetadata",()=>{const w=e.media();p.playlist(w,h),p.track(_.activeTrack()),(!a.paused()||w.endList&&a.preload()!=="none")&&p.load()}),e.on("loadedplaylist",()=>{p.playlist(e.media(),h),a.paused()||p.load()}),e.on("error",QT[r](r,s))}},q6={AUDIO:(r,e)=>{const{vhs:s,sourceType:a,segmentLoaders:{[r]:h},requestOptions:p,main:{mediaGroups:_},mediaTypes:{[r]:{groups:w,tracks:I,logger_:B}},mainPlaylistLoader:G}=e,se=W_(G.main);(!_[r]||Object.keys(_[r]).length===0)&&(_[r]={main:{default:{default:!0}}},se&&(_[r].main.default.playlists=G.main.playlists));for(const pe in _[r]){w[pe]||(w[pe]=[]);for(const Ee in _[r][pe]){let Ie=_[r][pe][Ee],ce;if(se?(B(`AUDIO group '${pe}' label '${Ee}' is a main playlist`),Ie.isMainPlaylist=!0,ce=null):a==="vhs-json"&&Ie.playlists?ce=new Og(Ie.playlists[0],s,p):Ie.resolvedUri?ce=new Og(Ie.resolvedUri,s,p):Ie.playlists&&a==="dash"?ce=new z1(Ie.playlists[0],s,p,G):ce=null,Ie=As({id:Ee,playlistLoader:ce},Ie),IL[r](r,Ie.playlistLoader,e),w[pe].push(Ie),typeof I[Ee]>"u"){const Ve=new Ye.AudioTrack({id:Ee,kind:V6(Ie),enabled:!1,language:Ie.language,default:Ie.default,label:Ee});I[Ee]=Ve}}}h.on("error",QT[r](r,e))},SUBTITLES:(r,e)=>{const{tech:s,vhs:a,sourceType:h,segmentLoaders:{[r]:p},requestOptions:_,main:{mediaGroups:w},mediaTypes:{[r]:{groups:I,tracks:B}},mainPlaylistLoader:G}=e;for(const se in w[r]){I[se]||(I[se]=[]);for(const pe in w[r][se]){if(!a.options_.useForcedSubtitles&&w[r][se][pe].forced)continue;let Ee=w[r][se][pe],Ie;if(h==="hls")Ie=new Og(Ee.resolvedUri,a,_);else if(h==="dash"){if(!Ee.playlists.filter(Ve=>Ve.excludeUntil!==1/0).length)return;Ie=new z1(Ee.playlists[0],a,_,G)}else h==="vhs-json"&&(Ie=new Og(Ee.playlists?Ee.playlists[0]:Ee.resolvedUri,a,_));if(Ee=As({id:pe,playlistLoader:Ie},Ee),IL[r](r,Ee.playlistLoader,e),I[se].push(Ee),typeof B[pe]>"u"){const ce=s.addRemoteTextTrack({id:pe,kind:"subtitles",default:Ee.default&&Ee.autoselect,language:Ee.language,label:pe},!1).track;B[pe]=ce}}}p.on("error",QT[r](r,e))},"CLOSED-CAPTIONS":(r,e)=>{const{tech:s,main:{mediaGroups:a},mediaTypes:{[r]:{groups:h,tracks:p}}}=e;for(const _ in a[r]){h[_]||(h[_]=[]);for(const w in a[r][_]){const I=a[r][_][w];if(!/^(?:CC|SERVICE)/.test(I.instreamId))continue;const B=s.options_.vhs&&s.options_.vhs.captionServices||{};let G={label:w,language:I.language,instreamId:I.instreamId,default:I.default&&I.autoselect};if(B[G.instreamId]&&(G=As(G,B[G.instreamId])),G.default===void 0&&delete G.default,h[_].push(As({id:w},I)),typeof p[w]>"u"){const se=s.addRemoteTextTrack({id:G.instreamId,kind:"captions",default:G.default,language:G.language,label:G.label},!1).track;p[w]=se}}}}},LL=(r,e)=>{for(let s=0;s<r.length;s++)if(B1(e,r[s])||r[s].playlists&&LL(r[s].playlists,e))return!0;return!1},G6=(r,e)=>s=>{const{mainPlaylistLoader:a,mediaTypes:{[r]:{groups:h}}}=e,p=a.media();if(!p)return null;let _=null;p.attributes[r]&&(_=h[p.attributes[r]]);const w=Object.keys(h);if(!_)if(r==="AUDIO"&&w.length>1&&W_(e.main))for(let I=0;I<w.length;I++){const B=h[w[I]];if(LL(B,p)){_=B;break}}else h.main?_=h.main:w.length===1&&(_=h[w[0]]);return typeof s>"u"?_:s===null||!_?null:_.filter(I=>I.id===s.id)[0]||null},X6={AUDIO:(r,e)=>()=>{const{mediaTypes:{[r]:{tracks:s}}}=e;for(const a in s)if(s[a].enabled)return s[a];return null},SUBTITLES:(r,e)=>()=>{const{mediaTypes:{[r]:{tracks:s}}}=e;for(const a in s)if(s[a].mode==="showing"||s[a].mode==="hidden")return s[a];return null}},K6=(r,{mediaTypes:e})=>()=>{const s=e[r].activeTrack();return s?e[r].activeGroup(s):null},Y6=r=>{["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(B=>{q6[B](B,r)});const{mediaTypes:e,mainPlaylistLoader:s,tech:a,vhs:h,segmentLoaders:{["AUDIO"]:p,main:_}}=r;["AUDIO","SUBTITLES"].forEach(B=>{e[B].activeGroup=G6(B,r),e[B].activeTrack=X6[B](B,r),e[B].onGroupChanged=$6(B,r),e[B].onGroupChanging=z6(B,r),e[B].onTrackChanged=W6(B,r),e[B].getActiveGroup=K6(B,r)});const w=e.AUDIO.activeGroup();if(w){const B=(w.filter(se=>se.default)[0]||w[0]).id;e.AUDIO.tracks[B].enabled=!0,e.AUDIO.onGroupChanged(),e.AUDIO.onTrackChanged(),e.AUDIO.getActiveGroup().playlistLoader?(_.setAudio(!1),p.setAudio(!0)):_.setAudio(!0)}s.on("mediachange",()=>{["AUDIO","SUBTITLES"].forEach(B=>e[B].onGroupChanged())}),s.on("mediachanging",()=>{["AUDIO","SUBTITLES"].forEach(B=>e[B].onGroupChanging())});const I=()=>{e.AUDIO.onTrackChanged(),a.trigger({type:"usage",name:"vhs-audio-change"})};a.audioTracks().addEventListener("change",I),a.remoteTextTracks().addEventListener("change",e.SUBTITLES.onTrackChanged),h.on("dispose",()=>{a.audioTracks().removeEventListener("change",I),a.remoteTextTracks().removeEventListener("change",e.SUBTITLES.onTrackChanged)}),a.clearTracks("audio");for(const B in e.AUDIO.tracks)a.audioTracks().addTrack(e.AUDIO.tracks[B])},Z6=()=>{const r={};return["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(e=>{r[e]={groups:{},tracks:{},activePlaylistLoader:null,activeGroup:Tu,activeTrack:Tu,getActiveGroup:Tu,onGroupChanged:Tu,onTrackChanged:Tu,lastTrack_:null,logger_:mo(`MediaGroups[${e}]`)}}),r};class NL{constructor(){this.priority_=[],this.pathwayClones_=new Map}set version(e){e===1&&(this.version_=e)}set ttl(e){this.ttl_=e||300}set reloadUri(e){e&&(this.reloadUri_=ma(this.reloadUri_,e))}set priority(e){e&&e.length&&(this.priority_=e)}set pathwayClones(e){e&&e.length&&(this.pathwayClones_=new Map(e.map(s=>[s.ID,s])))}get version(){return this.version_}get ttl(){return this.ttl_}get reloadUri(){return this.reloadUri_}get priority(){return this.priority_}get pathwayClones(){return this.pathwayClones_}}class Q6 extends Ye.EventTarget{constructor(e,s){super(),this.currentPathway=null,this.defaultPathway=null,this.queryBeforeStart=!1,this.availablePathways_=new Set,this.steeringManifest=new NL,this.proxyServerUrl_=null,this.manifestType_=null,this.ttlTimeout_=null,this.request_=null,this.currentPathwayClones=new Map,this.nextPathwayClones=new Map,this.excludedSteeringManifestURLs=new Set,this.logger_=mo("Content Steering"),this.xhr_=e,this.getBandwidth_=s}assignTagProperties(e,s){this.manifestType_=s.serverUri?"HLS":"DASH";const a=s.serverUri||s.serverURL;if(!a){this.logger_(`steering manifest URL is ${a}, cannot request steering manifest.`),this.trigger("error");return}if(a.startsWith("data:")){this.decodeDataUriManifest_(a.substring(a.indexOf(",")+1));return}this.steeringManifest.reloadUri=ma(e,a),this.defaultPathway=s.pathwayId||s.defaultServiceLocation,this.queryBeforeStart=s.queryBeforeStart,this.proxyServerUrl_=s.proxyServerURL,this.defaultPathway&&!this.queryBeforeStart&&this.trigger("content-steering")}requestSteeringManifest(e){const s=this.steeringManifest.reloadUri;if(!s)return;const a=e?s:this.getRequestURI(s);if(!a){this.logger_("No valid content steering manifest URIs. Stopping content steering."),this.trigger("error"),this.dispose();return}const h={contentSteeringInfo:{uri:a}};this.trigger({type:"contentsteeringloadstart",metadata:h}),this.request_=this.xhr_({uri:a,requestType:"content-steering-manifest"},(p,_)=>{if(p){if(_.status===410){this.logger_(`manifest request 410 ${p}.`),this.logger_(`There will be no more content steering requests to ${a} this session.`),this.excludedSteeringManifestURLs.add(a);return}if(_.status===429){const B=_.responseHeaders["retry-after"];this.logger_(`manifest request 429 ${p}.`),this.logger_(`content steering will retry in ${B} seconds.`),this.startTTLTimeout_(parseInt(B,10));return}this.logger_(`manifest failed to load ${p}.`),this.startTTLTimeout_();return}this.trigger({type:"contentsteeringloadcomplete",metadata:h});let w;try{w=JSON.parse(this.request_.responseText)}catch(B){const G={errorType:Ye.Error.StreamingContentSteeringParserError,error:B};this.trigger({type:"error",metadata:G})}this.assignSteeringProperties_(w);const I={contentSteeringInfo:h.contentSteeringInfo,contentSteeringManifest:{version:this.steeringManifest.version,reloadUri:this.steeringManifest.reloadUri,priority:this.steeringManifest.priority}};this.trigger({type:"contentsteeringparsed",metadata:I}),this.startTTLTimeout_()})}setProxyServerUrl_(e){const s=new window.URL(e),a=new window.URL(this.proxyServerUrl_);return a.searchParams.set("url",encodeURI(s.toString())),this.setSteeringParams_(a.toString())}decodeDataUriManifest_(e){const s=JSON.parse(window.atob(e));this.assignSteeringProperties_(s)}setSteeringParams_(e){const s=new window.URL(e),a=this.getPathway(),h=this.getBandwidth_();if(a){const p=`_${this.manifestType_}_pathway`;s.searchParams.set(p,a)}if(h){const p=`_${this.manifestType_}_throughput`;s.searchParams.set(p,h)}return s.toString()}assignSteeringProperties_(e){if(this.steeringManifest.version=e.VERSION,!this.steeringManifest.version){this.logger_(`manifest version is ${e.VERSION}, which is not supported.`),this.trigger("error");return}this.steeringManifest.ttl=e.TTL,this.steeringManifest.reloadUri=e["RELOAD-URI"],this.steeringManifest.priority=e["PATHWAY-PRIORITY"]||e["SERVICE-LOCATION-PRIORITY"],this.steeringManifest.pathwayClones=e["PATHWAY-CLONES"],this.nextPathwayClones=this.steeringManifest.pathwayClones,this.availablePathways_.size||(this.logger_("There are no available pathways for content steering. Ending content steering."),this.trigger("error"),this.dispose());const a=(h=>{for(const p of h)if(this.availablePathways_.has(p))return p;return[...this.availablePathways_][0]})(this.steeringManifest.priority);this.currentPathway!==a&&(this.currentPathway=a,this.trigger("content-steering"))}getPathway(){return this.currentPathway||this.defaultPathway}getRequestURI(e){if(!e)return null;const s=h=>this.excludedSteeringManifestURLs.has(h);if(this.proxyServerUrl_){const h=this.setProxyServerUrl_(e);if(!s(h))return h}const a=this.setSteeringParams_(e);return s(a)?null:a}startTTLTimeout_(e=this.steeringManifest.ttl){const s=e*1e3;this.ttlTimeout_=window.setTimeout(()=>{this.requestSteeringManifest()},s)}clearTTLTimeout_(){window.clearTimeout(this.ttlTimeout_),this.ttlTimeout_=null}abort(){this.request_&&this.request_.abort(),this.request_=null}dispose(){this.off("content-steering"),this.off("error"),this.abort(),this.clearTTLTimeout_(),this.currentPathway=null,this.defaultPathway=null,this.queryBeforeStart=null,this.proxyServerUrl_=null,this.manifestType_=null,this.ttlTimeout_=null,this.request_=null,this.excludedSteeringManifestURLs=new Set,this.availablePathways_=new Set,this.steeringManifest=new NL}addAvailablePathway(e){e&&this.availablePathways_.add(e)}clearAvailablePathways(){this.availablePathways_.clear()}excludePathway(e){return this.availablePathways_.delete(e)}didDASHTagChange(e,s){return!s&&this.steeringManifest.reloadUri||s&&(ma(e,s.serverURL)!==this.steeringManifest.reloadUri||s.defaultServiceLocation!==this.defaultPathway||s.queryBeforeStart!==this.queryBeforeStart||s.proxyServerURL!==this.proxyServerUrl_)}getAvailablePathways(){return this.availablePathways_}}const J6=(r,e)=>{let s=null;return(...a)=>{clearTimeout(s),s=setTimeout(()=>{r.apply(null,a)},e)}},ej=10;let Qh;const tj=["mediaRequests","mediaRequestsAborted","mediaRequestsTimedout","mediaRequestsErrored","mediaTransferDuration","mediaBytesTransferred","mediaAppends"],ij=function(r){return this.audioSegmentLoader_[r]+this.mainSegmentLoader_[r]},sj=function({currentPlaylist:r,buffered:e,currentTime:s,nextPlaylist:a,bufferLowWaterLine:h,bufferHighWaterLine:p,duration:_,bufferBasedABR:w,log:I}){if(!a)return Ye.log.warn("We received no playlist to switch to. Please check your stream."),!1;const B=`allowing switch ${r&&r.id||"null"} -> ${a.id}`;if(!r)return I(`${B} as current playlist is not set`),!0;if(a.id===r.id)return!1;const G=!!Ng(e,s).length;if(!r.endList)return!G&&typeof r.partTargetDuration=="number"?(I(`not ${B} as current playlist is live llhls, but currentTime isn't in buffered.`),!1):(I(`${B} as current playlist is live`),!0);const se=N1(e,s),pe=w?hr.EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE:hr.MAX_BUFFER_LOW_WATER_LINE;if(_<pe)return I(`${B} as duration < max low water line (${_} < ${pe})`),!0;const Ee=a.attributes.BANDWIDTH,Ie=r.attributes.BANDWIDTH;if(Ee<Ie&&(!w||se<p)){let ce=`${B} as next bandwidth < current bandwidth (${Ee} < ${Ie})`;return w&&(ce+=` and forwardBuffer < bufferHighWaterLine (${se} < ${p})`),I(ce),!0}if((!w||Ee>Ie)&&se>=h){let ce=`${B} as forwardBuffer >= bufferLowWaterLine (${se} >= ${h})`;return w&&(ce+=` and next bandwidth > current bandwidth (${Ee} > ${Ie})`),I(ce),!0}return I(`not ${B} as no switching criteria met`),!1};class nj extends Ye.EventTarget{constructor(e){super(),this.fastQualityChange_=J6(this.fastQualityChange_.bind(this),100);const{src:s,withCredentials:a,tech:h,bandwidth:p,externVhs:_,useCueTags:w,playlistExclusionDuration:I,enableLowInitialPlaylist:B,sourceType:G,cacheEncryptionKeys:se,bufferBasedABR:pe,leastPixelDiffSelector:Ee,captionServices:Ie,experimentalUseMMS:ce}=e;if(!s)throw new Error("A non-empty playlist URL or JSON manifest string is required");let{maxPlaylistRetries:Ve}=e;(Ve===null||typeof Ve>"u")&&(Ve=1/0),Qh=_,this.bufferBasedABR=!!pe,this.leastPixelDiffSelector=!!Ee,this.withCredentials=a,this.tech_=h,this.vhs_=h.vhs,this.player_=e.player_,this.sourceType_=G,this.useCueTags_=w,this.playlistExclusionDuration=I,this.maxPlaylistRetries=Ve,this.enableLowInitialPlaylist=B,this.usingManagedMediaSource_=!1,this.useCueTags_&&(this.cueTagsTrack_=this.tech_.addTextTrack("metadata","ad-cues"),this.cueTagsTrack_.inBandMetadataTrackDispatchType=""),this.requestOptions_={withCredentials:a,maxPlaylistRetries:Ve,timeout:null},this.on("error",this.pauseLoading),this.mediaTypes_=Z6(),ce&&window.ManagedMediaSource?(this.tech_.el_.disableRemotePlayback=!0,this.mediaSource=new window.ManagedMediaSource,this.usingManagedMediaSource_=!0,Ye.log("Using ManagedMediaSource")):window.MediaSource&&(this.mediaSource=new window.MediaSource),this.handleDurationChange_=this.handleDurationChange_.bind(this),this.handleSourceOpen_=this.handleSourceOpen_.bind(this),this.handleSourceEnded_=this.handleSourceEnded_.bind(this),this.load=this.load.bind(this),this.pause=this.pause.bind(this),this.mediaSource.addEventListener("durationchange",this.handleDurationChange_),this.mediaSource.addEventListener("sourceopen",this.handleSourceOpen_),this.mediaSource.addEventListener("sourceended",this.handleSourceEnded_),this.mediaSource.addEventListener("startstreaming",this.load),this.mediaSource.addEventListener("endstreaming",this.pause),this.seekable_=ur(),this.hasPlayed_=!1,this.syncController_=new B6(e),this.segmentMetadataTrack_=h.addRemoteTextTrack({kind:"metadata",label:"segment-metadata"},!1).track,this.segmentMetadataTrack_.mode="hidden",this.decrypter_=new H6,this.sourceUpdater_=new SL(this.mediaSource),this.inbandTextTracks_={},this.timelineChangeController_=new U6,this.keyStatusMap_=new Map;const Be={vhs:this.vhs_,parse708captions:e.parse708captions,useDtsForTimestampOffset:e.useDtsForTimestampOffset,captionServices:Ie,mediaSource:this.mediaSource,currentTime:this.tech_.currentTime.bind(this.tech_),seekable:()=>this.seekable(),seeking:()=>this.tech_.seeking(),duration:()=>this.duration(),hasPlayed:()=>this.hasPlayed_,goalBufferLength:()=>this.goalBufferLength(),bandwidth:p,syncController:this.syncController_,decrypter:this.decrypter_,sourceType:this.sourceType_,inbandTextTracks:this.inbandTextTracks_,cacheEncryptionKeys:se,sourceUpdater:this.sourceUpdater_,timelineChangeController:this.timelineChangeController_,exactManifestTimings:e.exactManifestTimings,addMetadataToTextTrack:this.addMetadataToTextTrack.bind(this)};this.mainPlaylistLoader_=this.sourceType_==="dash"?new z1(s,this.vhs_,As(this.requestOptions_,{addMetadataToTextTrack:this.addMetadataToTextTrack.bind(this)})):new Og(s,this.vhs_,As(this.requestOptions_,{addDateRangesToTextTrack:this.addDateRangesToTextTrack_.bind(this)})),this.setupMainPlaylistLoaderListeners_(),this.mainSegmentLoader_=new Y1(As(Be,{segmentMetadataTrack:this.segmentMetadataTrack_,loaderType:"main"}),e),this.audioSegmentLoader_=new Y1(As(Be,{loaderType:"audio"}),e),this.subtitleSegmentLoader_=new N6(As(Be,{loaderType:"vtt",featuresNativeTextTracks:this.tech_.featuresNativeTextTracks,loadVttJs:()=>new Promise((it,lt)=>{function Et(){h.off("vttjserror",yt),it()}function yt(){h.off("vttjsloaded",Et),lt()}h.one("vttjsloaded",Et),h.one("vttjserror",yt),h.addWebVttScript_()})}),e);const Ke=()=>this.mainSegmentLoader_.bandwidth;this.contentSteeringController_=new Q6(this.vhs_.xhr,Ke),this.setupSegmentLoaderListeners_(),this.bufferBasedABR&&(this.mainPlaylistLoader_.one("loadedplaylist",()=>this.startABRTimer_()),this.tech_.on("pause",()=>this.stopABRTimer_()),this.tech_.on("play",()=>this.startABRTimer_())),tj.forEach(it=>{this[it+"_"]=ij.bind(this,it)}),this.logger_=mo("pc"),this.triggeredFmp4Usage=!1,this.tech_.preload()==="none"?(this.loadOnPlay_=()=>{this.loadOnPlay_=null,this.mainPlaylistLoader_.load()},this.tech_.one("play",this.loadOnPlay_)):this.mainPlaylistLoader_.load(),this.timeToLoadedData__=-1,this.mainAppendsToLoadedData__=-1,this.audioAppendsToLoadedData__=-1;const ze=this.tech_.preload()==="none"?"play":"loadstart";this.tech_.one(ze,()=>{const it=Date.now();this.tech_.one("loadeddata",()=>{this.timeToLoadedData__=Date.now()-it,this.mainAppendsToLoadedData__=this.mainSegmentLoader_.mediaAppends,this.audioAppendsToLoadedData__=this.audioSegmentLoader_.mediaAppends})})}mainAppendsToLoadedData_(){return this.mainAppendsToLoadedData__}audioAppendsToLoadedData_(){return this.audioAppendsToLoadedData__}appendsToLoadedData_(){const e=this.mainAppendsToLoadedData_(),s=this.audioAppendsToLoadedData_();return e===-1||s===-1?-1:e+s}timeToLoadedData_(){return this.timeToLoadedData__}checkABR_(e="abr"){const s=this.selectPlaylist();s&&this.shouldSwitchToMedia_(s)&&this.switchMedia_(s,e)}switchMedia_(e,s,a){const h=this.media(),p=h&&(h.id||h.uri),_=e&&(e.id||e.uri);if(p&&p!==_){this.logger_(`switch media ${p} -> ${_} from ${s}`);const w={renditionInfo:{id:_,bandwidth:e.attributes.BANDWIDTH,resolution:e.attributes.RESOLUTION,codecs:e.attributes.CODECS},cause:s};this.trigger({type:"renditionselected",metadata:w}),this.tech_.trigger({type:"usage",name:`vhs-rendition-change-${s}`})}this.mainPlaylistLoader_.media(e,a)}switchMediaForDASHContentSteering_(){["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(e=>{const s=this.mediaTypes_[e],a=s?s.activeGroup():null,h=this.contentSteeringController_.getPathway();if(a&&h){const _=(a.length?a[0].playlists:a.playlists).filter(w=>w.attributes.serviceLocation===h);_.length&&this.mediaTypes_[e].activePlaylistLoader.media(_[0])}})}startABRTimer_(){this.stopABRTimer_(),this.abrTimer_=window.setInterval(()=>this.checkABR_(),250)}stopABRTimer_(){this.tech_.scrubbing&&this.tech_.scrubbing()||(window.clearInterval(this.abrTimer_),this.abrTimer_=null)}getAudioTrackPlaylists_(){const e=this.main(),s=e&&e.playlists||[];if(!e||!e.mediaGroups||!e.mediaGroups.AUDIO)return s;const a=e.mediaGroups.AUDIO,h=Object.keys(a);let p;if(Object.keys(this.mediaTypes_.AUDIO.groups).length)p=this.mediaTypes_.AUDIO.activeTrack();else{const w=a.main||h.length&&a[h[0]];for(const I in w)if(w[I].default){p={label:I};break}}if(!p)return s;const _=[];for(const w in a)if(a[w][p.label]){const I=a[w][p.label];if(I.playlists&&I.playlists.length)_.push.apply(_,I.playlists);else if(I.uri)_.push(I);else if(e.playlists.length)for(let B=0;B<e.playlists.length;B++){const G=e.playlists[B];G.attributes&&G.attributes.AUDIO&&G.attributes.AUDIO===w&&_.push(G)}}return _.length?_:s}setupMainPlaylistLoaderListeners_(){this.mainPlaylistLoader_.on("loadedmetadata",()=>{const s=this.mainPlaylistLoader_.media(),a=s.targetDuration*1.5*1e3;F1(this.mainPlaylistLoader_.main,this.mainPlaylistLoader_.media())?this.requestOptions_.timeout=0:this.requestOptions_.timeout=a,s.endList&&this.tech_.preload()!=="none"&&(this.mainSegmentLoader_.playlist(s,this.requestOptions_),this.mainSegmentLoader_.load()),Y6({sourceType:this.sourceType_,segmentLoaders:{AUDIO:this.audioSegmentLoader_,SUBTITLES:this.subtitleSegmentLoader_,main:this.mainSegmentLoader_},tech:this.tech_,requestOptions:this.requestOptions_,mainPlaylistLoader:this.mainPlaylistLoader_,vhs:this.vhs_,main:this.main(),mediaTypes:this.mediaTypes_,excludePlaylist:this.excludePlaylist.bind(this)}),this.triggerPresenceUsage_(this.main(),s),this.setupFirstPlay(),!this.mediaTypes_.AUDIO.activePlaylistLoader||this.mediaTypes_.AUDIO.activePlaylistLoader.media()?this.trigger("selectedinitialmedia"):this.mediaTypes_.AUDIO.activePlaylistLoader.one("loadedmetadata",()=>{this.trigger("selectedinitialmedia")})}),this.mainPlaylistLoader_.on("loadedplaylist",()=>{this.loadOnPlay_&&this.tech_.off("play",this.loadOnPlay_);let s=this.mainPlaylistLoader_.media();if(!s){this.attachContentSteeringListeners_(),this.initContentSteeringController_(),this.excludeUnsupportedVariants_();let a;if(this.enableLowInitialPlaylist&&(a=this.selectInitialPlaylist()),a||(a=this.selectPlaylist()),!a||!this.shouldSwitchToMedia_(a)||(this.initialMedia_=a,this.switchMedia_(this.initialMedia_,"initial"),!(this.sourceType_==="vhs-json"&&this.initialMedia_.segments)))return;s=this.initialMedia_}this.handleUpdatedMediaPlaylist(s)}),this.mainPlaylistLoader_.on("error",()=>{const s=this.mainPlaylistLoader_.error;this.excludePlaylist({playlistToExclude:s.playlist,error:s})}),this.mainPlaylistLoader_.on("mediachanging",()=>{this.mainSegmentLoader_.abort(),this.mainSegmentLoader_.pause()}),this.mainPlaylistLoader_.on("mediachange",()=>{const s=this.mainPlaylistLoader_.media(),a=s.targetDuration*1.5*1e3;F1(this.mainPlaylistLoader_.main,this.mainPlaylistLoader_.media())?this.requestOptions_.timeout=0:this.requestOptions_.timeout=a,this.sourceType_==="dash"&&this.mainPlaylistLoader_.isPaused&&this.mainPlaylistLoader_.load(),this.mainSegmentLoader_.pause(),this.mainSegmentLoader_.playlist(s,this.requestOptions_),this.waitingForFastQualityPlaylistReceived_?this.runFastQualitySwitch_():this.mainSegmentLoader_.load(),this.tech_.trigger({type:"mediachange",bubbles:!0})}),this.mainPlaylistLoader_.on("playlistunchanged",()=>{const s=this.mainPlaylistLoader_.media();if(s.lastExcludeReason_==="playlist-unchanged")return;this.stuckAtPlaylistEnd_(s)&&(this.excludePlaylist({error:{message:"Playlist no longer updating.",reason:"playlist-unchanged"}}),this.tech_.trigger("playliststuck"))}),this.mainPlaylistLoader_.on("renditiondisabled",()=>{this.tech_.trigger({type:"usage",name:"vhs-rendition-disabled"})}),this.mainPlaylistLoader_.on("renditionenabled",()=>{this.tech_.trigger({type:"usage",name:"vhs-rendition-enabled"})}),["manifestrequeststart","manifestrequestcomplete","manifestparsestart","manifestparsecomplete","playlistrequeststart","playlistrequestcomplete","playlistparsestart","playlistparsecomplete","renditiondisabled","renditionenabled"].forEach(s=>{this.mainPlaylistLoader_.on(s,a=>{this.player_.trigger(Z({},a))})})}handleUpdatedMediaPlaylist(e){this.useCueTags_&&this.updateAdCues_(e),this.mainSegmentLoader_.pause(),this.mainSegmentLoader_.playlist(e,this.requestOptions_),this.waitingForFastQualityPlaylistReceived_&&this.runFastQualitySwitch_(),this.updateDuration(!e.endList),this.tech_.paused()||(this.mainSegmentLoader_.load(),this.audioSegmentLoader_&&this.audioSegmentLoader_.load())}triggerPresenceUsage_(e,s){const a=e.mediaGroups||{};let h=!0;const p=Object.keys(a.AUDIO);for(const _ in a.AUDIO)for(const w in a.AUDIO[_])a.AUDIO[_][w].uri||(h=!1);h&&this.tech_.trigger({type:"usage",name:"vhs-demuxed"}),Object.keys(a.SUBTITLES).length&&this.tech_.trigger({type:"usage",name:"vhs-webvtt"}),Qh.Playlist.isAes(s)&&this.tech_.trigger({type:"usage",name:"vhs-aes"}),p.length&&Object.keys(a.AUDIO[p[0]]).length>1&&this.tech_.trigger({type:"usage",name:"vhs-alternate-audio"}),this.useCueTags_&&this.tech_.trigger({type:"usage",name:"vhs-playlist-cue-tags"})}shouldSwitchToMedia_(e){const s=this.mainPlaylistLoader_.media()||this.mainPlaylistLoader_.pendingMedia_,a=this.tech_.currentTime(),h=this.bufferLowWaterLine(),p=this.bufferHighWaterLine(),_=this.tech_.buffered();return sj({buffered:_,currentTime:a,currentPlaylist:s,nextPlaylist:e,bufferLowWaterLine:h,bufferHighWaterLine:p,duration:this.duration(),bufferBasedABR:this.bufferBasedABR,log:this.logger_})}setupSegmentLoaderListeners_(){this.mainSegmentLoader_.on("bandwidthupdate",()=>{this.checkABR_("bandwidthupdate"),this.tech_.trigger("bandwidthupdate")}),this.mainSegmentLoader_.on("timeout",()=>{this.bufferBasedABR&&this.mainSegmentLoader_.load()}),this.bufferBasedABR||this.mainSegmentLoader_.on("progress",()=>{this.trigger("progress")}),this.mainSegmentLoader_.on("error",()=>{const a=this.mainSegmentLoader_.error();this.excludePlaylist({playlistToExclude:a.playlist,error:a})}),this.mainSegmentLoader_.on("appenderror",()=>{this.error=this.mainSegmentLoader_.error_,this.trigger("error")}),this.mainSegmentLoader_.on("syncinfoupdate",()=>{this.onSyncInfoUpdate_()}),this.mainSegmentLoader_.on("timestampoffset",()=>{this.tech_.trigger({type:"usage",name:"vhs-timestamp-offset"})}),this.audioSegmentLoader_.on("syncinfoupdate",()=>{this.onSyncInfoUpdate_()}),this.audioSegmentLoader_.on("appenderror",()=>{this.error=this.audioSegmentLoader_.error_,this.trigger("error")}),this.mainSegmentLoader_.on("ended",()=>{this.logger_("main segment loader ended"),this.onEndOfStream()}),this.timelineChangeController_.on("audioTimelineBehind",()=>{const a=this.audioSegmentLoader_.pendingSegment_;if(!a||!a.segment||!a.segment.syncInfo)return;const h=a.segment.syncInfo.end+.01;this.tech_.setCurrentTime(h)}),this.timelineChangeController_.on("fixBadTimelineChange",()=>{this.logger_("Fix bad timeline change. Restarting al segment loaders..."),this.mainSegmentLoader_.pause(),this.mainSegmentLoader_.resetEverything(),this.mediaTypes_.AUDIO.activePlaylistLoader&&(this.audioSegmentLoader_.pause(),this.audioSegmentLoader_.resetEverything()),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&(this.subtitleSegmentLoader_.pause(),this.subtitleSegmentLoader_.resetEverything()),this.load()}),this.mainSegmentLoader_.on("earlyabort",a=>{this.bufferBasedABR||(this.delegateLoaders_("all",["abort"]),this.excludePlaylist({error:{message:"Aborted early because there isn't enough bandwidth to complete the request without rebuffering."},playlistExclusionDuration:ej}))});const e=()=>{if(!this.sourceUpdater_.hasCreatedSourceBuffers())return this.tryToCreateSourceBuffers_();const a=this.getCodecsOrExclude_();a&&this.sourceUpdater_.addOrChangeSourceBuffers(a)};this.mainSegmentLoader_.on("trackinfo",e),this.audioSegmentLoader_.on("trackinfo",e),this.mainSegmentLoader_.on("fmp4",()=>{this.triggeredFmp4Usage||(this.tech_.trigger({type:"usage",name:"vhs-fmp4"}),this.triggeredFmp4Usage=!0)}),this.audioSegmentLoader_.on("fmp4",()=>{this.triggeredFmp4Usage||(this.tech_.trigger({type:"usage",name:"vhs-fmp4"}),this.triggeredFmp4Usage=!0)}),this.audioSegmentLoader_.on("ended",()=>{this.logger_("audioSegmentLoader ended"),this.onEndOfStream()}),["segmentselected","segmentloadstart","segmentloaded","segmentkeyloadstart","segmentkeyloadcomplete","segmentdecryptionstart","segmentdecryptioncomplete","segmenttransmuxingstart","segmenttransmuxingcomplete","segmenttransmuxingtrackinfoavailable","segmenttransmuxingtiminginfoavailable","segmentappendstart","appendsdone","bandwidthupdated","timelinechange","codecschange"].forEach(a=>{this.mainSegmentLoader_.on(a,h=>{this.player_.trigger(Z({},h))}),this.audioSegmentLoader_.on(a,h=>{this.player_.trigger(Z({},h))}),this.subtitleSegmentLoader_.on(a,h=>{this.player_.trigger(Z({},h))})})}mediaSecondsLoaded_(){return Math.max(this.audioSegmentLoader_.mediaSecondsLoaded+this.mainSegmentLoader_.mediaSecondsLoaded)}load(){this.mainSegmentLoader_.load(),this.mediaTypes_.AUDIO.activePlaylistLoader&&this.audioSegmentLoader_.load(),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&this.subtitleSegmentLoader_.load()}pause(){this.mainSegmentLoader_.pause(),this.mediaTypes_.AUDIO.activePlaylistLoader&&this.audioSegmentLoader_.pause(),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&this.subtitleSegmentLoader_.pause()}fastQualityChange_(e=this.selectPlaylist()){if(e&&e===this.mainPlaylistLoader_.media()){this.logger_("skipping fastQualityChange because new media is same as old");return}this.switchMedia_(e,"fast-quality"),this.waitingForFastQualityPlaylistReceived_=!0}runFastQualitySwitch_(){this.waitingForFastQualityPlaylistReceived_=!1,this.mainSegmentLoader_.pause(),this.mainSegmentLoader_.resetEverything(),this.mediaTypes_.AUDIO.activePlaylistLoader&&(this.audioSegmentLoader_.pause(),this.audioSegmentLoader_.resetEverything()),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&(this.subtitleSegmentLoader_.pause(),this.subtitleSegmentLoader_.resetEverything()),this.load()}play(){if(this.setupFirstPlay())return;this.tech_.ended()&&this.tech_.setCurrentTime(0),this.hasPlayed_&&this.load();const e=this.tech_.seekable();if(this.tech_.duration()===1/0&&this.tech_.currentTime()<e.start(0))return this.tech_.setCurrentTime(e.end(e.length-1))}setupFirstPlay(){const e=this.mainPlaylistLoader_.media();if(!e||this.tech_.paused()||this.hasPlayed_)return!1;if(!e.endList||e.start){const s=this.seekable();if(!s.length)return!1;const a=s.end(0);let h=a;if(e.start){const p=e.start.timeOffset;p<0?h=Math.max(a+p,s.start(0)):h=Math.min(a,p)}this.trigger("firstplay"),this.tech_.setCurrentTime(h)}return this.hasPlayed_=!0,this.load(),!0}handleSourceOpen_(){if(this.tryToCreateSourceBuffers_(),this.tech_.autoplay()){const e=this.tech_.play();typeof e<"u"&&typeof e.then=="function"&&e.then(null,s=>{})}this.trigger("sourceopen")}handleSourceEnded_(){if(!this.inbandTextTracks_.metadataTrack_)return;const e=this.inbandTextTracks_.metadataTrack_.cues;if(!e||!e.length)return;const s=this.duration();e[e.length-1].endTime=isNaN(s)||Math.abs(s)===1/0?Number.MAX_VALUE:s}handleDurationChange_(){this.tech_.trigger("durationchange")}onEndOfStream(){let e=this.mainSegmentLoader_.ended_;if(this.mediaTypes_.AUDIO.activePlaylistLoader){const s=this.mainSegmentLoader_.getCurrentMediaInfo_();!s||s.hasVideo?e=e&&this.audioSegmentLoader_.ended_:e=this.audioSegmentLoader_.ended_}e&&(this.stopABRTimer_(),this.sourceUpdater_.endOfStream())}stuckAtPlaylistEnd_(e){if(!this.seekable().length)return!1;const a=this.syncController_.getExpiredTime(e,this.duration());if(a===null)return!1;const h=Qh.Playlist.playlistEnd(e,a),p=this.tech_.currentTime(),_=this.tech_.buffered();if(!_.length)return h-p<=Pl;const w=_.end(_.length-1);return w-p<=Pl&&h-w<=Pl}excludePlaylist({playlistToExclude:e=this.mainPlaylistLoader_.media(),error:s={},playlistExclusionDuration:a}){if(e=e||this.mainPlaylistLoader_.media(),a=a||s.playlistExclusionDuration||this.playlistExclusionDuration,!e){this.error=s,this.mediaSource.readyState!=="open"?this.trigger("error"):this.sourceUpdater_.endOfStream("network");return}e.playlistErrors_++;const h=this.mainPlaylistLoader_.main.playlists,p=h.filter(XT),_=p.length===1&&p[0]===e;if(h.length===1&&a!==1/0)return Ye.log.warn(`Problem encountered with playlist ${e.id}. Trying again since it is the only playlist.`),this.tech_.trigger("retryplaylist"),this.mainPlaylistLoader_.load(_);if(_){if(this.main().contentSteering){const Ie=this.pathwayAttribute_(e),ce=this.contentSteeringController_.steeringManifest.ttl*1e3;this.contentSteeringController_.excludePathway(Ie),this.excludeThenChangePathway_(),setTimeout(()=>{this.contentSteeringController_.addAvailablePathway(Ie)},ce);return}let Ee=!1;h.forEach(Ie=>{if(Ie===e)return;const ce=Ie.excludeUntil;typeof ce<"u"&&ce!==1/0&&(Ee=!0,delete Ie.excludeUntil)}),Ee&&(Ye.log.warn("Removing other playlists from the exclusion list because the last rendition is about to be excluded."),this.tech_.trigger("retryplaylist"))}let w;e.playlistErrors_>this.maxPlaylistRetries?w=1/0:w=Date.now()+a*1e3,e.excludeUntil=w,s.reason&&(e.lastExcludeReason_=s.reason),this.tech_.trigger("excludeplaylist"),this.tech_.trigger({type:"usage",name:"vhs-rendition-excluded"});const I=this.selectPlaylist();if(!I){this.error="Playback cannot continue. No available working or supported playlists.",this.trigger("error");return}const B=s.internal?this.logger_:Ye.log.warn,G=s.message?" "+s.message:"";B(`${s.internal?"Internal problem":"Problem"} encountered with playlist ${e.id}.${G} Switching to playlist ${I.id}.`),I.attributes.AUDIO!==e.attributes.AUDIO&&this.delegateLoaders_("audio",["abort","pause"]),I.attributes.SUBTITLES!==e.attributes.SUBTITLES&&this.delegateLoaders_("subtitle",["abort","pause"]),this.delegateLoaders_("main",["abort","pause"]);const se=I.targetDuration/2*1e3||5*1e3,pe=typeof I.lastRequest=="number"&&Date.now()-I.lastRequest<=se;return this.switchMedia_(I,"exclude",_||pe)}pauseLoading(){this.delegateLoaders_("all",["abort","pause"]),this.stopABRTimer_()}delegateLoaders_(e,s){const a=[],h=e==="all";(h||e==="main")&&a.push(this.mainPlaylistLoader_);const p=[];(h||e==="audio")&&p.push("AUDIO"),(h||e==="subtitle")&&(p.push("CLOSED-CAPTIONS"),p.push("SUBTITLES")),p.forEach(_=>{const w=this.mediaTypes_[_]&&this.mediaTypes_[_].activePlaylistLoader;w&&a.push(w)}),["main","audio","subtitle"].forEach(_=>{const w=this[`${_}SegmentLoader_`];w&&(e===_||e==="all")&&a.push(w)}),a.forEach(_=>s.forEach(w=>{typeof _[w]=="function"&&_[w]()}))}setCurrentTime(e){const s=Ng(this.tech_.buffered(),e);if(!(this.mainPlaylistLoader_&&this.mainPlaylistLoader_.media())||!this.mainPlaylistLoader_.media().segments)return 0;if(s&&s.length)return e;this.mainSegmentLoader_.pause(),this.mainSegmentLoader_.resetEverything(),this.mediaTypes_.AUDIO.activePlaylistLoader&&(this.audioSegmentLoader_.pause(),this.audioSegmentLoader_.resetEverything()),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&(this.subtitleSegmentLoader_.pause(),this.subtitleSegmentLoader_.resetEverything()),this.load()}duration(){if(!this.mainPlaylistLoader_)return 0;const e=this.mainPlaylistLoader_.media();return e?e.endList?this.mediaSource?this.mediaSource.duration:Qh.Playlist.duration(e):1/0:0}seekable(){return this.seekable_}getSeekableRange_(e,s){const a=e.media();if(!a)return null;const h=this.syncController_.getMediaSequenceSync(s);if(h&&h.isReliable){const w=h.start,I=h.end;if(!isFinite(w)||!isFinite(I))return null;const B=Qh.Playlist.liveEdgeDelay(this.mainPlaylistLoader_.main,a),G=Math.max(w,I-B);return ur([[w,G]])}const p=this.syncController_.getExpiredTime(a,this.duration());if(p===null)return null;const _=Qh.Playlist.seekable(a,p,Qh.Playlist.liveEdgeDelay(this.mainPlaylistLoader_.main,a));return _.length?_:null}computeFinalSeekable_(e,s){if(!s)return e;const a=e.start(0),h=e.end(0),p=s.start(0),_=s.end(0);return p>h||a>_?e:ur([[Math.max(a,p),Math.min(h,_)]])}onSyncInfoUpdate_(){if(!this.mainPlaylistLoader_)return;const e=this.getSeekableRange_(this.mainPlaylistLoader_,"main");if(!e)return;let s;if(this.mediaTypes_.AUDIO.activePlaylistLoader&&(s=this.getSeekableRange_(this.mediaTypes_.AUDIO.activePlaylistLoader,"audio"),!s))return;const a=this.seekable_;if(this.seekable_=this.computeFinalSeekable_(e,s),!this.seekable_||a&&a.length&&this.seekable_.length&&a.start(0)===this.seekable_.start(0)&&a.end(0)===this.seekable_.end(0))return;this.logger_(`seekable updated [${TI(this.seekable_)}]`);const h={seekableRanges:this.seekable_};this.trigger({type:"seekablerangeschanged",metadata:h}),this.tech_.trigger("seekablechanged")}updateDuration(e){if(this.updateDuration_&&(this.mediaSource.removeEventListener("sourceopen",this.updateDuration_),this.updateDuration_=null),this.mediaSource.readyState!=="open"){this.updateDuration_=this.updateDuration.bind(this,e),this.mediaSource.addEventListener("sourceopen",this.updateDuration_);return}if(e){const h=this.seekable();if(!h.length)return;(isNaN(this.mediaSource.duration)||this.mediaSource.duration<h.end(h.length-1))&&this.sourceUpdater_.setDuration(h.end(h.length-1));return}const s=this.tech_.buffered();let a=Qh.Playlist.duration(this.mainPlaylistLoader_.media());s.length>0&&(a=Math.max(a,s.end(s.length-1))),this.mediaSource.duration!==a&&this.sourceUpdater_.setDuration(a)}dispose(){this.trigger("dispose"),this.decrypter_.terminate(),this.mainPlaylistLoader_.dispose(),this.mainSegmentLoader_.dispose(),this.contentSteeringController_.dispose(),this.keyStatusMap_.clear(),this.loadOnPlay_&&this.tech_.off("play",this.loadOnPlay_),["AUDIO","SUBTITLES"].forEach(e=>{const s=this.mediaTypes_[e].groups;for(const a in s)s[a].forEach(h=>{h.playlistLoader&&h.playlistLoader.dispose()})}),this.audioSegmentLoader_.dispose(),this.subtitleSegmentLoader_.dispose(),this.sourceUpdater_.dispose(),this.timelineChangeController_.dispose(),this.stopABRTimer_(),this.updateDuration_&&this.mediaSource.removeEventListener("sourceopen",this.updateDuration_),this.mediaSource.removeEventListener("durationchange",this.handleDurationChange_),this.mediaSource.removeEventListener("sourceopen",this.handleSourceOpen_),this.mediaSource.removeEventListener("sourceended",this.handleSourceEnded_),this.off()}main(){return this.mainPlaylistLoader_.main}media(){return this.mainPlaylistLoader_.media()||this.initialMedia_}areMediaTypesKnown_(){const e=!!this.mediaTypes_.AUDIO.activePlaylistLoader,s=!!this.mainSegmentLoader_.getCurrentMediaInfo_(),a=e?!!this.audioSegmentLoader_.getCurrentMediaInfo_():!0;return!(!s||!a)}getCodecsOrExclude_(){const e={main:this.mainSegmentLoader_.getCurrentMediaInfo_()||{},audio:this.audioSegmentLoader_.getCurrentMediaInfo_()||{}},s=this.mainSegmentLoader_.getPendingSegmentPlaylist()||this.media();e.video=e.main;const a=G_(this.main(),s),h={},p=!!this.mediaTypes_.AUDIO.activePlaylistLoader;if(e.main.hasVideo&&(h.video=a.video||e.main.videoCodec||B4),e.main.isMuxed&&(h.video+=`,${a.audio||e.main.audioCodec||_D}`),(e.main.hasAudio&&!e.main.isMuxed||e.audio.hasAudio||p)&&(h.audio=a.audio||e.main.audioCodec||e.audio.audioCodec||_D,e.audio.isFmp4=e.main.hasAudio&&!e.main.isMuxed?e.main.isFmp4:e.audio.isFmp4),!h.audio&&!h.video){this.excludePlaylist({playlistToExclude:s,error:{message:"Could not determine codecs for playlist."},playlistExclusionDuration:1/0});return}const _=(B,G)=>B?P_(G,this.usingManagedMediaSource_):l1(G),w={};let I;if(["video","audio"].forEach(function(B){if(h.hasOwnProperty(B)&&!_(e[B].isFmp4,h[B])){const G=e[B].isFmp4?"browser":"muxer";w[G]=w[G]||[],w[G].push(h[B]),B==="audio"&&(I=G)}}),p&&I&&s.attributes.AUDIO){const B=s.attributes.AUDIO;this.main().playlists.forEach(G=>{(G.attributes&&G.attributes.AUDIO)===B&&G!==s&&(G.excludeUntil=1/0)}),this.logger_(`excluding audio group ${B} as ${I} does not support codec(s): "${h.audio}"`)}if(Object.keys(w).length){const B=Object.keys(w).reduce((G,se)=>(G&&(G+=", "),G+=`${se} does not support codec(s): "${w[se].join(",")}"`,G),"")+".";this.excludePlaylist({playlistToExclude:s,error:{internal:!0,message:B},playlistExclusionDuration:1/0});return}if(this.sourceUpdater_.hasCreatedSourceBuffers()&&!this.sourceUpdater_.canChangeType()){const B=[];if(["video","audio"].forEach(G=>{const se=(xl(this.sourceUpdater_.codecs[G]||"")[0]||{}).type,pe=(xl(h[G]||"")[0]||{}).type;se&&pe&&se.toLowerCase()!==pe.toLowerCase()&&B.push(`"${this.sourceUpdater_.codecs[G]}" -> "${h[G]}"`)}),B.length){this.excludePlaylist({playlistToExclude:s,error:{message:`Codec switching not supported: ${B.join(", ")}.`,internal:!0},playlistExclusionDuration:1/0});return}}return h}tryToCreateSourceBuffers_(){if(this.mediaSource.readyState!=="open"||this.sourceUpdater_.hasCreatedSourceBuffers()||!this.areMediaTypesKnown_())return;const e=this.getCodecsOrExclude_();if(!e)return;this.sourceUpdater_.createSourceBuffers(e);const s=[e.video,e.audio].filter(Boolean).join(",");this.excludeIncompatibleVariants_(s)}excludeUnsupportedVariants_(){const e=this.main().playlists,s=[];Object.keys(e).forEach(a=>{const h=e[a];if(s.indexOf(h.id)!==-1)return;s.push(h.id);const p=G_(this.main,h),_=[];p.audio&&!l1(p.audio)&&!P_(p.audio,this.usingManagedMediaSource_)&&_.push(`audio codec ${p.audio}`),p.video&&!l1(p.video)&&!P_(p.video,this.usingManagedMediaSource_)&&_.push(`video codec ${p.video}`),p.text&&p.text==="stpp.ttml.im1t"&&_.push(`text codec ${p.text}`),_.length&&(h.excludeUntil=1/0,this.logger_(`excluding ${h.id} for unsupported: ${_.join(", ")}`))})}excludeIncompatibleVariants_(e){const s=[],a=this.main().playlists,h=q_(xl(e)),p=jI(h),_=h.video&&xl(h.video)[0]||null,w=h.audio&&xl(h.audio)[0]||null;Object.keys(a).forEach(I=>{const B=a[I];if(s.indexOf(B.id)!==-1||B.excludeUntil===1/0)return;s.push(B.id);const G=[],se=G_(this.mainPlaylistLoader_.main,B),pe=jI(se);if(!(!se.audio&&!se.video)){if(pe!==p&&G.push(`codec count "${pe}" !== "${p}"`),!this.sourceUpdater_.canChangeType()){const Ee=se.video&&xl(se.video)[0]||null,Ie=se.audio&&xl(se.audio)[0]||null;Ee&&_&&Ee.type.toLowerCase()!==_.type.toLowerCase()&&G.push(`video codec "${Ee.type}" !== "${_.type}"`),Ie&&w&&Ie.type.toLowerCase()!==w.type.toLowerCase()&&G.push(`audio codec "${Ie.type}" !== "${w.type}"`)}G.length&&(B.excludeUntil=1/0,this.logger_(`excluding ${B.id}: ${G.join(" && ")}`))}})}updateAdCues_(e){let s=0;const a=this.seekable();a.length&&(s=a.start(0)),M6(e,this.cueTagsTrack_,s)}goalBufferLength(){const e=this.tech_.currentTime(),s=hr.GOAL_BUFFER_LENGTH,a=hr.GOAL_BUFFER_LENGTH_RATE,h=Math.max(s,hr.MAX_GOAL_BUFFER_LENGTH);return Math.min(s+e*a,h)}bufferLowWaterLine(){const e=this.tech_.currentTime(),s=hr.BUFFER_LOW_WATER_LINE,a=hr.BUFFER_LOW_WATER_LINE_RATE,h=Math.max(s,hr.MAX_BUFFER_LOW_WATER_LINE),p=Math.max(s,hr.EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE);return Math.min(s+e*a,this.bufferBasedABR?p:h)}bufferHighWaterLine(){return hr.BUFFER_HIGH_WATER_LINE}addDateRangesToTextTrack_(e){_L(this.inbandTextTracks_,"com.apple.streaming",this.tech_),p6({inbandTextTracks:this.inbandTextTracks_,dateRanges:e})}addMetadataToTextTrack(e,s,a){const h=this.sourceUpdater_.videoBuffer?this.sourceUpdater_.videoTimestampOffset():this.sourceUpdater_.audioTimestampOffset();_L(this.inbandTextTracks_,e,this.tech_),c6({inbandTextTracks:this.inbandTextTracks_,metadataArray:s,timestampOffset:h,videoDuration:a})}pathwayAttribute_(e){return e.attributes["PATHWAY-ID"]||e.attributes.serviceLocation}initContentSteeringController_(){const e=this.main();if(e.contentSteering){for(const s of e.playlists)this.contentSteeringController_.addAvailablePathway(this.pathwayAttribute_(s));if(this.contentSteeringController_.assignTagProperties(e.uri,e.contentSteering),this.contentSteeringController_.queryBeforeStart){this.contentSteeringController_.requestSteeringManifest(!0);return}this.tech_.one("canplay",()=>{this.contentSteeringController_.requestSteeringManifest()})}}resetContentSteeringController_(){this.contentSteeringController_.clearAvailablePathways(),this.contentSteeringController_.dispose(),this.initContentSteeringController_()}attachContentSteeringListeners_(){this.contentSteeringController_.on("content-steering",this.excludeThenChangePathway_.bind(this)),["contentsteeringloadstart","contentsteeringloadcomplete","contentsteeringparsed"].forEach(s=>{this.contentSteeringController_.on(s,a=>{this.trigger(Z({},a))})}),this.sourceType_==="dash"&&this.mainPlaylistLoader_.on("loadedplaylist",()=>{const s=this.main();(this.contentSteeringController_.didDASHTagChange(s.uri,s.contentSteering)||(()=>{const p=this.contentSteeringController_.getAvailablePathways(),_=[];for(const w of s.playlists){const I=w.attributes.serviceLocation;if(I&&(_.push(I),!p.has(I)))return!0}return!!(!_.length&&p.size)})())&&this.resetContentSteeringController_()})}excludeThenChangePathway_(){const e=this.contentSteeringController_.getPathway();if(!e)return;this.handlePathwayClones_();const a=this.main().playlists,h=new Set;let p=!1;Object.keys(a).forEach(_=>{const w=a[_],I=this.pathwayAttribute_(w),B=I&&e!==I;w.excludeUntil===1/0&&w.lastExcludeReason_==="content-steering"&&!B&&(delete w.excludeUntil,delete w.lastExcludeReason_,p=!0);const se=!w.excludeUntil&&w.excludeUntil!==1/0;!h.has(w.id)&&B&&se&&(h.add(w.id),w.excludeUntil=1/0,w.lastExcludeReason_="content-steering",this.logger_(`excluding ${w.id} for ${w.lastExcludeReason_}`))}),this.contentSteeringController_.manifestType_==="DASH"&&Object.keys(this.mediaTypes_).forEach(_=>{const w=this.mediaTypes_[_];if(w.activePlaylistLoader){const I=w.activePlaylistLoader.media_;I&&I.attributes.serviceLocation!==e&&(p=!0)}}),p&&this.changeSegmentPathway_()}handlePathwayClones_(){const s=this.main().playlists,a=this.contentSteeringController_.currentPathwayClones,h=this.contentSteeringController_.nextPathwayClones;if(a&&a.size||h&&h.size){for(const[_,w]of a.entries())h.get(_)||(this.mainPlaylistLoader_.updateOrDeleteClone(w),this.contentSteeringController_.excludePathway(_));for(const[_,w]of h.entries()){const I=a.get(_);if(!I){s.filter(G=>G.attributes["PATHWAY-ID"]===w["BASE-ID"]).forEach(G=>{this.mainPlaylistLoader_.addClonePathway(w,G)}),this.contentSteeringController_.addAvailablePathway(_);continue}this.equalPathwayClones_(I,w)||(this.mainPlaylistLoader_.updateOrDeleteClone(w,!0),this.contentSteeringController_.addAvailablePathway(_))}this.contentSteeringController_.currentPathwayClones=new Map(JSON.parse(JSON.stringify([...h])))}}equalPathwayClones_(e,s){if(e["BASE-ID"]!==s["BASE-ID"]||e.ID!==s.ID||e["URI-REPLACEMENT"].HOST!==s["URI-REPLACEMENT"].HOST)return!1;const a=e["URI-REPLACEMENT"].PARAMS,h=s["URI-REPLACEMENT"].PARAMS;for(const p in a)if(a[p]!==h[p])return!1;for(const p in h)if(a[p]!==h[p])return!1;return!0}changeSegmentPathway_(){const e=this.selectPlaylist();this.pauseLoading(),this.contentSteeringController_.manifestType_==="DASH"&&this.switchMediaForDASHContentSteering_(),this.switchMedia_(e,"content-steering")}excludeNonUsablePlaylistsByKeyId_(){if(!this.mainPlaylistLoader_||!this.mainPlaylistLoader_.main)return;let e=0;const s="non-usable";this.mainPlaylistLoader_.main.playlists.forEach(a=>{const h=this.mainPlaylistLoader_.getKeyIdSet(a);!h||!h.size||h.forEach(p=>{const _="usable",w=this.keyStatusMap_.has(p)&&this.keyStatusMap_.get(p)===_,I=a.lastExcludeReason_===s&&a.excludeUntil===1/0;w?w&&I&&(delete a.excludeUntil,delete a.lastExcludeReason_,this.logger_(`enabling playlist ${a.id} because key ID ${p} is ${_}`)):(a.excludeUntil!==1/0&&a.lastExcludeReason_!==s&&(a.excludeUntil=1/0,a.lastExcludeReason_=s,this.logger_(`excluding playlist ${a.id} because the key ID ${p} doesn't exist in the keyStatusMap or is not ${_}`)),e++)})}),e>=this.mainPlaylistLoader_.main.playlists.length&&this.mainPlaylistLoader_.main.playlists.forEach(a=>{const h=a&&a.attributes&&a.attributes.RESOLUTION&&a.attributes.RESOLUTION.height<720,p=a.excludeUntil===1/0&&a.lastExcludeReason_===s;h&&p&&(delete a.excludeUntil,Ye.log.warn(`enabling non-HD playlist ${a.id} because all playlists were excluded due to ${s} key IDs`))})}addKeyStatus_(e,s){const p=(typeof e=="string"?e:I6(e)).slice(0,32).toLowerCase();this.logger_(`KeyStatus '${s}' with key ID ${p} added to the keyStatusMap`),this.keyStatusMap_.set(p,s)}updatePlaylistByKeyStatus(e,s){this.addKeyStatus_(e,s),this.waitingForFastQualityPlaylistReceived_||this.excludeNonUsableThenChangePlaylist_(),this.mainPlaylistLoader_.off("loadedplaylist",this.excludeNonUsableThenChangePlaylist_.bind(this)),this.mainPlaylistLoader_.on("loadedplaylist",this.excludeNonUsableThenChangePlaylist_.bind(this))}excludeNonUsableThenChangePlaylist_(){this.excludeNonUsablePlaylistsByKeyId_(),this.fastQualityChange_()}}const rj=(r,e,s)=>a=>{const h=r.main.playlists[e],p=O1(h),_=XT(h);if(typeof a>"u")return _;a?delete h.disabled:h.disabled=!0;const w={renditionInfo:{id:e,bandwidth:h.attributes.BANDWIDTH,resolution:h.attributes.RESOLUTION,codecs:h.attributes.CODECS},cause:"fast-quality"};return a!==_&&!p&&(a?(s(h),r.trigger({type:"renditionenabled",metadata:w})):r.trigger({type:"renditiondisabled",metadata:w})),a};class aj{constructor(e,s,a){const{playlistController_:h}=e,p=h.fastQualityChange_.bind(h);if(s.attributes){const _=s.attributes.RESOLUTION;this.width=_&&_.width,this.height=_&&_.height,this.bandwidth=s.attributes.BANDWIDTH,this.frameRate=s.attributes["FRAME-RATE"]}this.codecs=G_(h.main(),s),this.playlist=s,this.id=a,this.enabled=rj(e.playlists,s.id,p)}}const oj=function(r){r.representations=()=>{const e=r.playlistController_.main(),s=W_(e)?r.playlistController_.getAudioTrackPlaylists_():e.playlists;return s?s.filter(a=>!O1(a)).map((a,h)=>new aj(r,a,a.id)):[]}},RL=["seeking","seeked","pause","playing","error"];class lj extends Ye.EventTarget{constructor(e){super(),this.playlistController_=e.playlistController,this.tech_=e.tech,this.seekable=e.seekable,this.allowSeeksWithinUnsafeLiveWindow=e.allowSeeksWithinUnsafeLiveWindow,this.liveRangeSafeTimeDelta=e.liveRangeSafeTimeDelta,this.media=e.media,this.playedRanges_=[],this.consecutiveUpdates=0,this.lastRecordedTime=null,this.checkCurrentTimeTimeout_=null,this.logger_=mo("PlaybackWatcher"),this.logger_("initialize");const s=()=>this.monitorCurrentTime_(),a=()=>this.monitorCurrentTime_(),h=()=>this.techWaiting_(),p=()=>this.resetTimeUpdate_(),_=this.playlistController_,w=["main","subtitle","audio"],I={};w.forEach(G=>{I[G]={reset:()=>this.resetSegmentDownloads_(G),updateend:()=>this.checkSegmentDownloads_(G)},_[`${G}SegmentLoader_`].on("appendsdone",I[G].updateend),_[`${G}SegmentLoader_`].on("playlistupdate",I[G].reset),this.tech_.on(["seeked","seeking"],I[G].reset)});const B=G=>{["main","audio"].forEach(se=>{_[`${se}SegmentLoader_`][G]("appended",this.seekingAppendCheck_)})};this.seekingAppendCheck_=()=>{this.fixesBadSeeks_()&&(this.consecutiveUpdates=0,this.lastRecordedTime=this.tech_.currentTime(),B("off"))},this.clearSeekingAppendCheck_=()=>B("off"),this.watchForBadSeeking_=()=>{this.clearSeekingAppendCheck_(),B("on")},this.tech_.on("seeked",this.clearSeekingAppendCheck_),this.tech_.on("seeking",this.watchForBadSeeking_),this.tech_.on("waiting",h),this.tech_.on(RL,p),this.tech_.on("canplay",a),this.tech_.one("play",s),this.dispose=()=>{this.clearSeekingAppendCheck_(),this.logger_("dispose"),this.tech_.off("waiting",h),this.tech_.off(RL,p),this.tech_.off("canplay",a),this.tech_.off("play",s),this.tech_.off("seeking",this.watchForBadSeeking_),this.tech_.off("seeked",this.clearSeekingAppendCheck_),w.forEach(G=>{_[`${G}SegmentLoader_`].off("appendsdone",I[G].updateend),_[`${G}SegmentLoader_`].off("playlistupdate",I[G].reset),this.tech_.off(["seeked","seeking"],I[G].reset)}),this.checkCurrentTimeTimeout_&&window.clearTimeout(this.checkCurrentTimeTimeout_),this.resetTimeUpdate_()}}monitorCurrentTime_(){this.checkCurrentTime_(),this.checkCurrentTimeTimeout_&&window.clearTimeout(this.checkCurrentTimeTimeout_),this.checkCurrentTimeTimeout_=window.setTimeout(this.monitorCurrentTime_.bind(this),250)}resetSegmentDownloads_(e){const s=this.playlistController_[`${e}SegmentLoader_`];this[`${e}StalledDownloads_`]>0&&this.logger_(`resetting possible stalled download count for ${e} loader`),this[`${e}StalledDownloads_`]=0,this[`${e}Buffered_`]=s.buffered_()}checkSegmentDownloads_(e){const s=this.playlistController_,a=s[`${e}SegmentLoader_`],h=a.buffered_(),p=YU(this[`${e}Buffered_`],h);if(this[`${e}Buffered_`]=h,p){const _={bufferedRanges:h};s.trigger({type:"bufferedrangeschanged",metadata:_}),this.resetSegmentDownloads_(e);return}this[`${e}StalledDownloads_`]++,this.logger_(`found #${this[`${e}StalledDownloads_`]} ${e} appends that did not increase buffer (possible stalled download)`,{playlistId:a.playlist_&&a.playlist_.id,buffered:zd(h)}),!(this[`${e}StalledDownloads_`]<10)&&(this.logger_(`${e} loader stalled download exclusion`),this.resetSegmentDownloads_(e),this.tech_.trigger({type:"usage",name:`vhs-${e}-download-exclusion`}),e!=="subtitle"&&s.excludePlaylist({error:{message:`Excessive ${e} segment downloading detected.`},playlistExclusionDuration:1/0}))}checkCurrentTime_(){if(this.tech_.paused()||this.tech_.seeking())return;const e=this.tech_.currentTime(),s=this.tech_.buffered();if(this.lastRecordedTime===e&&(!s.length||e+Pl>=s.end(s.length-1)))return this.techWaiting_();if(this.consecutiveUpdates>=5&&e===this.lastRecordedTime)this.consecutiveUpdates++,this.waiting_();else if(e===this.lastRecordedTime)this.consecutiveUpdates++;else{this.playedRanges_.push(ur([this.lastRecordedTime,e]));const a={playedRanges:this.playedRanges_};this.playlistController_.trigger({type:"playedrangeschanged",metadata:a}),this.consecutiveUpdates=0,this.lastRecordedTime=e}}resetTimeUpdate_(){this.consecutiveUpdates=0}fixesBadSeeks_(){if(!this.tech_.seeking())return!1;const s=this.seekable(),a=this.tech_.currentTime(),h=this.afterSeekableWindow_(s,a,this.media(),this.allowSeeksWithinUnsafeLiveWindow);let p;if(h&&(p=s.end(s.length-1)),this.beforeSeekableWindow_(s,a)){const Ie=s.start(0);p=Ie+(Ie===s.end(0)?0:Pl)}if(typeof p<"u")return this.logger_(`Trying to seek outside of seekable at time ${a} with seekable range ${TI(s)}. Seeking to ${p}.`),this.tech_.setCurrentTime(p),!0;const _=this.playlistController_.sourceUpdater_,w=this.tech_.buffered(),I=_.audioBuffer?_.audioBuffered():null,B=_.videoBuffer?_.videoBuffered():null,G=this.media(),se=G.partTargetDuration?G.partTargetDuration:(G.targetDuration-kl)*2,pe=[I,B];for(let Ie=0;Ie<pe.length;Ie++){if(!pe[Ie])continue;if(N1(pe[Ie],a)<se)return!1}const Ee=GT(w,a);return Ee.length===0?!1:(p=Ee.start(0)+Pl,this.logger_(`Buffered region starts (${Ee.start(0)})  just beyond seek point (${a}). Seeking to ${p}.`),this.tech_.setCurrentTime(p),!0)}waiting_(){if(this.techWaiting_())return;const e=this.tech_.currentTime(),s=this.tech_.buffered(),a=Ng(s,e);if(a.length&&e+3<=a.end(0)){this.resetTimeUpdate_(),this.tech_.setCurrentTime(e),this.logger_(`Stopped at ${e} while inside a buffered region [${a.start(0)} -> ${a.end(0)}]. Attempting to resume playback by seeking to the current time.`),this.tech_.trigger({type:"usage",name:"vhs-unknown-waiting"});return}}techWaiting_(){const e=this.seekable(),s=this.tech_.currentTime();if(this.tech_.seeking())return!0;if(this.beforeSeekableWindow_(e,s)){const w=e.end(e.length-1);return this.logger_(`Fell out of live window at time ${s}. Seeking to live point (seekable end) ${w}`),this.resetTimeUpdate_(),this.tech_.setCurrentTime(w),this.tech_.trigger({type:"usage",name:"vhs-live-resync"}),!0}const a=this.tech_.vhs.playlistController_.sourceUpdater_,h=this.tech_.buffered();if(this.videoUnderflow_({audioBuffered:a.audioBuffered(),videoBuffered:a.videoBuffered(),currentTime:s}))return this.resetTimeUpdate_(),this.tech_.setCurrentTime(s),this.tech_.trigger({type:"usage",name:"vhs-video-underflow"}),!0;const _=GT(h,s);return _.length>0?(this.logger_(`Stopped at ${s} and seeking to ${_.start(0)}`),this.resetTimeUpdate_(),this.skipTheGap_(s),!0):!1}afterSeekableWindow_(e,s,a,h=!1){if(!e.length)return!1;let p=e.end(e.length-1)+Pl;const _=!a.endList,w=typeof a.partTargetDuration=="number";return _&&(w||h)&&(p=e.end(e.length-1)+a.targetDuration*3),s>p}beforeSeekableWindow_(e,s){return!!(e.length&&e.start(0)>0&&s<e.start(0)-this.liveRangeSafeTimeDelta)}videoUnderflow_({videoBuffered:e,audioBuffered:s,currentTime:a}){if(!e)return;let h;if(e.length&&s.length){const p=Ng(e,a-3),_=Ng(e,a),w=Ng(s,a);w.length&&!_.length&&p.length&&(h={start:p.end(0),end:w.end(0)})}else GT(e,a).length||(h=this.gapFromVideoUnderflow_(e,a));return h?(this.logger_(`Encountered a gap in video from ${h.start} to ${h.end}. Seeking to current time ${a}`),!0):!1}skipTheGap_(e){const s=this.tech_.buffered(),a=this.tech_.currentTime(),h=GT(s,a);if(this.resetTimeUpdate_(),h.length===0||a!==e)return;this.logger_("skipTheGap_:","currentTime:",a,"scheduled currentTime:",e,"nextRange start:",h.start(0)),this.tech_.setCurrentTime(h.start(0)+kl);const p={gapInfo:{from:a,to:h.start(0)}};this.playlistController_.trigger({type:"gapjumped",metadata:p}),this.tech_.trigger({type:"usage",name:"vhs-gap-skip"})}gapFromVideoUnderflow_(e,s){const a=GU(e);for(let h=0;h<a.length;h++){const p=a.start(h),_=a.end(h);if(s-p<4&&s-p>2)return{start:p,end:_}}return null}}const uj={errorInterval:30,getSource(r){const s=this.tech({IWillNotUseThisInPlugins:!0}).currentSource_||this.currentSource();return r(s)}},ML=function(r,e){let s=0,a=0;const h=As(uj,e);r.ready(()=>{r.trigger({type:"usage",name:"vhs-error-reload-initialized"})});const p=function(){a&&r.currentTime(a)},_=function(G){G!=null&&(a=r.duration()!==1/0&&r.currentTime()||0,r.one("loadedmetadata",p),r.src(G),r.trigger({type:"usage",name:"vhs-error-reload"}),r.play())},w=function(){if(Date.now()-s<h.errorInterval*1e3){r.trigger({type:"usage",name:"vhs-error-reload-canceled"});return}if(!h.getSource||typeof h.getSource!="function"){Ye.log.error("ERROR: reloadSourceOnError - The option getSource must be a function!");return}return s=Date.now(),h.getSource.call(r,_)},I=function(){r.off("loadedmetadata",p),r.off("error",w),r.off("dispose",I)},B=function(G){I(),ML(r,G)};r.on("error",w),r.on("dispose",I),r.reloadSourceOnError=B},hj=function(r){ML(this,r)};var OL="3.17.0",cj="7.1.0",dj="1.3.1",fj="7.2.0",pj="4.0.2";const gn={PlaylistLoader:Og,Playlist:_a,utils:v5,STANDARD_PLAYLIST_SELECTOR:gL,INITIAL_PLAYLIST_SELECTOR:a6,lastBandwidthSelector:gL,movingAverageBandwidthSelector:n6,comparePlaylistBandwidth:X1,comparePlaylistResolution:s6,xhr:WI()};Object.keys(hr).forEach(r=>{Object.defineProperty(gn,r,{get(){return Ye.log.warn(`using Vhs.${r} is UNSAFE be sure you know what you are doing`),hr[r]},set(e){if(Ye.log.warn(`using Vhs.${r} is UNSAFE be sure you know what you are doing`),typeof e!="number"||e<0){Ye.log.warn(`value of Vhs.${r} must be greater than or equal to 0`);return}hr[r]=e}})});const FL="videojs-vhs",BL=function(r,e){const s=e.media();let a=-1;for(let h=0;h<r.length;h++)if(r[h].id===s.id){a=h;break}r.selectedIndex_=a,r.trigger({selectedIndex:a,type:"change"})},gj=function(r,e){e.representations().forEach(s=>{r.addQualityLevel(s)}),BL(r,e.playlists)};gn.canPlaySource=function(){return Ye.log.warn("VHS is no longer a tech. Please remove it from your player's techOrder.")};const mj=(r,e,s)=>{if(!r)return r;let a={};e&&e.attributes&&e.attributes.CODECS&&(a=q_(xl(e.attributes.CODECS))),s&&s.attributes&&s.attributes.CODECS&&(a.audio=s.attributes.CODECS);const h=yg(a.video),p=yg(a.audio),_={};for(const w in r)_[w]={},p&&(_[w].audioContentType=p),h&&(_[w].videoContentType=h),e.contentProtection&&e.contentProtection[w]&&e.contentProtection[w].pssh&&(_[w].pssh=e.contentProtection[w].pssh),typeof r[w]=="string"&&(_[w].url=r[w]);return As(r,_)},_j=(r,e)=>r.reduce((s,a)=>{if(!a.contentProtection)return s;const h=e.reduce((p,_)=>{const w=a.contentProtection[_];return w&&w.pssh&&(p[_]={pssh:w.pssh}),p},{});return Object.keys(h).length&&s.push(h),s},[]),bj=({player:r,sourceKeySystems:e,audioMedia:s,mainPlaylists:a})=>{if(!r.eme.initializeMediaKeys)return Promise.resolve();const h=s?a.concat([s]):a,p=_j(h,Object.keys(e)),_=[],w=[];return p.forEach(I=>{w.push(new Promise((B,G)=>{r.tech_.one("keysessioncreated",B)})),_.push(new Promise((B,G)=>{r.eme.initializeMediaKeys({keySystems:I},se=>{if(se){G(se);return}B()})}))}),Promise.race([Promise.all(_),Promise.race(w)])},yj=({player:r,sourceKeySystems:e,media:s,audioMedia:a})=>{const h=mj(e,s,a);return h?(r.currentSource().keySystems=h,h&&!r.eme?(Ye.log.warn("DRM encrypted source cannot be decrypted without a DRM plugin"),!1):!0):!1},UL=()=>{if(!window.localStorage)return null;const r=window.localStorage.getItem(FL);if(!r)return null;try{return JSON.parse(r)}catch{return null}},vj=r=>{if(!window.localStorage)return!1;let e=UL();e=e?As(e,r):r;try{window.localStorage.setItem(FL,JSON.stringify(e))}catch{return!1}return e},wj=r=>r.toLowerCase().indexOf("data:application/vnd.videojs.vhs+json,")===0?JSON.parse(r.substring(r.indexOf(",")+1)):r,jL=(r,e)=>{r._requestCallbackSet||(r._requestCallbackSet=new Set),r._requestCallbackSet.add(e)},HL=(r,e)=>{r._responseCallbackSet||(r._responseCallbackSet=new Set),r._responseCallbackSet.add(e)},VL=(r,e)=>{r._requestCallbackSet&&(r._requestCallbackSet.delete(e),r._requestCallbackSet.size||delete r._requestCallbackSet)},$L=(r,e)=>{r._responseCallbackSet&&(r._responseCallbackSet.delete(e),r._responseCallbackSet.size||delete r._responseCallbackSet)};gn.supportsNativeHls=function(){if(!document||!document.createElement)return!1;const r=document.createElement("video");return Ye.getTech("Html5").isSupported()?["application/vnd.apple.mpegurl","audio/mpegurl","audio/x-mpegurl","application/x-mpegurl","video/x-mpegurl","video/mpegurl","application/mpegurl"].some(function(s){return/maybe|probably/i.test(r.canPlayType(s))}):!1}(),gn.supportsNativeDash=function(){return!document||!document.createElement||!Ye.getTech("Html5").isSupported()?!1:/maybe|probably/i.test(document.createElement("video").canPlayType("application/dash+xml"))}(),gn.supportsTypeNatively=r=>r==="hls"?gn.supportsNativeHls:r==="dash"?gn.supportsNativeDash:!1,gn.isSupported=function(){return Ye.log.warn("VHS is no longer a tech. Please remove it from your player's techOrder.")},gn.xhr.onRequest=function(r){jL(gn.xhr,r)},gn.xhr.onResponse=function(r){HL(gn.xhr,r)},gn.xhr.offRequest=function(r){VL(gn.xhr,r)},gn.xhr.offResponse=function(r){$L(gn.xhr,r)};const Tj=Ye.getComponent("Component");class zL extends Tj{constructor(e,s,a){if(super(s,a.vhs),typeof a.initialBandwidth=="number"&&(this.options_.bandwidth=a.initialBandwidth),this.logger_=mo("VhsHandler"),s.options_&&s.options_.playerId){const h=Ye.getPlayer(s.options_.playerId);this.player_=h}if(this.tech_=s,this.source_=e,this.stats={},this.ignoreNextSeekingEvent_=!1,this.setOptions_(),this.options_.overrideNative&&s.overrideNativeAudioTracks&&s.overrideNativeVideoTracks)s.overrideNativeAudioTracks(!0),s.overrideNativeVideoTracks(!0);else if(this.options_.overrideNative&&(s.featuresNativeVideoTracks||s.featuresNativeAudioTracks))throw new Error("Overriding native VHS requires emulated tracks. See https://git.io/vMpjB");this.on(document,["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],h=>{const p=document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement;p&&p.contains(this.tech_.el())?this.playlistController_.fastQualityChange_():this.playlistController_.checkABR_()}),this.on(this.tech_,"seeking",function(){if(this.ignoreNextSeekingEvent_){this.ignoreNextSeekingEvent_=!1;return}this.setCurrentTime(this.tech_.currentTime())}),this.on(this.tech_,"error",function(){this.tech_.error()&&this.playlistController_&&this.playlistController_.pauseLoading()}),this.on(this.tech_,"play",this.play)}setOptions_(e={}){if(this.options_=As(this.options_,e),this.options_.withCredentials=this.options_.withCredentials||!1,this.options_.limitRenditionByPlayerDimensions=this.options_.limitRenditionByPlayerDimensions!==!1,this.options_.useDevicePixelRatio=this.options_.useDevicePixelRatio||!1,this.options_.usePlayerObjectFit=this.options_.usePlayerObjectFit||!1,this.options_.useBandwidthFromLocalStorage=typeof this.source_.useBandwidthFromLocalStorage<"u"?this.source_.useBandwidthFromLocalStorage:this.options_.useBandwidthFromLocalStorage||!1,this.options_.useForcedSubtitles=this.options_.useForcedSubtitles||!1,this.options_.useNetworkInformationApi=typeof this.options_.useNetworkInformationApi<"u"?this.options_.useNetworkInformationApi:!0,this.options_.useDtsForTimestampOffset=this.options_.useDtsForTimestampOffset||!1,this.options_.customTagParsers=this.options_.customTagParsers||[],this.options_.customTagMappers=this.options_.customTagMappers||[],this.options_.cacheEncryptionKeys=this.options_.cacheEncryptionKeys||!1,this.options_.llhls=this.options_.llhls!==!1,this.options_.bufferBasedABR=this.options_.bufferBasedABR||!1,typeof this.options_.playlistExclusionDuration!="number"&&(this.options_.playlistExclusionDuration=60),typeof this.options_.bandwidth!="number"&&this.options_.useBandwidthFromLocalStorage){const a=UL();a&&a.bandwidth&&(this.options_.bandwidth=a.bandwidth,this.tech_.trigger({type:"usage",name:"vhs-bandwidth-from-local-storage"})),a&&a.throughput&&(this.options_.throughput=a.throughput,this.tech_.trigger({type:"usage",name:"vhs-throughput-from-local-storage"}))}typeof this.options_.bandwidth!="number"&&(this.options_.bandwidth=hr.INITIAL_BANDWIDTH),this.options_.enableLowInitialPlaylist=this.options_.enableLowInitialPlaylist&&this.options_.bandwidth===hr.INITIAL_BANDWIDTH,["withCredentials","useDevicePixelRatio","usePlayerObjectFit","customPixelRatio","limitRenditionByPlayerDimensions","bandwidth","customTagParsers","customTagMappers","cacheEncryptionKeys","playlistSelector","initialPlaylistSelector","bufferBasedABR","liveRangeSafeTimeDelta","llhls","useForcedSubtitles","useNetworkInformationApi","useDtsForTimestampOffset","exactManifestTimings","leastPixelDiffSelector"].forEach(a=>{typeof this.source_[a]<"u"&&(this.options_[a]=this.source_[a])}),this.limitRenditionByPlayerDimensions=this.options_.limitRenditionByPlayerDimensions,this.useDevicePixelRatio=this.options_.useDevicePixelRatio,this.usePlayerObjectFit=this.options_.usePlayerObjectFit;const s=this.options_.customPixelRatio;typeof s=="number"&&s>=0&&(this.customPixelRatio=s)}setOptions(e={}){this.setOptions_(e)}src(e,s){if(!e)return;this.setOptions_(),this.options_.src=wj(this.source_.src),this.options_.tech=this.tech_,this.options_.externVhs=gn,this.options_.sourceType=bD(s),this.options_.seekTo=p=>{this.tech_.setCurrentTime(p)},this.options_.player_=this.player_,this.playlistController_=new nj(this.options_);const a=As({liveRangeSafeTimeDelta:Pl},this.options_,{seekable:()=>this.seekable(),media:()=>this.playlistController_.media(),playlistController:this.playlistController_});this.playbackWatcher_=new lj(a),this.attachStreamingEventListeners_(),this.playlistController_.on("error",()=>{const p=Ye.players[this.tech_.options_.playerId];let _=this.playlistController_.error;typeof _=="object"&&!_.code?_.code=3:typeof _=="string"&&(_={message:_,code:3}),p.error(_)});const h=this.options_.bufferBasedABR?gn.movingAverageBandwidthSelector(.55):gn.STANDARD_PLAYLIST_SELECTOR;this.playlistController_.selectPlaylist=this.selectPlaylist?this.selectPlaylist.bind(this):h.bind(this),this.playlistController_.selectInitialPlaylist=gn.INITIAL_PLAYLIST_SELECTOR.bind(this),this.playlists=this.playlistController_.mainPlaylistLoader_,this.mediaSource=this.playlistController_.mediaSource,Object.defineProperties(this,{selectPlaylist:{get(){return this.playlistController_.selectPlaylist},set(p){this.playlistController_.selectPlaylist=p.bind(this)}},throughput:{get(){return this.playlistController_.mainSegmentLoader_.throughput.rate},set(p){this.playlistController_.mainSegmentLoader_.throughput.rate=p,this.playlistController_.mainSegmentLoader_.throughput.count=1}},bandwidth:{get(){let p=this.playlistController_.mainSegmentLoader_.bandwidth;const _=window.navigator.connection||window.navigator.mozConnection||window.navigator.webkitConnection,w=1e7;if(this.options_.useNetworkInformationApi&&_){const I=_.downlink*1e3*1e3;I>=w&&p>=w?p=Math.max(p,I):p=I}return p},set(p){this.playlistController_.mainSegmentLoader_.bandwidth=p,this.playlistController_.mainSegmentLoader_.throughput={rate:0,count:0}}},systemBandwidth:{get(){const p=1/(this.bandwidth||1);let _;return this.throughput>0?_=1/this.throughput:_=0,Math.floor(1/(p+_))},set(){Ye.log.error('The "systemBandwidth" property is read-only')}}}),this.options_.bandwidth&&(this.bandwidth=this.options_.bandwidth),this.options_.throughput&&(this.throughput=this.options_.throughput),Object.defineProperties(this.stats,{bandwidth:{get:()=>this.bandwidth||0,enumerable:!0},mediaRequests:{get:()=>this.playlistController_.mediaRequests_()||0,enumerable:!0},mediaRequestsAborted:{get:()=>this.playlistController_.mediaRequestsAborted_()||0,enumerable:!0},mediaRequestsTimedout:{get:()=>this.playlistController_.mediaRequestsTimedout_()||0,enumerable:!0},mediaRequestsErrored:{get:()=>this.playlistController_.mediaRequestsErrored_()||0,enumerable:!0},mediaTransferDuration:{get:()=>this.playlistController_.mediaTransferDuration_()||0,enumerable:!0},mediaBytesTransferred:{get:()=>this.playlistController_.mediaBytesTransferred_()||0,enumerable:!0},mediaSecondsLoaded:{get:()=>this.playlistController_.mediaSecondsLoaded_()||0,enumerable:!0},mediaAppends:{get:()=>this.playlistController_.mediaAppends_()||0,enumerable:!0},mainAppendsToLoadedData:{get:()=>this.playlistController_.mainAppendsToLoadedData_()||0,enumerable:!0},audioAppendsToLoadedData:{get:()=>this.playlistController_.audioAppendsToLoadedData_()||0,enumerable:!0},appendsToLoadedData:{get:()=>this.playlistController_.appendsToLoadedData_()||0,enumerable:!0},timeToLoadedData:{get:()=>this.playlistController_.timeToLoadedData_()||0,enumerable:!0},buffered:{get:()=>zd(this.tech_.buffered()),enumerable:!0},currentTime:{get:()=>this.tech_.currentTime(),enumerable:!0},currentSource:{get:()=>this.tech_.currentSource_,enumerable:!0},currentTech:{get:()=>this.tech_.name_,enumerable:!0},duration:{get:()=>this.tech_.duration(),enumerable:!0},main:{get:()=>this.playlists.main,enumerable:!0},playerDimensions:{get:()=>this.tech_.currentDimensions(),enumerable:!0},seekable:{get:()=>zd(this.tech_.seekable()),enumerable:!0},timestamp:{get:()=>Date.now(),enumerable:!0},videoPlaybackQuality:{get:()=>this.tech_.getVideoPlaybackQuality(),enumerable:!0}}),this.tech_.one("canplay",this.playlistController_.setupFirstPlay.bind(this.playlistController_)),this.tech_.on("bandwidthupdate",()=>{this.options_.useBandwidthFromLocalStorage&&vj({bandwidth:this.bandwidth,throughput:Math.round(this.throughput)})}),this.playlistController_.on("selectedinitialmedia",()=>{oj(this)}),this.playlistController_.sourceUpdater_.on("createdsourcebuffers",()=>{this.setupEme_()}),this.on(this.playlistController_,"progress",function(){this.tech_.trigger("progress")}),this.on(this.playlistController_,"firstplay",function(){this.ignoreNextSeekingEvent_=!0}),this.setupQualityLevels_(),this.tech_.el()&&(this.mediaSourceUrl_=window.URL.createObjectURL(this.playlistController_.mediaSource),(Ye.browser.IS_ANY_SAFARI||Ye.browser.IS_IOS)&&this.options_.overrideNative&&this.options_.sourceType==="hls"&&typeof this.tech_.addSourceElement=="function"?(this.tech_.addSourceElement(this.mediaSourceUrl_),this.tech_.addSourceElement(this.source_.src)):this.tech_.src(this.mediaSourceUrl_))}createKeySessions_(){const e=this.playlistController_.mediaTypes_.AUDIO.activePlaylistLoader;this.logger_("waiting for EME key session creation"),bj({player:this.player_,sourceKeySystems:this.source_.keySystems,audioMedia:e&&e.media(),mainPlaylists:this.playlists.main.playlists}).then(()=>{this.logger_("created EME key session"),this.playlistController_.sourceUpdater_.initializedEme()}).catch(s=>{this.logger_("error while creating EME key session",s),this.player_.error({message:"Failed to initialize media keys for EME",code:3})})}handleWaitingForKey_(){this.logger_("waitingforkey fired, attempting to create any new key sessions"),this.createKeySessions_()}setupEme_(){const e=this.playlistController_.mediaTypes_.AUDIO.activePlaylistLoader,s=yj({player:this.player_,sourceKeySystems:this.source_.keySystems,media:this.playlists.media(),audioMedia:e&&e.media()});if(this.player_.tech_.on("keystatuschange",a=>{this.playlistController_.updatePlaylistByKeyStatus(a.keyId,a.status)}),this.handleWaitingForKey_=this.handleWaitingForKey_.bind(this),this.player_.tech_.on("waitingforkey",this.handleWaitingForKey_),!s){this.playlistController_.sourceUpdater_.initializedEme();return}this.createKeySessions_()}setupQualityLevels_(){const e=Ye.players[this.tech_.options_.playerId];!e||!e.qualityLevels||this.qualityLevels_||(this.qualityLevels_=e.qualityLevels(),this.playlistController_.on("selectedinitialmedia",()=>{gj(this.qualityLevels_,this)}),this.playlists.on("mediachange",()=>{BL(this.qualityLevels_,this.playlists)}))}static version(){return{"@videojs/http-streaming":OL,"mux.js":cj,"mpd-parser":dj,"m3u8-parser":fj,"aes-decrypter":pj}}version(){return this.constructor.version()}canChangeType(){return SL.canChangeType()}play(){this.playlistController_.play()}setCurrentTime(e){this.playlistController_.setCurrentTime(e)}duration(){return this.playlistController_.duration()}seekable(){return this.playlistController_.seekable()}dispose(){this.playbackWatcher_&&this.playbackWatcher_.dispose(),this.playlistController_&&this.playlistController_.dispose(),this.qualityLevels_&&this.qualityLevels_.dispose(),this.tech_&&this.tech_.vhs&&delete this.tech_.vhs,this.mediaSourceUrl_&&window.URL.revokeObjectURL&&(window.URL.revokeObjectURL(this.mediaSourceUrl_),this.mediaSourceUrl_=null),this.tech_&&this.tech_.off("waitingforkey",this.handleWaitingForKey_),super.dispose()}convertToProgramTime(e,s){return C5({playlist:this.playlistController_.media(),time:e,callback:s})}seekToProgramTime(e,s,a=!0,h=2){return YI({programTime:e,playlist:this.playlistController_.media(),retryCount:h,pauseAfterSeek:a,seekTo:this.options_.seekTo,tech:this.options_.tech,callback:s})}setupXhrHooks_(){this.xhr.onRequest=e=>{jL(this.xhr,e)},this.xhr.onResponse=e=>{HL(this.xhr,e)},this.xhr.offRequest=e=>{VL(this.xhr,e)},this.xhr.offResponse=e=>{$L(this.xhr,e)},this.player_.trigger("xhr-hooks-ready")}attachStreamingEventListeners_(){const e=["seekablerangeschanged","bufferedrangeschanged","contentsteeringloadstart","contentsteeringloadcomplete","contentsteeringparsed"],s=["gapjumped","playedrangeschanged"];e.forEach(a=>{this.playlistController_.on(a,h=>{this.player_.trigger(Z({},h))})}),s.forEach(a=>{this.playbackWatcher_.on(a,h=>{this.player_.trigger(Z({},h))})})}}const JT={name:"videojs-http-streaming",VERSION:OL,canHandleSource(r,e={}){const s=As(Ye.options,e);return!s.vhs.experimentalUseMMS&&!P_("avc1.4d400d,mp4a.40.2",!1)?!1:JT.canPlayType(r.type,s)},handleSource(r,e,s={}){const a=As(Ye.options,s);return e.vhs=new zL(r,e,a),e.vhs.xhr=WI(),e.vhs.setupXhrHooks_(),e.vhs.src(r.src,r.type),e.vhs},canPlayType(r,e){const s=bD(r);if(!s)return"";const a=JT.getOverrideNative(e);return!gn.supportsTypeNatively(s)||a?"maybe":""},getOverrideNative(r={}){const{vhs:e={}}=r,s=!(Ye.browser.IS_ANY_SAFARI||Ye.browser.IS_IOS),{overrideNative:a=s}=e;return a}};return P_("avc1.4d400d,mp4a.40.2",!0)&&Ye.getTech("Html5").registerSourceHandler(JT,0),Ye.VhsHandler=zL,Ye.VhsSourceHandler=JT,Ye.Vhs=gn,Ye.use||Ye.registerComponent("Vhs",gn),Ye.options.vhs=Ye.options.vhs||{},(!Ye.getPlugin||!Ye.getPlugin("reloadSourceOnError"))&&Ye.registerPlugin("reloadSourceOnError",hj),Ye});const rq=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));window.pdfjs=Az;window.pdfjsViewer=nq;window.videojs=rq;class aq{constructor(t){this.fileUrl=t.fileUrl,this.onLoaded=t.onLoaded,this.onError=t.onError,this.pluginConfig=t.pluginConfig||{},this.currentViewer=null,this.videoPlayer=null,this.renderFile(this.fileUrl)}async renderFile(t){if(!t){this.handleError("No file URL provided");return}try{const i=await fetch(t),n=await i.blob(),o=i.headers.get("Content-Type")||"",l=this.getExtensionFromContentType(o,t),c=URL.createObjectURL(n);await this.showViewerForExtension(l,c,t),this.onLoaded&&this.onLoaded({ext:l,url:t})}catch(i){this.handleError("Failed to load file: "+i)}}async showViewerForExtension(t,i,n){this.videoPlayer&&typeof this.videoPlayer.dispose=="function"&&(this.videoPlayer.dispose(),this.videoPlayer=null),this.container.innerHTML="",t==="pdf"?this.showPdfViewer(i):t==="docx"?await this.showDocxViewer(i):this.isVideoExtension(t)?this.showMediaViewer(i,t,"video"):this.isAudioExtension(t)?this.showMediaViewer(i,t,"audio"):this.handleError("Unsupported file type: "+t)}showPdfViewer(t){this.container.querySelector("#pdfViewerContainer")||this.container,Nt.setAll({workerSrc:"dist/pdf.js/build/pdf.worker.mjs",disablePreferences:!0,defaultUrl:t,defaultZoomValue:"page-fit",sidebarViewOnLoad:1,enableScripting:!1,enableSignatureEditor:!0,viewerCssTheme:1,cursorToolOnLoad:1,textLayerMode:1,annotationMode:3}),document.readyState==="interactive"||document.readyState==="complete"?Vk():document.addEventListener("DOMContentLoaded",Vk,!0)}async showDocxViewer(t){const i=this.container.querySelector("#docxViewerContainer")||this.container;try{await window.docx.renderAsync(await(await fetch(t)).blob(),i)}catch(n){this.handleError("DOCX render failed: "+n)}}showMediaViewer(t,i,n){const o=this.container.querySelector(n==="video"?"#videoViewer":"#audioViewer");o&&(o.style.display="",o.src=t,o.type=this.getMimeType(i,n),n==="video"?(this.videoPlayer=window.videojs(o,{controls:!0,fluid:!0,sources:[{src:t,type:this.getMimeType(i,"video")}]}),this.videoPlayer.el().addEventListener("contextmenu",l=>l.preventDefault()),this.videoPlayer.play()):o.play())}getExtensionFromContentType(t,i){return t.includes("pdf")?"pdf":t.includes("word")?"docx":t.includes("video")?this.getFileExtension(i)||"mp4":t.includes("audio")?this.getFileExtension(i)||"mp3":this.getFileExtension(i)}getFileExtension(t){let i=t.split(".").pop().toLowerCase().split("?")[0].split("#")[0];return!i||i.length>5?"":i}isVideoExtension(t){return["mp4","webm","ogv","ogg","mov","m4v"].includes(t)}isAudioExtension(t){return["mp3","wav","aac","flac","ogg","m4a"].includes(t)}getMimeType(t,i){if(i==="video")switch(t){case"mp4":return"video/mp4";case"webm":return"video/webm";case"ogg":case"ogv":return"video/ogg";case"mov":return"video/quicktime";case"m4v":return"video/x-m4v"}else if(i==="audio")switch(t){case"mp3":return"audio/mp3";case"wav":return"audio/wav";case"aac":return"audio/aac";case"flac":return"audio/flac";case"ogg":return"audio/ogg";case"m4a":return"audio/mp4"}return""}handleError(t){this.onError?this.onError(t):(this.container.innerHTML=`<div class="docv-error">${t}</div>`,console.error(t))}}window.DocViewer=aq;
